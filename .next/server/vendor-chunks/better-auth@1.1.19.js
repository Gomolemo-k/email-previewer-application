"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/better-auth@1.1.19";
exports.ids = ["vendor-chunks/better-auth@1.1.19"];
exports.modules = {

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/adapters/drizzle.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/adapters/drizzle.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   drizzleAdapter: () => (/* binding */ drizzleAdapter)\n/* harmony export */ });\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../chunk-62MWLLEG.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../chunk-NPO64SVN.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_SK6Y2YH6_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../chunk-SK6Y2YH6.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../chunk-3XTQSPPA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../chunk-53IPO2PJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! drizzle-orm */ \"(action-browser)/./node_modules/.pnpm/drizzle-orm@0.39.3_@neondatabase+serverless@0.10.4_@opentelemetry+api@1.9.0_@types+pg@8_69ac2805d474d60a6d38622a789f6e04/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! drizzle-orm */ \"(action-browser)/./node_modules/.pnpm/drizzle-orm@0.39.3_@neondatabase+serverless@0.10.4_@opentelemetry+api@1.9.0_@types+pg@8_69ac2805d474d60a6d38622a789f6e04/node_modules/drizzle-orm/sql/expressions/select.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar createTransform = (db, config, options) => {\n  const schema = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_0__.getAuthTables)(options);\n  function getField(model, field) {\n    if (field === \"id\") {\n      return field;\n    }\n    const f = schema[model].fields[field];\n    return f.fieldName || field;\n  }\n  function getSchema(modelName) {\n    const schema2 = config.schema || db._.fullSchema;\n    if (!schema2) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n        \"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\"\n      );\n    }\n    const model = getModelName(modelName);\n    const schemaModel = schema2[model];\n    if (!schemaModel) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n        `[# Drizzle Adapter]: The model \"${model}\" was not found in the schema object. Please pass the schema directly to the adapter options.`\n      );\n    }\n    return schemaModel;\n  }\n  const getModelName = (model) => {\n    return schema[model].modelName !== model ? schema[model].modelName : config.usePlural ? `${model}s` : model;\n  };\n  function convertWhereClause(where, model) {\n    const schemaModel = getSchema(model);\n    if (!where) return [];\n    if (where.length === 1) {\n      const w = where[0];\n      if (!w) {\n        return [];\n      }\n      const field = getField(model, w.field);\n      if (!schemaModel[field]) {\n        throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n          `The field \"${w.field}\" does not exist in the schema for the model \"${model}\". Please update your schema.`\n        );\n      }\n      if (w.operator === \"in\") {\n        if (!Array.isArray(w.value)) {\n          throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n            `The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`\n          );\n        }\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.inArray)(schemaModel[field], w.value)];\n      }\n      if (w.operator === \"contains\") {\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.like)(schemaModel[field], `%${w.value}%`)];\n      }\n      if (w.operator === \"starts_with\") {\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.like)(schemaModel[field], `${w.value}%`)];\n      }\n      if (w.operator === \"ends_with\") {\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.like)(schemaModel[field], `%${w.value}`)];\n      }\n      return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel[field], w.value)];\n    }\n    const andGroup = where.filter((w) => w.connector === \"AND\" || !w.connector);\n    const orGroup = where.filter((w) => w.connector === \"OR\");\n    const andClause = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.and)(\n      ...andGroup.map((w) => {\n        const field = getField(model, w.field);\n        if (w.operator === \"in\") {\n          if (!Array.isArray(w.value)) {\n            throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n              `The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`\n            );\n          }\n          return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.inArray)(schemaModel[field], w.value);\n        }\n        return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel[field], w.value);\n      })\n    );\n    const orClause = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.or)(\n      ...orGroup.map((w) => {\n        const field = getField(model, w.field);\n        return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel[field], w.value);\n      })\n    );\n    const clause = [];\n    if (andGroup.length) clause.push(andClause);\n    if (orGroup.length) clause.push(orClause);\n    return clause;\n  }\n  const useDatabaseGeneratedId = options?.advanced?.generateId === false;\n  return {\n    getSchema,\n    transformInput(data, model, action) {\n      const transformedData = useDatabaseGeneratedId || action === \"update\" ? {} : {\n        id: options.advanced?.generateId ? options.advanced.generateId({\n          model\n        }) : data.id || (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_2__.generateId)()\n      };\n      const fields = schema[model].fields;\n      for (const field in fields) {\n        const value = data[field];\n        if (value === void 0 && !fields[field].defaultValue) {\n          continue;\n        }\n        transformedData[fields[field].fieldName || field] = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_0__.withApplyDefault)(\n          value,\n          fields[field],\n          action\n        );\n      }\n      return transformedData;\n    },\n    transformOutput(data, model, select = []) {\n      if (!data) return null;\n      const transformedData = data.id || data._id ? select.length === 0 || select.includes(\"id\") ? {\n        id: data.id\n      } : {} : {};\n      const tableSchema = schema[model].fields;\n      for (const key in tableSchema) {\n        if (select.length && !select.includes(key)) {\n          continue;\n        }\n        const field = tableSchema[key];\n        if (field) {\n          transformedData[key] = data[field.fieldName || key];\n        }\n      }\n      return transformedData;\n    },\n    convertWhereClause,\n    withReturning: async (model, builder, data, where) => {\n      if (config.provider !== \"mysql\") {\n        const c = await builder.returning();\n        return c[0];\n      }\n      await builder.execute();\n      const schemaModel = getSchema(model);\n      const builderVal = builder.config?.values;\n      if (where?.length) {\n        const clause = convertWhereClause(where, model);\n        const res = await db.select().from(schemaModel).where(...clause);\n        return res[0];\n      } else if (builderVal) {\n        const tId = builderVal[0]?.id.value;\n        const res = await db.select().from(schemaModel).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel.id, tId));\n        return res[0];\n      } else if (data.id) {\n        const res = await db.select().from(schemaModel).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel.id, data.id));\n        return res[0];\n      }\n    },\n    getField,\n    getModelName\n  };\n};\nfunction checkMissingFields(schema, model, values) {\n  if (!schema) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n      \"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\"\n    );\n  }\n  for (const key in values) {\n    if (!schema[key]) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n        `The field \"${key}\" does not exist in the \"${model}\" schema. Please update your drizzle schema or re-generate using \"npx @better-auth/cli generate\".`\n      );\n    }\n  }\n}\nvar drizzleAdapter = (db, config) => (options) => {\n  const {\n    transformInput,\n    transformOutput,\n    convertWhereClause,\n    getSchema,\n    withReturning,\n    getField,\n    getModelName\n  } = createTransform(db, config, options);\n  return {\n    id: \"drizzle\",\n    async create(data) {\n      const { model, data: values } = data;\n      const transformed = transformInput(values, model, \"create\");\n      const schemaModel = getSchema(model);\n      checkMissingFields(schemaModel, getModelName(model), transformed);\n      const builder = db.insert(schemaModel).values(transformed);\n      const returned = await withReturning(model, builder, transformed);\n      return transformOutput(returned, model);\n    },\n    async findOne(data) {\n      const { model, where, select } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const res = await db.select().from(schemaModel).where(...clause);\n      if (!res.length) return null;\n      return transformOutput(res[0], model, select);\n    },\n    async findMany(data) {\n      const { model, where, sortBy, limit, offset } = data;\n      const schemaModel = getSchema(model);\n      const clause = where ? convertWhereClause(where, model) : [];\n      const sortFn = sortBy?.direction === \"desc\" ? drizzle_orm__WEBPACK_IMPORTED_MODULE_12__.desc : drizzle_orm__WEBPACK_IMPORTED_MODULE_12__.asc;\n      const builder = db.select().from(schemaModel).limit(limit || 100).offset(offset || 0);\n      if (sortBy?.field) {\n        builder.orderBy(sortFn(schemaModel[getField(model, sortBy?.field)]));\n      }\n      const res = await builder.where(...clause);\n      return res.map((r) => transformOutput(r, model));\n    },\n    async update(data) {\n      const { model, where, update: values } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const transformed = transformInput(values, model, \"update\");\n      const builder = db.update(schemaModel).set(transformed).where(...clause);\n      const returned = await withReturning(\n        model,\n        builder,\n        transformed,\n        where\n      );\n      return transformOutput(returned, model);\n    },\n    async updateMany(data) {\n      const { model, where, update: values } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const transformed = transformInput(values, model, \"update\");\n      const builder = db.update(schemaModel).set(transformed).where(...clause);\n      const res = await builder;\n      return res ? res.changes : 0;\n    },\n    async delete(data) {\n      const { model, where } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const builder = db.delete(schemaModel).where(...clause);\n      await builder;\n    },\n    async deleteMany(data) {\n      const { model, where } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const builder = db.delete(schemaModel).where(...clause);\n      const res = await builder;\n      return res ? res.length : 0;\n    },\n    options: config\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvYWRhcHRlcnMvZHJpenpsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUF1RTtBQUN6QztBQUNvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN5QjtBQUNhOztBQUVwRTtBQUNBLGlCQUFpQixpRUFBYTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnRUFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0VBQWU7QUFDL0IsMkNBQTJDLE1BQU07QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtGQUErRixNQUFNO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsZ0VBQWU7QUFDakMsd0JBQXdCLFFBQVEsZ0RBQWdELE1BQU07QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0VBQWU7QUFDbkMsd0NBQXdDLFFBQVE7QUFDaEQ7QUFDQTtBQUNBLGdCQUFnQixxREFBTztBQUN2QjtBQUNBO0FBQ0EsZ0JBQWdCLGtEQUFJLHlCQUF5QixRQUFRO0FBQ3JEO0FBQ0E7QUFDQSxnQkFBZ0Isa0RBQUksd0JBQXdCLFFBQVE7QUFDcEQ7QUFDQTtBQUNBLGdCQUFnQixrREFBSSx5QkFBeUIsUUFBUTtBQUNyRDtBQUNBLGNBQWMsZ0RBQUU7QUFDaEI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFHO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGdFQUFlO0FBQ3JDLDBDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQSxpQkFBaUIscURBQU87QUFDeEI7QUFDQSxlQUFlLGdEQUFFO0FBQ2pCLE9BQU87QUFDUDtBQUNBLHFCQUFxQixnREFBRTtBQUN2QjtBQUNBO0FBQ0EsZUFBZSxnREFBRTtBQUNqQixPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRkFBaUY7QUFDakY7QUFDQTtBQUNBLFNBQVMsZUFBZSw4REFBVTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCxvRUFBZ0I7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxLQUFLO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLDhEQUE4RCxnREFBRTtBQUNoRTtBQUNBLFFBQVE7QUFDUiw4REFBOEQsZ0RBQUU7QUFDaEU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGdFQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0VBQWU7QUFDL0Isc0JBQXNCLElBQUksMkJBQTJCLE1BQU07QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsY0FBYyxzQkFBc0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYyx1QkFBdUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsc0NBQXNDO0FBQ3BEO0FBQ0E7QUFDQSxvREFBb0QsOENBQUksR0FBRyw2Q0FBRztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxjQUFjLCtCQUErQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYywrQkFBK0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUUwQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FkYXB0ZXJzL2RyaXp6bGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0QXV0aFRhYmxlcywgd2l0aEFwcGx5RGVmYXVsdCB9IGZyb20gJy4uL2NodW5rLTYyTVdMTEVHLmpzJztcbmltcG9ydCAnLi4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVJZCB9IGZyb20gJy4uL2NodW5rLUtMREZCTFlMLmpzJztcbmltcG9ydCAnLi4vY2h1bmstTlBPNjRTVk4uanMnO1xuaW1wb3J0ICcuLi9jaHVuay1TSzZZMllINi5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLTNYVFFTUFBBLmpzJztcbmltcG9ydCAnLi4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0ICcuLi9jaHVuay01M0lQTzJQSi5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCAnLi4vY2h1bmstVFFRU1BQTkEuanMnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnLi4vY2h1bmstVU5XQ1hLTVAuanMnO1xuaW1wb3J0IHsgZGVzYywgYXNjLCBlcSwgaW5BcnJheSwgbGlrZSwgYW5kLCBvciB9IGZyb20gJ2RyaXp6bGUtb3JtJztcblxudmFyIGNyZWF0ZVRyYW5zZm9ybSA9IChkYiwgY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGZ1bmN0aW9uIGdldEZpZWxkKG1vZGVsLCBmaWVsZCkge1xuICAgIGlmIChmaWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxuICAgIGNvbnN0IGYgPSBzY2hlbWFbbW9kZWxdLmZpZWxkc1tmaWVsZF07XG4gICAgcmV0dXJuIGYuZmllbGROYW1lIHx8IGZpZWxkO1xuICB9XG4gIGZ1bmN0aW9uIGdldFNjaGVtYShtb2RlbE5hbWUpIHtcbiAgICBjb25zdCBzY2hlbWEyID0gY29uZmlnLnNjaGVtYSB8fCBkYi5fLmZ1bGxTY2hlbWE7XG4gICAgaWYgKCFzY2hlbWEyKSB7XG4gICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICBcIkRyaXp6bGUgYWRhcHRlciBmYWlsZWQgdG8gaW5pdGlhbGl6ZS4gU2NoZW1hIG5vdCBmb3VuZC4gUGxlYXNlIHByb3ZpZGUgYSBzY2hlbWEgb2JqZWN0IGluIHRoZSBhZGFwdGVyIG9wdGlvbnMgb2JqZWN0LlwiXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZShtb2RlbE5hbWUpO1xuICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gc2NoZW1hMlttb2RlbF07XG4gICAgaWYgKCFzY2hlbWFNb2RlbCkge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgYFsjIERyaXp6bGUgQWRhcHRlcl06IFRoZSBtb2RlbCBcIiR7bW9kZWx9XCIgd2FzIG5vdCBmb3VuZCBpbiB0aGUgc2NoZW1hIG9iamVjdC4gUGxlYXNlIHBhc3MgdGhlIHNjaGVtYSBkaXJlY3RseSB0byB0aGUgYWRhcHRlciBvcHRpb25zLmBcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBzY2hlbWFNb2RlbDtcbiAgfVxuICBjb25zdCBnZXRNb2RlbE5hbWUgPSAobW9kZWwpID0+IHtcbiAgICByZXR1cm4gc2NoZW1hW21vZGVsXS5tb2RlbE5hbWUgIT09IG1vZGVsID8gc2NoZW1hW21vZGVsXS5tb2RlbE5hbWUgOiBjb25maWcudXNlUGx1cmFsID8gYCR7bW9kZWx9c2AgOiBtb2RlbDtcbiAgfTtcbiAgZnVuY3Rpb24gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCkge1xuICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICBpZiAoIXdoZXJlKSByZXR1cm4gW107XG4gICAgaWYgKHdoZXJlLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29uc3QgdyA9IHdoZXJlWzBdO1xuICAgICAgaWYgKCF3KSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQobW9kZWwsIHcuZmllbGQpO1xuICAgICAgaWYgKCFzY2hlbWFNb2RlbFtmaWVsZF0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICBgVGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIGRvZXMgbm90IGV4aXN0IGluIHRoZSBzY2hlbWEgZm9yIHRoZSBtb2RlbCBcIiR7bW9kZWx9XCIuIFBsZWFzZSB1cGRhdGUgeW91ciBzY2hlbWEuYFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKHcub3BlcmF0b3IgPT09IFwiaW5cIikge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkody52YWx1ZSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgYFRoZSB2YWx1ZSBmb3IgdGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIG11c3QgYmUgYW4gYXJyYXkgd2hlbiB1c2luZyB0aGUgXCJpblwiIG9wZXJhdG9yLmBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbaW5BcnJheShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpXTtcbiAgICAgIH1cbiAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcImNvbnRhaW5zXCIpIHtcbiAgICAgICAgcmV0dXJuIFtsaWtlKHNjaGVtYU1vZGVsW2ZpZWxkXSwgYCUke3cudmFsdWV9JWApXTtcbiAgICAgIH1cbiAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcInN0YXJ0c193aXRoXCIpIHtcbiAgICAgICAgcmV0dXJuIFtsaWtlKHNjaGVtYU1vZGVsW2ZpZWxkXSwgYCR7dy52YWx1ZX0lYCldO1xuICAgICAgfVxuICAgICAgaWYgKHcub3BlcmF0b3IgPT09IFwiZW5kc193aXRoXCIpIHtcbiAgICAgICAgcmV0dXJuIFtsaWtlKHNjaGVtYU1vZGVsW2ZpZWxkXSwgYCUke3cudmFsdWV9YCldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtlcShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpXTtcbiAgICB9XG4gICAgY29uc3QgYW5kR3JvdXAgPSB3aGVyZS5maWx0ZXIoKHcpID0+IHcuY29ubmVjdG9yID09PSBcIkFORFwiIHx8ICF3LmNvbm5lY3Rvcik7XG4gICAgY29uc3Qgb3JHcm91cCA9IHdoZXJlLmZpbHRlcigodykgPT4gdy5jb25uZWN0b3IgPT09IFwiT1JcIik7XG4gICAgY29uc3QgYW5kQ2xhdXNlID0gYW5kKFxuICAgICAgLi4uYW5kR3JvdXAubWFwKCh3KSA9PiB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQobW9kZWwsIHcuZmllbGQpO1xuICAgICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJpblwiKSB7XG4gICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHcudmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgICBgVGhlIHZhbHVlIGZvciB0aGUgZmllbGQgXCIke3cuZmllbGR9XCIgbXVzdCBiZSBhbiBhcnJheSB3aGVuIHVzaW5nIHRoZSBcImluXCIgb3BlcmF0b3IuYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGluQXJyYXkoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXEoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgICBjb25zdCBvckNsYXVzZSA9IG9yKFxuICAgICAgLi4ub3JHcm91cC5tYXAoKHcpID0+IHtcbiAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChtb2RlbCwgdy5maWVsZCk7XG4gICAgICAgIHJldHVybiBlcShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpO1xuICAgICAgfSlcbiAgICApO1xuICAgIGNvbnN0IGNsYXVzZSA9IFtdO1xuICAgIGlmIChhbmRHcm91cC5sZW5ndGgpIGNsYXVzZS5wdXNoKGFuZENsYXVzZSk7XG4gICAgaWYgKG9yR3JvdXAubGVuZ3RoKSBjbGF1c2UucHVzaChvckNsYXVzZSk7XG4gICAgcmV0dXJuIGNsYXVzZTtcbiAgfVxuICBjb25zdCB1c2VEYXRhYmFzZUdlbmVyYXRlZElkID0gb3B0aW9ucz8uYWR2YW5jZWQ/LmdlbmVyYXRlSWQgPT09IGZhbHNlO1xuICByZXR1cm4ge1xuICAgIGdldFNjaGVtYSxcbiAgICB0cmFuc2Zvcm1JbnB1dChkYXRhLCBtb2RlbCwgYWN0aW9uKSB7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSB1c2VEYXRhYmFzZUdlbmVyYXRlZElkIHx8IGFjdGlvbiA9PT0gXCJ1cGRhdGVcIiA/IHt9IDoge1xuICAgICAgICBpZDogb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCA/IG9wdGlvbnMuYWR2YW5jZWQuZ2VuZXJhdGVJZCh7XG4gICAgICAgICAgbW9kZWxcbiAgICAgICAgfSkgOiBkYXRhLmlkIHx8IGdlbmVyYXRlSWQoKVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGZpZWxkcyA9IHNjaGVtYVttb2RlbF0uZmllbGRzO1xuICAgICAgZm9yIChjb25zdCBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2ZpZWxkXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgJiYgIWZpZWxkc1tmaWVsZF0uZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdHJhbnNmb3JtZWREYXRhW2ZpZWxkc1tmaWVsZF0uZmllbGROYW1lIHx8IGZpZWxkXSA9IHdpdGhBcHBseURlZmF1bHQoXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgZmllbGRzW2ZpZWxkXSxcbiAgICAgICAgICBhY3Rpb25cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gICAgfSxcbiAgICB0cmFuc2Zvcm1PdXRwdXQoZGF0YSwgbW9kZWwsIHNlbGVjdCA9IFtdKSB7XG4gICAgICBpZiAoIWRhdGEpIHJldHVybiBudWxsO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gZGF0YS5pZCB8fCBkYXRhLl9pZCA/IHNlbGVjdC5sZW5ndGggPT09IDAgfHwgc2VsZWN0LmluY2x1ZGVzKFwiaWRcIikgPyB7XG4gICAgICAgIGlkOiBkYXRhLmlkXG4gICAgICB9IDoge30gOiB7fTtcbiAgICAgIGNvbnN0IHRhYmxlU2NoZW1hID0gc2NoZW1hW21vZGVsXS5maWVsZHM7XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0YWJsZVNjaGVtYSkge1xuICAgICAgICBpZiAoc2VsZWN0Lmxlbmd0aCAmJiAhc2VsZWN0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWVsZCA9IHRhYmxlU2NoZW1hW2tleV07XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgIHRyYW5zZm9ybWVkRGF0YVtrZXldID0gZGF0YVtmaWVsZC5maWVsZE5hbWUgfHwga2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkRGF0YTtcbiAgICB9LFxuICAgIGNvbnZlcnRXaGVyZUNsYXVzZSxcbiAgICB3aXRoUmV0dXJuaW5nOiBhc3luYyAobW9kZWwsIGJ1aWxkZXIsIGRhdGEsIHdoZXJlKSA9PiB7XG4gICAgICBpZiAoY29uZmlnLnByb3ZpZGVyICE9PSBcIm15c3FsXCIpIHtcbiAgICAgICAgY29uc3QgYyA9IGF3YWl0IGJ1aWxkZXIucmV0dXJuaW5nKCk7XG4gICAgICAgIHJldHVybiBjWzBdO1xuICAgICAgfVxuICAgICAgYXdhaXQgYnVpbGRlci5leGVjdXRlKCk7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBjb25zdCBidWlsZGVyVmFsID0gYnVpbGRlci5jb25maWc/LnZhbHVlcztcbiAgICAgIGlmICh3aGVyZT8ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHNjaGVtYU1vZGVsKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgICByZXR1cm4gcmVzWzBdO1xuICAgICAgfSBlbHNlIGlmIChidWlsZGVyVmFsKSB7XG4gICAgICAgIGNvbnN0IHRJZCA9IGJ1aWxkZXJWYWxbMF0/LmlkLnZhbHVlO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHNjaGVtYU1vZGVsKS53aGVyZShlcShzY2hlbWFNb2RlbC5pZCwgdElkKSk7XG4gICAgICAgIHJldHVybiByZXNbMF07XG4gICAgICB9IGVsc2UgaWYgKGRhdGEuaWQpIHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzY2hlbWFNb2RlbCkud2hlcmUoZXEoc2NoZW1hTW9kZWwuaWQsIGRhdGEuaWQpKTtcbiAgICAgICAgcmV0dXJuIHJlc1swXTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGdldEZpZWxkLFxuICAgIGdldE1vZGVsTmFtZVxuICB9O1xufTtcbmZ1bmN0aW9uIGNoZWNrTWlzc2luZ0ZpZWxkcyhzY2hlbWEsIG1vZGVsLCB2YWx1ZXMpIHtcbiAgaWYgKCFzY2hlbWEpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgXCJEcml6emxlIGFkYXB0ZXIgZmFpbGVkIHRvIGluaXRpYWxpemUuIFNjaGVtYSBub3QgZm91bmQuIFBsZWFzZSBwcm92aWRlIGEgc2NoZW1hIG9iamVjdCBpbiB0aGUgYWRhcHRlciBvcHRpb25zIG9iamVjdC5cIlxuICAgICk7XG4gIH1cbiAgZm9yIChjb25zdCBrZXkgaW4gdmFsdWVzKSB7XG4gICAgaWYgKCFzY2hlbWFba2V5XSkge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgYFRoZSBmaWVsZCBcIiR7a2V5fVwiIGRvZXMgbm90IGV4aXN0IGluIHRoZSBcIiR7bW9kZWx9XCIgc2NoZW1hLiBQbGVhc2UgdXBkYXRlIHlvdXIgZHJpenpsZSBzY2hlbWEgb3IgcmUtZ2VuZXJhdGUgdXNpbmcgXCJucHggQGJldHRlci1hdXRoL2NsaSBnZW5lcmF0ZVwiLmBcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG52YXIgZHJpenpsZUFkYXB0ZXIgPSAoZGIsIGNvbmZpZykgPT4gKG9wdGlvbnMpID0+IHtcbiAgY29uc3Qge1xuICAgIHRyYW5zZm9ybUlucHV0LFxuICAgIHRyYW5zZm9ybU91dHB1dCxcbiAgICBjb252ZXJ0V2hlcmVDbGF1c2UsXG4gICAgZ2V0U2NoZW1hLFxuICAgIHdpdGhSZXR1cm5pbmcsXG4gICAgZ2V0RmllbGQsXG4gICAgZ2V0TW9kZWxOYW1lXG4gIH0gPSBjcmVhdGVUcmFuc2Zvcm0oZGIsIGNvbmZpZywgb3B0aW9ucyk7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZHJpenpsZVwiLFxuICAgIGFzeW5jIGNyZWF0ZShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCBkYXRhOiB2YWx1ZXMgfSA9IGRhdGE7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHRyYW5zZm9ybUlucHV0KHZhbHVlcywgbW9kZWwsIFwiY3JlYXRlXCIpO1xuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgY2hlY2tNaXNzaW5nRmllbGRzKHNjaGVtYU1vZGVsLCBnZXRNb2RlbE5hbWUobW9kZWwpLCB0cmFuc2Zvcm1lZCk7XG4gICAgICBjb25zdCBidWlsZGVyID0gZGIuaW5zZXJ0KHNjaGVtYU1vZGVsKS52YWx1ZXModHJhbnNmb3JtZWQpO1xuICAgICAgY29uc3QgcmV0dXJuZWQgPSBhd2FpdCB3aXRoUmV0dXJuaW5nKG1vZGVsLCBidWlsZGVyLCB0cmFuc2Zvcm1lZCk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtT3V0cHV0KHJldHVybmVkLCBtb2RlbCk7XG4gICAgfSxcbiAgICBhc3luYyBmaW5kT25lKGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlLCBzZWxlY3QgfSA9IGRhdGE7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBjb25zdCBjbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20oc2NoZW1hTW9kZWwpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICBpZiAoIXJlcy5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybU91dHB1dChyZXNbMF0sIG1vZGVsLCBzZWxlY3QpO1xuICAgIH0sXG4gICAgYXN5bmMgZmluZE1hbnkoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIHNvcnRCeSwgbGltaXQsIG9mZnNldCB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgIGNvbnN0IGNsYXVzZSA9IHdoZXJlID8gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCkgOiBbXTtcbiAgICAgIGNvbnN0IHNvcnRGbiA9IHNvcnRCeT8uZGlyZWN0aW9uID09PSBcImRlc2NcIiA/IGRlc2MgOiBhc2M7XG4gICAgICBjb25zdCBidWlsZGVyID0gZGIuc2VsZWN0KCkuZnJvbShzY2hlbWFNb2RlbCkubGltaXQobGltaXQgfHwgMTAwKS5vZmZzZXQob2Zmc2V0IHx8IDApO1xuICAgICAgaWYgKHNvcnRCeT8uZmllbGQpIHtcbiAgICAgICAgYnVpbGRlci5vcmRlckJ5KHNvcnRGbihzY2hlbWFNb2RlbFtnZXRGaWVsZChtb2RlbCwgc29ydEJ5Py5maWVsZCldKSk7XG4gICAgICB9XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBidWlsZGVyLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICByZXR1cm4gcmVzLm1hcCgocikgPT4gdHJhbnNmb3JtT3V0cHV0KHIsIG1vZGVsKSk7XG4gICAgfSxcbiAgICBhc3luYyB1cGRhdGUoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZTogdmFsdWVzIH0gPSBkYXRhO1xuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHRyYW5zZm9ybUlucHV0KHZhbHVlcywgbW9kZWwsIFwidXBkYXRlXCIpO1xuICAgICAgY29uc3QgYnVpbGRlciA9IGRiLnVwZGF0ZShzY2hlbWFNb2RlbCkuc2V0KHRyYW5zZm9ybWVkKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgY29uc3QgcmV0dXJuZWQgPSBhd2FpdCB3aXRoUmV0dXJuaW5nKFxuICAgICAgICBtb2RlbCxcbiAgICAgICAgYnVpbGRlcixcbiAgICAgICAgdHJhbnNmb3JtZWQsXG4gICAgICAgIHdoZXJlXG4gICAgICApO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybU91dHB1dChyZXR1cm5lZCwgbW9kZWwpO1xuICAgIH0sXG4gICAgYXN5bmMgdXBkYXRlTWFueShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSwgdXBkYXRlOiB2YWx1ZXMgfSA9IGRhdGE7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBjb25zdCBjbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gdHJhbnNmb3JtSW5wdXQodmFsdWVzLCBtb2RlbCwgXCJ1cGRhdGVcIik7XG4gICAgICBjb25zdCBidWlsZGVyID0gZGIudXBkYXRlKHNjaGVtYU1vZGVsKS5zZXQodHJhbnNmb3JtZWQpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBidWlsZGVyO1xuICAgICAgcmV0dXJuIHJlcyA/IHJlcy5jaGFuZ2VzIDogMDtcbiAgICB9LFxuICAgIGFzeW5jIGRlbGV0ZShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgIGNvbnN0IGNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgY29uc3QgYnVpbGRlciA9IGRiLmRlbGV0ZShzY2hlbWFNb2RlbCkud2hlcmUoLi4uY2xhdXNlKTtcbiAgICAgIGF3YWl0IGJ1aWxkZXI7XG4gICAgfSxcbiAgICBhc3luYyBkZWxldGVNYW55KGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlIH0gPSBkYXRhO1xuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICBjb25zdCBidWlsZGVyID0gZGIuZGVsZXRlKHNjaGVtYU1vZGVsKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYnVpbGRlcjtcbiAgICAgIHJldHVybiByZXMgPyByZXMubGVuZ3RoIDogMDtcbiAgICB9LFxuICAgIG9wdGlvbnM6IGNvbmZpZ1xuICB9O1xufTtcblxuZXhwb3J0IHsgZHJpenpsZUFkYXB0ZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/adapters/drizzle.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   magicLink: () => (/* binding */ magicLink)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\nvar magicLink = (options) => {\n  return {\n    id: \"magic-link\",\n    endpoints: {\n      signInMagicLink: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/magic-link\",\n        {\n          method: \"POST\",\n          requireHeaders: true,\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"Email address to send the magic link\"\n            }).email(),\n            name: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"User display name. Only used if the user is registering for the first time.\"\n            }).optional(),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"URL to redirect after magic link verification\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              description: \"Sign in with magic link\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          status: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { email } = ctx.body;\n          if (options.disableSignUp) {\n            const user = await ctx.context.internalAdapter.findUserByEmail(email);\n            if (!user) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_4__.APIError(\"BAD_REQUEST\", {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.USER_NOT_FOUND\n              });\n            }\n          }\n          const verificationToken = options?.generateToken ? await options.generateToken(email) : (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            identifier: verificationToken,\n            value: JSON.stringify({ email, name: ctx.body.name }),\n            expiresAt: new Date(\n              Date.now() + (options.expiresIn || 60 * 5) * 1e3\n            )\n          });\n          const url = `${ctx.context.baseURL}/magic-link/verify?token=${verificationToken}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n          await options.sendMagicLink(\n            {\n              email,\n              url,\n              token: verificationToken\n            },\n            ctx.request\n          );\n          return ctx.json({\n            status: true\n          });\n        }\n      ),\n      magicLinkVerify: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/magic-link/verify\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            token: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"Verification token\"\n            }),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"URL to redirect after magic link verification, if not provided will return session\"\n            }).optional()\n          }),\n          use: [(0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.originCheck)((ctx) => ctx.query.callbackURL)],\n          requireHeaders: true,\n          metadata: {\n            openapi: {\n              description: \"Verify magic link\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          },\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { token, callbackURL } = ctx.query;\n          const toRedirectTo = callbackURL?.startsWith(\"http\") ? callbackURL : callbackURL ? `${ctx.context.options.baseURL}${callbackURL}` : ctx.context.options.baseURL;\n          const tokenValue = await ctx.context.internalAdapter.findVerificationValue(token);\n          if (!tokenValue) {\n            throw ctx.redirect(`${toRedirectTo}?error=INVALID_TOKEN`);\n          }\n          if (tokenValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              tokenValue.id\n            );\n            throw ctx.redirect(`${toRedirectTo}?error=EXPIRED_TOKEN`);\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            tokenValue.id\n          );\n          const { email, name } = JSON.parse(tokenValue.value);\n          let user = await ctx.context.internalAdapter.findUserByEmail(email).then((res) => res?.user);\n          if (!user) {\n            if (!options.disableSignUp) {\n              const newUser = await ctx.context.internalAdapter.createUser({\n                email,\n                emailVerified: true,\n                name: name || email\n              });\n              user = newUser;\n              if (!user) {\n                throw ctx.redirect(\n                  `${toRedirectTo}?error=failed_to_create_user`\n                );\n              }\n            } else {\n              throw ctx.redirect(`${toRedirectTo}?error=failed_to_create_user`);\n            }\n          }\n          if (!user.emailVerified) {\n            await ctx.context.internalAdapter.updateUser(user.id, {\n              emailVerified: true\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.headers\n          );\n          if (!session) {\n            throw ctx.redirect(\n              `${toRedirectTo}?error=failed_to_create_session`\n            );\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n            session,\n            user\n          });\n          if (!callbackURL) {\n            return ctx.json({\n              token: session.token,\n              user: {\n                id: user.id,\n                email: user.email,\n                emailVerified: user.emailVerified,\n                name: user.name,\n                image: user.image,\n                createdAt: user.createdAt,\n                updatedAt: user.updatedAt\n              }\n            });\n          }\n          throw ctx.redirect(callbackURL);\n        }\n      )\n    },\n    rateLimit: [\n      {\n        pathMatcher(path) {\n          return path.startsWith(\"/sign-in/magic-link\") || path.startsWith(\"/magic-link/verify\");\n        },\n        window: options.rateLimit?.window || 60,\n        max: options.rateLimit?.max || 5\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstMktPVVkzU0ouanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXdGO0FBQ2pDO0FBQ0k7QUFDbkM7QUFDZTs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0VBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLG1CQUFtQix5Q0FBUTtBQUMzQjtBQUNBLGFBQWE7QUFDYixrQkFBa0IseUNBQVE7QUFDMUI7QUFDQSxhQUFhO0FBQ2IseUJBQXlCLHlDQUFRO0FBQ2pDO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLGtCQUFrQixRQUFRO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpREFBUTtBQUNoQyx5QkFBeUIsZ0VBQWdCO0FBQ3pDLGVBQWU7QUFDZjtBQUNBO0FBQ0Esa0dBQWtHLHdFQUFvQjtBQUN0SDtBQUNBO0FBQ0Esb0NBQW9DLDRCQUE0QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gseUJBQXlCLG9CQUFvQiwyQkFBMkIsa0JBQWtCLGVBQWUsNEJBQTRCO0FBQ3JJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLHVCQUF1QixzRUFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHlDQUFRO0FBQ3pCLG1CQUFtQix5Q0FBUTtBQUMzQjtBQUNBLGFBQWE7QUFDYix5QkFBeUIseUNBQVE7QUFDakM7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYLGdCQUFnQiwrREFBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDLGdHQUFnRyw0QkFBNEIsRUFBRSxZQUFZO0FBQzFJO0FBQ0E7QUFDQSxrQ0FBa0MsYUFBYTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGFBQWE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsY0FBYztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsYUFBYTtBQUNsQztBQUNBO0FBQ0EsY0FBYztBQUNkLG9DQUFvQyxhQUFhO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsYUFBYTtBQUM5QjtBQUNBO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstMktPVVkzU0ouanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBCQVNFX0VSUk9SX0NPREVTLCBvcmlnaW5DaGVjayB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbnZhciBtYWdpY0xpbmsgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm1hZ2ljLWxpbmtcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNpZ25Jbk1hZ2ljTGluazogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9zaWduLWluL21hZ2ljLWxpbmtcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgYWRkcmVzcyB0byBzZW5kIHRoZSBtYWdpYyBsaW5rXCJcbiAgICAgICAgICAgIH0pLmVtYWlsKCksXG4gICAgICAgICAgICBuYW1lOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgZGlzcGxheSBuYW1lLiBPbmx5IHVzZWQgaWYgdGhlIHVzZXIgaXMgcmVnaXN0ZXJpbmcgZm9yIHRoZSBmaXJzdCB0aW1lLlwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVVJMIHRvIHJlZGlyZWN0IGFmdGVyIG1hZ2ljIGxpbmsgdmVyaWZpY2F0aW9uXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggbWFnaWMgbGlua1wiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB7IGVtYWlsIH0gPSBjdHguYm9keTtcbiAgICAgICAgICBpZiAob3B0aW9ucy5kaXNhYmxlU2lnblVwKSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9OT1RfRk9VTkRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblRva2VuID0gb3B0aW9ucz8uZ2VuZXJhdGVUb2tlbiA/IGF3YWl0IG9wdGlvbnMuZ2VuZXJhdGVUb2tlbihlbWFpbCkgOiBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIik7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IHZlcmlmaWNhdGlvblRva2VuLFxuICAgICAgICAgICAgdmFsdWU6IEpTT04uc3RyaW5naWZ5KHsgZW1haWwsIG5hbWU6IGN0eC5ib2R5Lm5hbWUgfSksXG4gICAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKFxuICAgICAgICAgICAgICBEYXRlLm5vdygpICsgKG9wdGlvbnMuZXhwaXJlc0luIHx8IDYwICogNSkgKiAxZTNcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9tYWdpYy1saW5rL3ZlcmlmeT90b2tlbj0ke3ZlcmlmaWNhdGlvblRva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgICAgICAgYXdhaXQgb3B0aW9ucy5zZW5kTWFnaWNMaW5rKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICB0b2tlbjogdmVyaWZpY2F0aW9uVG9rZW5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgbWFnaWNMaW5rVmVyaWZ5OiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL21hZ2ljLWxpbmsvdmVyaWZ5XCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmaWNhdGlvbiB0b2tlblwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVSTCB0byByZWRpcmVjdCBhZnRlciBtYWdpYyBsaW5rIHZlcmlmaWNhdGlvbiwgaWYgbm90IHByb3ZpZGVkIHdpbGwgcmV0dXJuIHNlc3Npb25cIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgICAgICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmeSBtYWdpYyBsaW5rXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvU2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgeyB0b2tlbiwgY2FsbGJhY2tVUkwgfSA9IGN0eC5xdWVyeTtcbiAgICAgICAgICBjb25zdCB0b1JlZGlyZWN0VG8gPSBjYWxsYmFja1VSTD8uc3RhcnRzV2l0aChcImh0dHBcIikgPyBjYWxsYmFja1VSTCA6IGNhbGxiYWNrVVJMID8gYCR7Y3R4LmNvbnRleHQub3B0aW9ucy5iYXNlVVJMfSR7Y2FsbGJhY2tVUkx9YCA6IGN0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTDtcbiAgICAgICAgICBjb25zdCB0b2tlblZhbHVlID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZSh0b2tlbik7XG4gICAgICAgICAgaWYgKCF0b2tlblZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7dG9SZWRpcmVjdFRvfT9lcnJvcj1JTlZBTElEX1RPS0VOYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0b2tlblZhbHVlLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHRva2VuVmFsdWUuaWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7dG9SZWRpcmVjdFRvfT9lcnJvcj1FWFBJUkVEX1RPS0VOYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIHRva2VuVmFsdWUuaWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHsgZW1haWwsIG5hbWUgfSA9IEpTT04ucGFyc2UodG9rZW5WYWx1ZS52YWx1ZSk7XG4gICAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKS50aGVuKChyZXMpID0+IHJlcz8udXNlcik7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICBpZiAoIW9wdGlvbnMuZGlzYWJsZVNpZ25VcCkge1xuICAgICAgICAgICAgICBjb25zdCBuZXdVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVVzZXIoe1xuICAgICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSB8fCBlbWFpbFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdXNlciA9IG5ld1VzZXI7XG4gICAgICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgICAgICAgICAgIGAke3RvUmVkaXJlY3RUb30/ZXJyb3I9ZmFpbGVkX3RvX2NyZWF0ZV91c2VyYFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHt0b1JlZGlyZWN0VG99P2Vycm9yPWZhaWxlZF90b19jcmVhdGVfdXNlcmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXVzZXIuZW1haWxWZXJpZmllZCkge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIodXNlci5pZCwge1xuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgIGN0eC5oZWFkZXJzXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgICAgICAgYCR7dG9SZWRpcmVjdFRvfT9lcnJvcj1mYWlsZWRfdG9fY3JlYXRlX3Nlc3Npb25gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIWNhbGxiYWNrVVJMKSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY2FsbGJhY2tVUkwpO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICByYXRlTGltaXQ6IFtcbiAgICAgIHtcbiAgICAgICAgcGF0aE1hdGNoZXIocGF0aCkge1xuICAgICAgICAgIHJldHVybiBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi1pbi9tYWdpYy1saW5rXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9tYWdpYy1saW5rL3ZlcmlmeVwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgd2luZG93OiBvcHRpb25zLnJhdGVMaW1pdD8ud2luZG93IHx8IDYwLFxuICAgICAgICBtYXg6IG9wdGlvbnMucmF0ZUxpbWl0Py5tYXggfHwgNVxuICAgICAgfVxuICAgIF1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IG1hZ2ljTGluayB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   organization: () => (/* binding */ organization)\n/* harmony export */ });\n/* harmony import */ var _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-GBLEGHZW.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-HVHN3Y2L.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\n\n\n// src/utils/shim.ts\nvar shimContext = (originalObject, newContext) => {\n  const shimmedObj = {};\n  for (const [key, value] of Object.entries(originalObject)) {\n    shimmedObj[key] = (ctx) => {\n      return value({\n        ...ctx,\n        context: {\n          ...newContext,\n          ...ctx.context\n        }\n      });\n    };\n    shimmedObj[key].path = value.path;\n    shimmedObj[key].method = value.method;\n    shimmedObj[key].options = value.options;\n    shimmedObj[key].headers = value.headers;\n  }\n  return shimmedObj;\n};\n\n// src/plugins/organization/adapter.ts\nvar getOrgAdapter = (context, options) => {\n  const adapter = context.adapter;\n  return {\n    findOrganizationBySlug: async (slug) => {\n      const organization2 = await adapter.findOne({\n        model: \"organization\",\n        where: [\n          {\n            field: \"slug\",\n            value: slug\n          }\n        ]\n      });\n      return organization2;\n    },\n    createOrganization: async (data) => {\n      const organization2 = await adapter.create({\n        model: \"organization\",\n        data: {\n          ...data.organization,\n          metadata: data.organization.metadata ? JSON.stringify(data.organization.metadata) : void 0\n        }\n      });\n      const member = await adapter.create({\n        model: \"member\",\n        data: {\n          organizationId: organization2.id,\n          userId: data.user.id,\n          createdAt: /* @__PURE__ */ new Date(),\n          role: options?.creatorRole || \"owner\"\n        }\n      });\n      return {\n        ...organization2,\n        metadata: organization2.metadata ? JSON.parse(organization2.metadata) : void 0,\n        members: [\n          {\n            ...member,\n            user: {\n              id: data.user.id,\n              name: data.user.name,\n              email: data.user.email,\n              image: data.user.image\n            }\n          }\n        ]\n      };\n    },\n    findMemberByEmail: async (data) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"email\",\n            value: data.email\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const member = await adapter.findOne({\n        model: \"member\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: data.organizationId\n          },\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!member) {\n        return null;\n      }\n      return {\n        ...member,\n        user: {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          image: user.image\n        }\n      };\n    },\n    findMemberByOrgId: async (data) => {\n      const [member, user] = await Promise.all([\n        await adapter.findOne({\n          model: \"member\",\n          where: [\n            {\n              field: \"userId\",\n              value: data.userId\n            },\n            {\n              field: \"organizationId\",\n              value: data.organizationId\n            }\n          ]\n        }),\n        await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              field: \"id\",\n              value: data.userId\n            }\n          ]\n        })\n      ]);\n      if (!user || !member) {\n        return null;\n      }\n      return {\n        ...member,\n        user: {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          image: user.image\n        }\n      };\n    },\n    findMemberById: async (memberId) => {\n      const member = await adapter.findOne({\n        model: \"member\",\n        where: [\n          {\n            field: \"id\",\n            value: memberId\n          }\n        ]\n      });\n      if (!member) {\n        return null;\n      }\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: member.userId\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      return {\n        ...member,\n        user: {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          image: user.image\n        }\n      };\n    },\n    createMember: async (data) => {\n      const member = await adapter.create({\n        model: \"member\",\n        data\n      });\n      return member;\n    },\n    updateMember: async (memberId, role2) => {\n      const member = await adapter.update({\n        model: \"member\",\n        where: [\n          {\n            field: \"id\",\n            value: memberId\n          }\n        ],\n        update: {\n          role: role2\n        }\n      });\n      return member;\n    },\n    deleteMember: async (memberId) => {\n      const member = await adapter.delete({\n        model: \"member\",\n        where: [\n          {\n            field: \"id\",\n            value: memberId\n          }\n        ]\n      });\n      return member;\n    },\n    updateOrganization: async (organizationId, data) => {\n      const organization2 = await adapter.update({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationId\n          }\n        ],\n        update: {\n          ...data,\n          metadata: typeof data.metadata === \"object\" ? JSON.stringify(data.metadata) : data.metadata\n        }\n      });\n      if (!organization2) {\n        return null;\n      }\n      return {\n        ...organization2,\n        metadata: organization2.metadata ? (0,_chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_2__.parser_default)(organization2.metadata) : void 0\n      };\n    },\n    deleteOrganization: async (organizationId) => {\n      await adapter.delete({\n        model: \"member\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: organizationId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: organizationId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationId\n          }\n        ]\n      });\n      return organizationId;\n    },\n    setActiveOrganization: async (sessionToken, organizationId) => {\n      const session = await context.internalAdapter.updateSession(\n        sessionToken,\n        {\n          activeOrganizationId: organizationId\n        }\n      );\n      return session;\n    },\n    findOrganizationById: async (organizationId) => {\n      const organization2 = await adapter.findOne({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationId\n          }\n        ]\n      });\n      return organization2;\n    },\n    /**\n     * @requires db\n     */\n    findFullOrganization: async ({\n      organizationId,\n      isSlug\n    }) => {\n      const org = await adapter.findOne({\n        model: \"organization\",\n        where: [{ field: isSlug ? \"slug\" : \"id\", value: organizationId }]\n      });\n      if (!org) {\n        return null;\n      }\n      const [invitations, members] = await Promise.all([\n        adapter.findMany({\n          model: \"invitation\",\n          where: [{ field: \"organizationId\", value: org.id }]\n        }),\n        adapter.findMany({\n          model: \"member\",\n          where: [{ field: \"organizationId\", value: org.id }]\n        })\n      ]);\n      if (!org) return null;\n      const userIds = members.map((member) => member.userId);\n      const users = await adapter.findMany({\n        model: \"user\",\n        where: [{ field: \"id\", value: userIds, operator: \"in\" }]\n      });\n      const userMap = new Map(users.map((user) => [user.id, user]));\n      const membersWithUsers = members.map((member) => {\n        const user = userMap.get(member.userId);\n        if (!user) {\n          throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_6__.BetterAuthError(\n            \"Unexpected error: User not found for member\"\n          );\n        }\n        return {\n          ...member,\n          user: {\n            id: user.id,\n            name: user.name,\n            email: user.email,\n            image: user.image\n          }\n        };\n      });\n      return {\n        ...org,\n        invitations,\n        members: membersWithUsers\n      };\n    },\n    listOrganizations: async (userId) => {\n      const members = await adapter.findMany({\n        model: \"member\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      if (!members || members.length === 0) {\n        return [];\n      }\n      const organizationIds = members.map((member) => member.organizationId);\n      const organizations = await adapter.findMany({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return organizations;\n    },\n    createInvitation: async ({\n      invitation,\n      user\n    }) => {\n      const defaultExpiration = 1e3 * 60 * 60 * 48;\n      const expiresAt = (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_5__.getDate)(\n        options?.invitationExpiresIn || defaultExpiration\n      );\n      const invite = await adapter.create({\n        model: \"invitation\",\n        data: {\n          email: invitation.email,\n          role: invitation.role,\n          organizationId: invitation.organizationId,\n          status: \"pending\",\n          expiresAt,\n          inviterId: user.id\n        }\n      });\n      return invite;\n    },\n    findInvitationById: async (id) => {\n      const invitation = await adapter.findOne({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n      return invitation;\n    },\n    findPendingInvitation: async (data) => {\n      const invitation = await adapter.findMany({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"email\",\n            value: data.email\n          },\n          {\n            field: \"organizationId\",\n            value: data.organizationId\n          },\n          {\n            field: \"status\",\n            value: \"pending\"\n          }\n        ]\n      });\n      return invitation.filter(\n        (invite) => new Date(invite.expiresAt) > /* @__PURE__ */ new Date()\n      );\n    },\n    updateInvitation: async (data) => {\n      const invitation = await adapter.update({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"id\",\n            value: data.invitationId\n          }\n        ],\n        update: {\n          status: data.status\n        }\n      });\n      return invitation;\n    }\n  };\n};\nvar orgMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  return {};\n});\nvar orgSessionMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(\n  {\n    use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.sessionMiddleware]\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    return {\n      session\n    };\n  }\n);\nvar role = zod__WEBPACK_IMPORTED_MODULE_8__.z.string();\nvar invitationStatus = zod__WEBPACK_IMPORTED_MODULE_8__.z[\"enum\"]([\"pending\", \"accepted\", \"rejected\", \"canceled\"]).default(\"pending\");\nzod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().default(_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId),\n  name: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  slug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  logo: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().nullish(),\n  metadata: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string()).or(zod__WEBPACK_IMPORTED_MODULE_8__.z.string().transform((v) => JSON.parse(v))).nullish(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_8__.z.date()\n});\nzod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().default(_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId),\n  organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  role,\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_8__.z.date()\n});\nzod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().default(_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId),\n  organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  email: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  role,\n  status: invitationStatus,\n  /**\n   * The id of the user who invited the user.\n   */\n  inviterId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_8__.z.date()\n});\n\n// src/plugins/organization/error-codes.ts\nvar ORGANIZATION_ERROR_CODES = {\n  YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_ORGANIZATION: \"You are not allowed to create a new organization\",\n  YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_ORGANIZATIONS: \"You have reached the maximum number of organizations\",\n  ORGANIZATION_ALREADY_EXISTS: \"Organization already exists\",\n  ORGANIZATION_NOT_FOUND: \"Organization not found\",\n  USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION: \"User is not a member of the organization\",\n  YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_ORGANIZATION: \"You are not allowed to update this organization\",\n  YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_ORGANIZATION: \"You are not allowed to delete this organization\",\n  NO_ACTIVE_ORGANIZATION: \"No active organization\",\n  USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION: \"User is already a member of this organization\",\n  MEMBER_NOT_FOUND: \"Member not found\",\n  ROLE_NOT_FOUND: \"Role not found\",\n  YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER: \"You cannot leave the organization as the only owner\",\n  YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_MEMBER: \"You are not allowed to delete this member\",\n  YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION: \"You are not allowed to invite users to this organization\",\n  USER_IS_ALREADY_INVITED_TO_THIS_ORGANIZATION: \"User is already invited to this organization\",\n  INVITATION_NOT_FOUND: \"Invitation not found\",\n  YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION: \"You are not the recipient of the invitation\",\n  YOU_ARE_NOT_ALLOWED_TO_CANCEL_THIS_INVITATION: \"You are not allowed to cancel this invitation\",\n  INVITER_IS_NO_LONGER_A_MEMBER_OF_THE_ORGANIZATION: \"Inviter is no longer a member of the organization\",\n  YOU_ARE_NOT_ALLOWED_TO_INVITE_USER_WITH_THIS_ROLE: \"you are not allowed to invite user with this role\"\n};\n\n// src/plugins/organization/routes/crud-invites.ts\nvar createInvitation = (option) => (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/invite-member\",\n  {\n    method: \"POST\",\n    use: [orgMiddleware, orgSessionMiddleware],\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The email address of the user to invite\"\n      }),\n      role: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The role to assign to the user\"\n      }),\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization ID to invite the user to\"\n      }).optional(),\n      resend: zod__WEBPACK_IMPORTED_MODULE_8__.z.boolean({\n        description: \"Resend the invitation email, if the user is already invited\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Invite a user to an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\"\n                    },\n                    email: {\n                      type: \"string\"\n                    },\n                    role: {\n                      type: \"string\"\n                    },\n                    organizationId: {\n                      type: \"string\"\n                    },\n                    inviterId: {\n                      type: \"string\"\n                    },\n                    status: {\n                      type: \"string\"\n                    },\n                    expiresAt: {\n                      type: \"string\"\n                    }\n                  },\n                  required: [\n                    \"id\",\n                    \"email\",\n                    \"role\",\n                    \"organizationId\",\n                    \"inviterId\",\n                    \"status\",\n                    \"expiresAt\"\n                  ]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.orgOptions.sendInvitationEmail) {\n      ctx.context.logger.warn(\n        \"Invitation email is not enabled. Pass `sendInvitationEmail` to the plugin options to enable it.\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: \"Invitation email is not enabled\"\n      });\n    }\n    const session = ctx.context.session;\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ROLE_NOT_FOUND\n      });\n    }\n    const canInvite = role2.authorize({\n      invitation: [\"create\"]\n    });\n    if (canInvite.error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION\n      });\n    }\n    const creatorRole = ctx.context.orgOptions.creatorRole || \"owner\";\n    if (member.role !== creatorRole && ctx.body.role === creatorRole) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_INVITE_USER_WITH_THIS_ROLE\n      });\n    }\n    const alreadyMember = await adapter.findMemberByEmail({\n      email: ctx.body.email,\n      organizationId\n    });\n    if (alreadyMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION\n      });\n    }\n    const alreadyInvited = await adapter.findPendingInvitation({\n      email: ctx.body.email,\n      organizationId\n    });\n    if (alreadyInvited.length && !ctx.body.resend) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_ALREADY_INVITED_TO_THIS_ORGANIZATION\n      });\n    }\n    const invitation = await adapter.createInvitation({\n      invitation: {\n        role: ctx.body.role,\n        email: ctx.body.email,\n        organizationId\n      },\n      user: session.user\n    });\n    const organization2 = await adapter.findOrganizationById(organizationId);\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    await ctx.context.orgOptions.sendInvitationEmail?.(\n      {\n        id: invitation.id,\n        role: invitation.role,\n        email: invitation.email.toLowerCase(),\n        organization: organization2,\n        inviter: {\n          ...member,\n          user: session.user\n        }\n      },\n      ctx.request\n    );\n    return ctx.json(invitation);\n  }\n);\nvar acceptInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/accept-invitation\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      invitationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to accept\"\n      })\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Accept an invitation to an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    invitation: {\n                      type: \"object\"\n                    },\n                    member: {\n                      type: \"object\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.body.invitationId);\n    if (!invitation || invitation.expiresAt < /* @__PURE__ */ new Date() || invitation.status !== \"pending\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.INVITATION_NOT_FOUND\n      });\n    }\n    if (invitation.email !== session.user.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION\n      });\n    }\n    const acceptedI = await adapter.updateInvitation({\n      invitationId: ctx.body.invitationId,\n      status: \"accepted\"\n    });\n    const member = await adapter.createMember({\n      organizationId: invitation.organizationId,\n      userId: session.user.id,\n      role: invitation.role,\n      createdAt: /* @__PURE__ */ new Date()\n    });\n    await adapter.setActiveOrganization(\n      session.session.token,\n      invitation.organizationId\n    );\n    if (!acceptedI) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.INVITATION_NOT_FOUND\n        }\n      });\n    }\n    return ctx.json({\n      invitation: acceptedI,\n      member\n    });\n  }\n);\nvar rejectInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/reject-invitation\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      invitationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to reject\"\n      })\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Reject an invitation to an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    invitation: {\n                      type: \"object\"\n                    },\n                    member: {\n                      type: \"null\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.body.invitationId);\n    if (!invitation || invitation.expiresAt < /* @__PURE__ */ new Date() || invitation.status !== \"pending\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: \"Invitation not found!\"\n      });\n    }\n    if (invitation.email !== session.user.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION\n      });\n    }\n    const rejectedI = await adapter.updateInvitation({\n      invitationId: ctx.body.invitationId,\n      status: \"rejected\"\n    });\n    return ctx.json({\n      invitation: rejectedI,\n      member: null\n    });\n  }\n);\nvar cancelInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/cancel-invitation\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      invitationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to cancel\"\n      })\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    openapi: {\n      description: \"Cancel an invitation to an organization\",\n      responses: {\n        \"200\": {\n          description: \"Success\",\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  invitation: {\n                    type: \"object\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.body.invitationId);\n    if (!invitation) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.INVITATION_NOT_FOUND\n      });\n    }\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId: invitation.organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const canCancel = ctx.context.roles[member.role].authorize({\n      invitation: [\"cancel\"]\n    });\n    if (canCancel.error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CANCEL_THIS_INVITATION\n      });\n    }\n    const canceledI = await adapter.updateInvitation({\n      invitationId: ctx.body.invitationId,\n      status: \"canceled\"\n    });\n    return ctx.json(canceledI);\n  }\n);\nvar getInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/get-invitation\",\n  {\n    method: \"GET\",\n    use: [orgMiddleware],\n    requireHeaders: true,\n    query: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to get\"\n      })\n    }),\n    metadata: {\n      openapi: {\n        description: \"Get an invitation by ID\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\"\n                    },\n                    email: {\n                      type: \"string\"\n                    },\n                    role: {\n                      type: \"string\"\n                    },\n                    organizationId: {\n                      type: \"string\"\n                    },\n                    inviterId: {\n                      type: \"string\"\n                    },\n                    status: {\n                      type: \"string\"\n                    },\n                    expiresAt: {\n                      type: \"string\"\n                    },\n                    organizationName: {\n                      type: \"string\"\n                    },\n                    organizationSlug: {\n                      type: \"string\"\n                    },\n                    inviterEmail: {\n                      type: \"string\"\n                    }\n                  },\n                  required: [\n                    \"id\",\n                    \"email\",\n                    \"role\",\n                    \"organizationId\",\n                    \"inviterId\",\n                    \"status\",\n                    \"expiresAt\",\n                    \"organizationName\",\n                    \"organizationSlug\",\n                    \"inviterEmail\"\n                  ]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n        message: \"Not authenticated\"\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.query.id);\n    if (!invitation || invitation.status !== \"pending\" || invitation.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: \"Invitation not found!\"\n      });\n    }\n    if (invitation.email !== session.user.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION\n      });\n    }\n    const organization2 = await adapter.findOrganizationById(\n      invitation.organizationId\n    );\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    const member = await adapter.findMemberByOrgId({\n      userId: invitation.inviterId,\n      organizationId: invitation.organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.INVITER_IS_NO_LONGER_A_MEMBER_OF_THE_ORGANIZATION\n      });\n    }\n    return ctx.json({\n      ...invitation,\n      organizationName: organization2.name,\n      organizationSlug: organization2.slug,\n      inviterEmail: member.user.email\n    });\n  }\n);\nvar addMember = () => (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/add-member\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      userId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      role: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional()\n    }),\n    use: [orgMiddleware],\n    metadata: {\n      SERVER_ONLY: true\n    }\n  },\n  async (ctx) => {\n    const session = ctx.body.userId ? await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(ctx).catch((e) => null) : null;\n    const orgId = ctx.body.organizationId || session?.session.activeOrganizationId;\n    if (!orgId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const user = await ctx.context.internalAdapter.findUserById(\n      ctx.body.userId\n    );\n    if (!user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.BASE_ERROR_CODES.USER_NOT_FOUND\n      });\n    }\n    const alreadyMember = await adapter.findMemberByEmail({\n      email: user.email,\n      organizationId: orgId\n    });\n    if (alreadyMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION\n      });\n    }\n    const createdMember = await adapter.createMember({\n      id: (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId)(),\n      organizationId: orgId,\n      userId: user.id,\n      role: ctx.body.role,\n      createdAt: /* @__PURE__ */ new Date()\n    });\n    return ctx.json(createdMember);\n  }\n);\nvar removeMember = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/remove-member\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      memberIdOrEmail: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID or email of the member to remove\"\n      }),\n      /**\n       * If not provided, the active organization will be used\n       */\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the organization to remove the member from. If not provided, the active organization will be used\"\n      }).optional()\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Remove a member from an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    member: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        userId: {\n                          type: \"string\"\n                        },\n                        organizationId: {\n                          type: \"string\"\n                        },\n                        role: {\n                          type: \"string\"\n                        }\n                      },\n                      required: [\"id\", \"userId\", \"organizationId\", \"role\"]\n                    }\n                  },\n                  required: [\"member\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ROLE_NOT_FOUND\n      });\n    }\n    const isLeaving = session.user.email === ctx.body.memberIdOrEmail || member.id === ctx.body.memberIdOrEmail;\n    const isOwnerLeaving = isLeaving && member.role === (ctx.context.orgOptions?.creatorRole || \"owner\");\n    if (isOwnerLeaving) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER\n      });\n    }\n    const canDeleteMember = isLeaving || role2.authorize({\n      member: [\"delete\"]\n    }).success;\n    if (!canDeleteMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_MEMBER\n      });\n    }\n    let existing = null;\n    if (ctx.body.memberIdOrEmail.includes(\"@\")) {\n      existing = await adapter.findMemberByEmail({\n        email: ctx.body.memberIdOrEmail,\n        organizationId\n      });\n    } else {\n      existing = await adapter.findMemberById(ctx.body.memberIdOrEmail);\n    }\n    if (existing?.organizationId !== organizationId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    await adapter.deleteMember(existing.id);\n    if (session.user.id === existing.userId && session.session.activeOrganizationId === existing.organizationId) {\n      await adapter.setActiveOrganization(session.session.token, null);\n    }\n    return ctx.json({\n      member: existing\n    });\n  }\n);\nvar updateMemberRole = (option) => (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/update-member-role\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      role: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      memberId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      /**\n       * If not provided, the active organization will be used\n       */\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional()\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Update the role of a member in an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    member: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        userId: {\n                          type: \"string\"\n                        },\n                        organizationId: {\n                          type: \"string\"\n                        },\n                        role: {\n                          type: \"string\"\n                        }\n                      },\n                      required: [\"id\", \"userId\", \"organizationId\", \"role\"]\n                    }\n                  },\n                  required: [\"member\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n        }\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.ROLE_NOT_FOUND\n        }\n      });\n    }\n    const canUpdateMember = role2.authorize({\n      member: [\"update\"]\n    }).error || ctx.body.role === \"owner\" && member.role !== \"owner\";\n    if (canUpdateMember) {\n      return ctx.json(null, {\n        body: {\n          message: \"You are not allowed to update this member\"\n        },\n        status: 403\n      });\n    }\n    const updatedMember = await adapter.updateMember(\n      ctx.body.memberId,\n      ctx.body.role\n    );\n    if (!updatedMember) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n        }\n      });\n    }\n    return ctx.json(updatedMember);\n  }\n);\nvar getActiveMember = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/get-active-member\",\n  {\n    method: \"GET\",\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Get the active member in the organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\"\n                    },\n                    userId: {\n                      type: \"string\"\n                    },\n                    organizationId: {\n                      type: \"string\"\n                    },\n                    role: {\n                      type: \"string\"\n                    }\n                  },\n                  required: [\"id\", \"userId\", \"organizationId\", \"role\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n        }\n      });\n    }\n    return ctx.json(member);\n  }\n);\nvar leaveOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/leave\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string()\n    }),\n    use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.sessionMiddleware, orgMiddleware]\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId: ctx.body.organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const isOwnerLeaving = member.role === (ctx.context.orgOptions?.creatorRole || \"owner\");\n    if (isOwnerLeaving) {\n      const members = await ctx.context.adapter.findMany({\n        model: \"member\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: ctx.body.organizationId\n          }\n        ]\n      });\n      const owners = members.filter(\n        (member2) => member2.role === (ctx.context.orgOptions?.creatorRole || \"owner\")\n      );\n      if (owners.length <= 1) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: ORGANIZATION_ERROR_CODES.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER\n        });\n      }\n    }\n    await adapter.deleteMember(member.id);\n    if (session.session.activeOrganizationId === ctx.body.organizationId) {\n      await adapter.setActiveOrganization(session.session.token, null);\n    }\n    return ctx.json(member);\n  }\n);\nvar createOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/create\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      name: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The name of the organization\"\n      }),\n      slug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The slug of the organization\"\n      }),\n      userId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The user id of the organization creator. If not provided, the current user will be used. Should only be used by admins or when called by the server.\"\n      }).optional(),\n      logo: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The logo of the organization\"\n      }).optional(),\n      metadata: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string(), zod__WEBPACK_IMPORTED_MODULE_8__.z.any(), {\n        description: \"The metadata of the organization\"\n      }).optional()\n    }),\n    use: [orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Create an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The organization that was created\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(ctx);\n    if (!session && (ctx.request || ctx.headers)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\");\n    }\n    let user = session?.user || null;\n    if (!user) {\n      if (!ctx.body.userId) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\");\n      }\n      user = await ctx.context.internalAdapter.findUserById(ctx.body.userId);\n    }\n    if (!user) {\n      return ctx.json(null, {\n        status: 401\n      });\n    }\n    const options = ctx.context.orgOptions;\n    const canCreateOrg = typeof options?.allowUserToCreateOrganization === \"function\" ? await options.allowUserToCreateOrganization(user) : options?.allowUserToCreateOrganization === void 0 ? true : options.allowUserToCreateOrganization;\n    if (!canCreateOrg) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_ORGANIZATION\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, options);\n    const userOrganizations = await adapter.listOrganizations(user.id);\n    const hasReachedOrgLimit = typeof options.organizationLimit === \"number\" ? userOrganizations.length >= options.organizationLimit : typeof options.organizationLimit === \"function\" ? await options.organizationLimit(user) : false;\n    if (hasReachedOrgLimit) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_ORGANIZATIONS\n      });\n    }\n    const existingOrganization = await adapter.findOrganizationBySlug(\n      ctx.body.slug\n    );\n    if (existingOrganization) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_ALREADY_EXISTS\n      });\n    }\n    const organization2 = await adapter.createOrganization({\n      organization: {\n        id: (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId)(),\n        slug: ctx.body.slug,\n        name: ctx.body.name,\n        logo: ctx.body.logo,\n        createdAt: /* @__PURE__ */ new Date(),\n        metadata: ctx.body.metadata\n      },\n      user\n    });\n    if (ctx.context.session) {\n      await adapter.setActiveOrganization(\n        ctx.context.session.session.token,\n        organization2.id\n      );\n    }\n    return ctx.json(organization2);\n  }\n);\nvar updateOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/update\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      data: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n        name: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The name of the organization\"\n        }).optional(),\n        slug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The slug of the organization\"\n        }).optional(),\n        logo: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The logo of the organization\"\n        }).optional(),\n        metadata: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string(), zod__WEBPACK_IMPORTED_MODULE_8__.z.any(), {\n          description: \"The metadata of the organization\"\n        }).optional()\n      }).partial(),\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional()\n    }),\n    requireHeaders: true,\n    use: [orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Update an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The updated organization\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await ctx.context.getSession(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n        message: \"User not found\"\n      });\n    }\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n        }\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: \"Role not found!\"\n        }\n      });\n    }\n    const canUpdateOrg = role2.authorize({\n      organization: [\"update\"]\n    });\n    if (canUpdateOrg.error) {\n      return ctx.json(null, {\n        body: {\n          message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_ORGANIZATION\n        },\n        status: 403\n      });\n    }\n    const updatedOrg = await adapter.updateOrganization(\n      organizationId,\n      ctx.body.data\n    );\n    return ctx.json(updatedOrg);\n  }\n);\nvar deleteOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/delete\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization id to delete\"\n      })\n    }),\n    requireHeaders: true,\n    use: [orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Delete an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"string\",\n                  description: \"The organization id that was deleted\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await ctx.context.getSession(ctx);\n    if (!session) {\n      return ctx.json(null, {\n        status: 401\n      });\n    }\n    const organizationId = ctx.body.organizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n        }\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: \"Role not found!\"\n        }\n      });\n    }\n    const canDeleteOrg = role2.authorize({\n      organization: [\"delete\"]\n    });\n    if (canDeleteOrg.error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_ORGANIZATION\n      });\n    }\n    if (organizationId === session.session.activeOrganizationId) {\n      await adapter.setActiveOrganization(session.session.token, null);\n    }\n    const option = ctx.context.orgOptions.organizationDeletion;\n    if (option?.disabled) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\");\n    }\n    const org = await adapter.findOrganizationById(organizationId);\n    if (!org) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\");\n    }\n    if (option?.beforeDelete) {\n      await option.beforeDelete({\n        organization: org,\n        user: session.user\n      });\n    }\n    await adapter.deleteOrganization(organizationId);\n    if (option?.afterDelete) {\n      await option.afterDelete({\n        organization: org,\n        user: session.user\n      });\n    }\n    return ctx.json(org);\n  }\n);\nvar getFullOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/get-full-organization\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_8__.z.optional(\n      zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n        organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The organization id to get\"\n        }).optional(),\n        organizationSlug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The organization slug to get\"\n        }).optional()\n      })\n    ),\n    requireHeaders: true,\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Get the full organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The organization\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = ctx.query?.organizationSlug || ctx.query?.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 200\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const organization2 = await adapter.findFullOrganization({\n      organizationId,\n      isSlug: !!ctx.query?.organizationSlug\n    });\n    const isMember = organization2?.members.find(\n      (member) => member.userId === session.user.id\n    );\n    if (!isMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n      });\n    }\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    return ctx.json(organization2);\n  }\n);\nvar setActiveOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/set-active\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization id to set as active. It can be null to unset the active organization\"\n      }).nullable().optional(),\n      organizationSlug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization slug to set as active. It can be null to unset the active organization if organizationId is not provided\"\n      }).optional()\n    }),\n    use: [orgSessionMiddleware, orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Set the active organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The organization\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const session = ctx.context.session;\n    let organizationId = ctx.body.organizationSlug || ctx.body.organizationId;\n    if (organizationId === null) {\n      const sessionOrgId = session.session.activeOrganizationId;\n      if (!sessionOrgId) {\n        return ctx.json(null);\n      }\n      const updatedSession2 = await adapter.setActiveOrganization(\n        session.session.token,\n        null\n      );\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n        session: updatedSession2,\n        user: session.user\n      });\n      return ctx.json(null);\n    }\n    if (!organizationId) {\n      const sessionOrgId = session.session.activeOrganizationId;\n      if (!sessionOrgId) {\n        return ctx.json(null);\n      }\n      organizationId = sessionOrgId;\n    }\n    const organization2 = await adapter.findFullOrganization({\n      organizationId,\n      isSlug: !!ctx.body.organizationSlug\n    });\n    const isMember = organization2?.members.find(\n      (member) => member.userId === session.user.id\n    );\n    if (!isMember) {\n      await adapter.setActiveOrganization(session.session.token, null);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n      });\n    }\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    const updatedSession = await adapter.setActiveOrganization(\n      session.session.token,\n      organization2.id\n    );\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n      session: updatedSession,\n      user: session.user\n    });\n    return ctx.json(organization2);\n  }\n);\nvar listOrganizations = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/list\",\n  {\n    method: \"GET\",\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"List all organizations\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    $ref: \"#/components/schemas/Organization\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const organizations = await adapter.listOrganizations(\n      ctx.context.session.user.id\n    );\n    return ctx.json(organizations);\n  }\n);\n\n// src/plugins/organization/organization.ts\nvar organization = (options) => {\n  const endpoints = {\n    createOrganization,\n    updateOrganization,\n    deleteOrganization,\n    setActiveOrganization,\n    getFullOrganization,\n    listOrganizations,\n    createInvitation: createInvitation(),\n    cancelInvitation,\n    acceptInvitation,\n    getInvitation,\n    rejectInvitation,\n    addMember: addMember(),\n    removeMember,\n    updateMemberRole: updateMemberRole(),\n    getActiveMember,\n    leaveOrganization\n  };\n  const roles = {\n    ..._chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_0__.defaultRoles,\n    ...options?.roles\n  };\n  const api = shimContext(endpoints, {\n    orgOptions: options || {},\n    roles,\n    getSession: async (context) => {\n      return await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(context);\n    }\n  });\n  return {\n    id: \"organization\",\n    endpoints: {\n      ...api,\n      hasPermission: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n        \"/organization/has-permission\",\n        {\n          method: \"POST\",\n          requireHeaders: true,\n          body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n            organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional(),\n            permission: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string(), zod__WEBPACK_IMPORTED_MODULE_8__.z.array(zod__WEBPACK_IMPORTED_MODULE_8__.z.string()))\n          }),\n          use: [orgSessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Check if the user has permission\",\n              requestBody: {\n                content: {\n                  \"application/json\": {\n                    schema: {\n                      type: \"object\",\n                      properties: {\n                        permission: {\n                          type: \"object\",\n                          description: \"The permission to check\"\n                        }\n                      },\n                      required: [\"permission\"]\n                    }\n                  }\n                }\n              },\n              responses: {\n                \"200\": {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          error: {\n                            type: \"string\"\n                          },\n                          success: {\n                            type: \"boolean\"\n                          }\n                        },\n                        required: [\"success\"]\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!ctx.body.permission || Object.keys(ctx.body.permission).length > 1) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: \"invalid permission check. you can only check one resource permission at a time.\"\n            });\n          }\n          const activeOrganizationId = ctx.body.organizationId || ctx.context.session.session.activeOrganizationId;\n          if (!activeOrganizationId) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n            });\n          }\n          const adapter = getOrgAdapter(ctx.context);\n          const member = await adapter.findMemberByOrgId({\n            userId: ctx.context.session.user.id,\n            organizationId: activeOrganizationId\n          });\n          if (!member) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n              message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n            });\n          }\n          const role2 = roles[member.role];\n          const result = role2.authorize(ctx.body.permission);\n          if (result.error) {\n            return ctx.json(\n              {\n                error: result.error,\n                success: false\n              },\n              {\n                status: 403\n              }\n            );\n          }\n          return ctx.json({\n            error: null,\n            success: true\n          });\n        }\n      )\n    },\n    schema: {\n      session: {\n        fields: {\n          activeOrganizationId: {\n            type: \"string\",\n            required: false,\n            fieldName: options?.schema?.session?.fields?.activeOrganizationId\n          }\n        }\n      },\n      organization: {\n        modelName: options?.schema?.organization?.modelName,\n        fields: {\n          name: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            fieldName: options?.schema?.organization?.fields?.name\n          },\n          slug: {\n            type: \"string\",\n            unique: true,\n            sortable: true,\n            fieldName: options?.schema?.organization?.fields?.slug\n          },\n          logo: {\n            type: \"string\",\n            required: false,\n            fieldName: options?.schema?.organization?.fields?.logo\n          },\n          createdAt: {\n            type: \"date\",\n            required: true,\n            fieldName: options?.schema?.organization?.fields?.createdAt\n          },\n          metadata: {\n            type: \"string\",\n            required: false,\n            fieldName: options?.schema?.organization?.fields?.metadata\n          }\n        }\n      },\n      member: {\n        modelName: options?.schema?.member?.modelName,\n        fields: {\n          organizationId: {\n            type: \"string\",\n            required: true,\n            references: {\n              model: \"organization\",\n              field: \"id\"\n            },\n            fieldName: options?.schema?.member?.fields?.organizationId\n          },\n          userId: {\n            type: \"string\",\n            required: true,\n            fieldName: options?.schema?.member?.fields?.userId,\n            references: {\n              model: \"user\",\n              field: \"id\"\n            }\n          },\n          role: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            defaultValue: \"member\",\n            fieldName: options?.schema?.member?.fields?.role\n          },\n          createdAt: {\n            type: \"date\",\n            required: true,\n            fieldName: options?.schema?.member?.fields?.createdAt\n          }\n        }\n      },\n      invitation: {\n        modelName: options?.schema?.invitation?.modelName,\n        fields: {\n          organizationId: {\n            type: \"string\",\n            required: true,\n            references: {\n              model: \"organization\",\n              field: \"id\"\n            },\n            fieldName: options?.schema?.invitation?.fields?.organizationId\n          },\n          email: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            fieldName: options?.schema?.invitation?.fields?.email\n          },\n          role: {\n            type: \"string\",\n            required: false,\n            sortable: true,\n            fieldName: options?.schema?.invitation?.fields?.role\n          },\n          status: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            defaultValue: \"pending\",\n            fieldName: options?.schema?.invitation?.fields?.status\n          },\n          expiresAt: {\n            type: \"date\",\n            required: true,\n            fieldName: options?.schema?.invitation?.fields?.expiresAt\n          },\n          inviterId: {\n            type: \"string\",\n            references: {\n              model: \"user\",\n              field: \"id\"\n            },\n            fieldName: options?.schema?.invitation?.fields?.inviterId,\n            required: true\n          }\n        }\n      }\n    },\n    $Infer: {\n      Organization: {},\n      Invitation: {},\n      Member: {},\n      ActiveOrganization: {}\n    },\n    $ERROR_CODES: ORGANIZATION_ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstMlJEQVYyVUIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFtRDtBQUNvRjtBQUNsRjtBQUNFO0FBQ047QUFDSDtBQUNRO0FBQ2Y7QUFDZjs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxrRUFBYztBQUN6RDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esa0JBQWtCLHNEQUFzRDtBQUN4RSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHdDQUF3QztBQUM1RCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLG9CQUFvQix3Q0FBd0M7QUFDNUQsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkNBQTZDO0FBQy9ELE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBZTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0JBQXdCLDJEQUFPO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix3RUFBb0I7QUFDeEM7QUFDQSxDQUFDO0FBQ0QsMkJBQTJCLHdFQUFvQjtBQUMvQztBQUNBLFVBQVUsaUVBQWlCO0FBQzNCLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcseUNBQVE7QUFDbkIsdUJBQXVCLDBDQUFNO0FBQzdCLHlDQUFRO0FBQ1IsTUFBTSx5Q0FBUSxXQUFXLDBEQUFVO0FBQ25DLFFBQVEseUNBQVE7QUFDaEIsUUFBUSx5Q0FBUTtBQUNoQixRQUFRLHlDQUFRO0FBQ2hCLFlBQVkseUNBQVEsQ0FBQyx5Q0FBUSxPQUFPLHlDQUFRO0FBQzVDLGFBQWEsdUNBQU07QUFDbkIsQ0FBQztBQUNELHlDQUFRO0FBQ1IsTUFBTSx5Q0FBUSxXQUFXLDBEQUFVO0FBQ25DLGtCQUFrQix5Q0FBUTtBQUMxQixVQUFVLHlDQUFRO0FBQ2xCO0FBQ0EsYUFBYSx1Q0FBTTtBQUNuQixDQUFDO0FBQ0QseUNBQVE7QUFDUixNQUFNLHlDQUFRLFdBQVcsMERBQVU7QUFDbkMsa0JBQWtCLHlDQUFRO0FBQzFCLFNBQVMseUNBQVE7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEseUNBQVE7QUFDckIsYUFBYSx1Q0FBTTtBQUNuQixDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxtQ0FBbUMsc0VBQWtCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixhQUFhLHlDQUFRO0FBQ3JCO0FBQ0EsT0FBTztBQUNQLFlBQVkseUNBQVE7QUFDcEI7QUFDQSxPQUFPO0FBQ1Asc0JBQXNCLHlDQUFRO0FBQzlCO0FBQ0EsT0FBTztBQUNQLGNBQWMsMENBQVM7QUFDdkI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzRUFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixvQkFBb0IseUNBQVE7QUFDNUI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSxVQUFVLHlDQUFRO0FBQ2xCLG9CQUFvQix5Q0FBUTtBQUM1QjtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHVCQUF1QixzRUFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixvQkFBb0IseUNBQVE7QUFDNUI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0VBQWtCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHlDQUFRO0FBQ25CLFVBQVUseUNBQVE7QUFDbEI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwwQkFBMEIscUVBQWlCO0FBQzNDO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHNCQUFzQixzRUFBa0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixjQUFjLHlDQUFRO0FBQ3RCLFlBQVkseUNBQVE7QUFDcEIsc0JBQXNCLHlDQUFRO0FBQzlCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLDRDQUE0QyxxRUFBaUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCLGlCQUFpQixnRUFBZ0I7QUFDakMsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxVQUFVLDhEQUFVO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixzRUFBa0I7QUFDckM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQix1QkFBdUIseUNBQVE7QUFDL0I7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHlDQUFRO0FBQzlCO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLG1DQUFtQyxzRUFBa0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixZQUFZLHlDQUFRO0FBQ3BCLGdCQUFnQix5Q0FBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IseUNBQVE7QUFDOUIsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isc0VBQWtCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzRUFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixzQkFBc0IseUNBQVE7QUFDOUIsS0FBSztBQUNMLFVBQVUsaUVBQWlCO0FBQzNCLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBUTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsc0VBQWtCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLFVBQVUseUNBQVE7QUFDbEIsWUFBWSx5Q0FBUTtBQUNwQjtBQUNBLE9BQU87QUFDUCxZQUFZLHlDQUFRO0FBQ3BCO0FBQ0EsT0FBTztBQUNQLGNBQWMseUNBQVE7QUFDdEI7QUFDQSxPQUFPO0FBQ1AsWUFBWSx5Q0FBUTtBQUNwQjtBQUNBLE9BQU87QUFDUCxnQkFBZ0IseUNBQVEsQ0FBQyx5Q0FBUSxJQUFJLHNDQUFLO0FBQzFDO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsMEJBQTBCLHFFQUFpQjtBQUMzQztBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBUTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFlBQVksOERBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsc0VBQWtCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLFVBQVUseUNBQVE7QUFDbEIsWUFBWSx5Q0FBUTtBQUNwQixjQUFjLHlDQUFRO0FBQ3RCO0FBQ0EsU0FBUztBQUNULGNBQWMseUNBQVE7QUFDdEI7QUFDQSxTQUFTO0FBQ1QsY0FBYyx5Q0FBUTtBQUN0QjtBQUNBLFNBQVM7QUFDVCxrQkFBa0IseUNBQVEsQ0FBQyx5Q0FBUSxJQUFJLHNDQUFLO0FBQzVDO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxzQkFBc0IseUNBQVE7QUFDOUIsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHNFQUFrQjtBQUMzQztBQUNBO0FBQ0E7QUFDQSxVQUFVLHlDQUFRO0FBQ2xCLHNCQUFzQix5Q0FBUTtBQUM5QjtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzRUFBa0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsV0FBVywyQ0FBVTtBQUNyQixNQUFNLHlDQUFRO0FBQ2Qsd0JBQXdCLHlDQUFRO0FBQ2hDO0FBQ0EsU0FBUztBQUNULDBCQUEwQix5Q0FBUTtBQUNsQztBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixzRUFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsVUFBVSx5Q0FBUTtBQUNsQixzQkFBc0IseUNBQVE7QUFDOUI7QUFDQSxPQUFPO0FBQ1Asd0JBQXdCLHlDQUFRO0FBQ2hDO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvRUFBZ0I7QUFDNUI7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG9FQUFnQjtBQUMxQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzRUFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyw0REFBWTtBQUNuQjtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBLG1CQUFtQixxRUFBaUI7QUFDcEM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsc0VBQWtCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLDRCQUE0Qix5Q0FBUTtBQUNwQyx3QkFBd0IseUNBQVEsQ0FBQyx5Q0FBUSxJQUFJLHdDQUFPLENBQUMseUNBQVE7QUFDN0QsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLHNCQUFzQjtBQUN0QixvQkFBb0I7QUFDcEIsZ0JBQWdCO0FBQ2hCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFd0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay0yUkRBVjJVQi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWZhdWx0Um9sZXMgfSBmcm9tICcuL2NodW5rLUdCTEVHSFpXLmpzJztcbmltcG9ydCB7IGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBzZXNzaW9uTWlkZGxld2FyZSwgY3JlYXRlQXV0aEVuZHBvaW50LCBnZXRTZXNzaW9uRnJvbUN0eCwgQkFTRV9FUlJPUl9DT0RFUyB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgcGFyc2VyX2RlZmF1bHQgfSBmcm9tICcuL2NodW5rLUhWSE4zWTJMLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlSWQgfSBmcm9tICcuL2NodW5rLUtMREZCTFlMLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vY2h1bmstVU5XQ1hLTVAuanMnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuLy8gc3JjL3V0aWxzL3NoaW0udHNcbnZhciBzaGltQ29udGV4dCA9IChvcmlnaW5hbE9iamVjdCwgbmV3Q29udGV4dCkgPT4ge1xuICBjb25zdCBzaGltbWVkT2JqID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKG9yaWdpbmFsT2JqZWN0KSkge1xuICAgIHNoaW1tZWRPYmpba2V5XSA9IChjdHgpID0+IHtcbiAgICAgIHJldHVybiB2YWx1ZSh7XG4gICAgICAgIC4uLmN0eCxcbiAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgIC4uLm5ld0NvbnRleHQsXG4gICAgICAgICAgLi4uY3R4LmNvbnRleHRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBzaGltbWVkT2JqW2tleV0ucGF0aCA9IHZhbHVlLnBhdGg7XG4gICAgc2hpbW1lZE9ialtrZXldLm1ldGhvZCA9IHZhbHVlLm1ldGhvZDtcbiAgICBzaGltbWVkT2JqW2tleV0ub3B0aW9ucyA9IHZhbHVlLm9wdGlvbnM7XG4gICAgc2hpbW1lZE9ialtrZXldLmhlYWRlcnMgPSB2YWx1ZS5oZWFkZXJzO1xuICB9XG4gIHJldHVybiBzaGltbWVkT2JqO1xufTtcblxuLy8gc3JjL3BsdWdpbnMvb3JnYW5pemF0aW9uL2FkYXB0ZXIudHNcbnZhciBnZXRPcmdBZGFwdGVyID0gKGNvbnRleHQsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgYWRhcHRlciA9IGNvbnRleHQuYWRhcHRlcjtcbiAgcmV0dXJuIHtcbiAgICBmaW5kT3JnYW5pemF0aW9uQnlTbHVnOiBhc3luYyAoc2x1ZykgPT4ge1xuICAgICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInNsdWdcIixcbiAgICAgICAgICAgIHZhbHVlOiBzbHVnXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBvcmdhbml6YXRpb24yO1xuICAgIH0sXG4gICAgY3JlYXRlT3JnYW5pemF0aW9uOiBhc3luYyAoZGF0YSkgPT4ge1xuICAgICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgbW9kZWw6IFwib3JnYW5pemF0aW9uXCIsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAuLi5kYXRhLm9yZ2FuaXphdGlvbixcbiAgICAgICAgICBtZXRhZGF0YTogZGF0YS5vcmdhbml6YXRpb24ubWV0YWRhdGEgPyBKU09OLnN0cmluZ2lmeShkYXRhLm9yZ2FuaXphdGlvbi5tZXRhZGF0YSkgOiB2b2lkIDBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IG9yZ2FuaXphdGlvbjIuaWQsXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXIuaWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByb2xlOiBvcHRpb25zPy5jcmVhdG9yUm9sZSB8fCBcIm93bmVyXCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5vcmdhbml6YXRpb24yLFxuICAgICAgICBtZXRhZGF0YTogb3JnYW5pemF0aW9uMi5tZXRhZGF0YSA/IEpTT04ucGFyc2Uob3JnYW5pemF0aW9uMi5tZXRhZGF0YSkgOiB2b2lkIDAsXG4gICAgICAgIG1lbWJlcnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5tZW1iZXIsXG4gICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgIGlkOiBkYXRhLnVzZXIuaWQsXG4gICAgICAgICAgICAgIG5hbWU6IGRhdGEudXNlci5uYW1lLFxuICAgICAgICAgICAgICBlbWFpbDogZGF0YS51c2VyLmVtYWlsLFxuICAgICAgICAgICAgICBpbWFnZTogZGF0YS51c2VyLmltYWdlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9O1xuICAgIH0sXG4gICAgZmluZE1lbWJlckJ5RW1haWw6IGFzeW5jIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCIsXG4gICAgICAgICAgICB2YWx1ZTogZGF0YS5lbWFpbFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJvcmdhbml6YXRpb25JZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGEub3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5tZW1iZXIsXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2VcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIGZpbmRNZW1iZXJCeU9yZ0lkOiBhc3luYyAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgW21lbWJlciwgdXNlcl0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBkYXRhLnVzZXJJZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwib3JnYW5pemF0aW9uSWRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGRhdGEub3JnYW5pemF0aW9uSWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pLFxuICAgICAgICBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZGF0YS51c2VySWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pXG4gICAgICBdKTtcbiAgICAgIGlmICghdXNlciB8fCAhbWVtYmVyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ubWVtYmVyLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kTWVtYmVyQnlJZDogYXN5bmMgKG1lbWJlcklkKSA9PiB7XG4gICAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IG1lbWJlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghbWVtYmVyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IG1lbWJlci51c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ubWVtYmVyLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBjcmVhdGVNZW1iZXI6IGFzeW5jIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICBkYXRhXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBtZW1iZXI7XG4gICAgfSxcbiAgICB1cGRhdGVNZW1iZXI6IGFzeW5jIChtZW1iZXJJZCwgcm9sZTIpID0+IHtcbiAgICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIudXBkYXRlKHtcbiAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBtZW1iZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgcm9sZTogcm9sZTJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWVtYmVyO1xuICAgIH0sXG4gICAgZGVsZXRlTWVtYmVyOiBhc3luYyAobWVtYmVySWQpID0+IHtcbiAgICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBtZW1iZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWVtYmVyO1xuICAgIH0sXG4gICAgdXBkYXRlT3JnYW5pemF0aW9uOiBhc3luYyAob3JnYW5pemF0aW9uSWQsIGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLnVwZGF0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogb3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgbWV0YWRhdGE6IHR5cGVvZiBkYXRhLm1ldGFkYXRhID09PSBcIm9iamVjdFwiID8gSlNPTi5zdHJpbmdpZnkoZGF0YS5tZXRhZGF0YSkgOiBkYXRhLm1ldGFkYXRhXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFvcmdhbml6YXRpb24yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ub3JnYW5pemF0aW9uMixcbiAgICAgICAgbWV0YWRhdGE6IG9yZ2FuaXphdGlvbjIubWV0YWRhdGEgPyBwYXJzZXJfZGVmYXVsdChvcmdhbml6YXRpb24yLm1ldGFkYXRhKSA6IHZvaWQgMFxuICAgICAgfTtcbiAgICB9LFxuICAgIGRlbGV0ZU9yZ2FuaXphdGlvbjogYXN5bmMgKG9yZ2FuaXphdGlvbklkKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcIm9yZ2FuaXphdGlvbklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogb3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJpbnZpdGF0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwib3JnYW5pemF0aW9uSWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBvcmdhbml6YXRpb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogb3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG9yZ2FuaXphdGlvbklkO1xuICAgIH0sXG4gICAgc2V0QWN0aXZlT3JnYW5pemF0aW9uOiBhc3luYyAoc2Vzc2lvblRva2VuLCBvcmdhbml6YXRpb25JZCkgPT4ge1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVNlc3Npb24oXG4gICAgICAgIHNlc3Npb25Ub2tlbixcbiAgICAgICAge1xuICAgICAgICAgIGFjdGl2ZU9yZ2FuaXphdGlvbklkOiBvcmdhbml6YXRpb25JZFxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfSxcbiAgICBmaW5kT3JnYW5pemF0aW9uQnlJZDogYXN5bmMgKG9yZ2FuaXphdGlvbklkKSA9PiB7XG4gICAgICBjb25zdCBvcmdhbml6YXRpb24yID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwib3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBvcmdhbml6YXRpb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gb3JnYW5pemF0aW9uMjtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIEByZXF1aXJlcyBkYlxuICAgICAqL1xuICAgIGZpbmRGdWxsT3JnYW5pemF0aW9uOiBhc3luYyAoe1xuICAgICAgb3JnYW5pemF0aW9uSWQsXG4gICAgICBpc1NsdWdcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCBvcmcgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJvcmdhbml6YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFt7IGZpZWxkOiBpc1NsdWcgPyBcInNsdWdcIiA6IFwiaWRcIiwgdmFsdWU6IG9yZ2FuaXphdGlvbklkIH1dXG4gICAgICB9KTtcbiAgICAgIGlmICghb3JnKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgW2ludml0YXRpb25zLCBtZW1iZXJzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgICAgbW9kZWw6IFwiaW52aXRhdGlvblwiLFxuICAgICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJvcmdhbml6YXRpb25JZFwiLCB2YWx1ZTogb3JnLmlkIH1dXG4gICAgICAgIH0pLFxuICAgICAgICBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwib3JnYW5pemF0aW9uSWRcIiwgdmFsdWU6IG9yZy5pZCB9XVxuICAgICAgICB9KVxuICAgICAgXSk7XG4gICAgICBpZiAoIW9yZykgcmV0dXJuIG51bGw7XG4gICAgICBjb25zdCB1c2VySWRzID0gbWVtYmVycy5tYXAoKG1lbWJlcikgPT4gbWVtYmVyLnVzZXJJZCk7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJpZFwiLCB2YWx1ZTogdXNlcklkcywgb3BlcmF0b3I6IFwiaW5cIiB9XVxuICAgICAgfSk7XG4gICAgICBjb25zdCB1c2VyTWFwID0gbmV3IE1hcCh1c2Vycy5tYXAoKHVzZXIpID0+IFt1c2VyLmlkLCB1c2VyXSkpO1xuICAgICAgY29uc3QgbWVtYmVyc1dpdGhVc2VycyA9IG1lbWJlcnMubWFwKChtZW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgdXNlciA9IHVzZXJNYXAuZ2V0KG1lbWJlci51c2VySWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgXCJVbmV4cGVjdGVkIGVycm9yOiBVc2VyIG5vdCBmb3VuZCBmb3IgbWVtYmVyXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ubWVtYmVyLFxuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ub3JnLFxuICAgICAgICBpbnZpdGF0aW9ucyxcbiAgICAgICAgbWVtYmVyczogbWVtYmVyc1dpdGhVc2Vyc1xuICAgICAgfTtcbiAgICB9LFxuICAgIGxpc3RPcmdhbml6YXRpb25zOiBhc3luYyAodXNlcklkKSA9PiB7XG4gICAgICBjb25zdCBtZW1iZXJzID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIW1lbWJlcnMgfHwgbWVtYmVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgY29uc3Qgb3JnYW5pemF0aW9uSWRzID0gbWVtYmVycy5tYXAoKG1lbWJlcikgPT4gbWVtYmVyLm9yZ2FuaXphdGlvbklkKTtcbiAgICAgIGNvbnN0IG9yZ2FuaXphdGlvbnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwib3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBvcmdhbml6YXRpb25JZHMsXG4gICAgICAgICAgICBvcGVyYXRvcjogXCJpblwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBvcmdhbml6YXRpb25zO1xuICAgIH0sXG4gICAgY3JlYXRlSW52aXRhdGlvbjogYXN5bmMgKHtcbiAgICAgIGludml0YXRpb24sXG4gICAgICB1c2VyXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgZGVmYXVsdEV4cGlyYXRpb24gPSAxZTMgKiA2MCAqIDYwICogNDg7XG4gICAgICBjb25zdCBleHBpcmVzQXQgPSBnZXREYXRlKFxuICAgICAgICBvcHRpb25zPy5pbnZpdGF0aW9uRXhwaXJlc0luIHx8IGRlZmF1bHRFeHBpcmF0aW9uXG4gICAgICApO1xuICAgICAgY29uc3QgaW52aXRlID0gYXdhaXQgYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICBtb2RlbDogXCJpbnZpdGF0aW9uXCIsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBlbWFpbDogaW52aXRhdGlvbi5lbWFpbCxcbiAgICAgICAgICByb2xlOiBpbnZpdGF0aW9uLnJvbGUsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IGludml0YXRpb24ub3JnYW5pemF0aW9uSWQsXG4gICAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIixcbiAgICAgICAgICBleHBpcmVzQXQsXG4gICAgICAgICAgaW52aXRlcklkOiB1c2VyLmlkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGludml0ZTtcbiAgICB9LFxuICAgIGZpbmRJbnZpdGF0aW9uQnlJZDogYXN5bmMgKGlkKSA9PiB7XG4gICAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwiaW52aXRhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogaWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGludml0YXRpb247XG4gICAgfSxcbiAgICBmaW5kUGVuZGluZ0ludml0YXRpb246IGFzeW5jIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImludml0YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGEuZW1haWxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcIm9yZ2FuaXphdGlvbklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZGF0YS5vcmdhbml6YXRpb25JZFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwic3RhdHVzXCIsXG4gICAgICAgICAgICB2YWx1ZTogXCJwZW5kaW5nXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGludml0YXRpb24uZmlsdGVyKFxuICAgICAgICAoaW52aXRlKSA9PiBuZXcgRGF0ZShpbnZpdGUuZXhwaXJlc0F0KSA+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICApO1xuICAgIH0sXG4gICAgdXBkYXRlSW52aXRhdGlvbjogYXN5bmMgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IGludml0YXRpb24gPSBhd2FpdCBhZGFwdGVyLnVwZGF0ZSh7XG4gICAgICAgIG1vZGVsOiBcImludml0YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGEuaW52aXRhdGlvbklkXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGludml0YXRpb247XG4gICAgfVxuICB9O1xufTtcbnZhciBvcmdNaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICByZXR1cm4ge307XG59KTtcbnZhciBvcmdTZXNzaW9uTWlkZGxld2FyZSA9IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKFxuICB7XG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvblxuICAgIH07XG4gIH1cbik7XG52YXIgcm9sZSA9IHouc3RyaW5nKCk7XG52YXIgaW52aXRhdGlvblN0YXR1cyA9IHouZW51bShbXCJwZW5kaW5nXCIsIFwiYWNjZXB0ZWRcIiwgXCJyZWplY3RlZFwiLCBcImNhbmNlbGVkXCJdKS5kZWZhdWx0KFwicGVuZGluZ1wiKTtcbnoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCkuZGVmYXVsdChnZW5lcmF0ZUlkKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgc2x1Zzogei5zdHJpbmcoKSxcbiAgbG9nbzogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIG1ldGFkYXRhOiB6LnJlY29yZCh6LnN0cmluZygpKS5vcih6LnN0cmluZygpLnRyYW5zZm9ybSgodikgPT4gSlNPTi5wYXJzZSh2KSkpLm51bGxpc2goKSxcbiAgY3JlYXRlZEF0OiB6LmRhdGUoKVxufSk7XG56Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLmRlZmF1bHQoZ2VuZXJhdGVJZCksXG4gIG9yZ2FuaXphdGlvbklkOiB6LnN0cmluZygpLFxuICB1c2VySWQ6IHouc3RyaW5nKCksXG4gIHJvbGUsXG4gIGNyZWF0ZWRBdDogei5kYXRlKClcbn0pO1xuei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKS5kZWZhdWx0KGdlbmVyYXRlSWQpLFxuICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoKSxcbiAgZW1haWw6IHouc3RyaW5nKCksXG4gIHJvbGUsXG4gIHN0YXR1czogaW52aXRhdGlvblN0YXR1cyxcbiAgLyoqXG4gICAqIFRoZSBpZCBvZiB0aGUgdXNlciB3aG8gaW52aXRlZCB0aGUgdXNlci5cbiAgICovXG4gIGludml0ZXJJZDogei5zdHJpbmcoKSxcbiAgZXhwaXJlc0F0OiB6LmRhdGUoKVxufSk7XG5cbi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9lcnJvci1jb2Rlcy50c1xudmFyIE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUyA9IHtcbiAgWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19DUkVBVEVfQV9ORVdfT1JHQU5JWkFUSU9OOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gY3JlYXRlIGEgbmV3IG9yZ2FuaXphdGlvblwiLFxuICBZT1VfSEFWRV9SRUFDSEVEX1RIRV9NQVhJTVVNX05VTUJFUl9PRl9PUkdBTklaQVRJT05TOiBcIllvdSBoYXZlIHJlYWNoZWQgdGhlIG1heGltdW0gbnVtYmVyIG9mIG9yZ2FuaXphdGlvbnNcIixcbiAgT1JHQU5JWkFUSU9OX0FMUkVBRFlfRVhJU1RTOiBcIk9yZ2FuaXphdGlvbiBhbHJlYWR5IGV4aXN0c1wiLFxuICBPUkdBTklaQVRJT05fTk9UX0ZPVU5EOiBcIk9yZ2FuaXphdGlvbiBub3QgZm91bmRcIixcbiAgVVNFUl9JU19OT1RfQV9NRU1CRVJfT0ZfVEhFX09SR0FOSVpBVElPTjogXCJVc2VyIGlzIG5vdCBhIG1lbWJlciBvZiB0aGUgb3JnYW5pemF0aW9uXCIsXG4gIFlPVV9BUkVfTk9UX0FMTE9XRURfVE9fVVBEQVRFX1RISVNfT1JHQU5JWkFUSU9OOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gdXBkYXRlIHRoaXMgb3JnYW5pemF0aW9uXCIsXG4gIFlPVV9BUkVfTk9UX0FMTE9XRURfVE9fREVMRVRFX1RISVNfT1JHQU5JWkFUSU9OOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gZGVsZXRlIHRoaXMgb3JnYW5pemF0aW9uXCIsXG4gIE5PX0FDVElWRV9PUkdBTklaQVRJT046IFwiTm8gYWN0aXZlIG9yZ2FuaXphdGlvblwiLFxuICBVU0VSX0lTX0FMUkVBRFlfQV9NRU1CRVJfT0ZfVEhJU19PUkdBTklaQVRJT046IFwiVXNlciBpcyBhbHJlYWR5IGEgbWVtYmVyIG9mIHRoaXMgb3JnYW5pemF0aW9uXCIsXG4gIE1FTUJFUl9OT1RfRk9VTkQ6IFwiTWVtYmVyIG5vdCBmb3VuZFwiLFxuICBST0xFX05PVF9GT1VORDogXCJSb2xlIG5vdCBmb3VuZFwiLFxuICBZT1VfQ0FOTk9UX0xFQVZFX1RIRV9PUkdBTklaQVRJT05fQVNfVEhFX09OTFlfT1dORVI6IFwiWW91IGNhbm5vdCBsZWF2ZSB0aGUgb3JnYW5pemF0aW9uIGFzIHRoZSBvbmx5IG93bmVyXCIsXG4gIFlPVV9BUkVfTk9UX0FMTE9XRURfVE9fREVMRVRFX1RISVNfTUVNQkVSOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gZGVsZXRlIHRoaXMgbWVtYmVyXCIsXG4gIFlPVV9BUkVfTk9UX0FMTE9XRURfVE9fSU5WSVRFX1VTRVJTX1RPX1RISVNfT1JHQU5JWkFUSU9OOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gaW52aXRlIHVzZXJzIHRvIHRoaXMgb3JnYW5pemF0aW9uXCIsXG4gIFVTRVJfSVNfQUxSRUFEWV9JTlZJVEVEX1RPX1RISVNfT1JHQU5JWkFUSU9OOiBcIlVzZXIgaXMgYWxyZWFkeSBpbnZpdGVkIHRvIHRoaXMgb3JnYW5pemF0aW9uXCIsXG4gIElOVklUQVRJT05fTk9UX0ZPVU5EOiBcIkludml0YXRpb24gbm90IGZvdW5kXCIsXG4gIFlPVV9BUkVfTk9UX1RIRV9SRUNJUElFTlRfT0ZfVEhFX0lOVklUQVRJT046IFwiWW91IGFyZSBub3QgdGhlIHJlY2lwaWVudCBvZiB0aGUgaW52aXRhdGlvblwiLFxuICBZT1VfQVJFX05PVF9BTExPV0VEX1RPX0NBTkNFTF9USElTX0lOVklUQVRJT046IFwiWW91IGFyZSBub3QgYWxsb3dlZCB0byBjYW5jZWwgdGhpcyBpbnZpdGF0aW9uXCIsXG4gIElOVklURVJfSVNfTk9fTE9OR0VSX0FfTUVNQkVSX09GX1RIRV9PUkdBTklaQVRJT046IFwiSW52aXRlciBpcyBubyBsb25nZXIgYSBtZW1iZXIgb2YgdGhlIG9yZ2FuaXphdGlvblwiLFxuICBZT1VfQVJFX05PVF9BTExPV0VEX1RPX0lOVklURV9VU0VSX1dJVEhfVEhJU19ST0xFOiBcInlvdSBhcmUgbm90IGFsbG93ZWQgdG8gaW52aXRlIHVzZXIgd2l0aCB0aGlzIHJvbGVcIlxufTtcblxuLy8gc3JjL3BsdWdpbnMvb3JnYW5pemF0aW9uL3JvdXRlcy9jcnVkLWludml0ZXMudHNcbnZhciBjcmVhdGVJbnZpdGF0aW9uID0gKG9wdGlvbikgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vaW52aXRlLW1lbWJlclwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gaW52aXRlXCJcbiAgICAgIH0pLFxuICAgICAgcm9sZTogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcm9sZSB0byBhc3NpZ24gdG8gdGhlIHVzZXJcIlxuICAgICAgfSksXG4gICAgICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIElEIHRvIGludml0ZSB0aGUgdXNlciB0b1wiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgcmVzZW5kOiB6LmJvb2xlYW4oe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXNlbmQgdGhlIGludml0YXRpb24gZW1haWwsIGlmIHRoZSB1c2VyIGlzIGFscmVhZHkgaW52aXRlZFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiSW52aXRlIGEgdXNlciB0byBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByb2xlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25JZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaW52aXRlcklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyZXNBdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICBcInJvbGVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJvcmdhbml6YXRpb25JZFwiLFxuICAgICAgICAgICAgICAgICAgICBcImludml0ZXJJZFwiLFxuICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiLFxuICAgICAgICAgICAgICAgICAgICBcImV4cGlyZXNBdFwiXG4gICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcmdPcHRpb25zLnNlbmRJbnZpdGF0aW9uRW1haWwpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci53YXJuKFxuICAgICAgICBcIkludml0YXRpb24gZW1haWwgaXMgbm90IGVuYWJsZWQuIFBhc3MgYHNlbmRJbnZpdGF0aW9uRW1haWxgIHRvIHRoZSBwbHVnaW4gb3B0aW9ucyB0byBlbmFibGUgaXQuXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiSW52aXRhdGlvbiBlbWFpbCBpcyBub3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25JZCB8fCBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuT1JHQU5JWkFUSU9OX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRNZW1iZXJCeU9yZ0lkKHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgb3JnYW5pemF0aW9uSWRcbiAgICB9KTtcbiAgICBpZiAoIW1lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTUVNQkVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJvbGUyID0gY3R4LmNvbnRleHQucm9sZXNbbWVtYmVyLnJvbGVdO1xuICAgIGlmICghcm9sZTIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLlJPTEVfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY2FuSW52aXRlID0gcm9sZTIuYXV0aG9yaXplKHtcbiAgICAgIGludml0YXRpb246IFtcImNyZWF0ZVwiXVxuICAgIH0pO1xuICAgIGlmIChjYW5JbnZpdGUuZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9BTExPV0VEX1RPX0lOVklURV9VU0VSU19UT19USElTX09SR0FOSVpBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNyZWF0b3JSb2xlID0gY3R4LmNvbnRleHQub3JnT3B0aW9ucy5jcmVhdG9yUm9sZSB8fCBcIm93bmVyXCI7XG4gICAgaWYgKG1lbWJlci5yb2xlICE9PSBjcmVhdG9yUm9sZSAmJiBjdHguYm9keS5yb2xlID09PSBjcmVhdG9yUm9sZSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9BUkVfTk9UX0FMTE9XRURfVE9fSU5WSVRFX1VTRVJfV0lUSF9USElTX1JPTEVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhbHJlYWR5TWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlFbWFpbCh7XG4gICAgICBlbWFpbDogY3R4LmJvZHkuZW1haWwsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmIChhbHJlYWR5TWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX0FMUkVBRFlfQV9NRU1CRVJfT0ZfVEhJU19PUkdBTklaQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhbHJlYWR5SW52aXRlZCA9IGF3YWl0IGFkYXB0ZXIuZmluZFBlbmRpbmdJbnZpdGF0aW9uKHtcbiAgICAgIGVtYWlsOiBjdHguYm9keS5lbWFpbCxcbiAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKGFscmVhZHlJbnZpdGVkLmxlbmd0aCAmJiAhY3R4LmJvZHkucmVzZW5kKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX0FMUkVBRFlfSU5WSVRFRF9UT19USElTX09SR0FOSVpBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGludml0YXRpb24gPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZUludml0YXRpb24oe1xuICAgICAgaW52aXRhdGlvbjoge1xuICAgICAgICByb2xlOiBjdHguYm9keS5yb2xlLFxuICAgICAgICBlbWFpbDogY3R4LmJvZHkuZW1haWwsXG4gICAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgICB9LFxuICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgfSk7XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9yZ2FuaXphdGlvbkJ5SWQob3JnYW5pemF0aW9uSWQpO1xuICAgIGlmICghb3JnYW5pemF0aW9uMikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuT1JHQU5JWkFUSU9OX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMuc2VuZEludml0YXRpb25FbWFpbD8uKFxuICAgICAge1xuICAgICAgICBpZDogaW52aXRhdGlvbi5pZCxcbiAgICAgICAgcm9sZTogaW52aXRhdGlvbi5yb2xlLFxuICAgICAgICBlbWFpbDogaW52aXRhdGlvbi5lbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICBvcmdhbml6YXRpb246IG9yZ2FuaXphdGlvbjIsXG4gICAgICAgIGludml0ZXI6IHtcbiAgICAgICAgICAuLi5tZW1iZXIsXG4gICAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjdHgucmVxdWVzdFxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKGludml0YXRpb24pO1xuICB9XG4pO1xudmFyIGFjY2VwdEludml0YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9hY2NlcHQtaW52aXRhdGlvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBpbnZpdGF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIElEIG9mIHRoZSBpbnZpdGF0aW9uIHRvIGFjY2VwdFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmUsIG9yZ1Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2NlcHQgYW4gaW52aXRhdGlvbiB0byBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgaW52aXRhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IGludml0YXRpb24gPSBhd2FpdCBhZGFwdGVyLmZpbmRJbnZpdGF0aW9uQnlJZChjdHguYm9keS5pbnZpdGF0aW9uSWQpO1xuICAgIGlmICghaW52aXRhdGlvbiB8fCBpbnZpdGF0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpIHx8IGludml0YXRpb24uc3RhdHVzICE9PSBcInBlbmRpbmdcIikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuSU5WSVRBVElPTl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaW52aXRhdGlvbi5lbWFpbCAhPT0gc2Vzc2lvbi51c2VyLmVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfVEhFX1JFQ0lQSUVOVF9PRl9USEVfSU5WSVRBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY2VwdGVkSSA9IGF3YWl0IGFkYXB0ZXIudXBkYXRlSW52aXRhdGlvbih7XG4gICAgICBpbnZpdGF0aW9uSWQ6IGN0eC5ib2R5Lmludml0YXRpb25JZCxcbiAgICAgIHN0YXR1czogXCJhY2NlcHRlZFwiXG4gICAgfSk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5jcmVhdGVNZW1iZXIoe1xuICAgICAgb3JnYW5pemF0aW9uSWQ6IGludml0YXRpb24ub3JnYW5pemF0aW9uSWQsXG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIHJvbGU6IGludml0YXRpb24ucm9sZSxcbiAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICB9KTtcbiAgICBhd2FpdCBhZGFwdGVyLnNldEFjdGl2ZU9yZ2FuaXphdGlvbihcbiAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgIGludml0YXRpb24ub3JnYW5pemF0aW9uSWRcbiAgICApO1xuICAgIGlmICghYWNjZXB0ZWRJKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5JTlZJVEFUSU9OX05PVF9GT1VORFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIGludml0YXRpb246IGFjY2VwdGVkSSxcbiAgICAgIG1lbWJlclxuICAgIH0pO1xuICB9XG4pO1xudmFyIHJlamVjdEludml0YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9yZWplY3QtaW52aXRhdGlvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBpbnZpdGF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIElEIG9mIHRoZSBpbnZpdGF0aW9uIHRvIHJlamVjdFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmUsIG9yZ1Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZWplY3QgYW4gaW52aXRhdGlvbiB0byBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgaW52aXRhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJudWxsXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci5maW5kSW52aXRhdGlvbkJ5SWQoY3R4LmJvZHkuaW52aXRhdGlvbklkKTtcbiAgICBpZiAoIWludml0YXRpb24gfHwgaW52aXRhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSB8fCBpbnZpdGF0aW9uLnN0YXR1cyAhPT0gXCJwZW5kaW5nXCIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJJbnZpdGF0aW9uIG5vdCBmb3VuZCFcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChpbnZpdGF0aW9uLmVtYWlsICE9PSBzZXNzaW9uLnVzZXIuZW1haWwpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9USEVfUkVDSVBJRU5UX09GX1RIRV9JTlZJVEFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcmVqZWN0ZWRJID0gYXdhaXQgYWRhcHRlci51cGRhdGVJbnZpdGF0aW9uKHtcbiAgICAgIGludml0YXRpb25JZDogY3R4LmJvZHkuaW52aXRhdGlvbklkLFxuICAgICAgc3RhdHVzOiBcInJlamVjdGVkXCJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgaW52aXRhdGlvbjogcmVqZWN0ZWRJLFxuICAgICAgbWVtYmVyOiBudWxsXG4gICAgfSk7XG4gIH1cbik7XG52YXIgY2FuY2VsSW52aXRhdGlvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2NhbmNlbC1pbnZpdGF0aW9uXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIGludml0YXRpb25JZDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgSUQgb2YgdGhlIGludml0YXRpb24gdG8gY2FuY2VsXCJcbiAgICAgIH0pXG4gICAgfSksXG4gICAgdXNlOiBbb3JnTWlkZGxld2FyZSwgb3JnU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG9wZW5hcGk6IHtcbiAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbmNlbCBhbiBpbnZpdGF0aW9uIHRvIGFuIG9yZ2FuaXphdGlvblwiLFxuICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICBpbnZpdGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgaW52aXRhdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZEludml0YXRpb25CeUlkKGN0eC5ib2R5Lmludml0YXRpb25JZCk7XG4gICAgaWYgKCFpbnZpdGF0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5JTlZJVEFUSU9OX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBvcmdhbml6YXRpb25JZDogaW52aXRhdGlvbi5vcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5NRU1CRVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY2FuQ2FuY2VsID0gY3R4LmNvbnRleHQucm9sZXNbbWVtYmVyLnJvbGVdLmF1dGhvcml6ZSh7XG4gICAgICBpbnZpdGF0aW9uOiBbXCJjYW5jZWxcIl1cbiAgICB9KTtcbiAgICBpZiAoY2FuQ2FuY2VsLmVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19DQU5DRUxfVEhJU19JTlZJVEFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY2FuY2VsZWRJID0gYXdhaXQgYWRhcHRlci51cGRhdGVJbnZpdGF0aW9uKHtcbiAgICAgIGludml0YXRpb25JZDogY3R4LmJvZHkuaW52aXRhdGlvbklkLFxuICAgICAgc3RhdHVzOiBcImNhbmNlbGVkXCJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oY2FuY2VsZWRJKTtcbiAgfVxuKTtcbnZhciBnZXRJbnZpdGF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vZ2V0LWludml0YXRpb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlXSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgaWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIElEIG9mIHRoZSBpbnZpdGF0aW9uIHRvIGdldFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkdldCBhbiBpbnZpdGF0aW9uIGJ5IElEXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcm9sZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGludml0ZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbk5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvblNsdWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGludml0ZXJFbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICBcInJvbGVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJvcmdhbml6YXRpb25JZFwiLFxuICAgICAgICAgICAgICAgICAgICBcImludml0ZXJJZFwiLFxuICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiLFxuICAgICAgICAgICAgICAgICAgICBcImV4cGlyZXNBdFwiLFxuICAgICAgICAgICAgICAgICAgICBcIm9yZ2FuaXphdGlvbk5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJvcmdhbml6YXRpb25TbHVnXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiaW52aXRlckVtYWlsXCJcbiAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiTm90IGF1dGhlbnRpY2F0ZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci5maW5kSW52aXRhdGlvbkJ5SWQoY3R4LnF1ZXJ5LmlkKTtcbiAgICBpZiAoIWludml0YXRpb24gfHwgaW52aXRhdGlvbi5zdGF0dXMgIT09IFwicGVuZGluZ1wiIHx8IGludml0YXRpb24uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJJbnZpdGF0aW9uIG5vdCBmb3VuZCFcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChpbnZpdGF0aW9uLmVtYWlsICE9PSBzZXNzaW9uLnVzZXIuZW1haWwpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9USEVfUkVDSVBJRU5UX09GX1RIRV9JTlZJVEFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9yZ2FuaXphdGlvbkJ5SWQoXG4gICAgICBpbnZpdGF0aW9uLm9yZ2FuaXphdGlvbklkXG4gICAgKTtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbjIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk9SR0FOSVpBVElPTl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRNZW1iZXJCeU9yZ0lkKHtcbiAgICAgIHVzZXJJZDogaW52aXRhdGlvbi5pbnZpdGVySWQsXG4gICAgICBvcmdhbml6YXRpb25JZDogaW52aXRhdGlvbi5vcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5JTlZJVEVSX0lTX05PX0xPTkdFUl9BX01FTUJFUl9PRl9USEVfT1JHQU5JWkFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIC4uLmludml0YXRpb24sXG4gICAgICBvcmdhbml6YXRpb25OYW1lOiBvcmdhbml6YXRpb24yLm5hbWUsXG4gICAgICBvcmdhbml6YXRpb25TbHVnOiBvcmdhbml6YXRpb24yLnNsdWcsXG4gICAgICBpbnZpdGVyRW1haWw6IG1lbWJlci51c2VyLmVtYWlsXG4gICAgfSk7XG4gIH1cbik7XG52YXIgYWRkTWVtYmVyID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vYWRkLW1lbWJlclwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCksXG4gICAgICByb2xlOiB6LnN0cmluZygpLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBTRVJWRVJfT05MWTogdHJ1ZVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguYm9keS51c2VySWQgPyBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpLmNhdGNoKChlKSA9PiBudWxsKSA6IG51bGw7XG4gICAgY29uc3Qgb3JnSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25JZCB8fCBzZXNzaW9uPy5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkO1xuICAgIGlmICghb3JnSWQpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk5PX0FDVElWRV9PUkdBTklaQVRJT05cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZChcbiAgICAgIGN0eC5ib2R5LnVzZXJJZFxuICAgICk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhbHJlYWR5TWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlFbWFpbCh7XG4gICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiBvcmdJZFxuICAgIH0pO1xuICAgIGlmIChhbHJlYWR5TWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX0FMUkVBRFlfQV9NRU1CRVJfT0ZfVEhJU19PUkdBTklaQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjcmVhdGVkTWVtYmVyID0gYXdhaXQgYWRhcHRlci5jcmVhdGVNZW1iZXIoe1xuICAgICAgaWQ6IGdlbmVyYXRlSWQoKSxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiBvcmdJZCxcbiAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgIHJvbGU6IGN0eC5ib2R5LnJvbGUsXG4gICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKGNyZWF0ZWRNZW1iZXIpO1xuICB9XG4pO1xudmFyIHJlbW92ZU1lbWJlciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL3JlbW92ZS1tZW1iZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgbWVtYmVySWRPckVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBJRCBvciBlbWFpbCBvZiB0aGUgbWVtYmVyIHRvIHJlbW92ZVwiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogSWYgbm90IHByb3ZpZGVkLCB0aGUgYWN0aXZlIG9yZ2FuaXphdGlvbiB3aWxsIGJlIHVzZWRcbiAgICAgICAqL1xuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIElEIG9mIHRoZSBvcmdhbml6YXRpb24gdG8gcmVtb3ZlIHRoZSBtZW1iZXIgZnJvbS4gSWYgbm90IHByb3ZpZGVkLCB0aGUgYWN0aXZlIG9yZ2FuaXphdGlvbiB3aWxsIGJlIHVzZWRcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmUsIG9yZ1Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZW1vdmUgYSBtZW1iZXIgZnJvbSBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25JZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcm9sZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wiaWRcIiwgXCJ1c2VySWRcIiwgXCJvcmdhbml6YXRpb25JZFwiLCBcInJvbGVcIl1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJtZW1iZXJcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBvcmdhbml6YXRpb25JZCA9IGN0eC5ib2R5Lm9yZ2FuaXphdGlvbklkIHx8IHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbklkKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5OT19BQ1RJVkVfT1JHQU5JWkFUSU9OXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk1FTUJFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCByb2xlMiA9IGN0eC5jb250ZXh0LnJvbGVzW21lbWJlci5yb2xlXTtcbiAgICBpZiAoIXJvbGUyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ST0xFX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGlzTGVhdmluZyA9IHNlc3Npb24udXNlci5lbWFpbCA9PT0gY3R4LmJvZHkubWVtYmVySWRPckVtYWlsIHx8IG1lbWJlci5pZCA9PT0gY3R4LmJvZHkubWVtYmVySWRPckVtYWlsO1xuICAgIGNvbnN0IGlzT3duZXJMZWF2aW5nID0gaXNMZWF2aW5nICYmIG1lbWJlci5yb2xlID09PSAoY3R4LmNvbnRleHQub3JnT3B0aW9ucz8uY3JlYXRvclJvbGUgfHwgXCJvd25lclwiKTtcbiAgICBpZiAoaXNPd25lckxlYXZpbmcpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9DQU5OT1RfTEVBVkVfVEhFX09SR0FOSVpBVElPTl9BU19USEVfT05MWV9PV05FUlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhbkRlbGV0ZU1lbWJlciA9IGlzTGVhdmluZyB8fCByb2xlMi5hdXRob3JpemUoe1xuICAgICAgbWVtYmVyOiBbXCJkZWxldGVcIl1cbiAgICB9KS5zdWNjZXNzO1xuICAgIGlmICghY2FuRGVsZXRlTWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19ERUxFVEVfVEhJU19NRU1CRVJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBsZXQgZXhpc3RpbmcgPSBudWxsO1xuICAgIGlmIChjdHguYm9keS5tZW1iZXJJZE9yRW1haWwuaW5jbHVkZXMoXCJAXCIpKSB7XG4gICAgICBleGlzdGluZyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5RW1haWwoe1xuICAgICAgICBlbWFpbDogY3R4LmJvZHkubWVtYmVySWRPckVtYWlsLFxuICAgICAgICBvcmdhbml6YXRpb25JZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4aXN0aW5nID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlJZChjdHguYm9keS5tZW1iZXJJZE9yRW1haWwpO1xuICAgIH1cbiAgICBpZiAoZXhpc3Rpbmc/Lm9yZ2FuaXphdGlvbklkICE9PSBvcmdhbml6YXRpb25JZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTUVNQkVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlTWVtYmVyKGV4aXN0aW5nLmlkKTtcbiAgICBpZiAoc2Vzc2lvbi51c2VyLmlkID09PSBleGlzdGluZy51c2VySWQgJiYgc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkID09PSBleGlzdGluZy5vcmdhbml6YXRpb25JZCkge1xuICAgICAgYXdhaXQgYWRhcHRlci5zZXRBY3RpdmVPcmdhbml6YXRpb24oc2Vzc2lvbi5zZXNzaW9uLnRva2VuLCBudWxsKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIG1lbWJlcjogZXhpc3RpbmdcbiAgICB9KTtcbiAgfVxuKTtcbnZhciB1cGRhdGVNZW1iZXJSb2xlID0gKG9wdGlvbikgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vdXBkYXRlLW1lbWJlci1yb2xlXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHJvbGU6IHouc3RyaW5nKCksXG4gICAgICBtZW1iZXJJZDogei5zdHJpbmcoKSxcbiAgICAgIC8qKlxuICAgICAgICogSWYgbm90IHByb3ZpZGVkLCB0aGUgYWN0aXZlIG9yZ2FuaXphdGlvbiB3aWxsIGJlIHVzZWRcbiAgICAgICAqL1xuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmUsIG9yZ1Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJVcGRhdGUgdGhlIHJvbGUgb2YgYSBtZW1iZXIgaW4gYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lbWJlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcImlkXCIsIFwidXNlcklkXCIsIFwib3JnYW5pemF0aW9uSWRcIiwgXCJyb2xlXCJdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wibWVtYmVyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25JZCB8fCBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTk9fQUNUSVZFX09SR0FOSVpBVElPTlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5NRU1CRVJfTk9UX0ZPVU5EXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCByb2xlMiA9IGN0eC5jb250ZXh0LnJvbGVzW21lbWJlci5yb2xlXTtcbiAgICBpZiAoIXJvbGUyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ST0xFX05PVF9GT1VORFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY2FuVXBkYXRlTWVtYmVyID0gcm9sZTIuYXV0aG9yaXplKHtcbiAgICAgIG1lbWJlcjogW1widXBkYXRlXCJdXG4gICAgfSkuZXJyb3IgfHwgY3R4LmJvZHkucm9sZSA9PT0gXCJvd25lclwiICYmIG1lbWJlci5yb2xlICE9PSBcIm93bmVyXCI7XG4gICAgaWYgKGNhblVwZGF0ZU1lbWJlcikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiWW91IGFyZSBub3QgYWxsb3dlZCB0byB1cGRhdGUgdGhpcyBtZW1iZXJcIlxuICAgICAgICB9LFxuICAgICAgICBzdGF0dXM6IDQwM1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHVwZGF0ZWRNZW1iZXIgPSBhd2FpdCBhZGFwdGVyLnVwZGF0ZU1lbWJlcihcbiAgICAgIGN0eC5ib2R5Lm1lbWJlcklkLFxuICAgICAgY3R4LmJvZHkucm9sZVxuICAgICk7XG4gICAgaWYgKCF1cGRhdGVkTWVtYmVyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5NRU1CRVJfTk9UX0ZPVU5EXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24odXBkYXRlZE1lbWJlcik7XG4gIH1cbik7XG52YXIgZ2V0QWN0aXZlTWVtYmVyID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vZ2V0LWFjdGl2ZS1tZW1iZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSBhY3RpdmUgbWVtYmVyIGluIHRoZSBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJvbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wiaWRcIiwgXCJ1c2VySWRcIiwgXCJvcmdhbml6YXRpb25JZFwiLCBcInJvbGVcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBvcmdhbml6YXRpb25JZCA9IHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbklkKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5OT19BQ1RJVkVfT1JHQU5JWkFUSU9OXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk1FTUJFUl9OT1RfRk9VTkRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbihtZW1iZXIpO1xuICB9XG4pO1xudmFyIGxlYXZlT3JnYW5pemF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vbGVhdmVcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKClcbiAgICB9KSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZSwgb3JnTWlkZGxld2FyZV1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0KTtcbiAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRNZW1iZXJCeU9yZ0lkKHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IGN0eC5ib2R5Lm9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk1FTUJFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBpc093bmVyTGVhdmluZyA9IG1lbWJlci5yb2xlID09PSAoY3R4LmNvbnRleHQub3JnT3B0aW9ucz8uY3JlYXRvclJvbGUgfHwgXCJvd25lclwiKTtcbiAgICBpZiAoaXNPd25lckxlYXZpbmcpIHtcbiAgICAgIGNvbnN0IG1lbWJlcnMgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwib3JnYW5pemF0aW9uSWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBjdHguYm9keS5vcmdhbml6YXRpb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBjb25zdCBvd25lcnMgPSBtZW1iZXJzLmZpbHRlcihcbiAgICAgICAgKG1lbWJlcjIpID0+IG1lbWJlcjIucm9sZSA9PT0gKGN0eC5jb250ZXh0Lm9yZ09wdGlvbnM/LmNyZWF0b3JSb2xlIHx8IFwib3duZXJcIilcbiAgICAgICk7XG4gICAgICBpZiAob3duZXJzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0NBTk5PVF9MRUFWRV9USEVfT1JHQU5JWkFUSU9OX0FTX1RIRV9PTkxZX09XTkVSXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZU1lbWJlcihtZW1iZXIuaWQpO1xuICAgIGlmIChzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQgPT09IGN0eC5ib2R5Lm9yZ2FuaXphdGlvbklkKSB7XG4gICAgICBhd2FpdCBhZGFwdGVyLnNldEFjdGl2ZU9yZ2FuaXphdGlvbihzZXNzaW9uLnNlc3Npb24udG9rZW4sIG51bGwpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24obWVtYmVyKTtcbiAgfVxuKTtcbnZhciBjcmVhdGVPcmdhbml6YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9jcmVhdGVcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgbmFtZTogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgb3JnYW5pemF0aW9uXCJcbiAgICAgIH0pLFxuICAgICAgc2x1Zzogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgc2x1ZyBvZiB0aGUgb3JnYW5pemF0aW9uXCJcbiAgICAgIH0pLFxuICAgICAgdXNlcklkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIGlkIG9mIHRoZSBvcmdhbml6YXRpb24gY3JlYXRvci4gSWYgbm90IHByb3ZpZGVkLCB0aGUgY3VycmVudCB1c2VyIHdpbGwgYmUgdXNlZC4gU2hvdWxkIG9ubHkgYmUgdXNlZCBieSBhZG1pbnMgb3Igd2hlbiBjYWxsZWQgYnkgdGhlIHNlcnZlci5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIGxvZ286IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGxvZ28gb2YgdGhlIG9yZ2FuaXphdGlvblwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgbWV0YWRhdGE6IHoucmVjb3JkKHouc3RyaW5nKCksIHouYW55KCksIHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG1ldGFkYXRhIG9mIHRoZSBvcmdhbml6YXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNyZWF0ZSBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb24gdGhhdCB3YXMgY3JlYXRlZFwiLFxuICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Pcmdhbml6YXRpb25cIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbiAmJiAoY3R4LnJlcXVlc3QgfHwgY3R4LmhlYWRlcnMpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIGxldCB1c2VyID0gc2Vzc2lvbj8udXNlciB8fCBudWxsO1xuICAgIGlmICghdXNlcikge1xuICAgICAgaWYgKCFjdHguYm9keS51c2VySWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgICAgfVxuICAgICAgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoY3R4LmJvZHkudXNlcklkKTtcbiAgICB9XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG9wdGlvbnMgPSBjdHguY29udGV4dC5vcmdPcHRpb25zO1xuICAgIGNvbnN0IGNhbkNyZWF0ZU9yZyA9IHR5cGVvZiBvcHRpb25zPy5hbGxvd1VzZXJUb0NyZWF0ZU9yZ2FuaXphdGlvbiA9PT0gXCJmdW5jdGlvblwiID8gYXdhaXQgb3B0aW9ucy5hbGxvd1VzZXJUb0NyZWF0ZU9yZ2FuaXphdGlvbih1c2VyKSA6IG9wdGlvbnM/LmFsbG93VXNlclRvQ3JlYXRlT3JnYW5pemF0aW9uID09PSB2b2lkIDAgPyB0cnVlIDogb3B0aW9ucy5hbGxvd1VzZXJUb0NyZWF0ZU9yZ2FuaXphdGlvbjtcbiAgICBpZiAoIWNhbkNyZWF0ZU9yZykge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9BUkVfTk9UX0FMTE9XRURfVE9fQ1JFQVRFX0FfTkVXX09SR0FOSVpBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBvcHRpb25zKTtcbiAgICBjb25zdCB1c2VyT3JnYW5pemF0aW9ucyA9IGF3YWl0IGFkYXB0ZXIubGlzdE9yZ2FuaXphdGlvbnModXNlci5pZCk7XG4gICAgY29uc3QgaGFzUmVhY2hlZE9yZ0xpbWl0ID0gdHlwZW9mIG9wdGlvbnMub3JnYW5pemF0aW9uTGltaXQgPT09IFwibnVtYmVyXCIgPyB1c2VyT3JnYW5pemF0aW9ucy5sZW5ndGggPj0gb3B0aW9ucy5vcmdhbml6YXRpb25MaW1pdCA6IHR5cGVvZiBvcHRpb25zLm9yZ2FuaXphdGlvbkxpbWl0ID09PSBcImZ1bmN0aW9uXCIgPyBhd2FpdCBvcHRpb25zLm9yZ2FuaXphdGlvbkxpbWl0KHVzZXIpIDogZmFsc2U7XG4gICAgaWYgKGhhc1JlYWNoZWRPcmdMaW1pdCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9IQVZFX1JFQUNIRURfVEhFX01BWElNVU1fTlVNQkVSX09GX09SR0FOSVpBVElPTlNcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBleGlzdGluZ09yZ2FuaXphdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9yZ2FuaXphdGlvbkJ5U2x1ZyhcbiAgICAgIGN0eC5ib2R5LnNsdWdcbiAgICApO1xuICAgIGlmIChleGlzdGluZ09yZ2FuaXphdGlvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuT1JHQU5JWkFUSU9OX0FMUkVBRFlfRVhJU1RTXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlT3JnYW5pemF0aW9uKHtcbiAgICAgIG9yZ2FuaXphdGlvbjoge1xuICAgICAgICBpZDogZ2VuZXJhdGVJZCgpLFxuICAgICAgICBzbHVnOiBjdHguYm9keS5zbHVnLFxuICAgICAgICBuYW1lOiBjdHguYm9keS5uYW1lLFxuICAgICAgICBsb2dvOiBjdHguYm9keS5sb2dvLFxuICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICBtZXRhZGF0YTogY3R4LmJvZHkubWV0YWRhdGFcbiAgICAgIH0sXG4gICAgICB1c2VyXG4gICAgfSk7XG4gICAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb24pIHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuc2V0QWN0aXZlT3JnYW5pemF0aW9uKFxuICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgIG9yZ2FuaXphdGlvbjIuaWRcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbihvcmdhbml6YXRpb24yKTtcbiAgfVxuKTtcbnZhciB1cGRhdGVPcmdhbml6YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi91cGRhdGVcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgZGF0YTogei5vYmplY3Qoe1xuICAgICAgICBuYW1lOiB6LnN0cmluZyh7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIG9yZ2FuaXphdGlvblwiXG4gICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgIHNsdWc6IHouc3RyaW5nKHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgc2x1ZyBvZiB0aGUgb3JnYW5pemF0aW9uXCJcbiAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgbG9nbzogei5zdHJpbmcoe1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBsb2dvIG9mIHRoZSBvcmdhbml6YXRpb25cIlxuICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICBtZXRhZGF0YTogei5yZWNvcmQoei5zdHJpbmcoKSwgei5hbnkoKSwge1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBtZXRhZGF0YSBvZiB0aGUgb3JnYW5pemF0aW9uXCJcbiAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgfSkucGFydGlhbCgpLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlVwZGF0ZSBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1cGRhdGVkIG9yZ2FuaXphdGlvblwiLFxuICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Pcmdhbml6YXRpb25cIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5nZXRTZXNzaW9uKGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlVzZXIgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBvcmdhbml6YXRpb25JZCA9IGN0eC5ib2R5Lm9yZ2FuaXphdGlvbklkIHx8IHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbklkKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5PUkdBTklaQVRJT05fTk9UX0ZPVU5EXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLlVTRVJfSVNfTk9UX0FfTUVNQkVSX09GX1RIRV9PUkdBTklaQVRJT05cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJvbGUyID0gY3R4LmNvbnRleHQucm9sZXNbbWVtYmVyLnJvbGVdO1xuICAgIGlmICghcm9sZTIpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJSb2xlIG5vdCBmb3VuZCFcIlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY2FuVXBkYXRlT3JnID0gcm9sZTIuYXV0aG9yaXplKHtcbiAgICAgIG9yZ2FuaXphdGlvbjogW1widXBkYXRlXCJdXG4gICAgfSk7XG4gICAgaWYgKGNhblVwZGF0ZU9yZy5lcnJvcikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9BTExPV0VEX1RPX1VQREFURV9USElTX09SR0FOSVpBVElPTlxuICAgICAgICB9LFxuICAgICAgICBzdGF0dXM6IDQwM1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHVwZGF0ZWRPcmcgPSBhd2FpdCBhZGFwdGVyLnVwZGF0ZU9yZ2FuaXphdGlvbihcbiAgICAgIG9yZ2FuaXphdGlvbklkLFxuICAgICAgY3R4LmJvZHkuZGF0YVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHVwZGF0ZWRPcmcpO1xuICB9XG4pO1xudmFyIGRlbGV0ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2RlbGV0ZVwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIGlkIHRvIGRlbGV0ZVwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkRlbGV0ZSBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb24gaWQgdGhhdCB3YXMgZGVsZXRlZFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmdldFNlc3Npb24oY3R4KTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAxXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25JZDtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbklkKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5PUkdBTklaQVRJT05fTk9UX0ZPVU5EXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLlVTRVJfSVNfTk9UX0FfTUVNQkVSX09GX1RIRV9PUkdBTklaQVRJT05cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJvbGUyID0gY3R4LmNvbnRleHQucm9sZXNbbWVtYmVyLnJvbGVdO1xuICAgIGlmICghcm9sZTIpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJSb2xlIG5vdCBmb3VuZCFcIlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY2FuRGVsZXRlT3JnID0gcm9sZTIuYXV0aG9yaXplKHtcbiAgICAgIG9yZ2FuaXphdGlvbjogW1wiZGVsZXRlXCJdXG4gICAgfSk7XG4gICAgaWYgKGNhbkRlbGV0ZU9yZy5lcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9BUkVfTk9UX0FMTE9XRURfVE9fREVMRVRFX1RISVNfT1JHQU5JWkFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKG9yZ2FuaXphdGlvbklkID09PSBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQpIHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuc2V0QWN0aXZlT3JnYW5pemF0aW9uKHNlc3Npb24uc2Vzc2lvbi50b2tlbiwgbnVsbCk7XG4gICAgfVxuICAgIGNvbnN0IG9wdGlvbiA9IGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMub3JnYW5pemF0aW9uRGVsZXRpb247XG4gICAgaWYgKG9wdGlvbj8uZGlzYWJsZWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiKTtcbiAgICB9XG4gICAgY29uc3Qgb3JnID0gYXdhaXQgYWRhcHRlci5maW5kT3JnYW5pemF0aW9uQnlJZChvcmdhbml6YXRpb25JZCk7XG4gICAgaWYgKCFvcmcpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIpO1xuICAgIH1cbiAgICBpZiAob3B0aW9uPy5iZWZvcmVEZWxldGUpIHtcbiAgICAgIGF3YWl0IG9wdGlvbi5iZWZvcmVEZWxldGUoe1xuICAgICAgICBvcmdhbml6YXRpb246IG9yZyxcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgYWRhcHRlci5kZWxldGVPcmdhbml6YXRpb24ob3JnYW5pemF0aW9uSWQpO1xuICAgIGlmIChvcHRpb24/LmFmdGVyRGVsZXRlKSB7XG4gICAgICBhd2FpdCBvcHRpb24uYWZ0ZXJEZWxldGUoe1xuICAgICAgICBvcmdhbml6YXRpb246IG9yZyxcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKG9yZyk7XG4gIH1cbik7XG52YXIgZ2V0RnVsbE9yZ2FuaXphdGlvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2dldC1mdWxsLW9yZ2FuaXphdGlvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiB6Lm9wdGlvbmFsKFxuICAgICAgei5vYmplY3Qoe1xuICAgICAgICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoe1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb24gaWQgdG8gZ2V0XCJcbiAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgb3JnYW5pemF0aW9uU2x1Zzogei5zdHJpbmcoe1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb24gc2x1ZyB0byBnZXRcIlxuICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICB9KVxuICAgICksXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgdXNlOiBbb3JnTWlkZGxld2FyZSwgb3JnU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkdldCB0aGUgZnVsbCBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb25cIixcbiAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvT3JnYW5pemF0aW9uXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBvcmdhbml6YXRpb25JZCA9IGN0eC5xdWVyeT8ub3JnYW5pemF0aW9uU2x1ZyB8fCBjdHgucXVlcnk/Lm9yZ2FuaXphdGlvbklkIHx8IHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbklkKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDIwMFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBvcmdhbml6YXRpb24yID0gYXdhaXQgYWRhcHRlci5maW5kRnVsbE9yZ2FuaXphdGlvbih7XG4gICAgICBvcmdhbml6YXRpb25JZCxcbiAgICAgIGlzU2x1ZzogISFjdHgucXVlcnk/Lm9yZ2FuaXphdGlvblNsdWdcbiAgICB9KTtcbiAgICBjb25zdCBpc01lbWJlciA9IG9yZ2FuaXphdGlvbjI/Lm1lbWJlcnMuZmluZChcbiAgICAgIChtZW1iZXIpID0+IG1lbWJlci51c2VySWQgPT09IHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgaWYgKCFpc01lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLlVTRVJfSVNfTk9UX0FfTUVNQkVSX09GX1RIRV9PUkdBTklaQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIW9yZ2FuaXphdGlvbjIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk9SR0FOSVpBVElPTl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24ob3JnYW5pemF0aW9uMik7XG4gIH1cbik7XG52YXIgc2V0QWN0aXZlT3JnYW5pemF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vc2V0LWFjdGl2ZVwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIGlkIHRvIHNldCBhcyBhY3RpdmUuIEl0IGNhbiBiZSBudWxsIHRvIHVuc2V0IHRoZSBhY3RpdmUgb3JnYW5pemF0aW9uXCJcbiAgICAgIH0pLm51bGxhYmxlKCkub3B0aW9uYWwoKSxcbiAgICAgIG9yZ2FuaXphdGlvblNsdWc6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9yZ2FuaXphdGlvbiBzbHVnIHRvIHNldCBhcyBhY3RpdmUuIEl0IGNhbiBiZSBudWxsIHRvIHVuc2V0IHRoZSBhY3RpdmUgb3JnYW5pemF0aW9uIGlmIG9yZ2FuaXphdGlvbklkIGlzIG5vdCBwcm92aWRlZFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbb3JnU2Vzc2lvbk1pZGRsZXdhcmUsIG9yZ01pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNldCB0aGUgYWN0aXZlIG9yZ2FuaXphdGlvblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9yZ2FuaXphdGlvblwiLFxuICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Pcmdhbml6YXRpb25cIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBsZXQgb3JnYW5pemF0aW9uSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25TbHVnIHx8IGN0eC5ib2R5Lm9yZ2FuaXphdGlvbklkO1xuICAgIGlmIChvcmdhbml6YXRpb25JZCA9PT0gbnVsbCkge1xuICAgICAgY29uc3Qgc2Vzc2lvbk9yZ0lkID0gc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkO1xuICAgICAgaWYgKCFzZXNzaW9uT3JnSWQpIHtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgfVxuICAgICAgY29uc3QgdXBkYXRlZFNlc3Npb24yID0gYXdhaXQgYWRhcHRlci5zZXRBY3RpdmVPcmdhbml6YXRpb24oXG4gICAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgICAgbnVsbFxuICAgICAgKTtcbiAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgIHNlc3Npb246IHVwZGF0ZWRTZXNzaW9uMixcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICB9XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgY29uc3Qgc2Vzc2lvbk9yZ0lkID0gc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkO1xuICAgICAgaWYgKCFzZXNzaW9uT3JnSWQpIHtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgfVxuICAgICAgb3JnYW5pemF0aW9uSWQgPSBzZXNzaW9uT3JnSWQ7XG4gICAgfVxuICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLmZpbmRGdWxsT3JnYW5pemF0aW9uKHtcbiAgICAgIG9yZ2FuaXphdGlvbklkLFxuICAgICAgaXNTbHVnOiAhIWN0eC5ib2R5Lm9yZ2FuaXphdGlvblNsdWdcbiAgICB9KTtcbiAgICBjb25zdCBpc01lbWJlciA9IG9yZ2FuaXphdGlvbjI/Lm1lbWJlcnMuZmluZChcbiAgICAgIChtZW1iZXIpID0+IG1lbWJlci51c2VySWQgPT09IHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgaWYgKCFpc01lbWJlcikge1xuICAgICAgYXdhaXQgYWRhcHRlci5zZXRBY3RpdmVPcmdhbml6YXRpb24oc2Vzc2lvbi5zZXNzaW9uLnRva2VuLCBudWxsKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX05PVF9BX01FTUJFUl9PRl9USEVfT1JHQU5JWkFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFvcmdhbml6YXRpb24yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5PUkdBTklaQVRJT05fTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdXBkYXRlZFNlc3Npb24gPSBhd2FpdCBhZGFwdGVyLnNldEFjdGl2ZU9yZ2FuaXphdGlvbihcbiAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgIG9yZ2FuaXphdGlvbjIuaWRcbiAgICApO1xuICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICBzZXNzaW9uOiB1cGRhdGVkU2Vzc2lvbixcbiAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgIH0pO1xuICAgIHJldHVybiBjdHguanNvbihvcmdhbml6YXRpb24yKTtcbiAgfVxuKTtcbnZhciBsaXN0T3JnYW5pemF0aW9ucyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2xpc3RcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCBhbGwgb3JnYW5pemF0aW9uc1wiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL09yZ2FuaXphdGlvblwiXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IG9yZ2FuaXphdGlvbnMgPSBhd2FpdCBhZGFwdGVyLmxpc3RPcmdhbml6YXRpb25zKFxuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24ob3JnYW5pemF0aW9ucyk7XG4gIH1cbik7XG5cbi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9vcmdhbml6YXRpb24udHNcbnZhciBvcmdhbml6YXRpb24gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBlbmRwb2ludHMgPSB7XG4gICAgY3JlYXRlT3JnYW5pemF0aW9uLFxuICAgIHVwZGF0ZU9yZ2FuaXphdGlvbixcbiAgICBkZWxldGVPcmdhbml6YXRpb24sXG4gICAgc2V0QWN0aXZlT3JnYW5pemF0aW9uLFxuICAgIGdldEZ1bGxPcmdhbml6YXRpb24sXG4gICAgbGlzdE9yZ2FuaXphdGlvbnMsXG4gICAgY3JlYXRlSW52aXRhdGlvbjogY3JlYXRlSW52aXRhdGlvbigpLFxuICAgIGNhbmNlbEludml0YXRpb24sXG4gICAgYWNjZXB0SW52aXRhdGlvbixcbiAgICBnZXRJbnZpdGF0aW9uLFxuICAgIHJlamVjdEludml0YXRpb24sXG4gICAgYWRkTWVtYmVyOiBhZGRNZW1iZXIoKSxcbiAgICByZW1vdmVNZW1iZXIsXG4gICAgdXBkYXRlTWVtYmVyUm9sZTogdXBkYXRlTWVtYmVyUm9sZSgpLFxuICAgIGdldEFjdGl2ZU1lbWJlcixcbiAgICBsZWF2ZU9yZ2FuaXphdGlvblxuICB9O1xuICBjb25zdCByb2xlcyA9IHtcbiAgICAuLi5kZWZhdWx0Um9sZXMsXG4gICAgLi4ub3B0aW9ucz8ucm9sZXNcbiAgfTtcbiAgY29uc3QgYXBpID0gc2hpbUNvbnRleHQoZW5kcG9pbnRzLCB7XG4gICAgb3JnT3B0aW9uczogb3B0aW9ucyB8fCB7fSxcbiAgICByb2xlcyxcbiAgICBnZXRTZXNzaW9uOiBhc3luYyAoY29udGV4dCkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGNvbnRleHQpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwib3JnYW5pemF0aW9uXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICAuLi5hcGksXG4gICAgICBoYXNQZXJtaXNzaW9uOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL29yZ2FuaXphdGlvbi9oYXMtcGVybWlzc2lvblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgcGVybWlzc2lvbjogei5yZWNvcmQoei5zdHJpbmcoKSwgei5hcnJheSh6LnN0cmluZygpKSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFtvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQ2hlY2sgaWYgdGhlIHVzZXIgaGFzIHBlcm1pc3Npb25cIixcbiAgICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBlcm1pc3Npb24gdG8gY2hlY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInBlcm1pc3Npb25cIl1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN1Y2Nlc3NcIl1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBpZiAoIWN0eC5ib2R5LnBlcm1pc3Npb24gfHwgT2JqZWN0LmtleXMoY3R4LmJvZHkucGVybWlzc2lvbikubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcImludmFsaWQgcGVybWlzc2lvbiBjaGVjay4geW91IGNhbiBvbmx5IGNoZWNrIG9uZSByZXNvdXJjZSBwZXJtaXNzaW9uIGF0IGEgdGltZS5cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGFjdGl2ZU9yZ2FuaXphdGlvbklkID0gY3R4LmJvZHkub3JnYW5pemF0aW9uSWQgfHwgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkO1xuICAgICAgICAgIGlmICghYWN0aXZlT3JnYW5pemF0aW9uSWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk5PX0FDVElWRV9PUkdBTklaQVRJT05cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCk7XG4gICAgICAgICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICAgICAgICB1c2VySWQ6IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBhY3RpdmVPcmdhbml6YXRpb25JZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghbWVtYmVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuVVNFUl9JU19OT1RfQV9NRU1CRVJfT0ZfVEhFX09SR0FOSVpBVElPTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJvbGUyID0gcm9sZXNbbWVtYmVyLnJvbGVdO1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHJvbGUyLmF1dGhvcml6ZShjdHguYm9keS5wZXJtaXNzaW9uKTtcbiAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBlcnJvcjogcmVzdWx0LmVycm9yLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDQwM1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIHNjaGVtYToge1xuICAgICAgc2Vzc2lvbjoge1xuICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICBhY3RpdmVPcmdhbml6YXRpb25JZDoge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5zZXNzaW9uPy5maWVsZHM/LmFjdGl2ZU9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3JnYW5pemF0aW9uOiB7XG4gICAgICAgIG1vZGVsTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5vcmdhbml6YXRpb24/Lm1vZGVsTmFtZSxcbiAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ub3JnYW5pemF0aW9uPy5maWVsZHM/Lm5hbWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNsdWc6IHtcbiAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5vcmdhbml6YXRpb24/LmZpZWxkcz8uc2x1Z1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbG9nbzoge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5vcmdhbml6YXRpb24/LmZpZWxkcz8ubG9nb1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm9yZ2FuaXphdGlvbj8uZmllbGRzPy5jcmVhdGVkQXRcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm9yZ2FuaXphdGlvbj8uZmllbGRzPy5tZXRhZGF0YVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG1lbWJlcjoge1xuICAgICAgICBtb2RlbE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ubWVtYmVyPy5tb2RlbE5hbWUsXG4gICAgICAgIGZpZWxkczoge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm1lbWJlcj8uZmllbGRzPy5vcmdhbml6YXRpb25JZFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdXNlcklkOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ubWVtYmVyPy5maWVsZHM/LnVzZXJJZCxcbiAgICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICByb2xlOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogXCJtZW1iZXJcIixcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5tZW1iZXI/LmZpZWxkcz8ucm9sZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm1lbWJlcj8uZmllbGRzPy5jcmVhdGVkQXRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbnZpdGF0aW9uOiB7XG4gICAgICAgIG1vZGVsTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5pbnZpdGF0aW9uPy5tb2RlbE5hbWUsXG4gICAgICAgIGZpZWxkczoge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lmludml0YXRpb24/LmZpZWxkcz8ub3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5pbnZpdGF0aW9uPy5maWVsZHM/LmVtYWlsXG4gICAgICAgICAgfSxcbiAgICAgICAgICByb2xlOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8uaW52aXRhdGlvbj8uZmllbGRzPy5yb2xlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBcInBlbmRpbmdcIixcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5pbnZpdGF0aW9uPy5maWVsZHM/LnN0YXR1c1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lmludml0YXRpb24/LmZpZWxkcz8uZXhwaXJlc0F0XG4gICAgICAgICAgfSxcbiAgICAgICAgICBpbnZpdGVySWQ6IHtcbiAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5pbnZpdGF0aW9uPy5maWVsZHM/Lmludml0ZXJJZCxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICAkSW5mZXI6IHtcbiAgICAgIE9yZ2FuaXphdGlvbjoge30sXG4gICAgICBJbnZpdGF0aW9uOiB7fSxcbiAgICAgIE1lbWJlcjoge30sXG4gICAgICBBY3RpdmVPcmdhbml6YXRpb246IHt9XG4gICAgfSxcbiAgICAkRVJST1JfQ09ERVM6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFU1xuICB9O1xufTtcblxuZXhwb3J0IHsgb3JnYW5pemF0aW9uIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter)\n/* harmony export */ });\n// src/utils/misc.ts\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstM1hUUVNQUEEuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVpQyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTNYVFFTUFBBLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy91dGlscy9taXNjLnRzXG5mdW5jdGlvbiBjYXBpdGFsaXplRmlyc3RMZXR0ZXIoc3RyKSB7XG4gIHJldHVybiBzdHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSk7XG59XG5cbmV4cG9ydCB7IGNhcGl0YWxpemVGaXJzdExldHRlciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   safeJSONParse: () => (/* binding */ safeJSONParse)\n/* harmony export */ });\n// src/utils/json.ts\nfunction safeJSONParse(data) {\n  function reviver(_, value) {\n    if (typeof value === \"string\") {\n      const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z$/;\n      if (iso8601Regex.test(value)) {\n        const date = new Date(value);\n        if (!isNaN(date.getTime())) {\n          return date;\n        }\n      }\n    }\n    return value;\n  }\n  try {\n    return JSON.parse(data, reviver);\n  } catch {\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstNTNJUE8yUEouanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFeUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay01M0lQTzJQSi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvanNvbi50c1xuZnVuY3Rpb24gc2FmZUpTT05QYXJzZShkYXRhKSB7XG4gIGZ1bmN0aW9uIHJldml2ZXIoXywgdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBpc284NjAxUmVnZXggPSAvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9VFxcZHsyfTpcXGR7Mn06XFxkezJ9KD86XFwuXFxkKyk/WiQvO1xuICAgICAgaWYgKGlzbzg2MDFSZWdleC50ZXN0KHZhbHVlKSkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICAgICAgICBpZiAoIWlzTmFOKGRhdGUuZ2V0VGltZSgpKSkge1xuICAgICAgICAgIHJldHVybiBkYXRlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICB0cnkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEsIHJldml2ZXIpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgeyBzYWZlSlNPTlBhcnNlIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertFromDB: () => (/* binding */ convertFromDB),\n/* harmony export */   convertToDB: () => (/* binding */ convertToDB),\n/* harmony export */   createFieldAttribute: () => (/* binding */ createFieldAttribute),\n/* harmony export */   createInternalAdapter: () => (/* binding */ createInternalAdapter),\n/* harmony export */   createKyselyAdapter: () => (/* binding */ createKyselyAdapter),\n/* harmony export */   getAdapter: () => (/* binding */ getAdapter),\n/* harmony export */   getAuthTables: () => (/* binding */ getAuthTables),\n/* harmony export */   getMigrations: () => (/* binding */ getMigrations),\n/* harmony export */   getSchema: () => (/* binding */ getSchema),\n/* harmony export */   getWithHooks: () => (/* binding */ getWithHooks),\n/* harmony export */   kyselyAdapter: () => (/* binding */ kyselyAdapter),\n/* harmony export */   matchType: () => (/* binding */ matchType),\n/* harmony export */   memoryAdapter: () => (/* binding */ memoryAdapter),\n/* harmony export */   toZodSchema: () => (/* binding */ toZodSchema),\n/* harmony export */   withApplyDefault: () => (/* binding */ withApplyDefault)\n/* harmony export */ });\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! kysely */ \"(action-browser)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! kysely */ \"(action-browser)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! kysely */ \"(action-browser)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! kysely */ \"(action-browser)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/mssql/mssql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! kysely */ \"(action-browser)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/kysely.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\nfunction getDatabaseType(db) {\n  if (!db) {\n    return null;\n  }\n  if (\"dialect\" in db) {\n    return getDatabaseType(db.dialect);\n  }\n  if (\"createDriver\" in db) {\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_6__.SqliteDialect) {\n      return \"sqlite\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_7__.MysqlDialect) {\n      return \"mysql\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_8__.PostgresDialect) {\n      return \"postgres\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_9__.MssqlDialect) {\n      return \"mssql\";\n    }\n  }\n  if (\"aggregate\" in db) {\n    return \"sqlite\";\n  }\n  if (\"getConnection\" in db) {\n    return \"mysql\";\n  }\n  if (\"connect\" in db) {\n    return \"postgres\";\n  }\n  return null;\n}\nvar createKyselyAdapter = async (config) => {\n  const db = config.database;\n  if (!db) {\n    return {\n      kysely: null,\n      databaseType: null\n    };\n  }\n  if (\"db\" in db) {\n    return {\n      kysely: db.db,\n      databaseType: db.type\n    };\n  }\n  if (\"dialect\" in db) {\n    return {\n      kysely: new kysely__WEBPACK_IMPORTED_MODULE_10__.Kysely({ dialect: db.dialect }),\n      databaseType: db.type\n    };\n  }\n  let dialect = void 0;\n  const databaseType = getDatabaseType(db);\n  if (\"createDriver\" in db) {\n    dialect = db;\n  }\n  if (\"aggregate\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_6__.SqliteDialect({\n      database: db\n    });\n  }\n  if (\"getConnection\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_7__.MysqlDialect(db);\n  }\n  if (\"connect\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_8__.PostgresDialect({\n      pool: db\n    });\n  }\n  return {\n    kysely: dialect ? new kysely__WEBPACK_IMPORTED_MODULE_10__.Kysely({ dialect }) : null,\n    databaseType\n  };\n};\n\n// src/db/with-hooks.ts\nfunction getWithHooks(adapter, ctx) {\n  const hooks = ctx.hooks;\n  async function createWithHooks(data, model, customCreateFn) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.before;\n      if (toRun) {\n        const result = await toRun(actualData);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\" && \"data\" in result;\n        if (isObject) {\n          actualData = {\n            ...actualData,\n            ...result.data\n          };\n        }\n      }\n    }\n    const customCreated = customCreateFn ? await customCreateFn.fn(actualData) : null;\n    const created = !customCreateFn || customCreateFn.executeMainFn ? await adapter.create({\n      model,\n      data: actualData\n    }) : customCreated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.after;\n      if (toRun) {\n        await toRun(created);\n      }\n    }\n    return created;\n  }\n  async function updateWithHooks(data, where, model, customUpdateFn) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await adapter.update({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated);\n      }\n    }\n    return updated;\n  }\n  async function updateManyWithHooks(data, where, model, customUpdateFn) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await adapter.updateMany({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated);\n      }\n    }\n    return updated;\n  }\n  return {\n    createWithHooks,\n    updateWithHooks,\n    updateManyWithHooks\n  };\n}\n\n// src/db/internal-adapter.ts\nvar createInternalAdapter = (adapter, ctx) => {\n  const options = ctx.options;\n  const secondaryStorage = options.secondaryStorage;\n  const sessionExpiration = options.session?.expiresIn || 60 * 60 * 24 * 7;\n  const { createWithHooks, updateWithHooks, updateManyWithHooks } = getWithHooks(adapter, ctx);\n  return {\n    createOAuthUser: async (user, account) => {\n      const createdUser = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...user\n        },\n        \"user\"\n      );\n      const createdAccount = await createWithHooks(\n        {\n          ...account,\n          userId: createdUser.id || user.id,\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date()\n        },\n        \"account\"\n      );\n      return {\n        user: createdUser,\n        account: createdAccount\n      };\n    },\n    createUser: async (user) => {\n      const createdUser = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          emailVerified: false,\n          ...user,\n          email: user.email.toLowerCase()\n        },\n        \"user\"\n      );\n      return createdUser;\n    },\n    createAccount: async (account) => {\n      const createdAccount = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\"\n      );\n      return createdAccount;\n    },\n    listSessions: async (userId) => {\n      if (secondaryStorage) {\n        const currentList = await secondaryStorage.get(\n          `active-sessions-${userId}`\n        );\n        if (!currentList) return [];\n        const list = (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__.safeJSONParse)(currentList) || [];\n        const now = Date.now();\n        const validSessions = list.filter((s) => s.expiresAt > now);\n        const sessions2 = [];\n        for (const session of validSessions) {\n          const sessionStringified = await secondaryStorage.get(session.token);\n          if (sessionStringified) {\n            const s = JSON.parse(sessionStringified);\n            const parsedSession = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseSessionOutput)(ctx.options, {\n              ...s.session,\n              expiresAt: new Date(s.session.expiresAt)\n            });\n            sessions2.push(parsedSession);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await adapter.findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return sessions;\n    },\n    listUsers: async (limit, offset, sortBy, where) => {\n      const users = await adapter.findMany({\n        model: \"user\",\n        limit,\n        offset,\n        sortBy,\n        where\n      });\n      return users;\n    },\n    deleteUser: async (userId) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(`active-sessions-${userId}`);\n      }\n      if (!secondaryStorage || options.session?.storeSessionInDatabase) {\n        await adapter.deleteMany({\n          model: \"session\",\n          where: [\n            {\n              field: \"userId\",\n              value: userId\n            }\n          ]\n        });\n      }\n      await adapter.deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n    },\n    createSession: async (userId, request, dontRememberMe, override, overrideAll) => {\n      const headers = request instanceof Request ? request.headers : request;\n      const { id: _, ...rest } = override || {};\n      const data = {\n        ipAddress: request ? (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.getIp)(request, ctx.options) || \"\" : \"\",\n        userAgent: headers?.get(\"user-agent\") || \"\",\n        ...rest,\n        /**\n         * If the user doesn't want to be remembered\n         * set the session to expire in 1 day.\n         * The cookie will be set to expire at the end of the session\n         */\n        expiresAt: dontRememberMe ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(60 * 60 * 24, \"sec\") : (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(sessionExpiration, \"sec\"),\n        userId,\n        token: (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.generateId)(32),\n        createdAt: /* @__PURE__ */ new Date(),\n        updatedAt: /* @__PURE__ */ new Date(),\n        ...overrideAll ? rest : {}\n      };\n      const res = await createWithHooks(\n        data,\n        \"session\",\n        secondaryStorage ? {\n          fn: async (sessionData) => {\n            const currentList = await secondaryStorage.get(\n              `active-sessions-${userId}`\n            );\n            let list = [];\n            const now = Date.now();\n            if (currentList) {\n              list = (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__.safeJSONParse)(currentList) || [];\n              list = list.filter((session) => session.expiresAt > now);\n            }\n            list.push({\n              token: data.token,\n              expiresAt: now + sessionExpiration * 1e3\n            });\n            await secondaryStorage.set(\n              `active-sessions-${userId}`,\n              JSON.stringify(list),\n              sessionExpiration\n            );\n            return sessionData;\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0\n      );\n      return res;\n    },\n    findSession: async (token) => {\n      if (secondaryStorage) {\n        const sessionStringified = await secondaryStorage.get(token);\n        if (!sessionStringified) {\n          return null;\n        }\n        const s = JSON.parse(sessionStringified);\n        const parsedSession2 = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseSessionOutput)(ctx.options, {\n          ...s.session,\n          expiresAt: new Date(s.session.expiresAt),\n          createdAt: new Date(s.session.createdAt),\n          updatedAt: new Date(s.session.updatedAt)\n        });\n        const parsedUser2 = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseUserOutput)(ctx.options, {\n          ...s.user,\n          createdAt: new Date(s.user.createdAt),\n          updatedAt: new Date(s.user.updatedAt)\n        });\n        return {\n          session: parsedSession2,\n          user: parsedUser2\n        };\n      }\n      const session = await adapter.findOne({\n        model: \"session\",\n        where: [\n          {\n            value: token,\n            field: \"token\"\n          }\n        ]\n      });\n      if (!session) {\n        return null;\n      }\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            value: session.userId,\n            field: \"id\"\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const parsedSession = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseSessionOutput)(ctx.options, session);\n      const parsedUser = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseUserOutput)(ctx.options, user);\n      return {\n        session: parsedSession,\n        user: parsedUser\n      };\n    },\n    findSessions: async (sessionTokens) => {\n      if (secondaryStorage) {\n        const sessions2 = [];\n        for (const sessionToken of sessionTokens) {\n          const sessionStringified = await secondaryStorage.get(sessionToken);\n          if (sessionStringified) {\n            const s = JSON.parse(sessionStringified);\n            const session = {\n              session: {\n                ...s.session,\n                expiresAt: new Date(s.session.expiresAt)\n              },\n              user: {\n                ...s.user,\n                createdAt: new Date(s.user.createdAt),\n                updatedAt: new Date(s.user.updatedAt)\n              }\n            };\n            sessions2.push(session);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await adapter.findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: sessionTokens,\n            operator: \"in\"\n          }\n        ]\n      });\n      const userIds = sessions.map((session) => {\n        return session.userId;\n      });\n      if (!userIds.length) return [];\n      const users = await adapter.findMany({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return sessions.map((session) => {\n        const user = users.find((u) => u.id === session.userId);\n        if (!user) return null;\n        return {\n          session,\n          user\n        };\n      });\n    },\n    updateSession: async (sessionToken, session) => {\n      const updatedSession = await updateWithHooks(\n        session,\n        [{ field: \"token\", value: sessionToken }],\n        \"session\",\n        secondaryStorage ? {\n          async fn(data) {\n            const currentSession = await secondaryStorage.get(sessionToken);\n            let updatedSession2 = null;\n            if (currentSession) {\n              const parsedSession = JSON.parse(currentSession);\n              updatedSession2 = {\n                ...parsedSession.session,\n                ...data\n              };\n              return updatedSession2;\n            } else {\n              return null;\n            }\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0\n      );\n      return updatedSession;\n    },\n    deleteSession: async (token) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(token);\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await adapter.delete({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: token\n          }\n        ]\n      });\n    },\n    deleteAccounts: async (userId) => {\n      await adapter.deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteAccount: async (providerId, userId) => {\n      await adapter.delete({\n        model: \"account\",\n        where: [\n          {\n            field: \"providerId\",\n            value: providerId\n          },\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteSessions: async (userIdOrSessionTokens) => {\n      if (secondaryStorage) {\n        if (typeof userIdOrSessionTokens === \"string\") {\n          const activeSession = await secondaryStorage.get(\n            `active-sessions-${userIdOrSessionTokens}`\n          );\n          const sessions = activeSession ? (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__.safeJSONParse)(activeSession) : [];\n          if (!sessions) return;\n          for (const session of sessions) {\n            await secondaryStorage.delete(session.token);\n          }\n        } else {\n          for (const sessionToken of userIdOrSessionTokens) {\n            const session = await secondaryStorage.get(sessionToken);\n            if (session) {\n              await secondaryStorage.delete(sessionToken);\n            }\n          }\n        }\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await adapter.deleteMany({\n        model: \"session\",\n        where: [\n          {\n            field: Array.isArray(userIdOrSessionTokens) ? \"token\" : \"userId\",\n            value: userIdOrSessionTokens,\n            operator: Array.isArray(userIdOrSessionTokens) ? \"in\" : void 0\n          }\n        ]\n      });\n    },\n    findOAuthUser: async (email, accountId, providerId) => {\n      const account = await adapter.findOne({\n        model: \"account\",\n        where: [\n          {\n            value: accountId,\n            field: \"accountId\"\n          },\n          {\n            value: providerId,\n            field: \"providerId\"\n          }\n        ]\n      });\n      if (account) {\n        const user = await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              value: account.userId,\n              field: \"id\"\n            }\n          ]\n        });\n        if (user) {\n          return {\n            user,\n            accounts: [account]\n          };\n        } else {\n          return null;\n        }\n      } else {\n        const user = await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              value: email.toLowerCase(),\n              field: \"email\"\n            }\n          ]\n        });\n        if (user) {\n          const accounts = await adapter.findMany({\n            model: \"account\",\n            where: [\n              {\n                value: user.id,\n                field: \"userId\"\n              }\n            ]\n          });\n          return {\n            user,\n            accounts: accounts || []\n          };\n        } else {\n          return null;\n        }\n      }\n    },\n    findUserByEmail: async (email, options2) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            value: email.toLowerCase(),\n            field: \"email\"\n          }\n        ]\n      });\n      if (!user) return null;\n      if (options2?.includeAccounts) {\n        const accounts = await adapter.findMany({\n          model: \"account\",\n          where: [\n            {\n              value: user.id,\n              field: \"userId\"\n            }\n          ]\n        });\n        return {\n          user,\n          accounts\n        };\n      }\n      return {\n        user,\n        accounts: []\n      };\n    },\n    findUserById: async (userId) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n      return user;\n    },\n    linkAccount: async (account) => {\n      const _account = await createWithHooks(\n        {\n          ...account,\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date()\n        },\n        \"account\"\n      );\n      return _account;\n    },\n    updateUser: async (userId, data) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ],\n        \"user\"\n      );\n      return user;\n    },\n    updateUserByEmail: async (email, data) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"email\",\n            value: email.toLowerCase()\n          }\n        ],\n        \"user\"\n      );\n      return user;\n    },\n    updatePassword: async (userId, password) => {\n      await updateManyWithHooks(\n        {\n          password\n        },\n        [\n          {\n            field: \"userId\",\n            value: userId\n          },\n          {\n            field: \"providerId\",\n            value: \"credential\"\n          }\n        ],\n        \"account\"\n      );\n    },\n    findAccounts: async (userId) => {\n      const accounts = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return accounts;\n    },\n    findAccount: async (accountId) => {\n      const account = await adapter.findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByUserId: async (userId) => {\n      const account = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return account;\n    },\n    updateAccount: async (accountId, data) => {\n      const account = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: accountId }],\n        \"account\"\n      );\n      return account;\n    },\n    createVerificationValue: async (data) => {\n      const verification = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...data\n        },\n        \"verification\"\n      );\n      return verification;\n    },\n    findVerificationValue: async (identifier) => {\n      const verification = await adapter.findMany({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ],\n        sortBy: {\n          field: \"createdAt\",\n          direction: \"desc\"\n        },\n        limit: 1\n      });\n      const lastVerification = verification[0];\n      return lastVerification;\n    },\n    deleteVerificationValue: async (id) => {\n      await adapter.delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n    },\n    deleteVerificationByIdentifier: async (identifier) => {\n      await adapter.delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ]\n      });\n    },\n    updateVerificationValue: async (id, data) => {\n      const verification = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"verification\"\n      );\n      return verification;\n    }\n  };\n};\n\n// src/db/field.ts\nvar createFieldAttribute = (type, config) => {\n  return {\n    type,\n    ...config\n  };\n};\n\n// src/db/get-tables.ts\nvar getAuthTables = (options) => {\n  const pluginSchema = options.plugins?.reduce(\n    (acc, plugin) => {\n      const schema = plugin.schema;\n      if (!schema) return acc;\n      for (const [key, value] of Object.entries(schema)) {\n        acc[key] = {\n          fields: {\n            ...acc[key]?.fields,\n            ...value.fields\n          },\n          modelName: value.modelName || key\n        };\n      }\n      return acc;\n    },\n    {}\n  );\n  const shouldAddRateLimitTable = options.rateLimit?.storage === \"database\";\n  const rateLimitTable = {\n    rateLimit: {\n      modelName: options.rateLimit?.modelName || \"rateLimit\",\n      fields: {\n        key: {\n          type: \"string\",\n          fieldName: options.rateLimit?.fields?.key || \"key\"\n        },\n        count: {\n          type: \"number\",\n          fieldName: options.rateLimit?.fields?.count || \"count\"\n        },\n        lastRequest: {\n          type: \"number\",\n          bigint: true,\n          fieldName: options.rateLimit?.fields?.lastRequest || \"lastRequest\"\n        }\n      }\n    }\n  };\n  const { user, session, account, ...pluginTables } = pluginSchema || {};\n  const sessionTable = {\n    session: {\n      modelName: options.session?.modelName || \"session\",\n      fields: {\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.expiresAt || \"expiresAt\"\n        },\n        token: {\n          type: \"string\",\n          required: true,\n          fieldName: options.session?.fields?.token || \"token\",\n          unique: true\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.updatedAt || \"updatedAt\"\n        },\n        ipAddress: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.ipAddress || \"ipAddress\"\n        },\n        userAgent: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.userAgent || \"userAgent\"\n        },\n        userId: {\n          type: \"string\",\n          fieldName: options.session?.fields?.userId || \"userId\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true\n        },\n        ...session?.fields,\n        ...options.session?.additionalFields\n      },\n      order: 2\n    }\n  };\n  return {\n    user: {\n      modelName: options.user?.modelName || \"user\",\n      fields: {\n        name: {\n          type: \"string\",\n          required: true,\n          fieldName: options.user?.fields?.name || \"name\",\n          sortable: true\n        },\n        email: {\n          type: \"string\",\n          unique: true,\n          required: true,\n          fieldName: options.user?.fields?.email || \"email\",\n          sortable: true\n        },\n        emailVerified: {\n          type: \"boolean\",\n          defaultValue: () => false,\n          required: true,\n          fieldName: options.user?.fields?.emailVerified || \"emailVerified\"\n        },\n        image: {\n          type: \"string\",\n          required: false,\n          fieldName: options.user?.fields?.image || \"image\"\n        },\n        createdAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...user?.fields,\n        ...options.user?.additionalFields\n      },\n      order: 1\n    },\n    //only add session table if it's not stored in secondary storage\n    ...!options.secondaryStorage || options.session?.storeSessionInDatabase ? sessionTable : {},\n    account: {\n      modelName: options.account?.modelName || \"account\",\n      fields: {\n        accountId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.accountId || \"accountId\"\n        },\n        providerId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.providerId || \"providerId\"\n        },\n        userId: {\n          type: \"string\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true,\n          fieldName: options.account?.fields?.userId || \"userId\"\n        },\n        accessToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.accessToken || \"accessToken\"\n        },\n        refreshToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.refreshToken || \"refreshToken\"\n        },\n        idToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.idToken || \"idToken\"\n        },\n        accessTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"accessTokenExpiresAt\"\n        },\n        refreshTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"refreshTokenExpiresAt\"\n        },\n        scope: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.scope || \"scope\"\n        },\n        password: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.password || \"password\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...account?.fields\n      },\n      order: 3\n    },\n    verification: {\n      modelName: options.verification?.modelName || \"verification\",\n      fields: {\n        identifier: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.identifier || \"identifier\"\n        },\n        value: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.value || \"value\"\n        },\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.verification?.fields?.expiresAt || \"expiresAt\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: false,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: false,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.updatedAt || \"updatedAt\"\n        }\n      },\n      order: 4\n    },\n    ...pluginTables,\n    ...shouldAddRateLimitTable ? rateLimitTable : {}\n  };\n};\nfunction toZodSchema(fields) {\n  const schema = zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n    ...Object.keys(fields).reduce((acc, key) => {\n      const field = fields[key];\n      if (!field) {\n        return acc;\n      }\n      if (field.type === \"string[]\" || field.type === \"number[]\") {\n        return {\n          ...acc,\n          [key]: zod__WEBPACK_IMPORTED_MODULE_5__.z.array(field.type === \"string[]\" ? zod__WEBPACK_IMPORTED_MODULE_5__.z.string() : zod__WEBPACK_IMPORTED_MODULE_5__.z.number())\n        };\n      }\n      if (Array.isArray(field.type)) {\n        return {\n          ...acc,\n          [key]: zod__WEBPACK_IMPORTED_MODULE_5__.z.any()\n        };\n      }\n      let schema2 = zod__WEBPACK_IMPORTED_MODULE_5__.z[field.type]();\n      if (field?.required === false) {\n        schema2 = schema2.optional();\n      }\n      if (field?.returned === false) {\n        return acc;\n      }\n      return {\n        ...acc,\n        [key]: schema2\n      };\n    }, {})\n  });\n  return schema;\n}\n\n// src/adapters/utils.ts\nfunction withApplyDefault(value, field, action) {\n  if (action === \"update\") {\n    return value;\n  }\n  if (value === void 0 || value === null) {\n    if (field.defaultValue) {\n      if (typeof field.defaultValue === \"function\") {\n        return field.defaultValue();\n      }\n      return field.defaultValue;\n    }\n  }\n  return value;\n}\n\n// src/adapters/memory-adapter/memory-adapter.ts\nvar createTransform = (options) => {\n  const schema = getAuthTables(options);\n  function getField(model, field) {\n    if (field === \"id\") {\n      return field;\n    }\n    const f = schema[model].fields[field];\n    return f.fieldName || field;\n  }\n  return {\n    transformInput(data, model, action) {\n      const transformedData = action === \"update\" ? {} : {\n        id: options.advanced?.generateId ? options.advanced.generateId({\n          model\n        }) : data.id || (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.generateId)()\n      };\n      const fields = schema[model].fields;\n      for (const field in fields) {\n        const value = data[field];\n        if (value === void 0 && !fields[field].defaultValue) {\n          continue;\n        }\n        transformedData[fields[field].fieldName || field] = withApplyDefault(\n          value,\n          fields[field],\n          action\n        );\n      }\n      return transformedData;\n    },\n    transformOutput(data, model, select = []) {\n      if (!data) return null;\n      const transformedData = data.id || data._id ? select.length === 0 || select.includes(\"id\") ? {\n        id: data.id\n      } : {} : {};\n      const tableSchema = schema[model].fields;\n      for (const key in tableSchema) {\n        if (select.length && !select.includes(key)) {\n          continue;\n        }\n        const field = tableSchema[key];\n        if (field) {\n          transformedData[key] = data[field.fieldName || key];\n        }\n      }\n      return transformedData;\n    },\n    convertWhereClause(where, table, model) {\n      return table.filter((record) => {\n        return where.every((clause) => {\n          const { field: _field, value, operator } = clause;\n          const field = getField(model, _field);\n          if (operator === \"in\") {\n            if (!Array.isArray(value)) {\n              throw new Error(\"Value must be an array\");\n            }\n            return value.includes(record[field]);\n          } else if (operator === \"contains\") {\n            return record[field].includes(value);\n          } else if (operator === \"starts_with\") {\n            return record[field].startsWith(value);\n          } else if (operator === \"ends_with\") {\n            return record[field].endsWith(value);\n          } else {\n            return record[field] === value;\n          }\n        });\n      });\n    },\n    getField\n  };\n};\nvar memoryAdapter = (db) => (options) => {\n  const { transformInput, transformOutput, convertWhereClause, getField } = createTransform(options);\n  return {\n    id: \"memory\",\n    create: async ({ model, data }) => {\n      const transformed = transformInput(data, model, \"create\");\n      db[model].push(transformed);\n      return transformOutput(transformed, model);\n    },\n    findOne: async ({ model, where, select }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      const record = res[0] || null;\n      return transformOutput(record, model, select);\n    },\n    findMany: async ({ model, where, sortBy, limit, offset }) => {\n      let table = db[model];\n      if (where) {\n        table = convertWhereClause(where, table, model);\n      }\n      if (sortBy) {\n        table = table.sort((a, b) => {\n          const field = getField(model, sortBy.field);\n          if (sortBy.direction === \"asc\") {\n            return a[field] > b[field] ? 1 : -1;\n          } else {\n            return a[field] < b[field] ? 1 : -1;\n          }\n        });\n      }\n      if (offset !== void 0) {\n        table = table.slice(offset);\n      }\n      if (limit !== void 0) {\n        table = table.slice(0, limit);\n      }\n      return table.map((record) => transformOutput(record, model));\n    },\n    update: async ({ model, where, update }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      res.forEach((record) => {\n        Object.assign(record, transformInput(update, model, \"update\"));\n      });\n      return transformOutput(res[0], model);\n    },\n    delete: async ({ model, where }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      db[model] = table.filter((record) => !res.includes(record));\n    },\n    deleteMany: async ({ model, where }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      let count = 0;\n      db[model] = table.filter((record) => {\n        if (res.includes(record)) {\n          count++;\n          return false;\n        }\n        return !res.includes(record);\n      });\n      return count;\n    },\n    updateMany(data) {\n      const { model, where, update } = data;\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      res.forEach((record) => {\n        Object.assign(record, update);\n      });\n      return res[0] || null;\n    }\n  };\n};\n\n// src/db/utils.ts\nasync function getAdapter(options) {\n  if (!options.database) {\n    const tables = getAuthTables(options);\n    const memoryDB = Object.keys(tables).reduce((acc, key) => {\n      acc[key] = [];\n      return acc;\n    }, {});\n    _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.warn(\n      \"No database configuration provided. Using memory adapter in development\"\n    );\n    return memoryAdapter(memoryDB)(options);\n  }\n  if (typeof options.database === \"function\") {\n    return options.database(options);\n  }\n  const { kysely, databaseType } = await createKyselyAdapter(options);\n  if (!kysely) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_4__.BetterAuthError(\"Failed to initialize database adapter\");\n  }\n  return kyselyAdapter(kysely, {\n    type: databaseType || \"sqlite\"\n  })(options);\n}\nfunction convertToDB(fields, values) {\n  let result = values.id ? {\n    id: values.id\n  } : {};\n  for (const key in fields) {\n    const field = fields[key];\n    const value = values[key];\n    if (value === void 0) {\n      continue;\n    }\n    result[field.fieldName || key] = value;\n  }\n  return result;\n}\nfunction convertFromDB(fields, values) {\n  if (!values) {\n    return null;\n  }\n  let result = {\n    id: values.id\n  };\n  for (const [key, value] of Object.entries(fields)) {\n    result[key] = values[value.fieldName || key];\n  }\n  return result;\n}\n\n// src/db/get-schema.ts\nfunction getSchema(config) {\n  const tables = getAuthTables(config);\n  let schema = {};\n  for (const key in tables) {\n    const table = tables[key];\n    const fields = table.fields;\n    let actualFields = {};\n    Object.entries(fields).forEach(([key2, field]) => {\n      actualFields[field.fieldName || key2] = field;\n      if (field.references) {\n        const refTable = tables[field.references.model];\n        if (refTable) {\n          actualFields[field.fieldName || key2].references = {\n            model: refTable.modelName,\n            field: field.references.field\n          };\n        }\n      }\n    });\n    if (schema[table.modelName]) {\n      schema[table.modelName].fields = {\n        ...schema[table.modelName].fields,\n        ...actualFields\n      };\n      continue;\n    }\n    schema[table.modelName] = {\n      fields: actualFields,\n      order: table.order || Infinity\n    };\n  }\n  return schema;\n}\n\n// src/db/get-migration.ts\nvar postgresMap = {\n  string: [\"character varying\", \"text\"],\n  number: [\n    \"int4\",\n    \"integer\",\n    \"bigint\",\n    \"smallint\",\n    \"numeric\",\n    \"real\",\n    \"double precision\"\n  ],\n  boolean: [\"bool\", \"boolean\"],\n  date: [\"timestamp\", \"date\"]\n};\nvar mysqlMap = {\n  string: [\"varchar\", \"text\"],\n  number: [\n    \"integer\",\n    \"int\",\n    \"bigint\",\n    \"smallint\",\n    \"decimal\",\n    \"float\",\n    \"double\"\n  ],\n  boolean: [\"boolean\", \"tinyint\"],\n  date: [\"timestamp\", \"datetime\", \"date\"]\n};\nvar sqliteMap = {\n  string: [\"TEXT\"],\n  number: [\"INTEGER\", \"REAL\"],\n  boolean: [\"INTEGER\", \"BOOLEAN\"],\n  // 0 or 1\n  date: [\"DATE\", \"INTEGER\"]\n};\nvar mssqlMap = {\n  string: [\"text\", \"varchar\"],\n  number: [\"int\", \"bigint\", \"smallint\", \"decimal\", \"float\", \"double\"],\n  boolean: [\"bit\", \"smallint\"],\n  date: [\"datetime\", \"date\"]\n};\nvar map = {\n  postgres: postgresMap,\n  mysql: mysqlMap,\n  sqlite: sqliteMap,\n  mssql: mssqlMap\n};\nfunction matchType(columnDataType, fieldType, dbType) {\n  if (fieldType === \"string[]\" || fieldType === \"number[]\") {\n    return columnDataType.toLowerCase().includes(\"json\");\n  }\n  const types = map[dbType];\n  const type = Array.isArray(fieldType) ? types[\"string\"].map((t) => t.toLowerCase()) : types[fieldType].map((t) => t.toLowerCase());\n  const matches = type.includes(columnDataType.toLowerCase());\n  return matches;\n}\nasync function getMigrations(config) {\n  const betterAuthSchema = getSchema(config);\n  const logger2 = (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.createLogger)(config.logger);\n  let { kysely: db, databaseType: dbType } = await createKyselyAdapter(config);\n  if (!dbType) {\n    logger2.warn(\n      \"Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this.\"\n    );\n    dbType = \"sqlite\";\n  }\n  if (!db) {\n    logger2.error(\n      \"Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter.\"\n    );\n    process.exit(1);\n  }\n  const tableMetadata = await db.introspection.getTables();\n  const toBeCreated = [];\n  const toBeAdded = [];\n  for (const [key, value] of Object.entries(betterAuthSchema)) {\n    const table = tableMetadata.find((t) => t.name === key);\n    if (!table) {\n      const tIndex = toBeCreated.findIndex((t) => t.table === key);\n      const tableData = {\n        table: key,\n        fields: value.fields,\n        order: value.order || Infinity\n      };\n      const insertIndex = toBeCreated.findIndex(\n        (t) => (t.order || Infinity) > tableData.order\n      );\n      if (insertIndex === -1) {\n        if (tIndex === -1) {\n          toBeCreated.push(tableData);\n        } else {\n          toBeCreated[tIndex].fields = {\n            ...toBeCreated[tIndex].fields,\n            ...value.fields\n          };\n        }\n      } else {\n        toBeCreated.splice(insertIndex, 0, tableData);\n      }\n      continue;\n    }\n    let toBeAddedFields = {};\n    for (const [fieldName, field] of Object.entries(value.fields)) {\n      const column = table.columns.find((c) => c.name === fieldName);\n      if (!column) {\n        toBeAddedFields[fieldName] = field;\n        continue;\n      }\n      if (matchType(column.dataType, field.type, dbType)) {\n        continue;\n      } else {\n        logger2.warn(\n          `Field ${fieldName} in table ${key} has a different type in the database. Expected ${field.type} but got ${column.dataType}.`\n        );\n      }\n    }\n    if (Object.keys(toBeAddedFields).length > 0) {\n      toBeAdded.push({\n        table: key,\n        fields: toBeAddedFields,\n        order: value.order || Infinity\n      });\n    }\n  }\n  const migrations = [];\n  function getType(field) {\n    const type = field.type;\n    const typeMap = {\n      string: {\n        sqlite: \"text\",\n        postgres: \"text\",\n        mysql: field.unique ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\",\n        mssql: field.unique || field.sortable ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\"\n      },\n      boolean: {\n        sqlite: \"integer\",\n        postgres: \"boolean\",\n        mysql: \"boolean\",\n        mssql: \"smallint\"\n      },\n      number: {\n        sqlite: field.bigint ? \"bigint\" : \"integer\",\n        postgres: field.bigint ? \"bigint\" : \"integer\",\n        mysql: field.bigint ? \"bigint\" : \"integer\",\n        mssql: field.bigint ? \"bigint\" : \"integer\"\n      },\n      date: {\n        sqlite: \"date\",\n        postgres: \"timestamp\",\n        mysql: \"datetime\",\n        mssql: \"datetime\"\n      }\n    };\n    if (dbType === \"sqlite\" && (type === \"string[]\" || type === \"number[]\")) {\n      return \"text\";\n    }\n    if (type === \"string[]\" || type === \"number[]\") {\n      return \"jsonb\";\n    }\n    if (Array.isArray(type)) {\n      return \"text\";\n    }\n    return typeMap[type][dbType || \"sqlite\"];\n  }\n  if (toBeAdded.length) {\n    for (const table of toBeAdded) {\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field);\n        const exec = db.schema.alterTable(table.table).addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            );\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          return col;\n        });\n        migrations.push(exec);\n      }\n    }\n  }\n  if (toBeCreated.length) {\n    for (const table of toBeCreated) {\n      let dbT = db.schema.createTable(table.table).addColumn(\n        \"id\",\n        dbType === \"mysql\" || dbType === \"mssql\" ? \"varchar(36)\" : \"text\",\n        (col) => col.primaryKey().notNull()\n      );\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field);\n        dbT = dbT.addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            );\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          return col;\n        });\n      }\n      migrations.push(dbT);\n    }\n  }\n  async function runMigrations() {\n    for (const migration of migrations) {\n      await migration.execute();\n    }\n  }\n  async function compileMigrations() {\n    const compiled = migrations.map((m) => m.compile().sql);\n    return compiled.join(\";\\n\\n\");\n  }\n  return { toBeCreated, toBeAdded, runMigrations, compileMigrations };\n}\n\n// src/adapters/kysely-adapter/kysely-adapter.ts\nvar createTransform2 = (db, options, config) => {\n  const schema = getAuthTables(options);\n  function getField(model, field) {\n    if (field === \"id\") {\n      return field;\n    }\n    const f = schema[model].fields[field];\n    if (!f) {\n      console.log(\"Field not found\", model, field);\n    }\n    return f.fieldName || field;\n  }\n  function transformValueToDB(value, model, field) {\n    const { type = \"sqlite\" } = config || {};\n    const f = schema[model].fields[field];\n    if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null && value !== void 0) {\n      return value ? 1 : 0;\n    }\n    if (f.type === \"date\" && value && value instanceof Date) {\n      return type === \"sqlite\" ? value.toISOString() : value;\n    }\n    return value;\n  }\n  function transformValueFromDB(value, model, field) {\n    const { type = \"sqlite\" } = config || {};\n    const f = schema[model].fields[field];\n    if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null) {\n      return value === 1;\n    }\n    if (f.type === \"date\" && value) {\n      return new Date(value);\n    }\n    return value;\n  }\n  function getModelName(model) {\n    return schema[model].modelName;\n  }\n  const useDatabaseGeneratedId = options?.advanced?.generateId === false;\n  return {\n    transformInput(data, model, action) {\n      const transformedData = useDatabaseGeneratedId || action === \"update\" ? {} : {\n        id: options.advanced?.generateId ? options.advanced.generateId({\n          model\n        }) : data.id || (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.generateId)()\n      };\n      const fields = schema[model].fields;\n      for (const field in fields) {\n        const value = data[field];\n        transformedData[fields[field].fieldName || field] = withApplyDefault(\n          transformValueToDB(value, model, field),\n          fields[field],\n          action\n        );\n      }\n      return transformedData;\n    },\n    transformOutput(data, model, select = []) {\n      if (!data) return null;\n      const transformedData = data.id ? select.length === 0 || select.includes(\"id\") ? {\n        id: data.id\n      } : {} : {};\n      const tableSchema = schema[model].fields;\n      for (const key in tableSchema) {\n        if (select.length && !select.includes(key)) {\n          continue;\n        }\n        const field = tableSchema[key];\n        if (field) {\n          transformedData[key] = transformValueFromDB(\n            data[field.fieldName || key],\n            model,\n            key\n          );\n        }\n      }\n      return transformedData;\n    },\n    convertWhereClause(model, w) {\n      if (!w)\n        return {\n          and: null,\n          or: null\n        };\n      const conditions = {\n        and: [],\n        or: []\n      };\n      w.forEach((condition) => {\n        const {\n          field: _field,\n          value,\n          operator = \"=\",\n          connector = \"AND\"\n        } = condition;\n        const field = getField(model, _field);\n        const expr = (eb) => {\n          if (operator.toLowerCase() === \"in\") {\n            return eb(field, \"in\", Array.isArray(value) ? value : [value]);\n          }\n          if (operator === \"contains\") {\n            return eb(field, \"like\", `%${value}%`);\n          }\n          if (operator === \"starts_with\") {\n            return eb(field, \"like\", `${value}%`);\n          }\n          if (operator === \"ends_with\") {\n            return eb(field, \"like\", `%${value}`);\n          }\n          if (operator === \"eq\") {\n            return eb(field, \"=\", value);\n          }\n          if (operator === \"ne\") {\n            return eb(field, \"<>\", value);\n          }\n          if (operator === \"gt\") {\n            return eb(field, \">\", value);\n          }\n          if (operator === \"gte\") {\n            return eb(field, \">=\", value);\n          }\n          if (operator === \"lt\") {\n            return eb(field, \"<\", value);\n          }\n          if (operator === \"lte\") {\n            return eb(field, \"<=\", value);\n          }\n          return eb(field, operator, value);\n        };\n        if (connector === \"OR\") {\n          conditions.or.push(expr);\n        } else {\n          conditions.and.push(expr);\n        }\n      });\n      return {\n        and: conditions.and.length ? conditions.and : null,\n        or: conditions.or.length ? conditions.or : null\n      };\n    },\n    async withReturning(values, builder, model, where) {\n      let res;\n      if (config?.type === \"mysql\") {\n        await builder.execute();\n        const field = values.id ? \"id\" : where[0].field ? where[0].field : \"id\";\n        const value = values[field] || where[0].value;\n        res = await db.selectFrom(getModelName(model)).selectAll().where(getField(model, field), \"=\", value).executeTakeFirst();\n        return res;\n      }\n      if (config?.type === \"mssql\") {\n        res = await builder.outputAll(\"inserted\").executeTakeFirst();\n        return res;\n      }\n      res = await builder.returningAll().executeTakeFirst();\n      return res;\n    },\n    getModelName,\n    getField\n  };\n};\nvar kyselyAdapter = (db, config) => (opts) => {\n  const {\n    transformInput,\n    withReturning,\n    transformOutput,\n    convertWhereClause,\n    getModelName,\n    getField\n  } = createTransform2(db, opts, config);\n  return {\n    id: \"kysely\",\n    async create(data) {\n      const { model, data: values, select } = data;\n      const transformed = transformInput(values, model, \"create\");\n      const builder = db.insertInto(getModelName(model)).values(transformed);\n      return transformOutput(\n        await withReturning(transformed, builder, model, []),\n        model,\n        select\n      );\n    },\n    async findOne(data) {\n      const { model, where, select } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.selectFrom(getModelName(model)).selectAll();\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      const res = await query.executeTakeFirst();\n      if (!res) return null;\n      return transformOutput(res, model, select);\n    },\n    async findMany(data) {\n      const { model, where, limit, offset, sortBy } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.selectFrom(getModelName(model));\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      if (config?.type === \"mssql\") {\n        if (!offset) {\n          query = query.top(limit || 100);\n        }\n      } else {\n        query = query.limit(limit || 100);\n      }\n      if (sortBy) {\n        query = query.orderBy(\n          getField(model, sortBy.field),\n          sortBy.direction\n        );\n      }\n      if (offset) {\n        if (config?.type === \"mssql\") {\n          if (!sortBy) {\n            query = query.orderBy(getField(model, \"id\"));\n          }\n          query = query.offset(offset).fetch(limit || 100);\n        } else {\n          query = query.offset(offset);\n        }\n      }\n      const res = await query.selectAll().execute();\n      if (!res) return [];\n      return res.map((r) => transformOutput(r, model));\n    },\n    async update(data) {\n      const { model, where, update: values } = data;\n      const { and, or } = convertWhereClause(model, where);\n      const transformedData = transformInput(values, model, \"update\");\n      let query = db.updateTable(getModelName(model)).set(transformedData);\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      const res = await transformOutput(\n        await withReturning(transformedData, query, model, where),\n        model\n      );\n      return res;\n    },\n    async updateMany(data) {\n      const { model, where, update: values } = data;\n      const { and, or } = convertWhereClause(model, where);\n      const transformedData = transformInput(values, model, \"update\");\n      let query = db.updateTable(getModelName(model)).set(transformedData);\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      const res = await query.execute();\n      return res.length;\n    },\n    async delete(data) {\n      const { model, where } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.deleteFrom(getModelName(model));\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      await query.execute();\n    },\n    async deleteMany(data) {\n      const { model, where } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.deleteFrom(getModelName(model));\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      return (await query.execute()).length;\n    },\n    options: config\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstNjJNV0xMRUcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBaUY7QUFDVjtBQUNuQjtBQUNOO0FBQ1E7QUFDc0M7QUFDcEU7O0FBRXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaURBQWE7QUFDbkM7QUFDQTtBQUNBLHNCQUFzQixnREFBWTtBQUNsQztBQUNBO0FBQ0Esc0JBQXNCLG1EQUFlO0FBQ3JDO0FBQ0E7QUFDQSxzQkFBc0IsZ0RBQVk7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDJDQUFNLEdBQUcscUJBQXFCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBYTtBQUMvQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esa0JBQWtCLGdEQUFZO0FBQzlCO0FBQ0E7QUFDQSxrQkFBa0IsbURBQWU7QUFDakM7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDBCQUEwQiwyQ0FBTSxHQUFHLFNBQVM7QUFDNUM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHdEQUF3RDtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixPQUFPO0FBQ3BDO0FBQ0E7QUFDQSxxQkFBcUIsaUVBQWE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msc0VBQWtCO0FBQ3BEO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxXQUFXLCtCQUErQjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsV0FBVyx3QkFBd0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDBDQUEwQztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQSwrRkFBK0Y7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0EsS0FBSyxJQUFJO0FBQ1QsSUFBSSxzREFBTTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSx1QkFBdUI7QUFDakM7QUFDQSxjQUFjLCtEQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsZ0VBQVk7QUFDOUIsUUFBUSxtQ0FBbUM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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ZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTYyTVdMTEVHLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlU2Vzc2lvbk91dHB1dCwgZ2V0SXAsIHBhcnNlVXNlck91dHB1dCB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVJZCwgbG9nZ2VyLCBjcmVhdGVMb2dnZXIgfSBmcm9tICcuL2NodW5rLUtMREZCTFlMLmpzJztcbmltcG9ydCB7IHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2NodW5rLTUzSVBPMlBKLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vY2h1bmstVU5XQ1hLTVAuanMnO1xuaW1wb3J0IHsgS3lzZWx5LCBTcWxpdGVEaWFsZWN0LCBNeXNxbERpYWxlY3QsIFBvc3RncmVzRGlhbGVjdCwgTXNzcWxEaWFsZWN0IH0gZnJvbSAna3lzZWx5JztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG5mdW5jdGlvbiBnZXREYXRhYmFzZVR5cGUoZGIpIHtcbiAgaWYgKCFkYikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmIChcImRpYWxlY3RcIiBpbiBkYikge1xuICAgIHJldHVybiBnZXREYXRhYmFzZVR5cGUoZGIuZGlhbGVjdCk7XG4gIH1cbiAgaWYgKFwiY3JlYXRlRHJpdmVyXCIgaW4gZGIpIHtcbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBTcWxpdGVEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJzcWxpdGVcIjtcbiAgICB9XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgTXlzcWxEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJteXNxbFwiO1xuICAgIH1cbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBQb3N0Z3Jlc0RpYWxlY3QpIHtcbiAgICAgIHJldHVybiBcInBvc3RncmVzXCI7XG4gICAgfVxuICAgIGlmIChkYiBpbnN0YW5jZW9mIE1zc3FsRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwibXNzcWxcIjtcbiAgICB9XG4gIH1cbiAgaWYgKFwiYWdncmVnYXRlXCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJzcWxpdGVcIjtcbiAgfVxuICBpZiAoXCJnZXRDb25uZWN0aW9uXCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJteXNxbFwiO1xuICB9XG4gIGlmIChcImNvbm5lY3RcIiBpbiBkYikge1xuICAgIHJldHVybiBcInBvc3RncmVzXCI7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG52YXIgY3JlYXRlS3lzZWx5QWRhcHRlciA9IGFzeW5jIChjb25maWcpID0+IHtcbiAgY29uc3QgZGIgPSBjb25maWcuZGF0YWJhc2U7XG4gIGlmICghZGIpIHtcbiAgICByZXR1cm4ge1xuICAgICAga3lzZWx5OiBudWxsLFxuICAgICAgZGF0YWJhc2VUeXBlOiBudWxsXG4gICAgfTtcbiAgfVxuICBpZiAoXCJkYlwiIGluIGRiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGt5c2VseTogZGIuZGIsXG4gICAgICBkYXRhYmFzZVR5cGU6IGRiLnR5cGVcbiAgICB9O1xuICB9XG4gIGlmIChcImRpYWxlY3RcIiBpbiBkYikge1xuICAgIHJldHVybiB7XG4gICAgICBreXNlbHk6IG5ldyBLeXNlbHkoeyBkaWFsZWN0OiBkYi5kaWFsZWN0IH0pLFxuICAgICAgZGF0YWJhc2VUeXBlOiBkYi50eXBlXG4gICAgfTtcbiAgfVxuICBsZXQgZGlhbGVjdCA9IHZvaWQgMDtcbiAgY29uc3QgZGF0YWJhc2VUeXBlID0gZ2V0RGF0YWJhc2VUeXBlKGRiKTtcbiAgaWYgKFwiY3JlYXRlRHJpdmVyXCIgaW4gZGIpIHtcbiAgICBkaWFsZWN0ID0gZGI7XG4gIH1cbiAgaWYgKFwiYWdncmVnYXRlXCIgaW4gZGIpIHtcbiAgICBkaWFsZWN0ID0gbmV3IFNxbGl0ZURpYWxlY3Qoe1xuICAgICAgZGF0YWJhc2U6IGRiXG4gICAgfSk7XG4gIH1cbiAgaWYgKFwiZ2V0Q29ubmVjdGlvblwiIGluIGRiKSB7XG4gICAgZGlhbGVjdCA9IG5ldyBNeXNxbERpYWxlY3QoZGIpO1xuICB9XG4gIGlmIChcImNvbm5lY3RcIiBpbiBkYikge1xuICAgIGRpYWxlY3QgPSBuZXcgUG9zdGdyZXNEaWFsZWN0KHtcbiAgICAgIHBvb2w6IGRiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBreXNlbHk6IGRpYWxlY3QgPyBuZXcgS3lzZWx5KHsgZGlhbGVjdCB9KSA6IG51bGwsXG4gICAgZGF0YWJhc2VUeXBlXG4gIH07XG59O1xuXG4vLyBzcmMvZGIvd2l0aC1ob29rcy50c1xuZnVuY3Rpb24gZ2V0V2l0aEhvb2tzKGFkYXB0ZXIsIGN0eCkge1xuICBjb25zdCBob29rcyA9IGN0eC5ob29rcztcbiAgYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2l0aEhvb2tzKGRhdGEsIG1vZGVsLCBjdXN0b21DcmVhdGVGbikge1xuICAgIGxldCBhY3R1YWxEYXRhID0gZGF0YTtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LmNyZWF0ZT8uYmVmb3JlO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvUnVuKGFjdHVhbERhdGEpO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzT2JqZWN0ID0gdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIiAmJiBcImRhdGFcIiBpbiByZXN1bHQ7XG4gICAgICAgIGlmIChpc09iamVjdCkge1xuICAgICAgICAgIGFjdHVhbERhdGEgPSB7XG4gICAgICAgICAgICAuLi5hY3R1YWxEYXRhLFxuICAgICAgICAgICAgLi4ucmVzdWx0LmRhdGFcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbUNyZWF0ZWQgPSBjdXN0b21DcmVhdGVGbiA/IGF3YWl0IGN1c3RvbUNyZWF0ZUZuLmZuKGFjdHVhbERhdGEpIDogbnVsbDtcbiAgICBjb25zdCBjcmVhdGVkID0gIWN1c3RvbUNyZWF0ZUZuIHx8IGN1c3RvbUNyZWF0ZUZuLmV4ZWN1dGVNYWluRm4gPyBhd2FpdCBhZGFwdGVyLmNyZWF0ZSh7XG4gICAgICBtb2RlbCxcbiAgICAgIGRhdGE6IGFjdHVhbERhdGFcbiAgICB9KSA6IGN1c3RvbUNyZWF0ZWQ7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy5jcmVhdGU/LmFmdGVyO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGF3YWl0IHRvUnVuKGNyZWF0ZWQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlZDtcbiAgfVxuICBhc3luYyBmdW5jdGlvbiB1cGRhdGVXaXRoSG9va3MoZGF0YSwgd2hlcmUsIG1vZGVsLCBjdXN0b21VcGRhdGVGbikge1xuICAgIGxldCBhY3R1YWxEYXRhID0gZGF0YTtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYmVmb3JlO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvUnVuKGRhdGEpO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzT2JqZWN0ID0gdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIjtcbiAgICAgICAgYWN0dWFsRGF0YSA9IGlzT2JqZWN0ID8gcmVzdWx0LmRhdGEgOiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbVVwZGF0ZWQgPSBjdXN0b21VcGRhdGVGbiA/IGF3YWl0IGN1c3RvbVVwZGF0ZUZuLmZuKGFjdHVhbERhdGEpIDogbnVsbDtcbiAgICBjb25zdCB1cGRhdGVkID0gIWN1c3RvbVVwZGF0ZUZuIHx8IGN1c3RvbVVwZGF0ZUZuLmV4ZWN1dGVNYWluRm4gPyBhd2FpdCBhZGFwdGVyLnVwZGF0ZSh7XG4gICAgICBtb2RlbCxcbiAgICAgIHVwZGF0ZTogYWN0dWFsRGF0YSxcbiAgICAgIHdoZXJlXG4gICAgfSkgOiBjdXN0b21VcGRhdGVkO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5hZnRlcjtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBhd2FpdCB0b1J1bih1cGRhdGVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZWQ7XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWFueVdpdGhIb29rcyhkYXRhLCB3aGVyZSwgbW9kZWwsIGN1c3RvbVVwZGF0ZUZuKSB7XG4gICAgbGV0IGFjdHVhbERhdGEgPSBkYXRhO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5iZWZvcmU7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9SdW4oZGF0YSk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNPYmplY3QgPSB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiO1xuICAgICAgICBhY3R1YWxEYXRhID0gaXNPYmplY3QgPyByZXN1bHQuZGF0YSA6IHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY3VzdG9tVXBkYXRlZCA9IGN1c3RvbVVwZGF0ZUZuID8gYXdhaXQgY3VzdG9tVXBkYXRlRm4uZm4oYWN0dWFsRGF0YSkgOiBudWxsO1xuICAgIGNvbnN0IHVwZGF0ZWQgPSAhY3VzdG9tVXBkYXRlRm4gfHwgY3VzdG9tVXBkYXRlRm4uZXhlY3V0ZU1haW5GbiA/IGF3YWl0IGFkYXB0ZXIudXBkYXRlTWFueSh7XG4gICAgICBtb2RlbCxcbiAgICAgIHVwZGF0ZTogYWN0dWFsRGF0YSxcbiAgICAgIHdoZXJlXG4gICAgfSkgOiBjdXN0b21VcGRhdGVkO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5hZnRlcjtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBhd2FpdCB0b1J1bih1cGRhdGVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZWQ7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVXaXRoSG9va3MsXG4gICAgdXBkYXRlV2l0aEhvb2tzLFxuICAgIHVwZGF0ZU1hbnlXaXRoSG9va3NcbiAgfTtcbn1cblxuLy8gc3JjL2RiL2ludGVybmFsLWFkYXB0ZXIudHNcbnZhciBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIgPSAoYWRhcHRlciwgY3R4KSA9PiB7XG4gIGNvbnN0IG9wdGlvbnMgPSBjdHgub3B0aW9ucztcbiAgY29uc3Qgc2Vjb25kYXJ5U3RvcmFnZSA9IG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZTtcbiAgY29uc3Qgc2Vzc2lvbkV4cGlyYXRpb24gPSBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQgKiA3O1xuICBjb25zdCB7IGNyZWF0ZVdpdGhIb29rcywgdXBkYXRlV2l0aEhvb2tzLCB1cGRhdGVNYW55V2l0aEhvb2tzIH0gPSBnZXRXaXRoSG9va3MoYWRhcHRlciwgY3R4KTtcbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVPQXV0aFVzZXI6IGFzeW5jICh1c2VyLCBhY2NvdW50KSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVkVXNlciA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi51c2VyXG4gICAgICAgIH0sXG4gICAgICAgIFwidXNlclwiXG4gICAgICApO1xuICAgICAgY29uc3QgY3JlYXRlZEFjY291bnQgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5hY2NvdW50LFxuICAgICAgICAgIHVzZXJJZDogY3JlYXRlZFVzZXIuaWQgfHwgdXNlci5pZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgfSxcbiAgICAgICAgXCJhY2NvdW50XCJcbiAgICAgICk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiBjcmVhdGVkVXNlcixcbiAgICAgICAgYWNjb3VudDogY3JlYXRlZEFjY291bnRcbiAgICAgIH07XG4gICAgfSxcbiAgICBjcmVhdGVVc2VyOiBhc3luYyAodXNlcikgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlZFVzZXIgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgLi4udXNlcixcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbC50b0xvd2VyQ2FzZSgpXG4gICAgICAgIH0sXG4gICAgICAgIFwidXNlclwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIGNyZWF0ZWRVc2VyO1xuICAgIH0sXG4gICAgY3JlYXRlQWNjb3VudDogYXN5bmMgKGFjY291bnQpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZWRBY2NvdW50ID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIC4uLmFjY291bnRcbiAgICAgICAgfSxcbiAgICAgICAgXCJhY2NvdW50XCJcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3JlYXRlZEFjY291bnQ7XG4gICAgfSxcbiAgICBsaXN0U2Vzc2lvbnM6IGFzeW5jICh1c2VySWQpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRMaXN0ID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoXG4gICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gXG4gICAgICAgICk7XG4gICAgICAgIGlmICghY3VycmVudExpc3QpIHJldHVybiBbXTtcbiAgICAgICAgY29uc3QgbGlzdCA9IHNhZmVKU09OUGFyc2UoY3VycmVudExpc3QpIHx8IFtdO1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zdCB2YWxpZFNlc3Npb25zID0gbGlzdC5maWx0ZXIoKHMpID0+IHMuZXhwaXJlc0F0ID4gbm93KTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbnMyID0gW107XG4gICAgICAgIGZvciAoY29uc3Qgc2Vzc2lvbiBvZiB2YWxpZFNlc3Npb25zKSB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoc2Vzc2lvbi50b2tlbik7XG4gICAgICAgICAgaWYgKHNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0cmluZ2lmaWVkKTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFNlc3Npb24gPSBwYXJzZVNlc3Npb25PdXRwdXQoY3R4Lm9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgLi4ucy5zZXNzaW9uLFxuICAgICAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi5leHBpcmVzQXQpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlc3Npb25zMi5wdXNoKHBhcnNlZFNlc3Npb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2Vzc2lvbnMyO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gc2Vzc2lvbnM7XG4gICAgfSxcbiAgICBsaXN0VXNlcnM6IGFzeW5jIChsaW1pdCwgb2Zmc2V0LCBzb3J0QnksIHdoZXJlKSA9PiB7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIGxpbWl0LFxuICAgICAgICBvZmZzZXQsXG4gICAgICAgIHNvcnRCeSxcbiAgICAgICAgd2hlcmVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVzZXJzO1xuICAgIH0sXG4gICAgZGVsZXRlVXNlcjogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUoYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gKTtcbiAgICAgIH1cbiAgICAgIGlmICghc2Vjb25kYXJ5U3RvcmFnZSB8fCBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UpIHtcbiAgICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBjcmVhdGVTZXNzaW9uOiBhc3luYyAodXNlcklkLCByZXF1ZXN0LCBkb250UmVtZW1iZXJNZSwgb3ZlcnJpZGUsIG92ZXJyaWRlQWxsKSA9PiB7XG4gICAgICBjb25zdCBoZWFkZXJzID0gcmVxdWVzdCBpbnN0YW5jZW9mIFJlcXVlc3QgPyByZXF1ZXN0LmhlYWRlcnMgOiByZXF1ZXN0O1xuICAgICAgY29uc3QgeyBpZDogXywgLi4ucmVzdCB9ID0gb3ZlcnJpZGUgfHwge307XG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBpcEFkZHJlc3M6IHJlcXVlc3QgPyBnZXRJcChyZXF1ZXN0LCBjdHgub3B0aW9ucykgfHwgXCJcIiA6IFwiXCIsXG4gICAgICAgIHVzZXJBZ2VudDogaGVhZGVycz8uZ2V0KFwidXNlci1hZ2VudFwiKSB8fCBcIlwiLFxuICAgICAgICAuLi5yZXN0LFxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdGhlIHVzZXIgZG9lc24ndCB3YW50IHRvIGJlIHJlbWVtYmVyZWRcbiAgICAgICAgICogc2V0IHRoZSBzZXNzaW9uIHRvIGV4cGlyZSBpbiAxIGRheS5cbiAgICAgICAgICogVGhlIGNvb2tpZSB3aWxsIGJlIHNldCB0byBleHBpcmUgYXQgdGhlIGVuZCBvZiB0aGUgc2Vzc2lvblxuICAgICAgICAgKi9cbiAgICAgICAgZXhwaXJlc0F0OiBkb250UmVtZW1iZXJNZSA/IGdldERhdGUoNjAgKiA2MCAqIDI0LCBcInNlY1wiKSA6IGdldERhdGUoc2Vzc2lvbkV4cGlyYXRpb24sIFwic2VjXCIpLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHRva2VuOiBnZW5lcmF0ZUlkKDMyKSxcbiAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgLi4ub3ZlcnJpZGVBbGwgPyByZXN0IDoge31cbiAgICAgIH07XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFwic2Vzc2lvblwiLFxuICAgICAgICBzZWNvbmRhcnlTdG9yYWdlID8ge1xuICAgICAgICAgIGZuOiBhc3luYyAoc2Vzc2lvbkRhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaXN0ID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoXG4gICAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGxldCBsaXN0ID0gW107XG4gICAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRMaXN0KSB7XG4gICAgICAgICAgICAgIGxpc3QgPSBzYWZlSlNPTlBhcnNlKGN1cnJlbnRMaXN0KSB8fCBbXTtcbiAgICAgICAgICAgICAgbGlzdCA9IGxpc3QuZmlsdGVyKChzZXNzaW9uKSA9PiBzZXNzaW9uLmV4cGlyZXNBdCA+IG5vdyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaXN0LnB1c2goe1xuICAgICAgICAgICAgICB0b2tlbjogZGF0YS50b2tlbixcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBub3cgKyBzZXNzaW9uRXhwaXJhdGlvbiAqIDFlM1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLnNldChcbiAgICAgICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZH1gLFxuICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShsaXN0KSxcbiAgICAgICAgICAgICAgc2Vzc2lvbkV4cGlyYXRpb25cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gc2Vzc2lvbkRhdGE7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBleGVjdXRlTWFpbkZuOiBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2VcbiAgICAgICAgfSA6IHZvaWQgMFxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBmaW5kU2Vzc2lvbjogYXN5bmMgKHRva2VuKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBjb25zdCBzZXNzaW9uU3RyaW5naWZpZWQgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldCh0b2tlbik7XG4gICAgICAgIGlmICghc2Vzc2lvblN0cmluZ2lmaWVkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcyA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0cmluZ2lmaWVkKTtcbiAgICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbjIgPSBwYXJzZVNlc3Npb25PdXRwdXQoY3R4Lm9wdGlvbnMsIHtcbiAgICAgICAgICAuLi5zLnNlc3Npb24sXG4gICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi5jcmVhdGVkQXQpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocy5zZXNzaW9uLnVwZGF0ZWRBdClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHBhcnNlZFVzZXIyID0gcGFyc2VVc2VyT3V0cHV0KGN0eC5vcHRpb25zLCB7XG4gICAgICAgICAgLi4ucy51c2VyLFxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy51c2VyLmNyZWF0ZWRBdCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShzLnVzZXIudXBkYXRlZEF0KVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzZXNzaW9uOiBwYXJzZWRTZXNzaW9uMixcbiAgICAgICAgICB1c2VyOiBwYXJzZWRVc2VyMlxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB2YWx1ZTogdG9rZW4sXG4gICAgICAgICAgICBmaWVsZDogXCJ0b2tlblwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IHNlc3Npb24udXNlcklkLFxuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwYXJzZWRTZXNzaW9uID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCBzZXNzaW9uKTtcbiAgICAgIGNvbnN0IHBhcnNlZFVzZXIgPSBwYXJzZVVzZXJPdXRwdXQoY3R4Lm9wdGlvbnMsIHVzZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2Vzc2lvbjogcGFyc2VkU2Vzc2lvbixcbiAgICAgICAgdXNlcjogcGFyc2VkVXNlclxuICAgICAgfTtcbiAgICB9LFxuICAgIGZpbmRTZXNzaW9uczogYXN5bmMgKHNlc3Npb25Ub2tlbnMpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb25zMiA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb25Ub2tlbiBvZiBzZXNzaW9uVG9rZW5zKSB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICBpZiAoc2Vzc2lvblN0cmluZ2lmaWVkKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gSlNPTi5wYXJzZShzZXNzaW9uU3RyaW5naWZpZWQpO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IHtcbiAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgIC4uLnMuc2Vzc2lvbixcbiAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi5leHBpcmVzQXQpXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAuLi5zLnVzZXIsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShzLnVzZXIuY3JlYXRlZEF0KSxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMudXNlci51cGRhdGVkQXQpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzZXNzaW9uczIucHVzaChzZXNzaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlc3Npb25zMjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ0b2tlblwiLFxuICAgICAgICAgICAgdmFsdWU6IHNlc3Npb25Ub2tlbnMsXG4gICAgICAgICAgICBvcGVyYXRvcjogXCJpblwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHVzZXJJZHMgPSBzZXNzaW9ucy5tYXAoKHNlc3Npb24pID0+IHtcbiAgICAgICAgcmV0dXJuIHNlc3Npb24udXNlcklkO1xuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXJJZHMubGVuZ3RoKSByZXR1cm4gW107XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRzLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFwiaW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gc2Vzc2lvbnMubWFwKChzZXNzaW9uKSA9PiB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSB1c2Vycy5maW5kKCh1KSA9PiB1LmlkID09PSBzZXNzaW9uLnVzZXJJZCk7XG4gICAgICAgIGlmICghdXNlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICB1c2VyXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHVwZGF0ZVNlc3Npb246IGFzeW5jIChzZXNzaW9uVG9rZW4sIHNlc3Npb24pID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9uID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBzZXNzaW9uLFxuICAgICAgICBbeyBmaWVsZDogXCJ0b2tlblwiLCB2YWx1ZTogc2Vzc2lvblRva2VuIH1dLFxuICAgICAgICBcInNlc3Npb25cIixcbiAgICAgICAgc2Vjb25kYXJ5U3RvcmFnZSA/IHtcbiAgICAgICAgICBhc3luYyBmbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50U2Vzc2lvbiA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHNlc3Npb25Ub2tlbik7XG4gICAgICAgICAgICBsZXQgdXBkYXRlZFNlc3Npb24yID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChjdXJyZW50U2Vzc2lvbikge1xuICAgICAgICAgICAgICBjb25zdCBwYXJzZWRTZXNzaW9uID0gSlNPTi5wYXJzZShjdXJyZW50U2Vzc2lvbik7XG4gICAgICAgICAgICAgIHVwZGF0ZWRTZXNzaW9uMiA9IHtcbiAgICAgICAgICAgICAgICAuLi5wYXJzZWRTZXNzaW9uLnNlc3Npb24sXG4gICAgICAgICAgICAgICAgLi4uZGF0YVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlZFNlc3Npb24yO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBleGVjdXRlTWFpbkZuOiBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2VcbiAgICAgICAgfSA6IHZvaWQgMFxuICAgICAgKTtcbiAgICAgIHJldHVybiB1cGRhdGVkU2Vzc2lvbjtcbiAgICB9LFxuICAgIGRlbGV0ZVNlc3Npb246IGFzeW5jICh0b2tlbikgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUodG9rZW4pO1xuICAgICAgICBpZiAoIW9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSB8fCBjdHgub3B0aW9ucy5zZXNzaW9uPy5wcmVzZXJ2ZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ0b2tlblwiLFxuICAgICAgICAgICAgdmFsdWU6IHRva2VuXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZUFjY291bnRzOiBhc3luYyAodXNlcklkKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZU1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZUFjY291bnQ6IGFzeW5jIChwcm92aWRlcklkLCB1c2VySWQpID0+IHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInByb3ZpZGVySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBwcm92aWRlcklkXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlU2Vzc2lvbnM6IGFzeW5jICh1c2VySWRPclNlc3Npb25Ub2tlbnMpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXNlcklkT3JTZXNzaW9uVG9rZW5zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgY29uc3QgYWN0aXZlU2Vzc2lvbiA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KFxuICAgICAgICAgICAgYGFjdGl2ZS1zZXNzaW9ucy0ke3VzZXJJZE9yU2Vzc2lvblRva2Vuc31gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBzZXNzaW9ucyA9IGFjdGl2ZVNlc3Npb24gPyBzYWZlSlNPTlBhcnNlKGFjdGl2ZVNlc3Npb24pIDogW107XG4gICAgICAgICAgaWYgKCFzZXNzaW9ucykgcmV0dXJuO1xuICAgICAgICAgIGZvciAoY29uc3Qgc2Vzc2lvbiBvZiBzZXNzaW9ucykge1xuICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUoc2Vzc2lvbi50b2tlbik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAoY29uc3Qgc2Vzc2lvblRva2VuIG9mIHVzZXJJZE9yU2Vzc2lvblRva2Vucykge1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHNlc3Npb25Ub2tlbik7XG4gICAgICAgICAgICBpZiAoc2Vzc2lvbikge1xuICAgICAgICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmRlbGV0ZShzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSB8fCBjdHgub3B0aW9ucy5zZXNzaW9uPy5wcmVzZXJ2ZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZU1hbnkoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IEFycmF5LmlzQXJyYXkodXNlcklkT3JTZXNzaW9uVG9rZW5zKSA/IFwidG9rZW5cIiA6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkT3JTZXNzaW9uVG9rZW5zLFxuICAgICAgICAgICAgb3BlcmF0b3I6IEFycmF5LmlzQXJyYXkodXNlcklkT3JTZXNzaW9uVG9rZW5zKSA/IFwiaW5cIiA6IHZvaWQgMFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBmaW5kT0F1dGhVc2VyOiBhc3luYyAoZW1haWwsIGFjY291bnRJZCwgcHJvdmlkZXJJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB2YWx1ZTogYWNjb3VudElkLFxuICAgICAgICAgICAgZmllbGQ6IFwiYWNjb3VudElkXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBwcm92aWRlcklkLFxuICAgICAgICAgICAgZmllbGQ6IFwicHJvdmlkZXJJZFwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmIChhY2NvdW50KSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogYWNjb3VudC51c2VySWQsXG4gICAgICAgICAgICAgIGZpZWxkOiBcImlkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYWNjb3VudHM6IFthY2NvdW50XVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdXNlci5pZCxcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICBhY2NvdW50czogYWNjb3VudHMgfHwgW11cbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBmaW5kVXNlckJ5RW1haWw6IGFzeW5jIChlbWFpbCwgb3B0aW9uczIpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdXNlcikgcmV0dXJuIG51bGw7XG4gICAgICBpZiAob3B0aW9uczI/LmluY2x1ZGVBY2NvdW50cykge1xuICAgICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogdXNlci5pZCxcbiAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgYWNjb3VudHNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXIsXG4gICAgICAgIGFjY291bnRzOiBbXVxuICAgICAgfTtcbiAgICB9LFxuICAgIGZpbmRVc2VyQnlJZDogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9LFxuICAgIGxpbmtBY2NvdW50OiBhc3luYyAoYWNjb3VudCkgPT4ge1xuICAgICAgY29uc3QgX2FjY291bnQgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5hY2NvdW50LFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBcImFjY291bnRcIlxuICAgICAgKTtcbiAgICAgIHJldHVybiBfYWNjb3VudDtcbiAgICB9LFxuICAgIHVwZGF0ZVVzZXI6IGFzeW5jICh1c2VySWQsIGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJ1c2VyXCJcbiAgICAgICk7XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9LFxuICAgIHVwZGF0ZVVzZXJCeUVtYWlsOiBhc3luYyAoZW1haWwsIGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwidXNlclwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSxcbiAgICB1cGRhdGVQYXNzd29yZDogYXN5bmMgKHVzZXJJZCwgcGFzc3dvcmQpID0+IHtcbiAgICAgIGF3YWl0IHVwZGF0ZU1hbnlXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICBwYXNzd29yZFxuICAgICAgICB9LFxuICAgICAgICBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogXCJjcmVkZW50aWFsXCJcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiYWNjb3VudFwiXG4gICAgICApO1xuICAgIH0sXG4gICAgZmluZEFjY291bnRzOiBhc3luYyAodXNlcklkKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2NvdW50cztcbiAgICB9LFxuICAgIGZpbmRBY2NvdW50OiBhc3luYyAoYWNjb3VudElkKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImFjY291bnRJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGFjY291bnRJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjb3VudDtcbiAgICB9LFxuICAgIGZpbmRBY2NvdW50QnlVc2VySWQ6IGFzeW5jICh1c2VySWQpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjb3VudDtcbiAgICB9LFxuICAgIHVwZGF0ZUFjY291bnQ6IGFzeW5jIChhY2NvdW50SWQsIGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFt7IGZpZWxkOiBcImlkXCIsIHZhbHVlOiBhY2NvdW50SWQgfV0sXG4gICAgICAgIFwiYWNjb3VudFwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICBjcmVhdGVWZXJpZmljYXRpb25WYWx1ZTogYXN5bmMgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5kYXRhXG4gICAgICAgIH0sXG4gICAgICAgIFwidmVyaWZpY2F0aW9uXCJcbiAgICAgICk7XG4gICAgICByZXR1cm4gdmVyaWZpY2F0aW9uO1xuICAgIH0sXG4gICAgZmluZFZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWRlbnRpZmllcikgPT4ge1xuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkZW50aWZpZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBpZGVudGlmaWVyXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBzb3J0Qnk6IHtcbiAgICAgICAgICBmaWVsZDogXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICBkaXJlY3Rpb246IFwiZGVzY1wiXG4gICAgICAgIH0sXG4gICAgICAgIGxpbWl0OiAxXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGxhc3RWZXJpZmljYXRpb24gPSB2ZXJpZmljYXRpb25bMF07XG4gICAgICByZXR1cm4gbGFzdFZlcmlmaWNhdGlvbjtcbiAgICB9LFxuICAgIGRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWQpID0+IHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBpZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGVWZXJpZmljYXRpb25CeUlkZW50aWZpZXI6IGFzeW5jIChpZGVudGlmaWVyKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkZW50aWZpZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBpZGVudGlmaWVyXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHVwZGF0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWQsIGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgZGF0YSxcbiAgICAgICAgW3sgZmllbGQ6IFwiaWRcIiwgdmFsdWU6IGlkIH1dLFxuICAgICAgICBcInZlcmlmaWNhdGlvblwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHZlcmlmaWNhdGlvbjtcbiAgICB9XG4gIH07XG59O1xuXG4vLyBzcmMvZGIvZmllbGQudHNcbnZhciBjcmVhdGVGaWVsZEF0dHJpYnV0ZSA9ICh0eXBlLCBjb25maWcpID0+IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlLFxuICAgIC4uLmNvbmZpZ1xuICB9O1xufTtcblxuLy8gc3JjL2RiL2dldC10YWJsZXMudHNcbnZhciBnZXRBdXRoVGFibGVzID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgcGx1Z2luU2NoZW1hID0gb3B0aW9ucy5wbHVnaW5zPy5yZWR1Y2UoXG4gICAgKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgICBjb25zdCBzY2hlbWEgPSBwbHVnaW4uc2NoZW1hO1xuICAgICAgaWYgKCFzY2hlbWEpIHJldHVybiBhY2M7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEpKSB7XG4gICAgICAgIGFjY1trZXldID0ge1xuICAgICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgLi4uYWNjW2tleV0/LmZpZWxkcyxcbiAgICAgICAgICAgIC4uLnZhbHVlLmZpZWxkc1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbW9kZWxOYW1lOiB2YWx1ZS5tb2RlbE5hbWUgfHwga2V5XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sXG4gICAge31cbiAgKTtcbiAgY29uc3Qgc2hvdWxkQWRkUmF0ZUxpbWl0VGFibGUgPSBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSA9PT0gXCJkYXRhYmFzZVwiO1xuICBjb25zdCByYXRlTGltaXRUYWJsZSA9IHtcbiAgICByYXRlTGltaXQ6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/Lm1vZGVsTmFtZSB8fCBcInJhdGVMaW1pdFwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGtleToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5rZXkgfHwgXCJrZXlcIlxuICAgICAgICB9LFxuICAgICAgICBjb3VudDoge1xuICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5jb3VudCB8fCBcImNvdW50XCJcbiAgICAgICAgfSxcbiAgICAgICAgbGFzdFJlcXVlc3Q6IHtcbiAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgIGJpZ2ludDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5maWVsZHM/Lmxhc3RSZXF1ZXN0IHx8IFwibGFzdFJlcXVlc3RcIlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCB7IHVzZXIsIHNlc3Npb24sIGFjY291bnQsIC4uLnBsdWdpblRhYmxlcyB9ID0gcGx1Z2luU2NoZW1hIHx8IHt9O1xuICBjb25zdCBzZXNzaW9uVGFibGUgPSB7XG4gICAgc2Vzc2lvbjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnNlc3Npb24/Lm1vZGVsTmFtZSB8fCBcInNlc3Npb25cIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5leHBpcmVzQXQgfHwgXCJleHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICB0b2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udG9rZW4gfHwgXCJ0b2tlblwiLFxuICAgICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy51cGRhdGVkQXQgfHwgXCJ1cGRhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICBpcEFkZHJlc3M6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5pcEFkZHJlc3MgfHwgXCJpcEFkZHJlc3NcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VyQWdlbnQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy51c2VyQWdlbnQgfHwgXCJ1c2VyQWdlbnRcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnVzZXJJZCB8fCBcInVzZXJJZFwiLFxuICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICBvbkRlbGV0ZTogXCJjYXNjYWRlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIC4uLnNlc3Npb24/LmZpZWxkcyxcbiAgICAgICAgLi4ub3B0aW9ucy5zZXNzaW9uPy5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9LFxuICAgICAgb3JkZXI6IDJcbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgdXNlcjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5uYW1lIHx8IFwibmFtZVwiLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uZW1haWwgfHwgXCJlbWFpbFwiLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy51c2VyPy5maWVsZHM/LmVtYWlsVmVyaWZpZWQgfHwgXCJlbWFpbFZlcmlmaWVkXCJcbiAgICAgICAgfSxcbiAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5pbWFnZSB8fCBcImltYWdlXCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy51c2VyPy5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIC4uLnVzZXI/LmZpZWxkcyxcbiAgICAgICAgLi4ub3B0aW9ucy51c2VyPy5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9LFxuICAgICAgb3JkZXI6IDFcbiAgICB9LFxuICAgIC8vb25seSBhZGQgc2Vzc2lvbiB0YWJsZSBpZiBpdCdzIG5vdCBzdG9yZWQgaW4gc2Vjb25kYXJ5IHN0b3JhZ2VcbiAgICAuLi4hb3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlIHx8IG9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSA/IHNlc3Npb25UYWJsZSA6IHt9LFxuICAgIGFjY291bnQ6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5hY2NvdW50Py5tb2RlbE5hbWUgfHwgXCJhY2NvdW50XCIsXG4gICAgICBmaWVsZHM6IHtcbiAgICAgICAgYWNjb3VudElkOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5hY2NvdW50SWQgfHwgXCJhY2NvdW50SWRcIlxuICAgICAgICB9LFxuICAgICAgICBwcm92aWRlcklkOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5wcm92aWRlcklkIHx8IFwicHJvdmlkZXJJZFwiXG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICAgICAgbW9kZWw6IG9wdGlvbnMudXNlcj8ubW9kZWxOYW1lIHx8IFwidXNlclwiLFxuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIG9uRGVsZXRlOiBcImNhc2NhZGVcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8udXNlcklkIHx8IFwidXNlcklkXCJcbiAgICAgICAgfSxcbiAgICAgICAgYWNjZXNzVG9rZW46IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5hY2Nlc3NUb2tlbiB8fCBcImFjY2Vzc1Rva2VuXCJcbiAgICAgICAgfSxcbiAgICAgICAgcmVmcmVzaFRva2VuOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucmVmcmVzaFRva2VuIHx8IFwicmVmcmVzaFRva2VuXCJcbiAgICAgICAgfSxcbiAgICAgICAgaWRUb2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmlkVG9rZW4gfHwgXCJpZFRva2VuXCJcbiAgICAgICAgfSxcbiAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjZXNzVG9rZW5FeHBpcmVzQXQgfHwgXCJhY2Nlc3NUb2tlbkV4cGlyZXNBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCB8fCBcInJlZnJlc2hUb2tlbkV4cGlyZXNBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uc2NvcGUgfHwgXCJzY29wZVwiXG4gICAgICAgIH0sXG4gICAgICAgIHBhc3N3b3JkOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucGFzc3dvcmQgfHwgXCJwYXNzd29yZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmNyZWF0ZWRBdCB8fCBcImNyZWF0ZWRBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIC4uLmFjY291bnQ/LmZpZWxkc1xuICAgICAgfSxcbiAgICAgIG9yZGVyOiAzXG4gICAgfSxcbiAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/Lm1vZGVsTmFtZSB8fCBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGlkZW50aWZpZXI6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8uaWRlbnRpZmllciB8fCBcImlkZW50aWZpZXJcIlxuICAgICAgICB9LFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZmllbGRzPy52YWx1ZSB8fCBcInZhbHVlXCJcbiAgICAgICAgfSxcbiAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZmllbGRzPy5leHBpcmVzQXQgfHwgXCJleHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmNyZWF0ZWRBdCB8fCBcImNyZWF0ZWRBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCJcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9yZGVyOiA0XG4gICAgfSxcbiAgICAuLi5wbHVnaW5UYWJsZXMsXG4gICAgLi4uc2hvdWxkQWRkUmF0ZUxpbWl0VGFibGUgPyByYXRlTGltaXRUYWJsZSA6IHt9XG4gIH07XG59O1xuZnVuY3Rpb24gdG9ab2RTY2hlbWEoZmllbGRzKSB7XG4gIGNvbnN0IHNjaGVtYSA9IHoub2JqZWN0KHtcbiAgICAuLi5PYmplY3Qua2V5cyhmaWVsZHMpLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2tleV07XG4gICAgICBpZiAoIWZpZWxkKSB7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGQudHlwZSA9PT0gXCJzdHJpbmdbXVwiIHx8IGZpZWxkLnR5cGUgPT09IFwibnVtYmVyW11cIikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICBba2V5XTogei5hcnJheShmaWVsZC50eXBlID09PSBcInN0cmluZ1tdXCIgPyB6LnN0cmluZygpIDogei5udW1iZXIoKSlcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpZWxkLnR5cGUpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uYWNjLFxuICAgICAgICAgIFtrZXldOiB6LmFueSgpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBsZXQgc2NoZW1hMiA9IHpbZmllbGQudHlwZV0oKTtcbiAgICAgIGlmIChmaWVsZD8ucmVxdWlyZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIHNjaGVtYTIgPSBzY2hlbWEyLm9wdGlvbmFsKCk7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGQ/LnJldHVybmVkID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uYWNjLFxuICAgICAgICBba2V5XTogc2NoZW1hMlxuICAgICAgfTtcbiAgICB9LCB7fSlcbiAgfSk7XG4gIHJldHVybiBzY2hlbWE7XG59XG5cbi8vIHNyYy9hZGFwdGVycy91dGlscy50c1xuZnVuY3Rpb24gd2l0aEFwcGx5RGVmYXVsdCh2YWx1ZSwgZmllbGQsIGFjdGlvbikge1xuICBpZiAoYWN0aW9uID09PSBcInVwZGF0ZVwiKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGlmICh2YWx1ZSA9PT0gdm9pZCAwIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgaWYgKGZpZWxkLmRlZmF1bHRWYWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiBmaWVsZC5kZWZhdWx0VmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gZmllbGQuZGVmYXVsdFZhbHVlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmllbGQuZGVmYXVsdFZhbHVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbi8vIHNyYy9hZGFwdGVycy9tZW1vcnktYWRhcHRlci9tZW1vcnktYWRhcHRlci50c1xudmFyIGNyZWF0ZVRyYW5zZm9ybSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGZ1bmN0aW9uIGdldEZpZWxkKG1vZGVsLCBmaWVsZCkge1xuICAgIGlmIChmaWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxuICAgIGNvbnN0IGYgPSBzY2hlbWFbbW9kZWxdLmZpZWxkc1tmaWVsZF07XG4gICAgcmV0dXJuIGYuZmllbGROYW1lIHx8IGZpZWxkO1xuICB9XG4gIHJldHVybiB7XG4gICAgdHJhbnNmb3JtSW5wdXQoZGF0YSwgbW9kZWwsIGFjdGlvbikge1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gYWN0aW9uID09PSBcInVwZGF0ZVwiID8ge30gOiB7XG4gICAgICAgIGlkOiBvcHRpb25zLmFkdmFuY2VkPy5nZW5lcmF0ZUlkID8gb3B0aW9ucy5hZHZhbmNlZC5nZW5lcmF0ZUlkKHtcbiAgICAgICAgICBtb2RlbFxuICAgICAgICB9KSA6IGRhdGEuaWQgfHwgZ2VuZXJhdGVJZCgpXG4gICAgICB9O1xuICAgICAgY29uc3QgZmllbGRzID0gc2NoZW1hW21vZGVsXS5maWVsZHM7XG4gICAgICBmb3IgKGNvbnN0IGZpZWxkIGluIGZpZWxkcykge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGRhdGFbZmllbGRdO1xuICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCAmJiAhZmllbGRzW2ZpZWxkXS5kZWZhdWx0VmFsdWUpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2Zvcm1lZERhdGFbZmllbGRzW2ZpZWxkXS5maWVsZE5hbWUgfHwgZmllbGRdID0gd2l0aEFwcGx5RGVmYXVsdChcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICBmaWVsZHNbZmllbGRdLFxuICAgICAgICAgIGFjdGlvblxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkRGF0YTtcbiAgICB9LFxuICAgIHRyYW5zZm9ybU91dHB1dChkYXRhLCBtb2RlbCwgc2VsZWN0ID0gW10pIHtcbiAgICAgIGlmICghZGF0YSkgcmV0dXJuIG51bGw7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSBkYXRhLmlkIHx8IGRhdGEuX2lkID8gc2VsZWN0Lmxlbmd0aCA9PT0gMCB8fCBzZWxlY3QuaW5jbHVkZXMoXCJpZFwiKSA/IHtcbiAgICAgICAgaWQ6IGRhdGEuaWRcbiAgICAgIH0gOiB7fSA6IHt9O1xuICAgICAgY29uc3QgdGFibGVTY2hlbWEgPSBzY2hlbWFbbW9kZWxdLmZpZWxkcztcbiAgICAgIGZvciAoY29uc3Qga2V5IGluIHRhYmxlU2NoZW1hKSB7XG4gICAgICAgIGlmIChzZWxlY3QubGVuZ3RoICYmICFzZWxlY3QuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpZWxkID0gdGFibGVTY2hlbWFba2V5XTtcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgdHJhbnNmb3JtZWREYXRhW2tleV0gPSBkYXRhW2ZpZWxkLmZpZWxkTmFtZSB8fCBrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWREYXRhO1xuICAgIH0sXG4gICAgY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCB0YWJsZSwgbW9kZWwpIHtcbiAgICAgIHJldHVybiB0YWJsZS5maWx0ZXIoKHJlY29yZCkgPT4ge1xuICAgICAgICByZXR1cm4gd2hlcmUuZXZlcnkoKGNsYXVzZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgZmllbGQ6IF9maWVsZCwgdmFsdWUsIG9wZXJhdG9yIH0gPSBjbGF1c2U7XG4gICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChtb2RlbCwgX2ZpZWxkKTtcbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiaW5cIikge1xuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBtdXN0IGJlIGFuIGFycmF5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmluY2x1ZGVzKHJlY29yZFtmaWVsZF0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IFwiY29udGFpbnNcIikge1xuICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0uaW5jbHVkZXModmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IFwic3RhcnRzX3dpdGhcIikge1xuICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0uc3RhcnRzV2l0aCh2YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRvciA9PT0gXCJlbmRzX3dpdGhcIikge1xuICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0uZW5kc1dpdGgodmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcmVjb3JkW2ZpZWxkXSA9PT0gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0RmllbGRcbiAgfTtcbn07XG52YXIgbWVtb3J5QWRhcHRlciA9IChkYikgPT4gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgeyB0cmFuc2Zvcm1JbnB1dCwgdHJhbnNmb3JtT3V0cHV0LCBjb252ZXJ0V2hlcmVDbGF1c2UsIGdldEZpZWxkIH0gPSBjcmVhdGVUcmFuc2Zvcm0ob3B0aW9ucyk7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibWVtb3J5XCIsXG4gICAgY3JlYXRlOiBhc3luYyAoeyBtb2RlbCwgZGF0YSB9KSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHRyYW5zZm9ybUlucHV0KGRhdGEsIG1vZGVsLCBcImNyZWF0ZVwiKTtcbiAgICAgIGRiW21vZGVsXS5wdXNoKHRyYW5zZm9ybWVkKTtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1PdXRwdXQodHJhbnNmb3JtZWQsIG1vZGVsKTtcbiAgICB9LFxuICAgIGZpbmRPbmU6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSwgc2VsZWN0IH0pID0+IHtcbiAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCB0YWJsZSwgbW9kZWwpO1xuICAgICAgY29uc3QgcmVjb3JkID0gcmVzWzBdIHx8IG51bGw7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtT3V0cHV0KHJlY29yZCwgbW9kZWwsIHNlbGVjdCk7XG4gICAgfSxcbiAgICBmaW5kTWFueTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlLCBzb3J0QnksIGxpbWl0LCBvZmZzZXQgfSkgPT4ge1xuICAgICAgbGV0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgaWYgKHdoZXJlKSB7XG4gICAgICAgIHRhYmxlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCB0YWJsZSwgbW9kZWwpO1xuICAgICAgfVxuICAgICAgaWYgKHNvcnRCeSkge1xuICAgICAgICB0YWJsZSA9IHRhYmxlLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICBjb25zdCBmaWVsZCA9IGdldEZpZWxkKG1vZGVsLCBzb3J0QnkuZmllbGQpO1xuICAgICAgICAgIGlmIChzb3J0QnkuZGlyZWN0aW9uID09PSBcImFzY1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gYVtmaWVsZF0gPiBiW2ZpZWxkXSA/IDEgOiAtMTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGFbZmllbGRdIDwgYltmaWVsZF0gPyAxIDogLTE7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChvZmZzZXQgIT09IHZvaWQgMCkge1xuICAgICAgICB0YWJsZSA9IHRhYmxlLnNsaWNlKG9mZnNldCk7XG4gICAgICB9XG4gICAgICBpZiAobGltaXQgIT09IHZvaWQgMCkge1xuICAgICAgICB0YWJsZSA9IHRhYmxlLnNsaWNlKDAsIGxpbWl0KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0YWJsZS5tYXAoKHJlY29yZCkgPT4gdHJhbnNmb3JtT3V0cHV0KHJlY29yZCwgbW9kZWwpKTtcbiAgICB9LFxuICAgIHVwZGF0ZTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlLCB1cGRhdGUgfSkgPT4ge1xuICAgICAgY29uc3QgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIHRhYmxlLCBtb2RlbCk7XG4gICAgICByZXMuZm9yRWFjaCgocmVjb3JkKSA9PiB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ocmVjb3JkLCB0cmFuc2Zvcm1JbnB1dCh1cGRhdGUsIG1vZGVsLCBcInVwZGF0ZVwiKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1PdXRwdXQocmVzWzBdLCBtb2RlbCk7XG4gICAgfSxcbiAgICBkZWxldGU6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSB9KSA9PiB7XG4gICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgdGFibGUsIG1vZGVsKTtcbiAgICAgIGRiW21vZGVsXSA9IHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiAhcmVzLmluY2x1ZGVzKHJlY29yZCkpO1xuICAgIH0sXG4gICAgZGVsZXRlTWFueTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlIH0pID0+IHtcbiAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCB0YWJsZSwgbW9kZWwpO1xuICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgIGRiW21vZGVsXSA9IHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiB7XG4gICAgICAgIGlmIChyZXMuaW5jbHVkZXMocmVjb3JkKSkge1xuICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhcmVzLmluY2x1ZGVzKHJlY29yZCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjb3VudDtcbiAgICB9LFxuICAgIHVwZGF0ZU1hbnkoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZSB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCB0YWJsZSwgbW9kZWwpO1xuICAgICAgcmVzLmZvckVhY2goKHJlY29yZCkgPT4ge1xuICAgICAgICBPYmplY3QuYXNzaWduKHJlY29yZCwgdXBkYXRlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc1swXSB8fCBudWxsO1xuICAgIH1cbiAgfTtcbn07XG5cbi8vIHNyYy9kYi91dGlscy50c1xuYXN5bmMgZnVuY3Rpb24gZ2V0QWRhcHRlcihvcHRpb25zKSB7XG4gIGlmICghb3B0aW9ucy5kYXRhYmFzZSkge1xuICAgIGNvbnN0IHRhYmxlcyA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gICAgY29uc3QgbWVtb3J5REIgPSBPYmplY3Qua2V5cyh0YWJsZXMpLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICAgIGFjY1trZXldID0gW107XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbiAgICBsb2dnZXIud2FybihcbiAgICAgIFwiTm8gZGF0YWJhc2UgY29uZmlndXJhdGlvbiBwcm92aWRlZC4gVXNpbmcgbWVtb3J5IGFkYXB0ZXIgaW4gZGV2ZWxvcG1lbnRcIlxuICAgICk7XG4gICAgcmV0dXJuIG1lbW9yeUFkYXB0ZXIobWVtb3J5REIpKG9wdGlvbnMpO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5kYXRhYmFzZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgcmV0dXJuIG9wdGlvbnMuZGF0YWJhc2Uob3B0aW9ucyk7XG4gIH1cbiAgY29uc3QgeyBreXNlbHksIGRhdGFiYXNlVHlwZSB9ID0gYXdhaXQgY3JlYXRlS3lzZWx5QWRhcHRlcihvcHRpb25zKTtcbiAgaWYgKCFreXNlbHkpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgZGF0YWJhc2UgYWRhcHRlclwiKTtcbiAgfVxuICByZXR1cm4ga3lzZWx5QWRhcHRlcihreXNlbHksIHtcbiAgICB0eXBlOiBkYXRhYmFzZVR5cGUgfHwgXCJzcWxpdGVcIlxuICB9KShvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRUb0RCKGZpZWxkcywgdmFsdWVzKSB7XG4gIGxldCByZXN1bHQgPSB2YWx1ZXMuaWQgPyB7XG4gICAgaWQ6IHZhbHVlcy5pZFxuICB9IDoge307XG4gIGZvciAoY29uc3Qga2V5IGluIGZpZWxkcykge1xuICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2tleV07XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHJlc3VsdFtmaWVsZC5maWVsZE5hbWUgfHwga2V5XSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb252ZXJ0RnJvbURCKGZpZWxkcywgdmFsdWVzKSB7XG4gIGlmICghdmFsdWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgbGV0IHJlc3VsdCA9IHtcbiAgICBpZDogdmFsdWVzLmlkXG4gIH07XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGZpZWxkcykpIHtcbiAgICByZXN1bHRba2V5XSA9IHZhbHVlc1t2YWx1ZS5maWVsZE5hbWUgfHwga2V5XTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vLyBzcmMvZGIvZ2V0LXNjaGVtYS50c1xuZnVuY3Rpb24gZ2V0U2NoZW1hKGNvbmZpZykge1xuICBjb25zdCB0YWJsZXMgPSBnZXRBdXRoVGFibGVzKGNvbmZpZyk7XG4gIGxldCBzY2hlbWEgPSB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gdGFibGVzKSB7XG4gICAgY29uc3QgdGFibGUgPSB0YWJsZXNba2V5XTtcbiAgICBjb25zdCBmaWVsZHMgPSB0YWJsZS5maWVsZHM7XG4gICAgbGV0IGFjdHVhbEZpZWxkcyA9IHt9O1xuICAgIE9iamVjdC5lbnRyaWVzKGZpZWxkcykuZm9yRWFjaCgoW2tleTIsIGZpZWxkXSkgPT4ge1xuICAgICAgYWN0dWFsRmllbGRzW2ZpZWxkLmZpZWxkTmFtZSB8fCBrZXkyXSA9IGZpZWxkO1xuICAgICAgaWYgKGZpZWxkLnJlZmVyZW5jZXMpIHtcbiAgICAgICAgY29uc3QgcmVmVGFibGUgPSB0YWJsZXNbZmllbGQucmVmZXJlbmNlcy5tb2RlbF07XG4gICAgICAgIGlmIChyZWZUYWJsZSkge1xuICAgICAgICAgIGFjdHVhbEZpZWxkc1tmaWVsZC5maWVsZE5hbWUgfHwga2V5Ml0ucmVmZXJlbmNlcyA9IHtcbiAgICAgICAgICAgIG1vZGVsOiByZWZUYWJsZS5tb2RlbE5hbWUsXG4gICAgICAgICAgICBmaWVsZDogZmllbGQucmVmZXJlbmNlcy5maWVsZFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0pIHtcbiAgICAgIHNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdLmZpZWxkcyA9IHtcbiAgICAgICAgLi4uc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0uZmllbGRzLFxuICAgICAgICAuLi5hY3R1YWxGaWVsZHNcbiAgICAgIH07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgc2NoZW1hW3RhYmxlLm1vZGVsTmFtZV0gPSB7XG4gICAgICBmaWVsZHM6IGFjdHVhbEZpZWxkcyxcbiAgICAgIG9yZGVyOiB0YWJsZS5vcmRlciB8fCBJbmZpbml0eVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHNjaGVtYTtcbn1cblxuLy8gc3JjL2RiL2dldC1taWdyYXRpb24udHNcbnZhciBwb3N0Z3Jlc01hcCA9IHtcbiAgc3RyaW5nOiBbXCJjaGFyYWN0ZXIgdmFyeWluZ1wiLCBcInRleHRcIl0sXG4gIG51bWJlcjogW1xuICAgIFwiaW50NFwiLFxuICAgIFwiaW50ZWdlclwiLFxuICAgIFwiYmlnaW50XCIsXG4gICAgXCJzbWFsbGludFwiLFxuICAgIFwibnVtZXJpY1wiLFxuICAgIFwicmVhbFwiLFxuICAgIFwiZG91YmxlIHByZWNpc2lvblwiXG4gIF0sXG4gIGJvb2xlYW46IFtcImJvb2xcIiwgXCJib29sZWFuXCJdLFxuICBkYXRlOiBbXCJ0aW1lc3RhbXBcIiwgXCJkYXRlXCJdXG59O1xudmFyIG15c3FsTWFwID0ge1xuICBzdHJpbmc6IFtcInZhcmNoYXJcIiwgXCJ0ZXh0XCJdLFxuICBudW1iZXI6IFtcbiAgICBcImludGVnZXJcIixcbiAgICBcImludFwiLFxuICAgIFwiYmlnaW50XCIsXG4gICAgXCJzbWFsbGludFwiLFxuICAgIFwiZGVjaW1hbFwiLFxuICAgIFwiZmxvYXRcIixcbiAgICBcImRvdWJsZVwiXG4gIF0sXG4gIGJvb2xlYW46IFtcImJvb2xlYW5cIiwgXCJ0aW55aW50XCJdLFxuICBkYXRlOiBbXCJ0aW1lc3RhbXBcIiwgXCJkYXRldGltZVwiLCBcImRhdGVcIl1cbn07XG52YXIgc3FsaXRlTWFwID0ge1xuICBzdHJpbmc6IFtcIlRFWFRcIl0sXG4gIG51bWJlcjogW1wiSU5URUdFUlwiLCBcIlJFQUxcIl0sXG4gIGJvb2xlYW46IFtcIklOVEVHRVJcIiwgXCJCT09MRUFOXCJdLFxuICAvLyAwIG9yIDFcbiAgZGF0ZTogW1wiREFURVwiLCBcIklOVEVHRVJcIl1cbn07XG52YXIgbXNzcWxNYXAgPSB7XG4gIHN0cmluZzogW1widGV4dFwiLCBcInZhcmNoYXJcIl0sXG4gIG51bWJlcjogW1wiaW50XCIsIFwiYmlnaW50XCIsIFwic21hbGxpbnRcIiwgXCJkZWNpbWFsXCIsIFwiZmxvYXRcIiwgXCJkb3VibGVcIl0sXG4gIGJvb2xlYW46IFtcImJpdFwiLCBcInNtYWxsaW50XCJdLFxuICBkYXRlOiBbXCJkYXRldGltZVwiLCBcImRhdGVcIl1cbn07XG52YXIgbWFwID0ge1xuICBwb3N0Z3JlczogcG9zdGdyZXNNYXAsXG4gIG15c3FsOiBteXNxbE1hcCxcbiAgc3FsaXRlOiBzcWxpdGVNYXAsXG4gIG1zc3FsOiBtc3NxbE1hcFxufTtcbmZ1bmN0aW9uIG1hdGNoVHlwZShjb2x1bW5EYXRhVHlwZSwgZmllbGRUeXBlLCBkYlR5cGUpIHtcbiAgaWYgKGZpZWxkVHlwZSA9PT0gXCJzdHJpbmdbXVwiIHx8IGZpZWxkVHlwZSA9PT0gXCJudW1iZXJbXVwiKSB7XG4gICAgcmV0dXJuIGNvbHVtbkRhdGFUeXBlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJqc29uXCIpO1xuICB9XG4gIGNvbnN0IHR5cGVzID0gbWFwW2RiVHlwZV07XG4gIGNvbnN0IHR5cGUgPSBBcnJheS5pc0FycmF5KGZpZWxkVHlwZSkgPyB0eXBlc1tcInN0cmluZ1wiXS5tYXAoKHQpID0+IHQudG9Mb3dlckNhc2UoKSkgOiB0eXBlc1tmaWVsZFR5cGVdLm1hcCgodCkgPT4gdC50b0xvd2VyQ2FzZSgpKTtcbiAgY29uc3QgbWF0Y2hlcyA9IHR5cGUuaW5jbHVkZXMoY29sdW1uRGF0YVR5cGUudG9Mb3dlckNhc2UoKSk7XG4gIHJldHVybiBtYXRjaGVzO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0TWlncmF0aW9ucyhjb25maWcpIHtcbiAgY29uc3QgYmV0dGVyQXV0aFNjaGVtYSA9IGdldFNjaGVtYShjb25maWcpO1xuICBjb25zdCBsb2dnZXIyID0gY3JlYXRlTG9nZ2VyKGNvbmZpZy5sb2dnZXIpO1xuICBsZXQgeyBreXNlbHk6IGRiLCBkYXRhYmFzZVR5cGU6IGRiVHlwZSB9ID0gYXdhaXQgY3JlYXRlS3lzZWx5QWRhcHRlcihjb25maWcpO1xuICBpZiAoIWRiVHlwZSkge1xuICAgIGxvZ2dlcjIud2FybihcbiAgICAgIFwiQ291bGQgbm90IGRldGVybWluZSBkYXRhYmFzZSB0eXBlLCBkZWZhdWx0aW5nIHRvIHNxbGl0ZS4gUGxlYXNlIHByb3ZpZGUgYSB0eXBlIGluIHRoZSBkYXRhYmFzZSBvcHRpb25zIHRvIGF2b2lkIHRoaXMuXCJcbiAgICApO1xuICAgIGRiVHlwZSA9IFwic3FsaXRlXCI7XG4gIH1cbiAgaWYgKCFkYikge1xuICAgIGxvZ2dlcjIuZXJyb3IoXG4gICAgICBcIk9ubHkga3lzZWx5IGFkYXB0ZXIgaXMgc3VwcG9ydGVkIGZvciBtaWdyYXRpb25zLiBZb3UgY2FuIHVzZSBgZ2VuZXJhdGVgIGNvbW1hbmQgdG8gZ2VuZXJhdGUgdGhlIHNjaGVtYSwgaWYgeW91J3JlIHVzaW5nIGEgZGlmZmVyZW50IGFkYXB0ZXIuXCJcbiAgICApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuICBjb25zdCB0YWJsZU1ldGFkYXRhID0gYXdhaXQgZGIuaW50cm9zcGVjdGlvbi5nZXRUYWJsZXMoKTtcbiAgY29uc3QgdG9CZUNyZWF0ZWQgPSBbXTtcbiAgY29uc3QgdG9CZUFkZGVkID0gW107XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGJldHRlckF1dGhTY2hlbWEpKSB7XG4gICAgY29uc3QgdGFibGUgPSB0YWJsZU1ldGFkYXRhLmZpbmQoKHQpID0+IHQubmFtZSA9PT0ga2V5KTtcbiAgICBpZiAoIXRhYmxlKSB7XG4gICAgICBjb25zdCB0SW5kZXggPSB0b0JlQ3JlYXRlZC5maW5kSW5kZXgoKHQpID0+IHQudGFibGUgPT09IGtleSk7XG4gICAgICBjb25zdCB0YWJsZURhdGEgPSB7XG4gICAgICAgIHRhYmxlOiBrZXksXG4gICAgICAgIGZpZWxkczogdmFsdWUuZmllbGRzLFxuICAgICAgICBvcmRlcjogdmFsdWUub3JkZXIgfHwgSW5maW5pdHlcbiAgICAgIH07XG4gICAgICBjb25zdCBpbnNlcnRJbmRleCA9IHRvQmVDcmVhdGVkLmZpbmRJbmRleChcbiAgICAgICAgKHQpID0+ICh0Lm9yZGVyIHx8IEluZmluaXR5KSA+IHRhYmxlRGF0YS5vcmRlclxuICAgICAgKTtcbiAgICAgIGlmIChpbnNlcnRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKHRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICB0b0JlQ3JlYXRlZC5wdXNoKHRhYmxlRGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9CZUNyZWF0ZWRbdEluZGV4XS5maWVsZHMgPSB7XG4gICAgICAgICAgICAuLi50b0JlQ3JlYXRlZFt0SW5kZXhdLmZpZWxkcyxcbiAgICAgICAgICAgIC4uLnZhbHVlLmZpZWxkc1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvQmVDcmVhdGVkLnNwbGljZShpbnNlcnRJbmRleCwgMCwgdGFibGVEYXRhKTtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBsZXQgdG9CZUFkZGVkRmllbGRzID0ge307XG4gICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModmFsdWUuZmllbGRzKSkge1xuICAgICAgY29uc3QgY29sdW1uID0gdGFibGUuY29sdW1ucy5maW5kKChjKSA9PiBjLm5hbWUgPT09IGZpZWxkTmFtZSk7XG4gICAgICBpZiAoIWNvbHVtbikge1xuICAgICAgICB0b0JlQWRkZWRGaWVsZHNbZmllbGROYW1lXSA9IGZpZWxkO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChtYXRjaFR5cGUoY29sdW1uLmRhdGFUeXBlLCBmaWVsZC50eXBlLCBkYlR5cGUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nZ2VyMi53YXJuKFxuICAgICAgICAgIGBGaWVsZCAke2ZpZWxkTmFtZX0gaW4gdGFibGUgJHtrZXl9IGhhcyBhIGRpZmZlcmVudCB0eXBlIGluIHRoZSBkYXRhYmFzZS4gRXhwZWN0ZWQgJHtmaWVsZC50eXBlfSBidXQgZ290ICR7Y29sdW1uLmRhdGFUeXBlfS5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChPYmplY3Qua2V5cyh0b0JlQWRkZWRGaWVsZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgIHRvQmVBZGRlZC5wdXNoKHtcbiAgICAgICAgdGFibGU6IGtleSxcbiAgICAgICAgZmllbGRzOiB0b0JlQWRkZWRGaWVsZHMsXG4gICAgICAgIG9yZGVyOiB2YWx1ZS5vcmRlciB8fCBJbmZpbml0eVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGNvbnN0IG1pZ3JhdGlvbnMgPSBbXTtcbiAgZnVuY3Rpb24gZ2V0VHlwZShmaWVsZCkge1xuICAgIGNvbnN0IHR5cGUgPSBmaWVsZC50eXBlO1xuICAgIGNvbnN0IHR5cGVNYXAgPSB7XG4gICAgICBzdHJpbmc6IHtcbiAgICAgICAgc3FsaXRlOiBcInRleHRcIixcbiAgICAgICAgcG9zdGdyZXM6IFwidGV4dFwiLFxuICAgICAgICBteXNxbDogZmllbGQudW5pcXVlID8gXCJ2YXJjaGFyKDI1NSlcIiA6IGZpZWxkLnJlZmVyZW5jZXMgPyBcInZhcmNoYXIoMzYpXCIgOiBcInRleHRcIixcbiAgICAgICAgbXNzcWw6IGZpZWxkLnVuaXF1ZSB8fCBmaWVsZC5zb3J0YWJsZSA/IFwidmFyY2hhcigyNTUpXCIgOiBmaWVsZC5yZWZlcmVuY2VzID8gXCJ2YXJjaGFyKDM2KVwiIDogXCJ0ZXh0XCJcbiAgICAgIH0sXG4gICAgICBib29sZWFuOiB7XG4gICAgICAgIHNxbGl0ZTogXCJpbnRlZ2VyXCIsXG4gICAgICAgIHBvc3RncmVzOiBcImJvb2xlYW5cIixcbiAgICAgICAgbXlzcWw6IFwiYm9vbGVhblwiLFxuICAgICAgICBtc3NxbDogXCJzbWFsbGludFwiXG4gICAgICB9LFxuICAgICAgbnVtYmVyOiB7XG4gICAgICAgIHNxbGl0ZTogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiLFxuICAgICAgICBwb3N0Z3JlczogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiLFxuICAgICAgICBteXNxbDogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiLFxuICAgICAgICBtc3NxbDogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiXG4gICAgICB9LFxuICAgICAgZGF0ZToge1xuICAgICAgICBzcWxpdGU6IFwiZGF0ZVwiLFxuICAgICAgICBwb3N0Z3JlczogXCJ0aW1lc3RhbXBcIixcbiAgICAgICAgbXlzcWw6IFwiZGF0ZXRpbWVcIixcbiAgICAgICAgbXNzcWw6IFwiZGF0ZXRpbWVcIlxuICAgICAgfVxuICAgIH07XG4gICAgaWYgKGRiVHlwZSA9PT0gXCJzcWxpdGVcIiAmJiAodHlwZSA9PT0gXCJzdHJpbmdbXVwiIHx8IHR5cGUgPT09IFwibnVtYmVyW11cIikpIHtcbiAgICAgIHJldHVybiBcInRleHRcIjtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09IFwic3RyaW5nW11cIiB8fCB0eXBlID09PSBcIm51bWJlcltdXCIpIHtcbiAgICAgIHJldHVybiBcImpzb25iXCI7XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHR5cGUpKSB7XG4gICAgICByZXR1cm4gXCJ0ZXh0XCI7XG4gICAgfVxuICAgIHJldHVybiB0eXBlTWFwW3R5cGVdW2RiVHlwZSB8fCBcInNxbGl0ZVwiXTtcbiAgfVxuICBpZiAodG9CZUFkZGVkLmxlbmd0aCkge1xuICAgIGZvciAoY29uc3QgdGFibGUgb2YgdG9CZUFkZGVkKSB7XG4gICAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIGZpZWxkXSBvZiBPYmplY3QuZW50cmllcyh0YWJsZS5maWVsZHMpKSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBnZXRUeXBlKGZpZWxkKTtcbiAgICAgICAgY29uc3QgZXhlYyA9IGRiLnNjaGVtYS5hbHRlclRhYmxlKHRhYmxlLnRhYmxlKS5hZGRDb2x1bW4oZmllbGROYW1lLCB0eXBlLCAoY29sKSA9PiB7XG4gICAgICAgICAgY29sID0gZmllbGQucmVxdWlyZWQgIT09IGZhbHNlID8gY29sLm5vdE51bGwoKSA6IGNvbDtcbiAgICAgICAgICBpZiAoZmllbGQucmVmZXJlbmNlcykge1xuICAgICAgICAgICAgY29sID0gY29sLnJlZmVyZW5jZXMoXG4gICAgICAgICAgICAgIGAke2ZpZWxkLnJlZmVyZW5jZXMubW9kZWx9LiR7ZmllbGQucmVmZXJlbmNlcy5maWVsZH1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudW5pcXVlKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wudW5pcXVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjb2w7XG4gICAgICAgIH0pO1xuICAgICAgICBtaWdyYXRpb25zLnB1c2goZXhlYyk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmICh0b0JlQ3JlYXRlZC5sZW5ndGgpIHtcbiAgICBmb3IgKGNvbnN0IHRhYmxlIG9mIHRvQmVDcmVhdGVkKSB7XG4gICAgICBsZXQgZGJUID0gZGIuc2NoZW1hLmNyZWF0ZVRhYmxlKHRhYmxlLnRhYmxlKS5hZGRDb2x1bW4oXG4gICAgICAgIFwiaWRcIixcbiAgICAgICAgZGJUeXBlID09PSBcIm15c3FsXCIgfHwgZGJUeXBlID09PSBcIm1zc3FsXCIgPyBcInZhcmNoYXIoMzYpXCIgOiBcInRleHRcIixcbiAgICAgICAgKGNvbCkgPT4gY29sLnByaW1hcnlLZXkoKS5ub3ROdWxsKClcbiAgICAgICk7XG4gICAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIGZpZWxkXSBvZiBPYmplY3QuZW50cmllcyh0YWJsZS5maWVsZHMpKSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBnZXRUeXBlKGZpZWxkKTtcbiAgICAgICAgZGJUID0gZGJULmFkZENvbHVtbihmaWVsZE5hbWUsIHR5cGUsIChjb2wpID0+IHtcbiAgICAgICAgICBjb2wgPSBmaWVsZC5yZXF1aXJlZCAhPT0gZmFsc2UgPyBjb2wubm90TnVsbCgpIDogY29sO1xuICAgICAgICAgIGlmIChmaWVsZC5yZWZlcmVuY2VzKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wucmVmZXJlbmNlcyhcbiAgICAgICAgICAgICAgYCR7ZmllbGQucmVmZXJlbmNlcy5tb2RlbH0uJHtmaWVsZC5yZWZlcmVuY2VzLmZpZWxkfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC51bmlxdWUpIHtcbiAgICAgICAgICAgIGNvbCA9IGNvbC51bmlxdWUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNvbDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBtaWdyYXRpb25zLnB1c2goZGJUKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gcnVuTWlncmF0aW9ucygpIHtcbiAgICBmb3IgKGNvbnN0IG1pZ3JhdGlvbiBvZiBtaWdyYXRpb25zKSB7XG4gICAgICBhd2FpdCBtaWdyYXRpb24uZXhlY3V0ZSgpO1xuICAgIH1cbiAgfVxuICBhc3luYyBmdW5jdGlvbiBjb21waWxlTWlncmF0aW9ucygpIHtcbiAgICBjb25zdCBjb21waWxlZCA9IG1pZ3JhdGlvbnMubWFwKChtKSA9PiBtLmNvbXBpbGUoKS5zcWwpO1xuICAgIHJldHVybiBjb21waWxlZC5qb2luKFwiO1xcblxcblwiKTtcbiAgfVxuICByZXR1cm4geyB0b0JlQ3JlYXRlZCwgdG9CZUFkZGVkLCBydW5NaWdyYXRpb25zLCBjb21waWxlTWlncmF0aW9ucyB9O1xufVxuXG4vLyBzcmMvYWRhcHRlcnMva3lzZWx5LWFkYXB0ZXIva3lzZWx5LWFkYXB0ZXIudHNcbnZhciBjcmVhdGVUcmFuc2Zvcm0yID0gKGRiLCBvcHRpb25zLCBjb25maWcpID0+IHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgZnVuY3Rpb24gZ2V0RmllbGQobW9kZWwsIGZpZWxkKSB7XG4gICAgaWYgKGZpZWxkID09PSBcImlkXCIpIHtcbiAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG4gICAgY29uc3QgZiA9IHNjaGVtYVttb2RlbF0uZmllbGRzW2ZpZWxkXTtcbiAgICBpZiAoIWYpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRmllbGQgbm90IGZvdW5kXCIsIG1vZGVsLCBmaWVsZCk7XG4gICAgfVxuICAgIHJldHVybiBmLmZpZWxkTmFtZSB8fCBmaWVsZDtcbiAgfVxuICBmdW5jdGlvbiB0cmFuc2Zvcm1WYWx1ZVRvREIodmFsdWUsIG1vZGVsLCBmaWVsZCkge1xuICAgIGNvbnN0IHsgdHlwZSA9IFwic3FsaXRlXCIgfSA9IGNvbmZpZyB8fCB7fTtcbiAgICBjb25zdCBmID0gc2NoZW1hW21vZGVsXS5maWVsZHNbZmllbGRdO1xuICAgIGlmIChmLnR5cGUgPT09IFwiYm9vbGVhblwiICYmICh0eXBlID09PSBcInNxbGl0ZVwiIHx8IHR5cGUgPT09IFwibXNzcWxcIikgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIHZhbHVlID8gMSA6IDA7XG4gICAgfVxuICAgIGlmIChmLnR5cGUgPT09IFwiZGF0ZVwiICYmIHZhbHVlICYmIHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgcmV0dXJuIHR5cGUgPT09IFwic3FsaXRlXCIgPyB2YWx1ZS50b0lTT1N0cmluZygpIDogdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBmdW5jdGlvbiB0cmFuc2Zvcm1WYWx1ZUZyb21EQih2YWx1ZSwgbW9kZWwsIGZpZWxkKSB7XG4gICAgY29uc3QgeyB0eXBlID0gXCJzcWxpdGVcIiB9ID0gY29uZmlnIHx8IHt9O1xuICAgIGNvbnN0IGYgPSBzY2hlbWFbbW9kZWxdLmZpZWxkc1tmaWVsZF07XG4gICAgaWYgKGYudHlwZSA9PT0gXCJib29sZWFuXCIgJiYgKHR5cGUgPT09IFwic3FsaXRlXCIgfHwgdHlwZSA9PT0gXCJtc3NxbFwiKSAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHZhbHVlID09PSAxO1xuICAgIH1cbiAgICBpZiAoZi50eXBlID09PSBcImRhdGVcIiAmJiB2YWx1ZSkge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGZ1bmN0aW9uIGdldE1vZGVsTmFtZShtb2RlbCkge1xuICAgIHJldHVybiBzY2hlbWFbbW9kZWxdLm1vZGVsTmFtZTtcbiAgfVxuICBjb25zdCB1c2VEYXRhYmFzZUdlbmVyYXRlZElkID0gb3B0aW9ucz8uYWR2YW5jZWQ/LmdlbmVyYXRlSWQgPT09IGZhbHNlO1xuICByZXR1cm4ge1xuICAgIHRyYW5zZm9ybUlucHV0KGRhdGEsIG1vZGVsLCBhY3Rpb24pIHtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IHVzZURhdGFiYXNlR2VuZXJhdGVkSWQgfHwgYWN0aW9uID09PSBcInVwZGF0ZVwiID8ge30gOiB7XG4gICAgICAgIGlkOiBvcHRpb25zLmFkdmFuY2VkPy5nZW5lcmF0ZUlkID8gb3B0aW9ucy5hZHZhbmNlZC5nZW5lcmF0ZUlkKHtcbiAgICAgICAgICBtb2RlbFxuICAgICAgICB9KSA6IGRhdGEuaWQgfHwgZ2VuZXJhdGVJZCgpXG4gICAgICB9O1xuICAgICAgY29uc3QgZmllbGRzID0gc2NoZW1hW21vZGVsXS5maWVsZHM7XG4gICAgICBmb3IgKGNvbnN0IGZpZWxkIGluIGZpZWxkcykge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGRhdGFbZmllbGRdO1xuICAgICAgICB0cmFuc2Zvcm1lZERhdGFbZmllbGRzW2ZpZWxkXS5maWVsZE5hbWUgfHwgZmllbGRdID0gd2l0aEFwcGx5RGVmYXVsdChcbiAgICAgICAgICB0cmFuc2Zvcm1WYWx1ZVRvREIodmFsdWUsIG1vZGVsLCBmaWVsZCksXG4gICAgICAgICAgZmllbGRzW2ZpZWxkXSxcbiAgICAgICAgICBhY3Rpb25cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gICAgfSxcbiAgICB0cmFuc2Zvcm1PdXRwdXQoZGF0YSwgbW9kZWwsIHNlbGVjdCA9IFtdKSB7XG4gICAgICBpZiAoIWRhdGEpIHJldHVybiBudWxsO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gZGF0YS5pZCA/IHNlbGVjdC5sZW5ndGggPT09IDAgfHwgc2VsZWN0LmluY2x1ZGVzKFwiaWRcIikgPyB7XG4gICAgICAgIGlkOiBkYXRhLmlkXG4gICAgICB9IDoge30gOiB7fTtcbiAgICAgIGNvbnN0IHRhYmxlU2NoZW1hID0gc2NoZW1hW21vZGVsXS5maWVsZHM7XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0YWJsZVNjaGVtYSkge1xuICAgICAgICBpZiAoc2VsZWN0Lmxlbmd0aCAmJiAhc2VsZWN0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWVsZCA9IHRhYmxlU2NoZW1hW2tleV07XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgIHRyYW5zZm9ybWVkRGF0YVtrZXldID0gdHJhbnNmb3JtVmFsdWVGcm9tREIoXG4gICAgICAgICAgICBkYXRhW2ZpZWxkLmZpZWxkTmFtZSB8fCBrZXldLFxuICAgICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgICBrZXlcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWREYXRhO1xuICAgIH0sXG4gICAgY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3KSB7XG4gICAgICBpZiAoIXcpXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYW5kOiBudWxsLFxuICAgICAgICAgIG9yOiBudWxsXG4gICAgICAgIH07XG4gICAgICBjb25zdCBjb25kaXRpb25zID0ge1xuICAgICAgICBhbmQ6IFtdLFxuICAgICAgICBvcjogW11cbiAgICAgIH07XG4gICAgICB3LmZvckVhY2goKGNvbmRpdGlvbikgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZmllbGQ6IF9maWVsZCxcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICBvcGVyYXRvciA9IFwiPVwiLFxuICAgICAgICAgIGNvbm5lY3RvciA9IFwiQU5EXCJcbiAgICAgICAgfSA9IGNvbmRpdGlvbjtcbiAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChtb2RlbCwgX2ZpZWxkKTtcbiAgICAgICAgY29uc3QgZXhwciA9IChlYikgPT4ge1xuICAgICAgICAgIGlmIChvcGVyYXRvci50b0xvd2VyQ2FzZSgpID09PSBcImluXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCJpblwiLCBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJjb250YWluc1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwibGlrZVwiLCBgJSR7dmFsdWV9JWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwic3RhcnRzX3dpdGhcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcImxpa2VcIiwgYCR7dmFsdWV9JWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZW5kc193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCJsaWtlXCIsIGAlJHt2YWx1ZX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImVxXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI9XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcIm5lXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8PlwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJndFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPlwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJndGVcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIj49XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImx0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImx0ZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPD1cIiwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIG9wZXJhdG9yLCB2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChjb25uZWN0b3IgPT09IFwiT1JcIikge1xuICAgICAgICAgIGNvbmRpdGlvbnMub3IucHVzaChleHByKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25kaXRpb25zLmFuZC5wdXNoKGV4cHIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFuZDogY29uZGl0aW9ucy5hbmQubGVuZ3RoID8gY29uZGl0aW9ucy5hbmQgOiBudWxsLFxuICAgICAgICBvcjogY29uZGl0aW9ucy5vci5sZW5ndGggPyBjb25kaXRpb25zLm9yIDogbnVsbFxuICAgICAgfTtcbiAgICB9LFxuICAgIGFzeW5jIHdpdGhSZXR1cm5pbmcodmFsdWVzLCBidWlsZGVyLCBtb2RlbCwgd2hlcmUpIHtcbiAgICAgIGxldCByZXM7XG4gICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm15c3FsXCIpIHtcbiAgICAgICAgYXdhaXQgYnVpbGRlci5leGVjdXRlKCk7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gdmFsdWVzLmlkID8gXCJpZFwiIDogd2hlcmVbMF0uZmllbGQgPyB3aGVyZVswXS5maWVsZCA6IFwiaWRcIjtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbZmllbGRdIHx8IHdoZXJlWzBdLnZhbHVlO1xuICAgICAgICByZXMgPSBhd2FpdCBkYi5zZWxlY3RGcm9tKGdldE1vZGVsTmFtZShtb2RlbCkpLnNlbGVjdEFsbCgpLndoZXJlKGdldEZpZWxkKG1vZGVsLCBmaWVsZCksIFwiPVwiLCB2YWx1ZSkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfVxuICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJtc3NxbFwiKSB7XG4gICAgICAgIHJlcyA9IGF3YWl0IGJ1aWxkZXIub3V0cHV0QWxsKFwiaW5zZXJ0ZWRcIikuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfVxuICAgICAgcmVzID0gYXdhaXQgYnVpbGRlci5yZXR1cm5pbmdBbGwoKS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgZ2V0TW9kZWxOYW1lLFxuICAgIGdldEZpZWxkXG4gIH07XG59O1xudmFyIGt5c2VseUFkYXB0ZXIgPSAoZGIsIGNvbmZpZykgPT4gKG9wdHMpID0+IHtcbiAgY29uc3Qge1xuICAgIHRyYW5zZm9ybUlucHV0LFxuICAgIHdpdGhSZXR1cm5pbmcsXG4gICAgdHJhbnNmb3JtT3V0cHV0LFxuICAgIGNvbnZlcnRXaGVyZUNsYXVzZSxcbiAgICBnZXRNb2RlbE5hbWUsXG4gICAgZ2V0RmllbGRcbiAgfSA9IGNyZWF0ZVRyYW5zZm9ybTIoZGIsIG9wdHMsIGNvbmZpZyk7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwia3lzZWx5XCIsXG4gICAgYXN5bmMgY3JlYXRlKGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIGRhdGE6IHZhbHVlcywgc2VsZWN0IH0gPSBkYXRhO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFuc2Zvcm1JbnB1dCh2YWx1ZXMsIG1vZGVsLCBcImNyZWF0ZVwiKTtcbiAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi5pbnNlcnRJbnRvKGdldE1vZGVsTmFtZShtb2RlbCkpLnZhbHVlcyh0cmFuc2Zvcm1lZCk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtT3V0cHV0KFxuICAgICAgICBhd2FpdCB3aXRoUmV0dXJuaW5nKHRyYW5zZm9ybWVkLCBidWlsZGVyLCBtb2RlbCwgW10pLFxuICAgICAgICBtb2RlbCxcbiAgICAgICAgc2VsZWN0XG4gICAgICApO1xuICAgIH0sXG4gICAgYXN5bmMgZmluZE9uZShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSwgc2VsZWN0IH0gPSBkYXRhO1xuICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgIGxldCBxdWVyeSA9IGRiLnNlbGVjdEZyb20oZ2V0TW9kZWxOYW1lKG1vZGVsKSkuc2VsZWN0QWxsKCk7XG4gICAgICBpZiAoYW5kKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBpZiAob3IpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICBpZiAoIXJlcykgcmV0dXJuIG51bGw7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtT3V0cHV0KHJlcywgbW9kZWwsIHNlbGVjdCk7XG4gICAgfSxcbiAgICBhc3luYyBmaW5kTWFueShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSwgbGltaXQsIG9mZnNldCwgc29ydEJ5IH0gPSBkYXRhO1xuICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgIGxldCBxdWVyeSA9IGRiLnNlbGVjdEZyb20oZ2V0TW9kZWxOYW1lKG1vZGVsKSk7XG4gICAgICBpZiAoYW5kKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBpZiAob3IpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgaWYgKCFvZmZzZXQpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LnRvcChsaW1pdCB8fCAxMDApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmxpbWl0KGxpbWl0IHx8IDEwMCk7XG4gICAgICB9XG4gICAgICBpZiAoc29ydEJ5KSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXJCeShcbiAgICAgICAgICBnZXRGaWVsZChtb2RlbCwgc29ydEJ5LmZpZWxkKSxcbiAgICAgICAgICBzb3J0QnkuZGlyZWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBpZiAob2Zmc2V0KSB7XG4gICAgICAgIGlmIChjb25maWc/LnR5cGUgPT09IFwibXNzcWxcIikge1xuICAgICAgICAgIGlmICghc29ydEJ5KSB7XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyQnkoZ2V0RmllbGQobW9kZWwsIFwiaWRcIikpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9mZnNldChvZmZzZXQpLmZldGNoKGxpbWl0IHx8IDEwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5vZmZzZXQob2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuc2VsZWN0QWxsKCkuZXhlY3V0ZSgpO1xuICAgICAgaWYgKCFyZXMpIHJldHVybiBbXTtcbiAgICAgIHJldHVybiByZXMubWFwKChyKSA9PiB0cmFuc2Zvcm1PdXRwdXQociwgbW9kZWwpKTtcbiAgICB9LFxuICAgIGFzeW5jIHVwZGF0ZShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSwgdXBkYXRlOiB2YWx1ZXMgfSA9IGRhdGE7XG4gICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gdHJhbnNmb3JtSW5wdXQodmFsdWVzLCBtb2RlbCwgXCJ1cGRhdGVcIik7XG4gICAgICBsZXQgcXVlcnkgPSBkYi51cGRhdGVUYWJsZShnZXRNb2RlbE5hbWUobW9kZWwpKS5zZXQodHJhbnNmb3JtZWREYXRhKTtcbiAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcikge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRyYW5zZm9ybU91dHB1dChcbiAgICAgICAgYXdhaXQgd2l0aFJldHVybmluZyh0cmFuc2Zvcm1lZERhdGEsIHF1ZXJ5LCBtb2RlbCwgd2hlcmUpLFxuICAgICAgICBtb2RlbFxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBhc3luYyB1cGRhdGVNYW55KGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlLCB1cGRhdGU6IHZhbHVlcyB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSB0cmFuc2Zvcm1JbnB1dCh2YWx1ZXMsIG1vZGVsLCBcInVwZGF0ZVwiKTtcbiAgICAgIGxldCBxdWVyeSA9IGRiLnVwZGF0ZVRhYmxlKGdldE1vZGVsTmFtZShtb2RlbCkpLnNldCh0cmFuc2Zvcm1lZERhdGEpO1xuICAgICAgaWYgKGFuZCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgfVxuICAgICAgaWYgKG9yKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZSgpO1xuICAgICAgcmV0dXJuIHJlcy5sZW5ndGg7XG4gICAgfSxcbiAgICBhc3luYyBkZWxldGUoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUgfSA9IGRhdGE7XG4gICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgbGV0IHF1ZXJ5ID0gZGIuZGVsZXRlRnJvbShnZXRNb2RlbE5hbWUobW9kZWwpKTtcbiAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcikge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICB9LFxuICAgIGFzeW5jIGRlbGV0ZU1hbnkoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUgfSA9IGRhdGE7XG4gICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgbGV0IHF1ZXJ5ID0gZGIuZGVsZXRlRnJvbShnZXRNb2RlbE5hbWUobW9kZWwpKTtcbiAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcikge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoYXdhaXQgcXVlcnkuZXhlY3V0ZSgpKS5sZW5ndGg7XG4gICAgfSxcbiAgICBvcHRpb25zOiBjb25maWdcbiAgfTtcbn07XG5cbmV4cG9ydCB7IGNvbnZlcnRGcm9tREIsIGNvbnZlcnRUb0RCLCBjcmVhdGVGaWVsZEF0dHJpYnV0ZSwgY3JlYXRlSW50ZXJuYWxBZGFwdGVyLCBjcmVhdGVLeXNlbHlBZGFwdGVyLCBnZXRBZGFwdGVyLCBnZXRBdXRoVGFibGVzLCBnZXRNaWdyYXRpb25zLCBnZXRTY2hlbWEsIGdldFdpdGhIb29rcywga3lzZWx5QWRhcHRlciwgbWF0Y2hUeXBlLCBtZW1vcnlBZGFwdGVyLCB0b1pvZFNjaGVtYSwgd2l0aEFwcGx5RGVmYXVsdCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   multiSession: () => (/* binding */ multiSession)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\nvar multiSession = (options) => {\n  const opts = {\n    maximumSessions: 5,\n    ...options\n  };\n  const isMultiSessionCookie = (key) => key.includes(\"_multi-\");\n  const ERROR_CODES = {\n    INVALID_SESSION_TOKEN: \"Invalid session token\"\n  };\n  return {\n    id: \"multi-session\",\n    endpoints: {\n      listDeviceSessions: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/multi-session/list-device-sessions\",\n        {\n          method: \"GET\",\n          requireHeaders: true\n        },\n        async (ctx) => {\n          const cookieHeader = ctx.headers?.get(\"cookie\");\n          if (!cookieHeader) return ctx.json([]);\n          const cookies = Object.fromEntries((0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(cookieHeader));\n          const sessionTokens = (await Promise.all(\n            Object.entries(cookies).filter(([key]) => isMultiSessionCookie(key)).map(\n              async ([key]) => await ctx.getSignedCookie(key, ctx.context.secret)\n            )\n          )).filter((v) => v !== void 0);\n          if (!sessionTokens.length) return ctx.json([]);\n          const sessions = await ctx.context.internalAdapter.findSessions(sessionTokens);\n          const validSessions = sessions.filter(\n            (session) => session && session.session.expiresAt > /* @__PURE__ */ new Date()\n          );\n          return ctx.json(validSessions);\n        }\n      ),\n      setActiveSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/multi-session/set-active\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n            sessionToken: zod__WEBPACK_IMPORTED_MODULE_2__.z.string({\n              description: \"The session token to set as active\"\n            })\n          }),\n          requireHeaders: true,\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Set the active session\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const sessionToken = ctx.body.sessionToken;\n          const multiSessionCookieName = `${ctx.context.authCookies.sessionToken.name}_multi-${sessionToken}`;\n          const sessionCookie = await ctx.getSignedCookie(\n            multiSessionCookieName,\n            ctx.context.secret\n          );\n          if (!sessionCookie) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_SESSION_TOKEN\n            });\n          }\n          const session = await ctx.context.internalAdapter.findSession(sessionToken);\n          if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n            ctx.setCookie(multiSessionCookieName, \"\", {\n              ...ctx.context.authCookies.sessionToken.options,\n              maxAge: 0\n            });\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_SESSION_TOKEN\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, session);\n          return ctx.json(session);\n        }\n      ),\n      revokeDeviceSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/multi-session/revoke\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n            sessionToken: zod__WEBPACK_IMPORTED_MODULE_2__.z.string({\n              description: \"The session token to revoke\"\n            })\n          }),\n          requireHeaders: true,\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Revoke a device session\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          status: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const sessionToken = ctx.body.sessionToken;\n          const multiSessionCookieName = `${ctx.context.authCookies.sessionToken.name}_multi-${sessionToken}`;\n          const sessionCookie = await ctx.getSignedCookie(\n            multiSessionCookieName,\n            ctx.context.secret\n          );\n          if (!sessionCookie) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_SESSION_TOKEN\n            });\n          }\n          await ctx.context.internalAdapter.deleteSession(sessionToken);\n          ctx.setCookie(multiSessionCookieName, \"\", {\n            ...ctx.context.authCookies.sessionToken.options,\n            maxAge: 0\n          });\n          const isActive = ctx.context.session?.session.token === sessionToken;\n          if (!isActive) return ctx.json({ status: true });\n          const cookieHeader = ctx.headers?.get(\"cookie\");\n          if (cookieHeader) {\n            const cookies = Object.fromEntries((0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(cookieHeader));\n            const sessionTokens = (await Promise.all(\n              Object.entries(cookies).filter(([key]) => isMultiSessionCookie(key)).map(\n                async ([key]) => await ctx.getSignedCookie(key, ctx.context.secret)\n              )\n            )).filter((v) => v !== void 0);\n            const internalAdapter = ctx.context.internalAdapter;\n            if (sessionTokens.length > 0) {\n              const sessions = await internalAdapter.findSessions(sessionTokens);\n              const validSessions = sessions.filter(\n                (session) => session && session.session.expiresAt > /* @__PURE__ */ new Date()\n              );\n              if (validSessions.length > 0) {\n                const nextSession = validSessions[0];\n                await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, nextSession);\n              } else {\n                (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n              }\n            } else {\n              (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n            }\n          } else {\n            (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n          }\n          return ctx.json({\n            status: true\n          });\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher: () => true,\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const headers = ctx.context.returned instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError ? ctx.context.returned.headers : ctx.responseHeader;\n            const cookieString = headers.get(\"set-cookie\");\n            if (!cookieString) return;\n            const setCookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseSetCookieHeader)(cookieString);\n            const sessionCookieConfig = ctx.context.authCookies.sessionToken;\n            const sessionToken = setCookies.get(\n              sessionCookieConfig.name\n            )?.value;\n            if (!sessionToken) return;\n            const cookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(ctx.headers?.get(\"cookie\") || \"\");\n            const rawSession = sessionToken.split(\".\")[0];\n            if (!rawSession) {\n              return;\n            }\n            const cookieName = `${sessionCookieConfig.name}_multi-${rawSession}`;\n            if (setCookies.get(cookieName) || cookies.get(cookieName)) return;\n            const currentMultiSessions = Object.keys(Object.fromEntries(cookies)).filter(\n              isMultiSessionCookie\n            ).length + (cookieString.includes(\"session_token\") ? 1 : 0);\n            if (currentMultiSessions > opts.maximumSessions) {\n              return;\n            }\n            await ctx.setSignedCookie(\n              cookieName,\n              rawSession,\n              ctx.context.secret,\n              sessionCookieConfig.options\n            );\n          })\n        },\n        {\n          matcher: (context) => context.path === \"/sign-out\",\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const cookieHeader = ctx.headers?.get(\"cookie\");\n            if (!cookieHeader) return;\n            const cookies = Object.fromEntries((0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(cookieHeader));\n            const ids = Object.keys(cookies).map((key) => {\n              if (isMultiSessionCookie(key)) {\n                ctx.setCookie(key, \"\", { maxAge: 0 });\n                const id = key.split(\"_multi-\")[1];\n                return id;\n              }\n              return null;\n            }).filter((v) => v !== null);\n            await ctx.context.internalAdapter.deleteSessions(ids);\n          })\n        }\n      ]\n    },\n    $ERROR_CODES: ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstNkIzVVdBSjMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0RztBQUNJO0FBQ3hGOztBQUV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0VBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxnRUFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzRUFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLDBCQUEwQix5Q0FBUTtBQUNsQztBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQSxnQkFBZ0IsaUVBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw0Q0FBNEMsMENBQTBDLFNBQVMsYUFBYTtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQSxnQkFBZ0Isb0VBQWdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzRUFBa0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLDBCQUEwQix5Q0FBUTtBQUNsQztBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQSxnQkFBZ0IsaUVBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw0Q0FBNEMsMENBQTBDLFNBQVMsYUFBYTtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSwyQ0FBMkMsY0FBYztBQUN6RDtBQUNBO0FBQ0EsK0NBQStDLGdFQUFZO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLG9FQUFnQjtBQUN0QyxnQkFBZ0I7QUFDaEIsZ0JBQWdCLHVFQUFtQjtBQUNuQztBQUNBLGNBQWM7QUFDZCxjQUFjLHVFQUFtQjtBQUNqQztBQUNBLFlBQVk7QUFDWixZQUFZLHVFQUFtQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix3RUFBb0I7QUFDdkMsNERBQTRELHdEQUFRO0FBQ3BFO0FBQ0E7QUFDQSwrQkFBK0Isd0VBQW9CO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZ0VBQVk7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MseUJBQXlCLFNBQVMsV0FBVztBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLG1CQUFtQix3RUFBb0I7QUFDdkM7QUFDQTtBQUNBLCtDQUErQyxnRUFBWTtBQUMzRDtBQUNBO0FBQ0EseUNBQXlDLFdBQVc7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstNkIzVVdBSjMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBzZXNzaW9uTWlkZGxld2FyZSwgQVBJRXJyb3IsIGNyZWF0ZUF1dGhNaWRkbGV3YXJlIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBwYXJzZUNvb2tpZXMsIHNldFNlc3Npb25Db29raWUsIGRlbGV0ZVNlc3Npb25Db29raWUsIHBhcnNlU2V0Q29va2llSGVhZGVyIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxudmFyIG11bHRpU2Vzc2lvbiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgbWF4aW11bVNlc3Npb25zOiA1LFxuICAgIC4uLm9wdGlvbnNcbiAgfTtcbiAgY29uc3QgaXNNdWx0aVNlc3Npb25Db29raWUgPSAoa2V5KSA9PiBrZXkuaW5jbHVkZXMoXCJfbXVsdGktXCIpO1xuICBjb25zdCBFUlJPUl9DT0RFUyA9IHtcbiAgICBJTlZBTElEX1NFU1NJT05fVE9LRU46IFwiSW52YWxpZCBzZXNzaW9uIHRva2VuXCJcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJtdWx0aS1zZXNzaW9uXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBsaXN0RGV2aWNlU2Vzc2lvbnM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvbXVsdGktc2Vzc2lvbi9saXN0LWRldmljZS1zZXNzaW9uc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBjb29raWVIZWFkZXIgPSBjdHguaGVhZGVycz8uZ2V0KFwiY29va2llXCIpO1xuICAgICAgICAgIGlmICghY29va2llSGVhZGVyKSByZXR1cm4gY3R4Lmpzb24oW10pO1xuICAgICAgICAgIGNvbnN0IGNvb2tpZXMgPSBPYmplY3QuZnJvbUVudHJpZXMocGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikpO1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbnMgPSAoYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBPYmplY3QuZW50cmllcyhjb29raWVzKS5maWx0ZXIoKFtrZXldKSA9PiBpc011bHRpU2Vzc2lvbkNvb2tpZShrZXkpKS5tYXAoXG4gICAgICAgICAgICAgIGFzeW5jIChba2V5XSkgPT4gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShrZXksIGN0eC5jb250ZXh0LnNlY3JldClcbiAgICAgICAgICAgIClcbiAgICAgICAgICApKS5maWx0ZXIoKHYpID0+IHYgIT09IHZvaWQgMCk7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uVG9rZW5zLmxlbmd0aCkgcmV0dXJuIGN0eC5qc29uKFtdKTtcbiAgICAgICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbnMoc2Vzc2lvblRva2Vucyk7XG4gICAgICAgICAgY29uc3QgdmFsaWRTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcihcbiAgICAgICAgICAgIChzZXNzaW9uKSA9PiBzZXNzaW9uICYmIHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHZhbGlkU2Vzc2lvbnMpO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgc2V0QWN0aXZlU2Vzc2lvbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9tdWx0aS1zZXNzaW9uL3NldC1hY3RpdmVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgc2Vzc2lvblRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBzZXNzaW9uIHRva2VuIHRvIHNldCBhcyBhY3RpdmVcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICAgICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2V0IHRoZSBhY3RpdmUgc2Vzc2lvblwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvblRva2VuID0gY3R4LmJvZHkuc2Vzc2lvblRva2VuO1xuICAgICAgICAgIGNvbnN0IG11bHRpU2Vzc2lvbkNvb2tpZU5hbWUgPSBgJHtjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZX1fbXVsdGktJHtzZXNzaW9uVG9rZW59YDtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgIG11bHRpU2Vzc2lvbkNvb2tpZU5hbWUsXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghc2Vzc2lvbkNvb2tpZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9TRVNTSU9OX1RPS0VOXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbihzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgIGlmICghc2Vzc2lvbiB8fCBzZXNzaW9uLnNlc3Npb24uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgIGN0eC5zZXRDb29raWUobXVsdGlTZXNzaW9uQ29va2llTmFtZSwgXCJcIiwge1xuICAgICAgICAgICAgICAuLi5jdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ub3B0aW9ucyxcbiAgICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfU0VTU0lPTl9UT0tFTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCBzZXNzaW9uKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oc2Vzc2lvbik7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICByZXZva2VEZXZpY2VTZXNzaW9uOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL211bHRpLXNlc3Npb24vcmV2b2tlXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHNlc3Npb25Ub2tlbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgc2Vzc2lvbiB0b2tlbiB0byByZXZva2VcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICAgICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGEgZGV2aWNlIHNlc3Npb25cIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvblRva2VuID0gY3R4LmJvZHkuc2Vzc2lvblRva2VuO1xuICAgICAgICAgIGNvbnN0IG11bHRpU2Vzc2lvbkNvb2tpZU5hbWUgPSBgJHtjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZX1fbXVsdGktJHtzZXNzaW9uVG9rZW59YDtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgIG11bHRpU2Vzc2lvbkNvb2tpZU5hbWUsXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghc2Vzc2lvbkNvb2tpZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9TRVNTSU9OX1RPS0VOXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICBjdHguc2V0Q29va2llKG11bHRpU2Vzc2lvbkNvb2tpZU5hbWUsIFwiXCIsIHtcbiAgICAgICAgICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5vcHRpb25zLFxuICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgaXNBY3RpdmUgPSBjdHguY29udGV4dC5zZXNzaW9uPy5zZXNzaW9uLnRva2VuID09PSBzZXNzaW9uVG9rZW47XG4gICAgICAgICAgaWYgKCFpc0FjdGl2ZSkgcmV0dXJuIGN0eC5qc29uKHsgc3RhdHVzOiB0cnVlIH0pO1xuICAgICAgICAgIGNvbnN0IGNvb2tpZUhlYWRlciA9IGN0eC5oZWFkZXJzPy5nZXQoXCJjb29raWVcIik7XG4gICAgICAgICAgaWYgKGNvb2tpZUhlYWRlcikge1xuICAgICAgICAgICAgY29uc3QgY29va2llcyA9IE9iamVjdC5mcm9tRW50cmllcyhwYXJzZUNvb2tpZXMoY29va2llSGVhZGVyKSk7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uVG9rZW5zID0gKGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyhjb29raWVzKS5maWx0ZXIoKFtrZXldKSA9PiBpc011bHRpU2Vzc2lvbkNvb2tpZShrZXkpKS5tYXAoXG4gICAgICAgICAgICAgICAgYXN5bmMgKFtrZXldKSA9PiBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKGtleSwgY3R4LmNvbnRleHQuc2VjcmV0KVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApKS5maWx0ZXIoKHYpID0+IHYgIT09IHZvaWQgMCk7XG4gICAgICAgICAgICBjb25zdCBpbnRlcm5hbEFkYXB0ZXIgPSBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXI7XG4gICAgICAgICAgICBpZiAoc2Vzc2lvblRva2Vucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgaW50ZXJuYWxBZGFwdGVyLmZpbmRTZXNzaW9ucyhzZXNzaW9uVG9rZW5zKTtcbiAgICAgICAgICAgICAgY29uc3QgdmFsaWRTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcihcbiAgICAgICAgICAgICAgICAoc2Vzc2lvbikgPT4gc2Vzc2lvbiAmJiBzZXNzaW9uLnNlc3Npb24uZXhwaXJlc0F0ID4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgaWYgKHZhbGlkU2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRTZXNzaW9uID0gdmFsaWRTZXNzaW9uc1swXTtcbiAgICAgICAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwgbmV4dFNlc3Npb24pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyOiAoKSA9PiB0cnVlLFxuICAgICAgICAgIGhhbmRsZXI6IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBjdHguY29udGV4dC5yZXR1cm5lZCBpbnN0YW5jZW9mIEFQSUVycm9yID8gY3R4LmNvbnRleHQucmV0dXJuZWQuaGVhZGVycyA6IGN0eC5yZXNwb25zZUhlYWRlcjtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZVN0cmluZyA9IGhlYWRlcnMuZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICAgICAgICAgIGlmICghY29va2llU3RyaW5nKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBzZXRDb29raWVzID0gcGFyc2VTZXRDb29raWVIZWFkZXIoY29va2llU3RyaW5nKTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25Db29raWVDb25maWcgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW47XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBzZXRDb29raWVzLmdldChcbiAgICAgICAgICAgICAgc2Vzc2lvbkNvb2tpZUNvbmZpZy5uYW1lXG4gICAgICAgICAgICApPy52YWx1ZTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvblRva2VuKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBjb29raWVzID0gcGFyc2VDb29raWVzKGN0eC5oZWFkZXJzPy5nZXQoXCJjb29raWVcIikgfHwgXCJcIik7XG4gICAgICAgICAgICBjb25zdCByYXdTZXNzaW9uID0gc2Vzc2lvblRva2VuLnNwbGl0KFwiLlwiKVswXTtcbiAgICAgICAgICAgIGlmICghcmF3U2Vzc2lvbikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb29raWVOYW1lID0gYCR7c2Vzc2lvbkNvb2tpZUNvbmZpZy5uYW1lfV9tdWx0aS0ke3Jhd1Nlc3Npb259YDtcbiAgICAgICAgICAgIGlmIChzZXRDb29raWVzLmdldChjb29raWVOYW1lKSB8fCBjb29raWVzLmdldChjb29raWVOYW1lKSkgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudE11bHRpU2Vzc2lvbnMgPSBPYmplY3Qua2V5cyhPYmplY3QuZnJvbUVudHJpZXMoY29va2llcykpLmZpbHRlcihcbiAgICAgICAgICAgICAgaXNNdWx0aVNlc3Npb25Db29raWVcbiAgICAgICAgICAgICkubGVuZ3RoICsgKGNvb2tpZVN0cmluZy5pbmNsdWRlcyhcInNlc3Npb25fdG9rZW5cIikgPyAxIDogMCk7XG4gICAgICAgICAgICBpZiAoY3VycmVudE11bHRpU2Vzc2lvbnMgPiBvcHRzLm1heGltdW1TZXNzaW9ucykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgICAgICAgICAgICBjb29raWVOYW1lLFxuICAgICAgICAgICAgICByYXdTZXNzaW9uLFxuICAgICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICAgIHNlc3Npb25Db29raWVDb25maWcub3B0aW9uc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcjogKGNvbnRleHQpID0+IGNvbnRleHQucGF0aCA9PT0gXCIvc2lnbi1vdXRcIixcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb29raWVIZWFkZXIgPSBjdHguaGVhZGVycz8uZ2V0KFwiY29va2llXCIpO1xuICAgICAgICAgICAgaWYgKCFjb29raWVIZWFkZXIpIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZXMgPSBPYmplY3QuZnJvbUVudHJpZXMocGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikpO1xuICAgICAgICAgICAgY29uc3QgaWRzID0gT2JqZWN0LmtleXMoY29va2llcykubWFwKChrZXkpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGlzTXVsdGlTZXNzaW9uQ29va2llKGtleSkpIHtcbiAgICAgICAgICAgICAgICBjdHguc2V0Q29va2llKGtleSwgXCJcIiwgeyBtYXhBZ2U6IDAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSBrZXkuc3BsaXQoXCJfbXVsdGktXCIpWzFdO1xuICAgICAgICAgICAgICAgIHJldHVybiBpZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0pLmZpbHRlcigodikgPT4gdiAhPT0gbnVsbCk7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoaWRzKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSxcbiAgICAkRVJST1JfQ09ERVM6IEVSUk9SX0NPREVTXG4gIH07XG59O1xuXG5leHBvcnQgeyBtdWx0aVNlc3Npb24gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   jwt: () => (/* binding */ jwt)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/generate_key_pair.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/export.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n\n\n\n\n\n\nvar schema = {\n  jwks: {\n    fields: {\n      publicKey: {\n        type: \"string\",\n        required: true\n      },\n      privateKey: {\n        type: \"string\",\n        required: true\n      },\n      createdAt: {\n        type: \"date\",\n        required: true\n      }\n    }\n  }\n};\nzod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n  publicKey: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n  privateKey: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_3__.z.date()\n});\n\n// src/plugins/jwt/adapter.ts\nvar getJwksAdapter = (adapter) => {\n  return {\n    getAllKeys: async () => {\n      return await adapter.findMany({\n        model: \"jwks\"\n      });\n    },\n    getLatestKey: async () => {\n      const key = await adapter.findMany({\n        model: \"jwks\",\n        sortBy: {\n          field: \"createdAt\",\n          direction: \"desc\"\n        },\n        limit: 1\n      });\n      return key[0];\n    },\n    createJwk: async (webKey) => {\n      const jwk2 = await adapter.create({\n        model: \"jwks\",\n        data: {\n          ...webKey,\n          createdAt: /* @__PURE__ */ new Date()\n        }\n      });\n      return jwk2;\n    }\n  };\n};\nvar jwt = (options) => {\n  return {\n    id: \"jwt\",\n    endpoints: {\n      getJwks: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/jwks\",\n        {\n          method: \"GET\",\n          metadata: {\n            openapi: {\n              description: \"Get the JSON Web Key Set\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          keys: {\n                            type: \"array\",\n                            items: {\n                              type: \"object\",\n                              properties: {\n                                kid: {\n                                  type: \"string\"\n                                },\n                                kty: {\n                                  type: \"string\"\n                                },\n                                use: {\n                                  type: \"string\"\n                                },\n                                alg: {\n                                  type: \"string\"\n                                },\n                                n: {\n                                  type: \"string\"\n                                },\n                                e: {\n                                  type: \"string\"\n                                }\n                              }\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const adapter = getJwksAdapter(ctx.context.adapter);\n          const keySets = await adapter.getAllKeys();\n          if (keySets.length === 0) {\n            const alg = options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\";\n            const { publicKey, privateKey } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.generateKeyPair)(\n              alg,\n              options?.jwks?.keyPairConfig ?? {\n                crv: \"Ed25519\",\n                extractable: true\n              }\n            );\n            const publicWebKey = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(publicKey);\n            const privateWebKey = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(privateKey);\n            const stringifiedPrivateWebKey = JSON.stringify(privateWebKey);\n            const privateKeyEncryptionEnabled = !options?.jwks?.disablePrivateKeyEncryption;\n            let jwk2 = {\n              id: ctx.context.generateId({\n                model: \"jwks\"\n              }),\n              publicKey: JSON.stringify({ alg, ...publicWebKey }),\n              privateKey: privateKeyEncryptionEnabled ? JSON.stringify(\n                await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.symmetricEncrypt)({\n                  key: ctx.context.options.secret,\n                  data: stringifiedPrivateWebKey\n                })\n              ) : stringifiedPrivateWebKey,\n              createdAt: /* @__PURE__ */ new Date()\n            };\n            await adapter.createJwk(jwk2);\n            return ctx.json({\n              keys: [\n                {\n                  ...publicWebKey,\n                  alg,\n                  kid: jwk2.id\n                }\n              ]\n            });\n          }\n          return ctx.json({\n            keys: keySets.map((keySet) => ({\n              ...JSON.parse(keySet.publicKey),\n              kid: keySet.id\n            }))\n          });\n        }\n      ),\n      getToken: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/token\",\n        {\n          method: \"GET\",\n          requireHeaders: true,\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Get a JWT token\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          token: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const adapter = getJwksAdapter(ctx.context.adapter);\n          let key = await adapter.getLatestKey();\n          const privateKeyEncryptionEnabled = !options?.jwks?.disablePrivateKeyEncryption;\n          if (key === void 0) {\n            const { publicKey, privateKey: privateKey2 } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.generateKeyPair)(\n              options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\",\n              options?.jwks?.keyPairConfig ?? {\n                crv: \"Ed25519\",\n                extractable: true\n              }\n            );\n            const publicWebKey = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(publicKey);\n            const privateWebKey2 = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(privateKey2);\n            const stringifiedPrivateWebKey = JSON.stringify(privateWebKey2);\n            let jwk2 = {\n              id: ctx.context.generateId({\n                model: \"jwks\"\n              }),\n              publicKey: JSON.stringify(publicWebKey),\n              privateKey: privateKeyEncryptionEnabled ? JSON.stringify(\n                await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.symmetricEncrypt)({\n                  key: ctx.context.options.secret,\n                  data: stringifiedPrivateWebKey\n                })\n              ) : stringifiedPrivateWebKey,\n              createdAt: /* @__PURE__ */ new Date()\n            };\n            key = await adapter.createJwk(jwk2);\n          }\n          let privateWebKey = privateKeyEncryptionEnabled ? await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.symmetricDecrypt)({\n            key: ctx.context.options.secret,\n            data: JSON.parse(key.privateKey)\n          }) : key.privateKey;\n          const privateKey = await (0,jose__WEBPACK_IMPORTED_MODULE_6__.importJWK)(\n            JSON.parse(privateWebKey),\n            options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\"\n          );\n          const payload = !options?.jwt?.definePayload ? ctx.context.session.user : await options?.jwt.definePayload(ctx.context.session);\n          const jwt2 = await new jose__WEBPACK_IMPORTED_MODULE_7__.SignJWT({\n            ...payload,\n            // I am aware that this is not the best way to handle this, but this is the only way I know to get the impersonatedBy field\n            ...ctx.context.session.session.impersonatedBy ? {\n              impersonatedBy: ctx.context.session.session.impersonatedBy\n            } : {}\n          }).setProtectedHeader({\n            alg: options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\",\n            kid: key.id\n          }).setIssuedAt().setIssuer(options?.jwt?.issuer ?? ctx.context.options.baseURL).setAudience(options?.jwt?.audience ?? ctx.context.options.baseURL).setExpirationTime(options?.jwt?.expirationTime ?? \"15m\").setSubject(ctx.context.session.user.id).sign(privateKey);\n          return ctx.json({\n            token: jwt2\n          });\n        }\n      )\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_1__.mergeSchema)(schema, options?.schema)\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstN0xVN1BWUFAuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQTRFO0FBQzFCO0FBQ3VCO0FBQ2pEO0FBQzhDOztBQUV0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQVE7QUFDUixNQUFNLHlDQUFRO0FBQ2QsYUFBYSx5Q0FBUTtBQUNyQixjQUFjLHlDQUFRO0FBQ3RCLGFBQWEsdUNBQU07QUFDbkIsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxzRUFBa0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHdCQUF3QixRQUFRLHFEQUFlO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QywrQ0FBUztBQUNoRCx3Q0FBd0MsK0NBQVM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZiwwQ0FBMEMsc0JBQXNCO0FBQ2hFO0FBQ0Esc0JBQXNCLG9FQUFnQjtBQUN0QztBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWDtBQUNBO0FBQ0EsZ0JBQWdCLHNFQUFrQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpRUFBaUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixxQ0FBcUMsUUFBUSxxREFBZTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsK0NBQVM7QUFDaEQseUNBQXlDLCtDQUFTO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxzQkFBc0Isb0VBQWdCO0FBQ3RDO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxvRUFBZ0I7QUFDbEY7QUFDQTtBQUNBLFdBQVc7QUFDWCxtQ0FBbUMsK0NBQVM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMseUNBQU87QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2QsV0FBVztBQUNYO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVksK0RBQVc7QUFDdkI7QUFDQTs7QUFFZSIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTdMVTdQVlBQLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgc2Vzc2lvbk1pZGRsZXdhcmUgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IG1lcmdlU2NoZW1hIH0gZnJvbSAnLi9jaHVuay1XWjZPSVZKSy5qcyc7XG5pbXBvcnQgeyBzeW1tZXRyaWNFbmNyeXB0LCBzeW1tZXRyaWNEZWNyeXB0IH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IGdlbmVyYXRlS2V5UGFpciwgZXhwb3J0SldLLCBpbXBvcnRKV0ssIFNpZ25KV1QgfSBmcm9tICdqb3NlJztcblxudmFyIHNjaGVtYSA9IHtcbiAgandrczoge1xuICAgIGZpZWxkczoge1xuICAgICAgcHVibGljS2V5OiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICB9LFxuICAgICAgcHJpdmF0ZUtleToge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgfSxcbiAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG56Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLFxuICBwdWJsaWNLZXk6IHouc3RyaW5nKCksXG4gIHByaXZhdGVLZXk6IHouc3RyaW5nKCksXG4gIGNyZWF0ZWRBdDogei5kYXRlKClcbn0pO1xuXG4vLyBzcmMvcGx1Z2lucy9qd3QvYWRhcHRlci50c1xudmFyIGdldEp3a3NBZGFwdGVyID0gKGFkYXB0ZXIpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBnZXRBbGxLZXlzOiBhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImp3a3NcIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXRMYXRlc3RLZXk6IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJqd2tzXCIsXG4gICAgICAgIHNvcnRCeToge1xuICAgICAgICAgIGZpZWxkOiBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgIGRpcmVjdGlvbjogXCJkZXNjXCJcbiAgICAgICAgfSxcbiAgICAgICAgbGltaXQ6IDFcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGtleVswXTtcbiAgICB9LFxuICAgIGNyZWF0ZUp3azogYXN5bmMgKHdlYktleSkgPT4ge1xuICAgICAgY29uc3QgandrMiA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgbW9kZWw6IFwiandrc1wiLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgLi4ud2ViS2V5LFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gandrMjtcbiAgICB9XG4gIH07XG59O1xudmFyIGp3dCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiand0XCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBnZXRKd2tzOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2p3a3NcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIEpTT04gV2ViIEtleSBTZXRcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGt0eToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBhZGFwdGVyID0gZ2V0Sndrc0FkYXB0ZXIoY3R4LmNvbnRleHQuYWRhcHRlcik7XG4gICAgICAgICAgY29uc3Qga2V5U2V0cyA9IGF3YWl0IGFkYXB0ZXIuZ2V0QWxsS2V5cygpO1xuICAgICAgICAgIGlmIChrZXlTZXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgYWxnID0gb3B0aW9ucz8uandrcz8ua2V5UGFpckNvbmZpZz8uYWxnID8/IFwiRWREU0FcIjtcbiAgICAgICAgICAgIGNvbnN0IHsgcHVibGljS2V5LCBwcml2YXRlS2V5IH0gPSBhd2FpdCBnZW5lcmF0ZUtleVBhaXIoXG4gICAgICAgICAgICAgIGFsZyxcbiAgICAgICAgICAgICAgb3B0aW9ucz8uandrcz8ua2V5UGFpckNvbmZpZyA/PyB7XG4gICAgICAgICAgICAgICAgY3J2OiBcIkVkMjU1MTlcIixcbiAgICAgICAgICAgICAgICBleHRyYWN0YWJsZTogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgcHVibGljV2ViS2V5ID0gYXdhaXQgZXhwb3J0SldLKHB1YmxpY0tleSk7XG4gICAgICAgICAgICBjb25zdCBwcml2YXRlV2ViS2V5ID0gYXdhaXQgZXhwb3J0SldLKHByaXZhdGVLZXkpO1xuICAgICAgICAgICAgY29uc3Qgc3RyaW5naWZpZWRQcml2YXRlV2ViS2V5ID0gSlNPTi5zdHJpbmdpZnkocHJpdmF0ZVdlYktleSk7XG4gICAgICAgICAgICBjb25zdCBwcml2YXRlS2V5RW5jcnlwdGlvbkVuYWJsZWQgPSAhb3B0aW9ucz8uandrcz8uZGlzYWJsZVByaXZhdGVLZXlFbmNyeXB0aW9uO1xuICAgICAgICAgICAgbGV0IGp3azIgPSB7XG4gICAgICAgICAgICAgIGlkOiBjdHguY29udGV4dC5nZW5lcmF0ZUlkKHtcbiAgICAgICAgICAgICAgICBtb2RlbDogXCJqd2tzXCJcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIHB1YmxpY0tleTogSlNPTi5zdHJpbmdpZnkoeyBhbGcsIC4uLnB1YmxpY1dlYktleSB9KSxcbiAgICAgICAgICAgICAgcHJpdmF0ZUtleTogcHJpdmF0ZUtleUVuY3J5cHRpb25FbmFibGVkID8gSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgYXdhaXQgc3ltbWV0cmljRW5jcnlwdCh7XG4gICAgICAgICAgICAgICAgICBrZXk6IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2VjcmV0LFxuICAgICAgICAgICAgICAgICAgZGF0YTogc3RyaW5naWZpZWRQcml2YXRlV2ViS2V5XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgKSA6IHN0cmluZ2lmaWVkUHJpdmF0ZVdlYktleSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGF3YWl0IGFkYXB0ZXIuY3JlYXRlSndrKGp3azIpO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAga2V5czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIC4uLnB1YmxpY1dlYktleSxcbiAgICAgICAgICAgICAgICAgIGFsZyxcbiAgICAgICAgICAgICAgICAgIGtpZDogandrMi5pZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBrZXlzOiBrZXlTZXRzLm1hcCgoa2V5U2V0KSA9PiAoe1xuICAgICAgICAgICAgICAuLi5KU09OLnBhcnNlKGtleVNldC5wdWJsaWNLZXkpLFxuICAgICAgICAgICAgICBraWQ6IGtleVNldC5pZFxuICAgICAgICAgICAgfSkpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBnZXRUb2tlbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi90b2tlblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgYSBKV1QgdG9rZW5cIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRKd2tzQWRhcHRlcihjdHguY29udGV4dC5hZGFwdGVyKTtcbiAgICAgICAgICBsZXQga2V5ID0gYXdhaXQgYWRhcHRlci5nZXRMYXRlc3RLZXkoKTtcbiAgICAgICAgICBjb25zdCBwcml2YXRlS2V5RW5jcnlwdGlvbkVuYWJsZWQgPSAhb3B0aW9ucz8uandrcz8uZGlzYWJsZVByaXZhdGVLZXlFbmNyeXB0aW9uO1xuICAgICAgICAgIGlmIChrZXkgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgY29uc3QgeyBwdWJsaWNLZXksIHByaXZhdGVLZXk6IHByaXZhdGVLZXkyIH0gPSBhd2FpdCBnZW5lcmF0ZUtleVBhaXIoXG4gICAgICAgICAgICAgIG9wdGlvbnM/Lmp3a3M/LmtleVBhaXJDb25maWc/LmFsZyA/PyBcIkVkRFNBXCIsXG4gICAgICAgICAgICAgIG9wdGlvbnM/Lmp3a3M/LmtleVBhaXJDb25maWcgPz8ge1xuICAgICAgICAgICAgICAgIGNydjogXCJFZDI1NTE5XCIsXG4gICAgICAgICAgICAgICAgZXh0cmFjdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHB1YmxpY1dlYktleSA9IGF3YWl0IGV4cG9ydEpXSyhwdWJsaWNLZXkpO1xuICAgICAgICAgICAgY29uc3QgcHJpdmF0ZVdlYktleTIgPSBhd2FpdCBleHBvcnRKV0socHJpdmF0ZUtleTIpO1xuICAgICAgICAgICAgY29uc3Qgc3RyaW5naWZpZWRQcml2YXRlV2ViS2V5ID0gSlNPTi5zdHJpbmdpZnkocHJpdmF0ZVdlYktleTIpO1xuICAgICAgICAgICAgbGV0IGp3azIgPSB7XG4gICAgICAgICAgICAgIGlkOiBjdHguY29udGV4dC5nZW5lcmF0ZUlkKHtcbiAgICAgICAgICAgICAgICBtb2RlbDogXCJqd2tzXCJcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIHB1YmxpY0tleTogSlNPTi5zdHJpbmdpZnkocHVibGljV2ViS2V5KSxcbiAgICAgICAgICAgICAgcHJpdmF0ZUtleTogcHJpdmF0ZUtleUVuY3J5cHRpb25FbmFibGVkID8gSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgYXdhaXQgc3ltbWV0cmljRW5jcnlwdCh7XG4gICAgICAgICAgICAgICAgICBrZXk6IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2VjcmV0LFxuICAgICAgICAgICAgICAgICAgZGF0YTogc3RyaW5naWZpZWRQcml2YXRlV2ViS2V5XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgKSA6IHN0cmluZ2lmaWVkUHJpdmF0ZVdlYktleSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGtleSA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlSndrKGp3azIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgcHJpdmF0ZVdlYktleSA9IHByaXZhdGVLZXlFbmNyeXB0aW9uRW5hYmxlZCA/IGF3YWl0IHN5bW1ldHJpY0RlY3J5cHQoe1xuICAgICAgICAgICAga2V5OiBjdHguY29udGV4dC5vcHRpb25zLnNlY3JldCxcbiAgICAgICAgICAgIGRhdGE6IEpTT04ucGFyc2Uoa2V5LnByaXZhdGVLZXkpXG4gICAgICAgICAgfSkgOiBrZXkucHJpdmF0ZUtleTtcbiAgICAgICAgICBjb25zdCBwcml2YXRlS2V5ID0gYXdhaXQgaW1wb3J0SldLKFxuICAgICAgICAgICAgSlNPTi5wYXJzZShwcml2YXRlV2ViS2V5KSxcbiAgICAgICAgICAgIG9wdGlvbnM/Lmp3a3M/LmtleVBhaXJDb25maWc/LmFsZyA/PyBcIkVkRFNBXCJcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSAhb3B0aW9ucz8uand0Py5kZWZpbmVQYXlsb2FkID8gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyIDogYXdhaXQgb3B0aW9ucz8uand0LmRlZmluZVBheWxvYWQoY3R4LmNvbnRleHQuc2Vzc2lvbik7XG4gICAgICAgICAgY29uc3Qgand0MiA9IGF3YWl0IG5ldyBTaWduSldUKHtcbiAgICAgICAgICAgIC4uLnBheWxvYWQsXG4gICAgICAgICAgICAvLyBJIGFtIGF3YXJlIHRoYXQgdGhpcyBpcyBub3QgdGhlIGJlc3Qgd2F5IHRvIGhhbmRsZSB0aGlzLCBidXQgdGhpcyBpcyB0aGUgb25seSB3YXkgSSBrbm93IHRvIGdldCB0aGUgaW1wZXJzb25hdGVkQnkgZmllbGRcbiAgICAgICAgICAgIC4uLmN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi5pbXBlcnNvbmF0ZWRCeSA/IHtcbiAgICAgICAgICAgICAgaW1wZXJzb25hdGVkQnk6IGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi5pbXBlcnNvbmF0ZWRCeVxuICAgICAgICAgICAgfSA6IHt9XG4gICAgICAgICAgfSkuc2V0UHJvdGVjdGVkSGVhZGVyKHtcbiAgICAgICAgICAgIGFsZzogb3B0aW9ucz8uandrcz8ua2V5UGFpckNvbmZpZz8uYWxnID8/IFwiRWREU0FcIixcbiAgICAgICAgICAgIGtpZDoga2V5LmlkXG4gICAgICAgICAgfSkuc2V0SXNzdWVkQXQoKS5zZXRJc3N1ZXIob3B0aW9ucz8uand0Py5pc3N1ZXIgPz8gY3R4LmNvbnRleHQub3B0aW9ucy5iYXNlVVJMKS5zZXRBdWRpZW5jZShvcHRpb25zPy5qd3Q/LmF1ZGllbmNlID8/IGN0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTCkuc2V0RXhwaXJhdGlvblRpbWUob3B0aW9ucz8uand0Py5leHBpcmF0aW9uVGltZSA/PyBcIjE1bVwiKS5zZXRTdWJqZWN0KGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCkuc2lnbihwcml2YXRlS2V5KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdG9rZW46IGp3dDJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgc2NoZW1hOiBtZXJnZVNjaGVtYShzY2hlbWEsIG9wdGlvbnM/LnNjaGVtYSlcbiAgfTtcbn07XG5cbmV4cG9ydCB7IGp3dCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   oneTap: () => (/* binding */ oneTap)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwks/remote.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n\n\n\n\n\n// src/utils/boolean.ts\nfunction toBoolean(value) {\n  return value === \"true\" || value === true;\n}\n\n// src/plugins/one-tap/index.ts\nvar oneTap = (options) => ({\n  id: \"one-tap\",\n  endpoints: {\n    oneTapCallback: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n      \"/one-tap/callback\",\n      {\n        method: \"POST\",\n        body: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n          idToken: zod__WEBPACK_IMPORTED_MODULE_2__.z.string({\n            description: \"Google ID token, which the client obtains from the One Tap API\"\n          })\n        }),\n        metadata: {\n          openapi: {\n            summary: \"One tap callback\",\n            description: \"Use this endpoint to authenticate with Google One Tap\",\n            responses: {\n              200: {\n                description: \"Successful response\",\n                content: {\n                  \"application/json\": {\n                    schema: {\n                      type: \"object\",\n                      properties: {\n                        session: {\n                          $ref: \"#/components/schemas/Session\"\n                        },\n                        user: {\n                          $ref: \"#/components/schemas/User\"\n                        }\n                      }\n                    }\n                  }\n                }\n              },\n              400: {\n                description: \"Invalid token\"\n              }\n            }\n          }\n        }\n      },\n      async (ctx) => {\n        const { idToken } = ctx.body;\n        let payload;\n        try {\n          const JWKS = (0,jose__WEBPACK_IMPORTED_MODULE_3__.createRemoteJWKSet)(\n            new URL(\"https://www.googleapis.com/oauth2/v3/certs\")\n          );\n          const { payload: verifiedPayload } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.jwtVerify)(\n            idToken,\n            JWKS,\n            {\n              issuer: [\"https://accounts.google.com\", \"accounts.google.com\"],\n              audience: options?.clientId || ctx.context.options.socialProviders?.google?.clientId\n            }\n          );\n          payload = verifiedPayload;\n        } catch (error) {\n          throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n            message: \"invalid id token\"\n          });\n        }\n        const { email, email_verified, name, picture, sub } = payload;\n        if (!email) {\n          return ctx.json({ error: \"Email not available in token\" });\n        }\n        const user = await ctx.context.internalAdapter.findUserByEmail(email);\n        if (!user) {\n          if (options?.disableSignup) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_GATEWAY\", {\n              message: \"User not found\"\n            });\n          }\n          const newUser = await ctx.context.internalAdapter.createOAuthUser(\n            {\n              email,\n              emailVerified: typeof email_verified === \"boolean\" ? email_verified : toBoolean(email_verified),\n              name,\n              image: picture\n            },\n            {\n              providerId: \"google\",\n              accountId: sub\n            }\n          );\n          if (!newUser) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Could not create user\"\n            });\n          }\n          const session2 = await ctx.context.internalAdapter.createSession(\n            newUser.user.id,\n            ctx.request\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n            user: newUser.user,\n            session: session2\n          });\n          return ctx.json({\n            token: session2.token,\n            user: {\n              id: newUser.user.id,\n              email: newUser.user.email,\n              emailVerified: newUser.user.emailVerified,\n              name: newUser.user.name,\n              image: newUser.user.image,\n              createdAt: newUser.user.createdAt,\n              updatedAt: newUser.user.updatedAt\n            }\n          });\n        }\n        const account = await ctx.context.internalAdapter.findAccount(sub);\n        if (!account) {\n          throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n            message: \"Google sub doesn't match\"\n          });\n        }\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx.request\n        );\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n          user: user.user,\n          session\n        });\n        return ctx.json({\n          token: session.token,\n          user: {\n            id: user.user.id,\n            email: user.user.email,\n            emailVerified: user.user.emailVerified,\n            name: user.user.name,\n            image: user.user.image,\n            createdAt: user.user.createdAt,\n            updatedAt: user.user.updatedAt\n          }\n        });\n      }\n    )\n  }\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstQVZBQURQR0IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQW1FO0FBQ1o7QUFDL0I7QUFDNkI7O0FBRXJEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHNFQUFrQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxjQUFjLHlDQUFRO0FBQ3RCLG1CQUFtQix5Q0FBUTtBQUMzQjtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0EsdUJBQXVCLHdEQUFrQjtBQUN6QztBQUNBO0FBQ0Esa0JBQWtCLDJCQUEyQixRQUFRLCtDQUFTO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Ysb0JBQW9CLHdEQUFRO0FBQzVCO0FBQ0EsV0FBVztBQUNYO0FBQ0EsZ0JBQWdCLDRDQUE0QztBQUM1RDtBQUNBLDRCQUE0Qix1Q0FBdUM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isb0VBQWdCO0FBQ2hDO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0RBQVE7QUFDNUI7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsb0VBQWdCO0FBQzlCO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVpQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUFWQUFEUEdCLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgQVBJRXJyb3IgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgY3JlYXRlUmVtb3RlSldLU2V0LCBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJztcblxuLy8gc3JjL3V0aWxzL2Jvb2xlYW4udHNcbmZ1bmN0aW9uIHRvQm9vbGVhbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgPT09IFwidHJ1ZVwiIHx8IHZhbHVlID09PSB0cnVlO1xufVxuXG4vLyBzcmMvcGx1Z2lucy9vbmUtdGFwL2luZGV4LnRzXG52YXIgb25lVGFwID0gKG9wdGlvbnMpID0+ICh7XG4gIGlkOiBcIm9uZS10YXBcIixcbiAgZW5kcG9pbnRzOiB7XG4gICAgb25lVGFwQ2FsbGJhY2s6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgIFwiL29uZS10YXAvY2FsbGJhY2tcIixcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgIGlkVG9rZW46IHouc3RyaW5nKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkdvb2dsZSBJRCB0b2tlbiwgd2hpY2ggdGhlIGNsaWVudCBvYnRhaW5zIGZyb20gdGhlIE9uZSBUYXAgQVBJXCJcbiAgICAgICAgICB9KVxuICAgICAgICB9KSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICBzdW1tYXJ5OiBcIk9uZSB0YXAgY2FsbGJhY2tcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZSB0aGlzIGVuZHBvaW50IHRvIGF1dGhlbnRpY2F0ZSB3aXRoIEdvb2dsZSBPbmUgVGFwXCIsXG4gICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc2Z1bCByZXNwb25zZVwiLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIDQwMDoge1xuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkludmFsaWQgdG9rZW5cIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICBjb25zdCB7IGlkVG9rZW4gfSA9IGN0eC5ib2R5O1xuICAgICAgICBsZXQgcGF5bG9hZDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBKV0tTID0gY3JlYXRlUmVtb3RlSldLU2V0KFxuICAgICAgICAgICAgbmV3IFVSTChcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92My9jZXJ0c1wiKVxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgeyBwYXlsb2FkOiB2ZXJpZmllZFBheWxvYWQgfSA9IGF3YWl0IGp3dFZlcmlmeShcbiAgICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgICBKV0tTLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpc3N1ZXI6IFtcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbVwiLCBcImFjY291bnRzLmdvb2dsZS5jb21cIl0sXG4gICAgICAgICAgICAgIGF1ZGllbmNlOiBvcHRpb25zPy5jbGllbnRJZCB8fCBjdHguY29udGV4dC5vcHRpb25zLnNvY2lhbFByb3ZpZGVycz8uZ29vZ2xlPy5jbGllbnRJZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgcGF5bG9hZCA9IHZlcmlmaWVkUGF5bG9hZDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICBtZXNzYWdlOiBcImludmFsaWQgaWQgdG9rZW5cIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgZW1haWwsIGVtYWlsX3ZlcmlmaWVkLCBuYW1lLCBwaWN0dXJlLCBzdWIgfSA9IHBheWxvYWQ7XG4gICAgICAgIGlmICghZW1haWwpIHtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oeyBlcnJvcjogXCJFbWFpbCBub3QgYXZhaWxhYmxlIGluIHRva2VuXCIgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICBpZiAob3B0aW9ucz8uZGlzYWJsZVNpZ251cCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX0dBVEVXQVlcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIlVzZXIgbm90IGZvdW5kXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBuZXdVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZU9BdXRoVXNlcihcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHR5cGVvZiBlbWFpbF92ZXJpZmllZCA9PT0gXCJib29sZWFuXCIgPyBlbWFpbF92ZXJpZmllZCA6IHRvQm9vbGVhbihlbWFpbF92ZXJpZmllZCksXG4gICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgIGltYWdlOiBwaWN0dXJlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBwcm92aWRlcklkOiBcImdvb2dsZVwiLFxuICAgICAgICAgICAgICBhY2NvdW50SWQ6IHN1YlxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFuZXdVc2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkNvdWxkIG5vdCBjcmVhdGUgdXNlclwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbjIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgIG5ld1VzZXIudXNlci5pZCxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgdXNlcjogbmV3VXNlci51c2VyLFxuICAgICAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbjJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdG9rZW46IHNlc3Npb24yLnRva2VuLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogbmV3VXNlci51c2VyLmlkLFxuICAgICAgICAgICAgICBlbWFpbDogbmV3VXNlci51c2VyLmVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBuZXdVc2VyLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogbmV3VXNlci51c2VyLm5hbWUsXG4gICAgICAgICAgICAgIGltYWdlOiBuZXdVc2VyLnVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3VXNlci51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXdVc2VyLnVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudChzdWIpO1xuICAgICAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgbWVzc2FnZTogXCJHb29nbGUgc3ViIGRvZXNuJ3QgbWF0Y2hcIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICB1c2VyLnVzZXIuaWQsXG4gICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICB1c2VyOiB1c2VyLnVzZXIsXG4gICAgICAgICAgc2Vzc2lvblxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogdXNlci51c2VyLmlkLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIudXNlci5lbWFpbCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIudXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgbmFtZTogdXNlci51c2VyLm5hbWUsXG4gICAgICAgICAgICBpbWFnZTogdXNlci51c2VyLmltYWdlLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICApXG4gIH1cbn0pO1xuXG5leHBvcnQgeyBvbmVUYXAgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compareHash: () => (/* binding */ compareHash),\n/* harmony export */   constantTimeEqual: () => (/* binding */ constantTimeEqual),\n/* harmony export */   generateRandomString: () => (/* binding */ generateRandomString),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   hashToBase64: () => (/* binding */ hashToBase64),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   symmetricDecrypt: () => (/* binding */ symmetricDecrypt),\n/* harmony export */   symmetricEncrypt: () => (/* binding */ symmetricEncrypt),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/ciphers/chacha */ \"(action-browser)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @noble/ciphers/utils */ \"(action-browser)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/utils.js\");\n/* harmony import */ var _noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @noble/ciphers/webcrypto */ \"(action-browser)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/webcrypto.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var _noble_hashes_scrypt__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @noble/hashes/scrypt */ \"(action-browser)/./node_modules/.pnpm/@noble+hashes@1.7.1/node_modules/@noble/hashes/esm/scrypt.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/random */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n\n\n\n\n\n\n\n\n// src/crypto/index.ts\n\n// src/crypto/buffer.ts\nfunction constantTimeEqual(a, b) {\n  const aBuffer = new Uint8Array(a);\n  const bBuffer = new Uint8Array(b);\n  if (aBuffer.length !== bBuffer.length) {\n    return false;\n  }\n  let c = 0;\n  for (let i = 0; i < aBuffer.length; i++) {\n    c |= aBuffer[i] ^ bBuffer[i];\n  }\n  return c === 0;\n}\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(data);\n  return Buffer.from(buffer).toString(\"base64\");\n}\nasync function compareHash(data, hash) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(\n    typeof data === \"string\" ? new TextEncoder().encode(data) : data\n  );\n  const hashBuffer = Buffer.from(hash, \"base64\");\n  return constantTimeEqual(buffer, hashBuffer);\n}\nasync function signJWT(payload, secret, expiresIn = 3600) {\n  const jwt = await new jose__WEBPACK_IMPORTED_MODULE_4__.SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n  return jwt;\n}\nvar config = {\n  N: 16384,\n  r: 16,\n  p: 1,\n  dkLen: 64\n};\nasync function generateKey(password, salt) {\n  return await (0,_noble_hashes_scrypt__WEBPACK_IMPORTED_MODULE_5__.scryptAsync)(password.normalize(\"NFKC\"), salt, {\n    N: config.N,\n    p: config.p,\n    r: config.r,\n    dkLen: config.dkLen,\n    maxmem: 128 * config.N * config.r * 2\n  });\n}\nvar hashPassword = async (password) => {\n  const salt = _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode((0,_better_auth_utils__WEBPACK_IMPORTED_MODULE_1__.getRandomValues)(new Uint8Array(16)));\n  const key = await generateKey(password, salt);\n  return `${salt}:${_better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(key)}`;\n};\nvar verifyPassword = async ({\n  hash,\n  password\n}) => {\n  const [salt, key] = hash.split(\":\");\n  const targetKey = await generateKey(password, salt);\n  return constantTimeEqual(targetKey, new Uint8Array(Buffer.from(key, \"hex\")));\n};\nvar generateRandomString = (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__.createRandomStringGenerator)(\n  \"a-z\",\n  \"0-9\",\n  \"A-Z\",\n  \"-_\"\n);\n\n// src/crypto/index.ts\nvar symmetricEncrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.utf8ToBytes)(data);\n  const chacha = (0,_noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__.managedNonce)(_noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.bytesToHex)(chacha.encrypt(dataAsBytes));\n};\nvar symmetricDecrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.hexToBytes)(data);\n  const chacha = (0,_noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__.managedNonce)(_noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstREJQT1pSTVMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXFEO0FBQ0s7QUFDaUI7QUFDbkI7QUFDekI7QUFDb0I7QUFDRTtBQUNSO0FBQzJCOztBQUV4RTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG9CQUFvQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixtRUFBVTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUNBQU8sK0JBQStCLGNBQWM7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxpRUFBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxlQUFlLHVEQUFHLFFBQVEsbUVBQWU7QUFDekM7QUFDQSxZQUFZLEtBQUssR0FBRyx1REFBRyxhQUFhO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHNGQUEyQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDJCQUEyQixtRUFBVTtBQUNyQyxzQkFBc0IsaUVBQVc7QUFDakMsaUJBQWlCLHNFQUFZLENBQUMsb0VBQWlCO0FBQy9DLFNBQVMsZ0VBQVU7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMkJBQTJCLG1FQUFVO0FBQ3JDLHNCQUFzQixnRUFBVTtBQUNoQyxpQkFBaUIsc0VBQVksQ0FBQyxvRUFBaUI7QUFDL0M7QUFDQTs7QUFFeUoiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1EQlBPWlJNUy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0IHsgeGNoYWNoYTIwcG9seTEzMDUgfSBmcm9tICdAbm9ibGUvY2lwaGVycy9jaGFjaGEnO1xuaW1wb3J0IHsgdXRmOFRvQnl0ZXMsIGJ5dGVzVG9IZXgsIGhleFRvQnl0ZXMgfSBmcm9tICdAbm9ibGUvY2lwaGVycy91dGlscyc7XG5pbXBvcnQgeyBtYW5hZ2VkTm9uY2UgfSBmcm9tICdAbm9ibGUvY2lwaGVycy93ZWJjcnlwdG8nO1xuaW1wb3J0IHsgU2lnbkpXVCB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0IHsgc2NyeXB0QXN5bmMgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3NjcnlwdCc7XG5pbXBvcnQgeyBnZXRSYW5kb21WYWx1ZXMgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMnO1xuaW1wb3J0IHsgaGV4IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgeyBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcblxuLy8gc3JjL2NyeXB0by9pbmRleC50c1xuXG4vLyBzcmMvY3J5cHRvL2J1ZmZlci50c1xuZnVuY3Rpb24gY29uc3RhbnRUaW1lRXF1YWwoYSwgYikge1xuICBjb25zdCBhQnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYSk7XG4gIGNvbnN0IGJCdWZmZXIgPSBuZXcgVWludDhBcnJheShiKTtcbiAgaWYgKGFCdWZmZXIubGVuZ3RoICE9PSBiQnVmZmVyLmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBsZXQgYyA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYUJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgIGMgfD0gYUJ1ZmZlcltpXSBeIGJCdWZmZXJbaV07XG4gIH1cbiAgcmV0dXJuIGMgPT09IDA7XG59XG5hc3luYyBmdW5jdGlvbiBoYXNoVG9CYXNlNjQoZGF0YSkge1xuICBjb25zdCBidWZmZXIgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3QoZGF0YSk7XG4gIHJldHVybiBCdWZmZXIuZnJvbShidWZmZXIpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xufVxuYXN5bmMgZnVuY3Rpb24gY29tcGFyZUhhc2goZGF0YSwgaGFzaCkge1xuICBjb25zdCBidWZmZXIgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3QoXG4gICAgdHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIgPyBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoZGF0YSkgOiBkYXRhXG4gICk7XG4gIGNvbnN0IGhhc2hCdWZmZXIgPSBCdWZmZXIuZnJvbShoYXNoLCBcImJhc2U2NFwiKTtcbiAgcmV0dXJuIGNvbnN0YW50VGltZUVxdWFsKGJ1ZmZlciwgaGFzaEJ1ZmZlcik7XG59XG5hc3luYyBmdW5jdGlvbiBzaWduSldUKHBheWxvYWQsIHNlY3JldCwgZXhwaXJlc0luID0gMzYwMCkge1xuICBjb25zdCBqd3QgPSBhd2FpdCBuZXcgU2lnbkpXVChwYXlsb2FkKS5zZXRQcm90ZWN0ZWRIZWFkZXIoeyBhbGc6IFwiSFMyNTZcIiB9KS5zZXRJc3N1ZWRBdCgpLnNldEV4cGlyYXRpb25UaW1lKE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDFlMykgKyBleHBpcmVzSW4pLnNpZ24obmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlY3JldCkpO1xuICByZXR1cm4gand0O1xufVxudmFyIGNvbmZpZyA9IHtcbiAgTjogMTYzODQsXG4gIHI6IDE2LFxuICBwOiAxLFxuICBka0xlbjogNjRcbn07XG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCkge1xuICByZXR1cm4gYXdhaXQgc2NyeXB0QXN5bmMocGFzc3dvcmQubm9ybWFsaXplKFwiTkZLQ1wiKSwgc2FsdCwge1xuICAgIE46IGNvbmZpZy5OLFxuICAgIHA6IGNvbmZpZy5wLFxuICAgIHI6IGNvbmZpZy5yLFxuICAgIGRrTGVuOiBjb25maWcuZGtMZW4sXG4gICAgbWF4bWVtOiAxMjggKiBjb25maWcuTiAqIGNvbmZpZy5yICogMlxuICB9KTtcbn1cbnZhciBoYXNoUGFzc3dvcmQgPSBhc3luYyAocGFzc3dvcmQpID0+IHtcbiAgY29uc3Qgc2FsdCA9IGhleC5lbmNvZGUoZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDE2KSkpO1xuICBjb25zdCBrZXkgPSBhd2FpdCBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCk7XG4gIHJldHVybiBgJHtzYWx0fToke2hleC5lbmNvZGUoa2V5KX1gO1xufTtcbnZhciB2ZXJpZnlQYXNzd29yZCA9IGFzeW5jICh7XG4gIGhhc2gsXG4gIHBhc3N3b3JkXG59KSA9PiB7XG4gIGNvbnN0IFtzYWx0LCBrZXldID0gaGFzaC5zcGxpdChcIjpcIik7XG4gIGNvbnN0IHRhcmdldEtleSA9IGF3YWl0IGdlbmVyYXRlS2V5KHBhc3N3b3JkLCBzYWx0KTtcbiAgcmV0dXJuIGNvbnN0YW50VGltZUVxdWFsKHRhcmdldEtleSwgbmV3IFVpbnQ4QXJyYXkoQnVmZmVyLmZyb20oa2V5LCBcImhleFwiKSkpO1xufTtcbnZhciBnZW5lcmF0ZVJhbmRvbVN0cmluZyA9IGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvcihcbiAgXCJhLXpcIixcbiAgXCIwLTlcIixcbiAgXCJBLVpcIixcbiAgXCItX1wiXG4pO1xuXG4vLyBzcmMvY3J5cHRvL2luZGV4LnRzXG52YXIgc3ltbWV0cmljRW5jcnlwdCA9IGFzeW5jICh7XG4gIGtleSxcbiAgZGF0YVxufSkgPT4ge1xuICBjb25zdCBrZXlBc0J5dGVzID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGtleSk7XG4gIGNvbnN0IGRhdGFBc0J5dGVzID0gdXRmOFRvQnl0ZXMoZGF0YSk7XG4gIGNvbnN0IGNoYWNoYSA9IG1hbmFnZWROb25jZSh4Y2hhY2hhMjBwb2x5MTMwNSkobmV3IFVpbnQ4QXJyYXkoa2V5QXNCeXRlcykpO1xuICByZXR1cm4gYnl0ZXNUb0hleChjaGFjaGEuZW5jcnlwdChkYXRhQXNCeXRlcykpO1xufTtcbnZhciBzeW1tZXRyaWNEZWNyeXB0ID0gYXN5bmMgKHtcbiAga2V5LFxuICBkYXRhXG59KSA9PiB7XG4gIGNvbnN0IGtleUFzQnl0ZXMgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3Qoa2V5KTtcbiAgY29uc3QgZGF0YUFzQnl0ZXMgPSBoZXhUb0J5dGVzKGRhdGEpO1xuICBjb25zdCBjaGFjaGEgPSBtYW5hZ2VkTm9uY2UoeGNoYWNoYTIwcG9seTEzMDUpKG5ldyBVaW50OEFycmF5KGtleUFzQnl0ZXMpKTtcbiAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShjaGFjaGEuZGVjcnlwdChkYXRhQXNCeXRlcykpO1xufTtcblxuZXhwb3J0IHsgY29tcGFyZUhhc2gsIGNvbnN0YW50VGltZUVxdWFsLCBnZW5lcmF0ZVJhbmRvbVN0cmluZywgaGFzaFBhc3N3b3JkLCBoYXNoVG9CYXNlNjQsIHNpZ25KV1QsIHN5bW1ldHJpY0RlY3J5cHQsIHN5bW1ldHJpY0VuY3J5cHQsIHZlcmlmeVBhc3N3b3JkIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   customSession: () => (/* binding */ customSession)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\nvar customSession = (fn, options) => {\n  return {\n    id: \"custom-session\",\n    endpoints: {\n      getSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/get-session\",\n        {\n          method: \"GET\",\n          metadata: {\n            CUSTOM_SESSION: true\n          },\n          query: zod__WEBPACK_IMPORTED_MODULE_1__.z.optional(\n            zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n              /**\n               * If cookie cache is enabled, it will disable the cache\n               * and fetch the session from the database\n               */\n              disableCookieCache: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean({\n                description: \"Disable cookie cache and fetch session from database\"\n              }).or(zod__WEBPACK_IMPORTED_MODULE_1__.z.string().transform((v) => v === \"true\")).optional(),\n              disableRefresh: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean({\n                description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n              }).optional()\n            })\n          )\n        },\n        async (ctx) => {\n          const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n          if (!session) {\n            return ctx.json(null);\n          }\n          const fnResult = await fn(session);\n          return ctx.json(fnResult);\n        }\n      )\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstRlIzQllBNDcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRFO0FBQ3BEOztBQUV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixzRUFBa0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxpQkFBaUIsMkNBQVU7QUFDM0IsWUFBWSx5Q0FBUTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywwQ0FBUztBQUMzQztBQUNBLGVBQWUsS0FBSyx5Q0FBUTtBQUM1Qiw4QkFBOEIsMENBQVM7QUFDdkM7QUFDQSxlQUFlO0FBQ2YsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0EsZ0NBQWdDLHFFQUFpQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFeUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1GUjNCWUE0Ny5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIGdldFNlc3Npb25Gcm9tQ3R4IH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxudmFyIGN1c3RvbVNlc3Npb24gPSAoZm4sIG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJjdXN0b20tc2Vzc2lvblwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgZ2V0U2Vzc2lvbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9nZXQtc2Vzc2lvblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBDVVNUT01fU0VTU0lPTjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVlcnk6IHoub3B0aW9uYWwoXG4gICAgICAgICAgICB6Lm9iamVjdCh7XG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBJZiBjb29raWUgY2FjaGUgaXMgZW5hYmxlZCwgaXQgd2lsbCBkaXNhYmxlIHRoZSBjYWNoZVxuICAgICAgICAgICAgICAgKiBhbmQgZmV0Y2ggdGhlIHNlc3Npb24gZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIGRpc2FibGVDb29raWVDYWNoZTogei5ib29sZWFuKHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIGNvb2tpZSBjYWNoZSBhbmQgZmV0Y2ggc2Vzc2lvbiBmcm9tIGRhdGFiYXNlXCJcbiAgICAgICAgICAgICAgfSkub3Ioei5zdHJpbmcoKS50cmFuc2Zvcm0oKHYpID0+IHYgPT09IFwidHJ1ZVwiKSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgICAgZGlzYWJsZVJlZnJlc2g6IHouYm9vbGVhbih7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBzZXNzaW9uIHJlZnJlc2guIFVzZWZ1bCBmb3IgY2hlY2tpbmcgc2Vzc2lvbiBzdGF0dXMsIHdpdGhvdXQgdXBkYXRpbmcgdGhlIHNlc3Npb25cIlxuICAgICAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIClcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBmblJlc3VsdCA9IGF3YWl0IGZuKHNlc3Npb24pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihmblJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgeyBjdXN0b21TZXNzaW9uIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDate: () => (/* binding */ getDate)\n/* harmony export */ });\n// src/utils/date.ts\nvar getDate = (span, unit = \"ms\") => {\n  return new Date(Date.now() + (unit === \"sec\" ? span * 1e3 : span));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstRlVSTkE2SFkuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVtQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUZVUk5BNkhZLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy91dGlscy9kYXRlLnRzXG52YXIgZ2V0RGF0ZSA9IChzcGFuLCB1bml0ID0gXCJtc1wiKSA9PiB7XG4gIHJldHVybiBuZXcgRGF0ZShEYXRlLm5vdygpICsgKHVuaXQgPT09IFwic2VjXCIgPyBzcGFuICogMWUzIDogc3BhbikpO1xufTtcblxuZXhwb3J0IHsgZ2V0RGF0ZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminAc: () => (/* binding */ adminAc),\n/* harmony export */   createAccessControl: () => (/* binding */ createAccessControl),\n/* harmony export */   defaultAc: () => (/* binding */ defaultAc),\n/* harmony export */   defaultRoles: () => (/* binding */ defaultRoles),\n/* harmony export */   defaultStatements: () => (/* binding */ defaultStatements),\n/* harmony export */   memberAc: () => (/* binding */ memberAc),\n/* harmony export */   ownerAc: () => (/* binding */ ownerAc),\n/* harmony export */   role: () => (/* binding */ role)\n/* harmony export */ });\n// src/plugins/organization/access/access.ts\nfunction createAccessControl(s) {\n  return {\n    newRole(statements2) {\n      return role(statements2);\n    }\n  };\n}\nfunction role(statements) {\n  return {\n    statements,\n    authorize(request, connector) {\n      for (const [requestedResource, requestedActions] of Object.entries(\n        request\n      )) {\n        const allowedActions = statements[requestedResource];\n        if (!allowedActions) {\n          return {\n            success: false,\n            error: `You are not allowed to access resource: ${requestedResource}`\n          };\n        }\n        const success = connector === \"OR\" ? requestedActions.some(\n          (requestedAction) => allowedActions.includes(requestedAction)\n        ) : requestedActions.every(\n          (requestedAction) => allowedActions.includes(requestedAction)\n        );\n        if (success) {\n          return { success: true };\n        }\n        return {\n          success: false,\n          error: `Unauthorized to access resource \"${requestedResource}\"`\n        };\n      }\n      return {\n        success: false,\n        error: \"Not authorized\"\n      };\n    }\n  };\n}\n\n// src/plugins/organization/access/statement.ts\nvar defaultStatements = {\n  organization: [\"update\", \"delete\"],\n  member: [\"create\", \"update\", \"delete\"],\n  invitation: [\"create\", \"cancel\"]\n};\nvar defaultAc = createAccessControl();\nvar adminAc = defaultAc.newRole({\n  organization: [\"update\"],\n  invitation: [\"create\", \"cancel\"],\n  member: [\"create\", \"update\", \"delete\"]\n});\nvar ownerAc = defaultAc.newRole({\n  organization: [\"update\", \"delete\"],\n  member: [\"create\", \"update\", \"delete\"],\n  invitation: [\"create\", \"cancel\"]\n});\nvar memberAc = defaultAc.newRole({\n  organization: [],\n  member: [],\n  invitation: []\n});\nvar defaultRoles = {\n  admin: adminAc,\n  owner: ownerAc,\n  member: memberAc\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstR0JMRUdIWlcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxrQkFBa0I7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsa0JBQWtCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTZHIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstR0JMRUdIWlcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3BsdWdpbnMvb3JnYW5pemF0aW9uL2FjY2Vzcy9hY2Nlc3MudHNcbmZ1bmN0aW9uIGNyZWF0ZUFjY2Vzc0NvbnRyb2wocykge1xuICByZXR1cm4ge1xuICAgIG5ld1JvbGUoc3RhdGVtZW50czIpIHtcbiAgICAgIHJldHVybiByb2xlKHN0YXRlbWVudHMyKTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiByb2xlKHN0YXRlbWVudHMpIHtcbiAgcmV0dXJuIHtcbiAgICBzdGF0ZW1lbnRzLFxuICAgIGF1dGhvcml6ZShyZXF1ZXN0LCBjb25uZWN0b3IpIHtcbiAgICAgIGZvciAoY29uc3QgW3JlcXVlc3RlZFJlc291cmNlLCByZXF1ZXN0ZWRBY3Rpb25zXSBvZiBPYmplY3QuZW50cmllcyhcbiAgICAgICAgcmVxdWVzdFxuICAgICAgKSkge1xuICAgICAgICBjb25zdCBhbGxvd2VkQWN0aW9ucyA9IHN0YXRlbWVudHNbcmVxdWVzdGVkUmVzb3VyY2VdO1xuICAgICAgICBpZiAoIWFsbG93ZWRBY3Rpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IGBZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGFjY2VzcyByZXNvdXJjZTogJHtyZXF1ZXN0ZWRSZXNvdXJjZX1gXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdWNjZXNzID0gY29ubmVjdG9yID09PSBcIk9SXCIgPyByZXF1ZXN0ZWRBY3Rpb25zLnNvbWUoXG4gICAgICAgICAgKHJlcXVlc3RlZEFjdGlvbikgPT4gYWxsb3dlZEFjdGlvbnMuaW5jbHVkZXMocmVxdWVzdGVkQWN0aW9uKVxuICAgICAgICApIDogcmVxdWVzdGVkQWN0aW9ucy5ldmVyeShcbiAgICAgICAgICAocmVxdWVzdGVkQWN0aW9uKSA9PiBhbGxvd2VkQWN0aW9ucy5pbmNsdWRlcyhyZXF1ZXN0ZWRBY3Rpb24pXG4gICAgICAgICk7XG4gICAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGBVbmF1dGhvcml6ZWQgdG8gYWNjZXNzIHJlc291cmNlIFwiJHtyZXF1ZXN0ZWRSZXNvdXJjZX1cImBcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogXCJOb3QgYXV0aG9yaXplZFwiXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1cblxuLy8gc3JjL3BsdWdpbnMvb3JnYW5pemF0aW9uL2FjY2Vzcy9zdGF0ZW1lbnQudHNcbnZhciBkZWZhdWx0U3RhdGVtZW50cyA9IHtcbiAgb3JnYW5pemF0aW9uOiBbXCJ1cGRhdGVcIiwgXCJkZWxldGVcIl0sXG4gIG1lbWJlcjogW1wiY3JlYXRlXCIsIFwidXBkYXRlXCIsIFwiZGVsZXRlXCJdLFxuICBpbnZpdGF0aW9uOiBbXCJjcmVhdGVcIiwgXCJjYW5jZWxcIl1cbn07XG52YXIgZGVmYXVsdEFjID0gY3JlYXRlQWNjZXNzQ29udHJvbCgpO1xudmFyIGFkbWluQWMgPSBkZWZhdWx0QWMubmV3Um9sZSh7XG4gIG9yZ2FuaXphdGlvbjogW1widXBkYXRlXCJdLFxuICBpbnZpdGF0aW9uOiBbXCJjcmVhdGVcIiwgXCJjYW5jZWxcIl0sXG4gIG1lbWJlcjogW1wiY3JlYXRlXCIsIFwidXBkYXRlXCIsIFwiZGVsZXRlXCJdXG59KTtcbnZhciBvd25lckFjID0gZGVmYXVsdEFjLm5ld1JvbGUoe1xuICBvcmdhbml6YXRpb246IFtcInVwZGF0ZVwiLCBcImRlbGV0ZVwiXSxcbiAgbWVtYmVyOiBbXCJjcmVhdGVcIiwgXCJ1cGRhdGVcIiwgXCJkZWxldGVcIl0sXG4gIGludml0YXRpb246IFtcImNyZWF0ZVwiLCBcImNhbmNlbFwiXVxufSk7XG52YXIgbWVtYmVyQWMgPSBkZWZhdWx0QWMubmV3Um9sZSh7XG4gIG9yZ2FuaXphdGlvbjogW10sXG4gIG1lbWJlcjogW10sXG4gIGludml0YXRpb246IFtdXG59KTtcbnZhciBkZWZhdWx0Um9sZXMgPSB7XG4gIGFkbWluOiBhZG1pbkFjLFxuICBvd25lcjogb3duZXJBYyxcbiAgbWVtYmVyOiBtZW1iZXJBY1xufTtcblxuZXhwb3J0IHsgYWRtaW5BYywgY3JlYXRlQWNjZXNzQ29udHJvbCwgZGVmYXVsdEFjLCBkZWZhdWx0Um9sZXMsIGRlZmF1bHRTdGF0ZW1lbnRzLCBtZW1iZXJBYywgb3duZXJBYywgcm9sZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuthorizationURL: () => (/* binding */ createAuthorizationURL),\n/* harmony export */   generateCodeChallenge: () => (/* binding */ generateCodeChallenge),\n/* harmony export */   getOAuth2Tokens: () => (/* binding */ getOAuth2Tokens),\n/* harmony export */   validateAuthorizationCode: () => (/* binding */ validateAuthorizationCode),\n/* harmony export */   validateToken: () => (/* binding */ validateToken)\n/* harmony export */ });\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-fetch/fetch */ \"(action-browser)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n\n\n\n\n\n\nasync function generateCodeChallenge(codeVerifier) {\n  const codeChallengeBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_1__.createHash)(\"SHA-256\").digest(codeVerifier);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_2__.base64Url.encode(new Uint8Array(codeChallengeBytes), {\n    padding: false\n  });\n}\nfunction getOAuth2Tokens(data) {\n  return {\n    tokenType: data.token_type,\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    accessTokenExpiresAt: data.expires_in ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_0__.getDate)(data.expires_in, \"sec\") : void 0,\n    scopes: data?.scope ? typeof data.scope === \"string\" ? data.scope.split(\" \") : data.scope : [],\n    idToken: data.id_token\n  };\n}\n\n// src/oauth2/create-authorization-url.ts\nasync function createAuthorizationURL({\n  id,\n  options,\n  authorizationEndpoint,\n  state,\n  codeVerifier,\n  scopes,\n  claims,\n  redirectURI,\n  duration,\n  prompt\n}) {\n  const url = new URL(authorizationEndpoint);\n  url.searchParams.set(\"response_type\", \"code\");\n  url.searchParams.set(\"client_id\", options.clientId);\n  url.searchParams.set(\"state\", state);\n  url.searchParams.set(\"scope\", scopes.join(\" \"));\n  url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (codeVerifier) {\n    const codeChallenge = await generateCodeChallenge(codeVerifier);\n    url.searchParams.set(\"code_challenge_method\", \"S256\");\n    url.searchParams.set(\"code_challenge\", codeChallenge);\n  }\n  if (claims) {\n    const claimsObj = claims.reduce(\n      (acc, claim) => {\n        acc[claim] = null;\n        return acc;\n      },\n      {}\n    );\n    url.searchParams.set(\n      \"claims\",\n      JSON.stringify({\n        id_token: { email: null, email_verified: null, ...claimsObj }\n      })\n    );\n  }\n  if (duration) {\n    url.searchParams.set(\"duration\", duration);\n  }\n  if (prompt) {\n    url.searchParams.set(\"prompt\", \"select_account\");\n  }\n  return url;\n}\nasync function validateAuthorizationCode({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  tokenEndpoint,\n  authentication\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\",\n    \"user-agent\": \"better-auth\"\n  };\n  body.set(\"grant_type\", \"authorization_code\");\n  body.set(\"code\", code);\n  codeVerifier && body.set(\"code_verifier\", codeVerifier);\n  body.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (authentication === \"basic\") {\n    const encodedCredentials = btoa(\n      `${options.clientId}:${options.clientSecret}`\n    );\n    headers[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    body.set(\"client_id\", options.clientId);\n    body.set(\"client_secret\", options.clientSecret);\n  }\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = getOAuth2Tokens(data);\n  return tokens;\n}\nasync function validateToken(token, jwksEndpoint) {\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(jwksEndpoint, {\n    method: \"GET\",\n    headers: {\n      accept: \"application/json\",\n      \"user-agent\": \"better-auth\"\n    }\n  });\n  if (error) {\n    throw error;\n  }\n  const keys = data[\"keys\"];\n  const header = JSON.parse(atob(token.split(\".\")[0]));\n  const key = keys.find((key2) => key2.kid === header.kid);\n  if (!key) {\n    throw new Error(\"Key not found\");\n  }\n  const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.jwtVerify)(token, key);\n  return verified;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstR1RRTTdKVTcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUE4QztBQUNPO0FBQ0M7QUFDSjtBQUNqQjs7QUFFakM7QUFDQSxtQ0FBbUMsbUVBQVU7QUFDN0MsU0FBUyxnRUFBUztBQUNsQjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsMkRBQU87QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEIsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxpQkFBaUIsR0FBRyxxQkFBcUI7QUFDbEQ7QUFDQSx3Q0FBd0MsbUJBQW1CO0FBQzNELElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxVQUFVLGNBQWMsUUFBUSxnRUFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGNBQWMsUUFBUSxnRUFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiwrQ0FBUztBQUNsQztBQUNBOztBQUVvSCIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdUUU03SlU3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgeyBiYXNlNjRVcmwgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgeyBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJztcblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcikge1xuICBjb25zdCBjb2RlQ2hhbGxlbmdlQnl0ZXMgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3QoY29kZVZlcmlmaWVyKTtcbiAgcmV0dXJuIGJhc2U2NFVybC5lbmNvZGUobmV3IFVpbnQ4QXJyYXkoY29kZUNoYWxsZW5nZUJ5dGVzKSwge1xuICAgIHBhZGRpbmc6IGZhbHNlXG4gIH0pO1xufVxuZnVuY3Rpb24gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpIHtcbiAgcmV0dXJuIHtcbiAgICB0b2tlblR5cGU6IGRhdGEudG9rZW5fdHlwZSxcbiAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgcmVmcmVzaFRva2VuOiBkYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGRhdGEuZXhwaXJlc19pbiA/IGdldERhdGUoZGF0YS5leHBpcmVzX2luLCBcInNlY1wiKSA6IHZvaWQgMCxcbiAgICBzY29wZXM6IGRhdGE/LnNjb3BlID8gdHlwZW9mIGRhdGEuc2NvcGUgPT09IFwic3RyaW5nXCIgPyBkYXRhLnNjb3BlLnNwbGl0KFwiIFwiKSA6IGRhdGEuc2NvcGUgOiBbXSxcbiAgICBpZFRva2VuOiBkYXRhLmlkX3Rva2VuXG4gIH07XG59XG5cbi8vIHNyYy9vYXV0aDIvY3JlYXRlLWF1dGhvcml6YXRpb24tdXJsLnRzXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgaWQsXG4gIG9wdGlvbnMsXG4gIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgc3RhdGUsXG4gIGNvZGVWZXJpZmllcixcbiAgc2NvcGVzLFxuICBjbGFpbXMsXG4gIHJlZGlyZWN0VVJJLFxuICBkdXJhdGlvbixcbiAgcHJvbXB0XG59KSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoYXV0aG9yaXphdGlvbkVuZHBvaW50KTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV90eXBlXCIsIFwiY29kZVwiKTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJjbGllbnRfaWRcIiwgb3B0aW9ucy5jbGllbnRJZCk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwic3RhdGVcIiwgc3RhdGUpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInNjb3BlXCIsIHNjb3Blcy5qb2luKFwiIFwiKSk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVkaXJlY3RfdXJpXCIsIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkkpO1xuICBpZiAoY29kZVZlcmlmaWVyKSB7XG4gICAgY29uc3QgY29kZUNoYWxsZW5nZSA9IGF3YWl0IGdlbmVyYXRlQ29kZUNoYWxsZW5nZShjb2RlVmVyaWZpZXIpO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY29kZV9jaGFsbGVuZ2VfbWV0aG9kXCIsIFwiUzI1NlwiKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImNvZGVfY2hhbGxlbmdlXCIsIGNvZGVDaGFsbGVuZ2UpO1xuICB9XG4gIGlmIChjbGFpbXMpIHtcbiAgICBjb25zdCBjbGFpbXNPYmogPSBjbGFpbXMucmVkdWNlKFxuICAgICAgKGFjYywgY2xhaW0pID0+IHtcbiAgICAgICAgYWNjW2NsYWltXSA9IG51bGw7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LFxuICAgICAge31cbiAgICApO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFxuICAgICAgXCJjbGFpbXNcIixcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaWRfdG9rZW46IHsgZW1haWw6IG51bGwsIGVtYWlsX3ZlcmlmaWVkOiBudWxsLCAuLi5jbGFpbXNPYmogfVxuICAgICAgfSlcbiAgICApO1xuICB9XG4gIGlmIChkdXJhdGlvbikge1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiZHVyYXRpb25cIiwgZHVyYXRpb24pO1xuICB9XG4gIGlmIChwcm9tcHQpIHtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInByb21wdFwiLCBcInNlbGVjdF9hY2NvdW50XCIpO1xuICB9XG4gIHJldHVybiB1cmw7XG59XG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgY29kZSxcbiAgY29kZVZlcmlmaWVyLFxuICByZWRpcmVjdFVSSSxcbiAgb3B0aW9ucyxcbiAgdG9rZW5FbmRwb2ludCxcbiAgYXV0aGVudGljYXRpb25cbn0pIHtcbiAgY29uc3QgYm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICB9O1xuICBib2R5LnNldChcImdyYW50X3R5cGVcIiwgXCJhdXRob3JpemF0aW9uX2NvZGVcIik7XG4gIGJvZHkuc2V0KFwiY29kZVwiLCBjb2RlKTtcbiAgY29kZVZlcmlmaWVyICYmIGJvZHkuc2V0KFwiY29kZV92ZXJpZmllclwiLCBjb2RlVmVyaWZpZXIpO1xuICBib2R5LnNldChcInJlZGlyZWN0X3VyaVwiLCBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJKTtcbiAgaWYgKGF1dGhlbnRpY2F0aW9uID09PSBcImJhc2ljXCIpIHtcbiAgICBjb25zdCBlbmNvZGVkQ3JlZGVudGlhbHMgPSBidG9hKFxuICAgICAgYCR7b3B0aW9ucy5jbGllbnRJZH06JHtvcHRpb25zLmNsaWVudFNlY3JldH1gXG4gICAgKTtcbiAgICBoZWFkZXJzW1wiYXV0aG9yaXphdGlvblwiXSA9IGBCYXNpYyAke2VuY29kZWRDcmVkZW50aWFsc31gO1xuICB9IGVsc2Uge1xuICAgIGJvZHkuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICAgIGJvZHkuc2V0KFwiY2xpZW50X3NlY3JldFwiLCBvcHRpb25zLmNsaWVudFNlY3JldCk7XG4gIH1cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keSxcbiAgICBoZWFkZXJzXG4gIH0pO1xuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBjb25zdCB0b2tlbnMgPSBnZXRPQXV0aDJUb2tlbnMoZGF0YSk7XG4gIHJldHVybiB0b2tlbnM7XG59XG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVRva2VuKHRva2VuLCBqd2tzRW5kcG9pbnQpIHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goandrc0VuZHBvaW50LCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBcInVzZXItYWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiXG4gICAgfVxuICB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3Qga2V5cyA9IGRhdGFbXCJrZXlzXCJdO1xuICBjb25zdCBoZWFkZXIgPSBKU09OLnBhcnNlKGF0b2IodG9rZW4uc3BsaXQoXCIuXCIpWzBdKSk7XG4gIGNvbnN0IGtleSA9IGtleXMuZmluZCgoa2V5MikgPT4ga2V5Mi5raWQgPT09IGhlYWRlci5raWQpO1xuICBpZiAoIWtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIktleSBub3QgZm91bmRcIik7XG4gIH1cbiAgY29uc3QgdmVyaWZpZWQgPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIGtleSk7XG4gIHJldHVybiB2ZXJpZmllZDtcbn1cblxuZXhwb3J0IHsgY3JlYXRlQXV0aG9yaXphdGlvblVSTCwgZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlLCBnZXRPQXV0aDJUb2tlbnMsIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUsIHZhbGlkYXRlVG9rZW4gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   twoFactorClient: () => (/* binding */ twoFactorClient)\n/* harmony export */ });\n// src/plugins/two-factor/client.ts\nvar twoFactorClient = (options) => {\n  return {\n    id: \"two-factor\",\n    $InferServerPlugin: {},\n    atomListeners: [\n      {\n        matcher: (path) => path.startsWith(\"/two-factor/\"),\n        signal: \"$sessionSignal\"\n      }\n    ],\n    pathMethods: {\n      \"/two-factor/disable\": \"POST\",\n      \"/two-factor/enable\": \"POST\",\n      \"/two-factor/send-otp\": \"POST\",\n      \"/two-factor/generate-backup-codes\": \"POST\"\n    },\n    fetchPlugins: [\n      {\n        id: \"two-factor\",\n        name: \"two-factor\",\n        hooks: {\n          async onSuccess(context) {\n            if (context.data?.twoFactorRedirect) {\n              if (options?.onTwoFactorRedirect) {\n                await options.onTwoFactorRedirect();\n              }\n            }\n          }\n        }\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstR1lEVVBHN1guanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFMkIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1HWURVUEc3WC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcGx1Z2lucy90d28tZmFjdG9yL2NsaWVudC50c1xudmFyIHR3b0ZhY3RvckNsaWVudCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidHdvLWZhY3RvclwiLFxuICAgICRJbmZlclNlcnZlclBsdWdpbjoge30sXG4gICAgYXRvbUxpc3RlbmVyczogW1xuICAgICAge1xuICAgICAgICBtYXRjaGVyOiAocGF0aCkgPT4gcGF0aC5zdGFydHNXaXRoKFwiL3R3by1mYWN0b3IvXCIpLFxuICAgICAgICBzaWduYWw6IFwiJHNlc3Npb25TaWduYWxcIlxuICAgICAgfVxuICAgIF0sXG4gICAgcGF0aE1ldGhvZHM6IHtcbiAgICAgIFwiL3R3by1mYWN0b3IvZGlzYWJsZVwiOiBcIlBPU1RcIixcbiAgICAgIFwiL3R3by1mYWN0b3IvZW5hYmxlXCI6IFwiUE9TVFwiLFxuICAgICAgXCIvdHdvLWZhY3Rvci9zZW5kLW90cFwiOiBcIlBPU1RcIixcbiAgICAgIFwiL3R3by1mYWN0b3IvZ2VuZXJhdGUtYmFja3VwLWNvZGVzXCI6IFwiUE9TVFwiXG4gICAgfSxcbiAgICBmZXRjaFBsdWdpbnM6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6IFwidHdvLWZhY3RvclwiLFxuICAgICAgICBuYW1lOiBcInR3by1mYWN0b3JcIixcbiAgICAgICAgaG9va3M6IHtcbiAgICAgICAgICBhc3luYyBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKGNvbnRleHQuZGF0YT8udHdvRmFjdG9yUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnM/Lm9uVHdvRmFjdG9yUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBvcHRpb25zLm9uVHdvRmFjdG9yUmVkaXJlY3QoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIF1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IHR3b0ZhY3RvckNsaWVudCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseJSON: () => (/* binding */ parseJSON),\n/* harmony export */   parser_default: () => (/* binding */ parser_default)\n/* harmony export */ });\n// src/client/parser.ts\nvar PROTO_POLLUTION_PATTERNS = {\n  proto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n  constructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n  protoShort: /\"__proto__\"\\s*:/,\n  constructorShort: /\"constructor\"\\s*:/\n};\nvar JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nvar SPECIAL_VALUES = {\n  true: true,\n  false: false,\n  null: null,\n  undefined: void 0,\n  nan: Number.NaN,\n  infinity: Number.POSITIVE_INFINITY,\n  \"-infinity\": Number.NEGATIVE_INFINITY\n};\nvar ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n  return date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n  const match = ISO_DATE_REGEX.exec(value);\n  if (!match) return null;\n  const [\n    ,\n    year,\n    month,\n    day,\n    hour,\n    minute,\n    second,\n    ms,\n    offsetSign,\n    offsetHour,\n    offsetMinute\n  ] = match;\n  let date = new Date(\n    Date.UTC(\n      parseInt(year, 10),\n      parseInt(month, 10) - 1,\n      parseInt(day, 10),\n      parseInt(hour, 10),\n      parseInt(minute, 10),\n      parseInt(second, 10),\n      ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0\n    )\n  );\n  if (offsetSign) {\n    const offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n    date.setUTCMinutes(date.getUTCMinutes() + offset);\n  }\n  return isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n  const {\n    strict = false,\n    warnings = false,\n    reviver,\n    parseDates = true\n  } = options;\n  if (typeof value !== \"string\") {\n    return value;\n  }\n  const trimmed = value.trim();\n  if (trimmed[0] === '\"' && trimmed.endsWith('\"') && !trimmed.slice(1, -1).includes('\"')) {\n    return trimmed.slice(1, -1);\n  }\n  const lowerValue = trimmed.toLowerCase();\n  if (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n    return SPECIAL_VALUES[lowerValue];\n  }\n  if (!JSON_SIGNATURE.test(trimmed)) {\n    if (strict) {\n      throw new SyntaxError(\"[better-json] Invalid JSON\");\n    }\n    return value;\n  }\n  const hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n    ([key, pattern]) => {\n      const matches = pattern.test(trimmed);\n      if (matches && warnings) {\n        console.warn(\n          `[better-json] Detected potential prototype pollution attempt using ${key} pattern`\n        );\n      }\n      return matches;\n    }\n  );\n  if (hasProtoPattern && strict) {\n    throw new Error(\n      \"[better-json] Potential prototype pollution attempt detected\"\n    );\n  }\n  try {\n    const secureReviver = (key, value2) => {\n      if (key === \"__proto__\" || key === \"constructor\" && value2 && typeof value2 === \"object\" && \"prototype\" in value2) {\n        if (warnings) {\n          console.warn(\n            `[better-json] Dropping \"${key}\" key to prevent prototype pollution`\n          );\n        }\n        return void 0;\n      }\n      if (parseDates && typeof value2 === \"string\") {\n        const date = parseISODate(value2);\n        if (date) {\n          return date;\n        }\n      }\n      return reviver ? reviver(key, value2) : value2;\n    };\n    return JSON.parse(trimmed, secureReviver);\n  } catch (error) {\n    if (strict) {\n      throw error;\n    }\n    return value;\n  }\n}\nfunction parseJSON(value, options = { strict: true }) {\n  return betterJSONParse(value, options);\n}\nvar parser_default = parseJSON;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstSFZITjNZMkwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0EscUJBQXFCLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxhQUFhLEVBQUUsYUFBYSxFQUFFLGdCQUFnQixFQUFFLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxPQUFPLEVBQUU7QUFDdEk7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsV0FBVyxLQUFLLE1BQU0sS0FBSztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsSUFBSSxrQkFBa0IsRUFBRSxNQUFNLEVBQUU7QUFDL0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsS0FBSztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsSUFBSTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsY0FBYztBQUNwRDtBQUNBO0FBQ0E7O0FBRXFDIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstSFZITjNZMkwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2NsaWVudC9wYXJzZXIudHNcbnZhciBQUk9UT19QT0xMVVRJT05fUEFUVEVSTlMgPSB7XG4gIHByb3RvOiAvXCIoPzpffFxcXFx1MHsyfTVbRmZdKXsyfSg/OnB8XFxcXHUwezJ9NzApKD86cnxcXFxcdTB7Mn03MikoPzpvfFxcXFx1MHsyfTZbRmZdKSg/OnR8XFxcXHUwezJ9NzQpKD86b3xcXFxcdTB7Mn02W0ZmXSkoPzpffFxcXFx1MHsyfTVbRmZdKXsyfVwiXFxzKjovLFxuICBjb25zdHJ1Y3RvcjogL1wiKD86Y3xcXFxcdTAwNjMpKD86b3xcXFxcdTAwNltGZl0pKD86bnxcXFxcdTAwNltFZV0pKD86c3xcXFxcdTAwNzMpKD86dHxcXFxcdTAwNzQpKD86cnxcXFxcdTAwNzIpKD86dXxcXFxcdTAwNzUpKD86Y3xcXFxcdTAwNjMpKD86dHxcXFxcdTAwNzQpKD86b3xcXFxcdTAwNltGZl0pKD86cnxcXFxcdTAwNzIpXCJcXHMqOi8sXG4gIHByb3RvU2hvcnQ6IC9cIl9fcHJvdG9fX1wiXFxzKjovLFxuICBjb25zdHJ1Y3RvclNob3J0OiAvXCJjb25zdHJ1Y3RvclwiXFxzKjovXG59O1xudmFyIEpTT05fU0lHTkFUVVJFID0gL15cXHMqW1wiW3tdfF5cXHMqLT9cXGR7MSwxNn0oXFwuXFxkezEsMTd9KT8oW0VlXVsrLV0/XFxkKyk/XFxzKiQvO1xudmFyIFNQRUNJQUxfVkFMVUVTID0ge1xuICB0cnVlOiB0cnVlLFxuICBmYWxzZTogZmFsc2UsXG4gIG51bGw6IG51bGwsXG4gIHVuZGVmaW5lZDogdm9pZCAwLFxuICBuYW46IE51bWJlci5OYU4sXG4gIGluZmluaXR5OiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXG4gIFwiLWluZmluaXR5XCI6IE51bWJlci5ORUdBVElWRV9JTkZJTklUWVxufTtcbnZhciBJU09fREFURV9SRUdFWCA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSlUKFxcZHsyfSk6KFxcZHsyfSk6KFxcZHsyfSkoPzpcXC4oXFxkezEsN30pKT8oPzpafChbKy1dKShcXGR7Mn0pOihcXGR7Mn0pKSQvO1xuZnVuY3Rpb24gaXNWYWxpZERhdGUoZGF0ZSkge1xuICByZXR1cm4gZGF0ZSBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKGRhdGUuZ2V0VGltZSgpKTtcbn1cbmZ1bmN0aW9uIHBhcnNlSVNPRGF0ZSh2YWx1ZSkge1xuICBjb25zdCBtYXRjaCA9IElTT19EQVRFX1JFR0VYLmV4ZWModmFsdWUpO1xuICBpZiAoIW1hdGNoKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgW1xuICAgICxcbiAgICB5ZWFyLFxuICAgIG1vbnRoLFxuICAgIGRheSxcbiAgICBob3VyLFxuICAgIG1pbnV0ZSxcbiAgICBzZWNvbmQsXG4gICAgbXMsXG4gICAgb2Zmc2V0U2lnbixcbiAgICBvZmZzZXRIb3VyLFxuICAgIG9mZnNldE1pbnV0ZVxuICBdID0gbWF0Y2g7XG4gIGxldCBkYXRlID0gbmV3IERhdGUoXG4gICAgRGF0ZS5VVEMoXG4gICAgICBwYXJzZUludCh5ZWFyLCAxMCksXG4gICAgICBwYXJzZUludChtb250aCwgMTApIC0gMSxcbiAgICAgIHBhcnNlSW50KGRheSwgMTApLFxuICAgICAgcGFyc2VJbnQoaG91ciwgMTApLFxuICAgICAgcGFyc2VJbnQobWludXRlLCAxMCksXG4gICAgICBwYXJzZUludChzZWNvbmQsIDEwKSxcbiAgICAgIG1zID8gcGFyc2VJbnQobXMucGFkRW5kKDMsIFwiMFwiKSwgMTApIDogMFxuICAgIClcbiAgKTtcbiAgaWYgKG9mZnNldFNpZ24pIHtcbiAgICBjb25zdCBvZmZzZXQgPSAocGFyc2VJbnQob2Zmc2V0SG91ciwgMTApICogNjAgKyBwYXJzZUludChvZmZzZXRNaW51dGUsIDEwKSkgKiAob2Zmc2V0U2lnbiA9PT0gXCIrXCIgPyAtMSA6IDEpO1xuICAgIGRhdGUuc2V0VVRDTWludXRlcyhkYXRlLmdldFVUQ01pbnV0ZXMoKSArIG9mZnNldCk7XG4gIH1cbiAgcmV0dXJuIGlzVmFsaWREYXRlKGRhdGUpID8gZGF0ZSA6IG51bGw7XG59XG5mdW5jdGlvbiBiZXR0ZXJKU09OUGFyc2UodmFsdWUsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgc3RyaWN0ID0gZmFsc2UsXG4gICAgd2FybmluZ3MgPSBmYWxzZSxcbiAgICByZXZpdmVyLFxuICAgIHBhcnNlRGF0ZXMgPSB0cnVlXG4gIH0gPSBvcHRpb25zO1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGNvbnN0IHRyaW1tZWQgPSB2YWx1ZS50cmltKCk7XG4gIGlmICh0cmltbWVkWzBdID09PSAnXCInICYmIHRyaW1tZWQuZW5kc1dpdGgoJ1wiJykgJiYgIXRyaW1tZWQuc2xpY2UoMSwgLTEpLmluY2x1ZGVzKCdcIicpKSB7XG4gICAgcmV0dXJuIHRyaW1tZWQuc2xpY2UoMSwgLTEpO1xuICB9XG4gIGNvbnN0IGxvd2VyVmFsdWUgPSB0cmltbWVkLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChsb3dlclZhbHVlLmxlbmd0aCA8PSA5ICYmIGxvd2VyVmFsdWUgaW4gU1BFQ0lBTF9WQUxVRVMpIHtcbiAgICByZXR1cm4gU1BFQ0lBTF9WQUxVRVNbbG93ZXJWYWx1ZV07XG4gIH1cbiAgaWYgKCFKU09OX1NJR05BVFVSRS50ZXN0KHRyaW1tZWQpKSB7XG4gICAgaWYgKHN0cmljdCkge1xuICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFwiW2JldHRlci1qc29uXSBJbnZhbGlkIEpTT05cIik7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBjb25zdCBoYXNQcm90b1BhdHRlcm4gPSBPYmplY3QuZW50cmllcyhQUk9UT19QT0xMVVRJT05fUEFUVEVSTlMpLnNvbWUoXG4gICAgKFtrZXksIHBhdHRlcm5dKSA9PiB7XG4gICAgICBjb25zdCBtYXRjaGVzID0gcGF0dGVybi50ZXN0KHRyaW1tZWQpO1xuICAgICAgaWYgKG1hdGNoZXMgJiYgd2FybmluZ3MpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGBbYmV0dGVyLWpzb25dIERldGVjdGVkIHBvdGVudGlhbCBwcm90b3R5cGUgcG9sbHV0aW9uIGF0dGVtcHQgdXNpbmcgJHtrZXl9IHBhdHRlcm5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF0Y2hlcztcbiAgICB9XG4gICk7XG4gIGlmIChoYXNQcm90b1BhdHRlcm4gJiYgc3RyaWN0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJbYmV0dGVyLWpzb25dIFBvdGVudGlhbCBwcm90b3R5cGUgcG9sbHV0aW9uIGF0dGVtcHQgZGV0ZWN0ZWRcIlxuICAgICk7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCBzZWN1cmVSZXZpdmVyID0gKGtleSwgdmFsdWUyKSA9PiB7XG4gICAgICBpZiAoa2V5ID09PSBcIl9fcHJvdG9fX1wiIHx8IGtleSA9PT0gXCJjb25zdHJ1Y3RvclwiICYmIHZhbHVlMiAmJiB0eXBlb2YgdmFsdWUyID09PSBcIm9iamVjdFwiICYmIFwicHJvdG90eXBlXCIgaW4gdmFsdWUyKSB7XG4gICAgICAgIGlmICh3YXJuaW5ncykge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgIGBbYmV0dGVyLWpzb25dIERyb3BwaW5nIFwiJHtrZXl9XCIga2V5IHRvIHByZXZlbnQgcHJvdG90eXBlIHBvbGx1dGlvbmBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgICB9XG4gICAgICBpZiAocGFyc2VEYXRlcyAmJiB0eXBlb2YgdmFsdWUyID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGNvbnN0IGRhdGUgPSBwYXJzZUlTT0RhdGUodmFsdWUyKTtcbiAgICAgICAgaWYgKGRhdGUpIHtcbiAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldml2ZXIgPyByZXZpdmVyKGtleSwgdmFsdWUyKSA6IHZhbHVlMjtcbiAgICB9O1xuICAgIHJldHVybiBKU09OLnBhcnNlKHRyaW1tZWQsIHNlY3VyZVJldml2ZXIpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChzdHJpY3QpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbn1cbmZ1bmN0aW9uIHBhcnNlSlNPTih2YWx1ZSwgb3B0aW9ucyA9IHsgc3RyaWN0OiB0cnVlIH0pIHtcbiAgcmV0dXJuIGJldHRlckpTT05QYXJzZSh2YWx1ZSwgb3B0aW9ucyk7XG59XG52YXIgcGFyc2VyX2RlZmF1bHQgPSBwYXJzZUpTT047XG5cbmV4cG9ydCB7IHBhcnNlSlNPTiwgcGFyc2VyX2RlZmF1bHQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bearer: () => (/* binding */ bearer)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n\n\n\n\n\nvar bearer = (options) => {\n  return {\n    id: \"bearer\",\n    hooks: {\n      before: [\n        {\n          matcher(context) {\n            return Boolean(\n              context.request?.headers.get(\"authorization\") || context.headers?.get(\"authorization\")\n            );\n          },\n          handler: async (c) => {\n            const token = c.request?.headers.get(\"authorization\")?.replace(\"Bearer \", \"\") || c.headers?.get(\"authorization\")?.replace(\"Bearer \", \"\");\n            if (!token) {\n              return;\n            }\n            let signedToken = \"\";\n            if (token.includes(\".\")) {\n              signedToken = token.replace(\"=\", \"\");\n            } else {\n              if (options?.requireSignature) {\n                return;\n              }\n              signedToken = (await (0,better_call__WEBPACK_IMPORTED_MODULE_2__.serializeSigned)(\"\", token, c.context.secret)).replace(\"=\", \"\");\n            }\n            try {\n              const decodedToken = decodeURIComponent(signedToken);\n              const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_3__.createHMAC)(\n                \"SHA-256\",\n                \"base64urlnopad\"\n              ).verify(\n                c.context.secret,\n                decodedToken.split(\".\")[0],\n                decodedToken.split(\".\")[1]\n              );\n              if (!isValid) {\n                return;\n              }\n            } catch (e) {\n              return;\n            }\n            if (c.request) {\n              c.request.headers.append(\n                \"cookie\",\n                `${c.context.authCookies.sessionToken.name}=${signedToken}`\n              );\n            }\n            if (c.headers) {\n              c.headers.append(\n                \"cookie\",\n                `${c.context.authCookies.sessionToken.name}=${signedToken}`\n              );\n            }\n            return {\n              context: c\n            };\n          }\n        }\n      ],\n      after: [\n        {\n          matcher(context) {\n            return !!context.responseHeader.get(\"set-cookie\");\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const setCookie = ctx.responseHeader.get(\"set-cookie\");\n            if (!setCookie) {\n              return;\n            }\n            const parsedCookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseSetCookieHeader)(setCookie);\n            const cookieName = ctx.context.authCookies.sessionToken.name;\n            const sessionCookie = parsedCookies.get(cookieName);\n            if (!sessionCookie || !sessionCookie.value || sessionCookie[\"max-age\"] === 0) {\n              return;\n            }\n            const token = sessionCookie.value;\n            ctx.responseHeader.set(\"set-auth-token\", token);\n            ctx.responseHeader.set(\n              \"Access-Control-Expose-Headers\",\n              \"set-auth-token\"\n            );\n            return {\n              responseHeader: ctx.responseHeader\n            };\n          })\n        }\n      ]\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstS0tLSkk1WTcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkQ7QUFDQTtBQUNiO0FBQ087O0FBRXJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDREQUFlO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxtRUFBVTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHdDQUF3QyxHQUFHLFlBQVk7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix3Q0FBd0MsR0FBRyxZQUFZO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxtQkFBbUIsd0VBQW9CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHdFQUFvQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWtCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstS0tLSkk1WTcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aE1pZGRsZXdhcmUgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHBhcnNlU2V0Q29va2llSGVhZGVyIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBzZXJpYWxpemVTaWduZWQgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBjcmVhdGVITUFDIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuXG52YXIgYmVhcmVyID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJiZWFyZXJcIixcbiAgICBob29rczoge1xuICAgICAgYmVmb3JlOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuKFxuICAgICAgICAgICAgICBjb250ZXh0LnJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwiYXV0aG9yaXphdGlvblwiKSB8fCBjb250ZXh0LmhlYWRlcnM/LmdldChcImF1dGhvcml6YXRpb25cIilcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBhc3luYyAoYykgPT4ge1xuICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBjLnJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwiYXV0aG9yaXphdGlvblwiKT8ucmVwbGFjZShcIkJlYXJlciBcIiwgXCJcIikgfHwgYy5oZWFkZXJzPy5nZXQoXCJhdXRob3JpemF0aW9uXCIpPy5yZXBsYWNlKFwiQmVhcmVyIFwiLCBcIlwiKTtcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHNpZ25lZFRva2VuID0gXCJcIjtcbiAgICAgICAgICAgIGlmICh0b2tlbi5pbmNsdWRlcyhcIi5cIikpIHtcbiAgICAgICAgICAgICAgc2lnbmVkVG9rZW4gPSB0b2tlbi5yZXBsYWNlKFwiPVwiLCBcIlwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChvcHRpb25zPy5yZXF1aXJlU2lnbmF0dXJlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHNpZ25lZFRva2VuID0gKGF3YWl0IHNlcmlhbGl6ZVNpZ25lZChcIlwiLCB0b2tlbiwgYy5jb250ZXh0LnNlY3JldCkpLnJlcGxhY2UoXCI9XCIsIFwiXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgZGVjb2RlZFRva2VuID0gZGVjb2RlVVJJQ29tcG9uZW50KHNpZ25lZFRva2VuKTtcbiAgICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IGF3YWl0IGNyZWF0ZUhNQUMoXG4gICAgICAgICAgICAgICAgXCJTSEEtMjU2XCIsXG4gICAgICAgICAgICAgICAgXCJiYXNlNjR1cmxub3BhZFwiXG4gICAgICAgICAgICAgICkudmVyaWZ5KFxuICAgICAgICAgICAgICAgIGMuY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICAgICAgZGVjb2RlZFRva2VuLnNwbGl0KFwiLlwiKVswXSxcbiAgICAgICAgICAgICAgICBkZWNvZGVkVG9rZW4uc3BsaXQoXCIuXCIpWzFdXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYy5yZXF1ZXN0KSB7XG4gICAgICAgICAgICAgIGMucmVxdWVzdC5oZWFkZXJzLmFwcGVuZChcbiAgICAgICAgICAgICAgICBcImNvb2tpZVwiLFxuICAgICAgICAgICAgICAgIGAke2MuY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZX09JHtzaWduZWRUb2tlbn1gXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYy5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgIGMuaGVhZGVycy5hcHBlbmQoXG4gICAgICAgICAgICAgICAgXCJjb29raWVcIixcbiAgICAgICAgICAgICAgICBgJHtjLmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWV9PSR7c2lnbmVkVG9rZW59YFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgY29udGV4dDogY1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICBhZnRlcjogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcihjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gISFjb250ZXh0LnJlc3BvbnNlSGVhZGVyLmdldChcInNldC1jb29raWVcIik7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZXRDb29raWUgPSBjdHgucmVzcG9uc2VIZWFkZXIuZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICAgICAgICAgIGlmICghc2V0Q29va2llKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZENvb2tpZXMgPSBwYXJzZVNldENvb2tpZUhlYWRlcihzZXRDb29raWUpO1xuICAgICAgICAgICAgY29uc3QgY29va2llTmFtZSA9IGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IHBhcnNlZENvb2tpZXMuZ2V0KGNvb2tpZU5hbWUpO1xuICAgICAgICAgICAgaWYgKCFzZXNzaW9uQ29va2llIHx8ICFzZXNzaW9uQ29va2llLnZhbHVlIHx8IHNlc3Npb25Db29raWVbXCJtYXgtYWdlXCJdID09PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gc2Vzc2lvbkNvb2tpZS52YWx1ZTtcbiAgICAgICAgICAgIGN0eC5yZXNwb25zZUhlYWRlci5zZXQoXCJzZXQtYXV0aC10b2tlblwiLCB0b2tlbik7XG4gICAgICAgICAgICBjdHgucmVzcG9uc2VIZWFkZXIuc2V0KFxuICAgICAgICAgICAgICBcIkFjY2Vzcy1Db250cm9sLUV4cG9zZS1IZWFkZXJzXCIsXG4gICAgICAgICAgICAgIFwic2V0LWF1dGgtdG9rZW5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHJlc3BvbnNlSGVhZGVyOiBjdHgucmVzcG9uc2VIZWFkZXJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IGJlYXJlciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HIDE_METADATA: () => (/* binding */ HIDE_METADATA),\n/* harmony export */   createLogger: () => (/* binding */ createLogger),\n/* harmony export */   generateId: () => (/* binding */ generateId),\n/* harmony export */   levels: () => (/* binding */ levels),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   shouldPublishLog: () => (/* binding */ shouldPublishLog)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n// src/utils/logger.ts\nvar levels = [\"info\", \"success\", \"warn\", \"error\", \"debug\"];\nfunction shouldPublishLog(currentLogLevel, logLevel) {\n  return levels.indexOf(logLevel) <= levels.indexOf(currentLogLevel);\n}\nvar colors = {\n  reset: \"\\x1B[0m\",\n  bright: \"\\x1B[1m\",\n  dim: \"\\x1B[2m\",\n  underscore: \"\\x1B[4m\",\n  blink: \"\\x1B[5m\",\n  reverse: \"\\x1B[7m\",\n  hidden: \"\\x1B[8m\",\n  fg: {\n    black: \"\\x1B[30m\",\n    red: \"\\x1B[31m\",\n    green: \"\\x1B[32m\",\n    yellow: \"\\x1B[33m\",\n    blue: \"\\x1B[34m\",\n    magenta: \"\\x1B[35m\",\n    cyan: \"\\x1B[36m\",\n    white: \"\\x1B[37m\"\n  },\n  bg: {\n    black: \"\\x1B[40m\",\n    red: \"\\x1B[41m\",\n    green: \"\\x1B[42m\",\n    yellow: \"\\x1B[43m\",\n    blue: \"\\x1B[44m\",\n    magenta: \"\\x1B[45m\",\n    cyan: \"\\x1B[46m\",\n    white: \"\\x1B[47m\"\n  }\n};\nvar levelColors = {\n  info: colors.fg.blue,\n  success: colors.fg.green,\n  warn: colors.fg.yellow,\n  error: colors.fg.red,\n  debug: colors.fg.magenta\n};\nvar formatMessage = (level, message) => {\n  const timestamp = (/* @__PURE__ */ new Date()).toISOString();\n  return `${colors.dim}${timestamp}${colors.reset} ${levelColors[level]}${level.toUpperCase()}${colors.reset} ${colors.bright}[Better Auth]:${colors.reset} ${message}`;\n};\nvar createLogger = (options) => {\n  const enabled = options?.disabled !== true;\n  const logLevel = options?.level ?? \"error\";\n  const LogFunc = (level, message, args = []) => {\n    if (!enabled || !shouldPublishLog(logLevel, level)) {\n      return;\n    }\n    const formattedMessage = formatMessage(level, message);\n    if (!options || typeof options.log !== \"function\") {\n      if (level === \"error\") {\n        console.error(formattedMessage, ...args);\n      } else if (level === \"warn\") {\n        console.warn(formattedMessage, ...args);\n      } else {\n        console.log(formattedMessage, ...args);\n      }\n      return;\n    }\n    options.log(level === \"success\" ? \"info\" : level, message, ...args);\n  };\n  return Object.fromEntries(\n    levels.map((level) => [\n      level,\n      (...[message, ...args]) => LogFunc(level, message, args)\n    ])\n  );\n};\nvar logger = createLogger();\n\n// src/utils/hide-metadata.ts\nvar HIDE_METADATA = {\n  isAction: false\n};\nvar generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstS0xERkJMWUwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RTs7QUFFeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksV0FBVyxFQUFFLFVBQVUsRUFBRSxjQUFjLEVBQUUsbUJBQW1CLEVBQUUsb0JBQW9CLEVBQUUsY0FBYyxFQUFFLGNBQWMsZ0JBQWdCLGNBQWMsRUFBRSxRQUFRO0FBQ3RLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLHNGQUEyQjtBQUNwQzs7QUFFcUYiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1LTERGQkxZTC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcblxuLy8gc3JjL3V0aWxzL2xvZ2dlci50c1xudmFyIGxldmVscyA9IFtcImluZm9cIiwgXCJzdWNjZXNzXCIsIFwid2FyblwiLCBcImVycm9yXCIsIFwiZGVidWdcIl07XG5mdW5jdGlvbiBzaG91bGRQdWJsaXNoTG9nKGN1cnJlbnRMb2dMZXZlbCwgbG9nTGV2ZWwpIHtcbiAgcmV0dXJuIGxldmVscy5pbmRleE9mKGxvZ0xldmVsKSA8PSBsZXZlbHMuaW5kZXhPZihjdXJyZW50TG9nTGV2ZWwpO1xufVxudmFyIGNvbG9ycyA9IHtcbiAgcmVzZXQ6IFwiXFx4MUJbMG1cIixcbiAgYnJpZ2h0OiBcIlxceDFCWzFtXCIsXG4gIGRpbTogXCJcXHgxQlsybVwiLFxuICB1bmRlcnNjb3JlOiBcIlxceDFCWzRtXCIsXG4gIGJsaW5rOiBcIlxceDFCWzVtXCIsXG4gIHJldmVyc2U6IFwiXFx4MUJbN21cIixcbiAgaGlkZGVuOiBcIlxceDFCWzhtXCIsXG4gIGZnOiB7XG4gICAgYmxhY2s6IFwiXFx4MUJbMzBtXCIsXG4gICAgcmVkOiBcIlxceDFCWzMxbVwiLFxuICAgIGdyZWVuOiBcIlxceDFCWzMybVwiLFxuICAgIHllbGxvdzogXCJcXHgxQlszM21cIixcbiAgICBibHVlOiBcIlxceDFCWzM0bVwiLFxuICAgIG1hZ2VudGE6IFwiXFx4MUJbMzVtXCIsXG4gICAgY3lhbjogXCJcXHgxQlszNm1cIixcbiAgICB3aGl0ZTogXCJcXHgxQlszN21cIlxuICB9LFxuICBiZzoge1xuICAgIGJsYWNrOiBcIlxceDFCWzQwbVwiLFxuICAgIHJlZDogXCJcXHgxQls0MW1cIixcbiAgICBncmVlbjogXCJcXHgxQls0Mm1cIixcbiAgICB5ZWxsb3c6IFwiXFx4MUJbNDNtXCIsXG4gICAgYmx1ZTogXCJcXHgxQls0NG1cIixcbiAgICBtYWdlbnRhOiBcIlxceDFCWzQ1bVwiLFxuICAgIGN5YW46IFwiXFx4MUJbNDZtXCIsXG4gICAgd2hpdGU6IFwiXFx4MUJbNDdtXCJcbiAgfVxufTtcbnZhciBsZXZlbENvbG9ycyA9IHtcbiAgaW5mbzogY29sb3JzLmZnLmJsdWUsXG4gIHN1Y2Nlc3M6IGNvbG9ycy5mZy5ncmVlbixcbiAgd2FybjogY29sb3JzLmZnLnllbGxvdyxcbiAgZXJyb3I6IGNvbG9ycy5mZy5yZWQsXG4gIGRlYnVnOiBjb2xvcnMuZmcubWFnZW50YVxufTtcbnZhciBmb3JtYXRNZXNzYWdlID0gKGxldmVsLCBtZXNzYWdlKSA9PiB7XG4gIGNvbnN0IHRpbWVzdGFtcCA9ICgvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkudG9JU09TdHJpbmcoKTtcbiAgcmV0dXJuIGAke2NvbG9ycy5kaW19JHt0aW1lc3RhbXB9JHtjb2xvcnMucmVzZXR9ICR7bGV2ZWxDb2xvcnNbbGV2ZWxdfSR7bGV2ZWwudG9VcHBlckNhc2UoKX0ke2NvbG9ycy5yZXNldH0gJHtjb2xvcnMuYnJpZ2h0fVtCZXR0ZXIgQXV0aF06JHtjb2xvcnMucmVzZXR9ICR7bWVzc2FnZX1gO1xufTtcbnZhciBjcmVhdGVMb2dnZXIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBlbmFibGVkID0gb3B0aW9ucz8uZGlzYWJsZWQgIT09IHRydWU7XG4gIGNvbnN0IGxvZ0xldmVsID0gb3B0aW9ucz8ubGV2ZWwgPz8gXCJlcnJvclwiO1xuICBjb25zdCBMb2dGdW5jID0gKGxldmVsLCBtZXNzYWdlLCBhcmdzID0gW10pID0+IHtcbiAgICBpZiAoIWVuYWJsZWQgfHwgIXNob3VsZFB1Ymxpc2hMb2cobG9nTGV2ZWwsIGxldmVsKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlID0gZm9ybWF0TWVzc2FnZShsZXZlbCwgbWVzc2FnZSk7XG4gICAgaWYgKCFvcHRpb25zIHx8IHR5cGVvZiBvcHRpb25zLmxvZyAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAobGV2ZWwgPT09IFwiZXJyb3JcIikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdHRlZE1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PT0gXCJ3YXJuXCIpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGZvcm1hdHRlZE1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coZm9ybWF0dGVkTWVzc2FnZSwgLi4uYXJncyk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG9wdGlvbnMubG9nKGxldmVsID09PSBcInN1Y2Nlc3NcIiA/IFwiaW5mb1wiIDogbGV2ZWwsIG1lc3NhZ2UsIC4uLmFyZ3MpO1xuICB9O1xuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIGxldmVscy5tYXAoKGxldmVsKSA9PiBbXG4gICAgICBsZXZlbCxcbiAgICAgICguLi5bbWVzc2FnZSwgLi4uYXJnc10pID0+IExvZ0Z1bmMobGV2ZWwsIG1lc3NhZ2UsIGFyZ3MpXG4gICAgXSlcbiAgKTtcbn07XG52YXIgbG9nZ2VyID0gY3JlYXRlTG9nZ2VyKCk7XG5cbi8vIHNyYy91dGlscy9oaWRlLW1ldGFkYXRhLnRzXG52YXIgSElERV9NRVRBREFUQSA9IHtcbiAgaXNBY3Rpb246IGZhbHNlXG59O1xudmFyIGdlbmVyYXRlSWQgPSAoc2l6ZSkgPT4ge1xuICByZXR1cm4gY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yKFwiYS16XCIsIFwiQS1aXCIsIFwiMC05XCIpKHNpemUgfHwgMzIpO1xufTtcblxuZXhwb3J0IHsgSElERV9NRVRBREFUQSwgY3JlYXRlTG9nZ2VyLCBnZW5lcmF0ZUlkLCBsZXZlbHMsIGxvZ2dlciwgc2hvdWxkUHVibGlzaExvZyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   oidcProvider: () => (/* binding */ oidcProvider)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n\n\n\n\n\n\n\n\n\n// src/plugins/oidc-provider/schema.ts\nvar schema = {\n  oauthApplication: {\n    modelName: \"oauthApplication\",\n    fields: {\n      name: {\n        type: \"string\"\n      },\n      icon: {\n        type: \"string\",\n        required: false\n      },\n      metadata: {\n        type: \"string\",\n        required: false\n      },\n      clientId: {\n        type: \"string\",\n        unique: true\n      },\n      clientSecret: {\n        type: \"string\"\n      },\n      redirectURLs: {\n        type: \"string\"\n      },\n      type: {\n        type: \"string\"\n      },\n      disabled: {\n        type: \"boolean\",\n        required: false,\n        defaultValue: false\n      },\n      userId: {\n        type: \"string\",\n        required: false\n      },\n      createdAt: {\n        type: \"date\"\n      },\n      updatedAt: {\n        type: \"date\"\n      }\n    }\n  },\n  oauthAccessToken: {\n    modelName: \"oauthAccessToken\",\n    fields: {\n      accessToken: {\n        type: \"string\",\n        unique: true\n      },\n      refreshToken: {\n        type: \"string\",\n        unique: true\n      },\n      accessTokenExpiresAt: {\n        type: \"date\"\n      },\n      refreshTokenExpiresAt: {\n        type: \"date\"\n      },\n      clientId: {\n        type: \"string\"\n      },\n      userId: {\n        type: \"string\",\n        required: false\n      },\n      scopes: {\n        type: \"string\"\n      },\n      createdAt: {\n        type: \"date\"\n      },\n      updatedAt: {\n        type: \"date\"\n      }\n    }\n  },\n  oauthConsent: {\n    modelName: \"oauthConsent\",\n    fields: {\n      clientId: {\n        type: \"string\"\n      },\n      userId: {\n        type: \"string\"\n      },\n      scopes: {\n        type: \"string\"\n      },\n      createdAt: {\n        type: \"date\"\n      },\n      updatedAt: {\n        type: \"date\"\n      },\n      consentGiven: {\n        type: \"boolean\"\n      }\n    }\n  }\n};\nfunction redirectErrorURL(url, error, description) {\n  return `${url.includes(\"?\") ? \"&\" : \"?\"}error=${error}&error_description=${description}`;\n}\nasync function authorize(ctx, options) {\n  const opts = {\n    codeExpiresIn: 600,\n    defaultScope: \"openid\",\n    ...options,\n    scopes: [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"offline_access\",\n      ...options?.scopes || []\n    ]\n  };\n  if (!ctx.request) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n      error_description: \"request not found\",\n      error: \"invalid_request\"\n    });\n  }\n  const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n  if (!session) {\n    await ctx.setSignedCookie(\n      \"oidc_login_prompt\",\n      JSON.stringify(ctx.query),\n      ctx.context.secret,\n      {\n        maxAge: 600\n      }\n    );\n    const queryFromURL = ctx.request.url?.split(\"?\")[1];\n    throw ctx.redirect(`${options.loginPage}?${queryFromURL}`);\n  }\n  const query = ctx.query;\n  if (!query.client_id) {\n    throw ctx.redirect(`${ctx.context.baseURL}/error?error=invalid_client`);\n  }\n  if (!query.response_type) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        `${ctx.context.baseURL}/error`,\n        \"invalid_request\",\n        \"response_type is required\"\n      )\n    );\n  }\n  const client = await ctx.context.adapter.findOne({\n    model: \"oauthApplication\",\n    where: [\n      {\n        field: \"clientId\",\n        value: ctx.query.client_id\n      }\n    ]\n  }).then((res) => {\n    if (!res) {\n      return null;\n    }\n    return {\n      ...res,\n      redirectURLs: res.redirectURLs.split(\",\"),\n      metadata: res.metadata ? JSON.parse(res.metadata) : {}\n    };\n  });\n  if (!client) {\n    throw ctx.redirect(`${ctx.context.baseURL}/error?error=invalid_client`);\n  }\n  const redirectURI = client.redirectURLs.find(\n    (url) => url === ctx.query.redirect_uri\n  );\n  if (!redirectURI || !query.redirect_uri) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid redirect URI\"\n    });\n  }\n  if (client.disabled) {\n    throw ctx.redirect(`${ctx.context.baseURL}/error?error=client_disabled`);\n  }\n  if (query.response_type !== \"code\") {\n    throw ctx.redirect(\n      `${ctx.context.baseURL}/error?error=unsupported_response_type`\n    );\n  }\n  const requestScope = query.scope?.split(\" \").filter((s) => s) || opts.defaultScope.split(\" \");\n  const invalidScopes = requestScope.filter((scope) => {\n    const isInvalid = !opts.scopes.includes(scope) || scope === \"offline_access\" && query.prompt !== \"consent\";\n    return isInvalid;\n  });\n  if (invalidScopes.length) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"invalid_scope\",\n        `The following scopes are invalid: ${invalidScopes.join(\", \")}`\n      )\n    );\n  }\n  if ((!query.code_challenge || !query.code_challenge_method) && options.requirePKCE) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"invalid_request\",\n        \"pkce is required\"\n      )\n    );\n  }\n  if (![\n    \"s256\",\n    options.allowPlainCodeChallengeMethod ? \"plain\" : \"s256\"\n  ].includes(query.code_challenge_method?.toLowerCase() || \"\")) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"invalid_request\",\n        \"invalid code_challenge method\"\n      )\n    );\n  }\n  const code = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\", \"0-9\");\n  const codeExpiresInMs = opts.codeExpiresIn * 1e3;\n  const expiresAt = new Date(Date.now() + codeExpiresInMs);\n  try {\n    await ctx.context.internalAdapter.createVerificationValue({\n      value: JSON.stringify({\n        clientId: client.clientId,\n        redirectURI: query.redirect_uri,\n        scope: requestScope,\n        userId: session.user.id,\n        authTime: session.session.createdAt.getTime(),\n        /**\n         * If the prompt is set to `consent`, then we need\n         * to require the user to consent to the scopes.\n         *\n         * This means the code now needs to be treated as a\n         * consent request.\n         *\n         * once the user consents, teh code will be updated\n         * with the actual code. This is to prevent the\n         * client from using the code before the user\n         * consents.\n         */\n        requireConsent: query.prompt === \"consent\",\n        state: query.prompt === \"consent\" ? query.state : null,\n        codeChallenge: query.code_challenge,\n        codeChallengeMethod: query.code_challenge_method,\n        nonce: query.nonce\n      }),\n      identifier: code,\n      expiresAt\n    });\n  } catch (e) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"server_error\",\n        \"An error occurred while processing the request\"\n      )\n    );\n  }\n  const redirectURIWithCode = new URL(redirectURI);\n  redirectURIWithCode.searchParams.set(\"code\", code);\n  redirectURIWithCode.searchParams.set(\"state\", ctx.query.state);\n  if (query.prompt !== \"consent\") {\n    throw ctx.redirect(redirectURIWithCode.toString());\n  }\n  const hasAlreadyConsented = await ctx.context.adapter.findOne({\n    model: \"oauthConsent\",\n    where: [\n      {\n        field: \"clientId\",\n        value: client.clientId\n      },\n      {\n        field: \"userId\",\n        value: session.user.id\n      }\n    ]\n  }).then((res) => !!res?.consentGiven);\n  if (hasAlreadyConsented) {\n    throw ctx.redirect(redirectURIWithCode.toString());\n  }\n  if (options?.consentPage) {\n    await ctx.setSignedCookie(\"oidc_consent_prompt\", code, ctx.context.secret, {\n      maxAge: 600\n    });\n    const conceptURI = `${options.consentPage}?client_id=${client.clientId}&scope=${requestScope.join(\" \")}`;\n    throw ctx.redirect(conceptURI);\n  }\n  const htmlFn = options?.getConsentHTML;\n  if (!htmlFn) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"No consent page provided\"\n    });\n  }\n  return new Response(\n    htmlFn({\n      scopes: requestScope,\n      clientMetadata: client.metadata,\n      clientIcon: client?.icon,\n      clientId: client.clientId,\n      clientName: client.name,\n      code\n    }),\n    {\n      headers: {\n        \"content-type\": \"text/html\"\n      }\n    }\n  );\n}\nvar getMetadata = (ctx, options) => {\n  const issuer = ctx.context.options.baseURL;\n  const baseURL = ctx.context.baseURL;\n  return {\n    issuer,\n    authorization_endpoint: `${baseURL}/oauth2/authorize`,\n    token_endpoint: `${baseURL}/oauth2/token`,\n    userinfo_endpoint: `${baseURL}/oauth2/userinfo`,\n    jwks_uri: `${baseURL}/jwks`,\n    registration_endpoint: `${baseURL}/oauth2/register`,\n    scopes_supported: [\"openid\", \"profile\", \"email\", \"offline_access\"],\n    response_types_supported: [\"code\"],\n    response_modes_supported: [\"query\"],\n    grant_types_supported: [\"authorization_code\"],\n    acr_values_supported: [\n      \"urn:mace:incommon:iap:silver\",\n      \"urn:mace:incommon:iap:bronze\"\n    ],\n    subject_types_supported: [\"public\"],\n    id_token_signing_alg_values_supported: [\"RS256\", \"none\"],\n    token_endpoint_auth_methods_supported: [\n      \"client_secret_basic\",\n      \"client_secret_post\"\n    ],\n    claims_supported: [\n      \"sub\",\n      \"iss\",\n      \"aud\",\n      \"exp\",\n      \"nbf\",\n      \"iat\",\n      \"jti\",\n      \"email\",\n      \"email_verified\",\n      \"name\"\n    ],\n    ...options?.metadata\n  };\n};\nvar oidcProvider = (options) => {\n  const modelName = {\n    oauthClient: \"oauthApplication\",\n    oauthAccessToken: \"oauthAccessToken\",\n    oauthConsent: \"oauthConsent\"\n  };\n  const opts = {\n    codeExpiresIn: 600,\n    defaultScope: \"openid\",\n    accessTokenExpiresIn: 3600,\n    refreshTokenExpiresIn: 604800,\n    ...options,\n    scopes: [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"offline_access\",\n      ...options?.scopes || []\n    ]\n  };\n  return {\n    id: \"oidc\",\n    hooks: {\n      after: [\n        {\n          matcher() {\n            return true;\n          },\n          handler: async (ctx) => {\n            const cookie = await ctx.getSignedCookie(\n              \"oidc_login_prompt\",\n              ctx.context.secret\n            );\n            const cookieName = ctx.context.authCookies.sessionToken.name;\n            const parsedSetCookieHeader = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseSetCookieHeader)(\n              ctx.responseHeader.get(\"set-cookie\") || \"\"\n            );\n            const hasSessionToken = parsedSetCookieHeader.has(cookieName);\n            if (!cookie || !hasSessionToken) {\n              return;\n            }\n            ctx.setCookie(\"oidc_login_prompt\", \"\", {\n              maxAge: 0\n            });\n            const sessionCookie = parsedSetCookieHeader.get(cookieName)?.value;\n            const sessionToken = sessionCookie?.split(\".\")[0];\n            if (!sessionToken) {\n              return;\n            }\n            const session = await ctx.context.internalAdapter.findSession(sessionToken);\n            if (!session) {\n              return;\n            }\n            ctx.query = JSON.parse(cookie);\n            ctx.query.prompt = \"consent\";\n            ctx.context.session = session;\n            const response = await authorize(ctx, opts);\n            return response;\n          }\n        }\n      ]\n    },\n    endpoints: {\n      getOpenIdConfig: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/.well-known/openid-configuration\",\n        {\n          method: \"GET\"\n        },\n        async (ctx) => {\n          const metadata = getMetadata(ctx, options);\n          return ctx.json(metadata);\n        }\n      ),\n      oAuth2authorize: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/authorize\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_3__.z.record(zod__WEBPACK_IMPORTED_MODULE_3__.z.string(), zod__WEBPACK_IMPORTED_MODULE_3__.z.any())\n        },\n        async (ctx) => {\n          return authorize(ctx, opts);\n        }\n      ),\n      oAuthConsent: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/consent\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            accept: zod__WEBPACK_IMPORTED_MODULE_3__.z.boolean()\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware]\n        },\n        async (ctx) => {\n          const storedCode = await ctx.getSignedCookie(\n            \"oidc_consent_prompt\",\n            ctx.context.secret\n          );\n          if (!storedCode) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"No consent prompt found\",\n              error: \"invalid_grant\"\n            });\n          }\n          const verification = await ctx.context.internalAdapter.findVerificationValue(storedCode);\n          if (!verification) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"Invalid code\",\n              error: \"invalid_grant\"\n            });\n          }\n          if (verification.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verification.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"Code expired\",\n              error: \"invalid_grant\"\n            });\n          }\n          const value = JSON.parse(verification.value);\n          if (!value.requireConsent || !value.state) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"Consent not required\",\n              error: \"invalid_grant\"\n            });\n          }\n          if (!ctx.body.accept) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verification.id\n            );\n            return ctx.json({\n              redirectURI: `${value.redirectURI}?error=access_denied&error_description=User denied access`\n            });\n          }\n          const code = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\", \"0-9\");\n          const codeExpiresInMs = opts.codeExpiresIn * 1e3;\n          const expiresAt = new Date(Date.now() + codeExpiresInMs);\n          await ctx.context.internalAdapter.updateVerificationValue(\n            verification.id,\n            {\n              value: JSON.stringify({\n                ...value,\n                requireConsent: false\n              }),\n              identifier: code,\n              expiresAt\n            }\n          );\n          await ctx.context.adapter.create({\n            model: modelName.oauthConsent,\n            data: {\n              clientId: value.clientId,\n              userId: value.userId,\n              scopes: value.scope.join(\" \"),\n              consentGiven: true,\n              createdAt: /* @__PURE__ */ new Date(),\n              updatedAt: /* @__PURE__ */ new Date()\n            }\n          });\n          const redirectURI = new URL(value.redirectURI);\n          redirectURI.searchParams.set(\"code\", code);\n          redirectURI.searchParams.set(\"state\", value.state);\n          return ctx.json({\n            redirectURI: redirectURI.toString()\n          });\n        }\n      ),\n      oAuth2token: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/token\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.any(),\n          metadata: {\n            isAction: false\n          }\n        },\n        async (ctx) => {\n          let { body } = ctx;\n          if (!body) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"request body not found\",\n              error: \"invalid_request\"\n            });\n          }\n          if (body instanceof FormData) {\n            body = Object.fromEntries(body.entries());\n          }\n          if (!(body instanceof Object)) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"request body is not an object\",\n              error: \"invalid_request\"\n            });\n          }\n          const {\n            client_id,\n            client_secret,\n            grant_type,\n            code,\n            redirect_uri,\n            refresh_token,\n            code_verifier\n          } = body;\n          if (grant_type === \"refresh_token\") {\n            if (!refresh_token) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n                error_description: \"refresh_token is required\",\n                error: \"invalid_request\"\n              });\n            }\n            const token = await ctx.context.adapter.findOne({\n              model: modelName.oauthAccessToken,\n              where: [\n                {\n                  field: \"refreshToken\",\n                  value: refresh_token.toString()\n                }\n              ]\n            });\n            if (!token) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n                error_description: \"invalid refresh token\",\n                error: \"invalid_grant\"\n              });\n            }\n            if (token.clientId !== client_id?.toString()) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n                error_description: \"invalid client_id\",\n                error: \"invalid_client\"\n              });\n            }\n            if (token.refreshTokenExpiresAt < /* @__PURE__ */ new Date()) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n                error_description: \"refresh token expired\",\n                error: \"invalid_grant\"\n              });\n            }\n            const accessToken2 = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n            const newRefreshToken = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n            const accessTokenExpiresAt2 = new Date(\n              Date.now() + opts.accessTokenExpiresIn * 1e3\n            );\n            const refreshTokenExpiresAt2 = new Date(\n              Date.now() + opts.refreshTokenExpiresIn * 1e3\n            );\n            await ctx.context.adapter.create({\n              model: modelName.oauthAccessToken,\n              data: {\n                accessToken: accessToken2,\n                refreshToken: newRefreshToken,\n                accessTokenExpiresAt: accessTokenExpiresAt2,\n                refreshTokenExpiresAt: refreshTokenExpiresAt2,\n                clientId: client_id.toString(),\n                userId: token.userId,\n                scopes: token.scopes,\n                createdAt: /* @__PURE__ */ new Date(),\n                updatedAt: /* @__PURE__ */ new Date()\n              }\n            });\n            return ctx.json({\n              access_token: accessToken2,\n              token_type: \"bearer\",\n              expires_in: opts.accessTokenExpiresIn,\n              refresh_token: newRefreshToken,\n              scope: token.scopes\n            });\n          }\n          if (!code) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"code is required\",\n              error: \"invalid_request\"\n            });\n          }\n          if (options.requirePKCE && !code_verifier) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"code verifier is missing\",\n              error: \"invalid_request\"\n            });\n          }\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            code.toString()\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid code\",\n              error: \"invalid_grant\"\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"code expired\",\n              error: \"invalid_grant\"\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          if (!client_id || !client_secret) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"client_id and client_secret are required\",\n              error: \"invalid_client\"\n            });\n          }\n          if (!grant_type) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"grant_type is required\",\n              error: \"invalid_request\"\n            });\n          }\n          if (grant_type !== \"authorization_code\") {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"grant_type must be 'authorization_code'\",\n              error: \"unsupported_grant_type\"\n            });\n          }\n          if (!redirect_uri) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"redirect_uri is required\",\n              error: \"invalid_request\"\n            });\n          }\n          const client = await ctx.context.adapter.findOne({\n            model: modelName.oauthClient,\n            where: [{ field: \"clientId\", value: client_id.toString() }]\n          }).then((res) => {\n            if (!res) {\n              return null;\n            }\n            return {\n              ...res,\n              redirectURLs: res.redirectURLs.split(\",\"),\n              metadata: res.metadata ? JSON.parse(res.metadata) : {}\n            };\n          });\n          if (!client) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid client_id\",\n              error: \"invalid_client\"\n            });\n          }\n          if (client.disabled) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"client is disabled\",\n              error: \"invalid_client\"\n            });\n          }\n          const isValidSecret = client.clientSecret === client_secret.toString();\n          if (!isValidSecret) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid client_secret\",\n              error: \"invalid_client\"\n            });\n          }\n          const value = JSON.parse(\n            verificationValue.value\n          );\n          if (value.clientId !== client_id.toString()) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid client_id\",\n              error: \"invalid_client\"\n            });\n          }\n          if (value.redirectURI !== redirect_uri.toString()) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid redirect_uri\",\n              error: \"invalid_client\"\n            });\n          }\n          if (value.codeChallenge && !code_verifier) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"code verifier is missing\",\n              error: \"invalid_request\"\n            });\n          }\n          const challenge = value.codeChallengeMethod === \"plain\" ? code_verifier : await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_6__.createHash)(\"SHA-256\", \"base64urlnopad\").digest(\n            code_verifier\n          );\n          if (challenge !== value.codeChallenge) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"code verification failed\",\n              error: \"invalid_request\"\n            });\n          }\n          const requestedScopes = value.scope;\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const accessToken = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          const refreshToken = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"A-Z\", \"a-z\");\n          const accessTokenExpiresAt = new Date(\n            Date.now() + opts.accessTokenExpiresIn * 1e3\n          );\n          const refreshTokenExpiresAt = new Date(\n            Date.now() + opts.refreshTokenExpiresIn * 1e3\n          );\n          await ctx.context.adapter.create({\n            model: modelName.oauthAccessToken,\n            data: {\n              accessToken,\n              refreshToken,\n              accessTokenExpiresAt,\n              refreshTokenExpiresAt,\n              clientId: client_id.toString(),\n              userId: value.userId,\n              scopes: requestedScopes.join(\" \"),\n              createdAt: /* @__PURE__ */ new Date(),\n              updatedAt: /* @__PURE__ */ new Date()\n            }\n          });\n          const user = await ctx.context.internalAdapter.findUserById(\n            value.userId\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"user not found\",\n              error: \"invalid_grant\"\n            });\n          }\n          let secretKey = {\n            alg: \"HS256\",\n            key: await _better_auth_utils__WEBPACK_IMPORTED_MODULE_4__.subtle.generateKey(\n              {\n                name: \"HMAC\",\n                hash: \"SHA-256\"\n              },\n              true,\n              [\"sign\", \"verify\"]\n            )\n          };\n          const profile = {\n            given_name: user.name.split(\" \")[0],\n            family_name: user.name.split(\" \")[1],\n            name: user.name,\n            profile: user.image,\n            updated_at: user.updatedAt.toISOString()\n          };\n          const email = {\n            email: user.email,\n            email_verified: user.emailVerified\n          };\n          const userClaims = {\n            ...requestedScopes.includes(\"profile\") ? profile : {},\n            ...requestedScopes.includes(\"email\") ? email : {}\n          };\n          const idToken = await new jose__WEBPACK_IMPORTED_MODULE_7__.SignJWT({\n            sub: user.id,\n            aud: client_id.toString(),\n            iat: Date.now(),\n            auth_time: ctx.context.session?.session.createdAt.getTime(),\n            nonce: value.nonce,\n            acr: \"urn:mace:incommon:iap:silver\",\n            // default to silver - ⚠︎ this should be configurable and should be validated against the client's metadata\n            ...userClaims\n          }).setProtectedHeader({ alg: secretKey.alg }).setIssuedAt().setExpirationTime(\n            Math.floor(Date.now() / 1e3) + opts.accessTokenExpiresIn\n          ).sign(secretKey.key);\n          return ctx.json(\n            {\n              access_token: accessToken,\n              token_type: \"Bearer\",\n              expires_in: opts.accessTokenExpiresIn,\n              refresh_token: requestedScopes.includes(\"offline_access\") ? refreshToken : void 0,\n              scope: requestedScopes.join(\" \"),\n              id_token: requestedScopes.includes(\"openid\") ? idToken : void 0\n            },\n            {\n              headers: {\n                \"Cache-Control\": \"no-store\",\n                Pragma: \"no-cache\"\n              }\n            }\n          );\n        }\n      ),\n      oAuth2userInfo: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/userinfo\",\n        {\n          method: \"GET\",\n          metadata: {\n            isAction: false\n          }\n        },\n        async (ctx) => {\n          if (!ctx.request) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"request not found\",\n              error: \"invalid_request\"\n            });\n          }\n          const authorization = ctx.request.headers.get(\"authorization\");\n          if (!authorization) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"authorization header not found\",\n              error: \"invalid_request\"\n            });\n          }\n          const token = authorization.replace(\"Bearer \", \"\");\n          const accessToken = await ctx.context.adapter.findOne({\n            model: modelName.oauthAccessToken,\n            where: [\n              {\n                field: \"accessToken\",\n                value: token\n              }\n            ]\n          });\n          if (!accessToken) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid access token\",\n              error: \"invalid_token\"\n            });\n          }\n          if (accessToken.accessTokenExpiresAt < /* @__PURE__ */ new Date()) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"The Access Token expired\",\n              error: \"invalid_token\"\n            });\n          }\n          const user = await ctx.context.internalAdapter.findUserById(\n            accessToken.userId\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"user not found\",\n              error: \"invalid_token\"\n            });\n          }\n          const requestedScopes = accessToken.scopes.split(\" \");\n          const userClaims = {\n            sub: user.id,\n            email: requestedScopes.includes(\"email\") ? user.email : void 0,\n            name: requestedScopes.includes(\"profile\") ? user.name : void 0,\n            picture: requestedScopes.includes(\"profile\") ? user.image : void 0,\n            given_name: requestedScopes.includes(\"profile\") ? user.name.split(\" \")[0] : void 0,\n            family_name: requestedScopes.includes(\"profile\") ? user.name.split(\" \")[1] : void 0,\n            email_verified: requestedScopes.includes(\"email\") ? user.emailVerified : void 0\n          };\n          return ctx.json(userClaims);\n        }\n      ),\n      registerOAuthApplication: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/register\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            name: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n            icon: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().optional(),\n            metadata: zod__WEBPACK_IMPORTED_MODULE_3__.z.record(zod__WEBPACK_IMPORTED_MODULE_3__.z.any()).optional(),\n            redirectURLs: zod__WEBPACK_IMPORTED_MODULE_3__.z.array(zod__WEBPACK_IMPORTED_MODULE_3__.z.string())\n          })\n        },\n        async (ctx) => {\n          const body = ctx.body;\n          const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n          if (!session && !options.allowDynamicClientRegistration) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: \"Unauthorized\"\n            });\n          }\n          const clientId = options.generateClientId?.() || (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          const clientSecret = options.generateClientSecret?.() || (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          const client = await ctx.context.adapter.create({\n            model: modelName.oauthClient,\n            data: {\n              name: body.name,\n              icon: body.icon,\n              metadata: body.metadata ? JSON.stringify(body.metadata) : null,\n              clientId,\n              clientSecret,\n              redirectURLs: body.redirectURLs.join(\",\"),\n              type: \"web\",\n              authenticationScheme: \"client_secret\",\n              disabled: false,\n              userId: session?.session.userId,\n              createdAt: /* @__PURE__ */ new Date(),\n              updatedAt: /* @__PURE__ */ new Date()\n            }\n          });\n          return ctx.json({\n            ...client,\n            redirectURLs: client.redirectURLs.split(\",\"),\n            metadata: client.metadata ? JSON.parse(client.metadata) : null\n          });\n        }\n      ),\n      getOAuthClient: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/client/:id\",\n        {\n          method: \"GET\",\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware]\n        },\n        async (ctx) => {\n          const client = await ctx.context.adapter.findOne(\n            {\n              model: modelName.oauthClient,\n              where: [{ field: \"clientId\", value: ctx.params.id }]\n            }\n          );\n          if (!client) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"NOT_FOUND\", {\n              error_description: \"client not found\",\n              error: \"not_found\"\n            });\n          }\n          return ctx.json({\n            clientId: client.clientId,\n            name: client.name,\n            icon: client.icon\n          });\n        }\n      )\n    },\n    schema\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstS1lEWjRCRTIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQXlHO0FBQzlDO0FBQ0E7QUFDNUI7QUFDUDtBQUNvQjtBQUNTO0FBQ0E7O0FBRXJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDhCQUE4QixRQUFRLE1BQU0scUJBQXFCLFlBQVk7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpREFBVTtBQUN4QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0JBQXdCLHFFQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixrQkFBa0IsR0FBRyxhQUFhO0FBQzVEO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixvQkFBb0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLG9CQUFvQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsMEJBQTBCLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpREFBVTtBQUN4QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsMEJBQTBCLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQSxTQUFTLG9CQUFvQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2Qyx5QkFBeUI7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx3RUFBb0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsMEJBQTBCLG9CQUFvQixhQUFhLGdCQUFnQixTQUFTLHVCQUF1QjtBQUMzRztBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaURBQVU7QUFDeEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixRQUFRO0FBQ3ZDLHVCQUF1QixRQUFRO0FBQy9CLDBCQUEwQixRQUFRO0FBQ2xDLGlCQUFpQixRQUFRO0FBQ3pCLDhCQUE4QixRQUFRO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHdFQUFvQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSx1QkFBdUIsc0VBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSxpQkFBaUIseUNBQVEsQ0FBQyx5Q0FBUSxJQUFJLHNDQUFLO0FBQzNDLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzRUFBa0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLG9CQUFvQiwwQ0FBUztBQUM3QixXQUFXO0FBQ1gsZ0JBQWdCLGlFQUFpQjtBQUNqQyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixrQkFBa0I7QUFDaEQsYUFBYTtBQUNiO0FBQ0EsdUJBQXVCLHdFQUFvQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsbUJBQW1CLHNFQUFrQjtBQUNyQztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isc0NBQUs7QUFDckI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsZ0JBQWdCLE9BQU87QUFDdkI7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSx3QkFBd0Isd0RBQVE7QUFDaEM7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSx3QkFBd0Isd0RBQVE7QUFDaEM7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0Esd0JBQXdCLHdEQUFRO0FBQ2hDO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLHdCQUF3Qix3REFBUTtBQUNoQztBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0EsaUNBQWlDLHdFQUFvQjtBQUNyRCxvQ0FBb0Msd0VBQW9CO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixnREFBZ0Q7QUFDdEUsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSwwRkFBMEYsbUVBQVU7QUFDcEc7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix3RUFBb0I7QUFDbEQsK0JBQStCLHdFQUFvQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzREFBTTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUU7QUFDakU7QUFDQTtBQUNBLG9DQUFvQyx5Q0FBTztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx1QkFBdUIsb0JBQW9CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixzRUFBa0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxzRUFBa0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLGtCQUFrQix5Q0FBUTtBQUMxQixrQkFBa0IseUNBQVE7QUFDMUIsc0JBQXNCLHlDQUFRLENBQUMsc0NBQUs7QUFDcEMsMEJBQTBCLHdDQUFPLENBQUMseUNBQVE7QUFDMUMsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZ0NBQWdDLHFFQUFpQjtBQUNqRDtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBLDJEQUEyRCx3RUFBb0I7QUFDL0UsbUVBQW1FLHdFQUFvQjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0Esc0JBQXNCLHNFQUFrQjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUVBQWlCO0FBQ2pDLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5Q0FBeUM7QUFDakU7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFd0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1LWURaNEJFMi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIHNlc3Npb25NaWRkbGV3YXJlLCBBUElFcnJvciwgZ2V0U2Vzc2lvbkZyb21DdHggfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHBhcnNlU2V0Q29va2llSGVhZGVyIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZVJhbmRvbVN0cmluZyB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0IHsgU2lnbkpXVCB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBzdWJ0bGUgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMnO1xuaW1wb3J0IHsgQVBJRXJyb3IgYXMgQVBJRXJyb3IkMSB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5cbi8vIHNyYy9wbHVnaW5zL29pZGMtcHJvdmlkZXIvc2NoZW1hLnRzXG52YXIgc2NoZW1hID0ge1xuICBvYXV0aEFwcGxpY2F0aW9uOiB7XG4gICAgbW9kZWxOYW1lOiBcIm9hdXRoQXBwbGljYXRpb25cIixcbiAgICBmaWVsZHM6IHtcbiAgICAgIG5hbWU6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgfSxcbiAgICAgIGljb246IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgY2xpZW50SWQ6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgdW5pcXVlOiB0cnVlXG4gICAgICB9LFxuICAgICAgY2xpZW50U2VjcmV0OiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICByZWRpcmVjdFVSTHM6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgfSxcbiAgICAgIHR5cGU6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgfSxcbiAgICAgIGRpc2FibGVkOiB7XG4gICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZmFsc2VcbiAgICAgIH0sXG4gICAgICB1c2VySWQ6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgIHR5cGU6IFwiZGF0ZVwiXG4gICAgICB9LFxuICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgIHR5cGU6IFwiZGF0ZVwiXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBvYXV0aEFjY2Vzc1Rva2VuOiB7XG4gICAgbW9kZWxOYW1lOiBcIm9hdXRoQWNjZXNzVG9rZW5cIixcbiAgICBmaWVsZHM6IHtcbiAgICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgfSxcbiAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICB1bmlxdWU6IHRydWVcbiAgICAgIH0sXG4gICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIlxuICAgICAgfSxcbiAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIlxuICAgICAgfSxcbiAgICAgIGNsaWVudElkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICB1c2VySWQ6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgc2NvcGVzOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCJcbiAgICAgIH0sXG4gICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCJcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIG9hdXRoQ29uc2VudDoge1xuICAgIG1vZGVsTmFtZTogXCJvYXV0aENvbnNlbnRcIixcbiAgICBmaWVsZHM6IHtcbiAgICAgIGNsaWVudElkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICB1c2VySWQ6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgfSxcbiAgICAgIHNjb3Blczoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICB9LFxuICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgIHR5cGU6IFwiZGF0ZVwiXG4gICAgICB9LFxuICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgIHR5cGU6IFwiZGF0ZVwiXG4gICAgICB9LFxuICAgICAgY29uc2VudEdpdmVuOiB7XG4gICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuZnVuY3Rpb24gcmVkaXJlY3RFcnJvclVSTCh1cmwsIGVycm9yLCBkZXNjcmlwdGlvbikge1xuICByZXR1cm4gYCR7dXJsLmluY2x1ZGVzKFwiP1wiKSA/IFwiJlwiIDogXCI/XCJ9ZXJyb3I9JHtlcnJvcn0mZXJyb3JfZGVzY3JpcHRpb249JHtkZXNjcmlwdGlvbn1gO1xufVxuYXN5bmMgZnVuY3Rpb24gYXV0aG9yaXplKGN0eCwgb3B0aW9ucykge1xuICBjb25zdCBvcHRzID0ge1xuICAgIGNvZGVFeHBpcmVzSW46IDYwMCxcbiAgICBkZWZhdWx0U2NvcGU6IFwib3BlbmlkXCIsXG4gICAgLi4ub3B0aW9ucyxcbiAgICBzY29wZXM6IFtcbiAgICAgIFwib3BlbmlkXCIsXG4gICAgICBcInByb2ZpbGVcIixcbiAgICAgIFwiZW1haWxcIixcbiAgICAgIFwib2ZmbGluZV9hY2Nlc3NcIixcbiAgICAgIC4uLm9wdGlvbnM/LnNjb3BlcyB8fCBbXVxuICAgIF1cbiAgfTtcbiAgaWYgKCFjdHgucmVxdWVzdCkge1xuICAgIHRocm93IG5ldyBBUElFcnJvciQxKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcInJlcXVlc3Qgbm90IGZvdW5kXCIsXG4gICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24pIHtcbiAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgICAgXCJvaWRjX2xvZ2luX3Byb21wdFwiLFxuICAgICAgSlNPTi5zdHJpbmdpZnkoY3R4LnF1ZXJ5KSxcbiAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgIHtcbiAgICAgICAgbWF4QWdlOiA2MDBcbiAgICAgIH1cbiAgICApO1xuICAgIGNvbnN0IHF1ZXJ5RnJvbVVSTCA9IGN0eC5yZXF1ZXN0LnVybD8uc3BsaXQoXCI/XCIpWzFdO1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtvcHRpb25zLmxvZ2luUGFnZX0/JHtxdWVyeUZyb21VUkx9YCk7XG4gIH1cbiAgY29uc3QgcXVlcnkgPSBjdHgucXVlcnk7XG4gIGlmICghcXVlcnkuY2xpZW50X2lkKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPWludmFsaWRfY2xpZW50YCk7XG4gIH1cbiAgaWYgKCFxdWVyeS5yZXNwb25zZV90eXBlKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgcmVkaXJlY3RFcnJvclVSTChcbiAgICAgICAgYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgLFxuICAgICAgICBcImludmFsaWRfcmVxdWVzdFwiLFxuICAgICAgICBcInJlc3BvbnNlX3R5cGUgaXMgcmVxdWlyZWRcIlxuICAgICAgKVxuICAgICk7XG4gIH1cbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICBtb2RlbDogXCJvYXV0aEFwcGxpY2F0aW9uXCIsXG4gICAgd2hlcmU6IFtcbiAgICAgIHtcbiAgICAgICAgZmllbGQ6IFwiY2xpZW50SWRcIixcbiAgICAgICAgdmFsdWU6IGN0eC5xdWVyeS5jbGllbnRfaWRcbiAgICAgIH1cbiAgICBdXG4gIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgIGlmICghcmVzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnJlcyxcbiAgICAgIHJlZGlyZWN0VVJMczogcmVzLnJlZGlyZWN0VVJMcy5zcGxpdChcIixcIiksXG4gICAgICBtZXRhZGF0YTogcmVzLm1ldGFkYXRhID8gSlNPTi5wYXJzZShyZXMubWV0YWRhdGEpIDoge31cbiAgICB9O1xuICB9KTtcbiAgaWYgKCFjbGllbnQpIHtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9aW52YWxpZF9jbGllbnRgKTtcbiAgfVxuICBjb25zdCByZWRpcmVjdFVSSSA9IGNsaWVudC5yZWRpcmVjdFVSTHMuZmluZChcbiAgICAodXJsKSA9PiB1cmwgPT09IGN0eC5xdWVyeS5yZWRpcmVjdF91cmlcbiAgKTtcbiAgaWYgKCFyZWRpcmVjdFVSSSB8fCAhcXVlcnkucmVkaXJlY3RfdXJpKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yJDEoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIkludmFsaWQgcmVkaXJlY3QgVVJJXCJcbiAgICB9KTtcbiAgfVxuICBpZiAoY2xpZW50LmRpc2FibGVkKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPWNsaWVudF9kaXNhYmxlZGApO1xuICB9XG4gIGlmIChxdWVyeS5yZXNwb25zZV90eXBlICE9PSBcImNvZGVcIikge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgIGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPXVuc3VwcG9ydGVkX3Jlc3BvbnNlX3R5cGVgXG4gICAgKTtcbiAgfVxuICBjb25zdCByZXF1ZXN0U2NvcGUgPSBxdWVyeS5zY29wZT8uc3BsaXQoXCIgXCIpLmZpbHRlcigocykgPT4gcykgfHwgb3B0cy5kZWZhdWx0U2NvcGUuc3BsaXQoXCIgXCIpO1xuICBjb25zdCBpbnZhbGlkU2NvcGVzID0gcmVxdWVzdFNjb3BlLmZpbHRlcigoc2NvcGUpID0+IHtcbiAgICBjb25zdCBpc0ludmFsaWQgPSAhb3B0cy5zY29wZXMuaW5jbHVkZXMoc2NvcGUpIHx8IHNjb3BlID09PSBcIm9mZmxpbmVfYWNjZXNzXCIgJiYgcXVlcnkucHJvbXB0ICE9PSBcImNvbnNlbnRcIjtcbiAgICByZXR1cm4gaXNJbnZhbGlkO1xuICB9KTtcbiAgaWYgKGludmFsaWRTY29wZXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgcmVkaXJlY3RFcnJvclVSTChcbiAgICAgICAgcXVlcnkucmVkaXJlY3RfdXJpLFxuICAgICAgICBcImludmFsaWRfc2NvcGVcIixcbiAgICAgICAgYFRoZSBmb2xsb3dpbmcgc2NvcGVzIGFyZSBpbnZhbGlkOiAke2ludmFsaWRTY29wZXMuam9pbihcIiwgXCIpfWBcbiAgICAgIClcbiAgICApO1xuICB9XG4gIGlmICgoIXF1ZXJ5LmNvZGVfY2hhbGxlbmdlIHx8ICFxdWVyeS5jb2RlX2NoYWxsZW5nZV9tZXRob2QpICYmIG9wdGlvbnMucmVxdWlyZVBLQ0UpIHtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICByZWRpcmVjdEVycm9yVVJMKFxuICAgICAgICBxdWVyeS5yZWRpcmVjdF91cmksXG4gICAgICAgIFwiaW52YWxpZF9yZXF1ZXN0XCIsXG4gICAgICAgIFwicGtjZSBpcyByZXF1aXJlZFwiXG4gICAgICApXG4gICAgKTtcbiAgfVxuICBpZiAoIVtcbiAgICBcInMyNTZcIixcbiAgICBvcHRpb25zLmFsbG93UGxhaW5Db2RlQ2hhbGxlbmdlTWV0aG9kID8gXCJwbGFpblwiIDogXCJzMjU2XCJcbiAgXS5pbmNsdWRlcyhxdWVyeS5jb2RlX2NoYWxsZW5nZV9tZXRob2Q/LnRvTG93ZXJDYXNlKCkgfHwgXCJcIikpIHtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICByZWRpcmVjdEVycm9yVVJMKFxuICAgICAgICBxdWVyeS5yZWRpcmVjdF91cmksXG4gICAgICAgIFwiaW52YWxpZF9yZXF1ZXN0XCIsXG4gICAgICAgIFwiaW52YWxpZCBjb2RlX2NoYWxsZW5nZSBtZXRob2RcIlxuICAgICAgKVxuICAgICk7XG4gIH1cbiAgY29uc3QgY29kZSA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcImEtelwiLCBcIkEtWlwiLCBcIjAtOVwiKTtcbiAgY29uc3QgY29kZUV4cGlyZXNJbk1zID0gb3B0cy5jb2RlRXhwaXJlc0luICogMWUzO1xuICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgY29kZUV4cGlyZXNJbk1zKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgICAgdmFsdWU6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgY2xpZW50SWQ6IGNsaWVudC5jbGllbnRJZCxcbiAgICAgICAgcmVkaXJlY3RVUkk6IHF1ZXJ5LnJlZGlyZWN0X3VyaSxcbiAgICAgICAgc2NvcGU6IHJlcXVlc3RTY29wZSxcbiAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIGF1dGhUaW1lOiBzZXNzaW9uLnNlc3Npb24uY3JlYXRlZEF0LmdldFRpbWUoKSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRoZSBwcm9tcHQgaXMgc2V0IHRvIGBjb25zZW50YCwgdGhlbiB3ZSBuZWVkXG4gICAgICAgICAqIHRvIHJlcXVpcmUgdGhlIHVzZXIgdG8gY29uc2VudCB0byB0aGUgc2NvcGVzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGlzIG1lYW5zIHRoZSBjb2RlIG5vdyBuZWVkcyB0byBiZSB0cmVhdGVkIGFzIGFcbiAgICAgICAgICogY29uc2VudCByZXF1ZXN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBvbmNlIHRoZSB1c2VyIGNvbnNlbnRzLCB0ZWggY29kZSB3aWxsIGJlIHVwZGF0ZWRcbiAgICAgICAgICogd2l0aCB0aGUgYWN0dWFsIGNvZGUuIFRoaXMgaXMgdG8gcHJldmVudCB0aGVcbiAgICAgICAgICogY2xpZW50IGZyb20gdXNpbmcgdGhlIGNvZGUgYmVmb3JlIHRoZSB1c2VyXG4gICAgICAgICAqIGNvbnNlbnRzLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVxdWlyZUNvbnNlbnQ6IHF1ZXJ5LnByb21wdCA9PT0gXCJjb25zZW50XCIsXG4gICAgICAgIHN0YXRlOiBxdWVyeS5wcm9tcHQgPT09IFwiY29uc2VudFwiID8gcXVlcnkuc3RhdGUgOiBudWxsLFxuICAgICAgICBjb2RlQ2hhbGxlbmdlOiBxdWVyeS5jb2RlX2NoYWxsZW5nZSxcbiAgICAgICAgY29kZUNoYWxsZW5nZU1ldGhvZDogcXVlcnkuY29kZV9jaGFsbGVuZ2VfbWV0aG9kLFxuICAgICAgICBub25jZTogcXVlcnkubm9uY2VcbiAgICAgIH0pLFxuICAgICAgaWRlbnRpZmllcjogY29kZSxcbiAgICAgIGV4cGlyZXNBdFxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgcmVkaXJlY3RFcnJvclVSTChcbiAgICAgICAgcXVlcnkucmVkaXJlY3RfdXJpLFxuICAgICAgICBcInNlcnZlcl9lcnJvclwiLFxuICAgICAgICBcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgdGhlIHJlcXVlc3RcIlxuICAgICAgKVxuICAgICk7XG4gIH1cbiAgY29uc3QgcmVkaXJlY3RVUklXaXRoQ29kZSA9IG5ldyBVUkwocmVkaXJlY3RVUkkpO1xuICByZWRpcmVjdFVSSVdpdGhDb2RlLnNlYXJjaFBhcmFtcy5zZXQoXCJjb2RlXCIsIGNvZGUpO1xuICByZWRpcmVjdFVSSVdpdGhDb2RlLnNlYXJjaFBhcmFtcy5zZXQoXCJzdGF0ZVwiLCBjdHgucXVlcnkuc3RhdGUpO1xuICBpZiAocXVlcnkucHJvbXB0ICE9PSBcImNvbnNlbnRcIikge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChyZWRpcmVjdFVSSVdpdGhDb2RlLnRvU3RyaW5nKCkpO1xuICB9XG4gIGNvbnN0IGhhc0FscmVhZHlDb25zZW50ZWQgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgIG1vZGVsOiBcIm9hdXRoQ29uc2VudFwiLFxuICAgIHdoZXJlOiBbXG4gICAgICB7XG4gICAgICAgIGZpZWxkOiBcImNsaWVudElkXCIsXG4gICAgICAgIHZhbHVlOiBjbGllbnQuY2xpZW50SWRcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICB2YWx1ZTogc2Vzc2lvbi51c2VyLmlkXG4gICAgICB9XG4gICAgXVxuICB9KS50aGVuKChyZXMpID0+ICEhcmVzPy5jb25zZW50R2l2ZW4pO1xuICBpZiAoaGFzQWxyZWFkeUNvbnNlbnRlZCkge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChyZWRpcmVjdFVSSVdpdGhDb2RlLnRvU3RyaW5nKCkpO1xuICB9XG4gIGlmIChvcHRpb25zPy5jb25zZW50UGFnZSkge1xuICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXCJvaWRjX2NvbnNlbnRfcHJvbXB0XCIsIGNvZGUsIGN0eC5jb250ZXh0LnNlY3JldCwge1xuICAgICAgbWF4QWdlOiA2MDBcbiAgICB9KTtcbiAgICBjb25zdCBjb25jZXB0VVJJID0gYCR7b3B0aW9ucy5jb25zZW50UGFnZX0/Y2xpZW50X2lkPSR7Y2xpZW50LmNsaWVudElkfSZzY29wZT0ke3JlcXVlc3RTY29wZS5qb2luKFwiIFwiKX1gO1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChjb25jZXB0VVJJKTtcbiAgfVxuICBjb25zdCBodG1sRm4gPSBvcHRpb25zPy5nZXRDb25zZW50SFRNTDtcbiAgaWYgKCFodG1sRm4pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IkMShcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICBtZXNzYWdlOiBcIk5vIGNvbnNlbnQgcGFnZSBwcm92aWRlZFwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICBodG1sRm4oe1xuICAgICAgc2NvcGVzOiByZXF1ZXN0U2NvcGUsXG4gICAgICBjbGllbnRNZXRhZGF0YTogY2xpZW50Lm1ldGFkYXRhLFxuICAgICAgY2xpZW50SWNvbjogY2xpZW50Py5pY29uLFxuICAgICAgY2xpZW50SWQ6IGNsaWVudC5jbGllbnRJZCxcbiAgICAgIGNsaWVudE5hbWU6IGNsaWVudC5uYW1lLFxuICAgICAgY29kZVxuICAgIH0pLFxuICAgIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJ0ZXh0L2h0bWxcIlxuICAgICAgfVxuICAgIH1cbiAgKTtcbn1cbnZhciBnZXRNZXRhZGF0YSA9IChjdHgsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgaXNzdWVyID0gY3R4LmNvbnRleHQub3B0aW9ucy5iYXNlVVJMO1xuICBjb25zdCBiYXNlVVJMID0gY3R4LmNvbnRleHQuYmFzZVVSTDtcbiAgcmV0dXJuIHtcbiAgICBpc3N1ZXIsXG4gICAgYXV0aG9yaXphdGlvbl9lbmRwb2ludDogYCR7YmFzZVVSTH0vb2F1dGgyL2F1dGhvcml6ZWAsXG4gICAgdG9rZW5fZW5kcG9pbnQ6IGAke2Jhc2VVUkx9L29hdXRoMi90b2tlbmAsXG4gICAgdXNlcmluZm9fZW5kcG9pbnQ6IGAke2Jhc2VVUkx9L29hdXRoMi91c2VyaW5mb2AsXG4gICAgandrc191cmk6IGAke2Jhc2VVUkx9L2p3a3NgLFxuICAgIHJlZ2lzdHJhdGlvbl9lbmRwb2ludDogYCR7YmFzZVVSTH0vb2F1dGgyL3JlZ2lzdGVyYCxcbiAgICBzY29wZXNfc3VwcG9ydGVkOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIiwgXCJvZmZsaW5lX2FjY2Vzc1wiXSxcbiAgICByZXNwb25zZV90eXBlc19zdXBwb3J0ZWQ6IFtcImNvZGVcIl0sXG4gICAgcmVzcG9uc2VfbW9kZXNfc3VwcG9ydGVkOiBbXCJxdWVyeVwiXSxcbiAgICBncmFudF90eXBlc19zdXBwb3J0ZWQ6IFtcImF1dGhvcml6YXRpb25fY29kZVwiXSxcbiAgICBhY3JfdmFsdWVzX3N1cHBvcnRlZDogW1xuICAgICAgXCJ1cm46bWFjZTppbmNvbW1vbjppYXA6c2lsdmVyXCIsXG4gICAgICBcInVybjptYWNlOmluY29tbW9uOmlhcDpicm9uemVcIlxuICAgIF0sXG4gICAgc3ViamVjdF90eXBlc19zdXBwb3J0ZWQ6IFtcInB1YmxpY1wiXSxcbiAgICBpZF90b2tlbl9zaWduaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkOiBbXCJSUzI1NlwiLCBcIm5vbmVcIl0sXG4gICAgdG9rZW5fZW5kcG9pbnRfYXV0aF9tZXRob2RzX3N1cHBvcnRlZDogW1xuICAgICAgXCJjbGllbnRfc2VjcmV0X2Jhc2ljXCIsXG4gICAgICBcImNsaWVudF9zZWNyZXRfcG9zdFwiXG4gICAgXSxcbiAgICBjbGFpbXNfc3VwcG9ydGVkOiBbXG4gICAgICBcInN1YlwiLFxuICAgICAgXCJpc3NcIixcbiAgICAgIFwiYXVkXCIsXG4gICAgICBcImV4cFwiLFxuICAgICAgXCJuYmZcIixcbiAgICAgIFwiaWF0XCIsXG4gICAgICBcImp0aVwiLFxuICAgICAgXCJlbWFpbFwiLFxuICAgICAgXCJlbWFpbF92ZXJpZmllZFwiLFxuICAgICAgXCJuYW1lXCJcbiAgICBdLFxuICAgIC4uLm9wdGlvbnM/Lm1ldGFkYXRhXG4gIH07XG59O1xudmFyIG9pZGNQcm92aWRlciA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG1vZGVsTmFtZSA9IHtcbiAgICBvYXV0aENsaWVudDogXCJvYXV0aEFwcGxpY2F0aW9uXCIsXG4gICAgb2F1dGhBY2Nlc3NUb2tlbjogXCJvYXV0aEFjY2Vzc1Rva2VuXCIsXG4gICAgb2F1dGhDb25zZW50OiBcIm9hdXRoQ29uc2VudFwiXG4gIH07XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgY29kZUV4cGlyZXNJbjogNjAwLFxuICAgIGRlZmF1bHRTY29wZTogXCJvcGVuaWRcIixcbiAgICBhY2Nlc3NUb2tlbkV4cGlyZXNJbjogMzYwMCxcbiAgICByZWZyZXNoVG9rZW5FeHBpcmVzSW46IDYwNDgwMCxcbiAgICAuLi5vcHRpb25zLFxuICAgIHNjb3BlczogW1xuICAgICAgXCJvcGVuaWRcIixcbiAgICAgIFwicHJvZmlsZVwiLFxuICAgICAgXCJlbWFpbFwiLFxuICAgICAgXCJvZmZsaW5lX2FjY2Vzc1wiLFxuICAgICAgLi4ub3B0aW9ucz8uc2NvcGVzIHx8IFtdXG4gICAgXVxuICB9O1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm9pZGNcIixcbiAgICBob29rczoge1xuICAgICAgYWZ0ZXI6IFtcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGhhbmRsZXI6IGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICAgIFwib2lkY19sb2dpbl9wcm9tcHRcIixcbiAgICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgY29va2llTmFtZSA9IGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lO1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkU2V0Q29va2llSGVhZGVyID0gcGFyc2VTZXRDb29raWVIZWFkZXIoXG4gICAgICAgICAgICAgIGN0eC5yZXNwb25zZUhlYWRlci5nZXQoXCJzZXQtY29va2llXCIpIHx8IFwiXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBoYXNTZXNzaW9uVG9rZW4gPSBwYXJzZWRTZXRDb29raWVIZWFkZXIuaGFzKGNvb2tpZU5hbWUpO1xuICAgICAgICAgICAgaWYgKCFjb29raWUgfHwgIWhhc1Nlc3Npb25Ub2tlbikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdHguc2V0Q29va2llKFwib2lkY19sb2dpbl9wcm9tcHRcIiwgXCJcIiwge1xuICAgICAgICAgICAgICBtYXhBZ2U6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IHBhcnNlZFNldENvb2tpZUhlYWRlci5nZXQoY29va2llTmFtZSk/LnZhbHVlO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvblRva2VuID0gc2Vzc2lvbkNvb2tpZT8uc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICAgICAgaWYgKCFzZXNzaW9uVG9rZW4pIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbihzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5xdWVyeSA9IEpTT04ucGFyc2UoY29va2llKTtcbiAgICAgICAgICAgIGN0eC5xdWVyeS5wcm9tcHQgPSBcImNvbnNlbnRcIjtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhdXRob3JpemUoY3R4LCBvcHRzKTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9LFxuICAgIGVuZHBvaW50czoge1xuICAgICAgZ2V0T3BlbklkQ29uZmlnOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiLy53ZWxsLWtub3duL29wZW5pZC1jb25maWd1cmF0aW9uXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZ2V0TWV0YWRhdGEoY3R4LCBvcHRpb25zKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obWV0YWRhdGEpO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgb0F1dGgyYXV0aG9yaXplOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL29hdXRoMi9hdXRob3JpemVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBxdWVyeTogei5yZWNvcmQoei5zdHJpbmcoKSwgei5hbnkoKSlcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIHJldHVybiBhdXRob3JpemUoY3R4LCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIG9BdXRoQ29uc2VudDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvY29uc2VudFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBhY2NlcHQ6IHouYm9vbGVhbigpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBzdG9yZWRDb2RlID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgIFwib2lkY19jb25zZW50X3Byb21wdFwiLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXN0b3JlZENvZGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcIk5vIGNvbnNlbnQgcHJvbXB0IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfZ3JhbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoc3RvcmVkQ29kZSk7XG4gICAgICAgICAgaWYgKCF2ZXJpZmljYXRpb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcIkludmFsaWQgY29kZVwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvbi5pZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcIkNvZGUgZXhwaXJlZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IEpTT04ucGFyc2UodmVyaWZpY2F0aW9uLnZhbHVlKTtcbiAgICAgICAgICBpZiAoIXZhbHVlLnJlcXVpcmVDb25zZW50IHx8ICF2YWx1ZS5zdGF0ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiQ29uc2VudCBub3QgcmVxdWlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9ncmFudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjdHguYm9keS5hY2NlcHQpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgICAgdmVyaWZpY2F0aW9uLmlkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgcmVkaXJlY3RVUkk6IGAke3ZhbHVlLnJlZGlyZWN0VVJJfT9lcnJvcj1hY2Nlc3NfZGVuaWVkJmVycm9yX2Rlc2NyaXB0aW9uPVVzZXIgZGVuaWVkIGFjY2Vzc2BcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjb2RlID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIsIFwiYS16XCIsIFwiQS1aXCIsIFwiMC05XCIpO1xuICAgICAgICAgIGNvbnN0IGNvZGVFeHBpcmVzSW5NcyA9IG9wdHMuY29kZUV4cGlyZXNJbiAqIDFlMztcbiAgICAgICAgICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgY29kZUV4cGlyZXNJbk1zKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICB2ZXJpZmljYXRpb24uaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHZhbHVlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgcmVxdWlyZUNvbnNlbnQ6IGZhbHNlXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBpZGVudGlmaWVyOiBjb2RlLFxuICAgICAgICAgICAgICBleHBpcmVzQXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUub2F1dGhDb25zZW50LFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBjbGllbnRJZDogdmFsdWUuY2xpZW50SWQsXG4gICAgICAgICAgICAgIHVzZXJJZDogdmFsdWUudXNlcklkLFxuICAgICAgICAgICAgICBzY29wZXM6IHZhbHVlLnNjb3BlLmpvaW4oXCIgXCIpLFxuICAgICAgICAgICAgICBjb25zZW50R2l2ZW46IHRydWUsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCByZWRpcmVjdFVSSSA9IG5ldyBVUkwodmFsdWUucmVkaXJlY3RVUkkpO1xuICAgICAgICAgIHJlZGlyZWN0VVJJLnNlYXJjaFBhcmFtcy5zZXQoXCJjb2RlXCIsIGNvZGUpO1xuICAgICAgICAgIHJlZGlyZWN0VVJJLnNlYXJjaFBhcmFtcy5zZXQoXCJzdGF0ZVwiLCB2YWx1ZS5zdGF0ZSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VVJJOiByZWRpcmVjdFVSSS50b1N0cmluZygpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBvQXV0aDJ0b2tlbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvdG9rZW5cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5hbnkoKSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgaXNBY3Rpb246IGZhbHNlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgbGV0IHsgYm9keSB9ID0gY3R4O1xuICAgICAgICAgIGlmICghYm9keSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJyZXF1ZXN0IGJvZHkgbm90IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgYm9keSA9IE9iamVjdC5mcm9tRW50cmllcyhib2R5LmVudHJpZXMoKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghKGJvZHkgaW5zdGFuY2VvZiBPYmplY3QpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcInJlcXVlc3QgYm9keSBpcyBub3QgYW4gb2JqZWN0XCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2xpZW50X2lkLFxuICAgICAgICAgICAgY2xpZW50X3NlY3JldCxcbiAgICAgICAgICAgIGdyYW50X3R5cGUsXG4gICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgcmVkaXJlY3RfdXJpLFxuICAgICAgICAgICAgcmVmcmVzaF90b2tlbixcbiAgICAgICAgICAgIGNvZGVfdmVyaWZpZXJcbiAgICAgICAgICB9ID0gYm9keTtcbiAgICAgICAgICBpZiAoZ3JhbnRfdHlwZSA9PT0gXCJyZWZyZXNoX3Rva2VuXCIpIHtcbiAgICAgICAgICAgIGlmICghcmVmcmVzaF90b2tlbikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwicmVmcmVzaF90b2tlbiBpcyByZXF1aXJlZFwiLFxuICAgICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgICBtb2RlbDogbW9kZWxOYW1lLm9hdXRoQWNjZXNzVG9rZW4sXG4gICAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgZmllbGQ6IFwicmVmcmVzaFRva2VuXCIsXG4gICAgICAgICAgICAgICAgICB2YWx1ZTogcmVmcmVzaF90b2tlbi50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJpbnZhbGlkIHJlZnJlc2ggdG9rZW5cIixcbiAgICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodG9rZW4uY2xpZW50SWQgIT09IGNsaWVudF9pZD8udG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImludmFsaWQgY2xpZW50X2lkXCIsXG4gICAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9jbGllbnRcIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0b2tlbi5yZWZyZXNoVG9rZW5FeHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcInJlZnJlc2ggdG9rZW4gZXhwaXJlZFwiLFxuICAgICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfZ3JhbnRcIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuMiA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcImEtelwiLCBcIkEtWlwiKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JlZnJlc2hUb2tlbiA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcImEtelwiLCBcIkEtWlwiKTtcbiAgICAgICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuRXhwaXJlc0F0MiA9IG5ldyBEYXRlKFxuICAgICAgICAgICAgICBEYXRlLm5vdygpICsgb3B0cy5hY2Nlc3NUb2tlbkV4cGlyZXNJbiAqIDFlM1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHJlZnJlc2hUb2tlbkV4cGlyZXNBdDIgPSBuZXcgRGF0ZShcbiAgICAgICAgICAgICAgRGF0ZS5ub3coKSArIG9wdHMucmVmcmVzaFRva2VuRXhwaXJlc0luICogMWUzXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICAgICAgICBtb2RlbDogbW9kZWxOYW1lLm9hdXRoQWNjZXNzVG9rZW4sXG4gICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjZXNzVG9rZW4yLFxuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogbmV3UmVmcmVzaFRva2VuLFxuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBhY2Nlc3NUb2tlbkV4cGlyZXNBdDIsXG4gICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiByZWZyZXNoVG9rZW5FeHBpcmVzQXQyLFxuICAgICAgICAgICAgICAgIGNsaWVudElkOiBjbGllbnRfaWQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHRva2VuLnVzZXJJZCxcbiAgICAgICAgICAgICAgICBzY29wZXM6IHRva2VuLnNjb3BlcyxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICBhY2Nlc3NfdG9rZW46IGFjY2Vzc1Rva2VuMixcbiAgICAgICAgICAgICAgdG9rZW5fdHlwZTogXCJiZWFyZXJcIixcbiAgICAgICAgICAgICAgZXhwaXJlc19pbjogb3B0cy5hY2Nlc3NUb2tlbkV4cGlyZXNJbixcbiAgICAgICAgICAgICAgcmVmcmVzaF90b2tlbjogbmV3UmVmcmVzaFRva2VuLFxuICAgICAgICAgICAgICBzY29wZTogdG9rZW4uc2NvcGVzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjb2RlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImNvZGUgaXMgcmVxdWlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3B0aW9ucy5yZXF1aXJlUEtDRSAmJiAhY29kZV92ZXJpZmllcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjb2RlIHZlcmlmaWVyIGlzIG1pc3NpbmdcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25WYWx1ZSA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICBjb2RlLnRvU3RyaW5nKClcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghdmVyaWZpY2F0aW9uVmFsdWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImludmFsaWQgY29kZVwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uVmFsdWUuZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgICAgdmVyaWZpY2F0aW9uVmFsdWUuaWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjb2RlIGV4cGlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9ncmFudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uVmFsdWUuaWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghY2xpZW50X2lkIHx8ICFjbGllbnRfc2VjcmV0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjbGllbnRfaWQgYW5kIGNsaWVudF9zZWNyZXQgYXJlIHJlcXVpcmVkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfY2xpZW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWdyYW50X3R5cGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiZ3JhbnRfdHlwZSBpcyByZXF1aXJlZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChncmFudF90eXBlICE9PSBcImF1dGhvcml6YXRpb25fY29kZVwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImdyYW50X3R5cGUgbXVzdCBiZSAnYXV0aG9yaXphdGlvbl9jb2RlJ1wiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJ1bnN1cHBvcnRlZF9ncmFudF90eXBlXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXJlZGlyZWN0X3VyaSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJyZWRpcmVjdF91cmkgaXMgcmVxdWlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZS5vYXV0aENsaWVudCxcbiAgICAgICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJjbGllbnRJZFwiLCB2YWx1ZTogY2xpZW50X2lkLnRvU3RyaW5nKCkgfV1cbiAgICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzKSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgLi4ucmVzLFxuICAgICAgICAgICAgICByZWRpcmVjdFVSTHM6IHJlcy5yZWRpcmVjdFVSTHMuc3BsaXQoXCIsXCIpLFxuICAgICAgICAgICAgICBtZXRhZGF0YTogcmVzLm1ldGFkYXRhID8gSlNPTi5wYXJzZShyZXMubWV0YWRhdGEpIDoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFjbGllbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImludmFsaWQgY2xpZW50X2lkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfY2xpZW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY2xpZW50LmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjbGllbnQgaXMgZGlzYWJsZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9jbGllbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGlzVmFsaWRTZWNyZXQgPSBjbGllbnQuY2xpZW50U2VjcmV0ID09PSBjbGllbnRfc2VjcmV0LnRvU3RyaW5nKCk7XG4gICAgICAgICAgaWYgKCFpc1ZhbGlkU2VjcmV0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJpbnZhbGlkIGNsaWVudF9zZWNyZXRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9jbGllbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZhbHVlID0gSlNPTi5wYXJzZShcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLnZhbHVlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAodmFsdWUuY2xpZW50SWQgIT09IGNsaWVudF9pZC50b1N0cmluZygpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJpbnZhbGlkIGNsaWVudF9pZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2NsaWVudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZhbHVlLnJlZGlyZWN0VVJJICE9PSByZWRpcmVjdF91cmkudG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiaW52YWxpZCByZWRpcmVjdF91cmlcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9jbGllbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2YWx1ZS5jb2RlQ2hhbGxlbmdlICYmICFjb2RlX3ZlcmlmaWVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImNvZGUgdmVyaWZpZXIgaXMgbWlzc2luZ1wiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGNoYWxsZW5nZSA9IHZhbHVlLmNvZGVDaGFsbGVuZ2VNZXRob2QgPT09IFwicGxhaW5cIiA/IGNvZGVfdmVyaWZpZXIgOiBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLmRpZ2VzdChcbiAgICAgICAgICAgIGNvZGVfdmVyaWZpZXJcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChjaGFsbGVuZ2UgIT09IHZhbHVlLmNvZGVDaGFsbGVuZ2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImNvZGUgdmVyaWZpY2F0aW9uIGZhaWxlZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlcXVlc3RlZFNjb3BlcyA9IHZhbHVlLnNjb3BlO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcImEtelwiLCBcIkEtWlwiKTtcbiAgICAgICAgICBjb25zdCByZWZyZXNoVG9rZW4gPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJBLVpcIiwgXCJhLXpcIik7XG4gICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW5FeHBpcmVzQXQgPSBuZXcgRGF0ZShcbiAgICAgICAgICAgIERhdGUubm93KCkgKyBvcHRzLmFjY2Vzc1Rva2VuRXhwaXJlc0luICogMWUzXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCByZWZyZXNoVG9rZW5FeHBpcmVzQXQgPSBuZXcgRGF0ZShcbiAgICAgICAgICAgIERhdGUubm93KCkgKyBvcHRzLnJlZnJlc2hUb2tlbkV4cGlyZXNJbiAqIDFlM1xuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZS5vYXV0aEFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBhY2Nlc3NUb2tlbixcbiAgICAgICAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgICBjbGllbnRJZDogY2xpZW50X2lkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgIHVzZXJJZDogdmFsdWUudXNlcklkLFxuICAgICAgICAgICAgICBzY29wZXM6IHJlcXVlc3RlZFNjb3Blcy5qb2luKFwiIFwiKSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUlkKFxuICAgICAgICAgICAgdmFsdWUudXNlcklkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcInVzZXIgbm90IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfZ3JhbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCBzZWNyZXRLZXkgPSB7XG4gICAgICAgICAgICBhbGc6IFwiSFMyNTZcIixcbiAgICAgICAgICAgIGtleTogYXdhaXQgc3VidGxlLmdlbmVyYXRlS2V5KFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICAgICAgaGFzaDogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgICAgW1wic2lnblwiLCBcInZlcmlmeVwiXVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgcHJvZmlsZSA9IHtcbiAgICAgICAgICAgIGdpdmVuX25hbWU6IHVzZXIubmFtZS5zcGxpdChcIiBcIilbMF0sXG4gICAgICAgICAgICBmYW1pbHlfbmFtZTogdXNlci5uYW1lLnNwbGl0KFwiIFwiKVsxXSxcbiAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgIHByb2ZpbGU6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiB1c2VyLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXG4gICAgICAgICAgfTtcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IHtcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgZW1haWxfdmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZFxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgdXNlckNsYWltcyA9IHtcbiAgICAgICAgICAgIC4uLnJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcInByb2ZpbGVcIikgPyBwcm9maWxlIDoge30sXG4gICAgICAgICAgICAuLi5yZXF1ZXN0ZWRTY29wZXMuaW5jbHVkZXMoXCJlbWFpbFwiKSA/IGVtYWlsIDoge31cbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCBuZXcgU2lnbkpXVCh7XG4gICAgICAgICAgICBzdWI6IHVzZXIuaWQsXG4gICAgICAgICAgICBhdWQ6IGNsaWVudF9pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgaWF0OiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgYXV0aF90aW1lOiBjdHguY29udGV4dC5zZXNzaW9uPy5zZXNzaW9uLmNyZWF0ZWRBdC5nZXRUaW1lKCksXG4gICAgICAgICAgICBub25jZTogdmFsdWUubm9uY2UsXG4gICAgICAgICAgICBhY3I6IFwidXJuOm1hY2U6aW5jb21tb246aWFwOnNpbHZlclwiLFxuICAgICAgICAgICAgLy8gZGVmYXVsdCB0byBzaWx2ZXIgLSDimqDvuI4gdGhpcyBzaG91bGQgYmUgY29uZmlndXJhYmxlIGFuZCBzaG91bGQgYmUgdmFsaWRhdGVkIGFnYWluc3QgdGhlIGNsaWVudCdzIG1ldGFkYXRhXG4gICAgICAgICAgICAuLi51c2VyQ2xhaW1zXG4gICAgICAgICAgfSkuc2V0UHJvdGVjdGVkSGVhZGVyKHsgYWxnOiBzZWNyZXRLZXkuYWxnIH0pLnNldElzc3VlZEF0KCkuc2V0RXhwaXJhdGlvblRpbWUoXG4gICAgICAgICAgICBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxZTMpICsgb3B0cy5hY2Nlc3NUb2tlbkV4cGlyZXNJblxuICAgICAgICAgICkuc2lnbihzZWNyZXRLZXkua2V5KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGFjY2Vzc190b2tlbjogYWNjZXNzVG9rZW4sXG4gICAgICAgICAgICAgIHRva2VuX3R5cGU6IFwiQmVhcmVyXCIsXG4gICAgICAgICAgICAgIGV4cGlyZXNfaW46IG9wdHMuYWNjZXNzVG9rZW5FeHBpcmVzSW4sXG4gICAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcIm9mZmxpbmVfYWNjZXNzXCIpID8gcmVmcmVzaFRva2VuIDogdm9pZCAwLFxuICAgICAgICAgICAgICBzY29wZTogcmVxdWVzdGVkU2NvcGVzLmpvaW4oXCIgXCIpLFxuICAgICAgICAgICAgICBpZF90b2tlbjogcmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwib3BlbmlkXCIpID8gaWRUb2tlbiA6IHZvaWQgMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIFwiQ2FjaGUtQ29udHJvbFwiOiBcIm5vLXN0b3JlXCIsXG4gICAgICAgICAgICAgICAgUHJhZ21hOiBcIm5vLWNhY2hlXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBvQXV0aDJ1c2VySW5mbzogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvdXNlcmluZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgaXNBY3Rpb246IGZhbHNlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKCFjdHgucmVxdWVzdCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwicmVxdWVzdCBub3QgZm91bmRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhdXRob3JpemF0aW9uID0gY3R4LnJlcXVlc3QuaGVhZGVycy5nZXQoXCJhdXRob3JpemF0aW9uXCIpO1xuICAgICAgICAgIGlmICghYXV0aG9yaXphdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiYXV0aG9yaXphdGlvbiBoZWFkZXIgbm90IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdG9rZW4gPSBhdXRob3JpemF0aW9uLnJlcGxhY2UoXCJCZWFyZXIgXCIsIFwiXCIpO1xuICAgICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUub2F1dGhBY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJhY2Nlc3NUb2tlblwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0b2tlblxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFhY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiaW52YWxpZCBhY2Nlc3MgdG9rZW5cIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF90b2tlblwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGFjY2Vzc1Rva2VuLmFjY2Vzc1Rva2VuRXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcIlRoZSBBY2Nlc3MgVG9rZW4gZXhwaXJlZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3Rva2VuXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZChcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuLnVzZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJ1c2VyIG5vdCBmb3VuZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3Rva2VuXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXF1ZXN0ZWRTY29wZXMgPSBhY2Nlc3NUb2tlbi5zY29wZXMuc3BsaXQoXCIgXCIpO1xuICAgICAgICAgIGNvbnN0IHVzZXJDbGFpbXMgPSB7XG4gICAgICAgICAgICBzdWI6IHVzZXIuaWQsXG4gICAgICAgICAgICBlbWFpbDogcmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwiZW1haWxcIikgPyB1c2VyLmVtYWlsIDogdm9pZCAwLFxuICAgICAgICAgICAgbmFtZTogcmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwicHJvZmlsZVwiKSA/IHVzZXIubmFtZSA6IHZvaWQgMCxcbiAgICAgICAgICAgIHBpY3R1cmU6IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcInByb2ZpbGVcIikgPyB1c2VyLmltYWdlIDogdm9pZCAwLFxuICAgICAgICAgICAgZ2l2ZW5fbmFtZTogcmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwicHJvZmlsZVwiKSA/IHVzZXIubmFtZS5zcGxpdChcIiBcIilbMF0gOiB2b2lkIDAsXG4gICAgICAgICAgICBmYW1pbHlfbmFtZTogcmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwicHJvZmlsZVwiKSA/IHVzZXIubmFtZS5zcGxpdChcIiBcIilbMV0gOiB2b2lkIDAsXG4gICAgICAgICAgICBlbWFpbF92ZXJpZmllZDogcmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwiZW1haWxcIikgPyB1c2VyLmVtYWlsVmVyaWZpZWQgOiB2b2lkIDBcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih1c2VyQ2xhaW1zKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHJlZ2lzdGVyT0F1dGhBcHBsaWNhdGlvbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvcmVnaXN0ZXJcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgbmFtZTogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIGljb246IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiB6LnJlY29yZCh6LmFueSgpKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgcmVkaXJlY3RVUkxzOiB6LmFycmF5KHouc3RyaW5nKCkpXG4gICAgICAgICAgfSlcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGJvZHkgPSBjdHguYm9keTtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24gJiYgIW9wdGlvbnMuYWxsb3dEeW5hbWljQ2xpZW50UmVnaXN0cmF0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIlVuYXV0aG9yaXplZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgY2xpZW50SWQgPSBvcHRpb25zLmdlbmVyYXRlQ2xpZW50SWQ/LigpIHx8IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcImEtelwiLCBcIkEtWlwiKTtcbiAgICAgICAgICBjb25zdCBjbGllbnRTZWNyZXQgPSBvcHRpb25zLmdlbmVyYXRlQ2xpZW50U2VjcmV0Py4oKSB8fCBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIik7XG4gICAgICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZS5vYXV0aENsaWVudCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgbmFtZTogYm9keS5uYW1lLFxuICAgICAgICAgICAgICBpY29uOiBib2R5Lmljb24sXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiBib2R5Lm1ldGFkYXRhID8gSlNPTi5zdHJpbmdpZnkoYm9keS5tZXRhZGF0YSkgOiBudWxsLFxuICAgICAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICAgICAgY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgICByZWRpcmVjdFVSTHM6IGJvZHkucmVkaXJlY3RVUkxzLmpvaW4oXCIsXCIpLFxuICAgICAgICAgICAgICB0eXBlOiBcIndlYlwiLFxuICAgICAgICAgICAgICBhdXRoZW50aWNhdGlvblNjaGVtZTogXCJjbGllbnRfc2VjcmV0XCIsXG4gICAgICAgICAgICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uPy5zZXNzaW9uLnVzZXJJZCxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAuLi5jbGllbnQsXG4gICAgICAgICAgICByZWRpcmVjdFVSTHM6IGNsaWVudC5yZWRpcmVjdFVSTHMuc3BsaXQoXCIsXCIpLFxuICAgICAgICAgICAgbWV0YWRhdGE6IGNsaWVudC5tZXRhZGF0YSA/IEpTT04ucGFyc2UoY2xpZW50Lm1ldGFkYXRhKSA6IG51bGxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIGdldE9BdXRoQ2xpZW50OiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL29hdXRoMi9jbGllbnQvOmlkXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUub2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJjbGllbnRJZFwiLCB2YWx1ZTogY3R4LnBhcmFtcy5pZCB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFjbGllbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImNsaWVudCBub3QgZm91bmRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwibm90X2ZvdW5kXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgY2xpZW50SWQ6IGNsaWVudC5jbGllbnRJZCxcbiAgICAgICAgICAgIG5hbWU6IGNsaWVudC5uYW1lLFxuICAgICAgICAgICAgaWNvbjogY2xpZW50Lmljb25cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgc2NoZW1hXG4gIH07XG59O1xuXG5leHBvcnQgeyBvaWRjUHJvdmlkZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   emailOTP: () => (/* binding */ emailOTP)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\nvar types = [\"email-verification\", \"sign-in\", \"forget-password\"];\nvar emailOTP = (options) => {\n  const opts = {\n    expiresIn: 5 * 60,\n    otpLength: 6,\n    ...options\n  };\n  const ERROR_CODES = {\n    OTP_EXPIRED: \"otp expired\",\n    INVALID_OTP: \"invalid otp\",\n    INVALID_EMAIL: \"invalid email\",\n    USER_NOT_FOUND: \"user not found\"\n  };\n  return {\n    id: \"email-otp\",\n    endpoints: {\n      sendVerificationOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/send-verification-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to send the OTP\"\n            }),\n            type: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](types, {\n              description: \"Type of the OTP\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Send verification OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!options?.sendVerificationOTP) {\n            ctx.context.logger.error(\n              \"send email verification is not implemented\"\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: \"send email verification is not implemented\"\n            });\n          }\n          const email = ctx.body.email;\n          const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n          if (!emailRegex.test(email)) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_EMAIL\n            });\n          }\n          if (ctx.body.type === \"forget-password\" || opts.disableSignUp) {\n            const user = await ctx.context.internalAdapter.findUserByEmail(email);\n            if (!user) {\n              return ctx.json({\n                success: true\n              });\n            }\n          }\n          const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: otp,\n            identifier: `${ctx.body.type}-otp-${email}`,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n          }).catch(async (error) => {\n            await ctx.context.internalAdapter.deleteVerificationByIdentifier(\n              `${ctx.body.type}-otp-${email}`\n            );\n            await ctx.context.internalAdapter.createVerificationValue({\n              value: otp,\n              identifier: `${ctx.body.type}-otp-${email}`,\n              expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n            });\n          });\n          await options.sendVerificationOTP(\n            {\n              email,\n              otp,\n              type: ctx.body.type\n            },\n            ctx.request\n          );\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      createVerificationOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/create-verification-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to send the OTP\"\n            }),\n            type: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](types, {\n              description: \"Type of the OTP\"\n            })\n          }),\n          metadata: {\n            SERVER_ONLY: true,\n            openapi: {\n              description: \"Create verification OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: otp,\n            identifier: `${ctx.body.type}-otp-${email}`,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n          });\n          return otp;\n        }\n      ),\n      getVerificationOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/get-verification-otp\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to get the OTP\"\n            }),\n            type: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](types)\n          }),\n          metadata: {\n            SERVER_ONLY: true,\n            openapi: {\n              description: \"Get verification OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          otp: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.query.email;\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `${ctx.query.type}-otp-${email}`\n          );\n          if (!verificationValue || verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            return ctx.json({\n              otp: null\n            });\n          }\n          return ctx.json({\n            otp: verificationValue.value\n          });\n        }\n      ),\n      verifyEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/verify-email\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to verify\"\n            }),\n            otp: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"OTP to verify\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Verify email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n          if (!emailRegex.test(email)) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_EMAIL\n            });\n          }\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `email-verification-otp-${email}`\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_EXPIRED\n            });\n          }\n          const otp = ctx.body.otp;\n          if (verificationValue.value !== otp) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const user = await ctx.context.internalAdapter.findUserByEmail(email);\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_NOT_FOUND\n            });\n          }\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            user.user.id,\n            {\n              email,\n              emailVerified: true\n            }\n          );\n          if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n            const session = await ctx.context.internalAdapter.createSession(\n              updatedUser.id,\n              ctx.request\n            );\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n              session,\n              user: updatedUser\n            });\n            return ctx.json({\n              status: true,\n              token: session.token,\n              user: {\n                id: updatedUser.id,\n                email: updatedUser.email,\n                emailVerified: updatedUser.emailVerified,\n                name: updatedUser.name,\n                image: updatedUser.image,\n                createdAt: updatedUser.createdAt,\n                updatedAt: updatedUser.updatedAt\n              }\n            });\n          }\n          return ctx.json({\n            status: true,\n            token: null,\n            user: {\n              id: updatedUser.id,\n              email: updatedUser.email,\n              emailVerified: updatedUser.emailVerified,\n              name: updatedUser.name,\n              image: updatedUser.image,\n              createdAt: updatedUser.createdAt,\n              updatedAt: updatedUser.updatedAt\n            }\n          });\n        }\n      ),\n      signInEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/email-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to sign in\"\n            }),\n            otp: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"OTP sent to the email\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Sign in with email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `sign-in-otp-${email}`\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_EXPIRED\n            });\n          }\n          const otp = ctx.body.otp;\n          if (verificationValue.value !== otp) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const user = await ctx.context.internalAdapter.findUserByEmail(email);\n          if (!user) {\n            if (opts.disableSignUp) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.USER_NOT_FOUND\n              });\n            }\n            const newUser = await ctx.context.internalAdapter.createUser({\n              email,\n              emailVerified: true,\n              name: \"\"\n            });\n            const session2 = await ctx.context.internalAdapter.createSession(\n              newUser.id,\n              ctx.request\n            );\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n              session: session2,\n              user: newUser\n            });\n            return ctx.json({\n              token: session2.token,\n              user: {\n                id: newUser.id,\n                email: newUser.email,\n                emailVerified: newUser.emailVerified,\n                name: newUser.name,\n                image: newUser.image,\n                createdAt: newUser.createdAt,\n                updatedAt: newUser.updatedAt\n              }\n            });\n          }\n          if (!user.user.emailVerified) {\n            await ctx.context.internalAdapter.updateUser(user.user.id, {\n              emailVerified: true\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.user.id,\n            ctx.request\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n            session,\n            user: user.user\n          });\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: user.user.id,\n              email: user.user.email,\n              emailVerified: user.user.emailVerified,\n              name: user.user.name,\n              image: user.user.image,\n              createdAt: user.user.createdAt,\n              updatedAt: user.user.updatedAt\n            }\n          });\n        }\n      ),\n      forgetPasswordEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/forget-password/email-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to send the OTP\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Forget password with email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const user = await ctx.context.internalAdapter.findUserByEmail(email);\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_NOT_FOUND\n            });\n          }\n          const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: otp,\n            identifier: `forget-password-otp-${email}`,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n          });\n          await options.sendVerificationOTP(\n            {\n              email,\n              otp,\n              type: \"forget-password\"\n            },\n            ctx.request\n          );\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      resetPasswordEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/reset-password\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to reset the password\"\n            }),\n            otp: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"OTP sent to the email\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"New password\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Reset password with email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const user = await ctx.context.internalAdapter.findUserByEmail(\n            email,\n            {\n              includeAccounts: true\n            }\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_NOT_FOUND\n            });\n          }\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `forget-password-otp-${email}`\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_EXPIRED\n            });\n          }\n          const otp = ctx.body.otp;\n          if (verificationValue.value !== otp) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const passwordHash = await ctx.context.password.hash(\n            ctx.body.password\n          );\n          const account = user.accounts.find(\n            (account2) => account2.providerId === \"credential\"\n          );\n          if (!account) {\n            await ctx.context.internalAdapter.createAccount({\n              userId: user.user.id,\n              providerId: \"credential\",\n              accountId: user.user.id,\n              password: passwordHash\n            });\n          } else {\n            await ctx.context.internalAdapter.updatePassword(\n              user.user.id,\n              passwordHash\n            );\n          }\n          return ctx.json({\n            success: true\n          });\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return !!(context.path?.startsWith(\"/sign-up\") && opts.sendVerificationOnSignUp);\n          },\n          async handler(ctx) {\n            const response = ctx.context.returned;\n            if (response instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n              return;\n            }\n            const email = response && \"email\" in response ? response.email : response instanceof Response ? response.status === 200 ? ctx.body.email : null : null;\n            if (email) {\n              const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n              await ctx.context.internalAdapter.createVerificationValue({\n                value: otp,\n                identifier: `email-verification-otp-${email}`,\n                expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n              });\n              await options.sendVerificationOTP(\n                {\n                  email,\n                  otp,\n                  type: \"email-verification\"\n                },\n                ctx.request\n              );\n            }\n          }\n        }\n      ]\n    },\n    $ERROR_CODES: ERROR_CODES,\n    rateLimit: [\n      {\n        pathMatcher(path) {\n          return path === \"/email-otp/send-verification-otp\";\n        },\n        window: 60,\n        max: 3\n      },\n      {\n        pathMatcher(path) {\n          return path === \"/email-otp/verify-email\";\n        },\n        window: 60,\n        max: 3\n      },\n      {\n        pathMatcher(path) {\n          return path === \"/sign-in/email-otp\";\n        },\n        window: 60,\n        max: 3\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTE5BRVRWT08uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQW1FO0FBQ1o7QUFDSTtBQUNiO0FBQ3RCOztBQUV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzRUFBa0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLG1CQUFtQix5Q0FBUTtBQUMzQjtBQUNBLGFBQWE7QUFDYixrQkFBa0IsMENBQU07QUFDeEI7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDBFQUEwRSxHQUFHO0FBQzdFO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0Esc0JBQXNCLHdFQUFvQjtBQUMxQztBQUNBO0FBQ0EsMkJBQTJCLGNBQWMsT0FBTyxNQUFNO0FBQ3RELHVCQUF1QiwyREFBTztBQUM5QixXQUFXO0FBQ1g7QUFDQSxpQkFBaUIsY0FBYyxPQUFPLE1BQU07QUFDNUM7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGNBQWMsT0FBTyxNQUFNO0FBQ3hELHlCQUF5QiwyREFBTztBQUNoQyxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFD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QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLG9DQUFvQyx3REFBUTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix3RUFBb0I7QUFDOUM7QUFDQTtBQUNBLHNEQUFzRCxNQUFNO0FBQzVELDJCQUEyQiwyREFBTztBQUNsQyxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW9CIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTE5BRVRWT08uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBBUElFcnJvciB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG52YXIgdHlwZXMgPSBbXCJlbWFpbC12ZXJpZmljYXRpb25cIiwgXCJzaWduLWluXCIsIFwiZm9yZ2V0LXBhc3N3b3JkXCJdO1xudmFyIGVtYWlsT1RQID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3Qgb3B0cyA9IHtcbiAgICBleHBpcmVzSW46IDUgKiA2MCxcbiAgICBvdHBMZW5ndGg6IDYsXG4gICAgLi4ub3B0aW9uc1xuICB9O1xuICBjb25zdCBFUlJPUl9DT0RFUyA9IHtcbiAgICBPVFBfRVhQSVJFRDogXCJvdHAgZXhwaXJlZFwiLFxuICAgIElOVkFMSURfT1RQOiBcImludmFsaWQgb3RwXCIsXG4gICAgSU5WQUxJRF9FTUFJTDogXCJpbnZhbGlkIGVtYWlsXCIsXG4gICAgVVNFUl9OT1RfRk9VTkQ6IFwidXNlciBub3QgZm91bmRcIlxuICB9O1xuICByZXR1cm4ge1xuICAgIGlkOiBcImVtYWlsLW90cFwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgc2VuZFZlcmlmaWNhdGlvbk9UUDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9lbWFpbC1vdHAvc2VuZC12ZXJpZmljYXRpb24tb3RwXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gc2VuZCB0aGUgT1RQXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdHlwZTogei5lbnVtKHR5cGVzLCB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlR5cGUgb2YgdGhlIE9UUFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbmQgdmVyaWZpY2F0aW9uIE9UUFwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKCFvcHRpb25zPy5zZW5kVmVyaWZpY2F0aW9uT1RQKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgIFwic2VuZCBlbWFpbCB2ZXJpZmljYXRpb24gaXMgbm90IGltcGxlbWVudGVkXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwic2VuZCBlbWFpbCB2ZXJpZmljYXRpb24gaXMgbm90IGltcGxlbWVudGVkXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBlbWFpbCA9IGN0eC5ib2R5LmVtYWlsO1xuICAgICAgICAgIGNvbnN0IGVtYWlsUmVnZXggPSAvXlthLXpBLVowLTkuXyUrLV0rQFthLXpBLVowLTkuLV0rXFwuW2EtekEtWl17Mix9JC87XG4gICAgICAgICAgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfRU1BSUxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY3R4LmJvZHkudHlwZSA9PT0gXCJmb3JnZXQtcGFzc3dvcmRcIiB8fCBvcHRzLmRpc2FibGVTaWduVXApIHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG90cCA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKG9wdHMub3RwTGVuZ3RoLCBcIjAtOVwiKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgICAgICAgICAgdmFsdWU6IG90cCxcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IGAke2N0eC5ib2R5LnR5cGV9LW90cC0ke2VtYWlsfWAsXG4gICAgICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUob3B0cy5leHBpcmVzSW4sIFwic2VjXCIpXG4gICAgICAgICAgfSkuY2F0Y2goYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uQnlJZGVudGlmaWVyKFxuICAgICAgICAgICAgICBgJHtjdHguYm9keS50eXBlfS1vdHAtJHtlbWFpbH1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgICAgdmFsdWU6IG90cCxcbiAgICAgICAgICAgICAgaWRlbnRpZmllcjogYCR7Y3R4LmJvZHkudHlwZX0tb3RwLSR7ZW1haWx9YCxcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKG9wdHMuZXhwaXJlc0luLCBcInNlY1wiKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgb3B0aW9ucy5zZW5kVmVyaWZpY2F0aW9uT1RQKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgb3RwLFxuICAgICAgICAgICAgICB0eXBlOiBjdHguYm9keS50eXBlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBjcmVhdGVWZXJpZmljYXRpb25PVFA6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvZW1haWwtb3RwL2NyZWF0ZS12ZXJpZmljYXRpb24tb3RwXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gc2VuZCB0aGUgT1RQXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdHlwZTogei5lbnVtKHR5cGVzLCB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlR5cGUgb2YgdGhlIE9UUFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBTRVJWRVJfT05MWTogdHJ1ZSxcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQ3JlYXRlIHZlcmlmaWNhdGlvbiBPVFBcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgZW1haWwgPSBjdHguYm9keS5lbWFpbDtcbiAgICAgICAgICBjb25zdCBvdHAgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZyhvcHRzLm90cExlbmd0aCwgXCIwLTlcIik7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdHAsXG4gICAgICAgICAgICBpZGVudGlmaWVyOiBgJHtjdHguYm9keS50eXBlfS1vdHAtJHtlbWFpbH1gLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKG9wdHMuZXhwaXJlc0luLCBcInNlY1wiKVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBvdHA7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBnZXRWZXJpZmljYXRpb25PVFA6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvZW1haWwtb3RwL2dldC12ZXJpZmljYXRpb24tb3RwXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gZ2V0IHRoZSBPVFBcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0eXBlOiB6LmVudW0odHlwZXMpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIFNFUlZFUl9PTkxZOiB0cnVlLFxuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdmVyaWZpY2F0aW9uIE9UUFwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG90cDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gY3R4LnF1ZXJ5LmVtYWlsO1xuICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblZhbHVlID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIGAke2N0eC5xdWVyeS50eXBlfS1vdHAtJHtlbWFpbH1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblZhbHVlIHx8IHZlcmlmaWNhdGlvblZhbHVlLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICBvdHA6IG51bGxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgb3RwOiB2ZXJpZmljYXRpb25WYWx1ZS52YWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgdmVyaWZ5RW1haWxPVFA6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvZW1haWwtb3RwL3ZlcmlmeS1lbWFpbFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBhZGRyZXNzIHRvIHZlcmlmeVwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG90cDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJPVFAgdG8gdmVyaWZ5XCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVmVyaWZ5IGVtYWlsIE9UUFwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgZW1haWwgPSBjdHguYm9keS5lbWFpbDtcbiAgICAgICAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bYS16QS1aMC05Ll8lKy1dK0BbYS16QS1aMC05Li1dK1xcLlthLXpBLVpdezIsfSQvO1xuICAgICAgICAgIGlmICghZW1haWxSZWdleC50ZXN0KGVtYWlsKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uVmFsdWUgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgYGVtYWlsLXZlcmlmaWNhdGlvbi1vdHAtJHtlbWFpbH1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT1RQXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblZhbHVlLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5PVFBfRVhQSVJFRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG90cCA9IGN0eC5ib2R5Lm90cDtcbiAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uVmFsdWUudmFsdWUgIT09IG90cCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX09UUFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLlVTRVJfTk9UX0ZPVU5EXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgIHVzZXIudXNlci5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5hdXRvU2lnbkluQWZ0ZXJWZXJpZmljYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgICAgdXBkYXRlZFVzZXIuaWQsXG4gICAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgICAgdXNlcjogdXBkYXRlZFVzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1cGRhdGVkVXNlci5pZCxcbiAgICAgICAgICAgICAgICBlbWFpbDogdXBkYXRlZFVzZXIuZW1haWwsXG4gICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXBkYXRlZFVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVkVXNlci5uYW1lLFxuICAgICAgICAgICAgICAgIGltYWdlOiB1cGRhdGVkVXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHVwZGF0ZWRVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHVwZGF0ZWRVc2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogdXBkYXRlZFVzZXIuaWQsXG4gICAgICAgICAgICAgIGVtYWlsOiB1cGRhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXBkYXRlZFVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogdXBkYXRlZFVzZXIubmFtZSxcbiAgICAgICAgICAgICAgaW1hZ2U6IHVwZGF0ZWRVc2VyLmltYWdlLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHVwZGF0ZWRVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1cGRhdGVkVXNlci51cGRhdGVkQXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHNpZ25JbkVtYWlsT1RQOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3NpZ24taW4vZW1haWwtb3RwXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gc2lnbiBpblwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG90cDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJPVFAgc2VudCB0byB0aGUgZW1haWxcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggZW1haWwgT1RQXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgZW1haWwgPSBjdHguYm9keS5lbWFpbDtcbiAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25WYWx1ZSA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICBgc2lnbi1pbi1vdHAtJHtlbWFpbH1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT1RQXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblZhbHVlLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5PVFBfRVhQSVJFRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG90cCA9IGN0eC5ib2R5Lm90cDtcbiAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uVmFsdWUudmFsdWUgIT09IG90cCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX09UUFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICBpZiAob3B0cy5kaXNhYmxlU2lnblVwKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSX05PVF9GT1VORFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG5ld1VzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVXNlcih7XG4gICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgICBuYW1lOiBcIlwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24yID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICAgIG5ld1VzZXIuaWQsXG4gICAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbjIsXG4gICAgICAgICAgICAgIHVzZXI6IG5ld1VzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgdG9rZW46IHNlc3Npb24yLnRva2VuLFxuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgaWQ6IG5ld1VzZXIuaWQsXG4gICAgICAgICAgICAgICAgZW1haWw6IG5ld1VzZXIuZW1haWwsXG4gICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogbmV3VXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgICAgIG5hbWU6IG5ld1VzZXIubmFtZSxcbiAgICAgICAgICAgICAgICBpbWFnZTogbmV3VXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IG5ld1VzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3VXNlci51cGRhdGVkQXRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghdXNlci51c2VyLmVtYWlsVmVyaWZpZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKHVzZXIudXNlci5pZCwge1xuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgdXNlci51c2VyLmlkLFxuICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgICAgdXNlcjogdXNlci51c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogdXNlci51c2VyLmlkLFxuICAgICAgICAgICAgICBlbWFpbDogdXNlci51c2VyLmVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci51c2VyLm5hbWUsXG4gICAgICAgICAgICAgIGltYWdlOiB1c2VyLnVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogdXNlci51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBmb3JnZXRQYXNzd29yZEVtYWlsT1RQOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2ZvcmdldC1wYXNzd29yZC9lbWFpbC1vdHBcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgYWRkcmVzcyB0byBzZW5kIHRoZSBPVFBcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJGb3JnZXQgcGFzc3dvcmQgd2l0aCBlbWFpbCBPVFBcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gY3R4LmJvZHkuZW1haWw7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSX05PVF9GT1VORFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG90cCA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKG9wdHMub3RwTGVuZ3RoLCBcIjAtOVwiKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgICAgICAgICAgdmFsdWU6IG90cCxcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IGBmb3JnZXQtcGFzc3dvcmQtb3RwLSR7ZW1haWx9YCxcbiAgICAgICAgICAgIGV4cGlyZXNBdDogZ2V0RGF0ZShvcHRzLmV4cGlyZXNJbiwgXCJzZWNcIilcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhd2FpdCBvcHRpb25zLnNlbmRWZXJpZmljYXRpb25PVFAoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICBvdHAsXG4gICAgICAgICAgICAgIHR5cGU6IFwiZm9yZ2V0LXBhc3N3b3JkXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHJlc2V0UGFzc3dvcmRFbWFpbE9UUDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9lbWFpbC1vdHAvcmVzZXQtcGFzc3dvcmRcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgYWRkcmVzcyB0byByZXNldCB0aGUgcGFzc3dvcmRcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBvdHA6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiT1RQIHNlbnQgdG8gdGhlIGVtYWlsXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTmV3IHBhc3N3b3JkXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUmVzZXQgcGFzc3dvcmQgd2l0aCBlbWFpbCBPVFBcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gY3R4LmJvZHkuZW1haWw7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoXG4gICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaW5jbHVkZUFjY291bnRzOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUl9OT1RfRk9VTkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25WYWx1ZSA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICBgZm9yZ2V0LXBhc3N3b3JkLW90cC0ke2VtYWlsfWBcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghdmVyaWZpY2F0aW9uVmFsdWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9PVFBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uVmFsdWUuZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgICAgdmVyaWZpY2F0aW9uVmFsdWUuaWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLk9UUF9FWFBJUkVEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgb3RwID0gY3R4LmJvZHkub3RwO1xuICAgICAgICAgIGlmICh2ZXJpZmljYXRpb25WYWx1ZS52YWx1ZSAhPT0gb3RwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT1RQXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uVmFsdWUuaWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2goXG4gICAgICAgICAgICBjdHguYm9keS5wYXNzd29yZFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgYWNjb3VudCA9IHVzZXIuYWNjb3VudHMuZmluZChcbiAgICAgICAgICAgIChhY2NvdW50MikgPT4gYWNjb3VudDIucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCJcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghYWNjb3VudCkge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoe1xuICAgICAgICAgICAgICB1c2VySWQ6IHVzZXIudXNlci5pZCxcbiAgICAgICAgICAgICAgcHJvdmlkZXJJZDogXCJjcmVkZW50aWFsXCIsXG4gICAgICAgICAgICAgIGFjY291bnRJZDogdXNlci51c2VyLmlkLFxuICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRIYXNoXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVBhc3N3b3JkKFxuICAgICAgICAgICAgICB1c2VyLnVzZXIuaWQsXG4gICAgICAgICAgICAgIHBhc3N3b3JkSGFzaFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiAhIShjb250ZXh0LnBhdGg/LnN0YXJ0c1dpdGgoXCIvc2lnbi11cFwiKSAmJiBvcHRzLnNlbmRWZXJpZmljYXRpb25PblNpZ25VcCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBoYW5kbGVyKGN0eCkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBjdHguY29udGV4dC5yZXR1cm5lZDtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGVtYWlsID0gcmVzcG9uc2UgJiYgXCJlbWFpbFwiIGluIHJlc3BvbnNlID8gcmVzcG9uc2UuZW1haWwgOiByZXNwb25zZSBpbnN0YW5jZW9mIFJlc3BvbnNlID8gcmVzcG9uc2Uuc3RhdHVzID09PSAyMDAgPyBjdHguYm9keS5lbWFpbCA6IG51bGwgOiBudWxsO1xuICAgICAgICAgICAgaWYgKGVtYWlsKSB7XG4gICAgICAgICAgICAgIGNvbnN0IG90cCA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKG9wdHMub3RwTGVuZ3RoLCBcIjAtOVwiKTtcbiAgICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogb3RwLFxuICAgICAgICAgICAgICAgIGlkZW50aWZpZXI6IGBlbWFpbC12ZXJpZmljYXRpb24tb3RwLSR7ZW1haWx9YCxcbiAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUob3B0cy5leHBpcmVzSW4sIFwic2VjXCIpXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBhd2FpdCBvcHRpb25zLnNlbmRWZXJpZmljYXRpb25PVFAoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAgICAgICBvdHAsXG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImVtYWlsLXZlcmlmaWNhdGlvblwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0sXG4gICAgJEVSUk9SX0NPREVTOiBFUlJPUl9DT0RFUyxcbiAgICByYXRlTGltaXQ6IFtcbiAgICAgIHtcbiAgICAgICAgcGF0aE1hdGNoZXIocGF0aCkge1xuICAgICAgICAgIHJldHVybiBwYXRoID09PSBcIi9lbWFpbC1vdHAvc2VuZC12ZXJpZmljYXRpb24tb3RwXCI7XG4gICAgICAgIH0sXG4gICAgICAgIHdpbmRvdzogNjAsXG4gICAgICAgIG1heDogM1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcGF0aE1hdGNoZXIocGF0aCkge1xuICAgICAgICAgIHJldHVybiBwYXRoID09PSBcIi9lbWFpbC1vdHAvdmVyaWZ5LWVtYWlsXCI7XG4gICAgICAgIH0sXG4gICAgICAgIHdpbmRvdzogNjAsXG4gICAgICAgIG1heDogM1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcGF0aE1hdGNoZXIocGF0aCkge1xuICAgICAgICAgIHJldHVybiBwYXRoID09PSBcIi9zaWduLWluL2VtYWlsLW90cFwiO1xuICAgICAgICB9LFxuICAgICAgICB3aW5kb3c6IDYwLFxuICAgICAgICBtYXg6IDNcbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG5leHBvcnQgeyBlbWFpbE9UUCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   username: () => (/* binding */ username)\n/* harmony export */ });\n/* harmony import */ var _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-WMXBA6LX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\n\n// src/plugins/username/schema.ts\nvar schema = {\n  user: {\n    fields: {\n      username: {\n        type: \"string\",\n        required: false,\n        sortable: true,\n        unique: true,\n        returned: true,\n        transform: {\n          input(value) {\n            return value?.toString().toLowerCase();\n          }\n        }\n      }\n    }\n  }\n};\n\n// src/plugins/username/index.ts\nfunction defaultUsernameValidator(username2) {\n  return /^[a-zA-Z0-9_]+$/.test(username2);\n}\nvar username = (options) => {\n  const ERROR_CODES = {\n    INVALID_USERNAME_OR_PASSWORD: \"invalid username or password\",\n    EMAIL_NOT_VERIFIED: \"email not verified\",\n    UNEXPECTED_ERROR: \"unexpected error\",\n    USERNAME_IS_ALREADY_TAKEN: \"username is already taken. please try another.\",\n    USERNAME_TOO_SHORT: \"username is too short\",\n    USERNAME_TOO_LONG: \"username is too long\",\n    INVALID_USERNAME: \"username is invalid\"\n  };\n  return {\n    id: \"username\",\n    endpoints: {\n      signInUsername: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n        \"/sign-in/username\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            username: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The username of the user\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The password of the user\"\n            }),\n            rememberMe: zod__WEBPACK_IMPORTED_MODULE_4__.z.boolean({\n              description: \"Remember the user session\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Sign in with username\",\n              description: \"Sign in with username\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!ctx.body.username || !ctx.body.password) {\n            ctx.context.logger.error(\"Username or password not found\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const minUsernameLength = options?.minUsernameLength || 3;\n          const maxUsernameLength = options?.maxUsernameLength || 30;\n          if (ctx.body.username.length < minUsernameLength) {\n            ctx.context.logger.error(\"Username too short\", {\n              username: ctx.body.username\n            });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n              message: ERROR_CODES.USERNAME_TOO_SHORT\n            });\n          }\n          if (ctx.body.username.length > maxUsernameLength) {\n            ctx.context.logger.error(\"Username too long\", {\n              username: ctx.body.username\n            });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n              message: ERROR_CODES.USERNAME_TOO_LONG\n            });\n          }\n          const validator = options?.usernameValidator || defaultUsernameValidator;\n          if (!validator(ctx.body.username)) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n              message: ERROR_CODES.INVALID_USERNAME\n            });\n          }\n          const user = await ctx.context.adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                field: \"username\",\n                value: ctx.body.username.toLowerCase()\n              }\n            ]\n          });\n          if (!user) {\n            await ctx.context.password.hash(ctx.body.password);\n            ctx.context.logger.error(\"User not found\", { username });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          if (!user.emailVerified && ctx.context.options.emailAndPassword?.requireEmailVerification) {\n            await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.sendVerificationEmailFn)(ctx, user);\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"FORBIDDEN\", {\n              message: ERROR_CODES.EMAIL_NOT_VERIFIED\n            });\n          }\n          const account = await ctx.context.adapter.findOne({\n            model: \"account\",\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              },\n              {\n                field: \"providerId\",\n                value: \"credential\"\n              }\n            ]\n          });\n          if (!account) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const currentPassword = account?.password;\n          if (!currentPassword) {\n            ctx.context.logger.error(\"Password not found\", { username });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const validPassword = await ctx.context.password.verify({\n            hash: currentPassword,\n            password: ctx.body.password\n          });\n          if (!validPassword) {\n            ctx.context.logger.error(\"Invalid password\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.request,\n            ctx.body.rememberMe === false\n          );\n          if (!session) {\n            return ctx.json(null, {\n              status: 500,\n              body: {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION,\n                status: 500\n              }\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(\n            ctx,\n            { session, user },\n            ctx.body.rememberMe === false\n          );\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        }\n      )\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.mergeSchema)(schema, options?.schema),\n    hooks: {\n      before: [\n        {\n          matcher(context) {\n            return context.path === \"/sign-up/email\" || context.path === \"/update-user\";\n          },\n          async handler(ctx) {\n            const username2 = ctx.body.username;\n            if (username2) {\n              const minUsernameLength = options?.minUsernameLength || 3;\n              const maxUsernameLength = options?.maxUsernameLength || 30;\n              if (username2.length < minUsernameLength) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.USERNAME_TOO_SHORT\n                });\n              }\n              if (username2.length > maxUsernameLength) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.USERNAME_TOO_LONG\n                });\n              }\n              const validator = options?.usernameValidator || defaultUsernameValidator;\n              const valid = await validator(username2);\n              if (!valid) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.INVALID_USERNAME\n                });\n              }\n              const user = await ctx.context.adapter.findOne({\n                model: \"user\",\n                where: [\n                  {\n                    field: \"username\",\n                    value: username2.toLowerCase()\n                  }\n                ]\n              });\n              if (user) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.USERNAME_IS_ALREADY_TAKEN\n                });\n              }\n            }\n          }\n        }\n      ]\n    },\n    $ERROR_CODES: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTTdDN1RLSVUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUE2RDtBQUN1QztBQUM3QztBQUNMO0FBQzFCO0FBQ2U7O0FBRXZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isc0VBQWtCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QixzQkFBc0IseUNBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2Isc0JBQXNCLHlDQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiLHdCQUF3QiwwQ0FBUztBQUNqQztBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2Isc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSx5REFBeUQsVUFBVTtBQUNuRSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGtCQUFrQiwyRUFBdUI7QUFDekMsc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELFVBQVU7QUFDdkUsc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsZ0VBQWdCO0FBQ3pDO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxnQkFBZ0Isb0VBQWdCO0FBQ2hDO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSwrREFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixpREFBUTtBQUNsQztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsMEJBQTBCLGlEQUFRO0FBQ2xDO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGlEQUFRO0FBQ2xDO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLDBCQUEwQixpREFBUTtBQUNsQztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGtCQUFrQixzRUFBc0I7QUFDeEM7QUFDQTs7QUFFb0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1NN0M3VEtJVS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUV09fRkFDVE9SX0VSUk9SX0NPREVTIH0gZnJvbSAnLi9jaHVuay1XTVhCQTZMWC5qcyc7XG5pbXBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIHNlbmRWZXJpZmljYXRpb25FbWFpbEZuLCBCQVNFX0VSUk9SX0NPREVTIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBtZXJnZVNjaGVtYSB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcblxuLy8gc3JjL3BsdWdpbnMvdXNlcm5hbWUvc2NoZW1hLnRzXG52YXIgc2NoZW1hID0ge1xuICB1c2VyOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICB1c2VybmFtZToge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgIHJldHVybmVkOiB0cnVlLFxuICAgICAgICB0cmFuc2Zvcm06IHtcbiAgICAgICAgICBpbnB1dCh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlPy50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG4vLyBzcmMvcGx1Z2lucy91c2VybmFtZS9pbmRleC50c1xuZnVuY3Rpb24gZGVmYXVsdFVzZXJuYW1lVmFsaWRhdG9yKHVzZXJuYW1lMikge1xuICByZXR1cm4gL15bYS16QS1aMC05X10rJC8udGVzdCh1c2VybmFtZTIpO1xufVxudmFyIHVzZXJuYW1lID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgSU5WQUxJRF9VU0VSTkFNRV9PUl9QQVNTV09SRDogXCJpbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkXCIsXG4gICAgRU1BSUxfTk9UX1ZFUklGSUVEOiBcImVtYWlsIG5vdCB2ZXJpZmllZFwiLFxuICAgIFVORVhQRUNURURfRVJST1I6IFwidW5leHBlY3RlZCBlcnJvclwiLFxuICAgIFVTRVJOQU1FX0lTX0FMUkVBRFlfVEFLRU46IFwidXNlcm5hbWUgaXMgYWxyZWFkeSB0YWtlbi4gcGxlYXNlIHRyeSBhbm90aGVyLlwiLFxuICAgIFVTRVJOQU1FX1RPT19TSE9SVDogXCJ1c2VybmFtZSBpcyB0b28gc2hvcnRcIixcbiAgICBVU0VSTkFNRV9UT09fTE9ORzogXCJ1c2VybmFtZSBpcyB0b28gbG9uZ1wiLFxuICAgIElOVkFMSURfVVNFUk5BTUU6IFwidXNlcm5hbWUgaXMgaW52YWxpZFwiXG4gIH07XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidXNlcm5hbWVcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNpZ25JblVzZXJuYW1lOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3NpZ24taW4vdXNlcm5hbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgdXNlcm5hbWU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXJuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcmVtZW1iZXJNZTogei5ib29sZWFuKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUmVtZW1iZXIgdGhlIHVzZXIgc2Vzc2lvblwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJTaWduIGluIHdpdGggdXNlcm5hbWVcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIHVzZXJuYW1lXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKCFjdHguYm9keS51c2VybmFtZSB8fCAhY3R4LmJvZHkucGFzc3dvcmQpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXJuYW1lIG9yIHBhc3N3b3JkIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBtaW5Vc2VybmFtZUxlbmd0aCA9IG9wdGlvbnM/Lm1pblVzZXJuYW1lTGVuZ3RoIHx8IDM7XG4gICAgICAgICAgY29uc3QgbWF4VXNlcm5hbWVMZW5ndGggPSBvcHRpb25zPy5tYXhVc2VybmFtZUxlbmd0aCB8fCAzMDtcbiAgICAgICAgICBpZiAoY3R4LmJvZHkudXNlcm5hbWUubGVuZ3RoIDwgbWluVXNlcm5hbWVMZW5ndGgpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXJuYW1lIHRvbyBzaG9ydFwiLCB7XG4gICAgICAgICAgICAgIHVzZXJuYW1lOiBjdHguYm9keS51c2VybmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLlVTRVJOQU1FX1RPT19TSE9SVFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjdHguYm9keS51c2VybmFtZS5sZW5ndGggPiBtYXhVc2VybmFtZUxlbmd0aCkge1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlcm5hbWUgdG9vIGxvbmdcIiwge1xuICAgICAgICAgICAgICB1c2VybmFtZTogY3R4LmJvZHkudXNlcm5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSTkFNRV9UT09fTE9OR1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZhbGlkYXRvciA9IG9wdGlvbnM/LnVzZXJuYW1lVmFsaWRhdG9yIHx8IGRlZmF1bHRVc2VybmFtZVZhbGlkYXRvcjtcbiAgICAgICAgICBpZiAoIXZhbGlkYXRvcihjdHguYm9keS51c2VybmFtZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9VU0VSTkFNRVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJuYW1lXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGN0eC5ib2R5LnVzZXJuYW1lLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChjdHguYm9keS5wYXNzd29yZCk7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VyIG5vdCBmb3VuZFwiLCB7IHVzZXJuYW1lIH0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9VU0VSTkFNRV9PUl9QQVNTV09SRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghdXNlci5lbWFpbFZlcmlmaWVkICYmIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICAgICAgICBhd2FpdCBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbihjdHgsIHVzZXIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuRU1BSUxfTk9UX1ZFUklGSUVEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWRcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInByb3ZpZGVySWRcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogXCJjcmVkZW50aWFsXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghYWNjb3VudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9VU0VSTkFNRV9PUl9QQVNTV09SRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYXNzd29yZCA9IGFjY291bnQ/LnBhc3N3b3JkO1xuICAgICAgICAgIGlmICghY3VycmVudFBhc3N3b3JkKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBub3QgZm91bmRcIiwgeyB1c2VybmFtZSB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWxpZFBhc3N3b3JkID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICAgICAgICAgIGhhc2g6IGN1cnJlbnRQYXNzd29yZCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiBjdHguYm9keS5wYXNzd29yZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdmFsaWRQYXNzd29yZCkge1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSW52YWxpZCBwYXNzd29yZFwiKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICB1c2VyLmlkLFxuICAgICAgICAgICAgY3R4LnJlcXVlc3QsXG4gICAgICAgICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICAgICAgICBzdGF0dXM6IDUwMCxcbiAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OLFxuICAgICAgICAgICAgICAgIHN0YXR1czogNTAwXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgICAgICAgY3R4LFxuICAgICAgICAgICAgeyBzZXNzaW9uLCB1c2VyIH0sXG4gICAgICAgICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICBzY2hlbWE6IG1lcmdlU2NoZW1hKHNjaGVtYSwgb3B0aW9ucz8uc2NoZW1hKSxcbiAgICBob29rczoge1xuICAgICAgYmVmb3JlOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LnBhdGggPT09IFwiL3NpZ24tdXAvZW1haWxcIiB8fCBjb250ZXh0LnBhdGggPT09IFwiL3VwZGF0ZS11c2VyXCI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBoYW5kbGVyKGN0eCkge1xuICAgICAgICAgICAgY29uc3QgdXNlcm5hbWUyID0gY3R4LmJvZHkudXNlcm5hbWU7XG4gICAgICAgICAgICBpZiAodXNlcm5hbWUyKSB7XG4gICAgICAgICAgICAgIGNvbnN0IG1pblVzZXJuYW1lTGVuZ3RoID0gb3B0aW9ucz8ubWluVXNlcm5hbWVMZW5ndGggfHwgMztcbiAgICAgICAgICAgICAgY29uc3QgbWF4VXNlcm5hbWVMZW5ndGggPSBvcHRpb25zPy5tYXhVc2VybmFtZUxlbmd0aCB8fCAzMDtcbiAgICAgICAgICAgICAgaWYgKHVzZXJuYW1lMi5sZW5ndGggPCBtaW5Vc2VybmFtZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLlVTRVJOQU1FX1RPT19TSE9SVFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmICh1c2VybmFtZTIubGVuZ3RoID4gbWF4VXNlcm5hbWVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSTkFNRV9UT09fTE9OR1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRvciA9IG9wdGlvbnM/LnVzZXJuYW1lVmFsaWRhdG9yIHx8IGRlZmF1bHRVc2VybmFtZVZhbGlkYXRvcjtcbiAgICAgICAgICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCB2YWxpZGF0b3IodXNlcm5hbWUyKTtcbiAgICAgICAgICAgICAgaWYgKCF2YWxpZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcm5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHVzZXJuYW1lMi50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSTkFNRV9JU19BTFJFQURZX1RBS0VOXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9LFxuICAgICRFUlJPUl9DT0RFUzogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFU1xuICB9O1xufTtcblxuZXhwb3J0IHsgdXNlcm5hbWUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   genericOAuth: () => (/* binding */ genericOAuth)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-fetch/fetch */ \"(action-browser)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/decode_jwt.js\");\n\n\n\n\n\n\n\n\n\nasync function getUserInfo(tokens, finalUserInfoUrl) {\n  if (tokens.idToken) {\n    const decoded = (0,jose__WEBPACK_IMPORTED_MODULE_7__.decodeJwt)(tokens.idToken);\n    if (decoded) {\n      if (decoded.sub && decoded.email) {\n        return {\n          id: decoded.sub,\n          emailVerified: decoded.email_verified,\n          image: decoded.picture,\n          ...decoded\n        };\n      }\n    }\n  }\n  if (!finalUserInfoUrl) {\n    return null;\n  }\n  const userInfo = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(finalUserInfoUrl, {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${tokens.accessToken}`\n    }\n  });\n  return {\n    id: userInfo.data?.sub,\n    emailVerified: userInfo.data?.email_verified,\n    email: userInfo.data?.email,\n    image: userInfo.data?.picture,\n    name: userInfo.data?.name,\n    ...userInfo.data\n  };\n}\nvar genericOAuth = (options) => {\n  const ERROR_CODES = {\n    INVALID_OAUTH_CONFIGURATION: \"Invalid OAuth configuration\"\n  };\n  return {\n    id: \"generic-oauth\",\n    init: (ctx) => {\n      const genericProviders = options.config.map((c) => {\n        let finalUserInfoUrl = c.userInfoUrl;\n        return {\n          id: c.providerId,\n          name: c.providerId,\n          createAuthorizationURL(data) {\n            return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.createAuthorizationURL)({\n              id: c.providerId,\n              options: {\n                clientId: c.clientId,\n                clientSecret: c.clientSecret,\n                redirectURI: c.redirectURI\n              },\n              authorizationEndpoint: c.authorizationUrl,\n              state: data.state,\n              codeVerifier: c.pkce ? data.codeVerifier : void 0,\n              scopes: c.scopes || [],\n              redirectURI: `${ctx.baseURL}/oauth2/callback/${c.providerId}`\n            });\n          },\n          async validateAuthorizationCode(data) {\n            let finalTokenUrl = c.tokenUrl;\n            if (c.discoveryUrl) {\n              const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(c.discoveryUrl, {\n                method: \"GET\"\n              });\n              if (discovery.data) {\n                finalTokenUrl = discovery.data.token_endpoint;\n                finalUserInfoUrl = discovery.data.userinfo_endpoint;\n              }\n            }\n            if (!finalTokenUrl) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n                message: \"Invalid OAuth configuration. Token URL not found.\"\n              });\n            }\n            return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.validateAuthorizationCode)({\n              code: data.code,\n              codeVerifier: data.codeVerifier,\n              redirectURI: data.redirectURI,\n              options: {\n                clientId: c.clientId,\n                clientSecret: c.clientSecret,\n                redirectURI: c.redirectURI\n              },\n              tokenEndpoint: finalTokenUrl\n            });\n          },\n          async getUserInfo(tokens) {\n            if (!finalUserInfoUrl) {\n              return null;\n            }\n            const userInfo = c.getUserInfo ? await c.getUserInfo(tokens) : await getUserInfo(tokens, finalUserInfoUrl);\n            if (!userInfo) {\n              return null;\n            }\n            return {\n              user: {\n                id: userInfo?.id,\n                email: userInfo?.email,\n                emailVerified: userInfo?.emailVerified,\n                image: userInfo?.image,\n                name: userInfo?.name,\n                ...c.mapProfileToUser?.(userInfo)\n              },\n              data: userInfo\n            };\n          }\n        };\n      });\n      return {\n        context: {\n          socialProviders: genericProviders.concat(ctx.socialProviders)\n        }\n      };\n    },\n    endpoints: {\n      signInWithOAuth2: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/oauth2\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            providerId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The provider ID for the OAuth provider\"\n            }),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The URL to redirect to after sign in\"\n            }).optional(),\n            errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The URL to redirect to if an error occurs\"\n            }).optional(),\n            newUserCallbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The URL to redirect to after login if the user is new\"\n            }).optional(),\n            disableRedirect: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean({\n              description: \"Disable redirect\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              description: \"Sign in with OAuth2\",\n              responses: {\n                200: {\n                  description: \"Sign in with OAuth2\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          url: {\n                            type: \"string\"\n                          },\n                          redirect: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { providerId } = ctx.body;\n          const config = options.config.find(\n            (c) => c.providerId === providerId\n          );\n          if (!config) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: `No config found for provider ${providerId}`\n            });\n          }\n          const {\n            discoveryUrl,\n            authorizationUrl,\n            tokenUrl,\n            clientId,\n            clientSecret,\n            scopes,\n            redirectURI,\n            responseType,\n            pkce,\n            prompt,\n            accessType,\n            authorizationUrlParams\n          } = config;\n          let finalAuthUrl = authorizationUrl;\n          let finalTokenUrl = tokenUrl;\n          if (discoveryUrl) {\n            const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(discoveryUrl, {\n              onError(context) {\n                ctx.context.logger.error(context.error.message, context.error, {\n                  discoveryUrl\n                });\n              }\n            });\n            if (discovery.data) {\n              finalAuthUrl = discovery.data.authorization_endpoint;\n              finalTokenUrl = discovery.data.token_endpoint;\n            }\n          }\n          if (!finalAuthUrl || !finalTokenUrl) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OAUTH_CONFIGURATION\n            });\n          }\n          if (authorizationUrlParams) {\n            const withAdditionalParams = new URL(finalAuthUrl);\n            for (const [paramName, paramValue] of Object.entries(\n              authorizationUrlParams\n            )) {\n              withAdditionalParams.searchParams.set(paramName, paramValue);\n            }\n            finalAuthUrl = withAdditionalParams.toString();\n          }\n          const { state, codeVerifier } = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__.generateState)(ctx);\n          const authUrl = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.createAuthorizationURL)({\n            id: providerId,\n            options: {\n              clientId,\n              clientSecret,\n              redirectURI\n            },\n            authorizationEndpoint: finalAuthUrl,\n            state,\n            codeVerifier: pkce ? codeVerifier : void 0,\n            scopes: scopes || [],\n            redirectURI: `${ctx.context.baseURL}/oauth2/callback/${providerId}`\n          });\n          if (responseType && responseType !== \"code\") {\n            authUrl.searchParams.set(\"response_type\", responseType);\n          }\n          if (prompt) {\n            authUrl.searchParams.set(\"prompt\", prompt);\n          }\n          if (accessType) {\n            authUrl.searchParams.set(\"access_type\", accessType);\n          }\n          return ctx.json({\n            url: authUrl.toString(),\n            redirect: !ctx.body.disableRedirect\n          });\n        }\n      ),\n      oAuth2Callback: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/callback/:providerId\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The OAuth2 code\"\n            }).optional(),\n            error: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The error message, if any\"\n            }).optional(),\n            state: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The state parameter from the OAuth2 request\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              description: \"OAuth2 callback\",\n              responses: {\n                200: {\n                  description: \"OAuth2 callback\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          url: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (ctx.query.error || !ctx.query.code) {\n            throw ctx.redirect(\n              `${ctx.context.options.baseURL}?error=${ctx.query.error || \"oAuth_code_missing\"}`\n            );\n          }\n          const provider = options.config.find(\n            (p) => p.providerId === ctx.params.providerId\n          );\n          if (!provider) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: `No config found for provider ${ctx.params.providerId}`\n            });\n          }\n          let tokens = void 0;\n          const parsedState = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__.parseState)(ctx);\n          const { callbackURL, codeVerifier, errorURL, newUserURL, link } = parsedState;\n          const code = ctx.query.code;\n          let finalTokenUrl = provider.tokenUrl;\n          let finalUserInfoUrl = provider.userInfoUrl;\n          if (provider.discoveryUrl) {\n            const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(provider.discoveryUrl, {\n              method: \"GET\"\n            });\n            if (discovery.data) {\n              finalTokenUrl = discovery.data.token_endpoint;\n              finalUserInfoUrl = discovery.data.userinfo_endpoint;\n            }\n          }\n          try {\n            if (!finalTokenUrl) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n                message: \"Invalid OAuth configuration.\"\n              });\n            }\n            tokens = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.validateAuthorizationCode)({\n              code,\n              codeVerifier: provider.pkce ? codeVerifier : void 0,\n              redirectURI: `${ctx.context.baseURL}/oauth2/callback/${provider.providerId}`,\n              options: {\n                clientId: provider.clientId,\n                clientSecret: provider.clientSecret,\n                redirectURI: provider.redirectURI\n              },\n              tokenEndpoint: finalTokenUrl\n            });\n          } catch (e) {\n            ctx.context.logger.error(\n              e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n              e\n            );\n            throw ctx.redirect(\n              `${errorURL}?error=oauth_code_verification_failed`\n            );\n          }\n          if (!tokens) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: \"Invalid OAuth configuration.\"\n            });\n          }\n          const userInfo = provider.getUserInfo ? await provider.getUserInfo(tokens) : await getUserInfo(tokens, finalUserInfoUrl);\n          if (!userInfo?.email) {\n            ctx.context.logger.error(\"Unable to get user info\", userInfo);\n            throw ctx.redirect(\n              `${ctx.context.baseURL}/error?error=email_is_missing`\n            );\n          }\n          const mapUser = provider.mapProfileToUser ? await provider.mapProfileToUser(userInfo) : null;\n          if (link) {\n            if (ctx.context.options.account?.accountLinking?.allowDifferentEmails !== true && link.email !== userInfo.email.toLowerCase()) {\n              return redirectOnError(\"email_doesn't_match\");\n            }\n            const newAccount = await ctx.context.internalAdapter.createAccount({\n              userId: link.userId,\n              providerId: provider.providerId,\n              accountId: userInfo.id\n            });\n            if (!newAccount) {\n              return redirectOnError(\"unable_to_link_account\");\n            }\n            let toRedirectTo2;\n            try {\n              const url = callbackURL;\n              toRedirectTo2 = url.toString();\n            } catch {\n              toRedirectTo2 = callbackURL;\n            }\n            throw ctx.redirect(toRedirectTo2);\n          }\n          const result = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.handleOAuthUserInfo)(ctx, {\n            userInfo: {\n              ...userInfo,\n              ...mapUser\n            },\n            account: {\n              providerId: provider.providerId,\n              accountId: userInfo.id,\n              ...tokens,\n              scope: tokens.scopes?.join(\",\")\n            }\n          });\n          function redirectOnError(error) {\n            throw ctx.redirect(\n              `${errorURL || callbackURL || `${ctx.context.baseURL}/error`}?error=${error}`\n            );\n          }\n          if (result.error) {\n            return redirectOnError(result.error.split(\" \").join(\"_\"));\n          }\n          const { session, user } = result.data;\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n            session,\n            user\n          });\n          let toRedirectTo;\n          try {\n            const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n            toRedirectTo = url.toString();\n          } catch {\n            toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n          }\n          throw ctx.redirect(toRedirectTo);\n        }\n      ),\n      oAuth2LinkAccount: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/link\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            providerId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string(),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string()\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware]\n        },\n        async (c) => {\n          const session = c.context.session;\n          const account = await c.context.internalAdapter.findAccounts(\n            session.user.id\n          );\n          const existingAccount = account.find(\n            (a) => a.providerId === c.body.providerId\n          );\n          if (existingAccount) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.SOCIAL_ACCOUNT_ALREADY_LINKED\n            });\n          }\n          const provider = options.config.find(\n            (p) => p.providerId === c.body.providerId\n          );\n          if (!provider) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"NOT_FOUND\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n            });\n          }\n          const {\n            providerId,\n            clientId,\n            clientSecret,\n            redirectURI,\n            authorizationUrl,\n            discoveryUrl,\n            pkce,\n            scopes\n          } = provider;\n          let finalAuthUrl = authorizationUrl;\n          if (!finalAuthUrl) {\n            if (!discoveryUrl) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.INVALID_OAUTH_CONFIGURATION\n              });\n            }\n            const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(discoveryUrl, {\n              onError(context) {\n                c.context.logger.error(context.error.message, context.error, {\n                  discoveryUrl\n                });\n              }\n            });\n            if (discovery.data) {\n              finalAuthUrl = discovery.data.authorization_endpoint;\n            }\n          }\n          if (!finalAuthUrl) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OAUTH_CONFIGURATION\n            });\n          }\n          const state = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__.generateState)(c, {\n            userId: session.user.id,\n            email: session.user.email\n          });\n          const url = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.createAuthorizationURL)({\n            id: providerId,\n            options: {\n              clientId,\n              clientSecret,\n              redirectURI: redirectURI || `${c.context.baseURL}/oauth2/callback`\n            },\n            authorizationEndpoint: finalAuthUrl,\n            state: state.state,\n            codeVerifier: pkce ? state.codeVerifier : void 0,\n            scopes: scopes || [],\n            redirectURI: `${c.context.baseURL}/oauth2/callback/${providerId}`\n          });\n          return c.json({\n            url: url.toString(),\n            redirect: true\n          });\n        }\n      )\n    },\n    $ERROR_CODES: ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTklVVzRXRjcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQW1IO0FBQzNCO0FBQ2pDO0FBQ1M7QUFDZDtBQUNYO0FBQ2Y7QUFDUzs7QUFFakM7QUFDQTtBQUNBLG9CQUFvQiwrQ0FBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLGdFQUFXO0FBQ3BDO0FBQ0E7QUFDQSwrQkFBK0IsbUJBQW1CO0FBQ2xEO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDBFQUFzQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLFlBQVksbUJBQW1CLGFBQWE7QUFDMUUsYUFBYTtBQUNiLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsZ0VBQVc7QUFDakQ7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlEQUFRO0FBQ2hDO0FBQ0EsZUFBZTtBQUNmO0FBQ0EsbUJBQW1CLDZFQUF5QjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFD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Q0FBb0MsZ0VBQVc7QUFDL0M7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQSw4QkFBOEIsaUVBQWE7QUFDM0M7QUFDQTtBQUNBLFdBQVc7QUFDWCw0QkFBNEIsMEVBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLGtCQUFrQjtBQUMvRCxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0JBQWtCLG1CQUFtQixXQUFXO0FBQzVFLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTklVVzRXRjcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBoYW5kbGVPQXV0aFVzZXJJbmZvLCBzZXNzaW9uTWlkZGxld2FyZSwgQkFTRV9FUlJPUl9DT0RFUyB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aG9yaXphdGlvblVSTCwgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSB9IGZyb20gJy4vY2h1bmstR1RRTTdKVTcuanMnO1xuaW1wb3J0IHsgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVTdGF0ZSwgcGFyc2VTdGF0ZSB9IGZyb20gJy4vY2h1bmstTlBPNjRTVk4uanMnO1xuaW1wb3J0IHsgYmV0dGVyRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBkZWNvZGVKd3QgfSBmcm9tICdqb3NlJztcblxuYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckluZm8odG9rZW5zLCBmaW5hbFVzZXJJbmZvVXJsKSB7XG4gIGlmICh0b2tlbnMuaWRUb2tlbikge1xuICAgIGNvbnN0IGRlY29kZWQgPSBkZWNvZGVKd3QodG9rZW5zLmlkVG9rZW4pO1xuICAgIGlmIChkZWNvZGVkKSB7XG4gICAgICBpZiAoZGVjb2RlZC5zdWIgJiYgZGVjb2RlZC5lbWFpbCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBkZWNvZGVkLnN1YixcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBkZWNvZGVkLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgIGltYWdlOiBkZWNvZGVkLnBpY3R1cmUsXG4gICAgICAgICAgLi4uZGVjb2RlZFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAoIWZpbmFsVXNlckluZm9VcmwpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IGJldHRlckZldGNoKGZpbmFsVXNlckluZm9VcmwsIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgaGVhZGVyczoge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2Vucy5hY2Nlc3NUb2tlbn1gXG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBpZDogdXNlckluZm8uZGF0YT8uc3ViLFxuICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXJJbmZvLmRhdGE/LmVtYWlsX3ZlcmlmaWVkLFxuICAgIGVtYWlsOiB1c2VySW5mby5kYXRhPy5lbWFpbCxcbiAgICBpbWFnZTogdXNlckluZm8uZGF0YT8ucGljdHVyZSxcbiAgICBuYW1lOiB1c2VySW5mby5kYXRhPy5uYW1lLFxuICAgIC4uLnVzZXJJbmZvLmRhdGFcbiAgfTtcbn1cbnZhciBnZW5lcmljT0F1dGggPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBFUlJPUl9DT0RFUyA9IHtcbiAgICBJTlZBTElEX09BVVRIX0NPTkZJR1VSQVRJT046IFwiSW52YWxpZCBPQXV0aCBjb25maWd1cmF0aW9uXCJcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnZW5lcmljLW9hdXRoXCIsXG4gICAgaW5pdDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgZ2VuZXJpY1Byb3ZpZGVycyA9IG9wdGlvbnMuY29uZmlnLm1hcCgoYykgPT4ge1xuICAgICAgICBsZXQgZmluYWxVc2VySW5mb1VybCA9IGMudXNlckluZm9Vcmw7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IGMucHJvdmlkZXJJZCxcbiAgICAgICAgICBuYW1lOiBjLnByb3ZpZGVySWQsXG4gICAgICAgICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgICAgICAgIGlkOiBjLnByb3ZpZGVySWQsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBjbGllbnRJZDogYy5jbGllbnRJZCxcbiAgICAgICAgICAgICAgICBjbGllbnRTZWNyZXQ6IGMuY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiBjLnJlZGlyZWN0VVJJXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogYy5hdXRob3JpemF0aW9uVXJsLFxuICAgICAgICAgICAgICBzdGF0ZTogZGF0YS5zdGF0ZSxcbiAgICAgICAgICAgICAgY29kZVZlcmlmaWVyOiBjLnBrY2UgPyBkYXRhLmNvZGVWZXJpZmllciA6IHZvaWQgMCxcbiAgICAgICAgICAgICAgc2NvcGVzOiBjLnNjb3BlcyB8fCBbXSxcbiAgICAgICAgICAgICAgcmVkaXJlY3RVUkk6IGAke2N0eC5iYXNlVVJMfS9vYXV0aDIvY2FsbGJhY2svJHtjLnByb3ZpZGVySWR9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKGRhdGEpIHtcbiAgICAgICAgICAgIGxldCBmaW5hbFRva2VuVXJsID0gYy50b2tlblVybDtcbiAgICAgICAgICAgIGlmIChjLmRpc2NvdmVyeVVybCkge1xuICAgICAgICAgICAgICBjb25zdCBkaXNjb3ZlcnkgPSBhd2FpdCBiZXR0ZXJGZXRjaChjLmRpc2NvdmVyeVVybCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgZmluYWxUb2tlblVybCA9IGRpc2NvdmVyeS5kYXRhLnRva2VuX2VuZHBvaW50O1xuICAgICAgICAgICAgICAgIGZpbmFsVXNlckluZm9VcmwgPSBkaXNjb3ZlcnkuZGF0YS51c2VyaW5mb19lbmRwb2ludDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFmaW5hbFRva2VuVXJsKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgT0F1dGggY29uZmlndXJhdGlvbi4gVG9rZW4gVVJMIG5vdCBmb3VuZC5cIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgICAgICAgY29kZTogZGF0YS5jb2RlLFxuICAgICAgICAgICAgICBjb2RlVmVyaWZpZXI6IGRhdGEuY29kZVZlcmlmaWVyLFxuICAgICAgICAgICAgICByZWRpcmVjdFVSSTogZGF0YS5yZWRpcmVjdFVSSSxcbiAgICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICAgIGNsaWVudElkOiBjLmNsaWVudElkLFxuICAgICAgICAgICAgICAgIGNsaWVudFNlY3JldDogYy5jbGllbnRTZWNyZXQsXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RVUkk6IGMucmVkaXJlY3RVUklcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdG9rZW5FbmRwb2ludDogZmluYWxUb2tlblVybFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbnMpIHtcbiAgICAgICAgICAgIGlmICghZmluYWxVc2VySW5mb1VybCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHVzZXJJbmZvID0gYy5nZXRVc2VySW5mbyA/IGF3YWl0IGMuZ2V0VXNlckluZm8odG9rZW5zKSA6IGF3YWl0IGdldFVzZXJJbmZvKHRva2VucywgZmluYWxVc2VySW5mb1VybCk7XG4gICAgICAgICAgICBpZiAoIXVzZXJJbmZvKSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1c2VySW5mbz8uaWQsXG4gICAgICAgICAgICAgICAgZW1haWw6IHVzZXJJbmZvPy5lbWFpbCxcbiAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mbz8uZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBpbWFnZTogdXNlckluZm8/LmltYWdlLFxuICAgICAgICAgICAgICAgIG5hbWU6IHVzZXJJbmZvPy5uYW1lLFxuICAgICAgICAgICAgICAgIC4uLmMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXJJbmZvKVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBkYXRhOiB1c2VySW5mb1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICBzb2NpYWxQcm92aWRlcnM6IGdlbmVyaWNQcm92aWRlcnMuY29uY2F0KGN0eC5zb2NpYWxQcm92aWRlcnMpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNpZ25JbldpdGhPQXV0aDI6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvc2lnbi1pbi9vYXV0aDJcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvdmlkZXIgSUQgZm9yIHRoZSBPQXV0aCBwcm92aWRlclwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgc2lnbiBpblwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgZXJyb3JDYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIGFuIGVycm9yIG9jY3Vyc1wiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgbmV3VXNlckNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgbG9naW4gaWYgdGhlIHVzZXIgaXMgbmV3XCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBkaXNhYmxlUmVkaXJlY3Q6IHouYm9vbGVhbih7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2FibGUgcmVkaXJlY3RcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gaW4gd2l0aCBPQXV0aDJcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggT0F1dGgyXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgcHJvdmlkZXJJZCB9ID0gY3R4LmJvZHk7XG4gICAgICAgICAgY29uc3QgY29uZmlnID0gb3B0aW9ucy5jb25maWcuZmluZChcbiAgICAgICAgICAgIChjKSA9PiBjLnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghY29uZmlnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGBObyBjb25maWcgZm91bmQgZm9yIHByb3ZpZGVyICR7cHJvdmlkZXJJZH1gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgZGlzY292ZXJ5VXJsLFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvblVybCxcbiAgICAgICAgICAgIHRva2VuVXJsLFxuICAgICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgICBjbGllbnRTZWNyZXQsXG4gICAgICAgICAgICBzY29wZXMsXG4gICAgICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgIHBrY2UsXG4gICAgICAgICAgICBwcm9tcHQsXG4gICAgICAgICAgICBhY2Nlc3NUeXBlLFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvblVybFBhcmFtc1xuICAgICAgICAgIH0gPSBjb25maWc7XG4gICAgICAgICAgbGV0IGZpbmFsQXV0aFVybCA9IGF1dGhvcml6YXRpb25Vcmw7XG4gICAgICAgICAgbGV0IGZpbmFsVG9rZW5VcmwgPSB0b2tlblVybDtcbiAgICAgICAgICBpZiAoZGlzY292ZXJ5VXJsKSB7XG4gICAgICAgICAgICBjb25zdCBkaXNjb3ZlcnkgPSBhd2FpdCBiZXR0ZXJGZXRjaChkaXNjb3ZlcnlVcmwsIHtcbiAgICAgICAgICAgICAgb25FcnJvcihjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGNvbnRleHQuZXJyb3IubWVzc2FnZSwgY29udGV4dC5lcnJvciwge1xuICAgICAgICAgICAgICAgICAgZGlzY292ZXJ5VXJsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhKSB7XG4gICAgICAgICAgICAgIGZpbmFsQXV0aFVybCA9IGRpc2NvdmVyeS5kYXRhLmF1dGhvcml6YXRpb25fZW5kcG9pbnQ7XG4gICAgICAgICAgICAgIGZpbmFsVG9rZW5VcmwgPSBkaXNjb3ZlcnkuZGF0YS50b2tlbl9lbmRwb2ludDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFmaW5hbEF1dGhVcmwgfHwgIWZpbmFsVG9rZW5VcmwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9PQVVUSF9DT05GSUdVUkFUSU9OXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGF1dGhvcml6YXRpb25VcmxQYXJhbXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHdpdGhBZGRpdGlvbmFsUGFyYW1zID0gbmV3IFVSTChmaW5hbEF1dGhVcmwpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBbcGFyYW1OYW1lLCBwYXJhbVZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhcbiAgICAgICAgICAgICAgYXV0aG9yaXphdGlvblVybFBhcmFtc1xuICAgICAgICAgICAgKSkge1xuICAgICAgICAgICAgICB3aXRoQWRkaXRpb25hbFBhcmFtcy5zZWFyY2hQYXJhbXMuc2V0KHBhcmFtTmFtZSwgcGFyYW1WYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbEF1dGhVcmwgPSB3aXRoQWRkaXRpb25hbFBhcmFtcy50b1N0cmluZygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB7IHN0YXRlLCBjb2RlVmVyaWZpZXIgfSA9IGF3YWl0IGdlbmVyYXRlU3RhdGUoY3R4KTtcbiAgICAgICAgICBjb25zdCBhdXRoVXJsID0gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgICAgICBpZDogcHJvdmlkZXJJZCxcbiAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgICAgIGNsaWVudFNlY3JldCxcbiAgICAgICAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IGZpbmFsQXV0aFVybCxcbiAgICAgICAgICAgIHN0YXRlLFxuICAgICAgICAgICAgY29kZVZlcmlmaWVyOiBwa2NlID8gY29kZVZlcmlmaWVyIDogdm9pZCAwLFxuICAgICAgICAgICAgc2NvcGVzOiBzY29wZXMgfHwgW10sXG4gICAgICAgICAgICByZWRpcmVjdFVSSTogYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vb2F1dGgyL2NhbGxiYWNrLyR7cHJvdmlkZXJJZH1gXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlVHlwZSAmJiByZXNwb25zZVR5cGUgIT09IFwiY29kZVwiKSB7XG4gICAgICAgICAgICBhdXRoVXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV90eXBlXCIsIHJlc3BvbnNlVHlwZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChwcm9tcHQpIHtcbiAgICAgICAgICAgIGF1dGhVcmwuc2VhcmNoUGFyYW1zLnNldChcInByb21wdFwiLCBwcm9tcHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYWNjZXNzVHlwZSkge1xuICAgICAgICAgICAgYXV0aFVybC5zZWFyY2hQYXJhbXMuc2V0KFwiYWNjZXNzX3R5cGVcIiwgYWNjZXNzVHlwZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB1cmw6IGF1dGhVcmwudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIHJlZGlyZWN0OiAhY3R4LmJvZHkuZGlzYWJsZVJlZGlyZWN0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBvQXV0aDJDYWxsYmFjazogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvY2FsbGJhY2svOnByb3ZpZGVySWRcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgICAgICAgY29kZTogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgT0F1dGgyIGNvZGVcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGVycm9yOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlcnJvciBtZXNzYWdlLCBpZiBhbnlcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIHN0YXRlOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBzdGF0ZSBwYXJhbWV0ZXIgZnJvbSB0aGUgT0F1dGgyIHJlcXVlc3RcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk9BdXRoMiBjYWxsYmFja1wiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk9BdXRoMiBjYWxsYmFja1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKGN0eC5xdWVyeS5lcnJvciB8fCAhY3R4LnF1ZXJ5LmNvZGUpIHtcbiAgICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgICAgICAgYCR7Y3R4LmNvbnRleHQub3B0aW9ucy5iYXNlVVJMfT9lcnJvcj0ke2N0eC5xdWVyeS5lcnJvciB8fCBcIm9BdXRoX2NvZGVfbWlzc2luZ1wifWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHByb3ZpZGVyID0gb3B0aW9ucy5jb25maWcuZmluZChcbiAgICAgICAgICAgIChwKSA9PiBwLnByb3ZpZGVySWQgPT09IGN0eC5wYXJhbXMucHJvdmlkZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBgTm8gY29uZmlnIGZvdW5kIGZvciBwcm92aWRlciAke2N0eC5wYXJhbXMucHJvdmlkZXJJZH1gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IHRva2VucyA9IHZvaWQgMDtcbiAgICAgICAgICBjb25zdCBwYXJzZWRTdGF0ZSA9IGF3YWl0IHBhcnNlU3RhdGUoY3R4KTtcbiAgICAgICAgICBjb25zdCB7IGNhbGxiYWNrVVJMLCBjb2RlVmVyaWZpZXIsIGVycm9yVVJMLCBuZXdVc2VyVVJMLCBsaW5rIH0gPSBwYXJzZWRTdGF0ZTtcbiAgICAgICAgICBjb25zdCBjb2RlID0gY3R4LnF1ZXJ5LmNvZGU7XG4gICAgICAgICAgbGV0IGZpbmFsVG9rZW5VcmwgPSBwcm92aWRlci50b2tlblVybDtcbiAgICAgICAgICBsZXQgZmluYWxVc2VySW5mb1VybCA9IHByb3ZpZGVyLnVzZXJJbmZvVXJsO1xuICAgICAgICAgIGlmIChwcm92aWRlci5kaXNjb3ZlcnlVcmwpIHtcbiAgICAgICAgICAgIGNvbnN0IGRpc2NvdmVyeSA9IGF3YWl0IGJldHRlckZldGNoKHByb3ZpZGVyLmRpc2NvdmVyeVVybCwge1xuICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhKSB7XG4gICAgICAgICAgICAgIGZpbmFsVG9rZW5VcmwgPSBkaXNjb3ZlcnkuZGF0YS50b2tlbl9lbmRwb2ludDtcbiAgICAgICAgICAgICAgZmluYWxVc2VySW5mb1VybCA9IGRpc2NvdmVyeS5kYXRhLnVzZXJpbmZvX2VuZHBvaW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFmaW5hbFRva2VuVXJsKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgT0F1dGggY29uZmlndXJhdGlvbi5cIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRva2VucyA9IGF3YWl0IHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICBjb2RlVmVyaWZpZXI6IHByb3ZpZGVyLnBrY2UgPyBjb2RlVmVyaWZpZXIgOiB2b2lkIDAsXG4gICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9vYXV0aDIvY2FsbGJhY2svJHtwcm92aWRlci5wcm92aWRlcklkfWAsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBjbGllbnRJZDogcHJvdmlkZXIuY2xpZW50SWQsXG4gICAgICAgICAgICAgICAgY2xpZW50U2VjcmV0OiBwcm92aWRlci5jbGllbnRTZWNyZXQsXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RVUkk6IHByb3ZpZGVyLnJlZGlyZWN0VVJJXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRva2VuRW5kcG9pbnQ6IGZpbmFsVG9rZW5VcmxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgICAgZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlID8gZS5uYW1lIDogXCJcIixcbiAgICAgICAgICAgICAgZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgICAgICAgYCR7ZXJyb3JVUkx9P2Vycm9yPW9hdXRoX2NvZGVfdmVyaWZpY2F0aW9uX2ZhaWxlZGBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghdG9rZW5zKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBPQXV0aCBjb25maWd1cmF0aW9uLlwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXNlckluZm8gPSBwcm92aWRlci5nZXRVc2VySW5mbyA/IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHRva2VucykgOiBhd2FpdCBnZXRVc2VySW5mbyh0b2tlbnMsIGZpbmFsVXNlckluZm9VcmwpO1xuICAgICAgICAgIGlmICghdXNlckluZm8/LmVtYWlsKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVbmFibGUgdG8gZ2V0IHVzZXIgaW5mb1wiLCB1c2VySW5mbyk7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgICAgICAgIGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPWVtYWlsX2lzX21pc3NpbmdgXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBtYXBVc2VyID0gcHJvdmlkZXIubWFwUHJvZmlsZVRvVXNlciA/IGF3YWl0IHByb3ZpZGVyLm1hcFByb2ZpbGVUb1VzZXIodXNlckluZm8pIDogbnVsbDtcbiAgICAgICAgICBpZiAobGluaykge1xuICAgICAgICAgICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93RGlmZmVyZW50RW1haWxzICE9PSB0cnVlICYmIGxpbmsuZW1haWwgIT09IHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImVtYWlsX2RvZXNuJ3RfbWF0Y2hcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBuZXdBY2NvdW50ID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoe1xuICAgICAgICAgICAgICB1c2VySWQ6IGxpbmsudXNlcklkLFxuICAgICAgICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5wcm92aWRlcklkLFxuICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLmlkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghbmV3QWNjb3VudCkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hYmxlX3RvX2xpbmtfYWNjb3VudFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCB0b1JlZGlyZWN0VG8yO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgdXJsID0gY2FsbGJhY2tVUkw7XG4gICAgICAgICAgICAgIHRvUmVkaXJlY3RUbzIgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICB0b1JlZGlyZWN0VG8yID0gY2FsbGJhY2tVUkw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QodG9SZWRpcmVjdFRvMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZU9BdXRoVXNlckluZm8oY3R4LCB7XG4gICAgICAgICAgICB1c2VySW5mbzoge1xuICAgICAgICAgICAgICAuLi51c2VySW5mbyxcbiAgICAgICAgICAgICAgLi4ubWFwVXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFjY291bnQ6IHtcbiAgICAgICAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIucHJvdmlkZXJJZCxcbiAgICAgICAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZCxcbiAgICAgICAgICAgICAgLi4udG9rZW5zLFxuICAgICAgICAgICAgICBzY29wZTogdG9rZW5zLnNjb3Blcz8uam9pbihcIixcIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBmdW5jdGlvbiByZWRpcmVjdE9uRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgICAgICAgYCR7ZXJyb3JVUkwgfHwgY2FsbGJhY2tVUkwgfHwgYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgfT9lcnJvcj0ke2Vycm9yfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IocmVzdWx0LmVycm9yLnNwbGl0KFwiIFwiKS5qb2luKFwiX1wiKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHsgc2Vzc2lvbiwgdXNlciB9ID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbGV0IHRvUmVkaXJlY3RUbztcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdXJsID0gcmVzdWx0LmlzUmVnaXN0ZXIgPyBuZXdVc2VyVVJMIHx8IGNhbGxiYWNrVVJMIDogY2FsbGJhY2tVUkw7XG4gICAgICAgICAgICB0b1JlZGlyZWN0VG8gPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHRvUmVkaXJlY3RUbyA9IHJlc3VsdC5pc1JlZ2lzdGVyID8gbmV3VXNlclVSTCB8fCBjYWxsYmFja1VSTCA6IGNhbGxiYWNrVVJMO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QodG9SZWRpcmVjdFRvKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIG9BdXRoMkxpbmtBY2NvdW50OiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL29hdXRoMi9saW5rXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHouc3RyaW5nKCksXG4gICAgICAgICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoYykgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICAgICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICAgICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nQWNjb3VudCA9IGFjY291bnQuZmluZChcbiAgICAgICAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IGMuYm9keS5wcm92aWRlcklkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoZXhpc3RpbmdBY2NvdW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuU09DSUFMX0FDQ09VTlRfQUxSRUFEWV9MSU5LRURcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBwcm92aWRlciA9IG9wdGlvbnMuY29uZmlnLmZpbmQoXG4gICAgICAgICAgICAocCkgPT4gcC5wcm92aWRlcklkID09PSBjLmJvZHkucHJvdmlkZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QUk9WSURFUl9OT1RfRk9VTkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBwcm92aWRlcklkLFxuICAgICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgICBjbGllbnRTZWNyZXQsXG4gICAgICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb25VcmwsXG4gICAgICAgICAgICBkaXNjb3ZlcnlVcmwsXG4gICAgICAgICAgICBwa2NlLFxuICAgICAgICAgICAgc2NvcGVzXG4gICAgICAgICAgfSA9IHByb3ZpZGVyO1xuICAgICAgICAgIGxldCBmaW5hbEF1dGhVcmwgPSBhdXRob3JpemF0aW9uVXJsO1xuICAgICAgICAgIGlmICghZmluYWxBdXRoVXJsKSB7XG4gICAgICAgICAgICBpZiAoIWRpc2NvdmVyeVVybCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9PQVVUSF9DT05GSUdVUkFUSU9OXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZGlzY292ZXJ5ID0gYXdhaXQgYmV0dGVyRmV0Y2goZGlzY292ZXJ5VXJsLCB7XG4gICAgICAgICAgICAgIG9uRXJyb3IoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoY29udGV4dC5lcnJvci5tZXNzYWdlLCBjb250ZXh0LmVycm9yLCB7XG4gICAgICAgICAgICAgICAgICBkaXNjb3ZlcnlVcmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoZGlzY292ZXJ5LmRhdGEpIHtcbiAgICAgICAgICAgICAgZmluYWxBdXRoVXJsID0gZGlzY292ZXJ5LmRhdGEuYXV0aG9yaXphdGlvbl9lbmRwb2ludDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFmaW5hbEF1dGhVcmwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9PQVVUSF9DT05GSUdVUkFUSU9OXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBnZW5lcmF0ZVN0YXRlKGMsIHtcbiAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICAgICAgaWQ6IHByb3ZpZGVySWQsXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICAgICAgICBjbGllbnRTZWNyZXQsXG4gICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiByZWRpcmVjdFVSSSB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vb2F1dGgyL2NhbGxiYWNrYFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogZmluYWxBdXRoVXJsLFxuICAgICAgICAgICAgc3RhdGU6IHN0YXRlLnN0YXRlLFxuICAgICAgICAgICAgY29kZVZlcmlmaWVyOiBwa2NlID8gc3RhdGUuY29kZVZlcmlmaWVyIDogdm9pZCAwLFxuICAgICAgICAgICAgc2NvcGVzOiBzY29wZXMgfHwgW10sXG4gICAgICAgICAgICByZWRpcmVjdFVSSTogYCR7Yy5jb250ZXh0LmJhc2VVUkx9L29hdXRoMi9jYWxsYmFjay8ke3Byb3ZpZGVySWR9YFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgICAgICAgdXJsOiB1cmwudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIHJlZGlyZWN0OiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgICRFUlJPUl9DT0RFUzogRVJST1JfQ09ERVNcbiAgfTtcbn07XG5cbmV4cG9ydCB7IGdlbmVyaWNPQXV0aCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   admin: () => (/* binding */ admin)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\n\nvar getEndpointResponse = async (ctx) => {\n  const returned = ctx.context.returned;\n  if (!returned) {\n    return null;\n  }\n  if (returned instanceof Response) {\n    if (returned.status !== 200) {\n      return null;\n    }\n    return await returned.clone().json();\n  }\n  if (returned instanceof better_call__WEBPACK_IMPORTED_MODULE_5__.APIError) {\n    return null;\n  }\n  return returned;\n};\n\n// src/plugins/admin/index.ts\nvar admin = (options) => {\n  const opts = {\n    defaultRole: \"user\",\n    adminRole: \"admin\",\n    ...options\n  };\n  const ERROR_CODES = {\n    FAILED_TO_CREATE_USER: \"Failed to create user\",\n    USER_ALREADY_EXISTS: \"User already exists\",\n    USER_NOT_FOUND: \"User not found\",\n    YOU_CANNOT_BAN_YOURSELF: \"You cannot ban yourself\",\n    ONLY_ADMINS_CAN_ACCESS_THIS_ENDPOINT: \"Only admins can access this endpoint\"\n  };\n  const adminMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n    if (!session?.session) {\n      throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    const user = session.user;\n    if (!user.role || (Array.isArray(opts.adminRole) ? !opts.adminRole.includes(user.role) : user.role !== opts.adminRole)) {\n      throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"FORBIDDEN\", {\n        message: \"Only admins can access this endpoint\"\n      });\n    }\n    return {\n      session: {\n        user,\n        session: session.session\n      }\n    };\n  });\n  return {\n    id: \"admin\",\n    init(ctx) {\n      return {\n        options: {\n          databaseHooks: {\n            user: {\n              create: {\n                async before(user) {\n                  if (options?.defaultRole === false) {\n                    return;\n                  }\n                  return {\n                    data: {\n                      role: options?.defaultRole ?? \"user\"\n                    }\n                  };\n                }\n              }\n            },\n            session: {\n              create: {\n                async before(session) {\n                  const user = await ctx.internalAdapter.findUserById(\n                    session.userId\n                  );\n                  if (user.banned) {\n                    if (user.banExpires && user.banExpires.getTime() < Date.now()) {\n                      await ctx.internalAdapter.updateUser(session.userId, {\n                        banned: false,\n                        banReason: null,\n                        banExpires: null\n                      });\n                      return;\n                    }\n                    return false;\n                  }\n                }\n              }\n            }\n          }\n        }\n      };\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return context.path === \"/list-sessions\";\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const response = await getEndpointResponse(ctx);\n            if (!response) {\n              return;\n            }\n            const newJson = response.filter((session) => {\n              return !session.impersonatedBy;\n            });\n            return ctx.json(newJson);\n          })\n        }\n      ]\n    },\n    endpoints: {\n      setRole: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/set-role\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            }),\n            role: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The role to set. `admin` or `user` by default\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"setRole\",\n              summary: \"Set the role of a user\",\n              description: \"Set the role of a user\",\n              responses: {\n                200: {\n                  description: \"User role updated\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            ctx.body.userId,\n            {\n              role: ctx.body.role\n            }\n          );\n          return ctx.json({\n            user: updatedUser\n          });\n        }\n      ),\n      createUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/create-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The email of the user\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The password of the user\"\n            }),\n            name: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The name of the user\"\n            }),\n            role: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The role of the user\"\n            }),\n            /**\n             * extra fields for user\n             */\n            data: zod__WEBPACK_IMPORTED_MODULE_4__.z.optional(\n              zod__WEBPACK_IMPORTED_MODULE_4__.z.record(zod__WEBPACK_IMPORTED_MODULE_4__.z.any(), {\n                description: \"Extra fields for the user. Including custom additional fields.\"\n              })\n            )\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"createUser\",\n              summary: \"Create a new user\",\n              description: \"Create a new user\",\n              responses: {\n                200: {\n                  description: \"User created\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const existUser = await ctx.context.internalAdapter.findUserByEmail(\n            ctx.body.email\n          );\n          if (existUser) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_ALREADY_EXISTS\n            });\n          }\n          const user = await ctx.context.internalAdapter.createUser({\n            email: ctx.body.email,\n            name: ctx.body.name,\n            role: ctx.body.role,\n            ...ctx.body.data\n          });\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: ERROR_CODES.FAILED_TO_CREATE_USER\n            });\n          }\n          const hashedPassword = await ctx.context.password.hash(\n            ctx.body.password\n          );\n          await ctx.context.internalAdapter.linkAccount({\n            accountId: user.id,\n            providerId: \"credential\",\n            password: hashedPassword,\n            userId: user.id\n          });\n          return ctx.json({\n            user\n          });\n        }\n      ),\n      listUsers: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/list-users\",\n        {\n          method: \"GET\",\n          use: [adminMiddleware],\n          query: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            searchValue: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The value to search for\"\n            }).optional(),\n            searchField: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"email\", \"name\"], {\n              description: \"The field to search in, defaults to email. Can be `email` or `name`\"\n            }).optional(),\n            searchOperator: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"contains\", \"starts_with\", \"ends_with\"], {\n              description: \"The operator to use for the search. Can be `contains`, `starts_with` or `ends_with`\"\n            }).optional(),\n            limit: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The number of users to return\"\n            }).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.number()).optional(),\n            offset: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The offset to start from\"\n            }).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.number()).optional(),\n            sortBy: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The field to sort by\"\n            }).optional(),\n            sortDirection: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"asc\", \"desc\"], {\n              description: \"The direction to sort by\"\n            }).optional(),\n            filterField: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The field to filter by\"\n            }).optional(),\n            filterValue: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The value to filter by\"\n            }).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.number()).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.boolean()).optional(),\n            filterOperator: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"eq\", \"ne\", \"lt\", \"lte\", \"gt\", \"gte\"], {\n              description: \"The operator to use for the filter\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              operationId: \"listUsers\",\n              summary: \"List users\",\n              description: \"List users\",\n              responses: {\n                200: {\n                  description: \"List of users\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          users: {\n                            type: \"array\",\n                            items: {\n                              $ref: \"#/components/schemas/User\"\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const where = [];\n          if (ctx.query?.searchValue) {\n            where.push({\n              field: ctx.query.searchField || \"email\",\n              operator: ctx.query.searchOperator || \"contains\",\n              value: ctx.query.searchValue\n            });\n          }\n          if (ctx.query?.filterValue) {\n            where.push({\n              field: ctx.query.filterField || \"email\",\n              operator: ctx.query.filterOperator || \"eq\",\n              value: ctx.query.filterValue\n            });\n          }\n          try {\n            const users = await ctx.context.internalAdapter.listUsers(\n              Number(ctx.query?.limit) || void 0,\n              Number(ctx.query?.offset) || void 0,\n              ctx.query?.sortBy ? {\n                field: ctx.query.sortBy,\n                direction: ctx.query.sortDirection || \"asc\"\n              } : void 0,\n              where.length ? where : void 0\n            );\n            return ctx.json({\n              users\n            });\n          } catch (e) {\n            return ctx.json({\n              users: []\n            });\n          }\n        }\n      ),\n      listUserSessions: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/list-user-sessions\",\n        {\n          method: \"POST\",\n          use: [adminMiddleware],\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              operationId: \"listUserSessions\",\n              summary: \"List user sessions\",\n              description: \"List user sessions\",\n              responses: {\n                200: {\n                  description: \"List of user sessions\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          sessions: {\n                            type: \"array\",\n                            items: {\n                              $ref: \"#/components/schemas/Session\"\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const sessions = await ctx.context.internalAdapter.listSessions(\n            ctx.body.userId\n          );\n          return {\n            sessions\n          };\n        }\n      ),\n      unbanUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/unban-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"unbanUser\",\n              summary: \"Unban a user\",\n              description: \"Unban a user\",\n              responses: {\n                200: {\n                  description: \"User unbanned\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const user = await ctx.context.internalAdapter.updateUser(\n            ctx.body.userId,\n            {\n              banned: false,\n              banExpires: null,\n              banReason: null\n            }\n          );\n          return ctx.json({\n            user\n          });\n        }\n      ),\n      banUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/ban-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            }),\n            /**\n             * Reason for the ban\n             */\n            banReason: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The reason for the ban\"\n            }).optional(),\n            /**\n             * Number of seconds until the ban expires\n             */\n            banExpiresIn: zod__WEBPACK_IMPORTED_MODULE_4__.z.number({\n              description: \"The number of seconds until the ban expires\"\n            }).optional()\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"banUser\",\n              summary: \"Ban a user\",\n              description: \"Ban a user\",\n              responses: {\n                200: {\n                  description: \"User banned\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (ctx.body.userId === ctx.context.session.user.id) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.YOU_CANNOT_BAN_YOURSELF\n            });\n          }\n          const user = await ctx.context.internalAdapter.updateUser(\n            ctx.body.userId,\n            {\n              banned: true,\n              banReason: ctx.body.banReason || options?.defaultBanReason || \"No reason\",\n              banExpires: ctx.body.banExpiresIn ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(ctx.body.banExpiresIn, \"sec\") : options?.defaultBanExpiresIn ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(options.defaultBanExpiresIn, \"sec\") : void 0\n            }\n          );\n          await ctx.context.internalAdapter.deleteSessions(ctx.body.userId);\n          return ctx.json({\n            user\n          });\n        }\n      ),\n      impersonateUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/impersonate-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"impersonateUser\",\n              summary: \"Impersonate a user\",\n              description: \"Impersonate a user\",\n              responses: {\n                200: {\n                  description: \"Impersonation session created\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          },\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const targetUser = await ctx.context.internalAdapter.findUserById(\n            ctx.body.userId\n          );\n          if (!targetUser) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"NOT_FOUND\", {\n              message: \"User not found\"\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            targetUser.id,\n            void 0,\n            true,\n            {\n              impersonatedBy: ctx.context.session.user.id,\n              expiresAt: options?.impersonationSessionDuration ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(options.impersonationSessionDuration, \"sec\") : (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(60 * 60, \"sec\")\n              // 1 hour\n            },\n            true\n          );\n          if (!session) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: ERROR_CODES.FAILED_TO_CREATE_USER\n            });\n          }\n          const authCookies = ctx.context.authCookies;\n          (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n          await ctx.setSignedCookie(\n            \"admin_session\",\n            ctx.context.session.session.token,\n            ctx.context.secret,\n            authCookies.sessionToken.options\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(\n            ctx,\n            {\n              session,\n              user: targetUser\n            },\n            true\n          );\n          return ctx.json({\n            session,\n            user: targetUser\n          });\n        }\n      ),\n      stopImpersonating: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/stop-impersonating\",\n        {\n          method: \"POST\"\n        },\n        async (ctx) => {\n          const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n          if (!session) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n          }\n          if (!session.session.impersonatedBy) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: \"You are not impersonating anyone\"\n            });\n          }\n          const user = await ctx.context.internalAdapter.findUserById(\n            session.session.impersonatedBy\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Failed to find user\"\n            });\n          }\n          const adminCookie = await ctx.getSignedCookie(\n            \"admin_session\",\n            ctx.context.secret\n          );\n          if (!adminCookie) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Failed to find admin session\"\n            });\n          }\n          const adminSession = await ctx.context.internalAdapter.findSession(adminCookie);\n          if (!adminSession || adminSession.session.userId !== user.id) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Failed to find admin session\"\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, adminSession);\n          return ctx.json(adminSession);\n        }\n      ),\n      revokeUserSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/revoke-user-session\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            sessionToken: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The session token\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"revokeUserSession\",\n              summary: \"Revoke a user session\",\n              description: \"Revoke a user session\",\n              responses: {\n                200: {\n                  description: \"Session revoked\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          await ctx.context.internalAdapter.deleteSession(\n            ctx.body.sessionToken\n          );\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      revokeUserSessions: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/revoke-user-sessions\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"revokeUserSessions\",\n              summary: \"Revoke all user sessions\",\n              description: \"Revoke all user sessions\",\n              responses: {\n                200: {\n                  description: \"Sessions revoked\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          await ctx.context.internalAdapter.deleteSessions(ctx.body.userId);\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      removeUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/remove-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"removeUser\",\n              summary: \"Remove a user\",\n              description: \"Delete a user and all their sessions and accounts. Cannot be undone.\",\n              responses: {\n                200: {\n                  description: \"User removed\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          await ctx.context.internalAdapter.deleteUser(ctx.body.userId);\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      setUserPassword: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/set-user-password\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            newPassword: zod__WEBPACK_IMPORTED_MODULE_4__.z.string(),\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string()\n          }),\n          use: [adminMiddleware]\n        },\n        async (ctx) => {\n          const hashedPassword = await ctx.context.password.hash(\n            ctx.body.newPassword\n          );\n          await ctx.context.internalAdapter.updatePassword(\n            ctx.body.userId,\n            hashedPassword\n          );\n          return ctx.json({\n            status: true\n          });\n        }\n      )\n    },\n    $ERROR_CODES: ERROR_CODES,\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__.mergeSchema)(schema, opts.schema)\n  };\n};\nvar schema = {\n  user: {\n    fields: {\n      role: {\n        type: \"string\",\n        required: false,\n        input: false\n      },\n      banned: {\n        type: \"boolean\",\n        defaultValue: false,\n        required: false,\n        input: false\n      },\n      banReason: {\n        type: \"string\",\n        required: false,\n        input: false\n      },\n      banExpires: {\n        type: \"date\",\n        required: false,\n        input: false\n      }\n    }\n  },\n  session: {\n    fields: {\n      impersonatedBy: {\n        type: \"string\",\n        required: false\n      }\n    }\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTlAySDdWSlYuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUE0RztBQUNoQztBQUMxQjtBQUNKO0FBQ3RCO0FBQzZCOztBQUVyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGlEQUFVO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsd0VBQW9CO0FBQzlDLDBCQUEwQixxRUFBaUI7QUFDM0M7QUFDQSxnQkFBZ0Isd0RBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdEQUFRO0FBQ3hCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLG1CQUFtQix3RUFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxlQUFlLHNFQUFrQjtB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLHVCQUF1QixzRUFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLHlCQUF5Qix5Q0FBUTtBQUNqQyxvQkFBb0IseUNBQVE7QUFDNUIsV0FBVztBQUNYO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxZQUFZLCtEQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWlCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTlAySDdWSlYuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIGdldFNlc3Npb25Gcm9tQ3R4LCBBUElFcnJvciwgY3JlYXRlQXV0aEVuZHBvaW50IH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBkZWxldGVTZXNzaW9uQ29va2llLCBzZXRTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBtZXJnZVNjaGVtYSB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgZ2V0RGF0ZSB9IGZyb20gJy4vY2h1bmstRlVSTkE2SFkuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBBUElFcnJvciBhcyBBUElFcnJvciQxIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG52YXIgZ2V0RW5kcG9pbnRSZXNwb25zZSA9IGFzeW5jIChjdHgpID0+IHtcbiAgY29uc3QgcmV0dXJuZWQgPSBjdHguY29udGV4dC5yZXR1cm5lZDtcbiAgaWYgKCFyZXR1cm5lZCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmIChyZXR1cm5lZCBpbnN0YW5jZW9mIFJlc3BvbnNlKSB7XG4gICAgaWYgKHJldHVybmVkLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHJldHVybmVkLmNsb25lKCkuanNvbigpO1xuICB9XG4gIGlmIChyZXR1cm5lZCBpbnN0YW5jZW9mIEFQSUVycm9yJDEpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gcmV0dXJuZWQ7XG59O1xuXG4vLyBzcmMvcGx1Z2lucy9hZG1pbi9pbmRleC50c1xudmFyIGFkbWluID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3Qgb3B0cyA9IHtcbiAgICBkZWZhdWx0Um9sZTogXCJ1c2VyXCIsXG4gICAgYWRtaW5Sb2xlOiBcImFkbWluXCIsXG4gICAgLi4ub3B0aW9uc1xuICB9O1xuICBjb25zdCBFUlJPUl9DT0RFUyA9IHtcbiAgICBGQUlMRURfVE9fQ1JFQVRFX1VTRVI6IFwiRmFpbGVkIHRvIGNyZWF0ZSB1c2VyXCIsXG4gICAgVVNFUl9BTFJFQURZX0VYSVNUUzogXCJVc2VyIGFscmVhZHkgZXhpc3RzXCIsXG4gICAgVVNFUl9OT1RfRk9VTkQ6IFwiVXNlciBub3QgZm91bmRcIixcbiAgICBZT1VfQ0FOTk9UX0JBTl9ZT1VSU0VMRjogXCJZb3UgY2Fubm90IGJhbiB5b3Vyc2VsZlwiLFxuICAgIE9OTFlfQURNSU5TX0NBTl9BQ0NFU1NfVEhJU19FTkRQT0lOVDogXCJPbmx5IGFkbWlucyBjYW4gYWNjZXNzIHRoaXMgZW5kcG9pbnRcIlxuICB9O1xuICBjb25zdCBhZG1pbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uPy5zZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIGNvbnN0IHVzZXIgPSBzZXNzaW9uLnVzZXI7XG4gICAgaWYgKCF1c2VyLnJvbGUgfHwgKEFycmF5LmlzQXJyYXkob3B0cy5hZG1pblJvbGUpID8gIW9wdHMuYWRtaW5Sb2xlLmluY2x1ZGVzKHVzZXIucm9sZSkgOiB1c2VyLnJvbGUgIT09IG9wdHMuYWRtaW5Sb2xlKSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJPbmx5IGFkbWlucyBjYW4gYWNjZXNzIHRoaXMgZW5kcG9pbnRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBzZXNzaW9uOiB7XG4gICAgICAgIHVzZXIsXG4gICAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvblxuICAgICAgfVxuICAgIH07XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIGlkOiBcImFkbWluXCIsXG4gICAgaW5pdChjdHgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBkYXRhYmFzZUhvb2tzOiB7XG4gICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgICAgICAgIGFzeW5jIGJlZm9yZSh1c2VyKSB7XG4gICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucz8uZGVmYXVsdFJvbGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICByb2xlOiBvcHRpb25zPy5kZWZhdWx0Um9sZSA/PyBcInVzZXJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgICAgICAgYXN5bmMgYmVmb3JlKHNlc3Npb24pIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZChcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbi51c2VySWRcbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICBpZiAodXNlci5iYW5uZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXIuYmFuRXhwaXJlcyAmJiB1c2VyLmJhbkV4cGlyZXMuZ2V0VGltZSgpIDwgRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGN0eC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihzZXNzaW9uLnVzZXJJZCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhblJlYXNvbjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbkV4cGlyZXM6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIGhvb2tzOiB7XG4gICAgICBhZnRlcjogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcihjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5wYXRoID09PSBcIi9saXN0LXNlc3Npb25zXCI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEVuZHBvaW50UmVzcG9uc2UoY3R4KTtcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbmV3SnNvbiA9IHJlc3BvbnNlLmZpbHRlcigoc2Vzc2lvbikgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gIXNlc3Npb24uaW1wZXJzb25hdGVkQnk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbihuZXdKc29uKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSxcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNldFJvbGU6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vc2V0LXJvbGVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgdXNlcklkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIGlkXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcm9sZTogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcm9sZSB0byBzZXQuIGBhZG1pbmAgb3IgYHVzZXJgIGJ5IGRlZmF1bHRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcInNldFJvbGVcIixcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJTZXQgdGhlIHJvbGUgb2YgYSB1c2VyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNldCB0aGUgcm9sZSBvZiBhIHVzZXJcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHJvbGUgdXBkYXRlZFwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgICAgY3R4LmJvZHkudXNlcklkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICByb2xlOiBjdHguYm9keS5yb2xlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdXNlcjogdXBkYXRlZFVzZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIGNyZWF0ZVVzZXI6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vY3JlYXRlLXVzZXJcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmFtZTogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJvbGU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHJvbGUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGV4dHJhIGZpZWxkcyBmb3IgdXNlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkYXRhOiB6Lm9wdGlvbmFsKFxuICAgICAgICAgICAgICB6LnJlY29yZCh6LmFueSgpLCB7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRXh0cmEgZmllbGRzIGZvciB0aGUgdXNlci4gSW5jbHVkaW5nIGN1c3RvbSBhZGRpdGlvbmFsIGZpZWxkcy5cIlxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwiY3JlYXRlVXNlclwiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkNyZWF0ZSBhIG5ldyB1c2VyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNyZWF0ZSBhIG5ldyB1c2VyXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBjcmVhdGVkXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGV4aXN0VXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoXG4gICAgICAgICAgICBjdHguYm9keS5lbWFpbFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKGV4aXN0VXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSX0FMUkVBRFlfRVhJU1RTXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVVc2VyKHtcbiAgICAgICAgICAgIGVtYWlsOiBjdHguYm9keS5lbWFpbCxcbiAgICAgICAgICAgIG5hbWU6IGN0eC5ib2R5Lm5hbWUsXG4gICAgICAgICAgICByb2xlOiBjdHguYm9keS5yb2xlLFxuICAgICAgICAgICAgLi4uY3R4LmJvZHkuZGF0YVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKFxuICAgICAgICAgICAgY3R4LmJvZHkucGFzc3dvcmRcbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudCh7XG4gICAgICAgICAgICBhY2NvdW50SWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICBwcm92aWRlcklkOiBcImNyZWRlbnRpYWxcIixcbiAgICAgICAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXNzd29yZCxcbiAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBsaXN0VXNlcnM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vbGlzdC11c2Vyc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHNlYXJjaFZhbHVlOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSB0byBzZWFyY2ggZm9yXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBzZWFyY2hGaWVsZDogei5lbnVtKFtcImVtYWlsXCIsIFwibmFtZVwiXSwge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZmllbGQgdG8gc2VhcmNoIGluLCBkZWZhdWx0cyB0byBlbWFpbC4gQ2FuIGJlIGBlbWFpbGAgb3IgYG5hbWVgXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBzZWFyY2hPcGVyYXRvcjogei5lbnVtKFtcImNvbnRhaW5zXCIsIFwic3RhcnRzX3dpdGhcIiwgXCJlbmRzX3dpdGhcIl0sIHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9wZXJhdG9yIHRvIHVzZSBmb3IgdGhlIHNlYXJjaC4gQ2FuIGJlIGBjb250YWluc2AsIGBzdGFydHNfd2l0aGAgb3IgYGVuZHNfd2l0aGBcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGxpbWl0OiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBudW1iZXIgb2YgdXNlcnMgdG8gcmV0dXJuXCJcbiAgICAgICAgICAgIH0pLm9yKHoubnVtYmVyKCkpLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBvZmZzZXQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9mZnNldCB0byBzdGFydCBmcm9tXCJcbiAgICAgICAgICAgIH0pLm9yKHoubnVtYmVyKCkpLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBzb3J0Qnk6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGZpZWxkIHRvIHNvcnQgYnlcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIHNvcnREaXJlY3Rpb246IHouZW51bShbXCJhc2NcIiwgXCJkZXNjXCJdLCB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBkaXJlY3Rpb24gdG8gc29ydCBieVwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgZmlsdGVyRmllbGQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGZpZWxkIHRvIGZpbHRlciBieVwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgZmlsdGVyVmFsdWU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHZhbHVlIHRvIGZpbHRlciBieVwiXG4gICAgICAgICAgICB9KS5vcih6Lm51bWJlcigpKS5vcih6LmJvb2xlYW4oKSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGZpbHRlck9wZXJhdG9yOiB6LmVudW0oW1wiZXFcIiwgXCJuZVwiLCBcImx0XCIsIFwibHRlXCIsIFwiZ3RcIiwgXCJndGVcIl0sIHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9wZXJhdG9yIHRvIHVzZSBmb3IgdGhlIGZpbHRlclwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwibGlzdFVzZXJzXCIsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiTGlzdCB1c2Vyc1wiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJMaXN0IHVzZXJzXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCBvZiB1c2Vyc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3Qgd2hlcmUgPSBbXTtcbiAgICAgICAgICBpZiAoY3R4LnF1ZXJ5Py5zZWFyY2hWYWx1ZSkge1xuICAgICAgICAgICAgd2hlcmUucHVzaCh7XG4gICAgICAgICAgICAgIGZpZWxkOiBjdHgucXVlcnkuc2VhcmNoRmllbGQgfHwgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICBvcGVyYXRvcjogY3R4LnF1ZXJ5LnNlYXJjaE9wZXJhdG9yIHx8IFwiY29udGFpbnNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGN0eC5xdWVyeS5zZWFyY2hWYWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjdHgucXVlcnk/LmZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB3aGVyZS5wdXNoKHtcbiAgICAgICAgICAgICAgZmllbGQ6IGN0eC5xdWVyeS5maWx0ZXJGaWVsZCB8fCBcImVtYWlsXCIsXG4gICAgICAgICAgICAgIG9wZXJhdG9yOiBjdHgucXVlcnkuZmlsdGVyT3BlcmF0b3IgfHwgXCJlcVwiLFxuICAgICAgICAgICAgICB2YWx1ZTogY3R4LnF1ZXJ5LmZpbHRlclZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpc3RVc2VycyhcbiAgICAgICAgICAgICAgTnVtYmVyKGN0eC5xdWVyeT8ubGltaXQpIHx8IHZvaWQgMCxcbiAgICAgICAgICAgICAgTnVtYmVyKGN0eC5xdWVyeT8ub2Zmc2V0KSB8fCB2b2lkIDAsXG4gICAgICAgICAgICAgIGN0eC5xdWVyeT8uc29ydEJ5ID8ge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBjdHgucXVlcnkuc29ydEJ5LFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogY3R4LnF1ZXJ5LnNvcnREaXJlY3Rpb24gfHwgXCJhc2NcIlxuICAgICAgICAgICAgICB9IDogdm9pZCAwLFxuICAgICAgICAgICAgICB3aGVyZS5sZW5ndGggPyB3aGVyZSA6IHZvaWQgMFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAgIHVzZXJzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICB1c2VyczogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIGxpc3RVc2VyU2Vzc2lvbnM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vbGlzdC11c2VyLXNlc3Npb25zXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgdXNlcklkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIGlkXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwibGlzdFVzZXJTZXNzaW9uc1wiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkxpc3QgdXNlciBzZXNzaW9uc1wiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJMaXN0IHVzZXIgc2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJMaXN0IG9mIHVzZXIgc2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpc3RTZXNzaW9ucyhcbiAgICAgICAgICAgIGN0eC5ib2R5LnVzZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlc3Npb25zXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHVuYmFuVXNlcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi91bmJhbi11c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwidW5iYW5Vc2VyXCIsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiVW5iYW4gYSB1c2VyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVuYmFuIGEgdXNlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgdW5iYW5uZWRcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgICAgY3R4LmJvZHkudXNlcklkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBiYW5uZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICBiYW5FeHBpcmVzOiBudWxsLFxuICAgICAgICAgICAgICBiYW5SZWFzb246IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBiYW5Vc2VyOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL2Jhbi11c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZFwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVhc29uIGZvciB0aGUgYmFuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGJhblJlYXNvbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcmVhc29uIGZvciB0aGUgYmFuXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE51bWJlciBvZiBzZWNvbmRzIHVudGlsIHRoZSBiYW4gZXhwaXJlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBiYW5FeHBpcmVzSW46IHoubnVtYmVyKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG51bWJlciBvZiBzZWNvbmRzIHVudGlsIHRoZSBiYW4gZXhwaXJlc1wiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbYWRtaW5NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBvcGVyYXRpb25JZDogXCJiYW5Vc2VyXCIsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiQmFuIGEgdXNlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJCYW4gYSB1c2VyXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBiYW5uZWRcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKGN0eC5ib2R5LnVzZXJJZCA9PT0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLllPVV9DQU5OT1RfQkFOX1lPVVJTRUxGXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgICAgY3R4LmJvZHkudXNlcklkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBiYW5uZWQ6IHRydWUsXG4gICAgICAgICAgICAgIGJhblJlYXNvbjogY3R4LmJvZHkuYmFuUmVhc29uIHx8IG9wdGlvbnM/LmRlZmF1bHRCYW5SZWFzb24gfHwgXCJObyByZWFzb25cIixcbiAgICAgICAgICAgICAgYmFuRXhwaXJlczogY3R4LmJvZHkuYmFuRXhwaXJlc0luID8gZ2V0RGF0ZShjdHguYm9keS5iYW5FeHBpcmVzSW4sIFwic2VjXCIpIDogb3B0aW9ucz8uZGVmYXVsdEJhbkV4cGlyZXNJbiA/IGdldERhdGUob3B0aW9ucy5kZWZhdWx0QmFuRXhwaXJlc0luLCBcInNlY1wiKSA6IHZvaWQgMFxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKGN0eC5ib2R5LnVzZXJJZCk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIGltcGVyc29uYXRlVXNlcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi9pbXBlcnNvbmF0ZS11c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwiaW1wZXJzb25hdGVVc2VyXCIsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiSW1wZXJzb25hdGUgYSB1c2VyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkltcGVyc29uYXRlIGEgdXNlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkltcGVyc29uYXRpb24gc2Vzc2lvbiBjcmVhdGVkXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZChcbiAgICAgICAgICAgIGN0eC5ib2R5LnVzZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF0YXJnZXRVc2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIlVzZXIgbm90IGZvdW5kXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICB0YXJnZXRVc2VyLmlkLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaW1wZXJzb25hdGVkQnk6IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBvcHRpb25zPy5pbXBlcnNvbmF0aW9uU2Vzc2lvbkR1cmF0aW9uID8gZ2V0RGF0ZShvcHRpb25zLmltcGVyc29uYXRpb25TZXNzaW9uRHVyYXRpb24sIFwic2VjXCIpIDogZ2V0RGF0ZSg2MCAqIDYwLCBcInNlY1wiKVxuICAgICAgICAgICAgICAvLyAxIGhvdXJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGF1dGhDb29raWVzID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXM7XG4gICAgICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICBcImFkbWluX3Nlc3Npb25cIixcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgIGF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5vcHRpb25zXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgICAgICAgY3R4LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgICAgICB1c2VyOiB0YXJnZXRVc2VyXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgICB1c2VyOiB0YXJnZXRVc2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBzdG9wSW1wZXJzb25hdGluZzogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi9zdG9wLWltcGVyc29uYXRpbmdcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCJcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXNlc3Npb24uc2Vzc2lvbi5pbXBlcnNvbmF0ZWRCeSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIllvdSBhcmUgbm90IGltcGVyc29uYXRpbmcgYW55b25lXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZChcbiAgICAgICAgICAgIHNlc3Npb24uc2Vzc2lvbi5pbXBlcnNvbmF0ZWRCeVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBmaW5kIHVzZXJcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGFkbWluQ29va2llID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgIFwiYWRtaW5fc2Vzc2lvblwiLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIWFkbWluQ29va2llKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBmaW5kIGFkbWluIHNlc3Npb25cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGFkbWluU2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbihhZG1pbkNvb2tpZSk7XG4gICAgICAgICAgaWYgKCFhZG1pblNlc3Npb24gfHwgYWRtaW5TZXNzaW9uLnNlc3Npb24udXNlcklkICE9PSB1c2VyLmlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBmaW5kIGFkbWluIHNlc3Npb25cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCBhZG1pblNlc3Npb24pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihhZG1pblNlc3Npb24pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgcmV2b2tlVXNlclNlc3Npb246IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vcmV2b2tlLXVzZXItc2Vzc2lvblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBzZXNzaW9uVG9rZW46IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHNlc3Npb24gdG9rZW5cIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcInJldm9rZVVzZXJTZXNzaW9uXCIsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiUmV2b2tlIGEgdXNlciBzZXNzaW9uXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhIHVzZXIgc2Vzc2lvblwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlc3Npb24gcmV2b2tlZFwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihcbiAgICAgICAgICAgIGN0eC5ib2R5LnNlc3Npb25Ub2tlblxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHJldm9rZVVzZXJTZXNzaW9uczogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi9yZXZva2UtdXNlci1zZXNzaW9uc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgaWRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcInJldm9rZVVzZXJTZXNzaW9uc1wiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlJldm9rZSBhbGwgdXNlciBzZXNzaW9uc1wiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYWxsIHVzZXIgc2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXNzaW9ucyByZXZva2VkXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhjdHguYm9keS51c2VySWQpO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICByZW1vdmVVc2VyOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL3JlbW92ZS11c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwicmVtb3ZlVXNlclwiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlJlbW92ZSBhIHVzZXJcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGVsZXRlIGEgdXNlciBhbmQgYWxsIHRoZWlyIHNlc3Npb25zIGFuZCBhY2NvdW50cy4gQ2Fubm90IGJlIHVuZG9uZS5cIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHJlbW92ZWRcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoY3R4LmJvZHkudXNlcklkKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgc2V0VXNlclBhc3N3b3JkOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL3NldC11c2VyLXBhc3N3b3JkXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIG5ld1Bhc3N3b3JkOiB6LnN0cmluZygpLFxuICAgICAgICAgICAgdXNlcklkOiB6LnN0cmluZygpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbYWRtaW5NaWRkbGV3YXJlXVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKFxuICAgICAgICAgICAgY3R4LmJvZHkubmV3UGFzc3dvcmRcbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVQYXNzd29yZChcbiAgICAgICAgICAgIGN0eC5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIGhhc2hlZFBhc3N3b3JkXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgICRFUlJPUl9DT0RFUzogRVJST1JfQ09ERVMsXG4gICAgc2NoZW1hOiBtZXJnZVNjaGVtYShzY2hlbWEsIG9wdHMuc2NoZW1hKVxuICB9O1xufTtcbnZhciBzY2hlbWEgPSB7XG4gIHVzZXI6IHtcbiAgICBmaWVsZHM6IHtcbiAgICAgIHJvbGU6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBpbnB1dDogZmFsc2VcbiAgICAgIH0sXG4gICAgICBiYW5uZWQ6IHtcbiAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZmFsc2UsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgaW5wdXQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgYmFuUmVhc29uOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgaW5wdXQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgYmFuRXhwaXJlczoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBpbnB1dDogZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHNlc3Npb246IHtcbiAgICBmaWVsZHM6IHtcbiAgICAgIGltcGVyc29uYXRlZEJ5OiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IHsgYWRtaW4gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateState: () => (/* binding */ generateState),\n/* harmony export */   parseState: () => (/* binding */ parseState)\n/* harmony export */ });\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\nasync function generateState(c, link) {\n  const callbackURL = c.body?.callbackURL || c.context.options.baseURL;\n  if (!callbackURL) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n      message: \"callbackURL is required\"\n    });\n  }\n  const codeVerifier = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_0__.generateRandomString)(128);\n  const state = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_0__.generateRandomString)(32);\n  const data = JSON.stringify({\n    callbackURL,\n    codeVerifier,\n    errorURL: c.body?.errorCallbackURL,\n    newUserURL: c.body?.newUserCallbackURL,\n    link,\n    /**\n     * This is the actual expiry time of the state\n     */\n    expiresAt: Date.now() + 10 * 60 * 1e3\n  });\n  const expiresAt = /* @__PURE__ */ new Date();\n  expiresAt.setMinutes(expiresAt.getMinutes() + 10);\n  const verification = await c.context.internalAdapter.createVerificationValue({\n    value: data,\n    identifier: state,\n    expiresAt\n  });\n  if (!verification) {\n    c.context.logger.error(\n      \"Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database\"\n    );\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"Unable to create verification\"\n    });\n  }\n  return {\n    state: verification.identifier,\n    codeVerifier\n  };\n}\nasync function parseState(c) {\n  const state = c.query.state || c.body.state;\n  const data = await c.context.internalAdapter.findVerificationValue(state);\n  if (!data) {\n    c.context.logger.error(\"State Mismatch. Verification not found\", {\n      state\n    });\n    throw c.redirect(\n      `${c.context.baseURL}/error?error=please_restart_the_process`\n    );\n  }\n  const parsedData = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n    callbackURL: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n    codeVerifier: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n    errorURL: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n    newUserURL: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n    expiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n    link: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n    }).optional()\n  }).parse(JSON.parse(data.value));\n  if (!parsedData.errorURL) {\n    parsedData.errorURL = `${c.context.baseURL}/error`;\n  }\n  if (parsedData.expiresAt < Date.now()) {\n    await c.context.internalAdapter.deleteVerificationValue(data.id);\n    c.context.logger.error(\"State expired.\", {\n      state\n    });\n    throw c.redirect(\n      `${c.context.baseURL}/error?error=please_restart_the_process`\n    );\n  }\n  await c.context.internalAdapter.deleteVerificationValue(data.id);\n  return parsedData;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTlBPNjRTVk4uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkQ7QUFDbkM7QUFDZTs7QUFFdkM7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpREFBUTtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNBLHVCQUF1Qix3RUFBb0I7QUFDM0MsZ0JBQWdCLHdFQUFvQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGlEQUFRO0FBQ3RCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLFNBQVMsa0JBQWtCO0FBQzNCO0FBQ0E7QUFDQSxxQkFBcUIseUNBQVE7QUFDN0IsaUJBQWlCLHlDQUFRO0FBQ3pCLGtCQUFrQix5Q0FBUTtBQUMxQixjQUFjLHlDQUFRO0FBQ3RCLGdCQUFnQix5Q0FBUTtBQUN4QixlQUFlLHlDQUFRO0FBQ3ZCLFVBQVUseUNBQVE7QUFDbEIsYUFBYSx5Q0FBUTtBQUNyQixjQUFjLHlDQUFRO0FBQ3RCLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSw2QkFBNkIsa0JBQWtCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxTQUFTLGtCQUFrQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVxQyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU5QTzY0U1ZOLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdlbmVyYXRlUmFuZG9tU3RyaW5nIH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVN0YXRlKGMsIGxpbmspIHtcbiAgY29uc3QgY2FsbGJhY2tVUkwgPSBjLmJvZHk/LmNhbGxiYWNrVVJMIHx8IGMuY29udGV4dC5vcHRpb25zLmJhc2VVUkw7XG4gIGlmICghY2FsbGJhY2tVUkwpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcImNhbGxiYWNrVVJMIGlzIHJlcXVpcmVkXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBjb2RlVmVyaWZpZXIgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygxMjgpO1xuICBjb25zdCBzdGF0ZSA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyKTtcbiAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICBjYWxsYmFja1VSTCxcbiAgICBjb2RlVmVyaWZpZXIsXG4gICAgZXJyb3JVUkw6IGMuYm9keT8uZXJyb3JDYWxsYmFja1VSTCxcbiAgICBuZXdVc2VyVVJMOiBjLmJvZHk/Lm5ld1VzZXJDYWxsYmFja1VSTCxcbiAgICBsaW5rLFxuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgdGhlIGFjdHVhbCBleHBpcnkgdGltZSBvZiB0aGUgc3RhdGVcbiAgICAgKi9cbiAgICBleHBpcmVzQXQ6IERhdGUubm93KCkgKyAxMCAqIDYwICogMWUzXG4gIH0pO1xuICBjb25zdCBleHBpcmVzQXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgZXhwaXJlc0F0LnNldE1pbnV0ZXMoZXhwaXJlc0F0LmdldE1pbnV0ZXMoKSArIDEwKTtcbiAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgdmFsdWU6IGRhdGEsXG4gICAgaWRlbnRpZmllcjogc3RhdGUsXG4gICAgZXhwaXJlc0F0XG4gIH0pO1xuICBpZiAoIXZlcmlmaWNhdGlvbikge1xuICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICBcIlVuYWJsZSB0byBjcmVhdGUgdmVyaWZpY2F0aW9uLiBNYWtlIHN1cmUgdGhlIGRhdGFiYXNlIGFkYXB0ZXIgaXMgcHJvcGVybHkgd29ya2luZyBhbmQgdGhlcmUgaXMgYSB2ZXJpZmljYXRpb24gdGFibGUgaW4gdGhlIGRhdGFiYXNlXCJcbiAgICApO1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlVuYWJsZSB0byBjcmVhdGUgdmVyaWZpY2F0aW9uXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHN0YXRlOiB2ZXJpZmljYXRpb24uaWRlbnRpZmllcixcbiAgICBjb2RlVmVyaWZpZXJcbiAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHBhcnNlU3RhdGUoYykge1xuICBjb25zdCBzdGF0ZSA9IGMucXVlcnkuc3RhdGUgfHwgYy5ib2R5LnN0YXRlO1xuICBjb25zdCBkYXRhID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoc3RhdGUpO1xuICBpZiAoIWRhdGEpIHtcbiAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiU3RhdGUgTWlzbWF0Y2guIFZlcmlmaWNhdGlvbiBub3QgZm91bmRcIiwge1xuICAgICAgc3RhdGVcbiAgICB9KTtcbiAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPXBsZWFzZV9yZXN0YXJ0X3RoZV9wcm9jZXNzYFxuICAgICk7XG4gIH1cbiAgY29uc3QgcGFyc2VkRGF0YSA9IHoub2JqZWN0KHtcbiAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKSxcbiAgICBjb2RlVmVyaWZpZXI6IHouc3RyaW5nKCksXG4gICAgZXJyb3JVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBuZXdVc2VyVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgZXhwaXJlc0F0OiB6Lm51bWJlcigpLFxuICAgIGxpbms6IHoub2JqZWN0KHtcbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLFxuICAgICAgdXNlcklkOiB6LnN0cmluZygpXG4gICAgfSkub3B0aW9uYWwoKVxuICB9KS5wYXJzZShKU09OLnBhcnNlKGRhdGEudmFsdWUpKTtcbiAgaWYgKCFwYXJzZWREYXRhLmVycm9yVVJMKSB7XG4gICAgcGFyc2VkRGF0YS5lcnJvclVSTCA9IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gIH1cbiAgaWYgKHBhcnNlZERhdGEuZXhwaXJlc0F0IDwgRGF0ZS5ub3coKSkge1xuICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoZGF0YS5pZCk7XG4gICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlN0YXRlIGV4cGlyZWQuXCIsIHtcbiAgICAgIHN0YXRlXG4gICAgfSk7XG4gICAgdGhyb3cgYy5yZWRpcmVjdChcbiAgICAgIGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1wbGVhc2VfcmVzdGFydF90aGVfcHJvY2Vzc2BcbiAgICApO1xuICB9XG4gIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoZGF0YS5pZCk7XG4gIHJldHVybiBwYXJzZWREYXRhO1xufVxuXG5leHBvcnQgeyBnZW5lcmF0ZVN0YXRlLCBwYXJzZVN0YXRlIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   openAPI: () => (/* binding */ openAPI)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-62MWLLEG.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\nvar paths = {};\nfunction getTypeFromZodType(zodType) {\n  switch (zodType.constructor.name) {\n    case \"ZodString\":\n      return \"string\";\n    case \"ZodNumber\":\n      return \"number\";\n    case \"ZodBoolean\":\n      return \"boolean\";\n    case \"ZodObject\":\n      return \"object\";\n    case \"ZodArray\":\n      return \"array\";\n    default:\n      return \"string\";\n  }\n}\nfunction getParameters(options) {\n  const parameters = [];\n  if (options.metadata?.openapi?.parameters) {\n    parameters.push(...options.metadata.openapi.parameters);\n    return parameters;\n  }\n  if (options.query instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodObject) {\n    Object.entries(options.query.shape).forEach(([key, value]) => {\n      if (value instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodSchema) {\n        parameters.push({\n          name: key,\n          in: \"query\",\n          schema: {\n            type: getTypeFromZodType(value),\n            ...\"minLength\" in value && value.minLength ? {\n              minLength: value.minLength\n            } : {},\n            description: value.description\n          }\n        });\n      }\n    });\n  }\n  return parameters;\n}\nfunction getRequestBody(options) {\n  if (options.metadata?.openapi?.requestBody) {\n    return options.metadata.openapi.requestBody;\n  }\n  if (!options.body) return void 0;\n  if (options.body instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodObject || options.body instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodOptional) {\n    const shape = options.body.shape;\n    if (!shape) return void 0;\n    const properties = {};\n    const required = [];\n    Object.entries(shape).forEach(([key, value]) => {\n      if (value instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodSchema) {\n        properties[key] = {\n          type: getTypeFromZodType(value),\n          description: value.description\n        };\n        if (!(value instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodOptional)) {\n          required.push(key);\n        }\n      }\n    });\n    return {\n      required: options.body instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodOptional ? false : options.body ? true : false,\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties,\n            required\n          }\n        }\n      }\n    };\n  }\n  return void 0;\n}\nfunction getResponse(responses) {\n  return {\n    \"400\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            },\n            required: [\"message\"]\n          }\n        }\n      },\n      description: \"Bad Request. Usually due to missing parameters, or invalid parameters.\"\n    },\n    \"401\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            },\n            required: [\"message\"]\n          }\n        }\n      },\n      description: \"Unauthorized. Due to missing or invalid authentication.\"\n    },\n    \"403\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Forbidden. You do not have permission to access this resource or to perform this action.\"\n    },\n    \"404\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Not Found. The requested resource was not found.\"\n    },\n    \"429\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Too Many Requests. You have exceeded the rate limit. Try again later.\"\n    },\n    \"500\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Internal Server Error. This is a problem with the server that you cannot fix.\"\n    },\n    ...responses\n  };\n}\nfunction toOpenApiPath(path) {\n  return path.split(\"/\").map((part) => part.startsWith(\":\") ? `{${part.slice(1)}}` : part).join(\"/\");\n}\nasync function generator(ctx, options) {\n  const baseEndpoints = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(ctx, {\n    ...options,\n    plugins: []\n  });\n  const tables = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_1__.getAuthTables)(options);\n  const models = Object.entries(tables).reduce((acc, [key, value]) => {\n    const modelName = key.charAt(0).toUpperCase() + key.slice(1);\n    acc[modelName] = {\n      type: \"object\",\n      properties: Object.entries(value.fields).reduce(\n        (acc2, [key2, value2]) => {\n          acc2[key2] = {\n            type: value2.type\n          };\n          return acc2;\n        },\n        { id: { type: \"string\" } }\n      )\n    };\n    return acc;\n  }, {});\n  const components = {\n    schemas: {\n      ...models\n    }\n  };\n  Object.entries(baseEndpoints.api).forEach(([_, value]) => {\n    const options2 = value.options;\n    if (options2.metadata?.SERVER_ONLY) return;\n    const path = toOpenApiPath(value.path);\n    if (options2.method === \"GET\") {\n      paths[path] = {\n        get: {\n          tags: [\"Default\", ...options2.metadata?.openapi?.tags || []],\n          description: options2.metadata?.openapi?.description,\n          operationId: options2.metadata?.openapi?.operationId,\n          security: [\n            {\n              bearerAuth: []\n            }\n          ],\n          parameters: getParameters(options2),\n          responses: getResponse(options2.metadata?.openapi?.responses)\n        }\n      };\n    }\n    if (options2.method === \"POST\") {\n      const body = getRequestBody(options2);\n      paths[path] = {\n        post: {\n          tags: [\"Default\", ...options2.metadata?.openapi?.tags || []],\n          description: options2.metadata?.openapi?.description,\n          operationId: options2.metadata?.openapi?.operationId,\n          security: [\n            {\n              bearerAuth: []\n            }\n          ],\n          parameters: getParameters(options2),\n          ...body ? { requestBody: body } : {\n            requestBody: {\n              //set body none\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {}\n                  }\n                }\n              }\n            }\n          },\n          responses: getResponse(options2.metadata?.openapi?.responses)\n        }\n      };\n    }\n  });\n  for (const plugin of options.plugins || []) {\n    if (plugin.id === \"open-api\") {\n      continue;\n    }\n    const pluginEndpoints = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(ctx, {\n      ...options,\n      plugins: [plugin]\n    });\n    const api = Object.keys(pluginEndpoints.api).map((key) => {\n      if (baseEndpoints.api[key] === void 0) {\n        return pluginEndpoints.api[key];\n      }\n      return null;\n    }).filter((x) => x !== null);\n    Object.entries(api).forEach(([key, value]) => {\n      const options2 = value.options;\n      if (options2.metadata?.SERVER_ONLY) return;\n      const path = toOpenApiPath(value.path);\n      if (options2.method === \"GET\") {\n        paths[path] = {\n          get: {\n            tags: options2.metadata?.openapi?.tags || [\n              plugin.id.charAt(0).toUpperCase() + plugin.id.slice(1)\n            ],\n            description: options2.metadata?.openapi?.description,\n            operationId: options2.metadata?.openapi?.operationId,\n            security: [\n              {\n                bearerAuth: []\n              }\n            ],\n            parameters: getParameters(options2),\n            responses: getResponse(options2.metadata?.openapi?.responses)\n          }\n        };\n      }\n      if (options2.method === \"POST\") {\n        paths[path] = {\n          post: {\n            tags: options2.metadata?.openapi?.tags || [\n              plugin.id.charAt(0).toUpperCase() + plugin.id.slice(1)\n            ],\n            description: options2.metadata?.openapi?.description,\n            operationId: options2.metadata?.openapi?.operationId,\n            security: [\n              {\n                bearerAuth: []\n              }\n            ],\n            parameters: getParameters(options2),\n            requestBody: getRequestBody(options2),\n            responses: getResponse(options2.metadata?.openapi?.responses)\n          }\n        };\n      }\n    });\n  }\n  const res = {\n    openapi: \"3.1.1\",\n    info: {\n      title: \"Better Auth\",\n      description: \"API Reference for your Better Auth Instance\",\n      version: \"1.1.0\"\n    },\n    components,\n    security: [\n      {\n        apiKeyCookie: []\n      }\n    ],\n    servers: [\n      {\n        url: ctx.baseURL\n      }\n    ],\n    tags: [\n      {\n        name: \"Default\",\n        description: \"Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin.\"\n      }\n    ],\n    paths\n  };\n  return res;\n}\n\n// src/plugins/open-api/logo.ts\nvar logo = `<svg width=\"75\" height=\"75\" viewBox=\"0 0 75 75\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<rect width=\"75\" height=\"75\" fill=\"url(#pattern0_21_12)\"/>\n<defs>\n<pattern id=\"pattern0_21_12\" patternContentUnits=\"objectBoundingBox\" width=\"1\" height=\"1\">\n<use xlink:href=\"#image0_21_12\" transform=\"scale(0.00094697)\"/>\n</pattern>\n<image id=\"image0_21_12\" width=\"1056\" height=\"1056\" xlink:href=\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QBARXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAEIKADAAQAAAABAAAEIAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/+ICKElDQ19QUk9GSUxFAAEBAAACGGFwcGwEAAAAbW50clJHQiBYWVogB+YAAQABAAAAAAAAYWNzcEFQUEwAAAAAQVBQTAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1hcHBs7P2jjjiFR8NttL1PetoYLwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKZGVzYwAAAPwAAAAwY3BydAAAASwAAABQd3RwdAAAAXwAAAAUclhZWgAAAZAAAAAUZ1hZWgAAAaQAAAAUYlhZWgAAAbgAAAAUclRSQwAAAcwAAAAgY2hhZAAAAewAAAAsYlRSQwAAAcwAAAAgZ1RSQwAAAcwAAAAgbWx1YwAAAAAAAAABAAAADGVuVVMAAAAUAAAAHABEAGkAcwBwAGwAYQB5ACAAUAAzbWx1YwAAAAAAAAABAAAADGVuVVMAAAA0AAAAHABDAG8AcAB5AHIAaQBnAGgAdAAgAEEAcABwAGwAZQAgAEkAbgBjAC4ALAAgADIAMAAyADJYWVogAAAAAAAA9tUAAQAAAADTLFhZWiAAAAAAAACD3wAAPb////+7WFlaIAAAAAAAAEq/AACxNwAACrlYWVogAAAAAAAAKDgAABELAADIuXBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbc2YzMgAAAAAAAQxCAAAF3v//8yYAAAeTAAD9kP//+6L///2jAAAD3AAAwG7/wAARCAQgBCADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9sAQwACAgICAgIDAgIDBAMDAwQFBAQEBAUHBQUFBQUHCAcHBwcHBwgICAgICAgICgoKCgoKCwsLCwsNDQ0NDQ0NDQ0N/9sAQwECAgIDAwMGAwMGDQkHCQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0N/90ABABC/9oADAMBAAIRAxEAPwD9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9L9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//T/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9T9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Ln/gq38a/in8Dvgp4T8R/CfxFdeG9SvvFMdlcXFoELyW5srqQxnzEcY3op4Gciv1Gr8Z/+C2X/JvXgj/sc4v/AE33lAH4z/8ADwv9tD/oq2tf9823/wAZo/4eF/tof9FW1r/vm2/+M18Z0UAfZn/Dwv8AbQ/6KtrX/fNt/wDGaP8Ah4X+2h/0VbWv++bb/wCM18Z0UAfZn/Dwv9tD/oq2tf8AfNt/8Zo/4eF/tof9FW1r/vm2/wDjNfGdFAH2Z/w8L/bQ/wCira1/3zbf/GaP+Hhf7aH/AEVbWv8Avm2/+M18Z0UAfZn/AA8L/bQ/6KtrX/fNt/8AGaP+Hhf7aH/RVta/75tv/jNfGdFAH2Z/w8L/AG0P+ira1/3zbf8Axmj/AIeF/tof9FW1r/vm2/8AjNfGdFAH63/sVftq/tTfEb9qb4deCfG3xF1TVtD1bVGgvbKdYBHPGIJW2ttiVsblB4I6V/UbX8Z//BPT/k9D4U/9hpv/AEmmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+M/wD4eF/tof8ARVta/wC+bb/4zR/w8L/bQ/6KtrX/AHzbf/Ga+M6KAPsz/h4X+2h/0VbWv++bb/4zR/w8L/bQ/wCira1/3zbf/Ga+M6KAPsz/AIeF/tof9FW1r/vm2/8AjNH/AA8L/bQ/6KtrX/fNt/8AGa+M6KAPsz/h4X+2h/0VbWv++bb/AOM0f8PC/wBtD/oq2tf9823/AMZr4zooA+zP+Hhf7aH/AEVbWv8Avm2/+M0f8PC/20P+ira1/wB823/xmvjOigD7M/4eF/tof9FW1r/vm2/+M0f8PC/20P8Aoq2tf9823/xmvjOigD7M/wCHhf7aH/RVta/75tv/AIzR/wAPC/20P+ira1/3zbf/ABmvjOigD7M/4eF/tof9FW1r/vm2/wDjNH/Dwv8AbQ/6KtrX/fNt/wDGa+M6KAPsz/h4X+2h/wBFW1r/AL5tv/jNH/Dwv9tD/oq2tf8AfNt/8Zr4zooA+zP+Hhf7aH/RVta/75tv/jNH/Dwv9tD/AKKtrX/fNt/8Zr4zooA+zP8Ah4X+2h/0VbWv++bb/wCM0f8ADwv9tD/oq2tf9823/wAZr4zooA+zP+Hhf7aH/RVta/75tv8A4zR/w8L/AG0P+ira1/3zbf8AxmvjOigD7M/4eF/tof8ARVta/wC+bb/4zR/w8L/bQ/6KtrX/AHzbf/Ga+M6KAP6tv+CUnxr+Kfxx+CnizxH8WPEV14k1Kx8UyWVvcXYQPHbiytZBGPLRBje7HkZya/Uavxn/AOCJv/JvXjf/ALHOX/032dfsxQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfxn/APBPT/k9D4U/9hpv/Saav7MKACiiigAooooAKKKKACiiigAooooAKKKKAP4A6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfwq/BT4r638Dvin4d+LHhy0tb7UvDd0bu3t70ObeRzG0eJBGyPjDnowOa/Ub/h9l+0L/ANCR4M/79ah/8m0Af0yUV/M3/wAPsv2hf+hI8Gf9+tQ/+TaP+H2X7Qv/AEJHgz/v1qH/AMm0Af0yUV/M3/w+y/aF/wChI8Gf9+tQ/wDk2j/h9l+0L/0JHgz/AL9ah/8AJtAH9MlFfzN/8Psv2hf+hI8Gf9+tQ/8Ak2j/AIfZftC/9CR4M/79ah/8m0Af0yUV/M3/AMPsv2hf+hI8Gf8AfrUP/k2j/h9l+0L/ANCR4M/79ah/8m0Af0yUV/M3/wAPsv2hf+hI8Gf9+tQ/+TaP+H2X7Qv/AEJHgz/v1qH/AMm0Af0yUV/M3/w+y/aF/wChI8Gf9+tQ/wDk2j/h9l+0L/0JHgz/AL9ah/8AJtAH4z0V/TJ/w5N/Z6/6Hfxn/wB/dP8A/kKj/hyb+z1/0O/jP/v7p/8A8hUAfzN0V/TJ/wAOTf2ev+h38Z/9/dP/APkKj/hyb+z1/wBDv4z/AO/un/8AyFQB/M3RX9Mn/Dk39nr/AKHfxn/390//AOQqP+HJv7PX/Q7+M/8Av7p//wAhUAfzN0V/TJ/w5N/Z6/6Hfxn/AN/dP/8AkKj/AIcm/s9f9Dv4z/7+6f8A/IVAH8zdFf0yf8OTf2ev+h38Z/8Af3T/AP5Co/4cm/s9f9Dv4z/7+6f/APIVAH8zdFf0yf8ADk39nr/od/Gf/f3T/wD5Co/4cm/s9f8AQ7+M/wDv7p//AMhUAfzN0V/TJ/w5N/Z6/wCh38Z/9/dP/wDkKvwV/ag+FGifA74++M/hP4cu7q+03w3fi0t7i9KG4kQxRyZkMaomcueigYoA8FooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/AOxzl/8ATfZ1+zFfjP8A8ETf+TevG/8A2Ocv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/v8ooooAKKKKACiiigAooooAKKKKACiiigAr+M//goX/wAnofFb/sNL/wCk0Nf2YV/Gf/wUL/5PQ+K3/YaX/wBJoaAPjOiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP7/KKKKACiiigAooooAKKKKACiiigAooooAK/jP/4KF/8AJ6HxW/7DS/8ApNDX9mFfxn/8FC/+T0Pit/2Gl/8ASaGgD4zooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+/yiiigAooooAKKKKACiiigAooooAKKKKACv4z/+Chf/ACeh8Vv+w0v/AKTQ1/ZhX8Z//BQv/k9D4rf9hpf/AEmhoA+M6KKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/v8ooooAKKKKACiiigAooooAKKKKACiiigAr+M//goX/wAnofFb/sNL/wCk0Nf2YV/Gf/wUL/5PQ+K3/YaX/wBJoaAPjOiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP7/KKKKACiiigAooooAKKKKACiiigAooooAK/jP/4KF/8AJ6HxW/7DS/8ApNDX9mFfxn/8FC/+T0Pit/2Gl/8ASaGgD4zooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+/yiiigAooooAKKKKACiiigAooooAKKKKACv4z/+Chf/ACeh8Vv+w0v/AKTQ1/ZhX8Z//BQv/k9D4rf9hpf/AEmhoA+M6KKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD1L4KfCjW/jj8U/Dvwn8OXdrY6l4kujaW9xelxbxuI2kzIY1d8YQ9FJzX6jf8OTf2hf8Aod/Bn/f3UP8A5Cr4z/4J6f8AJ6Hwp/7DTf8ApNNX9mFAH8zf/Dk39oX/AKHfwZ/391D/AOQqP+HJv7Qv/Q7+DP8Av7qH/wAhV/TJRQB/M3/w5N/aF/6HfwZ/391D/wCQqP8Ahyb+0L/0O/gz/v7qH/yFX9MlFAH8zf8Aw5N/aF/6HfwZ/wB/dQ/+QqP+HJv7Qv8A0O/gz/v7qH/yFX9MlFAH8zf/AA5N/aF/6HfwZ/391D/5Co/4cm/tC/8AQ7+DP+/uof8AyFX9MlFAH8zf/Dk39oX/AKHfwZ/391D/AOQqP+HJv7Qv/Q7+DP8Av7qH/wAhV/TJRQB/M3/w5N/aF/6HfwZ/391D/wCQqP8Ahyb+0L/0O/gz/v7qH/yFX9MlFAH4z/8AD7L9nr/oSPGf/frT/wD5No/4fZfs9f8AQkeM/wDv1p//AMm1/M3RQB/TJ/w+y/Z6/wChI8Z/9+tP/wDk2j/h9l+z1/0JHjP/AL9af/8AJtfzN0UAf0yf8Psv2ev+hI8Z/wDfrT//AJNo/wCH2X7PX/QkeM/+/Wn/APybX8zdFAH9Mn/D7L9nr/oSPGf/AH60/wD+TaP+H2X7PX/QkeM/+/Wn/wDybX8zdFAH9Mn/AA+y/Z6/6Ejxn/360/8A+TaP+H2X7PX/AEJHjP8A79af/wDJtfzN0UAf0yf8Psv2ev8AoSPGf/frT/8A5No/4fZfs9f9CR4z/wC/Wn//ACbX8zdFAH9Mn/D7L9nr/oSPGf8A360//wCTa/BX9qD4r6J8cfj74z+LHhy0urHTfEl+Lu3t70ILiNBFHHiQRs6Zyh6MRivBaKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/ACb143/7HOX/ANN9nX7MV+M//BE3/k3rxv8A9jnL/wCm+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfxn/APBPT/k9D4U/9hpv/Saav7MKACiiigAooooAKKKKACiiigAooooAKKKKAP4A6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+XP/BVv4KfFP44/BTwn4c+E/h268SalY+KY724t7QoHjtxZXUZkPmOgxvdRwc5NAH8pNFfZn/DvT9tD/olOtf99W3/AMeo/wCHen7aH/RKda/76tv/AI9QB8Z0V9mf8O9P20P+iU61/wB9W3/x6j/h3p+2h/0SnWv++rb/AOPUAfGdFfZn/DvT9tD/AKJTrX/fVt/8eo/4d6ftof8ARKda/wC+rb/49QB8Z0V9mf8ADvT9tD/olOtf99W3/wAeo/4d6ftof9Ep1r/vq2/+PUAfGdFfZn/DvT9tD/olOtf99W3/AMeo/wCHen7aH/RKda/76tv/AI9QB8Z0V9mf8O9P20P+iU61/wB9W3/x6j/h3p+2h/0SnWv++rb/AOPUAH/BPT/k9D4U/wDYab/0mmr+zCv5cv2Kv2Kv2pvhz+1N8OvG3jb4dappOh6TqjT3t7O0BjgjMEq7m2ys2NzAcA9a/qNoAKKKKACiiigAooooAKKKKACiiigAooooA/gDor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD9mP+CJv/JvXjf8A7HOX/wBN9nX7MV+XP/BKT4KfFP4HfBTxZ4c+LHh268N6lfeKZL23t7soXktzZWsYkHlu4xvRhyc5FfqNQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9L9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//T/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9T9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9f9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==\"/>\n</defs>\n</svg>\n`;\n\n// src/plugins/open-api/index.ts\nvar getHTML = (apiReference) => `<!doctype html>\n<html>\n  <head>\n    <title>Scalar API Reference</title>\n    <meta charset=\"utf-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1\" />\n  </head>\n  <body>\n    <script\n      id=\"api-reference\"\n      type=\"application/json\">\n    ${JSON.stringify(apiReference)}\n    </script>\n\t <script>\n      var configuration = {\n\t  \tfavicon: \"data:image/svg+xml;utf8,${encodeURIComponent(logo)}\",\n\t   \ttheme: \"saturn\",\n        metaData: {\n\t\t\ttitle: \"Better Auth API\",\n\t\t\tdescription: \"API Reference for your Better Auth Instance\",\n\t\t}\n      }\n\n      document.getElementById('api-reference').dataset.configuration =\n        JSON.stringify(configuration)\n    </script>\n\t  <script src=\"https://cdn.jsdelivr.net/npm/@scalar/api-reference\"></script>\n  </body>\n</html>`;\nvar openAPI = (options) => {\n  const path = options?.path ?? \"/reference\";\n  return {\n    id: \"open-api\",\n    endpoints: {\n      generateOpenAPISchema: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/open-api/generate-schema\",\n        {\n          method: \"GET\"\n        },\n        async (ctx) => {\n          const schema = await generator(ctx.context, ctx.context.options);\n          return ctx.json(schema);\n        }\n      ),\n      openAPIReference: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        path,\n        {\n          method: \"GET\",\n          metadata: {\n            isAction: false\n          }\n        },\n        async (ctx) => {\n          if (options?.disableDefaultReference) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"NOT_FOUND\");\n          }\n          const schema = await generator(ctx.context, ctx.context.options);\n          return new Response(getHTML(schema), {\n            headers: {\n              \"Content-Type\": \"text/html\"\n            }\n          });\n        }\n      )\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstUEhIWVVWRkkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFpRjtBQUM3QjtBQUNJOztBQUV4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDBDQUFTO0FBQ3hDO0FBQ0EsMkJBQTJCLDBDQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxJQUFJO0FBQ2xCO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QiwwQ0FBUyw0QkFBNEIsNENBQVc7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwwQ0FBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0Q0FBVztBQUMxQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSx3Q0FBd0MsNENBQVc7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FB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Iiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstUEhIWVVWRkkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBBUElFcnJvciwgZ2V0RW5kcG9pbnRzIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBnZXRBdXRoVGFibGVzIH0gZnJvbSAnLi9jaHVuay02Mk1XTExFRy5qcyc7XG5pbXBvcnQgeyBab2RPYmplY3QsIFpvZFNjaGVtYSwgWm9kT3B0aW9uYWwgfSBmcm9tICd6b2QnO1xuXG52YXIgcGF0aHMgPSB7fTtcbmZ1bmN0aW9uIGdldFR5cGVGcm9tWm9kVHlwZSh6b2RUeXBlKSB7XG4gIHN3aXRjaCAoem9kVHlwZS5jb25zdHJ1Y3Rvci5uYW1lKSB7XG4gICAgY2FzZSBcIlpvZFN0cmluZ1wiOlxuICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgY2FzZSBcIlpvZE51bWJlclwiOlxuICAgICAgcmV0dXJuIFwibnVtYmVyXCI7XG4gICAgY2FzZSBcIlpvZEJvb2xlYW5cIjpcbiAgICAgIHJldHVybiBcImJvb2xlYW5cIjtcbiAgICBjYXNlIFwiWm9kT2JqZWN0XCI6XG4gICAgICByZXR1cm4gXCJvYmplY3RcIjtcbiAgICBjYXNlIFwiWm9kQXJyYXlcIjpcbiAgICAgIHJldHVybiBcImFycmF5XCI7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBcInN0cmluZ1wiO1xuICB9XG59XG5mdW5jdGlvbiBnZXRQYXJhbWV0ZXJzKG9wdGlvbnMpIHtcbiAgY29uc3QgcGFyYW1ldGVycyA9IFtdO1xuICBpZiAob3B0aW9ucy5tZXRhZGF0YT8ub3BlbmFwaT8ucGFyYW1ldGVycykge1xuICAgIHBhcmFtZXRlcnMucHVzaCguLi5vcHRpb25zLm1ldGFkYXRhLm9wZW5hcGkucGFyYW1ldGVycyk7XG4gICAgcmV0dXJuIHBhcmFtZXRlcnM7XG4gIH1cbiAgaWYgKG9wdGlvbnMucXVlcnkgaW5zdGFuY2VvZiBab2RPYmplY3QpIHtcbiAgICBPYmplY3QuZW50cmllcyhvcHRpb25zLnF1ZXJ5LnNoYXBlKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFpvZFNjaGVtYSkge1xuICAgICAgICBwYXJhbWV0ZXJzLnB1c2goe1xuICAgICAgICAgIG5hbWU6IGtleSxcbiAgICAgICAgICBpbjogXCJxdWVyeVwiLFxuICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgdHlwZTogZ2V0VHlwZUZyb21ab2RUeXBlKHZhbHVlKSxcbiAgICAgICAgICAgIC4uLlwibWluTGVuZ3RoXCIgaW4gdmFsdWUgJiYgdmFsdWUubWluTGVuZ3RoID8ge1xuICAgICAgICAgICAgICBtaW5MZW5ndGg6IHZhbHVlLm1pbkxlbmd0aFxuICAgICAgICAgICAgfSA6IHt9LFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhbHVlLmRlc2NyaXB0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcGFyYW1ldGVycztcbn1cbmZ1bmN0aW9uIGdldFJlcXVlc3RCb2R5KG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMubWV0YWRhdGE/Lm9wZW5hcGk/LnJlcXVlc3RCb2R5KSB7XG4gICAgcmV0dXJuIG9wdGlvbnMubWV0YWRhdGEub3BlbmFwaS5yZXF1ZXN0Qm9keTtcbiAgfVxuICBpZiAoIW9wdGlvbnMuYm9keSkgcmV0dXJuIHZvaWQgMDtcbiAgaWYgKG9wdGlvbnMuYm9keSBpbnN0YW5jZW9mIFpvZE9iamVjdCB8fCBvcHRpb25zLmJvZHkgaW5zdGFuY2VvZiBab2RPcHRpb25hbCkge1xuICAgIGNvbnN0IHNoYXBlID0gb3B0aW9ucy5ib2R5LnNoYXBlO1xuICAgIGlmICghc2hhcGUpIHJldHVybiB2b2lkIDA7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IHt9O1xuICAgIGNvbnN0IHJlcXVpcmVkID0gW107XG4gICAgT2JqZWN0LmVudHJpZXMoc2hhcGUpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgWm9kU2NoZW1hKSB7XG4gICAgICAgIHByb3BlcnRpZXNba2V5XSA9IHtcbiAgICAgICAgICB0eXBlOiBnZXRUeXBlRnJvbVpvZFR5cGUodmFsdWUpLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB2YWx1ZS5kZXNjcmlwdGlvblxuICAgICAgICB9O1xuICAgICAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFpvZE9wdGlvbmFsKSkge1xuICAgICAgICAgIHJlcXVpcmVkLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICByZXF1aXJlZDogb3B0aW9ucy5ib2R5IGluc3RhbmNlb2YgWm9kT3B0aW9uYWwgPyBmYWxzZSA6IG9wdGlvbnMuYm9keSA/IHRydWUgOiBmYWxzZSxcbiAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzLFxuICAgICAgICAgICAgcmVxdWlyZWRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHJldHVybiB2b2lkIDA7XG59XG5mdW5jdGlvbiBnZXRSZXNwb25zZShyZXNwb25zZXMpIHtcbiAgcmV0dXJuIHtcbiAgICBcIjQwMFwiOiB7XG4gICAgICBjb250ZW50OiB7XG4gICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVxdWlyZWQ6IFtcIm1lc3NhZ2VcIl1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjogXCJCYWQgUmVxdWVzdC4gVXN1YWxseSBkdWUgdG8gbWlzc2luZyBwYXJhbWV0ZXJzLCBvciBpbnZhbGlkIHBhcmFtZXRlcnMuXCJcbiAgICB9LFxuICAgIFwiNDAxXCI6IHtcbiAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXF1aXJlZDogW1wibWVzc2FnZVwiXVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiBcIlVuYXV0aG9yaXplZC4gRHVlIHRvIG1pc3Npbmcgb3IgaW52YWxpZCBhdXRoZW50aWNhdGlvbi5cIlxuICAgIH0sXG4gICAgXCI0MDNcIjoge1xuICAgICAgY29udGVudDoge1xuICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiBcIkZvcmJpZGRlbi4gWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIHRoaXMgcmVzb3VyY2Ugb3IgdG8gcGVyZm9ybSB0aGlzIGFjdGlvbi5cIlxuICAgIH0sXG4gICAgXCI0MDRcIjoge1xuICAgICAgY29udGVudDoge1xuICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiBcIk5vdCBGb3VuZC4gVGhlIHJlcXVlc3RlZCByZXNvdXJjZSB3YXMgbm90IGZvdW5kLlwiXG4gICAgfSxcbiAgICBcIjQyOVwiOiB7XG4gICAgICBjb250ZW50OiB7XG4gICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVzY3JpcHRpb246IFwiVG9vIE1hbnkgUmVxdWVzdHMuIFlvdSBoYXZlIGV4Y2VlZGVkIHRoZSByYXRlIGxpbWl0LiBUcnkgYWdhaW4gbGF0ZXIuXCJcbiAgICB9LFxuICAgIFwiNTAwXCI6IHtcbiAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjogXCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IuIFRoaXMgaXMgYSBwcm9ibGVtIHdpdGggdGhlIHNlcnZlciB0aGF0IHlvdSBjYW5ub3QgZml4LlwiXG4gICAgfSxcbiAgICAuLi5yZXNwb25zZXNcbiAgfTtcbn1cbmZ1bmN0aW9uIHRvT3BlbkFwaVBhdGgocGF0aCkge1xuICByZXR1cm4gcGF0aC5zcGxpdChcIi9cIikubWFwKChwYXJ0KSA9PiBwYXJ0LnN0YXJ0c1dpdGgoXCI6XCIpID8gYHske3BhcnQuc2xpY2UoMSl9fWAgOiBwYXJ0KS5qb2luKFwiL1wiKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRvcihjdHgsIG9wdGlvbnMpIHtcbiAgY29uc3QgYmFzZUVuZHBvaW50cyA9IGdldEVuZHBvaW50cyhjdHgsIHtcbiAgICAuLi5vcHRpb25zLFxuICAgIHBsdWdpbnM6IFtdXG4gIH0pO1xuICBjb25zdCB0YWJsZXMgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICBjb25zdCBtb2RlbHMgPSBPYmplY3QuZW50cmllcyh0YWJsZXMpLnJlZHVjZSgoYWNjLCBba2V5LCB2YWx1ZV0pID0+IHtcbiAgICBjb25zdCBtb2RlbE5hbWUgPSBrZXkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBrZXkuc2xpY2UoMSk7XG4gICAgYWNjW21vZGVsTmFtZV0gPSB7XG4gICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgcHJvcGVydGllczogT2JqZWN0LmVudHJpZXModmFsdWUuZmllbGRzKS5yZWR1Y2UoXG4gICAgICAgIChhY2MyLCBba2V5MiwgdmFsdWUyXSkgPT4ge1xuICAgICAgICAgIGFjYzJba2V5Ml0gPSB7XG4gICAgICAgICAgICB0eXBlOiB2YWx1ZTIudHlwZVxuICAgICAgICAgIH07XG4gICAgICAgICAgcmV0dXJuIGFjYzI7XG4gICAgICAgIH0sXG4gICAgICAgIHsgaWQ6IHsgdHlwZTogXCJzdHJpbmdcIiB9IH1cbiAgICAgIClcbiAgICB9O1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgY29uc3QgY29tcG9uZW50cyA9IHtcbiAgICBzY2hlbWFzOiB7XG4gICAgICAuLi5tb2RlbHNcbiAgICB9XG4gIH07XG4gIE9iamVjdC5lbnRyaWVzKGJhc2VFbmRwb2ludHMuYXBpKS5mb3JFYWNoKChbXywgdmFsdWVdKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uczIgPSB2YWx1ZS5vcHRpb25zO1xuICAgIGlmIChvcHRpb25zMi5tZXRhZGF0YT8uU0VSVkVSX09OTFkpIHJldHVybjtcbiAgICBjb25zdCBwYXRoID0gdG9PcGVuQXBpUGF0aCh2YWx1ZS5wYXRoKTtcbiAgICBpZiAob3B0aW9uczIubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgICBwYXRoc1twYXRoXSA9IHtcbiAgICAgICAgZ2V0OiB7XG4gICAgICAgICAgdGFnczogW1wiRGVmYXVsdFwiLCAuLi5vcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8udGFncyB8fCBbXV0sXG4gICAgICAgICAgZGVzY3JpcHRpb246IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5kZXNjcmlwdGlvbixcbiAgICAgICAgICBvcGVyYXRpb25JZDogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/Lm9wZXJhdGlvbklkLFxuICAgICAgICAgIHNlY3VyaXR5OiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJlYXJlckF1dGg6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXSxcbiAgICAgICAgICBwYXJhbWV0ZXJzOiBnZXRQYXJhbWV0ZXJzKG9wdGlvbnMyKSxcbiAgICAgICAgICByZXNwb25zZXM6IGdldFJlc3BvbnNlKG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5yZXNwb25zZXMpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChvcHRpb25zMi5tZXRob2QgPT09IFwiUE9TVFwiKSB7XG4gICAgICBjb25zdCBib2R5ID0gZ2V0UmVxdWVzdEJvZHkob3B0aW9uczIpO1xuICAgICAgcGF0aHNbcGF0aF0gPSB7XG4gICAgICAgIHBvc3Q6IHtcbiAgICAgICAgICB0YWdzOiBbXCJEZWZhdWx0XCIsIC4uLm9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy50YWdzIHx8IFtdXSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LmRlc2NyaXB0aW9uLFxuICAgICAgICAgIG9wZXJhdGlvbklkOiBvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8ub3BlcmF0aW9uSWQsXG4gICAgICAgICAgc2VjdXJpdHk6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYmVhcmVyQXV0aDogW11cbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIHBhcmFtZXRlcnM6IGdldFBhcmFtZXRlcnMob3B0aW9uczIpLFxuICAgICAgICAgIC4uLmJvZHkgPyB7IHJlcXVlc3RCb2R5OiBib2R5IH0gOiB7XG4gICAgICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgICAgICAvL3NldCBib2R5IG5vbmVcbiAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge31cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlc3BvbnNlczogZ2V0UmVzcG9uc2Uob3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LnJlc3BvbnNlcylcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBvcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICBpZiAocGx1Z2luLmlkID09PSBcIm9wZW4tYXBpXCIpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCBwbHVnaW5FbmRwb2ludHMgPSBnZXRFbmRwb2ludHMoY3R4LCB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgcGx1Z2luczogW3BsdWdpbl1cbiAgICB9KTtcbiAgICBjb25zdCBhcGkgPSBPYmplY3Qua2V5cyhwbHVnaW5FbmRwb2ludHMuYXBpKS5tYXAoKGtleSkgPT4ge1xuICAgICAgaWYgKGJhc2VFbmRwb2ludHMuYXBpW2tleV0gPT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm4gcGx1Z2luRW5kcG9pbnRzLmFwaVtrZXldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSkuZmlsdGVyKCh4KSA9PiB4ICE9PSBudWxsKTtcbiAgICBPYmplY3QuZW50cmllcyhhcGkpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9uczIgPSB2YWx1ZS5vcHRpb25zO1xuICAgICAgaWYgKG9wdGlvbnMyLm1ldGFkYXRhPy5TRVJWRVJfT05MWSkgcmV0dXJuO1xuICAgICAgY29uc3QgcGF0aCA9IHRvT3BlbkFwaVBhdGgodmFsdWUucGF0aCk7XG4gICAgICBpZiAob3B0aW9uczIubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgICAgIHBhdGhzW3BhdGhdID0ge1xuICAgICAgICAgIGdldDoge1xuICAgICAgICAgICAgdGFnczogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LnRhZ3MgfHwgW1xuICAgICAgICAgICAgICBwbHVnaW4uaWQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbHVnaW4uaWQuc2xpY2UoMSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5vcGVyYXRpb25JZCxcbiAgICAgICAgICAgIHNlY3VyaXR5OiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiZWFyZXJBdXRoOiBbXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgcGFyYW1ldGVyczogZ2V0UGFyYW1ldGVycyhvcHRpb25zMiksXG4gICAgICAgICAgICByZXNwb25zZXM6IGdldFJlc3BvbnNlKG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5yZXNwb25zZXMpXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMyLm1ldGhvZCA9PT0gXCJQT1NUXCIpIHtcbiAgICAgICAgcGF0aHNbcGF0aF0gPSB7XG4gICAgICAgICAgcG9zdDoge1xuICAgICAgICAgICAgdGFnczogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LnRhZ3MgfHwgW1xuICAgICAgICAgICAgICBwbHVnaW4uaWQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbHVnaW4uaWQuc2xpY2UoMSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5vcGVyYXRpb25JZCxcbiAgICAgICAgICAgIHNlY3VyaXR5OiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiZWFyZXJBdXRoOiBbXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgcGFyYW1ldGVyczogZ2V0UGFyYW1ldGVycyhvcHRpb25zMiksXG4gICAgICAgICAgICByZXF1ZXN0Qm9keTogZ2V0UmVxdWVzdEJvZHkob3B0aW9uczIpLFxuICAgICAgICAgICAgcmVzcG9uc2VzOiBnZXRSZXNwb25zZShvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8ucmVzcG9uc2VzKVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBjb25zdCByZXMgPSB7XG4gICAgb3BlbmFwaTogXCIzLjEuMVwiLFxuICAgIGluZm86IHtcbiAgICAgIHRpdGxlOiBcIkJldHRlciBBdXRoXCIsXG4gICAgICBkZXNjcmlwdGlvbjogXCJBUEkgUmVmZXJlbmNlIGZvciB5b3VyIEJldHRlciBBdXRoIEluc3RhbmNlXCIsXG4gICAgICB2ZXJzaW9uOiBcIjEuMS4wXCJcbiAgICB9LFxuICAgIGNvbXBvbmVudHMsXG4gICAgc2VjdXJpdHk6IFtcbiAgICAgIHtcbiAgICAgICAgYXBpS2V5Q29va2llOiBbXVxuICAgICAgfVxuICAgIF0sXG4gICAgc2VydmVyczogW1xuICAgICAge1xuICAgICAgICB1cmw6IGN0eC5iYXNlVVJMXG4gICAgICB9XG4gICAgXSxcbiAgICB0YWdzOiBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiRGVmYXVsdFwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJEZWZhdWx0IGVuZHBvaW50cyB0aGF0IGFyZSBpbmNsdWRlZCB3aXRoIEJldHRlciBBdXRoIGJ5IGRlZmF1bHQuIFRoZXNlIGVuZHBvaW50cyBhcmUgbm90IHBhcnQgb2YgYW55IHBsdWdpbi5cIlxuICAgICAgfVxuICAgIF0sXG4gICAgcGF0aHNcbiAgfTtcbiAgcmV0dXJuIHJlcztcbn1cblxuLy8gc3JjL3BsdWdpbnMvb3Blbi1hcGkvbG9nby50c1xudmFyIGxvZ28gPSBgPHN2ZyB3aWR0aD1cIjc1XCIgaGVpZ2h0PVwiNzVcIiB2aWV3Qm94PVwiMCAwIDc1IDc1XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCI+XG48cmVjdCB3aWR0aD1cIjc1XCIgaGVpZ2h0PVwiNzVcIiBmaWxsPVwidXJsKCNwYXR0ZXJuMF8yMV8xMilcIi8+XG48ZGVmcz5cbjxwYXR0ZXJuIGlkPVwicGF0dGVybjBfMjFfMTJcIiBwYXR0ZXJuQ29udGVudFVuaXRzPVwib2JqZWN0Qm91bmRpbmdCb3hcIiB3aWR0aD1cIjFcIiBoZWlnaHQ9XCIxXCI+XG48dXNlIHhsaW5rOmhyZWY9XCIjaW1hZ2UwXzIxXzEyXCIgdHJhbnNmb3JtPVwic2NhbGUoMC4wMDA5NDY5NylcIi8+XG48L3BhdHRlcm4+XG48aW1hZ2UgaWQ9XCJpbWFnZTBfMjFfMTJcIiB3aWR0aD1cIjEwNTZcIiBoZWlnaHQ9XCIxMDU2XCIgeGxpbms6aHJlZj1cImRhdGE6aW1hZ2UvanBlZztiYXNlNjQsLzlqLzRBQVFTa1pKUmdBQkFRQUFTQUJJQUFELzRRQkFSWGhwWmdBQVRVMEFLZ0FBQUFnQUFZZHBBQVFBQUFBQkFBQUFHZ0FBQUFBQUFxQUNBQVFBQUFBQkFBQUVJS0FEQUFRQUFBQUJBQUFFSUFBQUFBRC83UUE0VUdodmRHOXphRzl3SURNdU1BQTRRa2xOQkFRQUFBQUFBQUE0UWtsTkJDVUFBQUFBQUJEVUhZelpqd0N5Qk9tQUNaanMrRUorLytJQ0tFbERRMTlRVWs5R1NVeEZBQUVCQUFBQ0dHRndjR3dFQUFBQWJXNTBjbEpIUWlCWVdWb2dCK1lBQVFBQkFBQUFBQUFBWVdOemNFRlFVRXdBQUFBQVFWQlFUQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBUGJXQUFFQUFBQUEweTFoY0hCczdQMmpqamlGUjhOdHRMMVBldG9ZTHdBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUtaR1Z6WXdBQUFQd0FBQUF3WTNCeWRBQUFBU3dBQUFCUWQzUndkQUFBQVh3QUFBQVVjbGhaV2dBQUFaQUFBQUFVWjFoWldnQUFBYVFBQUFBVVlsaFpXZ0FBQWJnQUFBQVVjbFJTUXdBQUFjd0FBQUFnWTJoaFpBQUFBZXdBQUFBc1lsUlNRd0FBQWN3QUFBQWdaMVJTUXdBQUFjd0FBQUFnYld4MVl3QUFBQUFBQUFBQkFBQUFER1Z1VlZNQUFBQVVBQUFBSEFCRUFHa0Fjd0J3QUd3QVlRQjVBQ0FBVUFBemJXeDFZd0FBQUFBQUFBQUJBQUFBREdWdVZWTUFBQUEwQUFBQUhBQkRBRzhBY0FCNUFISUFhUUJuQUdnQWRBQWdBRUVBY0FCd0FHd0FaUUFnQUVrQWJnQmpBQzRBTEFBZ0FESUFNQUF5QURKWVdWb2dBQUFBQUFBQTl0VUFBUUFBQUFEVExGaFpXaUFBQUFBQUFBQ0Qzd0FBUGIvLy8vKzdXRmxhSUFBQUFBQUFBRXEvQUFDeE53QUFDcmxZV1ZvZ0FBQUFBQUFBS0RnQUFCRUxBQURJdVhCaGNtRUFBQUFBQUFNQUFBQUNabVlBQVBLbkFBQU5XUUFBRTlBQUFBcGJjMll6TWdBQUFBQUFBUXhDQUFBRjN2Ly84eVlBQUFlVEFBRDlrUC8vKzZMLy8vMmpBQUFEM0FBQXdHNy93QUFSQ0FRZ0JDQURBU0lBQWhFQkF4RUIvOFFBSHdBQUFRVUJBUUVCQVFFQUFBQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkFBQWdFREF3SUVBd1VGQkFRQUFBRjlBUUlEQUFRUkJSSWhNVUVHRTFGaEJ5SnhGREtCa2FFSUkwS3h3UlZTMGZBa00ySnlnZ2tLRmhjWUdSb2xKaWNvS1NvME5UWTNPRGs2UTBSRlJrZElTVXBUVkZWV1YxaFpXbU5rWldabmFHbHFjM1IxZG5kNGVYcURoSVdHaDRpSmlwS1RsSldXbDVpWm1xS2pwS1dtcDZpcHFyS3p0TFcydDdpNXVzTER4TVhHeDhqSnl0TFQxTlhXMTlqWjJ1SGk0K1RsNXVmbzZlcng4dlAwOWZiMytQbjYvOFFBSHdFQUF3RUJBUUVCQVFFQkFRQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkVBQWdFQ0JBUURCQWNGQkFRQUFRSjNBQUVDQXhFRUJTRXhCaEpCVVFkaGNSTWlNb0VJRkVLUm9iSEJDU016VXZBVlluTFJDaFlrTk9FbDhSY1lHUm9tSnlncEtqVTJOemc1T2tORVJVWkhTRWxLVTFSVlZsZFlXVnBqWkdWbVoyaHBhbk4wZFhaM2VIbDZnb09FaFlhSGlJbUtrcE9VbFphWG1KbWFvcU9rcGFhbnFLbXFzck8wdGJhM3VMbTZ3c1BFeGNiSHlNbkswdFBVMWRiWDJObmE0dVBrNWVibjZPbnE4dlAwOWZiMytQbjYvOXNBUXdBQ0FnSUNBZ0lEQWdJREJBTURBd1FGQkFRRUJBVUhCUVVGQlFVSENBY0hCd2NIQndnSUNBZ0lDQWdJQ2dvS0Nnb0tDd3NMQ3dzTkRRME5EUTBORFEwTi85c0FRd0VDQWdJREF3TUdBd01HRFFrSENRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBOLzkwQUJBQkMvOW9BREFNQkFBSVJBeEVBUHdEOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9RL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8wZjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85TDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVC9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMVAzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOVg5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1cvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzEvMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlEOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9SL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8wdjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85UDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVS9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMWYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOWI5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1gvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzBQMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlIOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9TL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8wLzM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85VDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVi9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMXYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BSy9Mbi9ncTM4YS9pbjhEdmdwNFQ4Ui9DZnhGZGVHOVN2dkZNZGxjWEZvRUx5VzVzcnFReG56RWNZM29wNEdjaXYxR3I4Wi8rQzJYL0p2WGdqL3NjNHYvQUUzM2xBSDR6LzhBRHd2OXREL29xMnRmOTgyMy93QVpvLzRlRi90b2Y5Rlcxci92bTIvK00xOFowVUFmWm4vRHd2OEFiUS82S3RyWC9mTnQvd0RHYVA4QWg0WCsyaC8wVmJXdisrYmIvd0NNMThaMFVBZlpuL0R3djl0RC9vcTJ0ZjhBZk50Lzhaby80ZUYvdG9mOUZXMXIvdm0yL3dEak5mR2RGQUgyWi93OEwvYlEvd0NpcmExLzN6YmYvR2FQK0hoZjdhSC9BRVZiV3Y4QXZtMi8rTTE4WjBVQWZabi9BQThML2JRLzZLdHJYL2ZOdC84QUdhUCtIaGY3YUgvUlZ0YS83NXR2L2pOZkdkRkFIMlovdzhML0FHMFAraXJhMS8zemJmOEF4bWovQUllRi90b2Y5Rlcxci92bTIvOEFqTmZHZEZBSDYzL3NWZnRxL3RUZkViOXFiNGRlQ2ZHM3hGMVRWdEQxYlZHZ3ZiS2RZQkhQR0lKVzJ0dGlWc2JsQjRJNlYvVWJYOFovL0JQVC9rOUQ0VS85aHB2L0FFbW1yK3pDZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCtNL3dENGVGL3RvZjhBUlZ0YS93QytiYi80elIvdzhML2JRLzZLdHJYL0FIemJmL0dhK002S0FQc3ovaDRYKzJoLzBWYld2KytiYi80elIvdzhML2JRL3dDaXJhMS8zemJmL0dhK002S0FQc3ovQUllRi90b2Y5Rlcxci92bTIvOEFqTkgvQUE4TC9iUS82S3RyWC9mTnQvOEFHYStNNktBUHN6L2g0WCsyaC8wVmJXdisrYmIvQU9NMGY4UEMvd0J0RC9vcTJ0Zjk4MjMvQU1acjR6b29BK3pQK0hoZjdhSC9BRVZiV3Y4QXZtMi8rTTBmOFBDLzIwUCtpcmExL3dCODIzL3htdmpPaWdEN00vNGVGL3RvZjlGVzFyL3ZtMi8rTTBmOFBDLzIwUDhBb3EydGY5ODIzL3htdmpPaWdEN00vd0NIaGY3YUgvUlZ0YS83NXR2L0FJelIvd0FQQy8yMFAraXJhMS8zemJmL0FCbXZqT2lnRDdNLzRlRi90b2Y5Rlcxci92bTIvd0RqTkgvRHd2OEFiUS82S3RyWC9mTnQvd0RHYStNNktBUHN6L2g0WCsyaC93QkZXMXIvQUw1dHYvak5IL0R3djl0RC9vcTJ0ZjhBZk50LzhacjR6b29BK3pQK0hoZjdhSC9SVnRhLzc1dHYvak5IL0R3djl0RC9BS0t0clgvZk50LzhacjR6b29BK3pQOEFoNFgrMmgvMFZiV3YrK2JiL3dDTTBmOEFEd3Y5dEQvb3EydGY5ODIzL3dBWnI0em9vQSt6UCtIaGY3YUgvUlZ0YS83NXR2OEE0elIvdzhML0FHMFAraXJhMS8zemJmOEF4bXZqT2lnRDdNLzRlRi90b2Y4QVJWdGEvd0MrYmIvNHpSL3c4TC9iUS82S3RyWC9BSHpiZi9HYStNNktBUDZ0ditDVW54citLZnh4K0NuaXp4SDhXUEVWMTRrMUt4OFV5V1Z2Y1hZUVBIYml5dFpCR1BMUkJqZTdIa1p5YS9VYXZ4bi9BT0NKdi9KdlhqZi9BTEhPWC8wMzJkZnN4UUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQWYvL1gvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQXI4Wi8rQzJYL0p2WGdqL3NjNHYvQUUzM2xmc3hYNHovQVBCYkwvazNyd1IvMk9jWC9wdnZLQVA1bTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BK3pQK0Nlbi9KNkh3cC83RFRmK2swMWYyWVYvR2Y4QThFOVArVDBQaFQvMkdtLzlKcHEvc3dvQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL2dEb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL3BrLzRJbS84bTllTi84QXNjNWYvVGZaMSt6RmZqUC9BTUVUZitUZXZHLy9BR09jdi9wdnM2L1ppZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS85RDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDdnhuLzRMWmY4bTllQ1AreHppLzhBVGZlVit6RmZqUDhBOEZzditUZXZCSC9ZNXhmK20rOG9BL21ib29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Q3TS80SjZmOG5vZkNuL3NOTi82VFRWL1poWDhaL3dEd1QwLzVQUStGUC9ZYWIvMG1tcit6Q2dBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrQU9paWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrbVQvZ2liL3liMTQzL3dDeHpsLzlOOW5YN01WK00vOEF3Uk4vNU42OGIvOEFZNXkvK20renI5bUtBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzBmMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUsvR2YvZ3RsL3liMTRJLzdIT0wvd0JOOTVYN01WK00vd0R3V3kvNU42OEVmOWpuRi82Yjd5Z0QrWnVpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUHN6L2ducC95ZWg4S2YrdzAzL3BOTlg5bUZmeG4vQVBCUFQvazlENFUvOWhwdi9TYWF2N01LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUDRBNktLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUDZaUCtDSnYvSnZYamYvQUxIT1gvMDMyZGZzeFg0ei93REJFMy9rM3J4di93QmpuTC82YjdPdjJZb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvUy9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBcjhaLytDMlgvSnZYZ2ovc2M0di9BRTMzbGZzeFg0ei9BUEJiTC9rM3J3Ui8yT2NYL3B2dktBUDVtNktLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0ErelArQ2VuL0o2SHdwLzdEVGYrazAxZjJZVi9HZjhBOEU5UCtUMFBoVC8yR20vOUpwcS9zd29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvZ0Rvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvcGsvNEltLzhtOWVOLzhBc2M1Zi9UZloxK3pGZmpQL0FNRVRmK1RldkcvL0FHT2N2L3B2czYvWmlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLzlQOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUN2eG4vNExaZjhtOWVDUCt4emkvOEFUZmVWK3pGZmpQOEE4RnN2K1RldkJIL1k1eGYrbSs4b0EvbWJvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRDdNLzRKNmY4bm9mQ24vc05OLzZUVFYvWmhYOFovd0R3VDAvNVBRK0ZQL1lhYi8wbW1yK3pDZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCtBT2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCttVC9naWIveWIxNDMvd0N4emwvOU45blg3TVYrTS84QXdSTi81TjY4Yi84QVk1eS8rbSt6cjltS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvMVAzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BSy9HZi9ndGwveWIxNEkvN0hPTC93Qk45NVg3TVYrTS93RHdXeS81TjY4RWY5am5GLzZiN3lnRCtadWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQc3ovZ25wL3llaDhLZit3MDMvcE5OWDltRmZ3cS9CVDRyNjM4RHZpbjRkK0xIaHkwdGI3VXZEZDBidTN0NzBPYmVSekcwZUpCR3lQakRub3dPYS9VYi9oOWwrMEwvQU5DUjRNLzc5YWgvOG0wQWYweVVWL00zL3dBUHN2MmhmK2hJOEdmOSt0US8rVGFQK0gyWDdRdi9BRUpIZ3ovdjFxSC9BTW0wQWYweVVWL00zL3creS9hRi93Q2hJOEdmOSt0US93RGsyai9oOWwrMEwvMEpIZ3ovQUw5YWgvOEFKdEFIOU1sRmZ6Ti84UHN2MmhmK2hJOEdmOSt0US84QWsyai9BSWZaZnRDLzlDUjRNLzc5YWgvOG0wQWYweVVWL00zL0FNUHN2MmhmK2hJOEdmOEFmclVQL2syai9oOWwrMEwvQU5DUjRNLzc5YWgvOG0wQWYweVVWL00zL3dBUHN2MmhmK2hJOEdmOSt0US8rVGFQK0gyWDdRdi9BRUpIZ3ovdjFxSC9BTW0wQWYweVVWL00zL3creS9hRi93Q2hJOEdmOSt0US93RGsyai9oOWwrMEwvMEpIZ3ovQUw5YWgvOEFKdEFINHowVi9USi93NU4vWjYvNkhmeG4vd0IvZFA4QS9rS2ovaHliK3oxLzBPL2pQL3Y3cC84QThoVUFmek4wVi9USi93QU9UZjJlditoMzhaLzkvZFAvQVBrS2ovaHliK3oxL3dCRHY0ei9BTy91bi84QXlGUUIvTTNSWDlNbi9EazM5bnIvQUtIZnhuLzM5MC8vQU9RcVArSEp2N1BYL1E3K00vOEF2N3AvL3dBaFVBZnpOMFYvVEovdzVOL1o2LzZIZnhuL0FOL2RQLzhBa0tqL0FJY20vczlmOUR2NHovNys2ZjhBL0lWQUg4emRGZjB5ZjhPVGYyZXYraDM4Wi84QWYzVC9BUDVDby80Y20vczlmOUR2NHovNys2Zi9BUElWQUg4emRGZjB5ZjhBRGszOW5yL29kL0dmL2YzVC93RDVDby80Y20vczlmOEFRNytNL3dEdjdwLy9BTWhVQWZ6TjBWL1RKL3c1Ti9aNi93Q2gzOFovOS9kUC93RGtLdndWL2FnK0ZHaWZBNzQrK00vaFA0Y3U3cSswM3czZmkwdDdpOUtHNGtReFJ5WmtNYW9tY3VlaWdZb0E4Rm9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK21UL2dpYi95YjE0My9BT3h6bC84QVRmWjErekZmalA4QThFVGYrVGV2Ry84QTJPY3YvcHZzNi9aaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvLzlYOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUN2eG4vNExaZjhtOWVDUCt4emkvOEFUZmVWK3pGZmpQOEE4RnN2K1RldkJIL1k1eGYrbSs4b0EvbWJvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0Evdjhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQXIrTS8vZ29YL3dBbm9mRmIvc05ML3dDazBOZjJZVi9HZi93VUwvNVBRK0szL1lhWC93QkpvYUFQak9paWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUDZaUCtDSnYvSnZYamYvQUxIT1gvMDMyZGZzeFg0ei93REJFMy9rM3J4di93QmpuTC82YjdPdjJZb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvVy9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBcjhaLytDMlgvSnZYZ2ovc2M0di9BRTMzbGZzeFg0ei9BUEJiTC9rM3J3Ui8yT2NYL3B2dktBUDVtNktLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUDcvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLL2pQLzRLRi84QUo2SHhXLzdEUy84QXBORFg5bUZmeG4vOEZDLytUMFBpdC8yR2wvOEFTYUdnRDR6b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrbVQvZ2liL3liMTQzL3dDeHpsLzlOOW5YN01WK00vOEF3Uk4vNU42OGIvOEFZNXkvK20renI5bUtBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzEvMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUsvR2YvZ3RsL3liMTRJLzdIT0wvd0JOOTVYN01WK00vd0R3V3kvNU42OEVmOWpuRi82Yjd5Z0QrWnVpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrL3lpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ3Y0ei8rQ2hmL0FDZWg4VnYrdzB2L0FLVFExL1poWDhaLy9CUXYvazlENHJmOWhwZi9BRW1ob0ErTTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL3BrLzRJbS84bTllTi84QXNjNWYvVGZaMSt6RmZqUC9BTUVUZitUZXZHLy9BR09jdi9wdnM2L1ppZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS85RDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDdnhuLzRMWmY4bTllQ1AreHppLzhBVGZlVit6RmZqUDhBOEZzditUZXZCSC9ZNXhmK20rOG9BL21ib29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL3Y4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0FyK00vL2dvWC93QW5vZkZiL3NOTC93Q2swTmYyWVYvR2Yvd1VMLzVQUStLMy9ZYVgvd0JKb2FBUGpPaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA2WlArQ0p2L0p2WGpmL0FMSE9YLzAzMmRmc3hYNHovd0RCRTMvazNyeHYvd0JqbkwvNmI3T3YyWW9BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQL1IvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQXI4Wi8rQzJYL0p2WGdqL3NjNHYvQUUzM2xmc3hYNHovQVBCYkwvazNyd1IvMk9jWC9wdnZLQVA1bTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA3L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BSy9qUC80S0YvOEFKNkh4Vy83RFMvOEFwTkRYOW1GZnhuLzhGQy8rVDBQaXQvMkdsLzhBU2FHZ0Q0em9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK21UL2dpYi95YjE0My93Q3h6bC85TjluWDdNVitNLzhBd1JOLzVONjhiLzhBWTV5LyttK3pyOW1LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC8wdjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLL0dmL2d0bC95YjE0SS83SE9ML3dCTjk1WDdNVitNL3dEd1d5LzVONjhFZjlqbkYvNmI3eWdEK1p1aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEKy95aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUN2NHovK0NoZi9BQ2VoOFZ2K3cwdi9BS1RRMS9aaFg4Wi8vQlF2L2s5RDRyZjlocGYvQUVtaG9BK002S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9way80SW0vOG05ZU4vOEFzYzVmL1RmWjErekZmalAvQU1FVGYrVGV2Ry8vQUdPY3YvcHZzNi9aaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvOVA5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ3Z4bi80TFpmOG05ZUNQK3h6aS84QVRmZVYrekZmalA4QThGc3YrVGV2QkgvWTV4ZittKzhvQS9tYm9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEMUw0S2ZDalcvamo4VS9EdnduOE9YZHJZNmw0a3VqYVc5eGVseGJ4dUkya3pJWTFkOFlROUZKelg2amY4T1RmMmhmOEFvZC9Cbi9mM1VQOEE1Q3I0ei80SjZmOEFKNkh3cC83RFRmOEFwTk5YOW1GQUg4emYvRGszOW9YL0FLSGZ3Wi8zOTFEL0FPUXFQK0hKdjdRdi9RNytEUDhBdjdxSC93QWhWL1RKUlFCL00zL3c1Ti9hRi82SGZ3Wi8zOTFEL3dDUXFQOEFoeWIrMEwvME8vZ3ovdjdxSC95Rlg5TWxGQUg4emY4QXc1Ti9hRi82SGZ3Wi93Qi9kUS8rUXFQK0hKdjdRdjhBME8vZ3ovdjdxSC95Rlg5TWxGQUg4emYvQUE1Ti9hRi82SGZ3Wi8zOTFELzVDby80Y20vdEMvOEFRNytEUCsvdW9mOEF5Rlg5TWxGQUg4emYvRGszOW9YL0FLSGZ3Wi8zOTFEL0FPUXFQK0hKdjdRdi9RNytEUDhBdjdxSC93QWhWL1RKUlFCL00zL3c1Ti9hRi82SGZ3Wi8zOTFEL3dDUXFQOEFoeWIrMEwvME8vZ3ovdjdxSC95Rlg5TWxGQUg0ei84QUQ3TDluci9vU1BHZi9mclQvd0Q1Tm8vNGZaZnM5ZjhBUWtlTS93RHYxcC8vQU1tMS9NM1JRQi9USi93K3kvWjYvd0NoSThaLzkrdFAvd0RrMmovaDlsK3oxLzBKSGpQL0FMOWFmLzhBSnRmek4wVUFmMHlmOFBzdjJlditoSThaL3dEZnJULy9BSk5vL3dDSDJYN1BYL1FrZU0vKy9Xbi9BUHliWDh6ZEZBSDlNbi9EN0w5bnIvb1NQR2YvQUg2MC93RCtUYVArSDJYN1BYL1FrZU0vKy9Xbi93RHliWDh6ZEZBSDlNbi9BQSt5L1o2LzZFanhuLzM2MC84QStUYVArSDJYN1BYL0FFSkhqUDhBNzlhZi93REp0ZnpOMFVBZjB5ZjhQc3YyZXY4QW9TUEdmL2ZyVC84QTVOby80ZlpmczlmOUNSNHovd0MvV24vL0FDYlg4emRGQUg5TW4vRDdMOW5yL29TUEdmOEEzNjAvL3dDVGEvQlg5cUQ0cjZKOGNmajc0eitMSGh5MHVySFRmRWwrTHUzdDcwSUxpTkJGSEhpUVJzNlp5aDZNUml2QmFLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUDZaUCtDSnYvQUNiMTQzLzdIT1gvQU5OOW5YN01WK00vL0JFMy9rM3J4djhBOWpuTC93Q20renI5bUtBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELy9VL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0FyOFovK0MyWC9Kdlhnai9zYzR2L0FFMzNsZnN4WDR6L0FQQmJML2szcndSLzJPY1gvcHZ2S0FQNW02S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQSt6UCtDZW4vSjZId3AvN0RUZitrMDFmMllWL0dmOEE4RTlQK1QwUGhULzJHbS85SnBxL3N3b0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9nRG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9way80SW0vOG05ZU4vOEFzYzVmL1RmWjErekZmalAvQU1FVGYrVGV2Ry8vQUdPY3YvcHZzNi9aaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvOVg5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ3Z4bi80TFpmOG05ZUNQK3h6aS84QVRmZVYrekZmalA4QThGc3YrVGV2QkgvWTV4ZittKzhvQS9tYm9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEN00vNEo2Zjhub2ZDbi9zTk4vNlRUVi9aaFg4Wi93RHdUMC81UFErRlAvWWFiLzBtbXIrekNnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK0FPaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK21UL2dpYi95YjE0My93Q3h6bC85TjluWDdNVitNLzhBd1JOLzVONjhiLzhBWTV5LyttK3pyOW1LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC8xdjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLL0dmL2d0bC95YjE0SS83SE9ML3dCTjk1WDdNVitNL3dEd1d5LzVONjhFZjlqbkYvNmI3eWdEK1p1aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVBzei9nbnAveWVoOEtmK3cwMy9wTk5YOW1GZnhuL0FQQlBUL2s5RDRVLzlocHYvU2FhdjdNS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA0QTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA2WlArQ0p2L0p2WGpmL0FMSE9YLzAzMmRmc3hYNHovd0RCRTMvazNyeHYvd0JqbkwvNmI3T3YyWW9BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQL1gvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQXI4Wi8rQzJYL0p2WGdqL3NjNHYvQUUzM2xmc3hYNHovQVBCYkwvazNyd1IvMk9jWC9wdnZLQVA1bTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BK3pQK0Nlbi9KNkh3cC83RFRmK2swMWYyWVYvR2Y4QThFOVArVDBQaFQvMkdtLzlKcHEvc3dvQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL2dEb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL3BrLzRJbS84bTllTi84QXNjNWYvVGZaMSt6RmZqUC9BTUVUZitUZXZHLy9BR09jdi9wdnM2L1ppZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS85RDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDdnhuLzRMWmY4bTllQ1AreHppLzhBVGZlVit6RmZqUDhBOEZzditUZXZCSC9ZNXhmK20rOG9BL21ib29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Q3TS80SjZmOG5vZkNuL3NOTi82VFRWL1poWDhaL3dEd1QwLzVQUStGUC9ZYWIvMG1tcit6Q2dBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrQU9paWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrbVQvZ2liL3liMTQzL3dDeHpsLzlOOW5YN01WK00vOEF3Uk4vNU42OGIvOEFZNXkvK20renI5bUtBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzBmMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUsvR2YvZ3RsL3liMTRJLzdIT0wvd0JOOTVYN01WK1hQL0JWdjRLZkZQNDQvQlR3bjRjK0UvaDI2OFNhbFkrS1k3MjR0N1FvSGp0eFpYVVprUG1PZ3h2ZFJ3YzVOQUg4cE5GZlpuL0R2VDl0RC9vbE90Zjk5VzMvQU1lby93Q0hlbjdhSC9SS2RhLzc2dHYvQUk5UUI4WjBWOW1mOE85UDIwUCtpVTYxL3dCOVczL3g2ai9oM3ArMmgvMFNuV3YrK3JiL0FPUFVBZkdkRmZabi9EdlQ5dEQvQUtKVHJYL2ZWdC84ZW8vNGQ2ZnRvZjhBUktkYS93QytyYi80OVFCOFowVjltZjhBRHZUOXREL29sT3RmOTlXMy93QWVvLzRkNmZ0b2Y5RXAxci92cTIvK1BVQWZHZEZmWm4vRHZUOXREL29sT3RmOTlXMy9BTWVvL3dDSGVuN2FIL1JLZGEvNzZ0di9BSTlRQjhaMFY5bWY4TzlQMjBQK2lVNjEvd0I5VzMveDZqL2gzcCsyaC8wU25XdisrcmIvQU9QVUFIL0JQVC9rOUQ0VS93RFlhYi8wbW1yK3pDdjVjdjJLdjJLdjJwdmh6KzFOOE92RzNqYjRkYXBwT2g2VHFqVDN0N08wQmpnak1FcTdtMnlzMk56QWNBOWEvcU5vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL2dEb3I3TS93Q0hlbjdhSC9SS2RhLzc2dHYvQUk5Ui93QU85UDIwUCtpVTYxLzMxYmYvQUI2Z0Q0em9yN00vNGQ2ZnRvZjlFcDFyL3ZxMi93RGoxSC9EdlQ5dEQvb2xPdGY5OVczL0FNZW9BK002Syt6UCtIZW43YUgvQUVTbld2OEF2cTIvK1BVZjhPOVAyMFAraVU2MS93QjlXMy94NmdENHpvcjdNLzRkNmZ0b2Y5RXAxci92cTIvK1BVZjhPOVAyMFA4QW9sT3RmOTlXMy94NmdENHpvcjdNL3dDSGVuN2FIL1JLZGEvNzZ0di9BSTlSL3dBTzlQMjBQK2lVNjEvMzFiZi9BQjZnRDR6b3I3TS80ZDZmdG9mOUVwMXIvdnEyL3dEajFIL0R2VDl0RC9vbE90Zjk5VzMvQU1lb0ErTTZLK3pQK0hlbjdhSC9BRVNuV3Y4QXZxMi8rUFVmOE85UDIwUCtpVTYxL3dCOVczL3g2Z0Q0em9yN00vNGQ2ZnRvZjlFcDFyL3ZxMi8rUFVmOE85UDIwUDhBb2xPdGY5OVczL3g2Z0Q0em9yN00vd0NIZW43YUgvUktkYS83NnR2L0FJOVIvd0FPOVAyMFAraVU2MS8zMWJmL0FCNmdENHpvcjdNLzRkNmZ0b2Y5RXAxci92cTIvd0RqMUgvRHZUOXREL29sT3RmOTlXMy9BTWVvQStNNksrelArSGVuN2FIL0FFU25XdjhBdnEyLytQVWY4TzlQMjBQK2lVNjEvd0I5VzMveDZnRDR6b3I3TS80ZDZmdG9mOUVwMXIvdnEyLytQVWY4TzlQMjBQOEFvbE90Zjk5VzMveDZnRDR6b3I3TS93Q0hlbjdhSC9SS2RhLzc2dHYvQUk5Ui93QU85UDIwUCtpVTYxLzMxYmYvQUI2Z0Q5bVArQ0p2L0p2WGpmOEE3SE9YL3dCTjluWDdNVitYUC9CS1Q0S2ZGUDRIZkJUeFo0YytMSGgyNjhONmxmZUtaTDIzdDdzb1hrdHpaV3NZa0hsdTR4dlJoeWM1RmZxTlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFmLzlMOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9UL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8xUDM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85WDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVy9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMS8zOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOUQ5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1IvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzB2Mzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlQOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9VL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8xZjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85YjkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vWC9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMFAzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOUg5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1MvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzAvMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlUOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9WL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8xdjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85ZjkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vUS9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMlE9PVwiLz5cbjwvZGVmcz5cbjwvc3ZnPlxuYDtcblxuLy8gc3JjL3BsdWdpbnMvb3Blbi1hcGkvaW5kZXgudHNcbnZhciBnZXRIVE1MID0gKGFwaVJlZmVyZW5jZSkgPT4gYDwhZG9jdHlwZSBodG1sPlxuPGh0bWw+XG4gIDxoZWFkPlxuICAgIDx0aXRsZT5TY2FsYXIgQVBJIFJlZmVyZW5jZTwvdGl0bGU+XG4gICAgPG1ldGEgY2hhcnNldD1cInV0Zi04XCIgLz5cbiAgICA8bWV0YVxuICAgICAgbmFtZT1cInZpZXdwb3J0XCJcbiAgICAgIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MVwiIC8+XG4gIDwvaGVhZD5cbiAgPGJvZHk+XG4gICAgPHNjcmlwdFxuICAgICAgaWQ9XCJhcGktcmVmZXJlbmNlXCJcbiAgICAgIHR5cGU9XCJhcHBsaWNhdGlvbi9qc29uXCI+XG4gICAgJHtKU09OLnN0cmluZ2lmeShhcGlSZWZlcmVuY2UpfVxuICAgIDwvc2NyaXB0PlxuXHQgPHNjcmlwdD5cbiAgICAgIHZhciBjb25maWd1cmF0aW9uID0ge1xuXHQgIFx0ZmF2aWNvbjogXCJkYXRhOmltYWdlL3N2Zyt4bWw7dXRmOCwke2VuY29kZVVSSUNvbXBvbmVudChsb2dvKX1cIixcblx0ICAgXHR0aGVtZTogXCJzYXR1cm5cIixcbiAgICAgICAgbWV0YURhdGE6IHtcblx0XHRcdHRpdGxlOiBcIkJldHRlciBBdXRoIEFQSVwiLFxuXHRcdFx0ZGVzY3JpcHRpb246IFwiQVBJIFJlZmVyZW5jZSBmb3IgeW91ciBCZXR0ZXIgQXV0aCBJbnN0YW5jZVwiLFxuXHRcdH1cbiAgICAgIH1cblxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaS1yZWZlcmVuY2UnKS5kYXRhc2V0LmNvbmZpZ3VyYXRpb24gPVxuICAgICAgICBKU09OLnN0cmluZ2lmeShjb25maWd1cmF0aW9uKVxuICAgIDwvc2NyaXB0PlxuXHQgIDxzY3JpcHQgc3JjPVwiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9Ac2NhbGFyL2FwaS1yZWZlcmVuY2VcIj48L3NjcmlwdD5cbiAgPC9ib2R5PlxuPC9odG1sPmA7XG52YXIgb3BlbkFQSSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHBhdGggPSBvcHRpb25zPy5wYXRoID8/IFwiL3JlZmVyZW5jZVwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm9wZW4tYXBpXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBnZW5lcmF0ZU9wZW5BUElTY2hlbWE6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvb3Blbi1hcGkvZ2VuZXJhdGUtc2NoZW1hXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNjaGVtYSA9IGF3YWl0IGdlbmVyYXRvcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3B0aW9ucyk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHNjaGVtYSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBvcGVuQVBJUmVmZXJlbmNlOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIHBhdGgsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIGlzQWN0aW9uOiBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGlmIChvcHRpb25zPy5kaXNhYmxlRGVmYXVsdFJlZmVyZW5jZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzY2hlbWEgPSBhd2FpdCBnZW5lcmF0b3IoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9wdGlvbnMpO1xuICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoZ2V0SFRNTChzY2hlbWEpLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwidGV4dC9odG1sXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IG9wZW5BUEkgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   anonymous: () => (/* binding */ anonymous)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n\n\n\n\n\n// src/plugins/anonymous/index.ts\nvar schema = {\n  user: {\n    fields: {\n      isAnonymous: {\n        type: \"boolean\",\n        required: false\n      }\n    }\n  }\n};\nvar anonymous = (options) => {\n  const ERROR_CODES = {\n    FAILED_TO_CREATE_USER: \"Failed to create user\",\n    COULD_NOT_CREATE_SESSION: \"Could not create session\",\n    ANONYMOUS_USERS_CANNOT_SIGN_IN_AGAIN_ANONYMOUSLY: \"Anonymous users cannot sign in again anonymously\"\n  };\n  return {\n    id: \"anonymous\",\n    endpoints: {\n      signInAnonymous: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/anonymous\",\n        {\n          method: \"POST\",\n          metadata: {\n            openapi: {\n              description: \"Sign in anonymously\",\n              responses: {\n                200: {\n                  description: \"Sign in anonymously\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { emailDomainName = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getOrigin)(ctx.context.baseURL) } = options || {};\n          const id = ctx.context.generateId({ model: \"user\" });\n          const email = `temp-${id}@${emailDomainName}`;\n          const newUser = await ctx.context.internalAdapter.createUser({\n            id,\n            email,\n            emailVerified: false,\n            isAnonymous: true,\n            name: \"Anonymous\",\n            createdAt: /* @__PURE__ */ new Date(),\n            updatedAt: /* @__PURE__ */ new Date()\n          });\n          if (!newUser) {\n            return ctx.json(null, {\n              status: 500,\n              body: {\n                message: ERROR_CODES.FAILED_TO_CREATE_USER,\n                status: 500\n              }\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            newUser.id,\n            ctx.request\n          );\n          if (!session) {\n            return ctx.json(null, {\n              status: 400,\n              body: {\n                message: ERROR_CODES.COULD_NOT_CREATE_SESSION\n              }\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n            session,\n            user: newUser\n          });\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: newUser.id,\n              email: newUser.email,\n              emailVerified: newUser.emailVerified,\n              name: newUser.name,\n              createdAt: newUser.createdAt,\n              updatedAt: newUser.updatedAt\n            }\n          });\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            const setCookie = context.responseHeader.get(\"set-cookie\");\n            setCookie?.includes(\n              context.context.authCookies.sessionToken.name\n            );\n            return context.path.startsWith(\"/sign-in\") || context.path.startsWith(\"/sign-up\") || context.path.startsWith(\"/callback\") || context.path.startsWith(\"/oauth2/callback\") || context.path.startsWith(\"/magic-link/verify\") || context.path.startsWith(\"/email-otp/verify-email\");\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const headers = ctx.context.returned instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError ? ctx.context.returned.headers : ctx.responseHeader;\n            const setCookie = headers.get(\"set-cookie\");\n            const sessionTokenName = ctx.context.authCookies.sessionToken.name;\n            const sessionCookie = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.parseSetCookieHeader)(setCookie || \"\").get(sessionTokenName)?.value.split(\".\")[0];\n            if (!sessionCookie) {\n              return;\n            }\n            const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(\n              ctx,\n              {\n                disableRefresh: true\n              }\n            );\n            if (!session || !session.user.isAnonymous) {\n              return;\n            }\n            if (ctx.path === \"/sign-in/anonymous\") {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.ANONYMOUS_USERS_CANNOT_SIGN_IN_AGAIN_ANONYMOUSLY\n              });\n            }\n            const newSession = ctx.context.newSession;\n            if (!newSession) {\n              return;\n            }\n            if (options?.onLinkAccount) {\n              await options?.onLinkAccount?.({\n                anonymousUser: session,\n                newUser: newSession\n              });\n            }\n            if (!options?.disableDeleteAnonymousUser) {\n              await ctx.context.internalAdapter.deleteUser(session.user.id);\n            }\n          })\n        }\n      ]\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.mergeSchema)(schema, options?.schema),\n    $ERROR_CODES: ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstUFpPQjY2QVAuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBNEc7QUFDNUQ7QUFDNkI7QUFDM0I7O0FBRWxEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0VBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxrQkFBa0Isa0JBQWtCLDZEQUFTLHdCQUF3QjtBQUNyRSw4Q0FBOEMsZUFBZTtBQUM3RCxnQ0FBZ0MsR0FBRyxHQUFHLGdCQUFnQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxnQkFBZ0Isb0VBQWdCO0FBQ2hDO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsbUJBQW1CLHdFQUFvQjtBQUN2Qyw0REFBNEQsd0RBQVE7QUFDcEU7QUFDQTtBQUNBLGtDQUFrQyx3RUFBb0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHFFQUFpQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0RBQVE7QUFDaEM7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSwrREFBVztBQUN2QjtBQUNBO0FBQ0E7O0FBRXFCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstUFpPQjY2QVAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBjcmVhdGVBdXRoTWlkZGxld2FyZSwgQVBJRXJyb3IsIGdldFNlc3Npb25Gcm9tQ3R4IH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBnZXRPcmlnaW4gfSBmcm9tICcuL2NodW5rLVhGQ0lBTlpYLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUsIHBhcnNlU2V0Q29va2llSGVhZGVyIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBtZXJnZVNjaGVtYSB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuXG4vLyBzcmMvcGx1Z2lucy9hbm9ueW1vdXMvaW5kZXgudHNcbnZhciBzY2hlbWEgPSB7XG4gIHVzZXI6IHtcbiAgICBmaWVsZHM6IHtcbiAgICAgIGlzQW5vbnltb3VzOiB7XG4gICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG52YXIgYW5vbnltb3VzID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgRkFJTEVEX1RPX0NSRUFURV9VU0VSOiBcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiLFxuICAgIENPVUxEX05PVF9DUkVBVEVfU0VTU0lPTjogXCJDb3VsZCBub3QgY3JlYXRlIHNlc3Npb25cIixcbiAgICBBTk9OWU1PVVNfVVNFUlNfQ0FOTk9UX1NJR05fSU5fQUdBSU5fQU5PTllNT1VTTFk6IFwiQW5vbnltb3VzIHVzZXJzIGNhbm5vdCBzaWduIGluIGFnYWluIGFub255bW91c2x5XCJcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJhbm9ueW1vdXNcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNpZ25JbkFub255bW91czogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9zaWduLWluL2Fub255bW91c1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIGFub255bW91c2x5XCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiBhbm9ueW1vdXNseVwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgeyBlbWFpbERvbWFpbk5hbWUgPSBnZXRPcmlnaW4oY3R4LmNvbnRleHQuYmFzZVVSTCkgfSA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgY29uc3QgaWQgPSBjdHguY29udGV4dC5nZW5lcmF0ZUlkKHsgbW9kZWw6IFwidXNlclwiIH0pO1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gYHRlbXAtJHtpZH1AJHtlbWFpbERvbWFpbk5hbWV9YDtcbiAgICAgICAgICBjb25zdCBuZXdVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVVzZXIoe1xuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgICAgaXNBbm9ueW1vdXM6IHRydWUsXG4gICAgICAgICAgICBuYW1lOiBcIkFub255bW91c1wiLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIW5ld1VzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSLFxuICAgICAgICAgICAgICAgIHN0YXR1czogNTAwXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICBuZXdVc2VyLmlkLFxuICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5DT1VMRF9OT1RfQ1JFQVRFX1NFU1NJT05cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgICAgdXNlcjogbmV3VXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IG5ld1VzZXIuaWQsXG4gICAgICAgICAgICAgIGVtYWlsOiBuZXdVc2VyLmVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBuZXdVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgIG5hbWU6IG5ld1VzZXIubmFtZSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXdVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXdVc2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICBob29rczoge1xuICAgICAgYWZ0ZXI6IFtcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXIoY29udGV4dCkge1xuICAgICAgICAgICAgY29uc3Qgc2V0Q29va2llID0gY29udGV4dC5yZXNwb25zZUhlYWRlci5nZXQoXCJzZXQtY29va2llXCIpO1xuICAgICAgICAgICAgc2V0Q29va2llPy5pbmNsdWRlcyhcbiAgICAgICAgICAgICAgY29udGV4dC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQucGF0aC5zdGFydHNXaXRoKFwiL3NpZ24taW5cIikgfHwgY29udGV4dC5wYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi11cFwiKSB8fCBjb250ZXh0LnBhdGguc3RhcnRzV2l0aChcIi9jYWxsYmFja1wiKSB8fCBjb250ZXh0LnBhdGguc3RhcnRzV2l0aChcIi9vYXV0aDIvY2FsbGJhY2tcIikgfHwgY29udGV4dC5wYXRoLnN0YXJ0c1dpdGgoXCIvbWFnaWMtbGluay92ZXJpZnlcIikgfHwgY29udGV4dC5wYXRoLnN0YXJ0c1dpdGgoXCIvZW1haWwtb3RwL3ZlcmlmeS1lbWFpbFwiKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGhhbmRsZXI6IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBjdHguY29udGV4dC5yZXR1cm5lZCBpbnN0YW5jZW9mIEFQSUVycm9yID8gY3R4LmNvbnRleHQucmV0dXJuZWQuaGVhZGVycyA6IGN0eC5yZXNwb25zZUhlYWRlcjtcbiAgICAgICAgICAgIGNvbnN0IHNldENvb2tpZSA9IGhlYWRlcnMuZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbk5hbWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25Db29raWUgPSBwYXJzZVNldENvb2tpZUhlYWRlcihzZXRDb29raWUgfHwgXCJcIikuZ2V0KHNlc3Npb25Ub2tlbk5hbWUpPy52YWx1ZS5zcGxpdChcIi5cIilbMF07XG4gICAgICAgICAgICBpZiAoIXNlc3Npb25Db29raWUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KFxuICAgICAgICAgICAgICBjdHgsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkaXNhYmxlUmVmcmVzaDogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKCFzZXNzaW9uIHx8ICFzZXNzaW9uLnVzZXIuaXNBbm9ueW1vdXMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGN0eC5wYXRoID09PSBcIi9zaWduLWluL2Fub255bW91c1wiKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5BTk9OWU1PVVNfVVNFUlNfQ0FOTk9UX1NJR05fSU5fQUdBSU5fQU5PTllNT1VTTFlcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBuZXdTZXNzaW9uID0gY3R4LmNvbnRleHQubmV3U2Vzc2lvbjtcbiAgICAgICAgICAgIGlmICghbmV3U2Vzc2lvbikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucz8ub25MaW5rQWNjb3VudCkge1xuICAgICAgICAgICAgICBhd2FpdCBvcHRpb25zPy5vbkxpbmtBY2NvdW50Py4oe1xuICAgICAgICAgICAgICAgIGFub255bW91c1VzZXI6IHNlc3Npb24sXG4gICAgICAgICAgICAgICAgbmV3VXNlcjogbmV3U2Vzc2lvblxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghb3B0aW9ucz8uZGlzYWJsZURlbGV0ZUFub255bW91c1VzZXIpIHtcbiAgICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSxcbiAgICBzY2hlbWE6IG1lcmdlU2NoZW1hKHNjaGVtYSwgb3B0aW9ucz8uc2NoZW1hKSxcbiAgICAkRVJST1JfQ09ERVM6IEVSUk9SX0NPREVTXG4gIH07XG59O1xuXG5leHBvcnQgeyBhbm9ueW1vdXMgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCookieGetter: () => (/* binding */ createCookieGetter),\n/* harmony export */   deleteSessionCookie: () => (/* binding */ deleteSessionCookie),\n/* harmony export */   getCookieCache: () => (/* binding */ getCookieCache),\n/* harmony export */   getCookies: () => (/* binding */ getCookies),\n/* harmony export */   getSessionCookie: () => (/* binding */ getSessionCookie),\n/* harmony export */   parseCookies: () => (/* binding */ parseCookies),\n/* harmony export */   parseSetCookieHeader: () => (/* binding */ parseSetCookieHeader),\n/* harmony export */   setCookieCache: () => (/* binding */ setCookieCache),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie)\n/* harmony export */ });\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n\n\n\n\n\n\n\n// src/utils/time.ts\nvar createTime = (value, format) => {\n  const toMilliseconds = () => {\n    switch (format) {\n      case \"ms\":\n        return value;\n      case \"s\":\n        return value * 1e3;\n      case \"m\":\n        return value * 1e3 * 60;\n      case \"h\":\n        return value * 1e3 * 60 * 60;\n      case \"d\":\n        return value * 1e3 * 60 * 60 * 24;\n      case \"w\":\n        return value * 1e3 * 60 * 60 * 24 * 7;\n      case \"y\":\n        return value * 1e3 * 60 * 60 * 24 * 365;\n    }\n  };\n  const time = {\n    t: `${value}${format}`,\n    value,\n    tFormat: format,\n    toMilliseconds,\n    toSeconds: () => time.toMilliseconds() / 1e3,\n    toMinutes: () => time.toSeconds() / 60,\n    toHours: () => time.toMinutes() / 60,\n    toDays: () => time.toHours() / 24,\n    toWeeks: () => time.toDays() / 7,\n    toYears: () => time.toDays() / 365,\n    getDate: () => new Date(Date.now() + time.toMilliseconds()),\n    add: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return createTime(time.toMilliseconds() + otherMs, \"ms\");\n    },\n    subtract: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return createTime(time.toMilliseconds() - otherMs, \"ms\");\n    },\n    multiply: (factor) => createTime(time.toMilliseconds() * factor, \"ms\"),\n    divide: (divisor) => createTime(time.toMilliseconds() / divisor, \"ms\"),\n    equals: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return time.toMilliseconds() === otherMs;\n    },\n    lessThan: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return time.toMilliseconds() < otherMs;\n    },\n    greaterThan: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return time.toMilliseconds() > otherMs;\n    },\n    format: (pattern) => {\n      const date = time.getDate();\n      return pattern.replace(/YYYY|MM|DD|HH|mm|ss/g, (match) => {\n        switch (match) {\n          case \"YYYY\":\n            return date.getFullYear().toString();\n          case \"MM\":\n            return (date.getMonth() + 1).toString().padStart(2, \"0\");\n          case \"DD\":\n            return date.getDate().toString().padStart(2, \"0\");\n          case \"HH\":\n            return date.getHours().toString().padStart(2, \"0\");\n          case \"mm\":\n            return date.getMinutes().toString().padStart(2, \"0\");\n          case \"ss\":\n            return date.getSeconds().toString().padStart(2, \"0\");\n          default:\n            return match;\n        }\n      });\n    },\n    fromNow: () => {\n      const ms = time.toMilliseconds();\n      if (ms < 0) return time.ago();\n      if (ms < 1e3) return \"in a few seconds\";\n      if (ms < 6e4) return `in ${Math.round(ms / 1e3)} seconds`;\n      if (ms < 36e5) return `in ${Math.round(ms / 6e4)} minutes`;\n      if (ms < 864e5) return `in ${Math.round(ms / 36e5)} hours`;\n      if (ms < 6048e5) return `in ${Math.round(ms / 864e5)} days`;\n      if (ms < 26298e5) return `in ${Math.round(ms / 6048e5)} weeks`;\n      if (ms < 315576e5) return `in ${Math.round(ms / 26298e5)} months`;\n      return `in ${Math.round(ms / 315576e5)} years`;\n    },\n    ago: () => {\n      const ms = -time.toMilliseconds();\n      if (ms < 0) return time.fromNow();\n      if (ms < 1e3) return \"a few seconds ago\";\n      if (ms < 6e4) return `${Math.round(ms / 1e3)} seconds ago`;\n      if (ms < 36e5) return `${Math.round(ms / 6e4)} minutes ago`;\n      if (ms < 864e5) return `${Math.round(ms / 36e5)} hours ago`;\n      if (ms < 6048e5) return `${Math.round(ms / 864e5)} days ago`;\n      if (ms < 26298e5) return `${Math.round(ms / 6048e5)} weeks ago`;\n      if (ms < 315576e5) return `${Math.round(ms / 26298e5)} months ago`;\n      return `${Math.round(ms / 315576e5)} years ago`;\n    }\n  };\n  return time;\n};\nvar parseTime = (time) => {\n  const match = time.match(/^(\\d+)(ms|s|m|h|d|w|y)$/);\n  if (!match) throw new Error(\"Invalid time format\");\n  return createTime(parseInt(match[1]), match[2]);\n};\n\n// src/cookies/cookie-utils.ts\nfunction parseSetCookieHeader(setCookie) {\n  const cookies = /* @__PURE__ */ new Map();\n  const cookieArray = setCookie.split(\", \");\n  cookieArray.forEach((cookieString) => {\n    const parts = cookieString.split(\";\").map((part) => part.trim());\n    const [nameValue, ...attributes] = parts;\n    const [name, ...valueParts] = nameValue.split(\"=\");\n    const value = valueParts.join(\"=\");\n    if (!name || value === void 0) {\n      return;\n    }\n    const attrObj = { value };\n    attributes.forEach((attribute) => {\n      const [attrName, ...attrValueParts] = attribute.split(\"=\");\n      const attrValue = attrValueParts.join(\"=\");\n      const normalizedAttrName = attrName.trim().toLowerCase();\n      switch (normalizedAttrName) {\n        case \"max-age\":\n          attrObj[\"max-age\"] = attrValue ? parseInt(attrValue.trim(), 10) : void 0;\n          break;\n        case \"expires\":\n          attrObj.expires = attrValue ? new Date(attrValue.trim()) : void 0;\n          break;\n        case \"domain\":\n          attrObj.domain = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"path\":\n          attrObj.path = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"secure\":\n          attrObj.secure = true;\n          break;\n        case \"httponly\":\n          attrObj.httponly = true;\n          break;\n        case \"samesite\":\n          attrObj.samesite = attrValue ? attrValue.trim().toLowerCase() : void 0;\n          break;\n        default:\n          attrObj[normalizedAttrName] = attrValue ? attrValue.trim() : true;\n          break;\n      }\n    });\n    cookies.set(name, attrObj);\n  });\n  return cookies;\n}\n\n// src/cookies/index.ts\nfunction createCookieGetter(options) {\n  const secure = options.advanced?.useSecureCookies !== void 0 ? options.advanced?.useSecureCookies : options.baseURL !== void 0 ? options.baseURL.startsWith(\"https://\") ? true : false : _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__.isProduction;\n  const secureCookiePrefix = secure ? \"__Secure-\" : \"\";\n  const crossSubdomainEnabled = !!options.advanced?.crossSubDomainCookies?.enabled;\n  const domain = crossSubdomainEnabled ? options.advanced?.crossSubDomainCookies?.domain || (options.baseURL ? new URL(options.baseURL).hostname : void 0) : void 0;\n  if (crossSubdomainEnabled && !domain) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\n      \"baseURL is required when crossSubdomainCookies are enabled\"\n    );\n  }\n  function createCookie(cookieName, overrideAttributes = {}) {\n    const prefix = options.advanced?.cookiePrefix || \"better-auth\";\n    const name = options.advanced?.cookies?.[cookieName]?.name || `${prefix}.${cookieName}`;\n    const attributes = options.advanced?.cookies?.[cookieName]?.attributes;\n    return {\n      name: `${secureCookiePrefix}${name}`,\n      attributes: {\n        secure: !!secureCookiePrefix,\n        sameSite: \"lax\",\n        path: \"/\",\n        httpOnly: true,\n        ...crossSubdomainEnabled ? { domain } : {},\n        ...options.advanced?.defaultCookieAttributes,\n        ...overrideAttributes,\n        ...attributes\n      }\n    };\n  }\n  return createCookie;\n}\nfunction getCookies(options) {\n  const createCookie = createCookieGetter(options);\n  const sessionMaxAge = options.session?.expiresIn || createTime(7, \"d\").toSeconds();\n  const sessionToken = createCookie(\"session_token\", {\n    maxAge: sessionMaxAge\n  });\n  const sessionData = createCookie(\"session_data\", {\n    maxAge: options.session?.cookieCache?.maxAge || 60 * 5\n  });\n  const dontRememberToken = createCookie(\"dont_remember\");\n  return {\n    sessionToken: {\n      name: sessionToken.name,\n      options: sessionToken.attributes\n    },\n    /**\n     * This cookie is used to store the session data in the cookie\n     * This is useful for when you want to cache the session in the cookie\n     */\n    sessionData: {\n      name: sessionData.name,\n      options: sessionData.attributes\n    },\n    dontRememberToken: {\n      name: dontRememberToken.name,\n      options: dontRememberToken.attributes\n    }\n  };\n}\nasync function setCookieCache(ctx, session) {\n  const shouldStoreSessionDataInCookie = ctx.context.options.session?.cookieCache?.enabled;\n  if (shouldStoreSessionDataInCookie) {\n    const data = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_4__.base64Url.encode(\n      JSON.stringify({\n        session,\n        expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_1__.getDate)(\n          ctx.context.authCookies.sessionData.options.maxAge || 60,\n          \"sec\"\n        ).getTime(),\n        signature: await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_5__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n          ctx.context.secret,\n          JSON.stringify(session)\n        )\n      }),\n      {\n        padding: false\n      }\n    );\n    if (data.length > 4093) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\n        \"Session data is too large to store in the cookie. Please disable session cookie caching or reduce the size of the session data\"\n      );\n    }\n    ctx.setCookie(\n      ctx.context.authCookies.sessionData.name,\n      data,\n      ctx.context.authCookies.sessionData.options\n    );\n  }\n}\nasync function setSessionCookie(ctx, session, dontRememberMe, overrides) {\n  const options = ctx.context.authCookies.sessionToken.options;\n  const maxAge = dontRememberMe ? void 0 : ctx.context.sessionConfig.expiresIn;\n  await ctx.setSignedCookie(\n    ctx.context.authCookies.sessionToken.name,\n    session.session.token,\n    ctx.context.secret,\n    {\n      ...options,\n      maxAge,\n      ...overrides\n    }\n  );\n  if (dontRememberMe) {\n    await ctx.setSignedCookie(\n      ctx.context.authCookies.dontRememberToken.name,\n      \"true\",\n      ctx.context.secret,\n      ctx.context.authCookies.dontRememberToken.options\n    );\n  }\n  await setCookieCache(ctx, session);\n  ctx.context.setNewSession(session);\n  if (ctx.context.options.secondaryStorage) {\n    await ctx.context.secondaryStorage?.set(\n      session.session.token,\n      JSON.stringify({\n        user: session.user,\n        session: session.session\n      }),\n      Math.floor(\n        (new Date(session.session.expiresAt).getTime() - Date.now()) / 1e3\n      )\n    );\n  }\n}\nfunction deleteSessionCookie(ctx) {\n  ctx.setCookie(ctx.context.authCookies.sessionToken.name, \"\", {\n    ...ctx.context.authCookies.sessionToken.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.sessionData.name, \"\", {\n    ...ctx.context.authCookies.sessionData.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.dontRememberToken.name, \"\", {\n    ...ctx.context.authCookies.dontRememberToken.options,\n    maxAge: 0\n  });\n}\nfunction parseCookies(cookieHeader) {\n  const cookies = cookieHeader.split(\"; \");\n  const cookieMap = /* @__PURE__ */ new Map();\n  cookies.forEach((cookie) => {\n    const [name, value] = cookie.split(\"=\");\n    cookieMap.set(name, value);\n  });\n  return cookieMap;\n}\nvar getSessionCookie = (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_token\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__.isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionToken = parsedCookie.get(name);\n  if (sessionToken) {\n    return sessionToken;\n  }\n  return null;\n};\nvar getCookieCache = (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_data\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__.isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionData = parsedCookie.get(name);\n  if (sessionData) {\n    return (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_0__.safeJSONParse)(sessionData);\n  }\n  return null;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstUVFHWjNYR0kuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW9EO0FBQ047QUFDSztBQUNHO0FBQ0E7QUFDRDs7QUFFckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxNQUFNLEVBQUUsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxzQkFBc0I7QUFDdkQsa0NBQWtDLHNCQUFzQjtBQUN4RCxtQ0FBbUMsdUJBQXVCO0FBQzFELG9DQUFvQyx3QkFBd0I7QUFDNUQscUNBQXFDLHlCQUF5QjtBQUM5RCxzQ0FBc0MsMEJBQTBCO0FBQ2hFLG1CQUFtQiwyQkFBMkI7QUFDOUMsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHNCQUFzQjtBQUNwRCwrQkFBK0Isc0JBQXNCO0FBQ3JELGdDQUFnQyx1QkFBdUI7QUFDdkQsaUNBQWlDLHdCQUF3QjtBQUN6RCxrQ0FBa0MseUJBQXlCO0FBQzNELG1DQUFtQywwQkFBMEI7QUFDN0QsZ0JBQWdCLDJCQUEyQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDJMQUEyTCw0REFBWTtBQUN2TTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsK0RBQWU7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNEO0FBQ0EscUVBQXFFLE9BQU8sR0FBRyxXQUFXO0FBQzFGO0FBQ0E7QUFDQSxlQUFlLG1CQUFtQixFQUFFLEtBQUs7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxTQUFTLElBQUk7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixnRUFBUztBQUMxQjtBQUNBO0FBQ0EsbUJBQW1CLDJEQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixtRUFBVTtBQUNuQztBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwrREFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDZEQUE2RDtBQUN2RSxlQUFlLDREQUFZLGVBQWUsYUFBYSxHQUFHLFdBQVcsT0FBTyxhQUFhLEdBQUcsV0FBVztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsNERBQTREO0FBQ3RFLGVBQWUsNERBQVksZUFBZSxhQUFhLEdBQUcsV0FBVyxPQUFPLGFBQWEsR0FBRyxXQUFXO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBLFdBQVcsaUVBQWE7QUFDeEI7QUFDQTtBQUNBOztBQUV1SyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVFRR1ozWEdJLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2NodW5rLTUzSVBPMlBKLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IGlzUHJvZHVjdGlvbiB9IGZyb20gJy4vY2h1bmstVFFRU1BQTkEuanMnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnLi9jaHVuay1VTldDWEtNUC5qcyc7XG5pbXBvcnQgeyBiYXNlNjRVcmwgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IGNyZWF0ZUhNQUMgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaG1hYyc7XG5cbi8vIHNyYy91dGlscy90aW1lLnRzXG52YXIgY3JlYXRlVGltZSA9ICh2YWx1ZSwgZm9ybWF0KSA9PiB7XG4gIGNvbnN0IHRvTWlsbGlzZWNvbmRzID0gKCkgPT4ge1xuICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICBjYXNlIFwibXNcIjpcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgY2FzZSBcInNcIjpcbiAgICAgICAgcmV0dXJuIHZhbHVlICogMWUzO1xuICAgICAgY2FzZSBcIm1cIjpcbiAgICAgICAgcmV0dXJuIHZhbHVlICogMWUzICogNjA7XG4gICAgICBjYXNlIFwiaFwiOlxuICAgICAgICByZXR1cm4gdmFsdWUgKiAxZTMgKiA2MCAqIDYwO1xuICAgICAgY2FzZSBcImRcIjpcbiAgICAgICAgcmV0dXJuIHZhbHVlICogMWUzICogNjAgKiA2MCAqIDI0O1xuICAgICAgY2FzZSBcIndcIjpcbiAgICAgICAgcmV0dXJuIHZhbHVlICogMWUzICogNjAgKiA2MCAqIDI0ICogNztcbiAgICAgIGNhc2UgXCJ5XCI6XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIDFlMyAqIDYwICogNjAgKiAyNCAqIDM2NTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IHRpbWUgPSB7XG4gICAgdDogYCR7dmFsdWV9JHtmb3JtYXR9YCxcbiAgICB2YWx1ZSxcbiAgICB0Rm9ybWF0OiBmb3JtYXQsXG4gICAgdG9NaWxsaXNlY29uZHMsXG4gICAgdG9TZWNvbmRzOiAoKSA9PiB0aW1lLnRvTWlsbGlzZWNvbmRzKCkgLyAxZTMsXG4gICAgdG9NaW51dGVzOiAoKSA9PiB0aW1lLnRvU2Vjb25kcygpIC8gNjAsXG4gICAgdG9Ib3VyczogKCkgPT4gdGltZS50b01pbnV0ZXMoKSAvIDYwLFxuICAgIHRvRGF5czogKCkgPT4gdGltZS50b0hvdXJzKCkgLyAyNCxcbiAgICB0b1dlZWtzOiAoKSA9PiB0aW1lLnRvRGF5cygpIC8gNyxcbiAgICB0b1llYXJzOiAoKSA9PiB0aW1lLnRvRGF5cygpIC8gMzY1LFxuICAgIGdldERhdGU6ICgpID0+IG5ldyBEYXRlKERhdGUubm93KCkgKyB0aW1lLnRvTWlsbGlzZWNvbmRzKCkpLFxuICAgIGFkZDogKG90aGVyKSA9PiB7XG4gICAgICBjb25zdCBvdGhlck1zID0gdHlwZW9mIG90aGVyID09PSBcInN0cmluZ1wiID8gcGFyc2VUaW1lKG90aGVyKS50b01pbGxpc2Vjb25kcygpIDogb3RoZXIudG9NaWxsaXNlY29uZHMoKTtcbiAgICAgIHJldHVybiBjcmVhdGVUaW1lKHRpbWUudG9NaWxsaXNlY29uZHMoKSArIG90aGVyTXMsIFwibXNcIik7XG4gICAgfSxcbiAgICBzdWJ0cmFjdDogKG90aGVyKSA9PiB7XG4gICAgICBjb25zdCBvdGhlck1zID0gdHlwZW9mIG90aGVyID09PSBcInN0cmluZ1wiID8gcGFyc2VUaW1lKG90aGVyKS50b01pbGxpc2Vjb25kcygpIDogb3RoZXIudG9NaWxsaXNlY29uZHMoKTtcbiAgICAgIHJldHVybiBjcmVhdGVUaW1lKHRpbWUudG9NaWxsaXNlY29uZHMoKSAtIG90aGVyTXMsIFwibXNcIik7XG4gICAgfSxcbiAgICBtdWx0aXBseTogKGZhY3RvcikgPT4gY3JlYXRlVGltZSh0aW1lLnRvTWlsbGlzZWNvbmRzKCkgKiBmYWN0b3IsIFwibXNcIiksXG4gICAgZGl2aWRlOiAoZGl2aXNvcikgPT4gY3JlYXRlVGltZSh0aW1lLnRvTWlsbGlzZWNvbmRzKCkgLyBkaXZpc29yLCBcIm1zXCIpLFxuICAgIGVxdWFsczogKG90aGVyKSA9PiB7XG4gICAgICBjb25zdCBvdGhlck1zID0gdHlwZW9mIG90aGVyID09PSBcInN0cmluZ1wiID8gcGFyc2VUaW1lKG90aGVyKS50b01pbGxpc2Vjb25kcygpIDogb3RoZXIudG9NaWxsaXNlY29uZHMoKTtcbiAgICAgIHJldHVybiB0aW1lLnRvTWlsbGlzZWNvbmRzKCkgPT09IG90aGVyTXM7XG4gICAgfSxcbiAgICBsZXNzVGhhbjogKG90aGVyKSA9PiB7XG4gICAgICBjb25zdCBvdGhlck1zID0gdHlwZW9mIG90aGVyID09PSBcInN0cmluZ1wiID8gcGFyc2VUaW1lKG90aGVyKS50b01pbGxpc2Vjb25kcygpIDogb3RoZXIudG9NaWxsaXNlY29uZHMoKTtcbiAgICAgIHJldHVybiB0aW1lLnRvTWlsbGlzZWNvbmRzKCkgPCBvdGhlck1zO1xuICAgIH0sXG4gICAgZ3JlYXRlclRoYW46IChvdGhlcikgPT4ge1xuICAgICAgY29uc3Qgb3RoZXJNcyA9IHR5cGVvZiBvdGhlciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlVGltZShvdGhlcikudG9NaWxsaXNlY29uZHMoKSA6IG90aGVyLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICByZXR1cm4gdGltZS50b01pbGxpc2Vjb25kcygpID4gb3RoZXJNcztcbiAgICB9LFxuICAgIGZvcm1hdDogKHBhdHRlcm4pID0+IHtcbiAgICAgIGNvbnN0IGRhdGUgPSB0aW1lLmdldERhdGUoKTtcbiAgICAgIHJldHVybiBwYXR0ZXJuLnJlcGxhY2UoL1lZWVl8TU18RER8SEh8bW18c3MvZywgKG1hdGNoKSA9PiB7XG4gICAgICAgIHN3aXRjaCAobWF0Y2gpIHtcbiAgICAgICAgICBjYXNlIFwiWVlZWVwiOlxuICAgICAgICAgICAgcmV0dXJuIGRhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuICAgICAgICAgIGNhc2UgXCJNTVwiOlxuICAgICAgICAgICAgcmV0dXJuIChkYXRlLmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgICAgICAgICBjYXNlIFwiRERcIjpcbiAgICAgICAgICAgIHJldHVybiBkYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgICAgICAgICBjYXNlIFwiSEhcIjpcbiAgICAgICAgICAgIHJldHVybiBkYXRlLmdldEhvdXJzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgICAgICAgY2FzZSBcIm1tXCI6XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgICAgICAgY2FzZSBcInNzXCI6XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS5nZXRTZWNvbmRzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBtYXRjaDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBmcm9tTm93OiAoKSA9PiB7XG4gICAgICBjb25zdCBtcyA9IHRpbWUudG9NaWxsaXNlY29uZHMoKTtcbiAgICAgIGlmIChtcyA8IDApIHJldHVybiB0aW1lLmFnbygpO1xuICAgICAgaWYgKG1zIDwgMWUzKSByZXR1cm4gXCJpbiBhIGZldyBzZWNvbmRzXCI7XG4gICAgICBpZiAobXMgPCA2ZTQpIHJldHVybiBgaW4gJHtNYXRoLnJvdW5kKG1zIC8gMWUzKX0gc2Vjb25kc2A7XG4gICAgICBpZiAobXMgPCAzNmU1KSByZXR1cm4gYGluICR7TWF0aC5yb3VuZChtcyAvIDZlNCl9IG1pbnV0ZXNgO1xuICAgICAgaWYgKG1zIDwgODY0ZTUpIHJldHVybiBgaW4gJHtNYXRoLnJvdW5kKG1zIC8gMzZlNSl9IGhvdXJzYDtcbiAgICAgIGlmIChtcyA8IDYwNDhlNSkgcmV0dXJuIGBpbiAke01hdGgucm91bmQobXMgLyA4NjRlNSl9IGRheXNgO1xuICAgICAgaWYgKG1zIDwgMjYyOThlNSkgcmV0dXJuIGBpbiAke01hdGgucm91bmQobXMgLyA2MDQ4ZTUpfSB3ZWVrc2A7XG4gICAgICBpZiAobXMgPCAzMTU1NzZlNSkgcmV0dXJuIGBpbiAke01hdGgucm91bmQobXMgLyAyNjI5OGU1KX0gbW9udGhzYDtcbiAgICAgIHJldHVybiBgaW4gJHtNYXRoLnJvdW5kKG1zIC8gMzE1NTc2ZTUpfSB5ZWFyc2A7XG4gICAgfSxcbiAgICBhZ286ICgpID0+IHtcbiAgICAgIGNvbnN0IG1zID0gLXRpbWUudG9NaWxsaXNlY29uZHMoKTtcbiAgICAgIGlmIChtcyA8IDApIHJldHVybiB0aW1lLmZyb21Ob3coKTtcbiAgICAgIGlmIChtcyA8IDFlMykgcmV0dXJuIFwiYSBmZXcgc2Vjb25kcyBhZ29cIjtcbiAgICAgIGlmIChtcyA8IDZlNCkgcmV0dXJuIGAke01hdGgucm91bmQobXMgLyAxZTMpfSBzZWNvbmRzIGFnb2A7XG4gICAgICBpZiAobXMgPCAzNmU1KSByZXR1cm4gYCR7TWF0aC5yb3VuZChtcyAvIDZlNCl9IG1pbnV0ZXMgYWdvYDtcbiAgICAgIGlmIChtcyA8IDg2NGU1KSByZXR1cm4gYCR7TWF0aC5yb3VuZChtcyAvIDM2ZTUpfSBob3VycyBhZ29gO1xuICAgICAgaWYgKG1zIDwgNjA0OGU1KSByZXR1cm4gYCR7TWF0aC5yb3VuZChtcyAvIDg2NGU1KX0gZGF5cyBhZ29gO1xuICAgICAgaWYgKG1zIDwgMjYyOThlNSkgcmV0dXJuIGAke01hdGgucm91bmQobXMgLyA2MDQ4ZTUpfSB3ZWVrcyBhZ29gO1xuICAgICAgaWYgKG1zIDwgMzE1NTc2ZTUpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zIC8gMjYyOThlNSl9IG1vbnRocyBhZ29gO1xuICAgICAgcmV0dXJuIGAke01hdGgucm91bmQobXMgLyAzMTU1NzZlNSl9IHllYXJzIGFnb2A7XG4gICAgfVxuICB9O1xuICByZXR1cm4gdGltZTtcbn07XG52YXIgcGFyc2VUaW1lID0gKHRpbWUpID0+IHtcbiAgY29uc3QgbWF0Y2ggPSB0aW1lLm1hdGNoKC9eKFxcZCspKG1zfHN8bXxofGR8d3x5KSQvKTtcbiAgaWYgKCFtYXRjaCkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0aW1lIGZvcm1hdFwiKTtcbiAgcmV0dXJuIGNyZWF0ZVRpbWUocGFyc2VJbnQobWF0Y2hbMV0pLCBtYXRjaFsyXSk7XG59O1xuXG4vLyBzcmMvY29va2llcy9jb29raWUtdXRpbHMudHNcbmZ1bmN0aW9uIHBhcnNlU2V0Q29va2llSGVhZGVyKHNldENvb2tpZSkge1xuICBjb25zdCBjb29raWVzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgY29uc3QgY29va2llQXJyYXkgPSBzZXRDb29raWUuc3BsaXQoXCIsIFwiKTtcbiAgY29va2llQXJyYXkuZm9yRWFjaCgoY29va2llU3RyaW5nKSA9PiB7XG4gICAgY29uc3QgcGFydHMgPSBjb29raWVTdHJpbmcuc3BsaXQoXCI7XCIpLm1hcCgocGFydCkgPT4gcGFydC50cmltKCkpO1xuICAgIGNvbnN0IFtuYW1lVmFsdWUsIC4uLmF0dHJpYnV0ZXNdID0gcGFydHM7XG4gICAgY29uc3QgW25hbWUsIC4uLnZhbHVlUGFydHNdID0gbmFtZVZhbHVlLnNwbGl0KFwiPVwiKTtcbiAgICBjb25zdCB2YWx1ZSA9IHZhbHVlUGFydHMuam9pbihcIj1cIik7XG4gICAgaWYgKCFuYW1lIHx8IHZhbHVlID09PSB2b2lkIDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgYXR0ck9iaiA9IHsgdmFsdWUgfTtcbiAgICBhdHRyaWJ1dGVzLmZvckVhY2goKGF0dHJpYnV0ZSkgPT4ge1xuICAgICAgY29uc3QgW2F0dHJOYW1lLCAuLi5hdHRyVmFsdWVQYXJ0c10gPSBhdHRyaWJ1dGUuc3BsaXQoXCI9XCIpO1xuICAgICAgY29uc3QgYXR0clZhbHVlID0gYXR0clZhbHVlUGFydHMuam9pbihcIj1cIik7XG4gICAgICBjb25zdCBub3JtYWxpemVkQXR0ck5hbWUgPSBhdHRyTmFtZS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgIHN3aXRjaCAobm9ybWFsaXplZEF0dHJOYW1lKSB7XG4gICAgICAgIGNhc2UgXCJtYXgtYWdlXCI6XG4gICAgICAgICAgYXR0ck9ialtcIm1heC1hZ2VcIl0gPSBhdHRyVmFsdWUgPyBwYXJzZUludChhdHRyVmFsdWUudHJpbSgpLCAxMCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJleHBpcmVzXCI6XG4gICAgICAgICAgYXR0ck9iai5leHBpcmVzID0gYXR0clZhbHVlID8gbmV3IERhdGUoYXR0clZhbHVlLnRyaW0oKSkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJkb21haW5cIjpcbiAgICAgICAgICBhdHRyT2JqLmRvbWFpbiA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJwYXRoXCI6XG4gICAgICAgICAgYXR0ck9iai5wYXRoID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKSA6IHZvaWQgMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInNlY3VyZVwiOlxuICAgICAgICAgIGF0dHJPYmouc2VjdXJlID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImh0dHBvbmx5XCI6XG4gICAgICAgICAgYXR0ck9iai5odHRwb25seSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzYW1lc2l0ZVwiOlxuICAgICAgICAgIGF0dHJPYmouc2FtZXNpdGUgPSBhdHRyVmFsdWUgPyBhdHRyVmFsdWUudHJpbSgpLnRvTG93ZXJDYXNlKCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYXR0ck9ialtub3JtYWxpemVkQXR0ck5hbWVdID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKSA6IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29va2llcy5zZXQobmFtZSwgYXR0ck9iaik7XG4gIH0pO1xuICByZXR1cm4gY29va2llcztcbn1cblxuLy8gc3JjL2Nvb2tpZXMvaW5kZXgudHNcbmZ1bmN0aW9uIGNyZWF0ZUNvb2tpZUdldHRlcihvcHRpb25zKSB7XG4gIGNvbnN0IHNlY3VyZSA9IG9wdGlvbnMuYWR2YW5jZWQ/LnVzZVNlY3VyZUNvb2tpZXMgIT09IHZvaWQgMCA/IG9wdGlvbnMuYWR2YW5jZWQ/LnVzZVNlY3VyZUNvb2tpZXMgOiBvcHRpb25zLmJhc2VVUkwgIT09IHZvaWQgMCA/IG9wdGlvbnMuYmFzZVVSTC5zdGFydHNXaXRoKFwiaHR0cHM6Ly9cIikgPyB0cnVlIDogZmFsc2UgOiBpc1Byb2R1Y3Rpb247XG4gIGNvbnN0IHNlY3VyZUNvb2tpZVByZWZpeCA9IHNlY3VyZSA/IFwiX19TZWN1cmUtXCIgOiBcIlwiO1xuICBjb25zdCBjcm9zc1N1YmRvbWFpbkVuYWJsZWQgPSAhIW9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uZW5hYmxlZDtcbiAgY29uc3QgZG9tYWluID0gY3Jvc3NTdWJkb21haW5FbmFibGVkID8gb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5kb21haW4gfHwgKG9wdGlvbnMuYmFzZVVSTCA/IG5ldyBVUkwob3B0aW9ucy5iYXNlVVJMKS5ob3N0bmFtZSA6IHZvaWQgMCkgOiB2b2lkIDA7XG4gIGlmIChjcm9zc1N1YmRvbWFpbkVuYWJsZWQgJiYgIWRvbWFpbikge1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICBcImJhc2VVUkwgaXMgcmVxdWlyZWQgd2hlbiBjcm9zc1N1YmRvbWFpbkNvb2tpZXMgYXJlIGVuYWJsZWRcIlxuICAgICk7XG4gIH1cbiAgZnVuY3Rpb24gY3JlYXRlQ29va2llKGNvb2tpZU5hbWUsIG92ZXJyaWRlQXR0cmlidXRlcyA9IHt9KSB7XG4gICAgY29uc3QgcHJlZml4ID0gb3B0aW9ucy5hZHZhbmNlZD8uY29va2llUHJlZml4IHx8IFwiYmV0dGVyLWF1dGhcIjtcbiAgICBjb25zdCBuYW1lID0gb3B0aW9ucy5hZHZhbmNlZD8uY29va2llcz8uW2Nvb2tpZU5hbWVdPy5uYW1lIHx8IGAke3ByZWZpeH0uJHtjb29raWVOYW1lfWA7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IG9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZXM/Lltjb29raWVOYW1lXT8uYXR0cmlidXRlcztcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogYCR7c2VjdXJlQ29va2llUHJlZml4fSR7bmFtZX1gLFxuICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICBzZWN1cmU6ICEhc2VjdXJlQ29va2llUHJlZml4LFxuICAgICAgICBzYW1lU2l0ZTogXCJsYXhcIixcbiAgICAgICAgcGF0aDogXCIvXCIsXG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICAuLi5jcm9zc1N1YmRvbWFpbkVuYWJsZWQgPyB7IGRvbWFpbiB9IDoge30sXG4gICAgICAgIC4uLm9wdGlvbnMuYWR2YW5jZWQ/LmRlZmF1bHRDb29raWVBdHRyaWJ1dGVzLFxuICAgICAgICAuLi5vdmVycmlkZUF0dHJpYnV0ZXMsXG4gICAgICAgIC4uLmF0dHJpYnV0ZXNcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHJldHVybiBjcmVhdGVDb29raWU7XG59XG5mdW5jdGlvbiBnZXRDb29raWVzKG9wdGlvbnMpIHtcbiAgY29uc3QgY3JlYXRlQ29va2llID0gY3JlYXRlQ29va2llR2V0dGVyKG9wdGlvbnMpO1xuICBjb25zdCBzZXNzaW9uTWF4QWdlID0gb3B0aW9ucy5zZXNzaW9uPy5leHBpcmVzSW4gfHwgY3JlYXRlVGltZSg3LCBcImRcIikudG9TZWNvbmRzKCk7XG4gIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGNyZWF0ZUNvb2tpZShcInNlc3Npb25fdG9rZW5cIiwge1xuICAgIG1heEFnZTogc2Vzc2lvbk1heEFnZVxuICB9KTtcbiAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBjcmVhdGVDb29raWUoXCJzZXNzaW9uX2RhdGFcIiwge1xuICAgIG1heEFnZTogb3B0aW9ucy5zZXNzaW9uPy5jb29raWVDYWNoZT8ubWF4QWdlIHx8IDYwICogNVxuICB9KTtcbiAgY29uc3QgZG9udFJlbWVtYmVyVG9rZW4gPSBjcmVhdGVDb29raWUoXCJkb250X3JlbWVtYmVyXCIpO1xuICByZXR1cm4ge1xuICAgIHNlc3Npb25Ub2tlbjoge1xuICAgICAgbmFtZTogc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgICBvcHRpb25zOiBzZXNzaW9uVG9rZW4uYXR0cmlidXRlc1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogVGhpcyBjb29raWUgaXMgdXNlZCB0byBzdG9yZSB0aGUgc2Vzc2lvbiBkYXRhIGluIHRoZSBjb29raWVcbiAgICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3Igd2hlbiB5b3Ugd2FudCB0byBjYWNoZSB0aGUgc2Vzc2lvbiBpbiB0aGUgY29va2llXG4gICAgICovXG4gICAgc2Vzc2lvbkRhdGE6IHtcbiAgICAgIG5hbWU6IHNlc3Npb25EYXRhLm5hbWUsXG4gICAgICBvcHRpb25zOiBzZXNzaW9uRGF0YS5hdHRyaWJ1dGVzXG4gICAgfSxcbiAgICBkb250UmVtZW1iZXJUb2tlbjoge1xuICAgICAgbmFtZTogZG9udFJlbWVtYmVyVG9rZW4ubmFtZSxcbiAgICAgIG9wdGlvbnM6IGRvbnRSZW1lbWJlclRva2VuLmF0dHJpYnV0ZXNcbiAgICB9XG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiBzZXRDb29raWVDYWNoZShjdHgsIHNlc3Npb24pIHtcbiAgY29uc3Qgc2hvdWxkU3RvcmVTZXNzaW9uRGF0YUluQ29va2llID0gY3R4LmNvbnRleHQub3B0aW9ucy5zZXNzaW9uPy5jb29raWVDYWNoZT8uZW5hYmxlZDtcbiAgaWYgKHNob3VsZFN0b3JlU2Vzc2lvbkRhdGFJbkNvb2tpZSkge1xuICAgIGNvbnN0IGRhdGEgPSBiYXNlNjRVcmwuZW5jb2RlKFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBzZXNzaW9uLFxuICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUoXG4gICAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEub3B0aW9ucy5tYXhBZ2UgfHwgNjAsXG4gICAgICAgICAgXCJzZWNcIlxuICAgICAgICApLmdldFRpbWUoKSxcbiAgICAgICAgc2lnbmF0dXJlOiBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnNpZ24oXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHNlc3Npb24pXG4gICAgICAgIClcbiAgICAgIH0pLFxuICAgICAge1xuICAgICAgICBwYWRkaW5nOiBmYWxzZVxuICAgICAgfVxuICAgICk7XG4gICAgaWYgKGRhdGEubGVuZ3RoID4gNDA5Mykge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJTZXNzaW9uIGRhdGEgaXMgdG9vIGxhcmdlIHRvIHN0b3JlIGluIHRoZSBjb29raWUuIFBsZWFzZSBkaXNhYmxlIHNlc3Npb24gY29va2llIGNhY2hpbmcgb3IgcmVkdWNlIHRoZSBzaXplIG9mIHRoZSBzZXNzaW9uIGRhdGFcIlxuICAgICAgKTtcbiAgICB9XG4gICAgY3R4LnNldENvb2tpZShcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm5hbWUsXG4gICAgICBkYXRhLFxuICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEub3B0aW9uc1xuICAgICk7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIHNldFNlc3Npb25Db29raWUoY3R4LCBzZXNzaW9uLCBkb250UmVtZW1iZXJNZSwgb3ZlcnJpZGVzKSB7XG4gIGNvbnN0IG9wdGlvbnMgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ub3B0aW9ucztcbiAgY29uc3QgbWF4QWdlID0gZG9udFJlbWVtYmVyTWUgPyB2b2lkIDAgOiBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmV4cGlyZXNJbjtcbiAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZSxcbiAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgIHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBtYXhBZ2UsXG4gICAgICAuLi5vdmVycmlkZXNcbiAgICB9XG4gICk7XG4gIGlmIChkb250UmVtZW1iZXJNZSkge1xuICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLFxuICAgICAgXCJ0cnVlXCIsXG4gICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5vcHRpb25zXG4gICAgKTtcbiAgfVxuICBhd2FpdCBzZXRDb29raWVDYWNoZShjdHgsIHNlc3Npb24pO1xuICBjdHguY29udGV4dC5zZXROZXdTZXNzaW9uKHNlc3Npb24pO1xuICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuc2Vjb25kYXJ5U3RvcmFnZT8uc2V0KFxuICAgICAgc2Vzc2lvbi5zZXNzaW9uLnRva2VuLFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXIsXG4gICAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvblxuICAgICAgfSksXG4gICAgICBNYXRoLmZsb29yKFxuICAgICAgICAobmV3IERhdGUoc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdCkuZ2V0VGltZSgpIC0gRGF0ZS5ub3coKSkgLyAxZTNcbiAgICAgIClcbiAgICApO1xuICB9XG59XG5mdW5jdGlvbiBkZWxldGVTZXNzaW9uQ29va2llKGN0eCkge1xuICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLCBcIlwiLCB7XG4gICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm9wdGlvbnMsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm5hbWUsIFwiXCIsIHtcbiAgICAuLi5jdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5vcHRpb25zLFxuICAgIG1heEFnZTogMFxuICB9KTtcbiAgY3R4LnNldENvb2tpZShjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLCBcIlwiLCB7XG4gICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ub3B0aW9ucyxcbiAgICBtYXhBZ2U6IDBcbiAgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUNvb2tpZXMoY29va2llSGVhZGVyKSB7XG4gIGNvbnN0IGNvb2tpZXMgPSBjb29raWVIZWFkZXIuc3BsaXQoXCI7IFwiKTtcbiAgY29uc3QgY29va2llTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgY29va2llcy5mb3JFYWNoKChjb29raWUpID0+IHtcbiAgICBjb25zdCBbbmFtZSwgdmFsdWVdID0gY29va2llLnNwbGl0KFwiPVwiKTtcbiAgICBjb29raWVNYXAuc2V0KG5hbWUsIHZhbHVlKTtcbiAgfSk7XG4gIHJldHVybiBjb29raWVNYXA7XG59XG52YXIgZ2V0U2Vzc2lvbkNvb2tpZSA9IChyZXF1ZXN0LCBjb25maWcpID0+IHtcbiAgY29uc3QgaGVhZGVycyA9IHJlcXVlc3QgaW5zdGFuY2VvZiBIZWFkZXJzID8gcmVxdWVzdCA6IHJlcXVlc3QuaGVhZGVycztcbiAgY29uc3QgY29va2llcyA9IGhlYWRlcnMuZ2V0KFwiY29va2llXCIpO1xuICBpZiAoIWNvb2tpZXMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB7IGNvb2tpZU5hbWUgPSBcInNlc3Npb25fdG9rZW5cIiwgY29va2llUHJlZml4ID0gXCJiZXR0ZXItYXV0aFwiIH0gPSBjb25maWcgfHwge307XG4gIGNvbnN0IG5hbWUgPSBpc1Byb2R1Y3Rpb24gPyBgX19TZWN1cmUtJHtjb29raWVQcmVmaXh9LiR7Y29va2llTmFtZX1gIDogYCR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YDtcbiAgY29uc3QgcGFyc2VkQ29va2llID0gcGFyc2VDb29raWVzKGNvb2tpZXMpO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBwYXJzZWRDb29raWUuZ2V0KG5hbWUpO1xuICBpZiAoc2Vzc2lvblRva2VuKSB7XG4gICAgcmV0dXJuIHNlc3Npb25Ub2tlbjtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG52YXIgZ2V0Q29va2llQ2FjaGUgPSAocmVxdWVzdCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGhlYWRlcnMgPSByZXF1ZXN0IGluc3RhbmNlb2YgSGVhZGVycyA/IHJlcXVlc3QgOiByZXF1ZXN0LmhlYWRlcnM7XG4gIGNvbnN0IGNvb2tpZXMgPSBoZWFkZXJzLmdldChcImNvb2tpZVwiKTtcbiAgaWYgKCFjb29raWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBjb29raWVOYW1lID0gXCJzZXNzaW9uX2RhdGFcIiwgY29va2llUHJlZml4ID0gXCJiZXR0ZXItYXV0aFwiIH0gPSBjb25maWcgfHwge307XG4gIGNvbnN0IG5hbWUgPSBpc1Byb2R1Y3Rpb24gPyBgX19TZWN1cmUtJHtjb29raWVQcmVmaXh9LiR7Y29va2llTmFtZX1gIDogYCR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YDtcbiAgY29uc3QgcGFyc2VkQ29va2llID0gcGFyc2VDb29raWVzKGNvb2tpZXMpO1xuICBjb25zdCBzZXNzaW9uRGF0YSA9IHBhcnNlZENvb2tpZS5nZXQobmFtZSk7XG4gIGlmIChzZXNzaW9uRGF0YSkge1xuICAgIHJldHVybiBzYWZlSlNPTlBhcnNlKHNlc3Npb25EYXRhKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUNvb2tpZUdldHRlciwgZGVsZXRlU2Vzc2lvbkNvb2tpZSwgZ2V0Q29va2llQ2FjaGUsIGdldENvb2tpZXMsIGdldFNlc3Npb25Db29raWUsIHBhcnNlQ29va2llcywgcGFyc2VTZXRDb29raWVIZWFkZXIsIHNldENvb2tpZUNhY2hlLCBzZXRTZXNzaW9uQ29va2llIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   phoneNumber: () => (/* binding */ phoneNumber)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\n\n\nfunction generateOTP(size) {\n  return (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_3__.generateRandomString)(size, \"0-9\");\n}\nvar phoneNumber = (options) => {\n  const opts = {\n    expiresIn: options?.expiresIn || 300,\n    otpLength: options?.otpLength || 6,\n    ...options,\n    phoneNumber: \"phoneNumber\",\n    phoneNumberVerified: \"phoneNumberVerified\",\n    code: \"code\",\n    createdAt: \"createdAt\"\n  };\n  const ERROR_CODES = {\n    INVALID_PHONE_NUMBER: \"Invalid phone number\",\n    INVALID_PHONE_NUMBER_OR_PASSWORD: \"Invalid phone number or password\",\n    UNEXPECTED_ERROR: \"Unexpected error\",\n    OTP_NOT_FOUND: \"OTP not found\"\n  };\n  return {\n    id: \"phone-number\",\n    endpoints: {\n      signInPhoneNumber: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/phone-number\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n            phoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Phone number to sign in\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Password to use for sign in\"\n            }),\n            rememberMe: zod__WEBPACK_IMPORTED_MODULE_5__.z.boolean({\n              description: \"Remember the session\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Sign in with phone number\",\n              description: \"Use this endpoint to sign in with phone number\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                },\n                400: {\n                  description: \"Invalid phone number or password\"\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { password, phoneNumber: phoneNumber2 } = ctx.body;\n          if (opts.phoneNumberValidator) {\n            const isValidNumber = await opts.phoneNumberValidator(\n              ctx.body.phoneNumber\n            );\n            if (!isValidNumber) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.INVALID_PHONE_NUMBER\n              });\n            }\n          }\n          const user = await ctx.context.adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                field: \"phoneNumber\",\n                value: phoneNumber2\n              }\n            ]\n          });\n          if (!user) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_PHONE_NUMBER_OR_PASSWORD\n            });\n          }\n          const accounts = await ctx.context.internalAdapter.findAccountByUserId(user.id);\n          const credentialAccount = accounts.find(\n            (a) => a.providerId === \"credential\"\n          );\n          if (!credentialAccount) {\n            ctx.context.logger.error(\"Credential account not found\", {\n              phoneNumber: phoneNumber2\n            });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_PHONE_NUMBER_OR_PASSWORD\n            });\n          }\n          const currentPassword = credentialAccount?.password;\n          if (!currentPassword) {\n            ctx.context.logger.error(\"Password not found\", { phoneNumber: phoneNumber2 });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.UNEXPECTED_ERROR\n            });\n          }\n          const validPassword = await ctx.context.password.verify({\n            hash: currentPassword,\n            password\n          });\n          if (!validPassword) {\n            ctx.context.logger.error(\"Invalid password\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_PHONE_NUMBER_OR_PASSWORD\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.headers,\n            ctx.body.rememberMe === false\n          );\n          if (!session) {\n            ctx.context.logger.error(\"Failed to create session\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(\n            ctx,\n            {\n              session,\n              user\n            },\n            ctx.body.rememberMe === false\n          );\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              phoneNumber: user.phoneNumber,\n              phoneNumberVerified: user.phoneNumberVerified,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        }\n      ),\n      sendPhoneNumberOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/phone-number/send-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n            phoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Phone number to send OTP\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Send OTP to phone number\",\n              description: \"Use this endpoint to send OTP to phone number\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          message: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!options?.sendOTP) {\n            ctx.context.logger.warn(\"sendOTP not implemented\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"NOT_IMPLEMENTED\", {\n              message: \"sendOTP not implemented\"\n            });\n          }\n          if (opts.phoneNumberValidator) {\n            const isValidNumber = await opts.phoneNumberValidator(\n              ctx.body.phoneNumber\n            );\n            if (!isValidNumber) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.INVALID_PHONE_NUMBER\n              });\n            }\n          }\n          const code = generateOTP(opts.otpLength);\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: code,\n            identifier: ctx.body.phoneNumber,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_4__.getDate)(opts.expiresIn, \"sec\")\n          });\n          await options.sendOTP(\n            {\n              phoneNumber: ctx.body.phoneNumber,\n              code\n            },\n            ctx.request\n          );\n          return ctx.json(\n            { code },\n            {\n              body: {\n                message: \"Code sent\"\n              }\n            }\n          );\n        }\n      ),\n      verifyPhoneNumber: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/phone-number/verify\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n            /**\n             * Phone number\n             */\n            phoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Phone number to verify\"\n            }),\n            /**\n             * OTP code\n             */\n            code: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"OTP code\"\n            }),\n            /**\n             * Disable session creation after verification\n             * @default false\n             */\n            disableSession: zod__WEBPACK_IMPORTED_MODULE_5__.z.boolean({\n              description: \"Disable session creation after verification\"\n            }).optional(),\n            /**\n             * This checks if there is a session already\n             * and updates the phone number with the provided\n             * phone number\n             */\n            updatePhoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.boolean({\n              description: \"Check if there is a session and update the phone number\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Verify phone number\",\n              description: \"Use this endpoint to verify phone number\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                },\n                400: {\n                  description: \"Invalid OTP\"\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const otp = await ctx.context.internalAdapter.findVerificationValue(\n            ctx.body.phoneNumber\n          );\n          if (!otp || otp.expiresAt < /* @__PURE__ */ new Date()) {\n            if (otp && otp.expiresAt < /* @__PURE__ */ new Date()) {\n              await ctx.context.internalAdapter.deleteVerificationValue(otp.id);\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n                message: \"OTP expired\"\n              });\n            }\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_NOT_FOUND\n            });\n          }\n          if (otp.value !== ctx.body.code) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n              message: \"Invalid OTP\"\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(otp.id);\n          if (ctx.body.updatePhoneNumber) {\n            const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n            if (!session) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.USER_NOT_FOUND\n              });\n            }\n            let user2 = await ctx.context.internalAdapter.updateUser(\n              session.user.id,\n              {\n                [opts.phoneNumber]: ctx.body.phoneNumber,\n                [opts.phoneNumberVerified]: true\n              }\n            );\n            return ctx.json({\n              status: true,\n              token: session.session.token,\n              user: {\n                id: user2.id,\n                email: user2.email,\n                emailVerified: user2.emailVerified,\n                name: user2.name,\n                image: user2.image,\n                phoneNumber: user2.phoneNumber,\n                phoneNumberVerified: user2.phoneNumberVerified,\n                createdAt: user2.createdAt,\n                updatedAt: user2.updatedAt\n              }\n            });\n          }\n          let user = await ctx.context.adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                value: ctx.body.phoneNumber,\n                field: opts.phoneNumber\n              }\n            ]\n          });\n          if (!user) {\n            if (options?.signUpOnVerification) {\n              user = await ctx.context.internalAdapter.createUser({\n                email: options.signUpOnVerification.getTempEmail(\n                  ctx.body.phoneNumber\n                ),\n                name: options.signUpOnVerification.getTempName ? options.signUpOnVerification.getTempName(\n                  ctx.body.phoneNumber\n                ) : ctx.body.phoneNumber,\n                [opts.phoneNumber]: ctx.body.phoneNumber,\n                [opts.phoneNumberVerified]: true\n              });\n              if (!user) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"INTERNAL_SERVER_ERROR\", {\n                  message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n                });\n              }\n            }\n          } else {\n            user = await ctx.context.internalAdapter.updateUser(user.id, {\n              [opts.phoneNumberVerified]: true\n            });\n          }\n          if (!user) {\n            return ctx.json(null);\n          }\n          await options?.callbackOnVerification?.(\n            {\n              phoneNumber: ctx.body.phoneNumber,\n              user\n            },\n            ctx.request\n          );\n          if (!user) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_UPDATE_USER\n            });\n          }\n          if (!ctx.body.disableSession) {\n            const session = await ctx.context.internalAdapter.createSession(\n              user.id,\n              ctx.request\n            );\n            if (!session) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"INTERNAL_SERVER_ERROR\", {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n              });\n            }\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n              session,\n              user\n            });\n            return ctx.json({\n              status: true,\n              token: session.token,\n              user: {\n                id: user.id,\n                email: user.email,\n                emailVerified: user.emailVerified,\n                name: user.name,\n                image: user.image,\n                phoneNumber: user.phoneNumber,\n                phoneNumberVerified: user.phoneNumberVerified,\n                createdAt: user.createdAt,\n                updatedAt: user.updatedAt\n              }\n            });\n          }\n          return ctx.json({\n            status: true,\n            token: null,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              phoneNumber: user.phoneNumber,\n              phoneNumberVerified: user.phoneNumberVerified,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        }\n      )\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__.mergeSchema)(schema, options?.schema),\n    $ERROR_CODES: ERROR_CODES\n  };\n};\nvar schema = {\n  user: {\n    fields: {\n      phoneNumber: {\n        type: \"string\",\n        required: false,\n        unique: true,\n        sortable: true,\n        returned: true\n      },\n      phoneNumberVerified: {\n        type: \"boolean\",\n        required: false,\n        returned: true,\n        input: false\n      }\n    }\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstUkJPQUQ1NVkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBOEY7QUFDdkM7QUFDTDtBQUNTO0FBQ2I7QUFDdEI7QUFDZTs7QUFFdkM7QUFDQSxTQUFTLHdFQUFvQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHNFQUFrQjtBQUMzQztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IseUNBQVE7QUFDeEIseUJBQXlCLHlDQUFRO0FBQ2pDO0FBQ0EsYUFBYTtBQUNiLHNCQUFzQix5Q0FBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYix3QkFBd0IsMENBQVM7QUFDakM7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0Esa0JBQWtCLHNDQUFzQztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlEQUFRO0FBQ2hDO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2Isc0JBQXNCLGlEQUFR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QTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSwwQkFBMEIsaURBQVE7QUFDbEMsMkJBQTJCLGdFQUFnQjtBQUMzQyxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCLHVCQUF1QixnRUFBZ0I7QUFDdkMsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlEQUFRO0FBQ2hDLHlCQUF5QixnRUFBZ0I7QUFDekMsZUFBZTtBQUNmO0FBQ0Esa0JBQWtCLG9FQUFnQjtBQUNsQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSwrREFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV1QiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVJCT0FENTVZLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgQkFTRV9FUlJPUl9DT0RFUywgZ2V0U2Vzc2lvbkZyb21DdHggfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IG1lcmdlU2NoZW1hIH0gZnJvbSAnLi9jaHVuay1XWjZPSVZKSy5qcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZVJhbmRvbVN0cmluZyB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0IHsgZ2V0RGF0ZSB9IGZyb20gJy4vY2h1bmstRlVSTkE2SFkuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcblxuZnVuY3Rpb24gZ2VuZXJhdGVPVFAoc2l6ZSkge1xuICByZXR1cm4gZ2VuZXJhdGVSYW5kb21TdHJpbmcoc2l6ZSwgXCIwLTlcIik7XG59XG52YXIgcGhvbmVOdW1iZXIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBvcHRzID0ge1xuICAgIGV4cGlyZXNJbjogb3B0aW9ucz8uZXhwaXJlc0luIHx8IDMwMCxcbiAgICBvdHBMZW5ndGg6IG9wdGlvbnM/Lm90cExlbmd0aCB8fCA2LFxuICAgIC4uLm9wdGlvbnMsXG4gICAgcGhvbmVOdW1iZXI6IFwicGhvbmVOdW1iZXJcIixcbiAgICBwaG9uZU51bWJlclZlcmlmaWVkOiBcInBob25lTnVtYmVyVmVyaWZpZWRcIixcbiAgICBjb2RlOiBcImNvZGVcIixcbiAgICBjcmVhdGVkQXQ6IFwiY3JlYXRlZEF0XCJcbiAgfTtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgSU5WQUxJRF9QSE9ORV9OVU1CRVI6IFwiSW52YWxpZCBwaG9uZSBudW1iZXJcIixcbiAgICBJTlZBTElEX1BIT05FX05VTUJFUl9PUl9QQVNTV09SRDogXCJJbnZhbGlkIHBob25lIG51bWJlciBvciBwYXNzd29yZFwiLFxuICAgIFVORVhQRUNURURfRVJST1I6IFwiVW5leHBlY3RlZCBlcnJvclwiLFxuICAgIE9UUF9OT1RfRk9VTkQ6IFwiT1RQIG5vdCBmb3VuZFwiXG4gIH07XG4gIHJldHVybiB7XG4gICAgaWQ6IFwicGhvbmUtbnVtYmVyXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzaWduSW5QaG9uZU51bWJlcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9zaWduLWluL3Bob25lLW51bWJlclwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBwaG9uZU51bWJlcjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJQaG9uZSBudW1iZXIgdG8gc2lnbiBpblwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlBhc3N3b3JkIHRvIHVzZSBmb3Igc2lnbiBpblwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlbWVtYmVyTWU6IHouYm9vbGVhbih7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlbWVtYmVyIHRoZSBzZXNzaW9uXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlNpZ24gaW4gd2l0aCBwaG9uZSBudW1iZXJcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHRoaXMgZW5kcG9pbnQgdG8gc2lnbiBpbiB3aXRoIHBob25lIG51bWJlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgNDAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbnZhbGlkIHBob25lIG51bWJlciBvciBwYXNzd29yZFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgeyBwYXNzd29yZCwgcGhvbmVOdW1iZXI6IHBob25lTnVtYmVyMiB9ID0gY3R4LmJvZHk7XG4gICAgICAgICAgaWYgKG9wdHMucGhvbmVOdW1iZXJWYWxpZGF0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWROdW1iZXIgPSBhd2FpdCBvcHRzLnBob25lTnVtYmVyVmFsaWRhdG9yKFxuICAgICAgICAgICAgICBjdHguYm9keS5waG9uZU51bWJlclxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghaXNWYWxpZE51bWJlcikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9QSE9ORV9OVU1CRVJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInBob25lTnVtYmVyXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHBob25lTnVtYmVyMlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1BIT05FX05VTUJFUl9PUl9QQVNTV09SRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50QnlVc2VySWQodXNlci5pZCk7XG4gICAgICAgICAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSBhY2NvdW50cy5maW5kKFxuICAgICAgICAgICAgKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCJcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghY3JlZGVudGlhbEFjY291bnQpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkNyZWRlbnRpYWwgYWNjb3VudCBub3QgZm91bmRcIiwge1xuICAgICAgICAgICAgICBwaG9uZU51bWJlcjogcGhvbmVOdW1iZXIyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfUEhPTkVfTlVNQkVSX09SX1BBU1NXT1JEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgY3VycmVudFBhc3N3b3JkID0gY3JlZGVudGlhbEFjY291bnQ/LnBhc3N3b3JkO1xuICAgICAgICAgIGlmICghY3VycmVudFBhc3N3b3JkKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBub3QgZm91bmRcIiwgeyBwaG9uZU51bWJlcjogcGhvbmVOdW1iZXIyIH0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVU5FWFBFQ1RFRF9FUlJPUlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZhbGlkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgICAgICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgICAgICAgICAgcGFzc3dvcmRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIXZhbGlkUGFzc3dvcmQpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkludmFsaWQgcGFzc3dvcmRcIik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1BIT05FX05VTUJFUl9PUl9QQVNTV09SRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgICBjdHguaGVhZGVycyxcbiAgICAgICAgICAgIGN0eC5ib2R5LnJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvblwiKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgICAgICAgIGN0eCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgICAgdXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGN0eC5ib2R5LnJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlLFxuICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdXNlci5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgcGhvbmVOdW1iZXJWZXJpZmllZDogdXNlci5waG9uZU51bWJlclZlcmlmaWVkLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBzZW5kUGhvbmVOdW1iZXJPVFA6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvcGhvbmUtbnVtYmVyL3NlbmQtb3RwXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHBob25lTnVtYmVyOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlBob25lIG51bWJlciB0byBzZW5kIE9UUFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiU2VuZCBPVFAgdG8gcGhvbmUgbnVtYmVyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZSB0aGlzIGVuZHBvaW50IHRvIHNlbmQgT1RQIHRvIHBob25lIG51bWJlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBpZiAoIW9wdGlvbnM/LnNlbmRPVFApIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci53YXJuKFwic2VuZE9UUCBub3QgaW1wbGVtZW50ZWRcIik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfSU1QTEVNRU5URURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcInNlbmRPVFAgbm90IGltcGxlbWVudGVkXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3B0cy5waG9uZU51bWJlclZhbGlkYXRvcikge1xuICAgICAgICAgICAgY29uc3QgaXNWYWxpZE51bWJlciA9IGF3YWl0IG9wdHMucGhvbmVOdW1iZXJWYWxpZGF0b3IoXG4gICAgICAgICAgICAgIGN0eC5ib2R5LnBob25lTnVtYmVyXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTnVtYmVyKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1BIT05FX05VTUJFUlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgY29kZSA9IGdlbmVyYXRlT1RQKG9wdHMub3RwTGVuZ3RoKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgICAgICAgICAgdmFsdWU6IGNvZGUsXG4gICAgICAgICAgICBpZGVudGlmaWVyOiBjdHguYm9keS5waG9uZU51bWJlcixcbiAgICAgICAgICAgIGV4cGlyZXNBdDogZ2V0RGF0ZShvcHRzLmV4cGlyZXNJbiwgXCJzZWNcIilcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhd2FpdCBvcHRpb25zLnNlbmRPVFAoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHBob25lTnVtYmVyOiBjdHguYm9keS5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgY29kZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgICAgICB7IGNvZGUgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQ29kZSBzZW50XCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB2ZXJpZnlQaG9uZU51bWJlcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9waG9uZS1udW1iZXIvdmVyaWZ5XCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHBob25lTnVtYmVyOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlBob25lIG51bWJlciB0byB2ZXJpZnlcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9UUCBjb2RlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvZGU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiT1RQIGNvZGVcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERpc2FibGUgc2Vzc2lvbiBjcmVhdGlvbiBhZnRlciB2ZXJpZmljYXRpb25cbiAgICAgICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRpc2FibGVTZXNzaW9uOiB6LmJvb2xlYW4oe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIHNlc3Npb24gY3JlYXRpb24gYWZ0ZXIgdmVyaWZpY2F0aW9uXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRoaXMgY2hlY2tzIGlmIHRoZXJlIGlzIGEgc2Vzc2lvbiBhbHJlYWR5XG4gICAgICAgICAgICAgKiBhbmQgdXBkYXRlcyB0aGUgcGhvbmUgbnVtYmVyIHdpdGggdGhlIHByb3ZpZGVkXG4gICAgICAgICAgICAgKiBwaG9uZSBudW1iZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdXBkYXRlUGhvbmVOdW1iZXI6IHouYm9vbGVhbih7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoZWNrIGlmIHRoZXJlIGlzIGEgc2Vzc2lvbiBhbmQgdXBkYXRlIHRoZSBwaG9uZSBudW1iZXJcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiVmVyaWZ5IHBob25lIG51bWJlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2UgdGhpcyBlbmRwb2ludCB0byB2ZXJpZnkgcGhvbmUgbnVtYmVyXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICA0MDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkludmFsaWQgT1RQXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBvdHAgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgY3R4LmJvZHkucGhvbmVOdW1iZXJcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghb3RwIHx8IG90cC5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgaWYgKG90cCAmJiBvdHAuZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKG90cC5pZCk7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIk9UUCBleHBpcmVkXCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLk9UUF9OT1RfRk9VTkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3RwLnZhbHVlICE9PSBjdHguYm9keS5jb2RlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBPVFBcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShvdHAuaWQpO1xuICAgICAgICAgIGlmIChjdHguYm9keS51cGRhdGVQaG9uZU51bWJlcikge1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfTk9UX0ZPVU5EXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHVzZXIyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoXG4gICAgICAgICAgICAgIHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFtvcHRzLnBob25lTnVtYmVyXTogY3R4LmJvZHkucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgW29wdHMucGhvbmVOdW1iZXJWZXJpZmllZF06IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgICAgdG9rZW46IHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1c2VyMi5pZCxcbiAgICAgICAgICAgICAgICBlbWFpbDogdXNlcjIuZW1haWwsXG4gICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlcjIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VyMi5uYW1lLFxuICAgICAgICAgICAgICAgIGltYWdlOiB1c2VyMi5pbWFnZSxcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdXNlcjIucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXJWZXJpZmllZDogdXNlcjIucGhvbmVOdW1iZXJWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHVzZXIyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHVzZXIyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBjdHguYm9keS5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICBmaWVsZDogb3B0cy5waG9uZU51bWJlclxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucz8uc2lnblVwT25WZXJpZmljYXRpb24pIHtcbiAgICAgICAgICAgICAgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVVc2VyKHtcbiAgICAgICAgICAgICAgICBlbWFpbDogb3B0aW9ucy5zaWduVXBPblZlcmlmaWNhdGlvbi5nZXRUZW1wRW1haWwoXG4gICAgICAgICAgICAgICAgICBjdHguYm9keS5waG9uZU51bWJlclxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgbmFtZTogb3B0aW9ucy5zaWduVXBPblZlcmlmaWNhdGlvbi5nZXRUZW1wTmFtZSA/IG9wdGlvbnMuc2lnblVwT25WZXJpZmljYXRpb24uZ2V0VGVtcE5hbWUoXG4gICAgICAgICAgICAgICAgICBjdHguYm9keS5waG9uZU51bWJlclxuICAgICAgICAgICAgICAgICkgOiBjdHguYm9keS5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICBbb3B0cy5waG9uZU51bWJlcl06IGN0eC5ib2R5LnBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIFtvcHRzLnBob25lTnVtYmVyVmVyaWZpZWRdOiB0cnVlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIodXNlci5pZCwge1xuICAgICAgICAgICAgICBbb3B0cy5waG9uZU51bWJlclZlcmlmaWVkXTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBvcHRpb25zPy5jYWxsYmFja09uVmVyaWZpY2F0aW9uPy4oXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHBob25lTnVtYmVyOiBjdHguYm9keS5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgdXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX1VQREFURV9VU0VSXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjdHguYm9keS5kaXNhYmxlU2Vzc2lvbikge1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgICB1c2VyLmlkLFxuICAgICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgICAgdXNlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdXNlci5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlclZlcmlmaWVkOiB1c2VyLnBob25lTnVtYmVyVmVyaWZpZWQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgICAgdG9rZW46IG51bGwsXG4gICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlLFxuICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdXNlci5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgcGhvbmVOdW1iZXJWZXJpZmllZDogdXNlci5waG9uZU51bWJlclZlcmlmaWVkLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIHNjaGVtYTogbWVyZ2VTY2hlbWEoc2NoZW1hLCBvcHRpb25zPy5zY2hlbWEpLFxuICAgICRFUlJPUl9DT0RFUzogRVJST1JfQ09ERVNcbiAgfTtcbn07XG52YXIgc2NoZW1hID0ge1xuICB1c2VyOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICBwaG9uZU51bWJlcjoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgIHJldHVybmVkOiB0cnVlXG4gICAgICB9LFxuICAgICAgcGhvbmVOdW1iZXJWZXJpZmllZDoge1xuICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICByZXR1cm5lZDogdHJ1ZSxcbiAgICAgICAgaW5wdXQ6IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgeyBwaG9uZU51bWJlciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkPassword: () => (/* binding */ checkPassword),\n/* harmony export */   validatePassword: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n// src/utils/password.ts\nasync function validatePassword(ctx, data) {\n  const accounts = await ctx.context.internalAdapter.findAccounts(data.userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword) {\n    return false;\n  }\n  const compare = await ctx.context.password.verify({\n    hash: currentPassword,\n    password: data.password\n  });\n  return compare;\n}\nasync function checkPassword(userId, c) {\n  const accounts = await c.context.internalAdapter.findAccounts(userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword || !c.body.password) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"No password credential found\"\n    });\n  }\n  const compare = await c.context.password.verify({\n    hash: currentPassword,\n    password: c.body.password\n  });\n  if (!compare) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid password\"\n    });\n  }\n  return true;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVE9LWkwzWkkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXVDOztBQUV2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGlEQUFRO0FBQ3RCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsY0FBYyxpREFBUTtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRTJDIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVE9LWkwzWkkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbi8vIHNyYy91dGlscy9wYXNzd29yZC50c1xuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVQYXNzd29yZChjdHgsIGRhdGEpIHtcbiAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKGRhdGEudXNlcklkKTtcbiAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSBhY2NvdW50cz8uZmluZChcbiAgICAoYWNjb3VudCkgPT4gYWNjb3VudC5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIlxuICApO1xuICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBjcmVkZW50aWFsQWNjb3VudD8ucGFzc3dvcmQ7XG4gIGlmICghY3JlZGVudGlhbEFjY291bnQgfHwgIWN1cnJlbnRQYXNzd29yZCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBjb21wYXJlID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgcGFzc3dvcmQ6IGRhdGEucGFzc3dvcmRcbiAgfSk7XG4gIHJldHVybiBjb21wYXJlO1xufVxuYXN5bmMgZnVuY3Rpb24gY2hlY2tQYXNzd29yZCh1c2VySWQsIGMpIHtcbiAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyh1c2VySWQpO1xuICBjb25zdCBjcmVkZW50aWFsQWNjb3VudCA9IGFjY291bnRzPy5maW5kKFxuICAgIChhY2NvdW50KSA9PiBhY2NvdW50LnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICk7XG4gIGNvbnN0IGN1cnJlbnRQYXNzd29yZCA9IGNyZWRlbnRpYWxBY2NvdW50Py5wYXNzd29yZDtcbiAgaWYgKCFjcmVkZW50aWFsQWNjb3VudCB8fCAhY3VycmVudFBhc3N3b3JkIHx8ICFjLmJvZHkucGFzc3dvcmQpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIk5vIHBhc3N3b3JkIGNyZWRlbnRpYWwgZm91bmRcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IGNvbXBhcmUgPSBhd2FpdCBjLmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgcGFzc3dvcmQ6IGMuYm9keS5wYXNzd29yZFxuICB9KTtcbiAgaWYgKCFjb21wYXJlKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIHBhc3N3b3JkXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IHsgY2hlY2tQYXNzd29yZCwgdmFsaWRhdGVQYXNzd29yZCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   env: () => (/* binding */ env),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   isTest: () => (/* binding */ isTest)\n/* harmony export */ });\n// src/utils/env.ts\nvar _envShim = /* @__PURE__ */ Object.create(null);\nvar _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nvar env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nvar nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nvar isProduction = nodeENV === \"production\";\nvar isDevelopment = nodeENV === \"dev\" || nodeENV === \"development\";\nvar isTest = nodeENV === \"test\" || toBoolean(env.TEST);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVFFRU1BQTkEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsK0RBQStELGFBQW9CO0FBQ25GO0FBQ0E7QUFDQTs7QUFFb0QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1UUVFTUFBOQS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvZW52LnRzXG52YXIgX2VudlNoaW0gPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmNyZWF0ZShudWxsKTtcbnZhciBfZ2V0RW52ID0gKHVzZVNoaW0pID0+IGdsb2JhbFRoaXMucHJvY2Vzcz8uZW52IHx8IC8vQHRzLWV4cGVjdC1lcnJvclxuZ2xvYmFsVGhpcy5EZW5vPy5lbnYudG9PYmplY3QoKSB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuX19lbnZfXyB8fCAodXNlU2hpbSA/IF9lbnZTaGltIDogZ2xvYmFsVGhpcyk7XG52YXIgZW52ID0gbmV3IFByb3h5KF9lbnZTaGltLCB7XG4gIGdldChfLCBwcm9wKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYoKTtcbiAgICByZXR1cm4gZW52Mltwcm9wXSA/PyBfZW52U2hpbVtwcm9wXTtcbiAgfSxcbiAgaGFzKF8sIHByb3ApIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudigpO1xuICAgIHJldHVybiBwcm9wIGluIGVudjIgfHwgcHJvcCBpbiBfZW52U2hpbTtcbiAgfSxcbiAgc2V0KF8sIHByb3AsIHZhbHVlKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYodHJ1ZSk7XG4gICAgZW52Mltwcm9wXSA9IHZhbHVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBkZWxldGVQcm9wZXJ0eShfLCBwcm9wKSB7XG4gICAgaWYgKCFwcm9wKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIGRlbGV0ZSBlbnYyW3Byb3BdO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBvd25LZXlzKCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhlbnYyKTtcbiAgfVxufSk7XG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsKSB7XG4gIHJldHVybiB2YWwgPyB2YWwgIT09IFwiZmFsc2VcIiA6IGZhbHNlO1xufVxudmFyIG5vZGVFTlYgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCBcIlwiO1xudmFyIGlzUHJvZHVjdGlvbiA9IG5vZGVFTlYgPT09IFwicHJvZHVjdGlvblwiO1xudmFyIGlzRGV2ZWxvcG1lbnQgPSBub2RlRU5WID09PSBcImRldlwiIHx8IG5vZGVFTlYgPT09IFwiZGV2ZWxvcG1lbnRcIjtcbnZhciBpc1Rlc3QgPSBub2RlRU5WID09PSBcInRlc3RcIiB8fCB0b0Jvb2xlYW4oZW52LlRFU1QpO1xuXG5leHBvcnQgeyBlbnYsIGlzRGV2ZWxvcG1lbnQsIGlzUHJvZHVjdGlvbiwgaXNUZXN0IH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BetterAuthError: () => (/* binding */ BetterAuthError),\n/* harmony export */   MissingDependencyError: () => (/* binding */ MissingDependencyError)\n/* harmony export */ });\n// src/error/index.ts\nvar BetterAuthError = class extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n};\nvar MissingDependencyError = class extends BetterAuthError {\n  constructor(pkgName) {\n    super(\n      `The package \"${pkgName}\" is required. Make sure it is installed.`,\n      pkgName\n    );\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVU5XQ1hLTVAuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixRQUFRO0FBQzlCO0FBQ0E7QUFDQTtBQUNBOztBQUVtRCIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVVOV0NYS01QLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9lcnJvci9pbmRleC50c1xudmFyIEJldHRlckF1dGhFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBjYXVzZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9IFwiQmV0dGVyQXV0aEVycm9yXCI7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLmNhdXNlID0gY2F1c2U7XG4gICAgdGhpcy5zdGFjayA9IFwiXCI7XG4gIH1cbn07XG52YXIgTWlzc2luZ0RlcGVuZGVuY3lFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmV0dGVyQXV0aEVycm9yIHtcbiAgY29uc3RydWN0b3IocGtnTmFtZSkge1xuICAgIHN1cGVyKFxuICAgICAgYFRoZSBwYWNrYWdlIFwiJHtwa2dOYW1lfVwiIGlzIHJlcXVpcmVkLiBNYWtlIHN1cmUgaXQgaXMgaW5zdGFsbGVkLmAsXG4gICAgICBwa2dOYW1lXG4gICAgKTtcbiAgfVxufTtcblxuZXhwb3J0IHsgQmV0dGVyQXV0aEVycm9yLCBNaXNzaW5nRGVwZW5kZW5jeUVycm9yIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   twoFactor: () => (/* binding */ twoFactor)\n/* harmony export */ });\n/* harmony import */ var _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-WMXBA6LX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\");\n/* harmony import */ var _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-TOKZL3ZI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/otp */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/otp.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n// src/plugins/two-factor/constant.ts\nvar TWO_FACTOR_COOKIE_NAME = \"two_factor\";\nvar TRUST_DEVICE_COOKIE_NAME = \"trust_device\";\nvar verifyTwoFactorMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(\n  {\n    body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n      /**\n       * if true, the device will be trusted\n       * for 30 days. It'll be refreshed on\n       * every sign in request within this time.\n       */\n      trustDevice: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean().optional()\n    })\n  },\n  async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.getSessionFromCtx)(ctx);\n    if (!session) {\n      const cookieName = ctx.context.createAuthCookie(TWO_FACTOR_COOKIE_NAME);\n      const userId = await ctx.getSignedCookie(\n        cookieName.name,\n        ctx.context.secret\n      );\n      if (!userId) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n          message: \"invalid two factor cookie\"\n        });\n      }\n      const user = await ctx.context.internalAdapter.findUserById(\n        userId\n      );\n      if (!user) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n          message: \"invalid two factor cookie\"\n        });\n      }\n      const session2 = await ctx.context.internalAdapter.createSession(\n        userId,\n        ctx.request\n      );\n      if (!session2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: \"failed to create session\"\n        });\n      }\n      return {\n        valid: async () => {\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n            session: session2,\n            user\n          });\n          if (ctx.body.trustDevice) {\n            const trustDeviceCookie = ctx.context.createAuthCookie(\n              TRUST_DEVICE_COOKIE_NAME,\n              {\n                maxAge: 30 * 24 * 60 * 60\n                // 30 days, it'll be refreshed on sign in requests\n              }\n            );\n            const token = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n              ctx.context.secret,\n              `${user.id}!${session2.token}`\n            );\n            await ctx.setSignedCookie(\n              trustDeviceCookie.name,\n              `${token}!${session2.token}`,\n              ctx.context.secret,\n              trustDeviceCookie.attributes\n            );\n          }\n          return ctx.json({\n            token: session2.token,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        },\n        invalid: async () => {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n            message: \"invalid two factor authentication\"\n          });\n        },\n        session: {\n          session: session2,\n          user\n        }\n      };\n    }\n    return {\n      valid: async () => {\n        return ctx.json({\n          token: session.session.token,\n          user: {\n            id: session.user.id,\n            email: session.user.email,\n            emailVerified: session.user.emailVerified,\n            name: session.user.name,\n            image: session.user.image,\n            createdAt: session.user.createdAt,\n            updatedAt: session.user.updatedAt\n          }\n        });\n      },\n      invalid: async () => {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n          message: \"invalid two factor authentication\"\n        });\n      },\n      session\n    };\n  }\n);\nfunction generateBackupCodesFn(options) {\n  return Array.from({ length: 10 }).fill(null).map(() => (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.generateRandomString)(10, \"a-z\", \"0-9\", \"A-Z\")).map((code) => `${code.slice(0, 5)}-${code.slice(5)}`);\n}\nasync function generateBackupCodes(secret, options) {\n  const key = secret;\n  const backupCodes = options?.customBackupCodesGenerate ? options.customBackupCodesGenerate() : generateBackupCodesFn();\n  const encCodes = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricEncrypt)({\n    data: JSON.stringify(backupCodes),\n    key\n  });\n  return {\n    backupCodes,\n    encryptedBackupCodes: encCodes\n  };\n}\nasync function verifyBackupCode(data, key) {\n  const codes = await getBackupCodes(data.backupCodes, key);\n  if (!codes) {\n    return {\n      status: false,\n      updated: null\n    };\n  }\n  return {\n    status: codes.includes(data.code),\n    updated: codes.filter((code) => code !== data.code)\n  };\n}\nasync function getBackupCodes(backupCodes, key) {\n  const secret = Buffer.from(\n    await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricDecrypt)({ key, data: backupCodes })\n  ).toString(\"utf-8\");\n  const data = JSON.parse(secret);\n  const result = zod__WEBPACK_IMPORTED_MODULE_6__.z.array(zod__WEBPACK_IMPORTED_MODULE_6__.z.string()).safeParse(data);\n  if (result.success) {\n    return result.data;\n  }\n  return null;\n}\nvar backupCode2fa = (options) => {\n  const twoFactorTable = \"twoFactor\";\n  return {\n    id: \"backup_code\",\n    endpoints: {\n      verifyBackupCode: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/verify-backup-code\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string(),\n            /**\n             * Disable setting the session cookie\n             */\n            disableSession: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean().optional()\n          }),\n          use: [verifyTwoFactorMiddleware]\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          const twoFactor2 = await ctx.context.adapter.findOne({\n            model: twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              }\n            ]\n          });\n          if (!twoFactor2) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.BACKUP_CODES_NOT_ENABLED\n            });\n          }\n          const validate = await verifyBackupCode(\n            {\n              backupCodes: twoFactor2.backupCodes,\n              code: ctx.body.code\n            },\n            ctx.context.secret\n          );\n          if (!validate.status) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.INVALID_BACKUP_CODE\n            });\n          }\n          const updatedBackupCodes = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricEncrypt)({\n            key: ctx.context.secret,\n            data: JSON.stringify(validate.updated)\n          });\n          await ctx.context.adapter.updateMany({\n            model: twoFactorTable,\n            update: {\n              backupCodes: updatedBackupCodes\n            },\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              }\n            ]\n          });\n          if (!ctx.body.disableSession) {\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n              session: ctx.context.session.session,\n              user\n            });\n          }\n          return ctx.json({\n            user,\n            session: ctx.context.session\n          });\n        }\n      ),\n      generateBackupCodes: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/generate-backup-codes\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string()\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware]\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          if (!user.twoFactorEnabled) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TWO_FACTOR_NOT_ENABLED\n            });\n          }\n          await ctx.context.password.checkPassword(user.id, ctx);\n          const backupCodes = await generateBackupCodes(\n            ctx.context.secret,\n            options\n          );\n          await ctx.context.adapter.update({\n            model: twoFactorTable,\n            update: {\n              backupCodes: backupCodes.encryptedBackupCodes\n            },\n            where: [\n              {\n                field: \"userId\",\n                value: ctx.context.session.user.id\n              }\n            ]\n          });\n          return ctx.json({\n            status: true,\n            backupCodes: backupCodes.backupCodes\n          });\n        }\n      ),\n      viewBackupCodes: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/view-backup-codes\",\n        {\n          method: \"GET\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string()\n          }),\n          metadata: {\n            SERVER_ONLY: true\n          }\n        },\n        async (ctx) => {\n          const twoFactor2 = await ctx.context.adapter.findOne({\n            model: twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: ctx.body.userId\n              }\n            ]\n          });\n          if (!twoFactor2) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: \"Backup codes aren't enabled\"\n            });\n          }\n          const backupCodes = await getBackupCodes(\n            twoFactor2.backupCodes,\n            ctx.context.secret\n          );\n          if (!backupCodes) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.BACKUP_CODES_NOT_ENABLED\n            });\n          }\n          return ctx.json({\n            status: true,\n            backupCodes\n          });\n        }\n      )\n    }\n  };\n};\nvar otp2fa = (options) => {\n  const opts = {\n    ...options,\n    digits: options?.digits || 6,\n    period: (options?.period || 3) * 60 * 1e3\n  };\n  const twoFactorTable = \"twoFactor\";\n  const send2FaOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/send-otp\",\n    {\n      method: \"POST\",\n      use: [verifyTwoFactorMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Send two factor OTP\",\n          description: \"Send two factor OTP to the user\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"boolean\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (!options || !options.sendOTP) {\n        ctx.context.logger.error(\n          \"send otp isn't configured. Please configure the send otp function on otp options.\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"otp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.OTP_NOT_ENABLED\n        });\n      }\n      const code = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.generateRandomString)(opts.digits, \"0-9\");\n      await ctx.context.internalAdapter.createVerificationValue({\n        value: code,\n        identifier: `2fa-otp-${user.id}`,\n        expiresAt: new Date(Date.now() + opts.period)\n      });\n      await options.sendOTP({ user, otp: code }, ctx.request);\n      return ctx.json({ status: true });\n    }\n  );\n  const verifyOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/verify-otp\",\n    {\n      method: \"POST\",\n      body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n          description: \"The otp code to verify\"\n        })\n      }),\n      use: [verifyTwoFactorMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Verify two factor OTP\",\n          description: \"Verify two factor OTP\",\n          responses: {\n            200: {\n              description: \"Success\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"boolean\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.OTP_NOT_ENABLED\n        });\n      }\n      const toCheckOtp = await ctx.context.internalAdapter.findVerificationValue(\n        `2fa-otp-${user.id}`\n      );\n      if (!toCheckOtp || toCheckOtp.expiresAt < /* @__PURE__ */ new Date()) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.OTP_HAS_EXPIRED\n        });\n      }\n      if (toCheckOtp.value === ctx.body.code) {\n        if (!user.twoFactorEnabled) {\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            user.id,\n            {\n              twoFactorEnabled: true\n            }\n          );\n          const newSession = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.request,\n            false,\n            ctx.context.session.session\n          );\n          await ctx.context.internalAdapter.deleteSession(\n            ctx.context.session.session.token\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n            session: newSession,\n            user: updatedUser\n          });\n        }\n        return ctx.context.valid();\n      } else {\n        return ctx.context.invalid();\n      }\n    }\n  );\n  return {\n    id: \"otp\",\n    endpoints: {\n      sendTwoFactorOTP: send2FaOTP,\n      verifyTwoFactorOTP: verifyOTP\n    }\n  };\n};\nvar totp2fa = (options) => {\n  const opts = {\n    ...options,\n    digits: options?.digits || 6,\n    period: options?.period || 30\n  };\n  const twoFactorTable = \"twoFactor\";\n  const generateTOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/totp/generate\",\n    {\n      method: \"POST\",\n      use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Generate TOTP code\",\n          description: \"Use this endpoint to generate a TOTP code\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      code: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (options?.disable) {\n        ctx.context.logger.error(\n          \"totp isn't configured. please pass totp option on two factor plugin to enable totp\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"totp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TOTP_NOT_ENABLED\n        });\n      }\n      const code = await (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(twoFactor2.secret, {\n        period: opts.period,\n        digits: opts.digits\n      }).totp();\n      return { code };\n    }\n  );\n  const getTOTPURI = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/get-totp-uri\",\n    {\n      method: \"POST\",\n      use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n      body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n          description: \"User password\"\n        })\n      }),\n      metadata: {\n        openapi: {\n          summary: \"Get TOTP URI\",\n          description: \"Use this endpoint to get the TOTP URI\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      totpURI: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (options?.disable) {\n        ctx.context.logger.error(\n          \"totp isn't configured. please pass totp option on two factor plugin to enable totp\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"totp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2 || !user.twoFactorEnabled) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TOTP_NOT_ENABLED\n        });\n      }\n      const secret = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricDecrypt)({\n        key: ctx.context.secret,\n        data: twoFactor2.secret\n      });\n      await ctx.context.password.checkPassword(user.id, ctx);\n      const totpURI = (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(secret, {\n        digits: opts.digits,\n        period: opts.period\n      }).url(options?.issuer || ctx.context.appName, user.email);\n      return {\n        totpURI\n      };\n    }\n  );\n  const verifyTOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/verify-totp\",\n    {\n      method: \"POST\",\n      body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n          description: \"The otp code to verify\"\n        })\n      }),\n      use: [verifyTwoFactorMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Verify two factor TOTP\",\n          description: \"Verify two factor TOTP\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"boolean\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (options?.disable) {\n        ctx.context.logger.error(\n          \"totp isn't configured. please pass totp option on two factor plugin to enable totp\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"totp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TOTP_NOT_ENABLED\n        });\n      }\n      const decrypted = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricDecrypt)({\n        key: ctx.context.secret,\n        data: twoFactor2.secret\n      });\n      const status = await (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(decrypted, {\n        period: opts.period,\n        digits: opts.digits\n      }).verify(ctx.body.code);\n      if (!status) {\n        return ctx.context.invalid();\n      }\n      if (!user.twoFactorEnabled) {\n        const updatedUser = await ctx.context.internalAdapter.updateUser(\n          user.id,\n          {\n            twoFactorEnabled: true\n          }\n        );\n        const newSession = await ctx.context.internalAdapter.createSession(\n          user.id,\n          ctx.request,\n          false,\n          ctx.context.session.session\n        ).catch((e) => {\n          throw e;\n        });\n        await ctx.context.internalAdapter.deleteSession(\n          ctx.context.session.session.token\n        );\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n          session: newSession,\n          user: updatedUser\n        });\n      }\n      return ctx.context.valid();\n    }\n  );\n  return {\n    id: \"totp\",\n    endpoints: {\n      generateTOTP,\n      getTOTPURI,\n      verifyTOTP\n    }\n  };\n};\n\n// src/plugins/two-factor/schema.ts\nvar schema = {\n  user: {\n    fields: {\n      twoFactorEnabled: {\n        type: \"boolean\",\n        required: false,\n        defaultValue: false,\n        input: false\n      }\n    }\n  },\n  twoFactor: {\n    fields: {\n      secret: {\n        type: \"string\",\n        required: true,\n        returned: false\n      },\n      backupCodes: {\n        type: \"string\",\n        required: true,\n        returned: false\n      },\n      userId: {\n        type: \"string\",\n        required: true,\n        returned: false,\n        references: {\n          model: \"user\",\n          field: \"id\"\n        }\n      }\n    }\n  }\n};\nvar twoFactor = (options) => {\n  const opts = {\n    twoFactorTable: \"twoFactor\"\n  };\n  const totp = totp2fa(options?.totpOptions);\n  const backupCode = backupCode2fa(options?.backupCodeOptions);\n  const otp = otp2fa(options?.otpOptions);\n  return {\n    id: \"two-factor\",\n    endpoints: {\n      ...totp.endpoints,\n      ...otp.endpoints,\n      ...backupCode.endpoints,\n      enableTwoFactor: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/enable\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"User password\"\n            }).min(8)\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              summary: \"Enable two factor authentication\",\n              description: \"Use this endpoint to enable two factor authentication. This will generate a TOTP URI and backup codes. Once the user verifies the TOTP URI, the two factor authentication will be enabled.\",\n              responses: {\n                200: {\n                  description: \"Successful response\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          totpURI: {\n                            type: \"string\",\n                            description: \"TOTP URI\"\n                          },\n                          backupCodes: {\n                            type: \"array\",\n                            items: {\n                              type: \"string\"\n                            },\n                            description: \"Backup codes\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          const { password } = ctx.body;\n          const isPasswordValid = await (0,_chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_1__.validatePassword)(ctx, {\n            password,\n            userId: user.id\n          });\n          if (!isPasswordValid) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.BASE_ERROR_CODES.INVALID_PASSWORD\n            });\n          }\n          const secret = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.generateRandomString)(32);\n          const encryptedSecret = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricEncrypt)({\n            key: ctx.context.secret,\n            data: secret\n          });\n          const backupCodes = await generateBackupCodes(\n            ctx.context.secret,\n            options?.backupCodeOptions\n          );\n          if (options?.skipVerificationOnEnable) {\n            const updatedUser = await ctx.context.internalAdapter.updateUser(\n              user.id,\n              {\n                twoFactorEnabled: true\n              }\n            );\n            const newSession = await ctx.context.internalAdapter.createSession(\n              updatedUser.id,\n              ctx.request,\n              false,\n              ctx.context.session.session\n            );\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n              session: newSession,\n              user: updatedUser\n            });\n            await ctx.context.internalAdapter.deleteSession(\n              ctx.context.session.session.token\n            );\n          }\n          await ctx.context.adapter.deleteMany({\n            model: opts.twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              }\n            ]\n          });\n          await ctx.context.adapter.create({\n            model: opts.twoFactorTable,\n            data: {\n              secret: encryptedSecret,\n              backupCodes: backupCodes.encryptedBackupCodes,\n              userId: user.id\n            }\n          });\n          const totpURI = (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(secret, {\n            digits: options?.totpOptions?.digits || 6,\n            period: options?.totpOptions?.period\n          }).url(options?.issuer || ctx.context.appName, user.email);\n          return ctx.json({ totpURI, backupCodes: backupCodes.backupCodes });\n        }\n      ),\n      disableTwoFactor: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/disable\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"User password\"\n            }).min(8)\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              summary: \"Disable two factor authentication\",\n              description: \"Use this endpoint to disable two factor authentication.\",\n              responses: {\n                200: {\n                  description: \"Successful response\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          status: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          const { password } = ctx.body;\n          const isPasswordValid = await (0,_chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_1__.validatePassword)(ctx, {\n            password,\n            userId: user.id\n          });\n          if (!isPasswordValid) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: \"Invalid password\"\n            });\n          }\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            user.id,\n            {\n              twoFactorEnabled: false\n            }\n          );\n          await ctx.context.adapter.delete({\n            model: opts.twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: updatedUser.id\n              }\n            ]\n          });\n          const newSession = await ctx.context.internalAdapter.createSession(\n            updatedUser.id,\n            ctx.request,\n            false,\n            ctx.context.session.session\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n            session: newSession,\n            user: updatedUser\n          });\n          await ctx.context.internalAdapter.deleteSession(\n            ctx.context.session.session.token\n          );\n          return ctx.json({ status: true });\n        }\n      )\n    },\n    options,\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return context.path === \"/sign-in/email\" || context.path === \"/sign-in/username\" || context.path === \"/sign-in/phone-number\";\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(async (ctx) => {\n            const data = ctx.context.newSession;\n            if (!data) {\n              return;\n            }\n            if (!data?.user.twoFactorEnabled) {\n              return;\n            }\n            const trustDeviceCookieName = ctx.context.createAuthCookie(\n              TRUST_DEVICE_COOKIE_NAME\n            );\n            const trustDeviceCookie = await ctx.getSignedCookie(\n              trustDeviceCookieName.name,\n              ctx.context.secret\n            );\n            if (trustDeviceCookie) {\n              const [token, sessionToken] = trustDeviceCookie.split(\"!\");\n              const expectedToken = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__.createHMAC)(\n                \"SHA-256\",\n                \"base64urlnopad\"\n              ).sign(ctx.context.secret, `${data.user.id}!${sessionToken}`);\n              if (token === expectedToken) {\n                const newToken = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__.createHMAC)(\n                  \"SHA-256\",\n                  \"base64urlnopad\"\n                ).sign(ctx.context.secret, `${data.user.id}!${sessionToken}`);\n                await ctx.setSignedCookie(\n                  trustDeviceCookieName.name,\n                  `${newToken}!${data.session.token}`,\n                  ctx.context.secret,\n                  trustDeviceCookieName.attributes\n                );\n                return;\n              }\n            }\n            (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.deleteSessionCookie)(ctx);\n            await ctx.context.internalAdapter.deleteSession(data.session.token);\n            const twoFactorCookie = ctx.context.createAuthCookie(\n              TWO_FACTOR_COOKIE_NAME,\n              {\n                maxAge: 60 * 10\n                // 10 minutes\n              }\n            );\n            await ctx.setSignedCookie(\n              twoFactorCookie.name,\n              data.user.id,\n              ctx.context.secret,\n              twoFactorCookie.attributes\n            );\n            return ctx.json({\n              twoFactorRedirect: true\n            });\n          })\n        }\n      ]\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_4__.mergeSchema)(schema, options?.schema),\n    rateLimit: [\n      {\n        pathMatcher(path) {\n          return path.startsWith(\"/two-factor/\");\n        },\n        window: 10,\n        max: 3\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVlJWSzdDRlcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBNkQ7QUFDTjtBQUNnRjtBQUMzRDtBQUMxQjtBQUM2QztBQUN2RTtBQUNlO0FBQ2M7QUFDRjs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHdFQUFvQjtBQUNwRDtBQUNBLFVBQVUseUNBQVE7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwwQ0FBUztBQUM1QixLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsMEJBQTBCLHFFQUFpQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBUTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGlEQUFRO0FBQzFCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBUTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isb0VBQWdCO0FBQ2hDO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxtRUFBVTtBQUMxQztBQUNBLGlCQUFpQixRQUFRLEdBQUcsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsTUFBTSxHQUFHLGVBQWU7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBLG9CQUFvQixpREFBUTtBQUM1QjtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0Esa0JBQWtCLGlEQUFRO0FBQzFCO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFlBQVksdUJBQXVCLHdFQUFvQiw0Q0FBNEMsaUJBQWlCLEdBQUcsY0FBYztBQUMzSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixvRUFBZ0I7QUFDekM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxvRUFBZ0IsR0FBRyx3QkFBd0I7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQix3Q0FBTyxDQUFDLHlDQUFRO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNFQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IseUNBQVE7QUFDeEIsa0JBQWtCLHlDQUFRO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwwQ0FBUztBQUNyQyxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUIsdUJBQXVCLHNFQUFzQjtBQUM3QyxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUIsdUJBQXVCLHNFQUFzQjtBQUM3QyxhQUFhO0FBQ2I7QUFDQSwyQ0FBMkMsb0VBQWdCO0FBQzNEO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0Esa0JBQWtCLG9FQUFnQjtBQUNsQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwyQkFBMkIsc0VBQWtCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QixzQkFBc0IseUNBQVE7QUFDOUIsV0FBVztBQUNYLGdCQUFnQixpRUFBaUI7QUFDakMsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpREFBUTtBQUM5Qix1QkFBdUIsc0VBQXNCO0FBQzdDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSx1QkFBdUIsc0VBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QixvQkFBb0IseUNBQVE7QUFDNUIsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCLHVCQUF1QixzRUFBc0I7QUFDN0MsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixzRUFBa0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUIsbUJBQW1CLHNFQUFzQjtBQUN6QyxTQUFTO0FBQ1Q7QUFDQSxtQkFBbUIsd0VBQW9CO0FBQ3ZDO0FBQ0E7QUFDQSwrQkFBK0IsUUFBUTtBQUN2QztBQUNBLE9BQU87QUFDUCw4QkFBOEIsaUJBQWlCO0FBQy9DLHdCQUF3QixjQUFjO0FBQ3RDO0FBQ0E7QUFDQSxvQkFBb0Isc0VBQWtCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLFlBQVkseUNBQVE7QUFDcEIsY0FBYyx5Q0FBUTtBQUN0QjtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0Esa0JBQWtCLGlEQUFRO0FBQzFCLG1CQUFtQixzRUFBc0I7QUFDekMsU0FBUztBQUNUO0FBQ0E7QUFDQSxtQkFBbUIsUUFBUTtBQUMzQjtBQUNBO0FBQ0Esa0JBQWtCLGlEQUFRO0FBQzFCLG1CQUFtQixzRUFBc0I7QUFDekMsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvRUFBZ0I7QUFDaEM7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSxZQUFZLGlFQUFpQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUIsbUJBQW1CLHNFQUFzQjtBQUN6QyxTQUFTO0FBQ1Q7QUFDQSx5QkFBeUIsaUVBQVM7QUFDbEM7QUFDQTtBQUNBLE9BQU87QUFDUCxlQUFlO0FBQ2Y7QUFDQTtBQUNBLHFCQUFxQixzRUFBa0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpRUFBaUI7QUFDN0IsWUFBWSx5Q0FBUTtBQUNwQixrQkFBa0IseUNBQVE7QUFDMUI7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBUTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLGtCQUFrQixpREFBUTtBQUMxQixtQkFBbUIsc0VBQXNCO0FBQ3pDLFNBQVM7QUFDVDtBQUNBLDJCQUEyQixvRUFBZ0I7QUFDM0M7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLHNCQUFzQixpRUFBUztBQUMvQjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsc0VBQWtCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLFlBQVkseUNBQVE7QUFDcEIsY0FBYyx5Q0FBUTtBQUN0QjtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUIsbUJBQW1CLHNFQUFzQjtBQUN6QyxTQUFTO0FBQ1Q7QUFDQSw4QkFBOEIsb0VBQWdCO0FBQzlDO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsMkJBQTJCLGlFQUFTO0FBQ3BDO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9FQUFnQjtBQUM5QjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IseUNBQVE7QUFDeEIsc0JBQXNCLHlDQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWCxnQkFBZ0IsaUVBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esa0JBQWtCLFdBQVc7QUFDN0Isd0NBQXdDLG9FQUFnQjtBQUN4RDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCLHVCQUF1QixnRUFBZ0I7QUFDdkMsYUFBYTtBQUNiO0FBQ0EseUJBQXlCLHdFQUFvQjtBQUM3Qyx3Q0FBd0Msb0VBQWdCO0FBQ3hEO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixvRUFBZ0I7QUFDbEM7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsMEJBQTBCLGlFQUFTO0FBQ25DO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsNEJBQTRCLCtDQUErQztBQUMzRTtBQUNBO0FBQ0Esd0JBQXdCLHNFQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IseUNBQVE7QUFDeEIsc0JBQXNCLHlDQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWCxnQkFBZ0IsaUVBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGtCQUFrQixXQUFXO0FBQzdCLHdDQUF3QyxvRUFBZ0I7QUFDeEQ7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixjQUFjO0FBQzFDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLG1CQUFtQix3RUFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsbUVBQVU7QUFDcEQ7QUFDQTtBQUNBLDRDQUE0QyxhQUFhLEdBQUcsYUFBYTtBQUN6RTtBQUNBLHVDQUF1QyxtRUFBVTtBQUNqRDtBQUNBO0FBQ0EsOENBQThDLGFBQWEsR0FBRyxhQUFhO0FBQzNFO0FBQ0E7QUFDQSxxQkFBcUIsU0FBUyxHQUFHLG1CQUFtQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHVFQUFtQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZLCtEQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFcUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1WUlZLN0NGVy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUV09fRkFDVE9SX0VSUk9SX0NPREVTIH0gZnJvbSAnLi9jaHVuay1XTVhCQTZMWC5qcyc7XG5pbXBvcnQgeyB2YWxpZGF0ZVBhc3N3b3JkIH0gZnJvbSAnLi9jaHVuay1UT0taTDNaSS5qcyc7XG5pbXBvcnQgeyBjcmVhdGVBdXRoTWlkZGxld2FyZSwgZ2V0U2Vzc2lvbkZyb21DdHgsIGNyZWF0ZUF1dGhFbmRwb2ludCwgc2Vzc2lvbk1pZGRsZXdhcmUsIEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUsIGRlbGV0ZVNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IG1lcmdlU2NoZW1hIH0gZnJvbSAnLi9jaHVuay1XWjZPSVZKSy5qcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZVJhbmRvbVN0cmluZywgc3ltbWV0cmljRW5jcnlwdCwgc3ltbWV0cmljRGVjcnlwdCB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGNyZWF0ZUhNQUMgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaG1hYyc7XG5pbXBvcnQgeyBjcmVhdGVPVFAgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvb3RwJztcblxuLy8gc3JjL3BsdWdpbnMvdHdvLWZhY3Rvci9jb25zdGFudC50c1xudmFyIFRXT19GQUNUT1JfQ09PS0lFX05BTUUgPSBcInR3b19mYWN0b3JcIjtcbnZhciBUUlVTVF9ERVZJQ0VfQ09PS0lFX05BTUUgPSBcInRydXN0X2RldmljZVwiO1xudmFyIHZlcmlmeVR3b0ZhY3Rvck1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShcbiAge1xuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogaWYgdHJ1ZSwgdGhlIGRldmljZSB3aWxsIGJlIHRydXN0ZWRcbiAgICAgICAqIGZvciAzMCBkYXlzLiBJdCdsbCBiZSByZWZyZXNoZWQgb25cbiAgICAgICAqIGV2ZXJ5IHNpZ24gaW4gcmVxdWVzdCB3aXRoaW4gdGhpcyB0aW1lLlxuICAgICAgICovXG4gICAgICB0cnVzdERldmljZTogei5ib29sZWFuKCkub3B0aW9uYWwoKVxuICAgIH0pXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIGNvbnN0IGNvb2tpZU5hbWUgPSBjdHguY29udGV4dC5jcmVhdGVBdXRoQ29va2llKFRXT19GQUNUT1JfQ09PS0lFX05BTUUpO1xuICAgICAgY29uc3QgdXNlcklkID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgY29va2llTmFtZS5uYW1lLFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICk7XG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiaW52YWxpZCB0d28gZmFjdG9yIGNvb2tpZVwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoXG4gICAgICAgIHVzZXJJZFxuICAgICAgKTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiaW52YWxpZCB0d28gZmFjdG9yIGNvb2tpZVwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbjIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICAgIGlmICghc2Vzc2lvbjIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcImZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvblwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbjIsXG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKGN0eC5ib2R5LnRydXN0RGV2aWNlKSB7XG4gICAgICAgICAgICBjb25zdCB0cnVzdERldmljZUNvb2tpZSA9IGN0eC5jb250ZXh0LmNyZWF0ZUF1dGhDb29raWUoXG4gICAgICAgICAgICAgIFRSVVNUX0RFVklDRV9DT09LSUVfTkFNRSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjBcbiAgICAgICAgICAgICAgICAvLyAzMCBkYXlzLCBpdCdsbCBiZSByZWZyZXNoZWQgb24gc2lnbiBpbiByZXF1ZXN0c1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnNpZ24oXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgICAgYCR7dXNlci5pZH0hJHtzZXNzaW9uMi50b2tlbn1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgICAgdHJ1c3REZXZpY2VDb29raWUubmFtZSxcbiAgICAgICAgICAgICAgYCR7dG9rZW59ISR7c2Vzc2lvbjIudG9rZW59YCxcbiAgICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgICB0cnVzdERldmljZUNvb2tpZS5hdHRyaWJ1dGVzXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdG9rZW46IHNlc3Npb24yLnRva2VuLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBpbnZhbGlkOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiaW52YWxpZCB0d28gZmFjdG9yIGF1dGhlbnRpY2F0aW9uXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgIHNlc3Npb246IHNlc3Npb24yLFxuICAgICAgICAgIHVzZXJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgdG9rZW46IHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHNlc3Npb24udXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgbmFtZTogc2Vzc2lvbi51c2VyLm5hbWUsXG4gICAgICAgICAgICBpbWFnZTogc2Vzc2lvbi51c2VyLmltYWdlLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiBzZXNzaW9uLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgICAgdXBkYXRlZEF0OiBzZXNzaW9uLnVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBpbnZhbGlkOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJpbnZhbGlkIHR3byBmYWN0b3IgYXV0aGVudGljYXRpb25cIlxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBzZXNzaW9uXG4gICAgfTtcbiAgfVxuKTtcbmZ1bmN0aW9uIGdlbmVyYXRlQmFja3VwQ29kZXNGbihvcHRpb25zKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxMCB9KS5maWxsKG51bGwpLm1hcCgoKSA9PiBnZW5lcmF0ZVJhbmRvbVN0cmluZygxMCwgXCJhLXpcIiwgXCIwLTlcIiwgXCJBLVpcIikpLm1hcCgoY29kZSkgPT4gYCR7Y29kZS5zbGljZSgwLCA1KX0tJHtjb2RlLnNsaWNlKDUpfWApO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVCYWNrdXBDb2RlcyhzZWNyZXQsIG9wdGlvbnMpIHtcbiAgY29uc3Qga2V5ID0gc2VjcmV0O1xuICBjb25zdCBiYWNrdXBDb2RlcyA9IG9wdGlvbnM/LmN1c3RvbUJhY2t1cENvZGVzR2VuZXJhdGUgPyBvcHRpb25zLmN1c3RvbUJhY2t1cENvZGVzR2VuZXJhdGUoKSA6IGdlbmVyYXRlQmFja3VwQ29kZXNGbigpO1xuICBjb25zdCBlbmNDb2RlcyA9IGF3YWl0IHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGJhY2t1cENvZGVzKSxcbiAgICBrZXlcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgYmFja3VwQ29kZXMsXG4gICAgZW5jcnlwdGVkQmFja3VwQ29kZXM6IGVuY0NvZGVzXG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlCYWNrdXBDb2RlKGRhdGEsIGtleSkge1xuICBjb25zdCBjb2RlcyA9IGF3YWl0IGdldEJhY2t1cENvZGVzKGRhdGEuYmFja3VwQ29kZXMsIGtleSk7XG4gIGlmICghY29kZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiBmYWxzZSxcbiAgICAgIHVwZGF0ZWQ6IG51bGxcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgc3RhdHVzOiBjb2Rlcy5pbmNsdWRlcyhkYXRhLmNvZGUpLFxuICAgIHVwZGF0ZWQ6IGNvZGVzLmZpbHRlcigoY29kZSkgPT4gY29kZSAhPT0gZGF0YS5jb2RlKVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0QmFja3VwQ29kZXMoYmFja3VwQ29kZXMsIGtleSkge1xuICBjb25zdCBzZWNyZXQgPSBCdWZmZXIuZnJvbShcbiAgICBhd2FpdCBzeW1tZXRyaWNEZWNyeXB0KHsga2V5LCBkYXRhOiBiYWNrdXBDb2RlcyB9KVxuICApLnRvU3RyaW5nKFwidXRmLThcIik7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHNlY3JldCk7XG4gIGNvbnN0IHJlc3VsdCA9IHouYXJyYXkoei5zdHJpbmcoKSkuc2FmZVBhcnNlKGRhdGEpO1xuICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4gcmVzdWx0LmRhdGE7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG52YXIgYmFja3VwQ29kZTJmYSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHR3b0ZhY3RvclRhYmxlID0gXCJ0d29GYWN0b3JcIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJiYWNrdXBfY29kZVwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgdmVyaWZ5QmFja3VwQ29kZTogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi90d28tZmFjdG9yL3ZlcmlmeS1iYWNrdXAtY29kZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBjb2RlOiB6LnN0cmluZygpLFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEaXNhYmxlIHNldHRpbmcgdGhlIHNlc3Npb24gY29va2llXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRpc2FibGVTZXNzaW9uOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbdmVyaWZ5VHdvRmFjdG9yTWlkZGxld2FyZV1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXI7XG4gICAgICAgICAgY29uc3QgdHdvRmFjdG9yMiA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgICAgICBtb2RlbDogdHdvRmFjdG9yVGFibGUsXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdHdvRmFjdG9yMikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBUV09fRkFDVE9SX0VSUk9SX0NPREVTLkJBQ0tVUF9DT0RFU19OT1RfRU5BQkxFRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZhbGlkYXRlID0gYXdhaXQgdmVyaWZ5QmFja3VwQ29kZShcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYmFja3VwQ29kZXM6IHR3b0ZhY3RvcjIuYmFja3VwQ29kZXMsXG4gICAgICAgICAgICAgIGNvZGU6IGN0eC5ib2R5LmNvZGVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghdmFsaWRhdGUuc3RhdHVzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBUV09fRkFDVE9SX0VSUk9SX0NPREVTLklOVkFMSURfQkFDS1VQX0NPREVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1cGRhdGVkQmFja3VwQ29kZXMgPSBhd2FpdCBzeW1tZXRyaWNFbmNyeXB0KHtcbiAgICAgICAgICAgIGtleTogY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkodmFsaWRhdGUudXBkYXRlZClcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLnVwZGF0ZU1hbnkoe1xuICAgICAgICAgICAgbW9kZWw6IHR3b0ZhY3RvclRhYmxlLFxuICAgICAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgICAgIGJhY2t1cENvZGVzOiB1cGRhdGVkQmFja3VwQ29kZXNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghY3R4LmJvZHkuZGlzYWJsZVNlc3Npb24pIHtcbiAgICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICAgIHNlc3Npb246IGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgICAgICAgdXNlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgc2Vzc2lvbjogY3R4LmNvbnRleHQuc2Vzc2lvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgZ2VuZXJhdGVCYWNrdXBDb2RlczogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi90d28tZmFjdG9yL2dlbmVyYXRlLWJhY2t1cC1jb2Rlc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBwYXNzd29yZDogei5zdHJpbmcoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGN0eC5jb250ZXh0LnNlc3Npb24udXNlcjtcbiAgICAgICAgICBpZiAoIXVzZXIudHdvRmFjdG9yRW5hYmxlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBUV09fRkFDVE9SX0VSUk9SX0NPREVTLlRXT19GQUNUT1JfTk9UX0VOQUJMRURcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5jaGVja1Bhc3N3b3JkKHVzZXIuaWQsIGN0eCk7XG4gICAgICAgICAgY29uc3QgYmFja3VwQ29kZXMgPSBhd2FpdCBnZW5lcmF0ZUJhY2t1cENvZGVzKFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgb3B0aW9uc1xuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci51cGRhdGUoe1xuICAgICAgICAgICAgbW9kZWw6IHR3b0ZhY3RvclRhYmxlLFxuICAgICAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgICAgIGJhY2t1cENvZGVzOiBiYWNrdXBDb2Rlcy5lbmNyeXB0ZWRCYWNrdXBDb2Rlc1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgICAgYmFja3VwQ29kZXM6IGJhY2t1cENvZGVzLmJhY2t1cENvZGVzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB2aWV3QmFja3VwQ29kZXM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvdHdvLWZhY3Rvci92aWV3LWJhY2t1cC1jb2Rlc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBTRVJWRVJfT05MWTogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHR3b0ZhY3RvcjIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IHR3b0ZhY3RvclRhYmxlLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBjdHguYm9keS51c2VySWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdHdvRmFjdG9yMikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkJhY2t1cCBjb2RlcyBhcmVuJ3QgZW5hYmxlZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgYmFja3VwQ29kZXMgPSBhd2FpdCBnZXRCYWNrdXBDb2RlcyhcbiAgICAgICAgICAgIHR3b0ZhY3RvcjIuYmFja3VwQ29kZXMsXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghYmFja3VwQ29kZXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5CQUNLVVBfQ09ERVNfTk9UX0VOQUJMRURcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgICAgYmFja3VwQ29kZXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH1cbiAgfTtcbn07XG52YXIgb3RwMmZhID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3Qgb3B0cyA9IHtcbiAgICAuLi5vcHRpb25zLFxuICAgIGRpZ2l0czogb3B0aW9ucz8uZGlnaXRzIHx8IDYsXG4gICAgcGVyaW9kOiAob3B0aW9ucz8ucGVyaW9kIHx8IDMpICogNjAgKiAxZTNcbiAgfTtcbiAgY29uc3QgdHdvRmFjdG9yVGFibGUgPSBcInR3b0ZhY3RvclwiO1xuICBjb25zdCBzZW5kMkZhT1RQID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgIFwiL3R3by1mYWN0b3Ivc2VuZC1vdHBcIixcbiAgICB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgdXNlOiBbdmVyaWZ5VHdvRmFjdG9yTWlkZGxld2FyZV0sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgc3VtbWFyeTogXCJTZW5kIHR3byBmYWN0b3IgT1RQXCIsXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiU2VuZCB0d28gZmFjdG9yIE9UUCB0byB0aGUgdXNlclwiLFxuICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NmdWwgcmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5zZW5kT1RQKSB7XG4gICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcInNlbmQgb3RwIGlzbid0IGNvbmZpZ3VyZWQuIFBsZWFzZSBjb25maWd1cmUgdGhlIHNlbmQgb3RwIGZ1bmN0aW9uIG9uIG90cCBvcHRpb25zLlwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcIm90cCBpc24ndCBjb25maWd1cmVkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgY29uc3QgdHdvRmFjdG9yMiA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdHdvRmFjdG9yMikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5PVFBfTk9UX0VOQUJMRURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCBjb2RlID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcob3B0cy5kaWdpdHMsIFwiMC05XCIpO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgdmFsdWU6IGNvZGUsXG4gICAgICAgIGlkZW50aWZpZXI6IGAyZmEtb3RwLSR7dXNlci5pZH1gLFxuICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgKyBvcHRzLnBlcmlvZClcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgb3B0aW9ucy5zZW5kT1RQKHsgdXNlciwgb3RwOiBjb2RlIH0sIGN0eC5yZXF1ZXN0KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7IHN0YXR1czogdHJ1ZSB9KTtcbiAgICB9XG4gICk7XG4gIGNvbnN0IHZlcmlmeU9UUCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICBcIi90d28tZmFjdG9yL3ZlcmlmeS1vdHBcIixcbiAgICB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICBjb2RlOiB6LnN0cmluZyh7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG90cCBjb2RlIHRvIHZlcmlmeVwiXG4gICAgICAgIH0pXG4gICAgICB9KSxcbiAgICAgIHVzZTogW3ZlcmlmeVR3b0ZhY3Rvck1pZGRsZXdhcmVdLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgIHN1bW1hcnk6IFwiVmVyaWZ5IHR3byBmYWN0b3IgT1RQXCIsXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVmVyaWZ5IHR3byBmYWN0b3IgT1RQXCIsXG4gICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGN0eC5jb250ZXh0LnNlc3Npb24udXNlcjtcbiAgICAgIGNvbnN0IHR3b0ZhY3RvcjIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogdHdvRmFjdG9yVGFibGUsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlci5pZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXR3b0ZhY3RvcjIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuT1RQX05PVF9FTkFCTEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdG9DaGVja090cCA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgIGAyZmEtb3RwLSR7dXNlci5pZH1gXG4gICAgICApO1xuICAgICAgaWYgKCF0b0NoZWNrT3RwIHx8IHRvQ2hlY2tPdHAuZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuT1RQX0hBU19FWFBJUkVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHRvQ2hlY2tPdHAudmFsdWUgPT09IGN0eC5ib2R5LmNvZGUpIHtcbiAgICAgICAgaWYgKCF1c2VyLnR3b0ZhY3RvckVuYWJsZWQpIHtcbiAgICAgICAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdHdvRmFjdG9yRW5hYmxlZDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgbmV3U2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0LFxuICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb25cbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgc2Vzc2lvbjogbmV3U2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN0eC5jb250ZXh0LnZhbGlkKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY3R4LmNvbnRleHQuaW52YWxpZCgpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJvdHBcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNlbmRUd29GYWN0b3JPVFA6IHNlbmQyRmFPVFAsXG4gICAgICB2ZXJpZnlUd29GYWN0b3JPVFA6IHZlcmlmeU9UUFxuICAgIH1cbiAgfTtcbn07XG52YXIgdG90cDJmYSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBkaWdpdHM6IG9wdGlvbnM/LmRpZ2l0cyB8fCA2LFxuICAgIHBlcmlvZDogb3B0aW9ucz8ucGVyaW9kIHx8IDMwXG4gIH07XG4gIGNvbnN0IHR3b0ZhY3RvclRhYmxlID0gXCJ0d29GYWN0b3JcIjtcbiAgY29uc3QgZ2VuZXJhdGVUT1RQID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgIFwiL3RvdHAvZ2VuZXJhdGVcIixcbiAgICB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgIHN1bW1hcnk6IFwiR2VuZXJhdGUgVE9UUCBjb2RlXCIsXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHRoaXMgZW5kcG9pbnQgdG8gZ2VuZXJhdGUgYSBUT1RQIGNvZGVcIixcbiAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzZnVsIHJlc3BvbnNlXCIsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb2RlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICBpZiAob3B0aW9ucz8uZGlzYWJsZSkge1xuICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJ0b3RwIGlzbid0IGNvbmZpZ3VyZWQuIHBsZWFzZSBwYXNzIHRvdHAgb3B0aW9uIG9uIHR3byBmYWN0b3IgcGx1Z2luIHRvIGVuYWJsZSB0b3RwXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwidG90cCBpc24ndCBjb25maWd1cmVkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgY29uc3QgdHdvRmFjdG9yMiA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdHdvRmFjdG9yMikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5UT1RQX05PVF9FTkFCTEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgY29kZSA9IGF3YWl0IGNyZWF0ZU9UUCh0d29GYWN0b3IyLnNlY3JldCwge1xuICAgICAgICBwZXJpb2Q6IG9wdHMucGVyaW9kLFxuICAgICAgICBkaWdpdHM6IG9wdHMuZGlnaXRzXG4gICAgICB9KS50b3RwKCk7XG4gICAgICByZXR1cm4geyBjb2RlIH07XG4gICAgfVxuICApO1xuICBjb25zdCBnZXRUT1RQVVJJID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgIFwiL3R3by1mYWN0b3IvZ2V0LXRvdHAtdXJpXCIsXG4gICAge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHBhc3N3b3JkXCJcbiAgICAgICAgfSlcbiAgICAgIH0pLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgIHN1bW1hcnk6IFwiR2V0IFRPVFAgVVJJXCIsXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHRoaXMgZW5kcG9pbnQgdG8gZ2V0IHRoZSBUT1RQIFVSSVwiLFxuICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NmdWwgcmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgIHRvdHBVUkk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgIGlmIChvcHRpb25zPy5kaXNhYmxlKSB7XG4gICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcInRvdHAgaXNuJ3QgY29uZmlndXJlZC4gcGxlYXNlIHBhc3MgdG90cCBvcHRpb24gb24gdHdvIGZhY3RvciBwbHVnaW4gdG8gZW5hYmxlIHRvdHBcIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJ0b3RwIGlzbid0IGNvbmZpZ3VyZWRcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXI7XG4gICAgICBjb25zdCB0d29GYWN0b3IyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IHR3b0ZhY3RvclRhYmxlLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF0d29GYWN0b3IyIHx8ICF1c2VyLnR3b0ZhY3RvckVuYWJsZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuVE9UUF9OT1RfRU5BQkxFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlY3JldCA9IGF3YWl0IHN5bW1ldHJpY0RlY3J5cHQoe1xuICAgICAgICBrZXk6IGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgZGF0YTogdHdvRmFjdG9yMi5zZWNyZXRcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuY2hlY2tQYXNzd29yZCh1c2VyLmlkLCBjdHgpO1xuICAgICAgY29uc3QgdG90cFVSSSA9IGNyZWF0ZU9UUChzZWNyZXQsIHtcbiAgICAgICAgZGlnaXRzOiBvcHRzLmRpZ2l0cyxcbiAgICAgICAgcGVyaW9kOiBvcHRzLnBlcmlvZFxuICAgICAgfSkudXJsKG9wdGlvbnM/Lmlzc3VlciB8fCBjdHguY29udGV4dC5hcHBOYW1lLCB1c2VyLmVtYWlsKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdHBVUklcbiAgICAgIH07XG4gICAgfVxuICApO1xuICBjb25zdCB2ZXJpZnlUT1RQID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgIFwiL3R3by1mYWN0b3IvdmVyaWZ5LXRvdHBcIixcbiAgICB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICBjb2RlOiB6LnN0cmluZyh7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG90cCBjb2RlIHRvIHZlcmlmeVwiXG4gICAgICAgIH0pXG4gICAgICB9KSxcbiAgICAgIHVzZTogW3ZlcmlmeVR3b0ZhY3Rvck1pZGRsZXdhcmVdLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgIHN1bW1hcnk6IFwiVmVyaWZ5IHR3byBmYWN0b3IgVE9UUFwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmeSB0d28gZmFjdG9yIFRPVFBcIixcbiAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzZnVsIHJlc3BvbnNlXCIsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICBpZiAob3B0aW9ucz8uZGlzYWJsZSkge1xuICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJ0b3RwIGlzbid0IGNvbmZpZ3VyZWQuIHBsZWFzZSBwYXNzIHRvdHAgb3B0aW9uIG9uIHR3byBmYWN0b3IgcGx1Z2luIHRvIGVuYWJsZSB0b3RwXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwidG90cCBpc24ndCBjb25maWd1cmVkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgY29uc3QgdHdvRmFjdG9yMiA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdHdvRmFjdG9yMikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5UT1RQX05PVF9FTkFCTEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgc3ltbWV0cmljRGVjcnlwdCh7XG4gICAgICAgIGtleTogY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICBkYXRhOiB0d29GYWN0b3IyLnNlY3JldFxuICAgICAgfSk7XG4gICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCBjcmVhdGVPVFAoZGVjcnlwdGVkLCB7XG4gICAgICAgIHBlcmlvZDogb3B0cy5wZXJpb2QsXG4gICAgICAgIGRpZ2l0czogb3B0cy5kaWdpdHNcbiAgICAgIH0pLnZlcmlmeShjdHguYm9keS5jb2RlKTtcbiAgICAgIGlmICghc3RhdHVzKSB7XG4gICAgICAgIHJldHVybiBjdHguY29udGV4dC5pbnZhbGlkKCk7XG4gICAgICB9XG4gICAgICBpZiAoIXVzZXIudHdvRmFjdG9yRW5hYmxlZCkge1xuICAgICAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHdvRmFjdG9yRW5hYmxlZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgbmV3U2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgY3R4LnJlcXVlc3QsXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uXG4gICAgICAgICkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuXG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgc2Vzc2lvbjogbmV3U2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiB1cGRhdGVkVXNlclxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjdHguY29udGV4dC52YWxpZCgpO1xuICAgIH1cbiAgKTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ0b3RwXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBnZW5lcmF0ZVRPVFAsXG4gICAgICBnZXRUT1RQVVJJLFxuICAgICAgdmVyaWZ5VE9UUFxuICAgIH1cbiAgfTtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL3R3by1mYWN0b3Ivc2NoZW1hLnRzXG52YXIgc2NoZW1hID0ge1xuICB1c2VyOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICB0d29GYWN0b3JFbmFibGVkOiB7XG4gICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZmFsc2UsXG4gICAgICAgIGlucHV0OiBmYWxzZVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgdHdvRmFjdG9yOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICBzZWNyZXQ6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIHJldHVybmVkOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGJhY2t1cENvZGVzOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICByZXR1cm5lZDogZmFsc2VcbiAgICAgIH0sXG4gICAgICB1c2VySWQ6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIHJldHVybmVkOiBmYWxzZSxcbiAgICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG52YXIgdHdvRmFjdG9yID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3Qgb3B0cyA9IHtcbiAgICB0d29GYWN0b3JUYWJsZTogXCJ0d29GYWN0b3JcIlxuICB9O1xuICBjb25zdCB0b3RwID0gdG90cDJmYShvcHRpb25zPy50b3RwT3B0aW9ucyk7XG4gIGNvbnN0IGJhY2t1cENvZGUgPSBiYWNrdXBDb2RlMmZhKG9wdGlvbnM/LmJhY2t1cENvZGVPcHRpb25zKTtcbiAgY29uc3Qgb3RwID0gb3RwMmZhKG9wdGlvbnM/Lm90cE9wdGlvbnMpO1xuICByZXR1cm4ge1xuICAgIGlkOiBcInR3by1mYWN0b3JcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIC4uLnRvdHAuZW5kcG9pbnRzLFxuICAgICAgLi4ub3RwLmVuZHBvaW50cyxcbiAgICAgIC4uLmJhY2t1cENvZGUuZW5kcG9pbnRzLFxuICAgICAgZW5hYmxlVHdvRmFjdG9yOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3R3by1mYWN0b3IvZW5hYmxlXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgcGFzc3dvcmRcIlxuICAgICAgICAgICAgfSkubWluKDgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiRW5hYmxlIHR3byBmYWN0b3IgYXV0aGVudGljYXRpb25cIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHRoaXMgZW5kcG9pbnQgdG8gZW5hYmxlIHR3byBmYWN0b3IgYXV0aGVudGljYXRpb24uIFRoaXMgd2lsbCBnZW5lcmF0ZSBhIFRPVFAgVVJJIGFuZCBiYWNrdXAgY29kZXMuIE9uY2UgdGhlIHVzZXIgdmVyaWZpZXMgdGhlIFRPVFAgVVJJLCB0aGUgdHdvIGZhY3RvciBhdXRoZW50aWNhdGlvbiB3aWxsIGJlIGVuYWJsZWQuXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc2Z1bCByZXNwb25zZVwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG90cFVSSToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVE9UUCBVUklcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrdXBDb2Rlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQmFja3VwIGNvZGVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXI7XG4gICAgICAgICAgY29uc3QgeyBwYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgICAgICAgY29uc3QgaXNQYXNzd29yZFZhbGlkID0gYXdhaXQgdmFsaWRhdGVQYXNzd29yZChjdHgsIHtcbiAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgdXNlcklkOiB1c2VyLmlkXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFpc1Bhc3N3b3JkVmFsaWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1BBU1NXT1JEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2VjcmV0ID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIpO1xuICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZFNlY3JldCA9IGF3YWl0IHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgICAgICAgICAga2V5OiBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICBkYXRhOiBzZWNyZXRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCBiYWNrdXBDb2RlcyA9IGF3YWl0IGdlbmVyYXRlQmFja3VwQ29kZXMoXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICBvcHRpb25zPy5iYWNrdXBDb2RlT3B0aW9uc1xuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKG9wdGlvbnM/LnNraXBWZXJpZmljYXRpb25PbkVuYWJsZSkge1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR3b0ZhY3RvckVuYWJsZWQ6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgICAgdXBkYXRlZFVzZXIuaWQsXG4gICAgICAgICAgICAgIGN0eC5yZXF1ZXN0LFxuICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgICAgc2Vzc2lvbjogbmV3U2Vzc2lvbixcbiAgICAgICAgICAgICAgdXNlcjogdXBkYXRlZFVzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi50b2tlblxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRzLnR3b0ZhY3RvclRhYmxlLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmNyZWF0ZSh7XG4gICAgICAgICAgICBtb2RlbDogb3B0cy50d29GYWN0b3JUYWJsZSxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgc2VjcmV0OiBlbmNyeXB0ZWRTZWNyZXQsXG4gICAgICAgICAgICAgIGJhY2t1cENvZGVzOiBiYWNrdXBDb2Rlcy5lbmNyeXB0ZWRCYWNrdXBDb2RlcyxcbiAgICAgICAgICAgICAgdXNlcklkOiB1c2VyLmlkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgdG90cFVSSSA9IGNyZWF0ZU9UUChzZWNyZXQsIHtcbiAgICAgICAgICAgIGRpZ2l0czogb3B0aW9ucz8udG90cE9wdGlvbnM/LmRpZ2l0cyB8fCA2LFxuICAgICAgICAgICAgcGVyaW9kOiBvcHRpb25zPy50b3RwT3B0aW9ucz8ucGVyaW9kXG4gICAgICAgICAgfSkudXJsKG9wdGlvbnM/Lmlzc3VlciB8fCBjdHguY29udGV4dC5hcHBOYW1lLCB1c2VyLmVtYWlsKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oeyB0b3RwVVJJLCBiYWNrdXBDb2RlczogYmFja3VwQ29kZXMuYmFja3VwQ29kZXMgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBkaXNhYmxlVHdvRmFjdG9yOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3R3by1mYWN0b3IvZGlzYWJsZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBwYXNzd29yZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHBhc3N3b3JkXCJcbiAgICAgICAgICAgIH0pLm1pbig4KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkRpc2FibGUgdHdvIGZhY3RvciBhdXRoZW50aWNhdGlvblwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2UgdGhpcyBlbmRwb2ludCB0byBkaXNhYmxlIHR3byBmYWN0b3IgYXV0aGVudGljYXRpb24uXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc2Z1bCByZXNwb25zZVwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXI7XG4gICAgICAgICAgY29uc3QgeyBwYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgICAgICAgY29uc3QgaXNQYXNzd29yZFZhbGlkID0gYXdhaXQgdmFsaWRhdGVQYXNzd29yZChjdHgsIHtcbiAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgdXNlcklkOiB1c2VyLmlkXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFpc1Bhc3N3b3JkVmFsaWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIHBhc3N3b3JkXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdHdvRmFjdG9yRW5hYmxlZDogZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRzLnR3b0ZhY3RvclRhYmxlLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB1cGRhdGVkVXNlci5pZFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgbmV3U2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgdXBkYXRlZFVzZXIuaWQsXG4gICAgICAgICAgICBjdHgucmVxdWVzdCxcbiAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgc2Vzc2lvbjogbmV3U2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24udG9rZW5cbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7IHN0YXR1czogdHJ1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgb3B0aW9ucyxcbiAgICBob29rczoge1xuICAgICAgYWZ0ZXI6IFtcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXIoY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQucGF0aCA9PT0gXCIvc2lnbi1pbi9lbWFpbFwiIHx8IGNvbnRleHQucGF0aCA9PT0gXCIvc2lnbi1pbi91c2VybmFtZVwiIHx8IGNvbnRleHQucGF0aCA9PT0gXCIvc2lnbi1pbi9waG9uZS1udW1iZXJcIjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGhhbmRsZXI6IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBjdHguY29udGV4dC5uZXdTZXNzaW9uO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZGF0YT8udXNlci50d29GYWN0b3JFbmFibGVkKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRydXN0RGV2aWNlQ29va2llTmFtZSA9IGN0eC5jb250ZXh0LmNyZWF0ZUF1dGhDb29raWUoXG4gICAgICAgICAgICAgIFRSVVNUX0RFVklDRV9DT09LSUVfTkFNRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHRydXN0RGV2aWNlQ29va2llID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgICAgdHJ1c3REZXZpY2VDb29raWVOYW1lLm5hbWUsXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICh0cnVzdERldmljZUNvb2tpZSkge1xuICAgICAgICAgICAgICBjb25zdCBbdG9rZW4sIHNlc3Npb25Ub2tlbl0gPSB0cnVzdERldmljZUNvb2tpZS5zcGxpdChcIiFcIik7XG4gICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkVG9rZW4gPSBhd2FpdCBjcmVhdGVITUFDKFxuICAgICAgICAgICAgICAgIFwiU0hBLTI1NlwiLFxuICAgICAgICAgICAgICAgIFwiYmFzZTY0dXJsbm9wYWRcIlxuICAgICAgICAgICAgICApLnNpZ24oY3R4LmNvbnRleHQuc2VjcmV0LCBgJHtkYXRhLnVzZXIuaWR9ISR7c2Vzc2lvblRva2VufWApO1xuICAgICAgICAgICAgICBpZiAodG9rZW4gPT09IGV4cGVjdGVkVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdUb2tlbiA9IGF3YWl0IGNyZWF0ZUhNQUMoXG4gICAgICAgICAgICAgICAgICBcIlNIQS0yNTZcIixcbiAgICAgICAgICAgICAgICAgIFwiYmFzZTY0dXJsbm9wYWRcIlxuICAgICAgICAgICAgICAgICkuc2lnbihjdHguY29udGV4dC5zZWNyZXQsIGAke2RhdGEudXNlci5pZH0hJHtzZXNzaW9uVG9rZW59YCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgICAgICAgIHRydXN0RGV2aWNlQ29va2llTmFtZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgYCR7bmV3VG9rZW59ISR7ZGF0YS5zZXNzaW9uLnRva2VufWAsXG4gICAgICAgICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICAgICAgICB0cnVzdERldmljZUNvb2tpZU5hbWUuYXR0cmlidXRlc1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihkYXRhLnNlc3Npb24udG9rZW4pO1xuICAgICAgICAgICAgY29uc3QgdHdvRmFjdG9yQ29va2llID0gY3R4LmNvbnRleHQuY3JlYXRlQXV0aENvb2tpZShcbiAgICAgICAgICAgICAgVFdPX0ZBQ1RPUl9DT09LSUVfTkFNRSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG1heEFnZTogNjAgKiAxMFxuICAgICAgICAgICAgICAgIC8vIDEwIG1pbnV0ZXNcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICAgIHR3b0ZhY3RvckNvb2tpZS5uYW1lLFxuICAgICAgICAgICAgICBkYXRhLnVzZXIuaWQsXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgICAgdHdvRmFjdG9yQ29va2llLmF0dHJpYnV0ZXNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICB0d29GYWN0b3JSZWRpcmVjdDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0sXG4gICAgc2NoZW1hOiBtZXJnZVNjaGVtYShzY2hlbWEsIG9wdGlvbnM/LnNjaGVtYSksXG4gICAgcmF0ZUxpbWl0OiBbXG4gICAgICB7XG4gICAgICAgIHBhdGhNYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgICByZXR1cm4gcGF0aC5zdGFydHNXaXRoKFwiL3R3by1mYWN0b3IvXCIpO1xuICAgICAgICB9LFxuICAgICAgICB3aW5kb3c6IDEwLFxuICAgICAgICBtYXg6IDNcbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG5leHBvcnQgeyB0d29GYWN0b3IgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SocialProviderListEnum: () => (/* binding */ SocialProviderListEnum),\n/* harmony export */   apple: () => (/* binding */ apple),\n/* harmony export */   discord: () => (/* binding */ discord),\n/* harmony export */   dropbox: () => (/* binding */ dropbox),\n/* harmony export */   facebook: () => (/* binding */ facebook),\n/* harmony export */   getApplePublicKey: () => (/* binding */ getApplePublicKey),\n/* harmony export */   github: () => (/* binding */ github),\n/* harmony export */   gitlab: () => (/* binding */ gitlab),\n/* harmony export */   google: () => (/* binding */ google),\n/* harmony export */   linkedin: () => (/* binding */ linkedin),\n/* harmony export */   microsoft: () => (/* binding */ microsoft),\n/* harmony export */   reddit: () => (/* binding */ reddit),\n/* harmony export */   socialProviderList: () => (/* binding */ socialProviderList),\n/* harmony export */   socialProviders: () => (/* binding */ socialProviders),\n/* harmony export */   spotify: () => (/* binding */ spotify),\n/* harmony export */   twitch: () => (/* binding */ twitch),\n/* harmony export */   twitter: () => (/* binding */ twitter)\n/* harmony export */ });\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-fetch/fetch */ \"(action-browser)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/decode_protected_header.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/decode_jwt.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwks/remote.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\nvar apple = (options) => {\n  const tokenEndpoint = \"https://appleid.apple.com/auth/token\";\n  return {\n    id: \"apple\",\n    name: \"Apple\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scope = scopes || [\"email\", \"name\"];\n      options.scope && _scope.push(...options.scope);\n      return new URL(\n        `https://appleid.apple.com/auth/authorize?client_id=${options.clientId}&response_type=code&redirect_uri=${options.redirectURI || redirectURI}&scope=${_scope.join(\" \")}&state=${state}&response_mode=form_post`\n      );\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_6__.decodeProtectedHeader)(token);\n      const { kid, alg: jwtAlg } = decodedHeader;\n      if (!kid || !jwtAlg) return false;\n      const publicKey = await getApplePublicKey(kid);\n      const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_7__.jwtVerify)(token, publicKey, {\n        algorithms: [jwtAlg],\n        issuer: \"https://appleid.apple.com\",\n        audience: options.appBundleIdentifier || options.clientId,\n        maxTokenAge: \"1h\"\n      });\n      [\"email_verified\", \"is_private_email\"].forEach((field) => {\n        if (jwtClaims[field] !== void 0) {\n          jwtClaims[field] = Boolean(jwtClaims[field]);\n        }\n      });\n      if (nonce && jwtClaims.nonce !== nonce) {\n        return false;\n      }\n      return !!jwtClaims;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n      if (!profile) {\n        return null;\n      }\n      const name = profile.user ? `${profile.user.name.firstName} ${profile.user.name.lastName}` : profile.email;\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name,\n          emailVerified: false,\n          email: profile.email,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar getApplePublicKey = async (kid) => {\n  const APPLE_BASE_URL = \"https://appleid.apple.com\";\n  const JWKS_APPLE_URI = \"/auth/keys\";\n  const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(`${APPLE_BASE_URL}${JWKS_APPLE_URI}`);\n  if (!data?.keys) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_4__.APIError(\"BAD_REQUEST\", {\n      message: \"Keys not found\"\n    });\n  }\n  const jwk = data.keys.find((key) => key.kid === kid);\n  if (!jwk) {\n    throw new Error(`JWK with kid ${kid} not found`);\n  }\n  return await (0,jose__WEBPACK_IMPORTED_MODULE_9__.importJWK)(jwk, jwk.alg);\n};\nvar discord = (options) => {\n  return {\n    id: \"discord\",\n    name: \"Discord\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"identify\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      return new URL(\n        `https://discord.com/api/oauth2/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"none\"}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://discord.com/api/users/@me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (profile.avatar === null) {\n        const defaultAvatarNumber = profile.discriminator === \"0\" ? Number(BigInt(profile.id) >> BigInt(22)) % 6 : parseInt(profile.discriminator) % 5;\n        profile.image_url = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarNumber}.png`;\n      } else {\n        const format = profile.avatar.startsWith(\"a_\") ? \"gif\" : \"png\";\n        profile.image_url = `https://cdn.discordapp.com/avatars/${profile.id}/${profile.avatar}.${format}`;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name || profile.username || \"\",\n          email: profile.email,\n          emailVerified: profile.verified,\n          image: profile.image_url,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar facebook = (options) => {\n  return {\n    id: \"facebook\",\n    name: \"Facebook\",\n    async createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"email\", \"public_profile\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"facebook\",\n        options,\n        authorizationEndpoint: \"https://www.facebook.com/v21.0/dialog/oauth\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://graph.facebook.com/oauth/access_token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      if (token.split(\".\").length) {\n        try {\n          const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_7__.jwtVerify)(\n            token,\n            (0,jose__WEBPACK_IMPORTED_MODULE_10__.createRemoteJWKSet)(\n              new URL(\"https://www.facebook.com/.well-known/oauth/openid/jwks\")\n            ),\n            {\n              algorithms: [\"RS256\"],\n              audience: options.clientId,\n              issuer: \"https://www.facebook.com\"\n            }\n          );\n          if (nonce && jwtClaims.nonce !== nonce) {\n            return false;\n          }\n          return !!jwtClaims;\n        } catch (error) {\n          return false;\n        }\n      }\n      return true;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken) {\n        const profile2 = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n        const user = {\n          id: profile2.sub,\n          name: profile2.name,\n          email: profile2.email,\n          picture: {\n            data: {\n              url: profile2.picture,\n              height: 100,\n              width: 100,\n              is_silhouette: false\n            }\n          }\n        };\n        const userMap2 = await options.mapProfileToUser?.({\n          ...user,\n          email_verified: true\n        });\n        return {\n          user: {\n            ...user,\n            emailVerified: true,\n            ...userMap2\n          },\n          data: profile2\n        };\n      }\n      const fields = [\n        \"id\",\n        \"name\",\n        \"email\",\n        \"picture\",\n        ...options?.fields || []\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://graph.facebook.com/me?fields=\" + fields.join(\",\"),\n        {\n          auth: {\n            type: \"Bearer\",\n            token: token.accessToken\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.picture.data.url,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar github = (options) => {\n  const tokenEndpoint = \"https://github.com/login/oauth/access_token\";\n  return {\n    id: \"github\",\n    name: \"GitHub\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = scopes || [\"read:user\", \"user:email\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"github\",\n        options,\n        authorizationEndpoint: \"https://github.com/login/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.github.com/user\",\n        {\n          headers: {\n            \"User-Agent\": \"better-auth\",\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      let emailVerified = false;\n      if (!profile.email) {\n        const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\"https://api.github.com/user/emails\", {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        });\n        if (data) {\n          profile.email = (data.find((e) => e.primary) ?? data[0])?.email;\n          emailVerified = data.find((e) => e.email === profile.email)?.verified ?? false;\n        }\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id.toString(),\n          name: profile.name || profile.login,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar google = (options) => {\n  return {\n    id: \"google\",\n    name: \"Google\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.error(\n          \"Client Id and Client Secret is required for Google. Make sure to provide them in the options.\"\n        );\n        throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_2__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_2__.BetterAuthError(\"codeVerifier is required for Google\");\n      }\n      const _scopes = scopes || [\"email\", \"profile\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      const url = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"google\",\n        options,\n        authorizationEndpoint: \"https://accounts.google.com/o/oauth2/auth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n      options.accessType && url.searchParams.set(\"access_type\", options.accessType);\n      options.prompt && url.searchParams.set(\"prompt\", options.prompt);\n      options.display && url.searchParams.set(\"display\", options.display);\n      options.hd && url.searchParams.set(\"hd\", options.hd);\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://oauth2.googleapis.com/token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const googlePublicKeyUrl = `https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${token}`;\n      const { data: tokenInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(googlePublicKeyUrl);\n      if (!tokenInfo) {\n        return false;\n      }\n      const isValid = tokenInfo.aud === options.clientId && (tokenInfo.iss === \"https://accounts.google.com\" || tokenInfo.iss === \"accounts.google.com\");\n      return isValid;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: user.email_verified,\n          ...userMap\n        },\n        data: user\n      };\n    }\n  };\n};\nvar microsoft = (options) => {\n  const tenant = options.tenantId || \"common\";\n  const authorizationEndpoint = `https://login.microsoftonline.com/${tenant}/oauth2/v2.0/authorize`;\n  const tokenEndpoint = `https://login.microsoftonline.com/${tenant}/oauth2/v2.0/token`;\n  return {\n    id: \"microsoft\",\n    name: \"Microsoft EntraID\",\n    createAuthorizationURL(data) {\n      const scopes = data.scopes || [\"openid\", \"profile\", \"email\", \"User.Read\"];\n      options.scope && scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"microsoft\",\n        options,\n        authorizationEndpoint,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        scopes,\n        redirectURI: data.redirectURI,\n        prompt: options.requireSelectAccount || false\n      });\n    },\n    validateAuthorizationCode({ code, codeVerifier, redirectURI }) {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n      const profilePhotoSize = options.profilePhotoSize || 48;\n      await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        `https://graph.microsoft.com/v1.0/me/photos/${profilePhotoSize}x${profilePhotoSize}/$value`,\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          async onResponse(context) {\n            if (options.disableProfilePhoto || !context.response.ok) {\n              return;\n            }\n            try {\n              const response = context.response.clone();\n              const pictureBuffer = await response.arrayBuffer();\n              const pictureBase64 = Buffer.from(pictureBuffer).toString(\"base64\");\n              user.picture = `data:image/jpeg;base64, ${pictureBase64}`;\n            } catch (e) {\n              _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.error(\n                e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n                e\n              );\n            }\n          }\n        }\n      );\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: user\n      };\n    }\n  };\n};\nvar spotify = (options) => {\n  return {\n    id: \"spotify\",\n    name: \"Spotify\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = scopes || [\"user-read-email\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"spotify\",\n        options,\n        authorizationEndpoint: \"https://accounts.spotify.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.spotify.com/v1/me\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          email: profile.email,\n          image: profile.images[0]?.url,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar twitch = (options) => {\n  return {\n    id: \"twitch\",\n    name: \"Twitch\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"user:read:email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"twitch\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.twitch.tv/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        claims: options.claims || [\n          \"email\",\n          \"email_verified\",\n          \"preferred_username\",\n          \"picture\"\n        ]\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const idToken = token.idToken;\n      if (!idToken) {\n        _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"No idToken found in token\");\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(idToken);\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar twitter = (options) => {\n  return {\n    id: \"twitter\",\n    name: \"Twitter\",\n    createAuthorizationURL(data) {\n      const _scopes = data.scopes || [\n        \"users.read\",\n        \"tweet.read\",\n        \"offline.access\"\n      ];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"twitter\",\n        options,\n        authorizationEndpoint: \"https://x.com/i/oauth2/authorize\",\n        scopes: _scopes,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        redirectURI: data.redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        authentication: \"basic\",\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.x.com/2/users/me?user.fields=profile_image_url\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.data.id,\n          name: profile.data.name,\n          email: profile.data.username || null,\n          image: profile.data.profile_image_url,\n          emailVerified: profile.data.verified || false,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar dropbox = (options) => {\n  const tokenEndpoint = \"https://api.dropboxapi.com/oauth2/token\";\n  return {\n    id: \"dropbox\",\n    name: \"Dropbox\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = scopes || [\"account_info.read\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"dropbox\",\n        options,\n        authorizationEndpoint: \"https://www.dropbox.com/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.dropboxapi.com/2/users/get_current_account\",\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.account_id,\n          name: profile.name?.display_name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.profile_photo_url,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar linkedin = (options) => {\n  const authorizationEndpoint = \"https://www.linkedin.com/oauth/v2/authorization\";\n  const tokenEndpoint = \"https://www.linkedin.com/oauth/v2/accessToken\";\n  return {\n    id: \"linkedin\",\n    name: \"Linkedin\",\n    createAuthorizationURL: async ({ state, scopes, redirectURI }) => {\n      const _scopes = scopes || [\"profile\", \"email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"linkedin\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.linkedin.com/v2/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.picture,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar cleanDoubleSlashes = (input = \"\") => {\n  return input.split(\"://\").map((str) => str.replace(/\\/{2,}/g, \"/\")).join(\"://\");\n};\nvar issuerToEndpoints = (issuer) => {\n  let baseUrl = issuer || \"https://gitlab.com\";\n  return {\n    authorizationEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/authorize`),\n    tokenEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/token`),\n    userinfoEndpoint: cleanDoubleSlashes(`${baseUrl}/api/v4/user`)\n  };\n};\nvar gitlab = (options) => {\n  const { authorizationEndpoint, tokenEndpoint, userinfoEndpoint } = issuerToEndpoints(options.issuer);\n  const issuerId = \"gitlab\";\n  const issuerName = \"Gitlab\";\n  return {\n    id: issuerId,\n    name: issuerName,\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = scopes || [\"read_user\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: issuerId,\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        codeVerifier,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        userinfoEndpoint,\n        { headers: { authorization: `Bearer ${token.accessToken}` } }\n      );\n      if (error || profile.state !== \"active\" || profile.locked) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id.toString(),\n          name: profile.name ?? profile.username,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar reddit = (options) => {\n  return {\n    id: \"reddit\",\n    name: \"Reddit\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"identity\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"reddit\",\n        options,\n        authorizationEndpoint: \"https://www.reddit.com/api/v1/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        duration: options.duration\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const body = new URLSearchParams({\n        grant_type: \"authorization_code\",\n        code,\n        redirect_uri: options.redirectURI || redirectURI\n      });\n      const headers = {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        accept: \"text/plain\",\n        \"user-agent\": \"better-auth\",\n        Authorization: `Basic ${Buffer.from(\n          `${options.clientId}:${options.clientSecret}`\n        ).toString(\"base64\")}`\n      };\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://www.reddit.com/api/v1/access_token\",\n        {\n          method: \"POST\",\n          headers,\n          body: body.toString()\n        }\n      );\n      if (error) {\n        throw error;\n      }\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.getOAuth2Tokens)(data);\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://oauth.reddit.com/api/v1/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.oauth_client_id,\n          emailVerified: profile.has_verified_email,\n          image: profile.icon_img?.split(\"?\")[0],\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar socialProviders = {\n  apple,\n  discord,\n  facebook,\n  github,\n  microsoft,\n  google,\n  spotify,\n  twitch,\n  twitter,\n  dropbox,\n  linkedin,\n  gitlab,\n  reddit\n};\nvar socialProviderList = Object.keys(socialProviders);\nvar SocialProviderListEnum = zod__WEBPACK_IMPORTED_MODULE_5__.z[\"enum\"](socialProviderList, {\n  description: \"OAuth2 provider to use\"\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVlhEWU5DT1guanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF5RztBQUM1RDtBQUNTO0FBQ0o7QUFDWDtBQUMyRDtBQUMxRTs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw0QkFBNEI7QUFDekQ7QUFDQTtBQUNBO0FBQ0EsOERBQThELGlCQUFpQixtQ0FBbUMsbUNBQW1DLFNBQVMsaUJBQWlCLFNBQVMsTUFBTTtBQUM5TDtBQUNBLEtBQUs7QUFDTCx3Q0FBd0MsaUNBQWlDO0FBQ3pFLGFBQWEsNkVBQXlCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDJEQUFxQjtBQUNqRCxjQUFjLG1CQUFtQjtBQUNqQztBQUNBO0FBQ0EsY0FBYyxxQkFBcUIsUUFBUSwrQ0FBUztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwrQ0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsNkJBQTZCLEVBQUUsMkJBQTJCO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsT0FBTyxRQUFRLGdFQUFXLElBQUksZUFBZSxFQUFFLGVBQWU7QUFDeEU7QUFDQSxjQUFjLGlEQUFRO0FBQ3RCO0FBQ0EsS0FB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Z2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVlhEWU5DT1guanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSwgY3JlYXRlQXV0aG9yaXphdGlvblVSTCwgZ2V0T0F1dGgyVG9rZW5zIH0gZnJvbSAnLi9jaHVuay1HVFFNN0pVNy5qcyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuL2NodW5rLUtMREZCTFlMLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vY2h1bmstVU5XQ1hLTVAuanMnO1xuaW1wb3J0IHsgYmV0dGVyRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgZGVjb2RlUHJvdGVjdGVkSGVhZGVyLCBqd3RWZXJpZnksIGRlY29kZUp3dCwgaW1wb3J0SldLLCBjcmVhdGVSZW1vdGVKV0tTZXQgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG52YXIgYXBwbGUgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tL2F1dGgvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJhcHBsZVwiLFxuICAgIG5hbWU6IFwiQXBwbGVcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlID0gc2NvcGVzIHx8IFtcImVtYWlsXCIsIFwibmFtZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3BlLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gbmV3IFVSTChcbiAgICAgICAgYGh0dHBzOi8vYXBwbGVpZC5hcHBsZS5jb20vYXV0aC9hdXRob3JpemU/Y2xpZW50X2lkPSR7b3B0aW9ucy5jbGllbnRJZH0mcmVzcG9uc2VfdHlwZT1jb2RlJnJlZGlyZWN0X3VyaT0ke29wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkl9JnNjb3BlPSR7X3Njb3BlLmpvaW4oXCIgXCIpfSZzdGF0ZT0ke3N0YXRlfSZyZXNwb25zZV9tb2RlPWZvcm1fcG9zdGBcbiAgICAgICk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyB2ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSkge1xuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUlkVG9rZW5TaWduSW4pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICB9XG4gICAgICBjb25zdCBkZWNvZGVkSGVhZGVyID0gZGVjb2RlUHJvdGVjdGVkSGVhZGVyKHRva2VuKTtcbiAgICAgIGNvbnN0IHsga2lkLCBhbGc6IGp3dEFsZyB9ID0gZGVjb2RlZEhlYWRlcjtcbiAgICAgIGlmICgha2lkIHx8ICFqd3RBbGcpIHJldHVybiBmYWxzZTtcbiAgICAgIGNvbnN0IHB1YmxpY0tleSA9IGF3YWl0IGdldEFwcGxlUHVibGljS2V5KGtpZCk7XG4gICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBwdWJsaWNLZXksIHtcbiAgICAgICAgYWxnb3JpdGhtczogW2p3dEFsZ10sXG4gICAgICAgIGlzc3VlcjogXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tXCIsXG4gICAgICAgIGF1ZGllbmNlOiBvcHRpb25zLmFwcEJ1bmRsZUlkZW50aWZpZXIgfHwgb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgbWF4VG9rZW5BZ2U6IFwiMWhcIlxuICAgICAgfSk7XG4gICAgICBbXCJlbWFpbF92ZXJpZmllZFwiLCBcImlzX3ByaXZhdGVfZW1haWxcIl0uZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgICAgaWYgKGp3dENsYWltc1tmaWVsZF0gIT09IHZvaWQgMCkge1xuICAgICAgICAgIGp3dENsYWltc1tmaWVsZF0gPSBCb29sZWFuKGp3dENsYWltc1tmaWVsZF0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChub25jZSAmJiBqd3RDbGFpbXMubm9uY2UgIT09IG5vbmNlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAhIWp3dENsYWltcztcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBpZiAoIXRva2VuLmlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maWxlID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgbmFtZSA9IHByb2ZpbGUudXNlciA/IGAke3Byb2ZpbGUudXNlci5uYW1lLmZpcnN0TmFtZX0gJHtwcm9maWxlLnVzZXIubmFtZS5sYXN0TmFtZX1gIDogcHJvZmlsZS5lbWFpbDtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBnZXRBcHBsZVB1YmxpY0tleSA9IGFzeW5jIChraWQpID0+IHtcbiAgY29uc3QgQVBQTEVfQkFTRV9VUkwgPSBcImh0dHBzOi8vYXBwbGVpZC5hcHBsZS5jb21cIjtcbiAgY29uc3QgSldLU19BUFBMRV9VUkkgPSBcIi9hdXRoL2tleXNcIjtcbiAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChgJHtBUFBMRV9CQVNFX1VSTH0ke0pXS1NfQVBQTEVfVVJJfWApO1xuICBpZiAoIWRhdGE/LmtleXMpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIktleXMgbm90IGZvdW5kXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBqd2sgPSBkYXRhLmtleXMuZmluZCgoa2V5KSA9PiBrZXkua2lkID09PSBraWQpO1xuICBpZiAoIWp3aykge1xuICAgIHRocm93IG5ldyBFcnJvcihgSldLIHdpdGgga2lkICR7a2lkfSBub3QgZm91bmRgKTtcbiAgfVxuICByZXR1cm4gYXdhaXQgaW1wb3J0SldLKGp3aywgandrLmFsZyk7XG59O1xudmFyIGRpc2NvcmQgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImRpc2NvcmRcIixcbiAgICBuYW1lOiBcIkRpc2NvcmRcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJpZGVudGlmeVwiLCBcImVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gbmV3IFVSTChcbiAgICAgICAgYGh0dHBzOi8vZGlzY29yZC5jb20vYXBpL29hdXRoMi9hdXRob3JpemU/c2NvcGU9JHtfc2NvcGVzLmpvaW4oXG4gICAgICAgICAgXCIrXCJcbiAgICAgICAgKX0mcmVzcG9uc2VfdHlwZT1jb2RlJmNsaWVudF9pZD0ke29wdGlvbnMuY2xpZW50SWR9JnJlZGlyZWN0X3VyaT0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJXG4gICAgICAgICl9JnN0YXRlPSR7c3RhdGV9JnByb21wdD0ke29wdGlvbnMucHJvbXB0IHx8IFwibm9uZVwifWBcbiAgICAgICk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS91c2Vycy9AbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHByb2ZpbGUuYXZhdGFyID09PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRBdmF0YXJOdW1iZXIgPSBwcm9maWxlLmRpc2NyaW1pbmF0b3IgPT09IFwiMFwiID8gTnVtYmVyKEJpZ0ludChwcm9maWxlLmlkKSA+PiBCaWdJbnQoMjIpKSAlIDYgOiBwYXJzZUludChwcm9maWxlLmRpc2NyaW1pbmF0b3IpICUgNTtcbiAgICAgICAgcHJvZmlsZS5pbWFnZV91cmwgPSBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vZW1iZWQvYXZhdGFycy8ke2RlZmF1bHRBdmF0YXJOdW1iZXJ9LnBuZ2A7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmb3JtYXQgPSBwcm9maWxlLmF2YXRhci5zdGFydHNXaXRoKFwiYV9cIikgPyBcImdpZlwiIDogXCJwbmdcIjtcbiAgICAgICAgcHJvZmlsZS5pbWFnZV91cmwgPSBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXZhdGFycy8ke3Byb2ZpbGUuaWR9LyR7cHJvZmlsZS5hdmF0YXJ9LiR7Zm9ybWF0fWA7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kaXNwbGF5X25hbWUgfHwgcHJvZmlsZS51c2VybmFtZSB8fCBcIlwiLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUudmVyaWZpZWQsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaW1hZ2VfdXJsLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIGZhY2Vib29rID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJmYWNlYm9va1wiLFxuICAgIG5hbWU6IFwiRmFjZWJvb2tcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJlbWFpbFwiLCBcInB1YmxpY19wcm9maWxlXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImZhY2Vib29rXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vdjIxLjAvZGlhbG9nL29hdXRoXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vb2F1dGgvYWNjZXNzX3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLnNwbGl0KFwiLlwiKS5sZW5ndGgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KFxuICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICBjcmVhdGVSZW1vdGVKV0tTZXQoXG4gICAgICAgICAgICAgIG5ldyBVUkwoXCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vLndlbGwta25vd24vb2F1dGgvb3BlbmlkL2p3a3NcIilcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGFsZ29yaXRobXM6IFtcIlJTMjU2XCJdLFxuICAgICAgICAgICAgICBhdWRpZW5jZTogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICAgICAgaXNzdWVyOiBcImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbVwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAobm9uY2UgJiYgand0Q2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gISFqd3RDbGFpbXM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBpZiAodG9rZW4uaWRUb2tlbikge1xuICAgICAgICBjb25zdCBwcm9maWxlMiA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgICAgY29uc3QgdXNlciA9IHtcbiAgICAgICAgICBpZDogcHJvZmlsZTIuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUyLmVtYWlsLFxuICAgICAgICAgIHBpY3R1cmU6IHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgdXJsOiBwcm9maWxlMi5waWN0dXJlLFxuICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCxcbiAgICAgICAgICAgICAgd2lkdGg6IDEwMCxcbiAgICAgICAgICAgICAgaXNfc2lsaG91ZXR0ZTogZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHVzZXJNYXAyID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4oe1xuICAgICAgICAgIC4uLnVzZXIsXG4gICAgICAgICAgZW1haWxfdmVyaWZpZWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4udXNlcixcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgICAuLi51c2VyTWFwMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YTogcHJvZmlsZTJcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpZWxkcyA9IFtcbiAgICAgICAgXCJpZFwiLFxuICAgICAgICBcIm5hbWVcIixcbiAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICBcInBpY3R1cmVcIixcbiAgICAgICAgLi4ub3B0aW9ucz8uZmllbGRzIHx8IFtdXG4gICAgICBdO1xuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWU/ZmllbGRzPVwiICsgZmllbGRzLmpvaW4oXCIsXCIpLFxuICAgICAgICB7XG4gICAgICAgICAgYXV0aDoge1xuICAgICAgICAgICAgdHlwZTogXCJCZWFyZXJcIixcbiAgICAgICAgICAgIHRva2VuOiB0b2tlbi5hY2Nlc3NUb2tlblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZS5kYXRhLnVybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIGdpdGh1YiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hY2Nlc3NfdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnaXRodWJcIixcbiAgICBuYW1lOiBcIkdpdEh1YlwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1wicmVhZDp1c2VyXCIsIFwidXNlcjplbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJnaXRodWJcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIlVzZXItQWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiLFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBsZXQgZW1haWxWZXJpZmllZCA9IGZhbHNlO1xuICAgICAgaWYgKCFwcm9maWxlLmVtYWlsKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXIvZW1haWxzXCIsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAgIFwiVXNlci1BZ2VudFwiOiBcImJldHRlci1hdXRoXCJcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgIHByb2ZpbGUuZW1haWwgPSAoZGF0YS5maW5kKChlKSA9PiBlLnByaW1hcnkpID8/IGRhdGFbMF0pPy5lbWFpbDtcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkID0gZGF0YS5maW5kKChlKSA9PiBlLmVtYWlsID09PSBwcm9maWxlLmVtYWlsKT8udmVyaWZpZWQgPz8gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZC50b1N0cmluZygpLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSB8fCBwcm9maWxlLmxvZ2luLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmF2YXRhcl91cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBnb29nbGUgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImdvb2dsZVwiLFxuICAgIG5hbWU6IFwiR29vZ2xlXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNsaWVudElkIHx8ICFvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnQgSWQgYW5kIENsaWVudCBTZWNyZXQgaXMgcmVxdWlyZWQgZm9yIEdvb2dsZS4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgdGhlbSBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBpZiAoIWNvZGVWZXJpZmllcikge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiY29kZVZlcmlmaWVyIGlzIHJlcXVpcmVkIGZvciBHb29nbGVcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gc2NvcGVzIHx8IFtcImVtYWlsXCIsIFwicHJvZmlsZVwiLCBcIm9wZW5pZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgY29uc3QgdXJsID0gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImdvb2dsZVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGhcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgICBvcHRpb25zLmFjY2Vzc1R5cGUgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJhY2Nlc3NfdHlwZVwiLCBvcHRpb25zLmFjY2Vzc1R5cGUpO1xuICAgICAgb3B0aW9ucy5wcm9tcHQgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJwcm9tcHRcIiwgb3B0aW9ucy5wcm9tcHQpO1xuICAgICAgb3B0aW9ucy5kaXNwbGF5ICYmIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiZGlzcGxheVwiLCBvcHRpb25zLmRpc3BsYXkpO1xuICAgICAgb3B0aW9ucy5oZCAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImhkXCIsIG9wdGlvbnMuaGQpO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgY29uc3QgZ29vZ2xlUHVibGljS2V5VXJsID0gYGh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92My90b2tlbmluZm8/aWRfdG9rZW49JHt0b2tlbn1gO1xuICAgICAgY29uc3QgeyBkYXRhOiB0b2tlbkluZm8gfSA9IGF3YWl0IGJldHRlckZldGNoKGdvb2dsZVB1YmxpY0tleVVybCk7XG4gICAgICBpZiAoIXRva2VuSW5mbykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjb25zdCBpc1ZhbGlkID0gdG9rZW5JbmZvLmF1ZCA9PT0gb3B0aW9ucy5jbGllbnRJZCAmJiAodG9rZW5JbmZvLmlzcyA9PT0gXCJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb21cIiB8fCB0b2tlbkluZm8uaXNzID09PSBcImFjY291bnRzLmdvb2dsZS5jb21cIik7XG4gICAgICByZXR1cm4gaXNWYWxpZDtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBpZiAoIXRva2VuLmlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLnN1YixcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIucGljdHVyZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogdXNlclxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIG1pY3Jvc29mdCA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRlbmFudCA9IG9wdGlvbnMudGVuYW50SWQgfHwgXCJjb21tb25cIjtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gYGh0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS8ke3RlbmFudH0vb2F1dGgyL3YyLjAvYXV0aG9yaXplYDtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IGBodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vJHt0ZW5hbnR9L29hdXRoMi92Mi4wL3Rva2VuYDtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJtaWNyb3NvZnRcIixcbiAgICBuYW1lOiBcIk1pY3Jvc29mdCBFbnRyYUlEXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTChkYXRhKSB7XG4gICAgICBjb25zdCBzY29wZXMgPSBkYXRhLnNjb3BlcyB8fCBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIiwgXCJVc2VyLlJlYWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIHNjb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJtaWNyb3NvZnRcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzdGF0ZTogZGF0YS5zdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyOiBkYXRhLmNvZGVWZXJpZmllcixcbiAgICAgICAgc2NvcGVzLFxuICAgICAgICByZWRpcmVjdFVSSTogZGF0YS5yZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnJlcXVpcmVTZWxlY3RBY2NvdW50IHx8IGZhbHNlXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGNvbnN0IHByb2ZpbGVQaG90b1NpemUgPSBvcHRpb25zLnByb2ZpbGVQaG90b1NpemUgfHwgNDg7XG4gICAgICBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgYGh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wL21lL3Bob3Rvcy8ke3Byb2ZpbGVQaG90b1NpemV9eCR7cHJvZmlsZVBob3RvU2l6ZX0vJHZhbHVlYCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBvblJlc3BvbnNlKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQcm9maWxlUGhvdG8gfHwgIWNvbnRleHQucmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb250ZXh0LnJlc3BvbnNlLmNsb25lKCk7XG4gICAgICAgICAgICAgIGNvbnN0IHBpY3R1cmVCdWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpO1xuICAgICAgICAgICAgICBjb25zdCBwaWN0dXJlQmFzZTY0ID0gQnVmZmVyLmZyb20ocGljdHVyZUJ1ZmZlcikudG9TdHJpbmcoXCJiYXNlNjRcIik7XG4gICAgICAgICAgICAgIHVzZXIucGljdHVyZSA9IGBkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCAke3BpY3R1cmVCYXNlNjR9YDtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICAgIGUgJiYgdHlwZW9mIGUgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZSA/IGUubmFtZSA6IFwiXCIsXG4gICAgICAgICAgICAgICAgZVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5zdWIsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBzcG90aWZ5ID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJzcG90aWZ5XCIsXG4gICAgbmFtZTogXCJTcG90aWZ5XCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJ1c2VyLXJlYWQtZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwic3BvdGlmeVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hY2NvdW50cy5zcG90aWZ5LmNvbS9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2FwaS90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5zcG90aWZ5LmNvbS92MS9tZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGlzcGxheV9uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmltYWdlc1swXT8udXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIHR3aXRjaCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidHdpdGNoXCIsXG4gICAgbmFtZTogXCJUd2l0Y2hcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJ1c2VyOnJlYWQ6ZW1haWxcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwidHdpdGNoXCIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC50d2l0Y2gudHYvb2F1dGgyL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjbGFpbXM6IG9wdGlvbnMuY2xhaW1zIHx8IFtcbiAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgXCJlbWFpbF92ZXJpZmllZFwiLFxuICAgICAgICAgIFwicHJlZmVycmVkX3VzZXJuYW1lXCIsXG4gICAgICAgICAgXCJwaWN0dXJlXCJcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudHdpdGNoLnR2L29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCBpZFRva2VuID0gdG9rZW4uaWRUb2tlbjtcbiAgICAgIGlmICghaWRUb2tlbikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJObyBpZFRva2VuIGZvdW5kIGluIHRva2VuXCIpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBkZWNvZGVKd3QoaWRUb2tlbik7XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUucHJlZmVycmVkX3VzZXJuYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgdHdpdHRlciA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidHdpdHRlclwiLFxuICAgIG5hbWU6IFwiVHdpdHRlclwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IGRhdGEuc2NvcGVzIHx8IFtcbiAgICAgICAgXCJ1c2Vycy5yZWFkXCIsXG4gICAgICAgIFwidHdlZXQucmVhZFwiLFxuICAgICAgICBcIm9mZmxpbmUuYWNjZXNzXCJcbiAgICAgIF07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwidHdpdHRlclwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly94LmNvbS9pL29hdXRoMi9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZTogZGF0YS5zdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyOiBkYXRhLmNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkk6IGRhdGEucmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwiYmFzaWNcIixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcGkueC5jb20vMi9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkueC5jb20vMi91c2Vycy9tZT91c2VyLmZpZWxkcz1wcm9maWxlX2ltYWdlX3VybFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmRhdGEuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kYXRhLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZGF0YS51c2VybmFtZSB8fCBudWxsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmRhdGEucHJvZmlsZV9pbWFnZV91cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5kYXRhLnZlcmlmaWVkIHx8IGZhbHNlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIGRyb3Bib3ggPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5kcm9wYm94YXBpLmNvbS9vYXV0aDIvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJkcm9wYm94XCIsXG4gICAgbmFtZTogXCJEcm9wYm94XCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTDogYXN5bmMgKHtcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcGVzLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUklcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gc2NvcGVzIHx8IFtcImFjY291bnRfaW5mby5yZWFkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImRyb3Bib3hcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmRyb3Bib3guY29tL29hdXRoMi9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGNvZGVWZXJpZmllclxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vMi91c2Vycy9nZXRfY3VycmVudF9hY2NvdW50XCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmFjY291bnRfaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lPy5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCB8fCBmYWxzZSxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5wcm9maWxlX3Bob3RvX3VybCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBsaW5rZWRpbiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IFwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL29hdXRoL3YyL2F1dGhvcml6YXRpb25cIjtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL29hdXRoL3YyL2FjY2Vzc1Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibGlua2VkaW5cIixcbiAgICBuYW1lOiBcIkxpbmtlZGluXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTDogYXN5bmMgKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJwcm9maWxlXCIsIFwiZW1haWxcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibGlua2VkaW5cIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5saW5rZWRpbi5jb20vdjIvdXNlcmluZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgfHwgZmFsc2UsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBjbGVhbkRvdWJsZVNsYXNoZXMgPSAoaW5wdXQgPSBcIlwiKSA9PiB7XG4gIHJldHVybiBpbnB1dC5zcGxpdChcIjovL1wiKS5tYXAoKHN0cikgPT4gc3RyLnJlcGxhY2UoL1xcL3syLH0vZywgXCIvXCIpKS5qb2luKFwiOi8vXCIpO1xufTtcbnZhciBpc3N1ZXJUb0VuZHBvaW50cyA9IChpc3N1ZXIpID0+IHtcbiAgbGV0IGJhc2VVcmwgPSBpc3N1ZXIgfHwgXCJodHRwczovL2dpdGxhYi5jb21cIjtcbiAgcmV0dXJuIHtcbiAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IGNsZWFuRG91YmxlU2xhc2hlcyhgJHtiYXNlVXJsfS9vYXV0aC9hdXRob3JpemVgKSxcbiAgICB0b2tlbkVuZHBvaW50OiBjbGVhbkRvdWJsZVNsYXNoZXMoYCR7YmFzZVVybH0vb2F1dGgvdG9rZW5gKSxcbiAgICB1c2VyaW5mb0VuZHBvaW50OiBjbGVhbkRvdWJsZVNsYXNoZXMoYCR7YmFzZVVybH0vYXBpL3Y0L3VzZXJgKVxuICB9O1xufTtcbnZhciBnaXRsYWIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGF1dGhvcml6YXRpb25FbmRwb2ludCwgdG9rZW5FbmRwb2ludCwgdXNlcmluZm9FbmRwb2ludCB9ID0gaXNzdWVyVG9FbmRwb2ludHMob3B0aW9ucy5pc3N1ZXIpO1xuICBjb25zdCBpc3N1ZXJJZCA9IFwiZ2l0bGFiXCI7XG4gIGNvbnN0IGlzc3Vlck5hbWUgPSBcIkdpdGxhYlwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBpc3N1ZXJJZCxcbiAgICBuYW1lOiBpc3N1ZXJOYW1lLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7XG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3BlcyxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJyZWFkX3VzZXJcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IGlzc3VlcklkLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBjb2RlVmVyaWZpZXJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkksIGNvZGVWZXJpZmllciB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICB1c2VyaW5mb0VuZHBvaW50LFxuICAgICAgICB7IGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWAgfSB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yIHx8IHByb2ZpbGUuc3RhdGUgIT09IFwiYWN0aXZlXCIgfHwgcHJvZmlsZS5sb2NrZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQudG9TdHJpbmcoKSxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUgPz8gcHJvZmlsZS51c2VybmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgcmVkZGl0ID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJyZWRkaXRcIixcbiAgICBuYW1lOiBcIlJlZGRpdFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gc2NvcGVzIHx8IFtcImlkZW50aXR5XCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInJlZGRpdFwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9hcGkvdjEvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvblxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIGdyYW50X3R5cGU6IFwiYXV0aG9yaXphdGlvbl9jb2RlXCIsXG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0X3VyaTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgICAgICBhY2NlcHQ6IFwidGV4dC9wbGFpblwiLFxuICAgICAgICBcInVzZXItYWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiLFxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtCdWZmZXIuZnJvbShcbiAgICAgICAgICBgJHtvcHRpb25zLmNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0fWBcbiAgICAgICAgKS50b1N0cmluZyhcImJhc2U2NFwiKX1gXG4gICAgICB9O1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9hcGkvdjEvYWNjZXNzX3Rva2VuXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgYm9keTogYm9keS50b1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vb2F1dGgucmVkZGl0LmNvbS9hcGkvdjEvbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICAgXCJVc2VyLUFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUub2F1dGhfY2xpZW50X2lkLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuaGFzX3ZlcmlmaWVkX2VtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmljb25faW1nPy5zcGxpdChcIj9cIilbMF0sXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgc29jaWFsUHJvdmlkZXJzID0ge1xuICBhcHBsZSxcbiAgZGlzY29yZCxcbiAgZmFjZWJvb2ssXG4gIGdpdGh1YixcbiAgbWljcm9zb2Z0LFxuICBnb29nbGUsXG4gIHNwb3RpZnksXG4gIHR3aXRjaCxcbiAgdHdpdHRlcixcbiAgZHJvcGJveCxcbiAgbGlua2VkaW4sXG4gIGdpdGxhYixcbiAgcmVkZGl0XG59O1xudmFyIHNvY2lhbFByb3ZpZGVyTGlzdCA9IE9iamVjdC5rZXlzKHNvY2lhbFByb3ZpZGVycyk7XG52YXIgU29jaWFsUHJvdmlkZXJMaXN0RW51bSA9IHouZW51bShzb2NpYWxQcm92aWRlckxpc3QsIHtcbiAgZGVzY3JpcHRpb246IFwiT0F1dGgyIHByb3ZpZGVyIHRvIHVzZVwiXG59KTtcblxuZXhwb3J0IHsgU29jaWFsUHJvdmlkZXJMaXN0RW51bSwgYXBwbGUsIGRpc2NvcmQsIGRyb3Bib3gsIGZhY2Vib29rLCBnZXRBcHBsZVB1YmxpY0tleSwgZ2l0aHViLCBnaXRsYWIsIGdvb2dsZSwgbGlua2VkaW4sIG1pY3Jvc29mdCwgcmVkZGl0LCBzb2NpYWxQcm92aWRlckxpc3QsIHNvY2lhbFByb3ZpZGVycywgc3BvdGlmeSwgdHdpdGNoLCB0d2l0dGVyIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TWO_FACTOR_ERROR_CODES: () => (/* binding */ TWO_FACTOR_ERROR_CODES)\n/* harmony export */ });\n// src/plugins/two-factor/error-code.ts\nvar TWO_FACTOR_ERROR_CODES = {\n  OTP_NOT_ENABLED: \"OTP not enabled\",\n  OTP_HAS_EXPIRED: \"OTP has expired\",\n  TOTP_NOT_ENABLED: \"TOTP not enabled\",\n  TWO_FACTOR_NOT_ENABLED: \"Two factor isn't enabled\",\n  BACKUP_CODES_NOT_ENABLED: \"Backup codes aren't enabled\",\n  INVALID_BACKUP_CODE: \"Invalid backup code\"\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstV01YQkE2TFguanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFa0MiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1XTVhCQTZMWC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcGx1Z2lucy90d28tZmFjdG9yL2Vycm9yLWNvZGUudHNcbnZhciBUV09fRkFDVE9SX0VSUk9SX0NPREVTID0ge1xuICBPVFBfTk9UX0VOQUJMRUQ6IFwiT1RQIG5vdCBlbmFibGVkXCIsXG4gIE9UUF9IQVNfRVhQSVJFRDogXCJPVFAgaGFzIGV4cGlyZWRcIixcbiAgVE9UUF9OT1RfRU5BQkxFRDogXCJUT1RQIG5vdCBlbmFibGVkXCIsXG4gIFRXT19GQUNUT1JfTk9UX0VOQUJMRUQ6IFwiVHdvIGZhY3RvciBpc24ndCBlbmFibGVkXCIsXG4gIEJBQ0tVUF9DT0RFU19OT1RfRU5BQkxFRDogXCJCYWNrdXAgY29kZXMgYXJlbid0IGVuYWJsZWRcIixcbiAgSU5WQUxJRF9CQUNLVVBfQ09ERTogXCJJbnZhbGlkIGJhY2t1cCBjb2RlXCJcbn07XG5cbmV4cG9ydCB7IFRXT19GQUNUT1JfRVJST1JfQ09ERVMgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accountSchema: () => (/* binding */ accountSchema),\n/* harmony export */   getAllFields: () => (/* binding */ getAllFields),\n/* harmony export */   getIp: () => (/* binding */ getIp),\n/* harmony export */   mergeSchema: () => (/* binding */ mergeSchema),\n/* harmony export */   parseAccountInput: () => (/* binding */ parseAccountInput),\n/* harmony export */   parseAccountOutput: () => (/* binding */ parseAccountOutput),\n/* harmony export */   parseAdditionalUserInput: () => (/* binding */ parseAdditionalUserInput),\n/* harmony export */   parseInputData: () => (/* binding */ parseInputData),\n/* harmony export */   parseOutputData: () => (/* binding */ parseOutputData),\n/* harmony export */   parseSessionInput: () => (/* binding */ parseSessionInput),\n/* harmony export */   parseSessionOutput: () => (/* binding */ parseSessionOutput),\n/* harmony export */   parseUserInput: () => (/* binding */ parseUserInput),\n/* harmony export */   parseUserOutput: () => (/* binding */ parseUserOutput),\n/* harmony export */   sessionSchema: () => (/* binding */ sessionSchema),\n/* harmony export */   userSchema: () => (/* binding */ userSchema),\n/* harmony export */   verificationSchema: () => (/* binding */ verificationSchema)\n/* harmony export */ });\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\nvar accountSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  providerId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  accountId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  accessToken: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  refreshToken: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  idToken: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  /**\n   * Access token expires at\n   */\n  accessTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().nullish(),\n  /**\n   * Refresh token expires at\n   */\n  refreshTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().nullish(),\n  /**\n   * The scopes that the user has authorized\n   */\n  scope: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  /**\n   * Password is only stored in the credential provider\n   */\n  password: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date())\n});\nvar userSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  email: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().transform((val) => val.toLowerCase()),\n  emailVerified: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean().default(false),\n  name: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  image: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date())\n});\nvar sessionSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  token: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  ipAddress: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  userAgent: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish()\n});\nvar verificationSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date(),\n  identifier: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  nonce: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish()\n});\nfunction parseOutputData(data, schema) {\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in data) {\n    const field = fields[key];\n    if (!field) {\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (field.returned === false) {\n      continue;\n    }\n    parsedData[key] = data[key];\n  }\n  return parsedData;\n}\nfunction getAllFields(options, table) {\n  let schema = {\n    ...table === \"user\" ? options.user?.additionalFields : {},\n    ...table === \"session\" ? options.session?.additionalFields : {}\n  };\n  for (const plugin of options.plugins || []) {\n    if (plugin.schema && plugin.schema[table]) {\n      schema = {\n        ...schema,\n        ...plugin.schema[table].fields\n      };\n    }\n  }\n  return schema;\n}\nfunction parseUserOutput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseOutputData(user, { fields: schema });\n}\nfunction parseAccountOutput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseOutputData(account, { fields: schema });\n}\nfunction parseSessionOutput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseOutputData(session, { fields: schema });\n}\nfunction parseInputData(data, schema) {\n  const action = schema.action || \"create\";\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in fields) {\n    if (key in data) {\n      if (fields[key].input === false) {\n        if (fields[key].defaultValue) {\n          parsedData[key] = fields[key].defaultValue;\n          continue;\n        }\n        continue;\n      }\n      if (fields[key].validator?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].validator.input.parse(data[key]);\n        continue;\n      }\n      if (fields[key].transform?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].transform?.input(data[key]);\n        continue;\n      }\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (fields[key].defaultValue && action === \"create\") {\n      parsedData[key] = fields[key].defaultValue;\n      continue;\n    }\n    if (fields[key].required && action === \"create\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `${key} is required`\n      });\n    }\n  }\n  return parsedData;\n}\nfunction parseUserInput(options, user, action) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema, action });\n}\nfunction parseAdditionalUserInput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema });\n}\nfunction parseAccountInput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseInputData(account, { fields: schema });\n}\nfunction parseSessionInput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseInputData(session, { fields: schema });\n}\nfunction mergeSchema(schema, newSchema) {\n  if (!newSchema) {\n    return schema;\n  }\n  for (const table in newSchema) {\n    const newModelName = newSchema[table]?.modelName;\n    if (newModelName) {\n      schema[table].modelName = newModelName;\n    }\n    for (const field in schema[table].fields) {\n      const newField = newSchema[table]?.fields?.[field];\n      if (!newField) {\n        continue;\n      }\n      schema[table].fields[field].fieldName = newField;\n    }\n  }\n  return schema;\n}\n\n// src/utils/get-request-ip.ts\nfunction getIp(req, options) {\n  if (options.advanced?.ipAddress?.disableIpTracking) {\n    return null;\n  }\n  const testIP = \"127.0.0.1\";\n  if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.isTest) {\n    return testIP;\n  }\n  const ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders;\n  const keys = ipHeaders || [\n    \"x-client-ip\",\n    \"x-forwarded-for\",\n    \"cf-connecting-ip\",\n    \"fastly-client-ip\",\n    \"x-real-ip\",\n    \"x-cluster-client-ip\",\n    \"x-forwarded\",\n    \"forwarded-for\",\n    \"forwarded\"\n  ];\n  const headers = req instanceof Request ? req.headers : req;\n  for (const key of keys) {\n    const value = headers.get(key);\n    if (typeof value === \"string\") {\n      const ip = value.split(\",\")[0].trim();\n      if (ip) return ip;\n    }\n  }\n  return null;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstV1o2T0lWSksuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE2QztBQUNyQjtBQUNlOztBQUV2QyxvQkFBb0IseUNBQVE7QUFDNUIsTUFBTSx5Q0FBUTtBQUNkLGNBQWMseUNBQVE7QUFDdEIsYUFBYSx5Q0FBUTtBQUNyQixVQUFVLHlDQUFRO0FBQ2xCLGVBQWUseUNBQVE7QUFDdkIsZ0JBQWdCLHlDQUFRO0FBQ3hCLFdBQVcseUNBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVDQUFNO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1Q0FBTTtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxTQUFTLHlDQUFRO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLFlBQVkseUNBQVE7QUFDcEIsYUFBYSx1Q0FBTTtBQUNuQixhQUFhLHVDQUFNO0FBQ25CLENBQUM7QUFDRCxpQkFBaUIseUNBQVE7QUFDekIsTUFBTSx5Q0FBUTtBQUNkLFNBQVMseUNBQVE7QUFDakIsaUJBQWlCLDBDQUFTO0FBQzFCLFFBQVEseUNBQVE7QUFDaEIsU0FBUyx5Q0FBUTtBQUNqQixhQUFhLHVDQUFNO0FBQ25CLGFBQWEsdUNBQU07QUFDbkIsQ0FBQztBQUNELG9CQUFvQix5Q0FBUTtBQUM1QixNQUFNLHlDQUFRO0FBQ2QsVUFBVSx5Q0FBUTtBQUNsQixhQUFhLHVDQUFNO0FBQ25CLGFBQWEsdUNBQU07QUFDbkIsYUFBYSx1Q0FBTTtBQUNuQixTQUFTLHlDQUFRO0FBQ2pCLGFBQWEseUNBQVE7QUFDckIsYUFBYSx5Q0FBUTtBQUNyQixDQUFDO0FBQ0QseUJBQXlCLHlDQUFRO0FBQ2pDLE1BQU0seUNBQVE7QUFDZCxTQUFTLHlDQUFRO0FBQ2pCLGFBQWEsdUNBQU07QUFDbkIsYUFBYSx1Q0FBTTtBQUNuQixhQUFhLHVDQUFNO0FBQ25CLGNBQWMseUNBQVE7QUFDdEIsU0FBUyx5Q0FBUTtBQUNqQixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsZ0JBQWdCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnQkFBZ0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGdCQUFnQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaURBQVE7QUFDeEIsb0JBQW9CLEtBQUs7QUFDekIsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxJQUFJLHdCQUF3QjtBQUM5RDtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsSUFBSSxnQkFBZ0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGdCQUFnQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsZ0JBQWdCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxzREFBTTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFb1IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1XWjZPSVZKSy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1Rlc3QgfSBmcm9tICcuL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbnZhciBhY2NvdW50U2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgcHJvdmlkZXJJZDogei5zdHJpbmcoKSxcbiAgYWNjb3VudElkOiB6LnN0cmluZygpLFxuICB1c2VySWQ6IHouc3RyaW5nKCksXG4gIGFjY2Vzc1Rva2VuOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgcmVmcmVzaFRva2VuOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgaWRUb2tlbjogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIC8qKlxuICAgKiBBY2Nlc3MgdG9rZW4gZXhwaXJlcyBhdFxuICAgKi9cbiAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHouZGF0ZSgpLm51bGxpc2goKSxcbiAgLyoqXG4gICAqIFJlZnJlc2ggdG9rZW4gZXhwaXJlcyBhdFxuICAgKi9cbiAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiB6LmRhdGUoKS5udWxsaXNoKCksXG4gIC8qKlxuICAgKiBUaGUgc2NvcGVzIHRoYXQgdGhlIHVzZXIgaGFzIGF1dGhvcml6ZWRcbiAgICovXG4gIHNjb3BlOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgLyoqXG4gICAqIFBhc3N3b3JkIGlzIG9ubHkgc3RvcmVkIGluIHRoZSBjcmVkZW50aWFsIHByb3ZpZGVyXG4gICAqL1xuICBwYXNzd29yZDogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIGNyZWF0ZWRBdDogei5kYXRlKCkuZGVmYXVsdCgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSksXG4gIHVwZGF0ZWRBdDogei5kYXRlKCkuZGVmYXVsdCgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSlcbn0pO1xudmFyIHVzZXJTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLFxuICBlbWFpbDogei5zdHJpbmcoKS50cmFuc2Zvcm0oKHZhbCkgPT4gdmFsLnRvTG93ZXJDYXNlKCkpLFxuICBlbWFpbFZlcmlmaWVkOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgaW1hZ2U6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB1cGRhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpXG59KTtcbnZhciBzZXNzaW9uU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgdXNlcklkOiB6LnN0cmluZygpLFxuICBleHBpcmVzQXQ6IHouZGF0ZSgpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB1cGRhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB0b2tlbjogei5zdHJpbmcoKSxcbiAgaXBBZGRyZXNzOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgdXNlckFnZW50OiB6LnN0cmluZygpLm51bGxpc2goKVxufSk7XG52YXIgdmVyaWZpY2F0aW9uU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgdmFsdWU6IHouc3RyaW5nKCksXG4gIGNyZWF0ZWRBdDogei5kYXRlKCkuZGVmYXVsdCgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSksXG4gIHVwZGF0ZWRBdDogei5kYXRlKCkuZGVmYXVsdCgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSksXG4gIGV4cGlyZXNBdDogei5kYXRlKCksXG4gIGlkZW50aWZpZXI6IHouc3RyaW5nKCksXG4gIG5vbmNlOiB6LnN0cmluZygpLm51bGxpc2goKVxufSk7XG5mdW5jdGlvbiBwYXJzZU91dHB1dERhdGEoZGF0YSwgc2NoZW1hKSB7XG4gIGNvbnN0IGZpZWxkcyA9IHNjaGVtYS5maWVsZHM7XG4gIGNvbnN0IHBhcnNlZERhdGEgPSB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xuICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2tleV07XG4gICAgaWYgKCFmaWVsZCkge1xuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZGF0YVtrZXldO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZC5yZXR1cm5lZCA9PT0gZmFsc2UpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBwYXJzZWREYXRhW2tleV0gPSBkYXRhW2tleV07XG4gIH1cbiAgcmV0dXJuIHBhcnNlZERhdGE7XG59XG5mdW5jdGlvbiBnZXRBbGxGaWVsZHMob3B0aW9ucywgdGFibGUpIHtcbiAgbGV0IHNjaGVtYSA9IHtcbiAgICAuLi50YWJsZSA9PT0gXCJ1c2VyXCIgPyBvcHRpb25zLnVzZXI/LmFkZGl0aW9uYWxGaWVsZHMgOiB7fSxcbiAgICAuLi50YWJsZSA9PT0gXCJzZXNzaW9uXCIgPyBvcHRpb25zLnNlc3Npb24/LmFkZGl0aW9uYWxGaWVsZHMgOiB7fVxuICB9O1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBvcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICBpZiAocGx1Z2luLnNjaGVtYSAmJiBwbHVnaW4uc2NoZW1hW3RhYmxlXSkge1xuICAgICAgc2NoZW1hID0ge1xuICAgICAgICAuLi5zY2hlbWEsXG4gICAgICAgIC4uLnBsdWdpbi5zY2hlbWFbdGFibGVdLmZpZWxkc1xuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNjaGVtYTtcbn1cbmZ1bmN0aW9uIHBhcnNlVXNlck91dHB1dChvcHRpb25zLCB1c2VyKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInVzZXJcIik7XG4gIHJldHVybiBwYXJzZU91dHB1dERhdGEodXNlciwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlQWNjb3VudE91dHB1dChvcHRpb25zLCBhY2NvdW50KSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcImFjY291bnRcIik7XG4gIHJldHVybiBwYXJzZU91dHB1dERhdGEoYWNjb3VudCwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlU2Vzc2lvbk91dHB1dChvcHRpb25zLCBzZXNzaW9uKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInNlc3Npb25cIik7XG4gIHJldHVybiBwYXJzZU91dHB1dERhdGEoc2Vzc2lvbiwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlSW5wdXREYXRhKGRhdGEsIHNjaGVtYSkge1xuICBjb25zdCBhY3Rpb24gPSBzY2hlbWEuYWN0aW9uIHx8IFwiY3JlYXRlXCI7XG4gIGNvbnN0IGZpZWxkcyA9IHNjaGVtYS5maWVsZHM7XG4gIGNvbnN0IHBhcnNlZERhdGEgPSB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gZmllbGRzKSB7XG4gICAgaWYgKGtleSBpbiBkYXRhKSB7XG4gICAgICBpZiAoZmllbGRzW2tleV0uaW5wdXQgPT09IGZhbHNlKSB7XG4gICAgICAgIGlmIChmaWVsZHNba2V5XS5kZWZhdWx0VmFsdWUpIHtcbiAgICAgICAgICBwYXJzZWREYXRhW2tleV0gPSBmaWVsZHNba2V5XS5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGRzW2tleV0udmFsaWRhdG9yPy5pbnB1dCAmJiBkYXRhW2tleV0gIT09IHZvaWQgMCkge1xuICAgICAgICBwYXJzZWREYXRhW2tleV0gPSBmaWVsZHNba2V5XS52YWxpZGF0b3IuaW5wdXQucGFyc2UoZGF0YVtrZXldKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoZmllbGRzW2tleV0udHJhbnNmb3JtPy5pbnB1dCAmJiBkYXRhW2tleV0gIT09IHZvaWQgMCkge1xuICAgICAgICBwYXJzZWREYXRhW2tleV0gPSBmaWVsZHNba2V5XS50cmFuc2Zvcm0/LmlucHV0KGRhdGFba2V5XSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZGF0YVtrZXldO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZHNba2V5XS5kZWZhdWx0VmFsdWUgJiYgYWN0aW9uID09PSBcImNyZWF0ZVwiKSB7XG4gICAgICBwYXJzZWREYXRhW2tleV0gPSBmaWVsZHNba2V5XS5kZWZhdWx0VmFsdWU7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGZpZWxkc1trZXldLnJlcXVpcmVkICYmIGFjdGlvbiA9PT0gXCJjcmVhdGVcIikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBgJHtrZXl9IGlzIHJlcXVpcmVkYFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJzZWREYXRhO1xufVxuZnVuY3Rpb24gcGFyc2VVc2VySW5wdXQob3B0aW9ucywgdXNlciwgYWN0aW9uKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInVzZXJcIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YSh1c2VyIHx8IHt9LCB7IGZpZWxkczogc2NoZW1hLCBhY3Rpb24gfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFkZGl0aW9uYWxVc2VySW5wdXQob3B0aW9ucywgdXNlcikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEodXNlciB8fCB7fSwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlQWNjb3VudElucHV0KG9wdGlvbnMsIGFjY291bnQpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwiYWNjb3VudFwiKTtcbiAgcmV0dXJuIHBhcnNlSW5wdXREYXRhKGFjY291bnQsIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZVNlc3Npb25JbnB1dChvcHRpb25zLCBzZXNzaW9uKSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcInNlc3Npb25cIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YShzZXNzaW9uLCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gbWVyZ2VTY2hlbWEoc2NoZW1hLCBuZXdTY2hlbWEpIHtcbiAgaWYgKCFuZXdTY2hlbWEpIHtcbiAgICByZXR1cm4gc2NoZW1hO1xuICB9XG4gIGZvciAoY29uc3QgdGFibGUgaW4gbmV3U2NoZW1hKSB7XG4gICAgY29uc3QgbmV3TW9kZWxOYW1lID0gbmV3U2NoZW1hW3RhYmxlXT8ubW9kZWxOYW1lO1xuICAgIGlmIChuZXdNb2RlbE5hbWUpIHtcbiAgICAgIHNjaGVtYVt0YWJsZV0ubW9kZWxOYW1lID0gbmV3TW9kZWxOYW1lO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGZpZWxkIGluIHNjaGVtYVt0YWJsZV0uZmllbGRzKSB7XG4gICAgICBjb25zdCBuZXdGaWVsZCA9IG5ld1NjaGVtYVt0YWJsZV0/LmZpZWxkcz8uW2ZpZWxkXTtcbiAgICAgIGlmICghbmV3RmllbGQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBzY2hlbWFbdGFibGVdLmZpZWxkc1tmaWVsZF0uZmllbGROYW1lID0gbmV3RmllbGQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBzY2hlbWE7XG59XG5cbi8vIHNyYy91dGlscy9nZXQtcmVxdWVzdC1pcC50c1xuZnVuY3Rpb24gZ2V0SXAocmVxLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmRpc2FibGVJcFRyYWNraW5nKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgdGVzdElQID0gXCIxMjcuMC4wLjFcIjtcbiAgaWYgKGlzVGVzdCkge1xuICAgIHJldHVybiB0ZXN0SVA7XG4gIH1cbiAgY29uc3QgaXBIZWFkZXJzID0gb3B0aW9ucy5hZHZhbmNlZD8uaXBBZGRyZXNzPy5pcEFkZHJlc3NIZWFkZXJzO1xuICBjb25zdCBrZXlzID0gaXBIZWFkZXJzIHx8IFtcbiAgICBcIngtY2xpZW50LWlwXCIsXG4gICAgXCJ4LWZvcndhcmRlZC1mb3JcIixcbiAgICBcImNmLWNvbm5lY3RpbmctaXBcIixcbiAgICBcImZhc3RseS1jbGllbnQtaXBcIixcbiAgICBcIngtcmVhbC1pcFwiLFxuICAgIFwieC1jbHVzdGVyLWNsaWVudC1pcFwiLFxuICAgIFwieC1mb3J3YXJkZWRcIixcbiAgICBcImZvcndhcmRlZC1mb3JcIixcbiAgICBcImZvcndhcmRlZFwiXG4gIF07XG4gIGNvbnN0IGhlYWRlcnMgPSByZXEgaW5zdGFuY2VvZiBSZXF1ZXN0ID8gcmVxLmhlYWRlcnMgOiByZXE7XG4gIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGhlYWRlcnMuZ2V0KGtleSk7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgaXAgPSB2YWx1ZS5zcGxpdChcIixcIilbMF0udHJpbSgpO1xuICAgICAgaWYgKGlwKSByZXR1cm4gaXA7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgeyBhY2NvdW50U2NoZW1hLCBnZXRBbGxGaWVsZHMsIGdldElwLCBtZXJnZVNjaGVtYSwgcGFyc2VBY2NvdW50SW5wdXQsIHBhcnNlQWNjb3VudE91dHB1dCwgcGFyc2VBZGRpdGlvbmFsVXNlcklucHV0LCBwYXJzZUlucHV0RGF0YSwgcGFyc2VPdXRwdXREYXRhLCBwYXJzZVNlc3Npb25JbnB1dCwgcGFyc2VTZXNzaW9uT3V0cHV0LCBwYXJzZVVzZXJJbnB1dCwgcGFyc2VVc2VyT3V0cHV0LCBzZXNzaW9uU2NoZW1hLCB1c2VyU2NoZW1hLCB2ZXJpZmljYXRpb25TY2hlbWEgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getBaseURL: () => (/* binding */ getBaseURL),\n/* harmony export */   getHost: () => (/* binding */ getHost),\n/* harmony export */   getOrigin: () => (/* binding */ getOrigin),\n/* harmony export */   getProtocol: () => (/* binding */ getProtocol)\n/* harmony export */ });\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n\n\n\n// src/utils/url.ts\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.pathname !== \"/\";\n  } catch (error) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${url.replace(/\\/+$/, \"\")}${path}`;\n}\nfunction getBaseURL(url, path) {\n  if (url) {\n    return withPath(url, path);\n  }\n  const fromEnv = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n  if (fromEnv) {\n    return withPath(fromEnv, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  if (url.includes(\"://\")) {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  }\n  return url;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstWEZDSUFOWlguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTBDO0FBQ1k7O0FBRXREO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osY0FBYywrREFBZTtBQUM3QiwyQkFBMkIsSUFBSTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLEtBQUs7QUFDaEQsWUFBWSx3QkFBd0IsRUFBRSxLQUFLO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbURBQUcsb0JBQW9CLG1EQUFHLGdDQUFnQyxtREFBRywyQkFBMkIsbURBQUcsZ0NBQWdDLG1EQUFHLDBCQUEwQixtREFBRyxvQkFBb0IsbURBQUc7QUFDcE07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV1RCIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVhGQ0lBTlpYLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVudiB9IGZyb20gJy4vY2h1bmstVFFRU1BQTkEuanMnO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnLi9jaHVuay1VTldDWEtNUC5qcyc7XG5cbi8vIHNyYy91dGlscy91cmwudHNcbmZ1bmN0aW9uIGNoZWNrSGFzUGF0aCh1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5wYXRobmFtZSAhPT0gXCIvXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIGBJbnZhbGlkIGJhc2UgVVJMOiAke3VybH0uIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIHdpdGhQYXRoKHVybCwgcGF0aCA9IFwiL2FwaS9hdXRoXCIpIHtcbiAgY29uc3QgaGFzUGF0aCA9IGNoZWNrSGFzUGF0aCh1cmwpO1xuICBpZiAoaGFzUGF0aCkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgcGF0aCA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogYC8ke3BhdGh9YDtcbiAgcmV0dXJuIGAke3VybC5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpfSR7cGF0aH1gO1xufVxuZnVuY3Rpb24gZ2V0QmFzZVVSTCh1cmwsIHBhdGgpIHtcbiAgaWYgKHVybCkge1xuICAgIHJldHVybiB3aXRoUGF0aCh1cmwsIHBhdGgpO1xuICB9XG4gIGNvbnN0IGZyb21FbnYgPSBlbnYuQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5ORVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52LlBVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0JFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTlVYVF9QVUJMSUNfQVVUSF9VUkwgfHwgKGVudi5CQVNFX1VSTCAhPT0gXCIvXCIgPyBlbnYuQkFTRV9VUkwgOiB2b2lkIDApO1xuICBpZiAoZnJvbUVudikge1xuICAgIHJldHVybiB3aXRoUGF0aChmcm9tRW52LCBwYXRoKTtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgod2luZG93LmxvY2F0aW9uLm9yaWdpbiwgcGF0aCk7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGdldE9yaWdpbih1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5vcmlnaW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFByb3RvY29sKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLnByb3RvY29sO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRIb3N0KHVybCkge1xuICBpZiAodXJsLmluY2x1ZGVzKFwiOi8vXCIpKSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwuaG9zdDtcbiAgfVxuICByZXR1cm4gdXJsO1xufVxuXG5leHBvcnQgeyBnZXRCYXNlVVJMLCBnZXRIb3N0LCBnZXRPcmlnaW4sIGdldFByb3RvY29sIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_10__.APIError),\n/* harmony export */   BASE_ERROR_CODES: () => (/* binding */ BASE_ERROR_CODES),\n/* harmony export */   callbackOAuth: () => (/* binding */ callbackOAuth),\n/* harmony export */   changeEmail: () => (/* binding */ changeEmail),\n/* harmony export */   changePassword: () => (/* binding */ changePassword),\n/* harmony export */   createAuthEndpoint: () => (/* binding */ createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* binding */ createAuthMiddleware),\n/* harmony export */   createEmailVerificationToken: () => (/* binding */ createEmailVerificationToken),\n/* harmony export */   deleteUser: () => (/* binding */ deleteUser),\n/* harmony export */   deleteUserCallback: () => (/* binding */ deleteUserCallback),\n/* harmony export */   error: () => (/* binding */ error),\n/* harmony export */   forgetPassword: () => (/* binding */ forgetPassword),\n/* harmony export */   forgetPasswordCallback: () => (/* binding */ forgetPasswordCallback),\n/* harmony export */   freshSessionMiddleware: () => (/* binding */ freshSessionMiddleware),\n/* harmony export */   getEndpoints: () => (/* binding */ getEndpoints),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   getSessionFromCtx: () => (/* binding */ getSessionFromCtx),\n/* harmony export */   handleOAuthUserInfo: () => (/* binding */ handleOAuthUserInfo),\n/* harmony export */   linkSocialAccount: () => (/* binding */ linkSocialAccount),\n/* harmony export */   listSessions: () => (/* binding */ listSessions),\n/* harmony export */   listUserAccounts: () => (/* binding */ listUserAccounts),\n/* harmony export */   ok: () => (/* binding */ ok),\n/* harmony export */   optionsMiddleware: () => (/* binding */ optionsMiddleware),\n/* harmony export */   originCheck: () => (/* binding */ originCheck),\n/* harmony export */   originCheckMiddleware: () => (/* binding */ originCheckMiddleware),\n/* harmony export */   resetPassword: () => (/* binding */ resetPassword),\n/* harmony export */   revokeOtherSessions: () => (/* binding */ revokeOtherSessions),\n/* harmony export */   revokeSession: () => (/* binding */ revokeSession),\n/* harmony export */   revokeSessions: () => (/* binding */ revokeSessions),\n/* harmony export */   router: () => (/* binding */ router),\n/* harmony export */   sendVerificationEmail: () => (/* binding */ sendVerificationEmail),\n/* harmony export */   sendVerificationEmailFn: () => (/* binding */ sendVerificationEmailFn),\n/* harmony export */   sessionMiddleware: () => (/* binding */ sessionMiddleware),\n/* harmony export */   setPassword: () => (/* binding */ setPassword),\n/* harmony export */   signInEmail: () => (/* binding */ signInEmail),\n/* harmony export */   signInSocial: () => (/* binding */ signInSocial),\n/* harmony export */   signOut: () => (/* binding */ signOut),\n/* harmony export */   signUpEmail: () => (/* binding */ signUpEmail),\n/* harmony export */   unlinkAccount: () => (/* binding */ unlinkAccount),\n/* harmony export */   updateUser: () => (/* binding */ updateUser),\n/* harmony export */   verifyEmail: () => (/* binding */ verifyEmail)\n/* harmony export */ });\n/* harmony import */ var _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-VXDYNCOX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(action-browser)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n/* harmony import */ var jose_errors__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! jose/errors */ \"(action-browser)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/errors.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar optionsMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createMiddleware)(async () => {\n  return {};\n});\nvar createAuthMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createMiddlewareCreator)({\n  use: [\n    optionsMiddleware,\n    /**\n     * Only use for post hooks\n     */\n    (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createMiddleware)(async () => {\n      return {};\n    })\n  ]\n});\nvar createAuthEndpoint = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createEndpointCreator)({\n  use: [optionsMiddleware]\n});\n\n// src/utils/wildcard.ts\nfunction escapeRegExpChar(char) {\n  if (char === \"-\" || char === \"^\" || char === \"$\" || char === \"+\" || char === \".\" || char === \"(\" || char === \")\" || char === \"|\" || char === \"[\" || char === \"]\" || char === \"{\" || char === \"}\" || char === \"*\" || char === \"?\" || char === \"\\\\\") {\n    return `\\\\${char}`;\n  } else {\n    return char;\n  }\n}\nfunction escapeRegExpString(str) {\n  let result = \"\";\n  for (let i = 0; i < str.length; i++) {\n    result += escapeRegExpChar(str[i]);\n  }\n  return result;\n}\nfunction transform(pattern, separator = true) {\n  if (Array.isArray(pattern)) {\n    let regExpPatterns = pattern.map((p) => `^${transform(p, separator)}$`);\n    return `(?:${regExpPatterns.join(\"|\")})`;\n  }\n  let separatorSplitter = \"\";\n  let separatorMatcher = \"\";\n  let wildcard = \".\";\n  if (separator === true) {\n    separatorSplitter = \"/\";\n    separatorMatcher = \"[/\\\\\\\\]\";\n    wildcard = \"[^/\\\\\\\\]\";\n  } else if (separator) {\n    separatorSplitter = separator;\n    separatorMatcher = escapeRegExpString(separatorSplitter);\n    if (separatorMatcher.length > 1) {\n      separatorMatcher = `(?:${separatorMatcher})`;\n      wildcard = `((?!${separatorMatcher}).)`;\n    } else {\n      wildcard = `[^${separatorMatcher}]`;\n    }\n  }\n  let requiredSeparator = separator ? `${separatorMatcher}+?` : \"\";\n  let optionalSeparator = separator ? `${separatorMatcher}*?` : \"\";\n  let segments = separator ? pattern.split(separatorSplitter) : [pattern];\n  let result = \"\";\n  for (let s = 0; s < segments.length; s++) {\n    let segment = segments[s];\n    let nextSegment = segments[s + 1];\n    let currentSeparator = \"\";\n    if (!segment && s > 0) {\n      continue;\n    }\n    if (separator) {\n      if (s === segments.length - 1) {\n        currentSeparator = optionalSeparator;\n      } else if (nextSegment !== \"**\") {\n        currentSeparator = requiredSeparator;\n      } else {\n        currentSeparator = \"\";\n      }\n    }\n    if (separator && segment === \"**\") {\n      if (currentSeparator) {\n        result += s === 0 ? \"\" : currentSeparator;\n        result += `(?:${wildcard}*?${currentSeparator})*?`;\n      }\n      continue;\n    }\n    for (let c = 0; c < segment.length; c++) {\n      let char = segment[c];\n      if (char === \"\\\\\") {\n        if (c < segment.length - 1) {\n          result += escapeRegExpChar(segment[c + 1]);\n          c++;\n        }\n      } else if (char === \"?\") {\n        result += wildcard;\n      } else if (char === \"*\") {\n        result += `${wildcard}*?`;\n      } else {\n        result += escapeRegExpChar(char);\n      }\n    }\n    result += currentSeparator;\n  }\n  return result;\n}\nfunction isMatch(regexp, sample) {\n  if (typeof sample !== \"string\") {\n    throw new TypeError(`Sample must be a string, but ${typeof sample} given`);\n  }\n  return regexp.test(sample);\n}\nfunction wildcardMatch(pattern, options) {\n  if (typeof pattern !== \"string\" && !Array.isArray(pattern)) {\n    throw new TypeError(\n      `The first argument must be a single pattern string or an array of patterns, but ${typeof pattern} given`\n    );\n  }\n  if (typeof options === \"string\" || typeof options === \"boolean\") {\n    options = { separator: options };\n  }\n  if (arguments.length === 2 && !(typeof options === \"undefined\" || typeof options === \"object\" && options !== null && !Array.isArray(options))) {\n    throw new TypeError(\n      `The second argument must be an options object or a string/boolean separator, but ${typeof options} given`\n    );\n  }\n  options = options || {};\n  if (options.separator === \"\\\\\") {\n    throw new Error(\n      \"\\\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead\"\n    );\n  }\n  let regexpPattern = transform(pattern, options.separator);\n  let regexp = new RegExp(`^${regexpPattern}$`, options.flags);\n  let fn = isMatch.bind(null, regexp);\n  fn.options = options;\n  fn.pattern = pattern;\n  fn.regexp = regexp;\n  return fn;\n}\n\n// src/api/middlewares/origin-check.ts\nvar originCheckMiddleware = createAuthMiddleware(async (ctx) => {\n  if (ctx.request?.method !== \"POST\" || !ctx.request) {\n    return;\n  }\n  const { body, query, context } = ctx;\n  const originHeader = ctx.headers?.get(\"origin\") || ctx.headers?.get(\"referer\") || \"\";\n  const callbackURL = body?.callbackURL || query?.callbackURL;\n  const redirectURL = body?.redirectTo;\n  const errorCallbackURL = body?.errorCallbackURL;\n  const newUserCallbackURL = body?.newUserCallbackURL;\n  const trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const usesCookies = ctx.headers?.has(\"cookie\");\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      return wildcardMatch(pattern)((0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getHost)(url));\n    }\n    const protocol = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getProtocol)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getOrigin)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && !url.includes(\":\")\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  if (usesCookies && !ctx.context.options.advanced?.disableCSRFCheck) {\n    validateURL(originHeader, \"origin\");\n  }\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n  redirectURL && validateURL(redirectURL, \"redirectURL\");\n  errorCallbackURL && validateURL(errorCallbackURL, \"errorCallbackURL\");\n  newUserCallbackURL && validateURL(newUserCallbackURL, \"newUserCallbackURL\");\n});\nvar originCheck = (getValue) => createAuthMiddleware(async (ctx) => {\n  if (!ctx.request) {\n    return;\n  }\n  const { context } = ctx;\n  const callbackURL = getValue(ctx);\n  const trustedOrigins = Array.isArray(\n    context.options.trustedOrigins\n  ) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      return wildcardMatch(pattern)((0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getHost)(url));\n    }\n    return url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && !url.includes(\":\")\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n});\n\n// src/error/codes.ts\nvar BASE_ERROR_CODES = {\n  USER_NOT_FOUND: \"User not found\",\n  FAILED_TO_CREATE_USER: \"Failed to create user\",\n  FAILED_TO_CREATE_SESSION: \"Failed to create session\",\n  FAILED_TO_UPDATE_USER: \"Failed to update user\",\n  FAILED_TO_GET_SESSION: \"Failed to get session\",\n  INVALID_PASSWORD: \"Invalid password\",\n  INVALID_EMAIL: \"Invalid email\",\n  INVALID_EMAIL_OR_PASSWORD: \"Invalid email or password\",\n  SOCIAL_ACCOUNT_ALREADY_LINKED: \"Social account already linked\",\n  PROVIDER_NOT_FOUND: \"Provider not found\",\n  INVALID_TOKEN: \"invalid token\",\n  ID_TOKEN_NOT_SUPPORTED: \"id_token not supported\",\n  FAILED_TO_GET_USER_INFO: \"Failed to get user info\",\n  USER_EMAIL_NOT_FOUND: \"User email not found\",\n  EMAIL_NOT_VERIFIED: \"Email not verified\",\n  PASSWORD_TOO_SHORT: \"Password too short\",\n  PASSWORD_TOO_LONG: \"Password too long\",\n  USER_ALREADY_EXISTS: \"User already exists\",\n  EMAIL_CAN_NOT_BE_UPDATED: \"Email can not be updated\",\n  CREDENTIAL_ACCOUNT_NOT_FOUND: \"Credential account not found\",\n  SESSION_EXPIRED: \"Session expired. Re-authenticate to perform this action.\",\n  FAILED_TO_UNLINK_LAST_ACCOUNT: \"You can't unlink your last account\",\n  ACCOUNT_NOT_FOUND: \"Account not found\"\n};\nvar getSession = () => createAuthEndpoint(\n  \"/get-session\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.optional(\n      zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n        /**\n         * If cookie cache is enabled, it will disable the cache\n         * and fetch the session from the database\n         */\n        disableCookieCache: zod__WEBPACK_IMPORTED_MODULE_11__.z.optional(\n          zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n            description: \"Disable cookie cache and fetch session from database\"\n          }).or(zod__WEBPACK_IMPORTED_MODULE_11__.z.string().transform((v) => v === \"true\"))\n        ).optional(),\n        disableRefresh: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n          description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n        }).or(zod__WEBPACK_IMPORTED_MODULE_11__.z.string().transform((v) => v === \"true\")).optional()\n      })\n    ),\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Get the current session\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      type: \"object\",\n                      properties: {\n                        token: {\n                          type: \"string\"\n                        },\n                        userId: {\n                          type: \"string\"\n                        },\n                        expiresAt: {\n                          type: \"string\"\n                        }\n                      }\n                    },\n                    user: {\n                      type: \"object\",\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessionCookieToken = await ctx.getSignedCookie(\n        ctx.context.authCookies.sessionToken.name,\n        ctx.context.secret\n      );\n      if (!sessionCookieToken) {\n        return ctx.json(null);\n      }\n      const sessionDataCookie = ctx.getCookie(\n        ctx.context.authCookies.sessionData.name\n      );\n      const sessionDataPayload = sessionDataCookie ? (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_7__.safeJSONParse)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_14__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__.base64.decode(sessionDataCookie))) : null;\n      if (sessionDataPayload) {\n        const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_12__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n          ctx.context.secret,\n          JSON.stringify(sessionDataPayload.session),\n          sessionDataPayload.signature\n        );\n        if (!isValid) {\n          (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n          return ctx.json(null);\n        }\n      }\n      const dontRememberMe = await ctx.getSignedCookie(\n        ctx.context.authCookies.dontRememberToken.name,\n        ctx.context.secret\n      );\n      if (sessionDataPayload?.session && ctx.context.options.session?.cookieCache?.enabled && !ctx.query?.disableCookieCache) {\n        const session2 = sessionDataPayload.session;\n        const hasExpired = sessionDataPayload.expiresAt < Date.now() || session2.session.expiresAt < /* @__PURE__ */ new Date();\n        if (!hasExpired) {\n          return ctx.json(\n            session2\n          );\n        } else {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n        }\n      }\n      const session = await ctx.context.internalAdapter.findSession(sessionCookieToken);\n      ctx.context.session = session;\n      if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n        (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n        if (session) {\n          await ctx.context.internalAdapter.deleteSession(\n            session.session.token\n          );\n        }\n        return ctx.json(null);\n      }\n      if (dontRememberMe || ctx.query?.disableRefresh) {\n        return ctx.json(\n          session\n        );\n      }\n      const expiresIn = ctx.context.sessionConfig.expiresIn;\n      const updateAge = ctx.context.sessionConfig.updateAge;\n      const sessionIsDueToBeUpdatedDate = session.session.expiresAt.valueOf() - expiresIn * 1e3 + updateAge * 1e3;\n      const shouldBeUpdated = sessionIsDueToBeUpdatedDate <= Date.now();\n      if (shouldBeUpdated) {\n        const updatedSession = await ctx.context.internalAdapter.updateSession(\n          session.session.token,\n          {\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__.getDate)(ctx.context.sessionConfig.expiresIn, \"sec\")\n          }\n        );\n        if (!updatedSession) {\n          (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n          return ctx.json(null, { status: 401 });\n        }\n        const maxAge = (updatedSession.expiresAt.valueOf() - Date.now()) / 1e3;\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(\n          ctx,\n          {\n            session: updatedSession,\n            user: session.user\n          },\n          false,\n          {\n            maxAge\n          }\n        );\n        return ctx.json({\n          session: updatedSession,\n          user: session.user\n        });\n      }\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setCookieCache)(ctx, session);\n      return ctx.json(\n        session\n      );\n    } catch (error2) {\n      ctx.context.logger.error(\"INTERNAL_SERVER_ERROR\", error2);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n  }\n);\nvar getSessionFromCtx = async (ctx, config) => {\n  if (ctx.context.session) {\n    return ctx.context.session;\n  }\n  const session = await getSession()({\n    ...ctx,\n    _flag: \"json\",\n    headers: ctx.headers,\n    query: { ...ctx.query, ...config }\n  }).catch((e) => {\n    return null;\n  });\n  ctx.context.session = session;\n  return session;\n};\nvar sessionMiddleware = createAuthMiddleware(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nvar freshSessionMiddleware = createAuthMiddleware(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n  }\n  if (ctx.context.sessionConfig.freshAge === 0) {\n    return {\n      session\n    };\n  }\n  const freshAge = ctx.context.sessionConfig.freshAge;\n  const lastUpdated = session.session.updatedAt?.valueOf() || session.session.createdAt.valueOf();\n  const now = Date.now();\n  const isFresh = now - lastUpdated < freshAge * 1e3;\n  if (!isFresh) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", {\n      message: \"Session is not fresh\"\n    });\n  }\n  return {\n    session\n  };\n});\nvar listSessions = () => createAuthEndpoint(\n  \"/list-sessions\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"List all active sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      token: {\n                        type: \"string\"\n                      },\n                      userId: {\n                        type: \"string\"\n                      },\n                      expiresAt: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      ctx.context.session.user.id\n    );\n    const activeSessions = sessions.filter((session) => {\n      return session.expiresAt > /* @__PURE__ */ new Date();\n    });\n    return ctx.json(\n      activeSessions\n    );\n  }\n);\nvar revokeSession = createAuthEndpoint(\n  \"/revoke-session\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The token to revoke\"\n      })\n    }),\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke a single session\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  token: {\n                    type: \"string\"\n                  }\n                },\n                required: [\"token\"]\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token;\n    const findSession = await ctx.context.internalAdapter.findSession(token);\n    if (!findSession) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Session not found\"\n      });\n    }\n    if (findSession.session.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n    }\n    try {\n      await ctx.context.internalAdapter.deleteSession(token);\n    } catch (error2) {\n      ctx.context.logger.error(\n        error2 && typeof error2 === \"object\" && \"name\" in error2 ? error2.name : \"\",\n        error2\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar revokeSessions = createAuthEndpoint(\n  \"/revoke-sessions\",\n  {\n    method: \"POST\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke all sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      await ctx.context.internalAdapter.deleteSessions(\n        ctx.context.session.user.id\n      );\n    } catch (error2) {\n      ctx.context.logger.error(\n        error2 && typeof error2 === \"object\" && \"name\" in error2 ? error2.name : \"\",\n        error2\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar revokeOtherSessions = createAuthEndpoint(\n  \"/revoke-other-sessions\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Revoke all other sessions for the user except the current one\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    if (!session.user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n    }\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      session.user.id\n    );\n    const activeSessions = sessions.filter((session2) => {\n      return session2.expiresAt > /* @__PURE__ */ new Date();\n    });\n    const otherSessions = activeSessions.filter(\n      (session2) => session2.token !== ctx.context.session.session.token\n    );\n    await Promise.all(\n      otherSessions.map(\n        (session2) => ctx.context.internalAdapter.deleteSession(session2.token)\n      )\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nasync function createEmailVerificationToken(secret, email, updateTo, expiresIn = 3600) {\n  const token = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__.signJWT)(\n    {\n      email: email.toLowerCase(),\n      updateTo\n    },\n    secret,\n    expiresIn\n  );\n  return token;\n}\nasync function sendVerificationEmailFn(ctx, user) {\n  if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n    ctx.context.logger.error(\"Verification email isn't enabled.\");\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n      message: \"Verification email isn't enabled\"\n    });\n  }\n  const token = await createEmailVerificationToken(\n    ctx.context.secret,\n    user.email,\n    void 0,\n    ctx.context.options.emailVerification?.expiresIn\n  );\n  const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n  await ctx.context.options.emailVerification.sendVerificationEmail(\n    {\n      user,\n      url,\n      token\n    },\n    ctx.request\n  );\n}\nvar sendVerificationEmail = createAuthEndpoint(\n  \"/send-verification-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The email to send the verification email to\"\n      }).email(),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to use for email verification callback\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a verification email to the user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  email: {\n                    type: \"string\",\n                    description: \"The email to send the verification email to\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  }\n                },\n                required: [\"email\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const { email } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (!user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.USER_NOT_FOUND\n      });\n    }\n    await sendVerificationEmailFn(ctx, user.user);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar verifyEmail = createAuthEndpoint(\n  \"/verify-email\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The token to verify the email\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Verify the email of the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"user\", \"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    function redirectOnError(error2) {\n      if (ctx.query.callbackURL) {\n        if (ctx.query.callbackURL.includes(\"?\")) {\n          throw ctx.redirect(`${ctx.query.callbackURL}&error=${error2}`);\n        }\n        throw ctx.redirect(`${ctx.query.callbackURL}?error=${error2}`);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: error2\n      });\n    }\n    const { token } = ctx.query;\n    let jwt;\n    try {\n      jwt = await (0,jose__WEBPACK_IMPORTED_MODULE_15__.jwtVerify)(\n        token,\n        new TextEncoder().encode(ctx.context.secret),\n        {\n          algorithms: [\"HS256\"]\n        }\n      );\n    } catch (e) {\n      if (e instanceof jose_errors__WEBPACK_IMPORTED_MODULE_16__.JWTExpired) {\n        return redirectOnError(\"token_expired\");\n      }\n      return redirectOnError(\"invalid_token\");\n    }\n    const schema2 = zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().email(),\n      updateTo: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    });\n    const parsed = schema2.parse(jwt.payload);\n    const user = await ctx.context.internalAdapter.findUserByEmail(\n      parsed.email\n    );\n    if (!user) {\n      return redirectOnError(\"user_not_found\");\n    }\n    if (parsed.updateTo) {\n      const session = await getSessionFromCtx(ctx);\n      if (!session) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      if (session.user.email !== parsed.email) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      const updatedUser = await ctx.context.internalAdapter.updateUserByEmail(\n        parsed.email,\n        {\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      );\n      const newToken = await createEmailVerificationToken(\n        ctx.context.secret,\n        parsed.updateTo\n      );\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: updatedUser,\n          url: `${ctx.context.baseURL}/verify-email?token=${newToken}`,\n          token: newToken\n        },\n        ctx.request\n      );\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n        session: session.session,\n        user: {\n          ...session.user,\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      });\n      if (ctx.query.callbackURL) {\n        throw ctx.redirect(ctx.query.callbackURL);\n      }\n      return ctx.json({\n        status: true,\n        user: {\n          id: updatedUser.id,\n          email: updatedUser.email,\n          name: updatedUser.name,\n          image: updatedUser.image,\n          emailVerified: updatedUser.emailVerified,\n          createdAt: updatedUser.createdAt,\n          updatedAt: updatedUser.updatedAt\n        }\n      });\n    }\n    await ctx.context.internalAdapter.updateUserByEmail(parsed.email, {\n      emailVerified: true\n    });\n    if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n      const currentSession = await getSessionFromCtx(ctx);\n      if (!currentSession || currentSession.user.email !== parsed.email) {\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx.request\n        );\n        if (!session) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\", {\n            message: \"Failed to create session\"\n          });\n        }\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n          session,\n          user: {\n            ...user.user,\n            emailVerified: true\n          }\n        });\n      } else {\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n          session: currentSession.session,\n          user: {\n            ...currentSession.user,\n            emailVerified: true\n          }\n        });\n      }\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL);\n    }\n    return ctx.json({\n      status: true,\n      user: null\n    });\n  }\n);\n\n// src/oauth2/link-account.ts\nasync function handleOAuthUserInfo(c, {\n  userInfo,\n  account,\n  callbackURL\n}) {\n  const dbUser = await c.context.internalAdapter.findOAuthUser(\n    userInfo.email.toLowerCase(),\n    account.accountId,\n    account.providerId\n  ).catch((e) => {\n    _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n      \"Better auth was unable to query your database.\\nError: \",\n      e\n    );\n    throw c.redirect(\n      `${c.context.baseURL}/error?error=internal_server_error`\n    );\n  });\n  let user = dbUser?.user;\n  let isRegister = !user;\n  if (dbUser) {\n    const hasBeenLinked = dbUser.accounts.find(\n      (a) => a.providerId === account.providerId\n    );\n    if (!hasBeenLinked) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        account.providerId\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__.isDevelopment) {\n          _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.warn(\n            `User already exist but account isn't linked to ${account.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`\n          );\n        }\n        return {\n          error: \"account not linked\",\n          data: null\n        };\n      }\n      try {\n        await c.context.internalAdapter.linkAccount({\n          providerId: account.providerId,\n          accountId: userInfo.id.toString(),\n          userId: dbUser.user.id,\n          accessToken: account.accessToken,\n          idToken: account.idToken,\n          refreshToken: account.refreshToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope\n        });\n      } catch (e) {\n        _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Unable to link account\", e);\n        return {\n          error: \"unable to link account\",\n          data: null\n        };\n      }\n    } else {\n      const updateData = Object.fromEntries(\n        Object.entries({\n          accessToken: account.accessToken,\n          idToken: account.idToken,\n          refreshToken: account.refreshToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope\n        }).filter(([_, value]) => value !== void 0)\n      );\n      if (Object.keys(updateData).length > 0) {\n        await c.context.internalAdapter.updateAccount(\n          hasBeenLinked.id,\n          updateData\n        );\n      }\n    }\n  } else {\n    try {\n      user = await c.context.internalAdapter.createOAuthUser(\n        {\n          ...userInfo,\n          email: userInfo.email.toLowerCase(),\n          id: void 0\n        },\n        {\n          accessToken: account.accessToken,\n          idToken: account.idToken,\n          refreshToken: account.refreshToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope,\n          providerId: account.providerId,\n          accountId: userInfo.id.toString()\n        }\n      ).then((res) => res?.user);\n      if (!userInfo.emailVerified && user && c.context.options.emailVerification?.sendOnSignUp) {\n        const token = await createEmailVerificationToken(\n          c.context.secret,\n          user.email,\n          void 0,\n          c.context.options.emailVerification?.expiresIn\n        );\n        const url = `${c.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n        await c.context.options.emailVerification?.sendVerificationEmail?.(\n          {\n            user,\n            url,\n            token\n          },\n          c.request\n        );\n      }\n    } catch (e) {\n      _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.error(e);\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n        return {\n          error: e.message,\n          data: null,\n          isRegister: false\n        };\n      }\n      return {\n        error: \"unable to create user\",\n        data: null,\n        isRegister: false\n      };\n    }\n  }\n  if (!user) {\n    return {\n      error: \"unable to create user\",\n      data: null,\n      isRegister: false\n    };\n  }\n  const session = await c.context.internalAdapter.createSession(\n    user.id,\n    c.request\n  );\n  if (!session) {\n    return {\n      error: \"unable to create session\",\n      data: null,\n      isRegister: false\n    };\n  }\n  return {\n    data: {\n      session,\n      user\n    },\n    error: null,\n    isRegister\n  };\n}\n\n// src/api/routes/sign-in.ts\nvar signInSocial = createAuthEndpoint(\n  \"/sign-in/social\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * Callback URL to redirect to after the user\n       * has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Callback URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * callback url to redirect if the user is newly registered.\n       *\n       * useful if you have different routes for existing users and new users\n       */\n      newUserCallbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n      /**\n       * Callback url to redirect to if an error happens\n       *\n       * If it's initiated from the client sdk this defaults to\n       * the current url.\n       */\n      errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Callback URL to redirect to if an error happens\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_0__.SocialProviderListEnum,\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional(),\n      /**\n       * ID token from the provider\n       *\n       * This is used to sign in the user\n       * if the user is already signed in with the\n       * provider in the frontend.\n       *\n       * Only applicable if the provider supports\n       * it. Currently only `apple` and `google` is\n       * supported out of the box.\n       */\n      idToken: zod__WEBPACK_IMPORTED_MODULE_11__.z.optional(\n        zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n          /**\n           * ID token from the provider\n           */\n          token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"ID token from the provider\"\n          }),\n          /**\n           * The nonce used to generate the token\n           */\n          nonce: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"Nonce used to generate the token\"\n          }).optional(),\n          /**\n           * Access token from the provider\n           */\n          accessToken: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"Access token from the provider\"\n          }).optional(),\n          /**\n           * Refresh token from the provider\n           */\n          refreshToken: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"Refresh token from the provider\"\n          }).optional(),\n          /**\n           * Expiry date of the token\n           */\n          expiresAt: zod__WEBPACK_IMPORTED_MODULE_11__.z.number({\n            description: \"Expiry date of the token\"\n          }).optional()\n        }),\n        {\n          description: \"ID token from the provider to sign in the user with id token\"\n        }\n      )\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with a social provider\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      type: \"string\"\n                    },\n                    user: {\n                      type: \"object\"\n                    },\n                    url: {\n                      type: \"string\"\n                    },\n                    redirect: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"session\", \"user\", \"url\", \"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n          message: BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: BASE_ERROR_CODES.INVALID_TOKEN\n        });\n      }\n      const userInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!userInfo || !userInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n        });\n      }\n      if (!userInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const data = await handleOAuthUserInfo(c, {\n        userInfo: {\n          email: userInfo.user.email,\n          id: userInfo.user.id,\n          name: userInfo.user.name || \"\",\n          image: userInfo.user.image,\n          emailVerified: userInfo.user.emailVerified || false\n        },\n        account: {\n          providerId: provider.id,\n          accountId: userInfo.user.id,\n          accessToken: c.body.idToken.accessToken\n        }\n      });\n      if (data.error) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: data.error\n        });\n      }\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(c, data.data);\n      return c.json({\n        redirect: false,\n        token: data.data.session.token,\n        url: void 0,\n        user: {\n          id: data.data.user.id,\n          email: data.data.user.email,\n          name: data.data.user.name,\n          image: data.data.user.image,\n          emailVerified: data.data.user.emailVerified,\n          createdAt: data.data.user.createdAt,\n          updatedAt: data.data.user.updatedAt\n        }\n      });\n    }\n    const { codeVerifier, state } = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__.generateState)(c);\n    const url = await provider.createAuthorizationURL({\n      state,\n      codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nvar signInEmail = createAuthEndpoint(\n  \"/sign-in/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * Email of the user\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Email of the user\"\n      }),\n      /**\n       * Password of the user\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Password of the user\"\n      }),\n      /**\n       * Callback URL to use as a redirect for email\n       * verification and for possible redirects\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Callback URL to use as a redirect for email verification\"\n      }).optional(),\n      /**\n       * If this is false, the session will not be remembered\n       * @default true\n       */\n      rememberMe: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n        description: \"If this is false, the session will not be remembered. Default is `true`.\"\n      }).default(true).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with email and password\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    },\n                    url: {\n                      type: \"string\"\n                    },\n                    redirect: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"session\", \"user\", \"url\", \"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options?.emailAndPassword?.enabled) {\n      ctx.context.logger.error(\n        \"Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password is not enabled\"\n      });\n    }\n    const { email, password } = ctx.body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_11__.z.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      await ctx.context.password.hash(password);\n      ctx.context.logger.error(\"User not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const credentialAccount = user.accounts.find(\n      (a) => a.providerId === \"credential\"\n    );\n    if (!credentialAccount) {\n      ctx.context.logger.error(\"Credential account not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const currentPassword = credentialAccount?.password;\n    if (!currentPassword) {\n      ctx.context.logger.error(\"Password not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const validPassword = await ctx.context.password.verify({\n      hash: currentPassword,\n      password\n    });\n    if (!validPassword) {\n      ctx.context.logger.error(\"Invalid password\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    if (ctx.context.options?.emailAndPassword?.requireEmailVerification && !user.user.emailVerified) {\n      if (!ctx.context.options?.emailVerification?.sendVerificationEmail) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", {\n          message: BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n        });\n      }\n      const token = await createEmailVerificationToken(\n        ctx.context.secret,\n        user.user.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.emailVerification.sendVerificationEmail(\n        {\n          user: user.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", {\n        message: BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      user.user.id,\n      ctx.headers,\n      ctx.body.rememberMe === false\n    );\n    if (!session) {\n      ctx.context.logger.error(\"Failed to create session\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(\n      ctx,\n      {\n        session,\n        user: user.user\n      },\n      ctx.body.rememberMe === false\n    );\n    return ctx.json({\n      redirect: !!ctx.body.callbackURL,\n      token: session.token,\n      url: ctx.body.callbackURL,\n      user: {\n        id: user.user.id,\n        email: user.user.email,\n        name: user.user.name,\n        image: user.user.image,\n        emailVerified: user.user.emailVerified,\n        createdAt: user.user.createdAt,\n        updatedAt: user.user.updatedAt\n      }\n    });\n  }\n);\nvar schema = zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n  code: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n  error: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n  error_description: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n  state: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n});\nvar callbackOAuth = createAuthEndpoint(\n  \"/callback/:id\",\n  {\n    method: [\"GET\", \"POST\"],\n    body: schema.optional(),\n    query: schema.optional(),\n    metadata: _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.HIDE_METADATA\n  },\n  async (c) => {\n    let queryOrBody;\n    try {\n      if (c.method === \"GET\") {\n        queryOrBody = schema.parse(c.query);\n      } else if (c.method === \"POST\") {\n        queryOrBody = schema.parse(c.body);\n      } else {\n        throw new Error(\"Unsupported method\");\n      }\n    } catch (e) {\n      c.context.logger.error(\"INVALID_CALLBACK_REQUEST\", e);\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=invalid_callback_request`\n      );\n    }\n    const { code, error: error2, state, error_description } = queryOrBody;\n    if (!state) {\n      c.context.logger.error(\"State not found\", error2);\n      throw c.redirect(`${c.context.baseURL}/error?error=state_not_found`);\n    }\n    if (!code) {\n      c.context.logger.error(\"Code not found\");\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=${error2 || \"no_code\"}&error_description=${error_description}`\n      );\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.params.id\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Oauth provider with id\",\n        c.params.id,\n        \"not found\"\n      );\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=oauth_provider_not_found`\n      );\n    }\n    const { codeVerifier, callbackURL, link, errorURL, newUserURL } = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__.parseState)(c);\n    let tokens;\n    try {\n      tokens = await provider.validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n      });\n    } catch (e) {\n      c.context.logger.error(\"\", e);\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=please_restart_the_process`\n      );\n    }\n    const userInfo = await provider.getUserInfo(tokens).then((res) => res?.user);\n    function redirectOnError(error3) {\n      let url = errorURL || callbackURL || `${c.context.baseURL}/error`;\n      if (url.includes(\"?\")) {\n        url = `${url}&error=${error3}`;\n      } else {\n        url = `${url}?error=${error3}`;\n      }\n      throw c.redirect(url);\n    }\n    if (!userInfo) {\n      c.context.logger.error(\"Unable to get user info\");\n      return redirectOnError(\"unable_to_get_user_info\");\n    }\n    if (!userInfo.email) {\n      c.context.logger.error(\n        \"Provider did not return email. This could be due to misconfiguration in the provider settings.\"\n      );\n      return redirectOnError(\"email_not_found\");\n    }\n    if (!callbackURL) {\n      c.context.logger.error(\"No callback URL found\");\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=please_restart_the_process`\n      );\n    }\n    if (link) {\n      if (c.context.options.account?.accountLinking?.allowDifferentEmails !== true && link.email !== userInfo.email.toLowerCase()) {\n        return redirectOnError(\"email_doesn't_match\");\n      }\n      const existingAccount = await c.context.internalAdapter.findAccount(\n        userInfo.id\n      );\n      if (existingAccount) {\n        if (existingAccount && existingAccount.userId !== link.userId) {\n          return redirectOnError(\"account_already_linked_to_different_user\");\n        }\n        return redirectOnError(\"account_already_linked\");\n      }\n      const newAccount = await c.context.internalAdapter.createAccount({\n        userId: link.userId,\n        providerId: provider.id,\n        accountId: userInfo.id,\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      });\n      if (!newAccount) {\n        return redirectOnError(\"unable_to_link_account\");\n      }\n      let toRedirectTo2;\n      try {\n        const url = callbackURL;\n        toRedirectTo2 = url.toString();\n      } catch {\n        toRedirectTo2 = callbackURL;\n      }\n      throw c.redirect(toRedirectTo2);\n    }\n    const result = await handleOAuthUserInfo(c, {\n      userInfo: {\n        ...userInfo,\n        email: userInfo.email,\n        name: userInfo.name || userInfo.email\n      },\n      account: {\n        providerId: provider.id,\n        accountId: userInfo.id,\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      },\n      callbackURL\n    });\n    if (result.error) {\n      c.context.logger.error(result.error.split(\" \").join(\"_\"));\n      return redirectOnError(result.error.split(\" \").join(\"_\"));\n    }\n    const { session, user } = result.data;\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(c, {\n      session,\n      user\n    });\n    let toRedirectTo;\n    try {\n      const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n      toRedirectTo = url.toString();\n    } catch {\n      toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n    }\n    throw c.redirect(toRedirectTo);\n  }\n);\nvar signOut = createAuthEndpoint(\n  \"/sign-out\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Sign out the current user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessionCookieToken = await ctx.getSignedCookie(\n      ctx.context.authCookies.sessionToken.name,\n      ctx.context.secret\n    );\n    if (!sessionCookieToken) {\n      (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n    await ctx.context.internalAdapter.deleteSession(sessionCookieToken);\n    (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n    return ctx.json({\n      success: true\n    });\n  }\n);\nfunction redirectError(ctx, callbackURL, query) {\n  const url = callbackURL ? new URL(callbackURL, ctx.baseURL) : new URL(`${ctx.baseURL}/error`);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nfunction redirectCallback(ctx, callbackURL, query) {\n  const url = new URL(callbackURL, ctx.baseURL);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nvar forgetPassword = createAuthEndpoint(\n  \"/forget-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The email address of the user to send a password reset email to\"\n      }).email(),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPasswordToken function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json(\n        {\n          status: false\n        },\n        {\n          body: {\n            status: true\n          }\n        }\n      );\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__.getDate)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId)(24);\n    await ctx.context.internalAdapter.createVerificationValue({\n      value: user.user.id.toString(),\n      identifier: `reset-password:${verificationToken}`,\n      expiresAt\n    });\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${redirectTo}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar forgetPasswordCallback = createAuthEndpoint(\n  \"/reset-password/:token\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect the user to reset their password\"\n      })\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Redirects the user to the callback URL with the token\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { token } = ctx.params;\n    const { callbackURL } = ctx.query;\n    if (!token || !callbackURL) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    const verification = await ctx.context.internalAdapter.findVerificationValue(\n      `reset-password:${token}`\n    );\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    throw ctx.redirect(redirectCallback(ctx.context, callbackURL, { token }));\n  }\n);\nvar resetPassword = createAuthEndpoint(\n  \"/reset-password\",\n  {\n    method: \"POST\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    }).optional(),\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The new password to set\"\n      }),\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The token to reset the password\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Reset the password for a user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token || ctx.query?.token;\n    if (!token) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const { newPassword } = ctx.body;\n    const minLength = ctx.context.password?.config.minPasswordLength;\n    const maxLength = ctx.context.password?.config.maxPasswordLength;\n    if (newPassword.length < minLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    if (newPassword.length > maxLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const id = `reset-password:${token}`;\n    const verification = await ctx.context.internalAdapter.findVerificationValue(id);\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    await ctx.context.internalAdapter.deleteVerificationValue(verification.id);\n    const userId = verification.value;\n    const hashedPassword = await ctx.context.password.hash(newPassword);\n    const accounts = await ctx.context.internalAdapter.findAccounts(userId);\n    const account = accounts.find((ac) => ac.providerId === \"credential\");\n    if (!account) {\n      await ctx.context.internalAdapter.createAccount({\n        userId,\n        providerId: \"credential\",\n        password: hashedPassword,\n        accountId: userId\n      });\n      return ctx.json({\n        status: true\n      });\n    }\n    await ctx.context.internalAdapter.updatePassword(userId, hashedPassword);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar updateUser = () => createAuthEndpoint(\n  \"/update-user\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.record(zod__WEBPACK_IMPORTED_MODULE_11__.z.string(), zod__WEBPACK_IMPORTED_MODULE_11__.z.any()),\n    use: [sessionMiddleware],\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Update the current user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The image of the user\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const body = ctx.body;\n    if (body.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.EMAIL_CAN_NOT_BE_UPDATED\n      });\n    }\n    const { name, image, ...rest } = body;\n    const session = ctx.context.session;\n    if (image === void 0 && name === void 0 && Object.keys(rest).length === 0) {\n      return ctx.json({\n        status: true\n      });\n    }\n    const additionalFields = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.parseUserInput)(\n      ctx.context.options,\n      rest,\n      \"update\"\n    );\n    const user = await ctx.context.internalAdapter.updateUser(\n      session.user.id,\n      {\n        name,\n        image,\n        ...additionalFields\n      }\n    );\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n      session: session.session,\n      user\n    });\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar changePassword = createAuthEndpoint(\n  \"/change-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The new password to set\"\n      }),\n      /**\n       * The current password of the user\n       */\n      currentPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The current password\"\n      }),\n      /**\n       * revoke all sessions that are not the\n       * current one logged in by the user\n       */\n      revokeOtherSessions: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n        description: \"Revoke all other sessions\"\n      }).optional()\n    }),\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Change the password of the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      description: \"The user object\",\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { newPassword, currentPassword, revokeOtherSessions: revokeOtherSessions2 } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    if (!account || !account.password) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n      });\n    }\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    const verify = await ctx.context.password.verify({\n      hash: account.password,\n      password: currentPassword\n    });\n    if (!verify) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_PASSWORD\n      });\n    }\n    await ctx.context.internalAdapter.updateAccount(account.id, {\n      password: passwordHash\n    });\n    let token = null;\n    if (revokeOtherSessions2) {\n      await ctx.context.internalAdapter.deleteSessions(session.user.id);\n      const newSession = await ctx.context.internalAdapter.createSession(\n        session.user.id,\n        ctx.headers\n      );\n      if (!newSession) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n        });\n      }\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n        session: newSession,\n        user: session.user\n      });\n      token = newSession.token;\n    }\n    return ctx.json({\n      token,\n      user: {\n        id: session.user.id,\n        email: session.user.email,\n        name: session.user.name,\n        image: session.user.image,\n        emailVerified: session.user.emailVerified,\n        createdAt: session.user.createdAt,\n        updatedAt: session.user.updatedAt\n      }\n    });\n  }\n);\nvar setPassword = createAuthEndpoint(\n  \"/set-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string()\n    }),\n    metadata: {\n      SERVER_ONLY: true\n    },\n    use: [sessionMiddleware]\n  },\n  async (ctx) => {\n    const { newPassword } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    if (!account) {\n      await ctx.context.internalAdapter.linkAccount({\n        userId: session.user.id,\n        providerId: \"credential\",\n        accountId: session.user.id,\n        password: passwordHash\n      });\n      return ctx.json({\n        status: true\n      });\n    }\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n      message: \"user already has a password\"\n    });\n  }\n);\nvar deleteUser = createAuthEndpoint(\n  \"/delete-user\",\n  {\n    method: \"POST\",\n    use: [sessionMiddleware],\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The callback URL to redirect to after the user is deleted\n       * this is only used on delete user callback\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n      /**\n       * The password of the user. If the password isn't provided, session freshness\n       * will be checked.\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n      /**\n       * The token to delete the user. If the token is provided, the user will be deleted\n       */\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Delete the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\",\n        {\n          session: ctx.context.session\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\");\n    }\n    const session = ctx.context.session;\n    if (ctx.body.password) {\n      const accounts = await ctx.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const account = accounts.find(\n        (account2) => account2.providerId === \"credential\" && account2.password\n      );\n      if (!account || !account.password) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n          message: BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n        });\n      }\n      const verify = await ctx.context.password.verify({\n        hash: account.password,\n        password: ctx.body.password\n      });\n      if (!verify) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n          message: BASE_ERROR_CODES.INVALID_PASSWORD\n        });\n      }\n    } else {\n      if (ctx.context.options.session?.freshAge) {\n        const currentAge = session.session.createdAt.getTime();\n        const freshAge = ctx.context.options.session.freshAge;\n        const now = Date.now();\n        if (now - currentAge > freshAge) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n            message: BASE_ERROR_CODES.SESSION_EXPIRED\n          });\n        }\n      }\n    }\n    if (ctx.body.token) {\n      await deleteUserCallback({\n        ...ctx,\n        query: {\n          token: ctx.body.token\n        }\n      });\n      return ctx.json({\n        success: true,\n        message: \"User deleted\"\n      });\n    }\n    if (ctx.context.options.user.deleteUser?.sendDeleteAccountVerification) {\n      const token = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__.generateRandomString)(32, \"0-9\", \"a-z\");\n      await ctx.context.internalAdapter.createVerificationValue({\n        value: session.user.id,\n        identifier: `delete-account-${token}`,\n        expiresAt: new Date(Date.now() + 1e3 * 60 * 60 * 24)\n      });\n      const url = `${ctx.context.baseURL}/delete-user/callback?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.user.deleteUser.sendDeleteAccountVerification(\n        {\n          user: session.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      return ctx.json({\n        success: true,\n        message: \"Verification email sent\"\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nvar deleteUserCallback = createAuthEndpoint(\n  \"/delete-user/callback\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string(),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)]\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\");\n    }\n    const session = await getSessionFromCtx(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n      });\n    }\n    const token = await ctx.context.internalAdapter.findVerificationValue(\n      `delete-account-${ctx.query.token}`\n    );\n    if (!token || token.expiresAt < /* @__PURE__ */ new Date()) {\n      if (token) {\n        await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    if (token.value !== session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n    (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL || \"/\");\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nvar changeEmail = createAuthEndpoint(\n  \"/change-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      newEmail: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The new email to set\"\n      }).email(),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.changeEmail?.enabled) {\n      ctx.context.logger.error(\"Change email is disabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Change email is disabled\"\n      });\n    }\n    if (ctx.body.newEmail === ctx.context.session.user.email) {\n      ctx.context.logger.error(\"Email is the same\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Email is the same\"\n      });\n    }\n    const existingUser = await ctx.context.internalAdapter.findUserByEmail(\n      ctx.body.newEmail\n    );\n    if (existingUser) {\n      ctx.context.logger.error(\"Email already exists\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Couldn't update your email\"\n      });\n    }\n    if (ctx.context.session.user.emailVerified !== true) {\n      await ctx.context.internalAdapter.updateUserByEmail(\n        ctx.context.session.user.email,\n        {\n          email: ctx.body.newEmail\n        }\n      );\n      return ctx.json({\n        status: true\n      });\n    }\n    if (!ctx.context.options.user.changeEmail.sendChangeEmailVerification) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const token = await createEmailVerificationToken(\n      ctx.context.secret,\n      ctx.context.session.user.email,\n      ctx.body.newEmail,\n      ctx.context.options.emailVerification?.expiresIn\n    );\n    const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n    await ctx.context.options.user.changeEmail.sendChangeEmailVerification(\n      {\n        user: ctx.context.session.user,\n        newEmail: ctx.body.newEmail,\n        url,\n        token\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n// src/api/routes/error.ts\nfunction sanitize(input) {\n  return input.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\");\n}\nvar html = (errorCode = \"Unknown\") => `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Authentication Error</title>\n    <style>\n        :root {\n            --bg-color: #f8f9fa;\n            --text-color: #212529;\n            --accent-color: #000000;\n            --error-color: #dc3545;\n            --border-color: #e9ecef;\n        }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            line-height: 1.5;\n        }\n        .error-container {\n            background-color: #ffffff;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n            padding: 2.5rem;\n            text-align: center;\n            max-width: 90%;\n            width: 400px;\n        }\n        h1 {\n            color: var(--error-color);\n            font-size: 1.75rem;\n            margin-bottom: 1rem;\n            font-weight: 600;\n        }\n        p {\n            margin-bottom: 1.5rem;\n            color: #495057;\n        }\n        .btn {\n            background-color: var(--accent-color);\n            color: #ffffff;\n            text-decoration: none;\n            padding: 0.75rem 1.5rem;\n            border-radius: 6px;\n            transition: all 0.3s ease;\n            display: inline-block;\n            font-weight: 500;\n            border: 2px solid var(--accent-color);\n        }\n        .btn:hover {\n            background-color: #131721;\n        }\n        .error-code {\n            font-size: 0.875rem;\n            color: #6c757d;\n            margin-top: 1.5rem;\n            padding-top: 1.5rem;\n            border-top: 1px solid var(--border-color);\n        }\n        .icon {\n            font-size: 3rem;\n            margin-bottom: 1rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"error-container\">\n        <div class=\"icon\">\\u26A0\\uFE0F</div>\n        <h1>Better Auth Error</h1>\n        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>\n        <a href=\"/\" id=\"returnLink\" class=\"btn\">Return to Application</a>\n        <div class=\"error-code\">Error Code: <span id=\"errorCode\">${sanitize(\n  errorCode\n)}</span></div>\n    </div>\n</body>\n</html>`;\nvar error = createAuthEndpoint(\n  \"/error\",\n  {\n    method: \"GET\",\n    metadata: {\n      ..._chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.HIDE_METADATA,\n      openapi: {\n        description: \"Displays an error page\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"text/html\": {\n                schema: {\n                  type: \"string\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const query = new URL(c.request?.url || \"\").searchParams.get(\"error\") || \"Unknown\";\n    return new Response(html(query), {\n      headers: {\n        \"Content-Type\": \"text/html\"\n      }\n    });\n  }\n);\n\n// src/api/routes/ok.ts\nvar ok = createAuthEndpoint(\n  \"/ok\",\n  {\n    method: \"GET\",\n    metadata: {\n      ..._chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.HIDE_METADATA,\n      openapi: {\n        description: \"Check if the API is working\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    ok: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    return ctx.json({\n      ok: true\n    });\n  }\n);\nvar signUpEmail = () => createAuthEndpoint(\n  \"/sign-up/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.record(zod__WEBPACK_IMPORTED_MODULE_11__.z.string(), zod__WEBPACK_IMPORTED_MODULE_11__.z.any()),\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Sign up a user using email and password\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  email: {\n                    type: \"string\",\n                    description: \"The email of the user\"\n                  },\n                  password: {\n                    type: \"string\",\n                    description: \"The password of the user\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  }\n                },\n                required: [\"name\", \"email\", \"password\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\",\n                      description: \"The id of the user\"\n                    },\n                    email: {\n                      type: \"string\",\n                      description: \"The email of the user\"\n                    },\n                    name: {\n                      type: \"string\",\n                      description: \"The name of the user\"\n                    },\n                    image: {\n                      type: \"string\",\n                      description: \"The image of the user\"\n                    },\n                    emailVerified: {\n                      type: \"boolean\",\n                      description: \"If the email is verified\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.enabled) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password sign up is not enabled\"\n      });\n    }\n    const body = ctx.body;\n    const { name, email, password, image, callbackURL, ...additionalFields } = body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_11__.z.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (password.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (password.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const dbUser = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (dbUser?.user) {\n      ctx.context.logger.info(`Sign-up attempt for existing email: ${email}`);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: BASE_ERROR_CODES.USER_ALREADY_EXISTS\n      });\n    }\n    const additionalData = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.parseUserInput)(\n      ctx.context.options,\n      additionalFields\n    );\n    let createdUser;\n    try {\n      createdUser = await ctx.context.internalAdapter.createUser({\n        email: email.toLowerCase(),\n        name,\n        image,\n        ...additionalData,\n        emailVerified: false\n      });\n      if (!createdUser) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n          message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n        });\n      }\n    } catch (e) {\n      if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__.isDevelopment) {\n        ctx.context.logger.error(\"Failed to create user\", e);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER,\n        details: e\n      });\n    }\n    if (!createdUser) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n      });\n    }\n    const hash = await ctx.context.password.hash(password);\n    await ctx.context.internalAdapter.linkAccount({\n      userId: createdUser.id,\n      providerId: \"credential\",\n      accountId: createdUser.id,\n      password: hash\n    });\n    if (ctx.context.options.emailVerification?.sendOnSignUp || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      const token = await createEmailVerificationToken(\n        ctx.context.secret,\n        createdUser.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${body.callbackURL || \"/\"}`;\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: createdUser,\n          url,\n          token\n        },\n        ctx.request\n      );\n    }\n    if (ctx.context.options.emailAndPassword.autoSignIn === false || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      return ctx.json({\n        token: null,\n        user: {\n          id: createdUser.id,\n          email: createdUser.email,\n          name: createdUser.name,\n          image: createdUser.image,\n          emailVerified: createdUser.emailVerified,\n          createdAt: createdUser.createdAt,\n          updatedAt: createdUser.updatedAt\n        }\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      createdUser.id,\n      ctx.request\n    );\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n      session,\n      user: createdUser\n    });\n    return ctx.json({\n      token: session.token,\n      user: {\n        id: createdUser.id,\n        email: createdUser.email,\n        name: createdUser.name,\n        image: createdUser.image,\n        emailVerified: createdUser.emailVerified,\n        createdAt: createdUser.createdAt,\n        updatedAt: createdUser.updatedAt\n      }\n    });\n  }\n);\nvar listUserAccounts = createAuthEndpoint(\n  \"/list-accounts\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"List all accounts linked to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      id: {\n                        type: \"string\"\n                      },\n                      provider: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const accounts = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    return c.json(\n      accounts.map((a) => {\n        return {\n          id: a.id,\n          provider: a.providerId,\n          createdAt: a.createdAt,\n          updatedAt: a.updatedAt,\n          accountId: a.accountId,\n          scopes: a.scope?.split(\",\") || []\n        };\n      })\n    );\n  }\n);\nvar linkSocialAccount = createAuthEndpoint(\n  \"/link-social\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * Callback URL to redirect to after the user has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: zod__WEBPACK_IMPORTED_MODULE_11__.z[\"enum\"](_chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_0__.socialProviderList, {\n        description: \"The OAuth2 provider to use\"\n      })\n    }),\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Link a social account to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    url: {\n                      type: \"string\"\n                    },\n                    redirect: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"url\", \"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const account = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const existingAccount = account.find(\n      (a) => a.providerId === c.body.provider\n    );\n    if (existingAccount) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.SOCIAL_ACCOUNT_ALREADY_LINKED\n      });\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    const state = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__.generateState)(c, {\n      userId: session.user.id,\n      email: session.user.email\n    });\n    const url = await provider.createAuthorizationURL({\n      state: state.state,\n      codeVerifier: state.codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: true\n    });\n  }\n);\nvar unlinkAccount = createAuthEndpoint(\n  \"/unlink-account\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_11__.z.string()\n    }),\n    use: [freshSessionMiddleware]\n  },\n  async (ctx) => {\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      ctx.context.session.user.id\n    );\n    if (accounts.length === 1) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.FAILED_TO_UNLINK_LAST_ACCOUNT\n      });\n    }\n    const accountExist = accounts.find(\n      (account) => account.providerId === ctx.body.providerId\n    );\n    if (!accountExist) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.ACCOUNT_NOT_FOUND\n      });\n    }\n    await ctx.context.internalAdapter.deleteAccount(\n      ctx.body.providerId,\n      ctx.context.session.user.id\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n// src/api/rate-limiter/index.ts\nfunction shouldRateLimit(max, window, rateLimitData) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  const timeSinceLastRequest = now - rateLimitData.lastRequest;\n  return timeSinceLastRequest < windowInMs && rateLimitData.count >= max;\n}\nfunction rateLimitResponse(retryAfter) {\n  return new Response(\n    JSON.stringify({\n      message: \"Too many requests. Please try again later.\"\n    }),\n    {\n      status: 429,\n      statusText: \"Too Many Requests\",\n      headers: {\n        \"X-Retry-After\": retryAfter.toString()\n      }\n    }\n  );\n}\nfunction getRetryAfter(lastRequest, window) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  return Math.ceil((lastRequest + windowInMs - now) / 1e3);\n}\nfunction createDBStorage(ctx, modelName) {\n  const model = ctx.options.rateLimit?.modelName || \"rateLimit\";\n  const db = ctx.adapter;\n  return {\n    get: async (key) => {\n      const res = await db.findMany({\n        model,\n        where: [{ field: \"key\", value: key }]\n      });\n      const data = res[0];\n      if (typeof data?.lastRequest === \"bigint\") {\n        data.lastRequest = Number(data.lastRequest);\n      }\n      return data;\n    },\n    set: async (key, value, _update) => {\n      try {\n        if (_update) {\n          await db.updateMany({\n            model: modelName ?? \"rateLimit\",\n            where: [{ field: \"key\", value: key }],\n            update: {\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        } else {\n          await db.create({\n            model: modelName ?? \"rateLimit\",\n            data: {\n              key,\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        }\n      } catch (e) {\n        ctx.logger.error(\"Error setting rate limit\", e);\n      }\n    }\n  };\n}\nvar memory = /* @__PURE__ */ new Map();\nfunction getRateLimitStorage(ctx) {\n  if (ctx.options.rateLimit?.customStorage) {\n    return ctx.options.rateLimit.customStorage;\n  }\n  if (ctx.rateLimit.storage === \"secondary-storage\") {\n    return {\n      get: async (key) => {\n        const stringified = await ctx.options.secondaryStorage?.get(key);\n        return stringified ? JSON.parse(stringified) : void 0;\n      },\n      set: async (key, value) => {\n        await ctx.options.secondaryStorage?.set?.(key, JSON.stringify(value));\n      }\n    };\n  }\n  const storage = ctx.rateLimit.storage;\n  if (storage === \"memory\") {\n    return {\n      async get(key) {\n        return memory.get(key);\n      },\n      async set(key, value, _update) {\n        memory.set(key, value);\n      }\n    };\n  }\n  return createDBStorage(ctx, ctx.rateLimit.modelName);\n}\nasync function onRequestRateLimit(req, ctx) {\n  if (!ctx.rateLimit.enabled) {\n    return;\n  }\n  const baseURL = ctx.baseURL;\n  const path = req.url.replace(baseURL, \"\").split(\"?\")[0];\n  let window = ctx.rateLimit.window;\n  let max = ctx.rateLimit.max;\n  const key = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.getIp)(req, ctx.options) + path;\n  const specialRules = getDefaultSpecialRules();\n  const specialRule = specialRules.find((rule) => rule.pathMatcher(path));\n  if (specialRule) {\n    window = specialRule.window;\n    max = specialRule.max;\n  }\n  for (const plugin of ctx.options.plugins || []) {\n    if (plugin.rateLimit) {\n      const matchedRule = plugin.rateLimit.find(\n        (rule) => rule.pathMatcher(path)\n      );\n      if (matchedRule) {\n        window = matchedRule.window;\n        max = matchedRule.max;\n        break;\n      }\n    }\n  }\n  if (ctx.rateLimit.customRules) {\n    const _path = Object.keys(ctx.rateLimit.customRules).find((p) => {\n      if (p.includes(\"*\")) {\n        const isMatch2 = wildcardMatch(p)(path);\n        return isMatch2;\n      }\n      return p === path;\n    });\n    if (_path) {\n      const customRule = ctx.rateLimit.customRules[_path];\n      const resolved = typeof customRule === \"function\" ? await customRule(req) : customRule;\n      if (resolved) {\n        window = resolved.window;\n        max = resolved.max;\n      }\n    }\n  }\n  const storage = getRateLimitStorage(ctx);\n  const data = await storage.get(key);\n  const now = Date.now();\n  if (!data) {\n    await storage.set(key, {\n      key,\n      count: 1,\n      lastRequest: now\n    });\n  } else {\n    const timeSinceLastRequest = now - data.lastRequest;\n    if (shouldRateLimit(max, window, data)) {\n      const retryAfter = getRetryAfter(data.lastRequest, window);\n      return rateLimitResponse(retryAfter);\n    } else if (timeSinceLastRequest > window * 1e3) {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: 1,\n          lastRequest: now\n        },\n        true\n      );\n    } else {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: data.count + 1,\n          lastRequest: now\n        },\n        true\n      );\n    }\n  }\n}\nfunction getDefaultSpecialRules() {\n  const specialRules = [\n    {\n      pathMatcher(path) {\n        return path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path.startsWith(\"/change-password\") || path.startsWith(\"/change-email\");\n      },\n      window: 10,\n      max: 3\n    }\n  ];\n  return specialRules;\n}\nfunction getEndpoints(ctx, options) {\n  const pluginEndpoints = options.plugins?.reduce(\n    (acc, plugin) => {\n      return {\n        ...acc,\n        ...plugin.endpoints\n      };\n    },\n    {}\n  );\n  const middlewares = options.plugins?.map(\n    (plugin) => plugin.middlewares?.map((m) => {\n      const middleware = async (context) => {\n        return m.middleware({\n          ...context,\n          context: {\n            ...ctx,\n            ...context.context\n          }\n        });\n      };\n      middleware.path = m.path;\n      middleware.options = m.middleware.options;\n      middleware.headers = m.middleware.headers;\n      return {\n        path: m.path,\n        middleware\n      };\n    })\n  ).filter((plugin) => plugin !== void 0).flat() || [];\n  const baseEndpoints = {\n    signInSocial,\n    callbackOAuth,\n    getSession: getSession(),\n    signOut,\n    signUpEmail: signUpEmail(),\n    signInEmail,\n    forgetPassword,\n    resetPassword,\n    verifyEmail,\n    sendVerificationEmail,\n    changeEmail,\n    changePassword,\n    setPassword,\n    updateUser: updateUser(),\n    deleteUser,\n    forgetPasswordCallback,\n    listSessions: listSessions(),\n    revokeSession,\n    revokeSessions,\n    revokeOtherSessions,\n    linkSocialAccount,\n    listUserAccounts,\n    deleteUserCallback,\n    unlinkAccount\n  };\n  const endpoints = {\n    ...baseEndpoints,\n    ...pluginEndpoints,\n    ok,\n    error\n  };\n  let api = {};\n  for (const [key, endpoint] of Object.entries(endpoints)) {\n    api[key] = async (context = {}) => {\n      endpoint.headers = new Headers();\n      let internalCtx = {\n        setHeader(key2, value) {\n          endpoint.headers.set(key2, value);\n        },\n        setCookie(key2, value, options2) {\n          (0,better_call__WEBPACK_IMPORTED_MODULE_10__.setCookie)(endpoint.headers, key2, value, options2);\n        },\n        getCookie(key2, prefix) {\n          const header = context.headers;\n          const cookieH = header?.get(\"cookie\");\n          const cookie = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.getCookie)(cookieH || \"\", key2, prefix);\n          return cookie;\n        },\n        getSignedCookie(key2, secret, prefix) {\n          const header = context.headers;\n          if (!header) {\n            return null;\n          }\n          const cookie = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.getSignedCookie)(header, secret, key2, prefix);\n          return cookie;\n        },\n        async setSignedCookie(key2, value, secret, options2) {\n          await (0,better_call__WEBPACK_IMPORTED_MODULE_10__.setSignedCookie)(endpoint.headers, key2, value, secret, options2);\n        },\n        redirect(url) {\n          endpoint.headers.set(\"Location\", url);\n          return new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FOUND\");\n        },\n        responseHeader: endpoint.headers\n      };\n      let authCtx = await ctx;\n      let newSession = null;\n      let internalContext = {\n        ...internalCtx,\n        ...context,\n        path: endpoint.path,\n        context: {\n          ...authCtx,\n          ...context.context,\n          session: null,\n          setNewSession: function(session) {\n            this.newSession = session;\n            newSession = session;\n          },\n          returned: void 0\n        },\n        responseHeader: new Headers()\n      };\n      const plugins = options.plugins || [];\n      const beforeHooks = plugins.map((plugin) => {\n        if (plugin.hooks?.before) {\n          return plugin.hooks.before;\n        }\n      }).filter((plugin) => plugin !== void 0).flat();\n      const afterHooks = plugins.map((plugin) => {\n        if (plugin.hooks?.after) {\n          return plugin.hooks.after;\n        }\n      }).filter((plugin) => plugin !== void 0).flat();\n      if (options.hooks?.before) {\n        beforeHooks.push({\n          matcher: () => true,\n          handler: options.hooks.before\n        });\n      }\n      if (options.hooks?.after) {\n        afterHooks.push({\n          matcher: () => true,\n          handler: options.hooks.after\n        });\n      }\n      for (const hook of beforeHooks) {\n        if (!hook.matcher(internalContext)) continue;\n        const hookRes = await hook.handler(internalContext);\n        if (hookRes && \"context\" in hookRes) {\n          internalContext = {\n            ...internalContext,\n            ...hookRes.context\n          };\n          continue;\n        }\n        if (hookRes) {\n          return hookRes;\n        }\n      }\n      let endpointRes;\n      try {\n        endpointRes = await endpoint(internalContext);\n        if (newSession) {\n          internalContext.context.newSession = newSession;\n        }\n      } catch (e) {\n        if (newSession) {\n          internalContext.context.newSession = newSession;\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n          if (!afterHooks?.length) {\n            e.headers = endpoint.headers;\n            throw e;\n          }\n          internalContext.context.returned = e;\n          internalContext.context.returned.headers = endpoint.headers;\n          for (const hook of afterHooks || []) {\n            const match = hook.matcher(internalContext);\n            if (match) {\n              try {\n                const hookRes = await hook.handler(internalContext);\n                if (hookRes && \"response\" in hookRes) {\n                  internalContext.context.returned = hookRes.response;\n                }\n              } catch (e2) {\n                if (e2 instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n                  internalContext.context.returned = e2;\n                  continue;\n                }\n                throw e2;\n              }\n            }\n          }\n          if (internalContext.context.returned instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n            internalContext.context.returned.headers = endpoint.headers;\n            throw internalContext.context.returned;\n          }\n          return internalContext.context.returned;\n        }\n        throw e;\n      }\n      internalContext.context.returned = endpointRes;\n      internalContext.responseHeader = endpoint.headers;\n      for (const hook of afterHooks) {\n        const match = hook.matcher(internalContext);\n        if (match) {\n          try {\n            const hookRes = await hook.handler(internalContext);\n            if (hookRes) {\n              if (\"responseHeader\" in hookRes) {\n                const headers = hookRes.responseHeader;\n                internalContext.responseHeader = headers;\n              } else {\n                internalContext.context.returned = hookRes;\n              }\n            }\n          } catch (e) {\n            if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n              internalContext.context.returned = e;\n              continue;\n            }\n            throw e;\n          }\n        }\n      }\n      const response = internalContext.context.returned;\n      if (response instanceof Response) {\n        endpoint.headers.forEach((value, key2) => {\n          if (key2 === \"set-cookie\") {\n            response.headers.append(key2, value);\n          } else {\n            response.headers.set(key2, value);\n          }\n        });\n      }\n      if (response instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n        response.headers = endpoint.headers;\n        throw response;\n      }\n      return response;\n    };\n    api[key].path = endpoint.path;\n    api[key].method = endpoint.method;\n    api[key].options = endpoint.options;\n    api[key].headers = endpoint.headers;\n  }\n  return {\n    api,\n    middlewares\n  };\n}\nvar router = (ctx, options) => {\n  const { api, middlewares } = getEndpoints(ctx, options);\n  const basePath = new URL(ctx.baseURL).pathname;\n  return (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createRouter)(api, {\n    extraContext: ctx,\n    basePath,\n    routerMiddleware: [\n      {\n        path: \"/**\",\n        middleware: originCheckMiddleware\n      },\n      ...middlewares\n    ],\n    async onRequest(req) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onRequest) {\n          const response = await plugin.onRequest(req, ctx);\n          if (response && \"response\" in response) {\n            return response.response;\n          }\n        }\n      }\n      return onRequestRateLimit(req, ctx);\n    },\n    async onResponse(res) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onResponse) {\n          const response = await plugin.onResponse(res, ctx);\n          if (response) {\n            return response.response;\n          }\n        }\n      }\n      return res;\n    },\n    onError(e) {\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError && e.status === \"FOUND\") {\n        return;\n      }\n      if (options.onAPIError?.throw) {\n        throw e;\n      }\n      if (options.onAPIError?.onError) {\n        options.onAPIError.onError(e, ctx);\n        return;\n      }\n      const optLogLevel = options.logger?.level;\n      const log = optLogLevel === \"error\" || optLogLevel === \"warn\" || optLogLevel === \"debug\" ? _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger : void 0;\n      if (options.logger?.disabled !== true) {\n        if (e && typeof e === \"object\" && \"message\" in e && typeof e.message === \"string\") {\n          if (e.message.includes(\"no column\") || e.message.includes(\"column\") || e.message.includes(\"relation\") || e.message.includes(\"table\") || e.message.includes(\"does not exist\")) {\n            ctx.logger?.error(e.message);\n            return;\n          }\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n          if (e.status === \"INTERNAL_SERVER_ERROR\") {\n            ctx.logger.error(e.status, e);\n          }\n          log?.error(e.message);\n        } else {\n          ctx.logger?.error(\n            e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n            e\n          );\n        }\n      }\n    }\n  });\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstWFlLQktPNlouanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFpRjtBQUNYO0FBQ3NCO0FBQ2hDO0FBQ1k7QUFDUjtBQUNJO0FBQ2hCO0FBQ047QUFDTTtBQUMySDtBQUN4STtBQUNmO0FBQzZCO0FBQ0Y7QUFDQTtBQUNsQjtBQUNROztBQUV6Qyx3QkFBd0IsOERBQWdCO0FBQ3hDO0FBQ0EsQ0FBQztBQUNELDJCQUEyQixxRUFBdUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksOERBQWdCO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNELHlCQUF5QixtRUFBcUI7QUFDOUM7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQSxpTEFBaUwsZ0JBQWdCO0FBQ2pNLGdCQUFnQixLQUFLO0FBQ3JCLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGdCQUFnQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Qsd0JBQXdCO0FBQ3hFLGlCQUFpQix5QkFBeUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsaUJBQWlCO0FBQ2hELHdCQUF3QixpQkFBaUI7QUFDekMsTUFBTTtBQUNOLHNCQUFzQixpQkFBaUI7QUFDdkM7QUFDQTtBQUNBLHlDQUF5QyxpQkFBaUI7QUFDMUQseUNBQXlDLGlCQUFpQjtBQUMxRDtBQUNBO0FBQ0Esa0JBQWtCLHFCQUFxQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FO0FBQ25FO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDZEQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsNkRBQWE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDBDQUFRLENBQUMsMENBQVEsSUFBSSx1Q0FBSztBQUNwQztBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtB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O0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLGtEQUFRO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUUycEIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1YWUtCS082Wi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTb2NpYWxQcm92aWRlckxpc3RFbnVtLCBzb2NpYWxQcm92aWRlckxpc3QgfSBmcm9tICcuL2NodW5rLVZYRFlOQ09YLmpzJztcbmltcG9ydCB7IGdldEhvc3QsIGdldFByb3RvY29sLCBnZXRPcmlnaW4gfSBmcm9tICcuL2NodW5rLVhGQ0lBTlpYLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUsIGRlbGV0ZVNlc3Npb25Db29raWUsIHNldENvb2tpZUNhY2hlIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBwYXJzZVVzZXJJbnB1dCwgZ2V0SXAgfSBmcm9tICcuL2NodW5rLVdaNk9JVkpLLmpzJztcbmltcG9ydCB7IEhJREVfTUVUQURBVEEsIGdlbmVyYXRlSWQsIGxvZ2dlciB9IGZyb20gJy4vY2h1bmstS0xERkJMWUwuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVTdGF0ZSwgcGFyc2VTdGF0ZSB9IGZyb20gJy4vY2h1bmstTlBPNjRTVk4uanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcsIHNpZ25KV1QgfSBmcm9tICcuL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCB7IHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2NodW5rLTUzSVBPMlBKLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IGlzRGV2ZWxvcG1lbnQgfSBmcm9tICcuL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUsIGNyZWF0ZU1pZGRsZXdhcmVDcmVhdG9yLCBjcmVhdGVFbmRwb2ludENyZWF0b3IsIEFQSUVycm9yLCBzZXRDb29raWUsIGdldENvb2tpZSwgZ2V0U2lnbmVkQ29va2llLCBzZXRTaWduZWRDb29raWUsIGNyZWF0ZVJvdXRlciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmV4cG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBjcmVhdGVITUFDIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0IHsgYmFzZTY0IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgeyBiaW5hcnkgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCB7IGp3dFZlcmlmeSB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0IHsgSldURXhwaXJlZCB9IGZyb20gJ2pvc2UvZXJyb3JzJztcblxudmFyIG9wdGlvbnNNaWRkbGV3YXJlID0gY3JlYXRlTWlkZGxld2FyZShhc3luYyAoKSA9PiB7XG4gIHJldHVybiB7fTtcbn0pO1xudmFyIGNyZWF0ZUF1dGhNaWRkbGV3YXJlID0gY3JlYXRlTWlkZGxld2FyZUNyZWF0b3Ioe1xuICB1c2U6IFtcbiAgICBvcHRpb25zTWlkZGxld2FyZSxcbiAgICAvKipcbiAgICAgKiBPbmx5IHVzZSBmb3IgcG9zdCBob29rc1xuICAgICAqL1xuICAgIGNyZWF0ZU1pZGRsZXdhcmUoYXN5bmMgKCkgPT4ge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH0pXG4gIF1cbn0pO1xudmFyIGNyZWF0ZUF1dGhFbmRwb2ludCA9IGNyZWF0ZUVuZHBvaW50Q3JlYXRvcih7XG4gIHVzZTogW29wdGlvbnNNaWRkbGV3YXJlXVxufSk7XG5cbi8vIHNyYy91dGlscy93aWxkY2FyZC50c1xuZnVuY3Rpb24gZXNjYXBlUmVnRXhwQ2hhcihjaGFyKSB7XG4gIGlmIChjaGFyID09PSBcIi1cIiB8fCBjaGFyID09PSBcIl5cIiB8fCBjaGFyID09PSBcIiRcIiB8fCBjaGFyID09PSBcIitcIiB8fCBjaGFyID09PSBcIi5cIiB8fCBjaGFyID09PSBcIihcIiB8fCBjaGFyID09PSBcIilcIiB8fCBjaGFyID09PSBcInxcIiB8fCBjaGFyID09PSBcIltcIiB8fCBjaGFyID09PSBcIl1cIiB8fCBjaGFyID09PSBcIntcIiB8fCBjaGFyID09PSBcIn1cIiB8fCBjaGFyID09PSBcIipcIiB8fCBjaGFyID09PSBcIj9cIiB8fCBjaGFyID09PSBcIlxcXFxcIikge1xuICAgIHJldHVybiBgXFxcXCR7Y2hhcn1gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBjaGFyO1xuICB9XG59XG5mdW5jdGlvbiBlc2NhcGVSZWdFeHBTdHJpbmcoc3RyKSB7XG4gIGxldCByZXN1bHQgPSBcIlwiO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIHJlc3VsdCArPSBlc2NhcGVSZWdFeHBDaGFyKHN0cltpXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybShwYXR0ZXJuLCBzZXBhcmF0b3IgPSB0cnVlKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHBhdHRlcm4pKSB7XG4gICAgbGV0IHJlZ0V4cFBhdHRlcm5zID0gcGF0dGVybi5tYXAoKHApID0+IGBeJHt0cmFuc2Zvcm0ocCwgc2VwYXJhdG9yKX0kYCk7XG4gICAgcmV0dXJuIGAoPzoke3JlZ0V4cFBhdHRlcm5zLmpvaW4oXCJ8XCIpfSlgO1xuICB9XG4gIGxldCBzZXBhcmF0b3JTcGxpdHRlciA9IFwiXCI7XG4gIGxldCBzZXBhcmF0b3JNYXRjaGVyID0gXCJcIjtcbiAgbGV0IHdpbGRjYXJkID0gXCIuXCI7XG4gIGlmIChzZXBhcmF0b3IgPT09IHRydWUpIHtcbiAgICBzZXBhcmF0b3JTcGxpdHRlciA9IFwiL1wiO1xuICAgIHNlcGFyYXRvck1hdGNoZXIgPSBcIlsvXFxcXFxcXFxdXCI7XG4gICAgd2lsZGNhcmQgPSBcIlteL1xcXFxcXFxcXVwiO1xuICB9IGVsc2UgaWYgKHNlcGFyYXRvcikge1xuICAgIHNlcGFyYXRvclNwbGl0dGVyID0gc2VwYXJhdG9yO1xuICAgIHNlcGFyYXRvck1hdGNoZXIgPSBlc2NhcGVSZWdFeHBTdHJpbmcoc2VwYXJhdG9yU3BsaXR0ZXIpO1xuICAgIGlmIChzZXBhcmF0b3JNYXRjaGVyLmxlbmd0aCA+IDEpIHtcbiAgICAgIHNlcGFyYXRvck1hdGNoZXIgPSBgKD86JHtzZXBhcmF0b3JNYXRjaGVyfSlgO1xuICAgICAgd2lsZGNhcmQgPSBgKCg/ISR7c2VwYXJhdG9yTWF0Y2hlcn0pLilgO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aWxkY2FyZCA9IGBbXiR7c2VwYXJhdG9yTWF0Y2hlcn1dYDtcbiAgICB9XG4gIH1cbiAgbGV0IHJlcXVpcmVkU2VwYXJhdG9yID0gc2VwYXJhdG9yID8gYCR7c2VwYXJhdG9yTWF0Y2hlcn0rP2AgOiBcIlwiO1xuICBsZXQgb3B0aW9uYWxTZXBhcmF0b3IgPSBzZXBhcmF0b3IgPyBgJHtzZXBhcmF0b3JNYXRjaGVyfSo/YCA6IFwiXCI7XG4gIGxldCBzZWdtZW50cyA9IHNlcGFyYXRvciA/IHBhdHRlcm4uc3BsaXQoc2VwYXJhdG9yU3BsaXR0ZXIpIDogW3BhdHRlcm5dO1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgZm9yIChsZXQgcyA9IDA7IHMgPCBzZWdtZW50cy5sZW5ndGg7IHMrKykge1xuICAgIGxldCBzZWdtZW50ID0gc2VnbWVudHNbc107XG4gICAgbGV0IG5leHRTZWdtZW50ID0gc2VnbWVudHNbcyArIDFdO1xuICAgIGxldCBjdXJyZW50U2VwYXJhdG9yID0gXCJcIjtcbiAgICBpZiAoIXNlZ21lbnQgJiYgcyA+IDApIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoc2VwYXJhdG9yKSB7XG4gICAgICBpZiAocyA9PT0gc2VnbWVudHMubGVuZ3RoIC0gMSkge1xuICAgICAgICBjdXJyZW50U2VwYXJhdG9yID0gb3B0aW9uYWxTZXBhcmF0b3I7XG4gICAgICB9IGVsc2UgaWYgKG5leHRTZWdtZW50ICE9PSBcIioqXCIpIHtcbiAgICAgICAgY3VycmVudFNlcGFyYXRvciA9IHJlcXVpcmVkU2VwYXJhdG9yO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFNlcGFyYXRvciA9IFwiXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChzZXBhcmF0b3IgJiYgc2VnbWVudCA9PT0gXCIqKlwiKSB7XG4gICAgICBpZiAoY3VycmVudFNlcGFyYXRvcikge1xuICAgICAgICByZXN1bHQgKz0gcyA9PT0gMCA/IFwiXCIgOiBjdXJyZW50U2VwYXJhdG9yO1xuICAgICAgICByZXN1bHQgKz0gYCg/OiR7d2lsZGNhcmR9Kj8ke2N1cnJlbnRTZXBhcmF0b3J9KSo/YDtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBmb3IgKGxldCBjID0gMDsgYyA8IHNlZ21lbnQubGVuZ3RoOyBjKyspIHtcbiAgICAgIGxldCBjaGFyID0gc2VnbWVudFtjXTtcbiAgICAgIGlmIChjaGFyID09PSBcIlxcXFxcIikge1xuICAgICAgICBpZiAoYyA8IHNlZ21lbnQubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHJlc3VsdCArPSBlc2NhcGVSZWdFeHBDaGFyKHNlZ21lbnRbYyArIDFdKTtcbiAgICAgICAgICBjKys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gXCI/XCIpIHtcbiAgICAgICAgcmVzdWx0ICs9IHdpbGRjYXJkO1xuICAgICAgfSBlbHNlIGlmIChjaGFyID09PSBcIipcIikge1xuICAgICAgICByZXN1bHQgKz0gYCR7d2lsZGNhcmR9Kj9gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ICs9IGVzY2FwZVJlZ0V4cENoYXIoY2hhcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdCArPSBjdXJyZW50U2VwYXJhdG9yO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBpc01hdGNoKHJlZ2V4cCwgc2FtcGxlKSB7XG4gIGlmICh0eXBlb2Ygc2FtcGxlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgU2FtcGxlIG11c3QgYmUgYSBzdHJpbmcsIGJ1dCAke3R5cGVvZiBzYW1wbGV9IGdpdmVuYCk7XG4gIH1cbiAgcmV0dXJuIHJlZ2V4cC50ZXN0KHNhbXBsZSk7XG59XG5mdW5jdGlvbiB3aWxkY2FyZE1hdGNoKHBhdHRlcm4sIG9wdGlvbnMpIHtcbiAgaWYgKHR5cGVvZiBwYXR0ZXJuICE9PSBcInN0cmluZ1wiICYmICFBcnJheS5pc0FycmF5KHBhdHRlcm4pKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgIGBUaGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHNpbmdsZSBwYXR0ZXJuIHN0cmluZyBvciBhbiBhcnJheSBvZiBwYXR0ZXJucywgYnV0ICR7dHlwZW9mIHBhdHRlcm59IGdpdmVuYFxuICAgICk7XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBvcHRpb25zID09PSBcImJvb2xlYW5cIikge1xuICAgIG9wdGlvbnMgPSB7IHNlcGFyYXRvcjogb3B0aW9ucyB9O1xuICB9XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyICYmICEodHlwZW9mIG9wdGlvbnMgPT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucyAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheShvcHRpb25zKSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgYFRoZSBzZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBhbiBvcHRpb25zIG9iamVjdCBvciBhIHN0cmluZy9ib29sZWFuIHNlcGFyYXRvciwgYnV0ICR7dHlwZW9mIG9wdGlvbnN9IGdpdmVuYFxuICAgICk7XG4gIH1cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGlmIChvcHRpb25zLnNlcGFyYXRvciA9PT0gXCJcXFxcXCIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcIlxcXFwgaXMgbm90IGEgdmFsaWQgc2VwYXJhdG9yIGJlY2F1c2UgaXQgaXMgdXNlZCBmb3IgZXNjYXBpbmcuIFRyeSBzZXR0aW5nIHRoZSBzZXBhcmF0b3IgdG8gYHRydWVgIGluc3RlYWRcIlxuICAgICk7XG4gIH1cbiAgbGV0IHJlZ2V4cFBhdHRlcm4gPSB0cmFuc2Zvcm0ocGF0dGVybiwgb3B0aW9ucy5zZXBhcmF0b3IpO1xuICBsZXQgcmVnZXhwID0gbmV3IFJlZ0V4cChgXiR7cmVnZXhwUGF0dGVybn0kYCwgb3B0aW9ucy5mbGFncyk7XG4gIGxldCBmbiA9IGlzTWF0Y2guYmluZChudWxsLCByZWdleHApO1xuICBmbi5vcHRpb25zID0gb3B0aW9ucztcbiAgZm4ucGF0dGVybiA9IHBhdHRlcm47XG4gIGZuLnJlZ2V4cCA9IHJlZ2V4cDtcbiAgcmV0dXJuIGZuO1xufVxuXG4vLyBzcmMvYXBpL21pZGRsZXdhcmVzL29yaWdpbi1jaGVjay50c1xudmFyIG9yaWdpbkNoZWNrTWlkZGxld2FyZSA9IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgaWYgKGN0eC5yZXF1ZXN0Py5tZXRob2QgIT09IFwiUE9TVFwiIHx8ICFjdHgucmVxdWVzdCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB7IGJvZHksIHF1ZXJ5LCBjb250ZXh0IH0gPSBjdHg7XG4gIGNvbnN0IG9yaWdpbkhlYWRlciA9IGN0eC5oZWFkZXJzPy5nZXQoXCJvcmlnaW5cIikgfHwgY3R4LmhlYWRlcnM/LmdldChcInJlZmVyZXJcIikgfHwgXCJcIjtcbiAgY29uc3QgY2FsbGJhY2tVUkwgPSBib2R5Py5jYWxsYmFja1VSTCB8fCBxdWVyeT8uY2FsbGJhY2tVUkw7XG4gIGNvbnN0IHJlZGlyZWN0VVJMID0gYm9keT8ucmVkaXJlY3RUbztcbiAgY29uc3QgZXJyb3JDYWxsYmFja1VSTCA9IGJvZHk/LmVycm9yQ2FsbGJhY2tVUkw7XG4gIGNvbnN0IG5ld1VzZXJDYWxsYmFja1VSTCA9IGJvZHk/Lm5ld1VzZXJDYWxsYmFja1VSTDtcbiAgY29uc3QgdHJ1c3RlZE9yaWdpbnMgPSBBcnJheS5pc0FycmF5KGNvbnRleHQub3B0aW9ucy50cnVzdGVkT3JpZ2lucykgPyBjb250ZXh0LnRydXN0ZWRPcmlnaW5zIDogW1xuICAgIC4uLmNvbnRleHQudHJ1c3RlZE9yaWdpbnMsXG4gICAgLi4uY29udGV4dC5vcHRpb25zLnRydXN0ZWRPcmlnaW5zPy4oY3R4LnJlcXVlc3QpIHx8IFtdXG4gIF07XG4gIGNvbnN0IHVzZXNDb29raWVzID0gY3R4LmhlYWRlcnM/LmhhcyhcImNvb2tpZVwiKTtcbiAgY29uc3QgbWF0Y2hlc1BhdHRlcm4gPSAodXJsLCBwYXR0ZXJuKSA9PiB7XG4gICAgaWYgKHVybC5zdGFydHNXaXRoKFwiL1wiKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIipcIikpIHtcbiAgICAgIHJldHVybiB3aWxkY2FyZE1hdGNoKHBhdHRlcm4pKGdldEhvc3QodXJsKSk7XG4gICAgfVxuICAgIGNvbnN0IHByb3RvY29sID0gZ2V0UHJvdG9jb2wodXJsKTtcbiAgICByZXR1cm4gcHJvdG9jb2wgPT09IFwiaHR0cDpcIiB8fCBwcm90b2NvbCA9PT0gXCJodHRwczpcIiB8fCAhcHJvdG9jb2wgPyBwYXR0ZXJuID09PSBnZXRPcmlnaW4odXJsKSA6IHVybC5zdGFydHNXaXRoKHBhdHRlcm4pO1xuICB9O1xuICBjb25zdCB2YWxpZGF0ZVVSTCA9ICh1cmwsIGxhYmVsKSA9PiB7XG4gICAgaWYgKCF1cmwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaXNUcnVzdGVkT3JpZ2luID0gdHJ1c3RlZE9yaWdpbnMuc29tZShcbiAgICAgIChvcmlnaW4pID0+IG1hdGNoZXNQYXR0ZXJuKHVybCwgb3JpZ2luKSB8fCB1cmw/LnN0YXJ0c1dpdGgoXCIvXCIpICYmIGxhYmVsICE9PSBcIm9yaWdpblwiICYmICF1cmwuaW5jbHVkZXMoXCI6XCIpXG4gICAgKTtcbiAgICBpZiAoIWlzVHJ1c3RlZE9yaWdpbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGBJbnZhbGlkICR7bGFiZWx9OiAke3VybH1gKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKFxuICAgICAgICBgSWYgaXQncyBhIHZhbGlkIFVSTCwgcGxlYXNlIGFkZCAke3VybH0gdG8gdHJ1c3RlZE9yaWdpbnMgaW4geW91ciBhdXRoIGNvbmZpZ1xuYCxcbiAgICAgICAgYEN1cnJlbnQgbGlzdCBvZiB0cnVzdGVkT3JpZ2luczogJHt0cnVzdGVkT3JpZ2luc31gXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogYEludmFsaWQgJHtsYWJlbH1gIH0pO1xuICAgIH1cbiAgfTtcbiAgaWYgKHVzZXNDb29raWVzICYmICFjdHguY29udGV4dC5vcHRpb25zLmFkdmFuY2VkPy5kaXNhYmxlQ1NSRkNoZWNrKSB7XG4gICAgdmFsaWRhdGVVUkwob3JpZ2luSGVhZGVyLCBcIm9yaWdpblwiKTtcbiAgfVxuICBjYWxsYmFja1VSTCAmJiB2YWxpZGF0ZVVSTChjYWxsYmFja1VSTCwgXCJjYWxsYmFja1VSTFwiKTtcbiAgcmVkaXJlY3RVUkwgJiYgdmFsaWRhdGVVUkwocmVkaXJlY3RVUkwsIFwicmVkaXJlY3RVUkxcIik7XG4gIGVycm9yQ2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwoZXJyb3JDYWxsYmFja1VSTCwgXCJlcnJvckNhbGxiYWNrVVJMXCIpO1xuICBuZXdVc2VyQ2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwobmV3VXNlckNhbGxiYWNrVVJMLCBcIm5ld1VzZXJDYWxsYmFja1VSTFwiKTtcbn0pO1xudmFyIG9yaWdpbkNoZWNrID0gKGdldFZhbHVlKSA9PiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGlmICghY3R4LnJlcXVlc3QpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgeyBjb250ZXh0IH0gPSBjdHg7XG4gIGNvbnN0IGNhbGxiYWNrVVJMID0gZ2V0VmFsdWUoY3R4KTtcbiAgY29uc3QgdHJ1c3RlZE9yaWdpbnMgPSBBcnJheS5pc0FycmF5KFxuICAgIGNvbnRleHQub3B0aW9ucy50cnVzdGVkT3JpZ2luc1xuICApID8gY29udGV4dC50cnVzdGVkT3JpZ2lucyA6IFtcbiAgICAuLi5jb250ZXh0LnRydXN0ZWRPcmlnaW5zLFxuICAgIC4uLmNvbnRleHQub3B0aW9ucy50cnVzdGVkT3JpZ2lucz8uKGN0eC5yZXF1ZXN0KSB8fCBbXVxuICBdO1xuICBjb25zdCBtYXRjaGVzUGF0dGVybiA9ICh1cmwsIHBhdHRlcm4pID0+IHtcbiAgICBpZiAodXJsLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChwYXR0ZXJuLmluY2x1ZGVzKFwiKlwiKSkge1xuICAgICAgcmV0dXJuIHdpbGRjYXJkTWF0Y2gocGF0dGVybikoZ2V0SG9zdCh1cmwpKTtcbiAgICB9XG4gICAgcmV0dXJuIHVybC5zdGFydHNXaXRoKHBhdHRlcm4pO1xuICB9O1xuICBjb25zdCB2YWxpZGF0ZVVSTCA9ICh1cmwsIGxhYmVsKSA9PiB7XG4gICAgaWYgKCF1cmwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaXNUcnVzdGVkT3JpZ2luID0gdHJ1c3RlZE9yaWdpbnMuc29tZShcbiAgICAgIChvcmlnaW4pID0+IG1hdGNoZXNQYXR0ZXJuKHVybCwgb3JpZ2luKSB8fCB1cmw/LnN0YXJ0c1dpdGgoXCIvXCIpICYmIGxhYmVsICE9PSBcIm9yaWdpblwiICYmICF1cmwuaW5jbHVkZXMoXCI6XCIpXG4gICAgKTtcbiAgICBpZiAoIWlzVHJ1c3RlZE9yaWdpbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGBJbnZhbGlkICR7bGFiZWx9OiAke3VybH1gKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKFxuICAgICAgICBgSWYgaXQncyBhIHZhbGlkIFVSTCwgcGxlYXNlIGFkZCAke3VybH0gdG8gdHJ1c3RlZE9yaWdpbnMgaW4geW91ciBhdXRoIGNvbmZpZ1xuYCxcbiAgICAgICAgYEN1cnJlbnQgbGlzdCBvZiB0cnVzdGVkT3JpZ2luczogJHt0cnVzdGVkT3JpZ2luc31gXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogYEludmFsaWQgJHtsYWJlbH1gIH0pO1xuICAgIH1cbiAgfTtcbiAgY2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwoY2FsbGJhY2tVUkwsIFwiY2FsbGJhY2tVUkxcIik7XG59KTtcblxuLy8gc3JjL2Vycm9yL2NvZGVzLnRzXG52YXIgQkFTRV9FUlJPUl9DT0RFUyA9IHtcbiAgVVNFUl9OT1RfRk9VTkQ6IFwiVXNlciBub3QgZm91bmRcIixcbiAgRkFJTEVEX1RPX0NSRUFURV9VU0VSOiBcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiLFxuICBGQUlMRURfVE9fQ1JFQVRFX1NFU1NJT046IFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCIsXG4gIEZBSUxFRF9UT19VUERBVEVfVVNFUjogXCJGYWlsZWQgdG8gdXBkYXRlIHVzZXJcIixcbiAgRkFJTEVEX1RPX0dFVF9TRVNTSU9OOiBcIkZhaWxlZCB0byBnZXQgc2Vzc2lvblwiLFxuICBJTlZBTElEX1BBU1NXT1JEOiBcIkludmFsaWQgcGFzc3dvcmRcIixcbiAgSU5WQUxJRF9FTUFJTDogXCJJbnZhbGlkIGVtYWlsXCIsXG4gIElOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkQ6IFwiSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZFwiLFxuICBTT0NJQUxfQUNDT1VOVF9BTFJFQURZX0xJTktFRDogXCJTb2NpYWwgYWNjb3VudCBhbHJlYWR5IGxpbmtlZFwiLFxuICBQUk9WSURFUl9OT1RfRk9VTkQ6IFwiUHJvdmlkZXIgbm90IGZvdW5kXCIsXG4gIElOVkFMSURfVE9LRU46IFwiaW52YWxpZCB0b2tlblwiLFxuICBJRF9UT0tFTl9OT1RfU1VQUE9SVEVEOiBcImlkX3Rva2VuIG5vdCBzdXBwb3J0ZWRcIixcbiAgRkFJTEVEX1RPX0dFVF9VU0VSX0lORk86IFwiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9cIixcbiAgVVNFUl9FTUFJTF9OT1RfRk9VTkQ6IFwiVXNlciBlbWFpbCBub3QgZm91bmRcIixcbiAgRU1BSUxfTk9UX1ZFUklGSUVEOiBcIkVtYWlsIG5vdCB2ZXJpZmllZFwiLFxuICBQQVNTV09SRF9UT09fU0hPUlQ6IFwiUGFzc3dvcmQgdG9vIHNob3J0XCIsXG4gIFBBU1NXT1JEX1RPT19MT05HOiBcIlBhc3N3b3JkIHRvbyBsb25nXCIsXG4gIFVTRVJfQUxSRUFEWV9FWElTVFM6IFwiVXNlciBhbHJlYWR5IGV4aXN0c1wiLFxuICBFTUFJTF9DQU5fTk9UX0JFX1VQREFURUQ6IFwiRW1haWwgY2FuIG5vdCBiZSB1cGRhdGVkXCIsXG4gIENSRURFTlRJQUxfQUNDT1VOVF9OT1RfRk9VTkQ6IFwiQ3JlZGVudGlhbCBhY2NvdW50IG5vdCBmb3VuZFwiLFxuICBTRVNTSU9OX0VYUElSRUQ6IFwiU2Vzc2lvbiBleHBpcmVkLiBSZS1hdXRoZW50aWNhdGUgdG8gcGVyZm9ybSB0aGlzIGFjdGlvbi5cIixcbiAgRkFJTEVEX1RPX1VOTElOS19MQVNUX0FDQ09VTlQ6IFwiWW91IGNhbid0IHVubGluayB5b3VyIGxhc3QgYWNjb3VudFwiLFxuICBBQ0NPVU5UX05PVF9GT1VORDogXCJBY2NvdW50IG5vdCBmb3VuZFwiXG59O1xudmFyIGdldFNlc3Npb24gPSAoKSA9PiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2dldC1zZXNzaW9uXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub3B0aW9uYWwoXG4gICAgICB6Lm9iamVjdCh7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBjb29raWUgY2FjaGUgaXMgZW5hYmxlZCwgaXQgd2lsbCBkaXNhYmxlIHRoZSBjYWNoZVxuICAgICAgICAgKiBhbmQgZmV0Y2ggdGhlIHNlc3Npb24gZnJvbSB0aGUgZGF0YWJhc2VcbiAgICAgICAgICovXG4gICAgICAgIGRpc2FibGVDb29raWVDYWNoZTogei5vcHRpb25hbChcbiAgICAgICAgICB6LmJvb2xlYW4oe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBjb29raWUgY2FjaGUgYW5kIGZldGNoIHNlc3Npb24gZnJvbSBkYXRhYmFzZVwiXG4gICAgICAgICAgfSkub3Ioei5zdHJpbmcoKS50cmFuc2Zvcm0oKHYpID0+IHYgPT09IFwidHJ1ZVwiKSlcbiAgICAgICAgKS5vcHRpb25hbCgpLFxuICAgICAgICBkaXNhYmxlUmVmcmVzaDogei5ib29sZWFuKHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIHNlc3Npb24gcmVmcmVzaC4gVXNlZnVsIGZvciBjaGVja2luZyBzZXNzaW9uIHN0YXR1cywgd2l0aG91dCB1cGRhdGluZyB0aGUgc2Vzc2lvblwiXG4gICAgICAgIH0pLm9yKHouc3RyaW5nKCkudHJhbnNmb3JtKCh2KSA9PiB2ID09PSBcInRydWVcIikpLm9wdGlvbmFsKClcbiAgICAgIH0pXG4gICAgKSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGN1cnJlbnQgc2Vzc2lvblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZXNzaW9uQ29va2llVG9rZW4gPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZSxcbiAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICApO1xuICAgICAgaWYgKCFzZXNzaW9uQ29va2llVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbkRhdGFDb29raWUgPSBjdHguZ2V0Q29va2llKFxuICAgICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lXG4gICAgICApO1xuICAgICAgY29uc3Qgc2Vzc2lvbkRhdGFQYXlsb2FkID0gc2Vzc2lvbkRhdGFDb29raWUgPyBzYWZlSlNPTlBhcnNlKGJpbmFyeS5kZWNvZGUoYmFzZTY0LmRlY29kZShzZXNzaW9uRGF0YUNvb2tpZSkpKSA6IG51bGw7XG4gICAgICBpZiAoc2Vzc2lvbkRhdGFQYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnZlcmlmeShcbiAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb24pLFxuICAgICAgICAgIHNlc3Npb25EYXRhUGF5bG9hZC5zaWduYXR1cmVcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgZG9udFJlbWVtYmVyTWUgPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICk7XG4gICAgICBpZiAoc2Vzc2lvbkRhdGFQYXlsb2FkPy5zZXNzaW9uICYmIGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/LmVuYWJsZWQgJiYgIWN0eC5xdWVyeT8uZGlzYWJsZUNvb2tpZUNhY2hlKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb24yID0gc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb247XG4gICAgICAgIGNvbnN0IGhhc0V4cGlyZWQgPSBzZXNzaW9uRGF0YVBheWxvYWQuZXhwaXJlc0F0IDwgRGF0ZS5ub3coKSB8fCBzZXNzaW9uMi5zZXNzaW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAoIWhhc0V4cGlyZWQpIHtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgICAgICBzZXNzaW9uMlxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgZGF0YUNvb2tpZSA9IGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm5hbWU7XG4gICAgICAgICAgY3R4LnNldENvb2tpZShkYXRhQ29va2llLCBcIlwiLCB7XG4gICAgICAgICAgICBtYXhBZ2U6IDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbihzZXNzaW9uQ29va2llVG9rZW4pO1xuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICBpZiAoIXNlc3Npb24gfHwgc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgaWYgKHNlc3Npb24pIHtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlblxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwpO1xuICAgICAgfVxuICAgICAgaWYgKGRvbnRSZW1lbWJlck1lIHx8IGN0eC5xdWVyeT8uZGlzYWJsZVJlZnJlc2gpIHtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgIHNlc3Npb25cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4cGlyZXNJbiA9IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZXhwaXJlc0luO1xuICAgICAgY29uc3QgdXBkYXRlQWdlID0gY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy51cGRhdGVBZ2U7XG4gICAgICBjb25zdCBzZXNzaW9uSXNEdWVUb0JlVXBkYXRlZERhdGUgPSBzZXNzaW9uLnNlc3Npb24uZXhwaXJlc0F0LnZhbHVlT2YoKSAtIGV4cGlyZXNJbiAqIDFlMyArIHVwZGF0ZUFnZSAqIDFlMztcbiAgICAgIGNvbnN0IHNob3VsZEJlVXBkYXRlZCA9IHNlc3Npb25Jc0R1ZVRvQmVVcGRhdGVkRGF0ZSA8PSBEYXRlLm5vdygpO1xuICAgICAgaWYgKHNob3VsZEJlVXBkYXRlZCkge1xuICAgICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVTZXNzaW9uKFxuICAgICAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICB7XG4gICAgICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUoY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy5leHBpcmVzSW4sIFwic2VjXCIpXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBpZiAoIXVwZGF0ZWRTZXNzaW9uKSB7XG4gICAgICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7IHN0YXR1czogNDAxIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1heEFnZSA9ICh1cGRhdGVkU2Vzc2lvbi5leHBpcmVzQXQudmFsdWVPZigpIC0gRGF0ZS5ub3coKSkgLyAxZTM7XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoXG4gICAgICAgICAgY3R4LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHNlc3Npb246IHVwZGF0ZWRTZXNzaW9uLFxuICAgICAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtYXhBZ2VcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgc2Vzc2lvbjogdXBkYXRlZFNlc3Npb24sXG4gICAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgc2V0Q29va2llQ2FjaGUoY3R4LCBzZXNzaW9uKTtcbiAgICAgIHJldHVybiBjdHguanNvbihcbiAgICAgICAgc2Vzc2lvblxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcjIpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCBlcnJvcjIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuKTtcbnZhciBnZXRTZXNzaW9uRnJvbUN0eCA9IGFzeW5jIChjdHgsIGNvbmZpZykgPT4ge1xuICBpZiAoY3R4LmNvbnRleHQuc2Vzc2lvbikge1xuICAgIHJldHVybiBjdHguY29udGV4dC5zZXNzaW9uO1xuICB9XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKCkoe1xuICAgIC4uLmN0eCxcbiAgICBfZmxhZzogXCJqc29uXCIsXG4gICAgaGVhZGVyczogY3R4LmhlYWRlcnMsXG4gICAgcXVlcnk6IHsgLi4uY3R4LnF1ZXJ5LCAuLi5jb25maWcgfVxuICB9KS5jYXRjaCgoZSkgPT4ge1xuICAgIHJldHVybiBudWxsO1xuICB9KTtcbiAgY3R4LmNvbnRleHQuc2Vzc2lvbiA9IHNlc3Npb247XG4gIHJldHVybiBzZXNzaW9uO1xufTtcbnZhciBzZXNzaW9uTWlkZGxld2FyZSA9IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gIGlmICghc2Vzc2lvbj8uc2Vzc2lvbikge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHNlc3Npb25cbiAgfTtcbn0pO1xudmFyIGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZnJlc2hBZ2UgPT09IDApIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvblxuICAgIH07XG4gIH1cbiAgY29uc3QgZnJlc2hBZ2UgPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlO1xuICBjb25zdCBsYXN0VXBkYXRlZCA9IHNlc3Npb24uc2Vzc2lvbi51cGRhdGVkQXQ/LnZhbHVlT2YoKSB8fCBzZXNzaW9uLnNlc3Npb24uY3JlYXRlZEF0LnZhbHVlT2YoKTtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgaXNGcmVzaCA9IG5vdyAtIGxhc3RVcGRhdGVkIDwgZnJlc2hBZ2UgKiAxZTM7XG4gIGlmICghaXNGcmVzaCkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlNlc3Npb24gaXMgbm90IGZyZXNoXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHNlc3Npb25cbiAgfTtcbn0pO1xudmFyIGxpc3RTZXNzaW9ucyA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvbGlzdC1zZXNzaW9uc1wiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJMaXN0IGFsbCBhY3RpdmUgc2Vzc2lvbnMgZm9yIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saXN0U2Vzc2lvbnMoXG4gICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGNvbnN0IGFjdGl2ZVNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKChzZXNzaW9uKSA9PiB7XG4gICAgICByZXR1cm4gc2Vzc2lvbi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICBhY3RpdmVTZXNzaW9uc1xuICAgICk7XG4gIH1cbik7XG52YXIgcmV2b2tlU2Vzc2lvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLXNlc3Npb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIHJldm9rZVwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYSBzaW5nbGUgc2Vzc2lvblwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInRva2VuXCJdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IGN0eC5ib2R5LnRva2VuO1xuICAgIGNvbnN0IGZpbmRTZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRTZXNzaW9uKHRva2VuKTtcbiAgICBpZiAoIWZpbmRTZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiU2Vzc2lvbiBub3QgZm91bmRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChmaW5kU2Vzc2lvbi5zZXNzaW9uLnVzZXJJZCAhPT0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbih0b2tlbik7XG4gICAgfSBjYXRjaCAoZXJyb3IyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGVycm9yMiAmJiB0eXBlb2YgZXJyb3IyID09PSBcIm9iamVjdFwiICYmIFwibmFtZVwiIGluIGVycm9yMiA/IGVycm9yMi5uYW1lIDogXCJcIixcbiAgICAgICAgZXJyb3IyXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG52YXIgcmV2b2tlU2Vzc2lvbnMgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jldm9rZS1zZXNzaW9uc1wiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGFsbCBzZXNzaW9ucyBmb3IgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJzdGF0dXNcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKFxuICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGVycm9yMiAmJiB0eXBlb2YgZXJyb3IyID09PSBcIm9iamVjdFwiICYmIFwibmFtZVwiIGluIGVycm9yMiA/IGVycm9yMi5uYW1lIDogXCJcIixcbiAgICAgICAgZXJyb3IyXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG52YXIgcmV2b2tlT3RoZXJTZXNzaW9ucyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLW90aGVyLXNlc3Npb25zXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYWxsIG90aGVyIHNlc3Npb25zIGZvciB0aGUgdXNlciBleGNlcHQgdGhlIGN1cnJlbnQgb25lXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBpZiAoIXNlc3Npb24udXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saXN0U2Vzc2lvbnMoXG4gICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGNvbnN0IGFjdGl2ZVNlc3Npb25zID0gc2Vzc2lvbnMuZmlsdGVyKChzZXNzaW9uMikgPT4ge1xuICAgICAgcmV0dXJuIHNlc3Npb24yLmV4cGlyZXNBdCA+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgIH0pO1xuICAgIGNvbnN0IG90aGVyU2Vzc2lvbnMgPSBhY3RpdmVTZXNzaW9ucy5maWx0ZXIoXG4gICAgICAoc2Vzc2lvbjIpID0+IHNlc3Npb24yLnRva2VuICE9PSBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24udG9rZW5cbiAgICApO1xuICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgb3RoZXJTZXNzaW9ucy5tYXAoXG4gICAgICAgIChzZXNzaW9uMikgPT4gY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oc2Vzc2lvbjIudG9rZW4pXG4gICAgICApXG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5hc3luYyBmdW5jdGlvbiBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKHNlY3JldCwgZW1haWwsIHVwZGF0ZVRvLCBleHBpcmVzSW4gPSAzNjAwKSB7XG4gIGNvbnN0IHRva2VuID0gYXdhaXQgc2lnbkpXVChcbiAgICB7XG4gICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgIHVwZGF0ZVRvXG4gICAgfSxcbiAgICBzZWNyZXQsXG4gICAgZXhwaXJlc0luXG4gICk7XG4gIHJldHVybiB0b2tlbjtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNlbmRWZXJpZmljYXRpb25FbWFpbEZuKGN0eCwgdXNlcikge1xuICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCkge1xuICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgIHVzZXIuZW1haWwsXG4gICAgdm9pZCAwLFxuICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICApO1xuICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLnNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICB7XG4gICAgICB1c2VyLFxuICAgICAgdXJsLFxuICAgICAgdG9rZW5cbiAgICB9LFxuICAgIGN0eC5yZXF1ZXN0XG4gICk7XG59XG52YXIgc2VuZFZlcmlmaWNhdGlvbkVtYWlsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zZW5kLXZlcmlmaWNhdGlvbi1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgdG8gc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGVtYWlsIHRvXCJcbiAgICAgIH0pLmVtYWlsKCksXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHVzZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGNhbGxiYWNrXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTZW5kIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgdG8gc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGVtYWlsIHRvXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBjYWxsYmFja1VSTDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHVzZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGNhbGxiYWNrXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJlbWFpbFwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWwpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4oY3R4LCB1c2VyLnVzZXIpO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbnZhciB2ZXJpZnlFbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvdmVyaWZ5LWVtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byB2ZXJpZnkgdGhlIGVtYWlsXCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciBlbWFpbCB2ZXJpZmljYXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmeSB0aGUgZW1haWwgb2YgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ1c2VyXCIsIFwic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgZnVuY3Rpb24gcmVkaXJlY3RPbkVycm9yKGVycm9yMikge1xuICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMLmluY2x1ZGVzKFwiP1wiKSkge1xuICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9JmVycm9yPSR7ZXJyb3IyfWApO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9P2Vycm9yPSR7ZXJyb3IyfWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IyXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gY3R4LnF1ZXJ5O1xuICAgIGxldCBqd3Q7XG4gICAgdHJ5IHtcbiAgICAgIGp3dCA9IGF3YWl0IGp3dFZlcmlmeShcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjdHguY29udGV4dC5zZWNyZXQpLFxuICAgICAgICB7XG4gICAgICAgICAgYWxnb3JpdGhtczogW1wiSFMyNTZcIl1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEpXVEV4cGlyZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInRva2VuX2V4cGlyZWRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiaW52YWxpZF90b2tlblwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2NoZW1hMiA9IHoub2JqZWN0KHtcbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLmVtYWlsKCksXG4gICAgICB1cGRhdGVUbzogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSk7XG4gICAgY29uc3QgcGFyc2VkID0gc2NoZW1hMi5wYXJzZShqd3QucGF5bG9hZCk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoXG4gICAgICBwYXJzZWQuZW1haWxcbiAgICApO1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVzZXJfbm90X2ZvdW5kXCIpO1xuICAgIH1cbiAgICBpZiAocGFyc2VkLnVwZGF0ZVRvKSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5xdWVyeS5jYWxsYmFja1VSTH0/ZXJyb3I9dW5hdXRob3JpemVkYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYXV0aG9yaXplZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChzZXNzaW9uLnVzZXIuZW1haWwgIT09IHBhcnNlZC5lbWFpbCkge1xuICAgICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5xdWVyeS5jYWxsYmFja1VSTH0/ZXJyb3I9dW5hdXRob3JpemVkYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYXV0aG9yaXplZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXJCeUVtYWlsKFxuICAgICAgICBwYXJzZWQuZW1haWwsXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogcGFyc2VkLnVwZGF0ZVRvLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBjb25zdCBuZXdUb2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgcGFyc2VkLnVwZGF0ZVRvXG4gICAgICApO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsPy4oXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiB1cGRhdGVkVXNlcixcbiAgICAgICAgICB1cmw6IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke25ld1Rva2VufWAsXG4gICAgICAgICAgdG9rZW46IG5ld1Rva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgLi4uc2Vzc2lvbi51c2VyLFxuICAgICAgICAgIGVtYWlsOiBwYXJzZWQudXBkYXRlVG8sXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2VcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChjdHgucXVlcnkuY2FsbGJhY2tVUkwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVwZGF0ZWRVc2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1cGRhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiB1cGRhdGVkVXNlci5uYW1lLFxuICAgICAgICAgIGltYWdlOiB1cGRhdGVkVXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1cGRhdGVkVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogdXBkYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogdXBkYXRlZFVzZXIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlckJ5RW1haWwocGFyc2VkLmVtYWlsLCB7XG4gICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgfSk7XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmF1dG9TaWduSW5BZnRlclZlcmlmaWNhdGlvbikge1xuICAgICAgY29uc3QgY3VycmVudFNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgICAgaWYgKCFjdXJyZW50U2Vzc2lvbiB8fCBjdXJyZW50U2Vzc2lvbi51c2VyLmVtYWlsICE9PSBwYXJzZWQuZW1haWwpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgIHVzZXIudXNlci5pZCxcbiAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICApO1xuICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi51c2VyLnVzZXIsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgc2Vzc2lvbjogY3VycmVudFNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi5jdXJyZW50U2Vzc2lvbi51c2VyLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgIHRocm93IGN0eC5yZWRpcmVjdChjdHgucXVlcnkuY2FsbGJhY2tVUkwpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgdXNlcjogbnVsbFxuICAgIH0pO1xuICB9XG4pO1xuXG4vLyBzcmMvb2F1dGgyL2xpbmstYWNjb3VudC50c1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlT0F1dGhVc2VySW5mbyhjLCB7XG4gIHVzZXJJbmZvLFxuICBhY2NvdW50LFxuICBjYWxsYmFja1VSTFxufSkge1xuICBjb25zdCBkYlVzZXIgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRPQXV0aFVzZXIoXG4gICAgdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICBhY2NvdW50LmFjY291bnRJZCxcbiAgICBhY2NvdW50LnByb3ZpZGVySWRcbiAgKS5jYXRjaCgoZSkgPT4ge1xuICAgIGxvZ2dlci5lcnJvcihcbiAgICAgIFwiQmV0dGVyIGF1dGggd2FzIHVuYWJsZSB0byBxdWVyeSB5b3VyIGRhdGFiYXNlLlxcbkVycm9yOiBcIixcbiAgICAgIGVcbiAgICApO1xuICAgIHRocm93IGMucmVkaXJlY3QoXG4gICAgICBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9aW50ZXJuYWxfc2VydmVyX2Vycm9yYFxuICAgICk7XG4gIH0pO1xuICBsZXQgdXNlciA9IGRiVXNlcj8udXNlcjtcbiAgbGV0IGlzUmVnaXN0ZXIgPSAhdXNlcjtcbiAgaWYgKGRiVXNlcikge1xuICAgIGNvbnN0IGhhc0JlZW5MaW5rZWQgPSBkYlVzZXIuYWNjb3VudHMuZmluZChcbiAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IGFjY291bnQucHJvdmlkZXJJZFxuICAgICk7XG4gICAgaWYgKCFoYXNCZWVuTGlua2VkKSB7XG4gICAgICBjb25zdCB0cnVzdGVkUHJvdmlkZXJzID0gYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnRydXN0ZWRQcm92aWRlcnM7XG4gICAgICBjb25zdCBpc1RydXN0ZWRQcm92aWRlciA9IHRydXN0ZWRQcm92aWRlcnM/LmluY2x1ZGVzKFxuICAgICAgICBhY2NvdW50LnByb3ZpZGVySWRcbiAgICAgICk7XG4gICAgICBpZiAoIWlzVHJ1c3RlZFByb3ZpZGVyICYmICF1c2VySW5mby5lbWFpbFZlcmlmaWVkIHx8IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgICBpZiAoaXNEZXZlbG9wbWVudCkge1xuICAgICAgICAgIGxvZ2dlci53YXJuKFxuICAgICAgICAgICAgYFVzZXIgYWxyZWFkeSBleGlzdCBidXQgYWNjb3VudCBpc24ndCBsaW5rZWQgdG8gJHthY2NvdW50LnByb3ZpZGVySWR9LiBUbyByZWFkIG1vcmUgYWJvdXQgaG93IGFjY291bnQgbGlua2luZyB3b3JrcyBpbiBCZXR0ZXIgQXV0aCBzZWUgaHR0cHM6Ly93d3cuYmV0dGVyLWF1dGguY29tL2RvY3MvY29uY2VwdHMvdXNlcnMtYWNjb3VudHMjYWNjb3VudC1saW5raW5nLmBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZXJyb3I6IFwiYWNjb3VudCBub3QgbGlua2VkXCIsXG4gICAgICAgICAgZGF0YTogbnVsbFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudCh7XG4gICAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkLFxuICAgICAgICAgIGFjY291bnRJZDogdXNlckluZm8uaWQudG9TdHJpbmcoKSxcbiAgICAgICAgICB1c2VySWQ6IGRiVXNlci51c2VyLmlkLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2NvdW50LmFjY2Vzc1Rva2VuLFxuICAgICAgICAgIGlkVG9rZW46IGFjY291bnQuaWRUb2tlbixcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGFjY291bnQucmVmcmVzaFRva2VuLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5yZWZyZXNoVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGVcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIlVuYWJsZSB0byBsaW5rIGFjY291bnRcIiwgZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZXJyb3I6IFwidW5hYmxlIHRvIGxpbmsgYWNjb3VudFwiLFxuICAgICAgICAgIGRhdGE6IG51bGxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoe1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2NvdW50LmFjY2Vzc1Rva2VuLFxuICAgICAgICAgIGlkVG9rZW46IGFjY291bnQuaWRUb2tlbixcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGFjY291bnQucmVmcmVzaFRva2VuLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5yZWZyZXNoVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGVcbiAgICAgICAgfSkuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gdm9pZCAwKVxuICAgICAgKTtcbiAgICAgIGlmIChPYmplY3Qua2V5cyh1cGRhdGVEYXRhKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChcbiAgICAgICAgICBoYXNCZWVuTGlua2VkLmlkLFxuICAgICAgICAgIHVwZGF0ZURhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIHVzZXIgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZU9BdXRoVXNlcihcbiAgICAgICAge1xuICAgICAgICAgIC4uLnVzZXJJbmZvLFxuICAgICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgIGlkOiB2b2lkIDBcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2NvdW50LmFjY2Vzc1Rva2VuLFxuICAgICAgICAgIGlkVG9rZW46IGFjY291bnQuaWRUb2tlbixcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGFjY291bnQucmVmcmVzaFRva2VuLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5yZWZyZXNoVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGUsXG4gICAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkLFxuICAgICAgICAgIGFjY291bnRJZDogdXNlckluZm8uaWQudG9TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICApLnRoZW4oKHJlcykgPT4gcmVzPy51c2VyKTtcbiAgICAgIGlmICghdXNlckluZm8uZW1haWxWZXJpZmllZCAmJiB1c2VyICYmIGMuY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduVXApIHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICAgIGMuY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgdXNlci5lbWFpbCxcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgYy5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICAgICApO1xuICAgICAgICBjb25zdCB1cmwgPSBgJHtjLmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y2FsbGJhY2tVUkx9YDtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB0b2tlblxuICAgICAgICAgIH0sXG4gICAgICAgICAgYy5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nZ2VyLmVycm9yKGUpO1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBlLm1lc3NhZ2UsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXJyb3I6IFwidW5hYmxlIHRvIGNyZWF0ZSB1c2VyXCIsXG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBpZiAoIXVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3I6IFwidW5hYmxlIHRvIGNyZWF0ZSB1c2VyXCIsXG4gICAgICBkYXRhOiBudWxsLFxuICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICB9O1xuICB9XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgdXNlci5pZCxcbiAgICBjLnJlcXVlc3RcbiAgKTtcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiBcInVuYWJsZSB0byBjcmVhdGUgc2Vzc2lvblwiLFxuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb24sXG4gICAgICB1c2VyXG4gICAgfSxcbiAgICBlcnJvcjogbnVsbCxcbiAgICBpc1JlZ2lzdGVyXG4gIH07XG59XG5cbi8vIHNyYy9hcGkvcm91dGVzL3NpZ24taW4udHNcbnZhciBzaWduSW5Tb2NpYWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NpZ24taW4vc29jaWFsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyXG4gICAgICAgKiBoYXMgc2lnbmVkIGluLlxuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDYWxsYmFjayBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHVzZXIgaGFzIHNpZ25lZCBpblwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBjYWxsYmFjayB1cmwgdG8gcmVkaXJlY3QgaWYgdGhlIHVzZXIgaXMgbmV3bHkgcmVnaXN0ZXJlZC5cbiAgICAgICAqXG4gICAgICAgKiB1c2VmdWwgaWYgeW91IGhhdmUgZGlmZmVyZW50IHJvdXRlcyBmb3IgZXhpc3RpbmcgdXNlcnMgYW5kIG5ldyB1c2Vyc1xuICAgICAgICovXG4gICAgICBuZXdVc2VyQ2FsbGJhY2tVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgdXJsIHRvIHJlZGlyZWN0IHRvIGlmIGFuIGVycm9yIGhhcHBlbnNcbiAgICAgICAqXG4gICAgICAgKiBJZiBpdCdzIGluaXRpYXRlZCBmcm9tIHRoZSBjbGllbnQgc2RrIHRoaXMgZGVmYXVsdHMgdG9cbiAgICAgICAqIHRoZSBjdXJyZW50IHVybC5cbiAgICAgICAqL1xuICAgICAgZXJyb3JDYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDYWxsYmFjayBVUkwgdG8gcmVkaXJlY3QgdG8gaWYgYW4gZXJyb3IgaGFwcGVuc1wiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBPQXV0aDIgcHJvdmlkZXIgdG8gdXNlYFxuICAgICAgICovXG4gICAgICBwcm92aWRlcjogU29jaWFsUHJvdmlkZXJMaXN0RW51bSxcbiAgICAgIC8qKlxuICAgICAgICogRGlzYWJsZSBhdXRvbWF0aWMgcmVkaXJlY3Rpb24gdG8gdGhlIHByb3ZpZGVyXG4gICAgICAgKlxuICAgICAgICogVGhpcyBpcyB1c2VmdWwgaWYgeW91IHdhbnQgdG8gaGFuZGxlIHRoZSByZWRpcmVjdGlvblxuICAgICAgICogeW91cnNlbGYgbGlrZSBpbiBhIHBvcHVwIG9yIGEgZGlmZmVyZW50IHRhYi5cbiAgICAgICAqL1xuICAgICAgZGlzYWJsZVJlZGlyZWN0OiB6LmJvb2xlYW4oe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIGF1dG9tYXRpYyByZWRpcmVjdGlvbiB0byB0aGUgcHJvdmlkZXIuIFVzZWZ1bCBmb3IgaGFuZGxpbmcgdGhlIHJlZGlyZWN0aW9uIHlvdXJzZWxmXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIElEIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXG4gICAgICAgKlxuICAgICAgICogVGhpcyBpcyB1c2VkIHRvIHNpZ24gaW4gdGhlIHVzZXJcbiAgICAgICAqIGlmIHRoZSB1c2VyIGlzIGFscmVhZHkgc2lnbmVkIGluIHdpdGggdGhlXG4gICAgICAgKiBwcm92aWRlciBpbiB0aGUgZnJvbnRlbmQuXG4gICAgICAgKlxuICAgICAgICogT25seSBhcHBsaWNhYmxlIGlmIHRoZSBwcm92aWRlciBzdXBwb3J0c1xuICAgICAgICogaXQuIEN1cnJlbnRseSBvbmx5IGBhcHBsZWAgYW5kIGBnb29nbGVgIGlzXG4gICAgICAgKiBzdXBwb3J0ZWQgb3V0IG9mIHRoZSBib3guXG4gICAgICAgKi9cbiAgICAgIGlkVG9rZW46IHoub3B0aW9uYWwoXG4gICAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICAgICAqL1xuICAgICAgICAgIHRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICAgICAgfSksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogVGhlIG5vbmNlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIHRva2VuXG4gICAgICAgICAgICovXG4gICAgICAgICAgbm9uY2U6IHouc3RyaW5nKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk5vbmNlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIHRva2VuXCJcbiAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEFjY2VzcyB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICAgICAqL1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiB6LnN0cmluZyh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBY2Nlc3MgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogUmVmcmVzaCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICAgICAqL1xuICAgICAgICAgIHJlZnJlc2hUb2tlbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUmVmcmVzaCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBFeHBpcnkgZGF0ZSBvZiB0aGUgdG9rZW5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBleHBpcmVzQXQ6IHoubnVtYmVyKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkV4cGlyeSBkYXRlIG9mIHRoZSB0b2tlblwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICB9KSxcbiAgICAgICAge1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIklEIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyIHRvIHNpZ24gaW4gdGhlIHVzZXIgd2l0aCBpZCB0b2tlblwiXG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggYSBzb2NpYWwgcHJvdmlkZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic2Vzc2lvblwiLCBcInVzZXJcIiwgXCJ1cmxcIiwgXCJyZWRpcmVjdFwiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGMpID0+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLmJvZHkucHJvdmlkZXJcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gYWRkIHRoZSBwcm92aWRlciBpbiB5b3VyIGF1dGggY29uZmlnXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBST1ZJREVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjLmJvZHkuaWRUb2tlbikge1xuICAgICAgaWYgKCFwcm92aWRlci52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJQcm92aWRlciBkb2VzIG5vdCBzdXBwb3J0IGlkIHRva2VuIHZlcmlmaWNhdGlvblwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JRF9UT0tFTl9OT1RfU1VQUE9SVEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyB0b2tlbiwgbm9uY2UgfSA9IGMuYm9keS5pZFRva2VuO1xuICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIGlkIHRva2VuXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJJbmZvID0gYXdhaXQgcHJvdmlkZXIuZ2V0VXNlckluZm8oe1xuICAgICAgICBpZFRva2VuOiB0b2tlbixcbiAgICAgICAgYWNjZXNzVG9rZW46IGMuYm9keS5pZFRva2VuLmFjY2Vzc1Rva2VuLFxuICAgICAgICByZWZyZXNoVG9rZW46IGMuYm9keS5pZFRva2VuLnJlZnJlc2hUb2tlblxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXJJbmZvIHx8ICF1c2VySW5mbz8udXNlcikge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9cIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICghdXNlckluZm8udXNlci5lbWFpbCkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlciBlbWFpbCBub3QgZm91bmRcIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX0VNQUlMX05PVF9GT1VORFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBoYW5kbGVPQXV0aFVzZXJJbmZvKGMsIHtcbiAgICAgICAgdXNlckluZm86IHtcbiAgICAgICAgICBlbWFpbDogdXNlckluZm8udXNlci5lbWFpbCxcbiAgICAgICAgICBpZDogdXNlckluZm8udXNlci5pZCxcbiAgICAgICAgICBuYW1lOiB1c2VySW5mby51c2VyLm5hbWUgfHwgXCJcIixcbiAgICAgICAgICBpbWFnZTogdXNlckluZm8udXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby51c2VyLmVtYWlsVmVyaWZpZWQgfHwgZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgYWNjb3VudDoge1xuICAgICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICAgIGFjY291bnRJZDogdXNlckluZm8udXNlci5pZCxcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogYy5ib2R5LmlkVG9rZW4uYWNjZXNzVG9rZW5cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IGRhdGEuZXJyb3JcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGMsIGRhdGEuZGF0YSk7XG4gICAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgICAgcmVkaXJlY3Q6IGZhbHNlLFxuICAgICAgICB0b2tlbjogZGF0YS5kYXRhLnNlc3Npb24udG9rZW4sXG4gICAgICAgIHVybDogdm9pZCAwLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IGRhdGEuZGF0YS51c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiBkYXRhLmRhdGEudXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiBkYXRhLmRhdGEudXNlci5uYW1lLFxuICAgICAgICAgIGltYWdlOiBkYXRhLmRhdGEudXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBkYXRhLmRhdGEudXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5kYXRhLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogZGF0YS5kYXRhLnVzZXIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGNvZGVWZXJpZmllciwgc3RhdGUgfSA9IGF3YWl0IGdlbmVyYXRlU3RhdGUoYyk7XG4gICAgY29uc3QgdXJsID0gYXdhaXQgcHJvdmlkZXIuY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICBzdGF0ZSxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJOiBgJHtjLmNvbnRleHQuYmFzZVVSTH0vY2FsbGJhY2svJHtwcm92aWRlci5pZH1gXG4gICAgfSk7XG4gICAgcmV0dXJuIGMuanNvbih7XG4gICAgICB1cmw6IHVybC50b1N0cmluZygpLFxuICAgICAgcmVkaXJlY3Q6ICFjLmJvZHkuZGlzYWJsZVJlZGlyZWN0XG4gICAgfSk7XG4gIH1cbik7XG52YXIgc2lnbkluRW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NpZ24taW4vZW1haWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBFbWFpbCBvZiB0aGUgdXNlclxuICAgICAgICovXG4gICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBvZiB0aGUgdXNlclwiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogUGFzc3dvcmQgb2YgdGhlIHVzZXJcbiAgICAgICAqL1xuICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUGFzc3dvcmQgb2YgdGhlIHVzZXJcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byB1c2UgYXMgYSByZWRpcmVjdCBmb3IgZW1haWxcbiAgICAgICAqIHZlcmlmaWNhdGlvbiBhbmQgZm9yIHBvc3NpYmxlIHJlZGlyZWN0c1xuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDYWxsYmFjayBVUkwgdG8gdXNlIGFzIGEgcmVkaXJlY3QgZm9yIGVtYWlsIHZlcmlmaWNhdGlvblwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBJZiB0aGlzIGlzIGZhbHNlLCB0aGUgc2Vzc2lvbiB3aWxsIG5vdCBiZSByZW1lbWJlcmVkXG4gICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgKi9cbiAgICAgIHJlbWVtYmVyTWU6IHouYm9vbGVhbih7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIklmIHRoaXMgaXMgZmFsc2UsIHRoZSBzZXNzaW9uIHdpbGwgbm90IGJlIHJlbWVtYmVyZWQuIERlZmF1bHQgaXMgYHRydWVgLlwiXG4gICAgICB9KS5kZWZhdWx0KHRydWUpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInNlc3Npb25cIiwgXCJ1c2VyXCIsIFwidXJsXCIsIFwicmVkaXJlY3RcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnM/LmVtYWlsQW5kUGFzc3dvcmQ/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJFbWFpbCBhbmQgcGFzc3dvcmQgaXMgbm90IGVuYWJsZWQuIE1ha2Ugc3VyZSB0byBlbmFibGUgaXQgaW4gdGhlIG9wdGlvbnMgb24geW91IGBhdXRoLnRzYCBmaWxlLiBDaGVjayBgaHR0cHM6Ly9iZXR0ZXItYXV0aC5jb20vZG9jcy9hdXRoZW50aWNhdGlvbi9lbWFpbC1wYXNzd29yZGAgZm9yIG1vcmUhXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRW1haWwgYW5kIHBhc3N3b3JkIGlzIG5vdCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgaXNWYWxpZEVtYWlsID0gei5zdHJpbmcoKS5lbWFpbCgpLnNhZmVQYXJzZShlbWFpbCk7XG4gICAgaWYgKCFpc1ZhbGlkRW1haWwuc3VjY2Vzcykge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCwge1xuICAgICAgaW5jbHVkZUFjY291bnRzOiB0cnVlXG4gICAgfSk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKHBhc3N3b3JkKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXIgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjcmVkZW50aWFsQWNjb3VudCA9IHVzZXIuYWNjb3VudHMuZmluZChcbiAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICAgKTtcbiAgICBpZiAoIWNyZWRlbnRpYWxBY2NvdW50KSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJDcmVkZW50aWFsIGFjY291bnQgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBjcmVkZW50aWFsQWNjb3VudD8ucGFzc3dvcmQ7XG4gICAgaWYgKCFjdXJyZW50UGFzc3dvcmQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdmFsaWRQYXNzd29yZCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgICBwYXNzd29yZFxuICAgIH0pO1xuICAgIGlmICghdmFsaWRQYXNzd29yZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSW52YWxpZCBwYXNzd29yZFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbEFuZFBhc3N3b3JkPy5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24gJiYgIXVzZXIudXNlci5lbWFpbFZlcmlmaWVkKSB7XG4gICAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnM/LmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkVNQUlMX05PVF9WRVJJRklFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICB1c2VyLnVzZXIuZW1haWwsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICApO1xuICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogdXNlci51c2VyLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICB0b2tlblxuICAgICAgICB9LFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRU1BSUxfTk9UX1ZFUklGSUVEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgdXNlci51c2VyLmlkLFxuICAgICAgY3R4LmhlYWRlcnMsXG4gICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoXG4gICAgICBjdHgsXG4gICAgICB7XG4gICAgICAgIHNlc3Npb24sXG4gICAgICAgIHVzZXI6IHVzZXIudXNlclxuICAgICAgfSxcbiAgICAgIGN0eC5ib2R5LnJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgcmVkaXJlY3Q6ICEhY3R4LmJvZHkuY2FsbGJhY2tVUkwsXG4gICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgIHVybDogY3R4LmJvZHkuY2FsbGJhY2tVUkwsXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiB1c2VyLnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiB1c2VyLnVzZXIuZW1haWwsXG4gICAgICAgIG5hbWU6IHVzZXIudXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogdXNlci51c2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgY3JlYXRlZEF0OiB1c2VyLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IHVzZXIudXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcbnZhciBzY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGNvZGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZXJyb3I6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZXJyb3JfZGVzY3JpcHRpb246IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgc3RhdGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgY2FsbGJhY2tPQXV0aCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2FsbGJhY2svOmlkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFtcIkdFVFwiLCBcIlBPU1RcIl0sXG4gICAgYm9keTogc2NoZW1hLm9wdGlvbmFsKCksXG4gICAgcXVlcnk6IHNjaGVtYS5vcHRpb25hbCgpLFxuICAgIG1ldGFkYXRhOiBISURFX01FVEFEQVRBXG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgbGV0IHF1ZXJ5T3JCb2R5O1xuICAgIHRyeSB7XG4gICAgICBpZiAoYy5tZXRob2QgPT09IFwiR0VUXCIpIHtcbiAgICAgICAgcXVlcnlPckJvZHkgPSBzY2hlbWEucGFyc2UoYy5xdWVyeSk7XG4gICAgICB9IGVsc2UgaWYgKGMubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgICAgICBxdWVyeU9yQm9keSA9IHNjaGVtYS5wYXJzZShjLmJvZHkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgbWV0aG9kXCIpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJTlZBTElEX0NBTExCQUNLX1JFUVVFU1RcIiwgZSk7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgICBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9aW52YWxpZF9jYWxsYmFja19yZXF1ZXN0YFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgeyBjb2RlLCBlcnJvcjogZXJyb3IyLCBzdGF0ZSwgZXJyb3JfZGVzY3JpcHRpb24gfSA9IHF1ZXJ5T3JCb2R5O1xuICAgIGlmICghc3RhdGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJTdGF0ZSBub3QgZm91bmRcIiwgZXJyb3IyKTtcbiAgICAgIHRocm93IGMucmVkaXJlY3QoYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPXN0YXRlX25vdF9mb3VuZGApO1xuICAgIH1cbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJDb2RlIG5vdCBmb3VuZFwiKTtcbiAgICAgIHRocm93IGMucmVkaXJlY3QoXG4gICAgICAgIGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj0ke2Vycm9yMiB8fCBcIm5vX2NvZGVcIn0mZXJyb3JfZGVzY3JpcHRpb249JHtlcnJvcl9kZXNjcmlwdGlvbn1gXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLnBhcmFtcy5pZFxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJPYXV0aCBwcm92aWRlciB3aXRoIGlkXCIsXG4gICAgICAgIGMucGFyYW1zLmlkLFxuICAgICAgICBcIm5vdCBmb3VuZFwiXG4gICAgICApO1xuICAgICAgdGhyb3cgYy5yZWRpcmVjdChcbiAgICAgICAgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPW9hdXRoX3Byb3ZpZGVyX25vdF9mb3VuZGBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHsgY29kZVZlcmlmaWVyLCBjYWxsYmFja1VSTCwgbGluaywgZXJyb3JVUkwsIG5ld1VzZXJVUkwgfSA9IGF3YWl0IHBhcnNlU3RhdGUoYyk7XG4gICAgbGV0IHRva2VucztcbiAgICB0cnkge1xuICAgICAgdG9rZW5zID0gYXdhaXQgcHJvdmlkZXIudmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkk6IGAke2MuY29udGV4dC5iYXNlVVJMfS9jYWxsYmFjay8ke3Byb3ZpZGVyLmlkfWBcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJcIiwgZSk7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgICBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9cGxlYXNlX3Jlc3RhcnRfdGhlX3Byb2Nlc3NgXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHRva2VucykudGhlbigocmVzKSA9PiByZXM/LnVzZXIpO1xuICAgIGZ1bmN0aW9uIHJlZGlyZWN0T25FcnJvcihlcnJvcjMpIHtcbiAgICAgIGxldCB1cmwgPSBlcnJvclVSTCB8fCBjYWxsYmFja1VSTCB8fCBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICAgICAgaWYgKHVybC5pbmNsdWRlcyhcIj9cIikpIHtcbiAgICAgICAgdXJsID0gYCR7dXJsfSZlcnJvcj0ke2Vycm9yM31gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXJsID0gYCR7dXJsfT9lcnJvcj0ke2Vycm9yM31gO1xuICAgICAgfVxuICAgICAgdGhyb3cgYy5yZWRpcmVjdCh1cmwpO1xuICAgIH1cbiAgICBpZiAoIXVzZXJJbmZvKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVW5hYmxlIHRvIGdldCB1c2VyIGluZm9cIik7XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hYmxlX3RvX2dldF91c2VyX2luZm9cIik7XG4gICAgfVxuICAgIGlmICghdXNlckluZm8uZW1haWwpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgZGlkIG5vdCByZXR1cm4gZW1haWwuIFRoaXMgY291bGQgYmUgZHVlIHRvIG1pc2NvbmZpZ3VyYXRpb24gaW4gdGhlIHByb3ZpZGVyIHNldHRpbmdzLlwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImVtYWlsX25vdF9mb3VuZFwiKTtcbiAgICB9XG4gICAgaWYgKCFjYWxsYmFja1VSTCkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIk5vIGNhbGxiYWNrIFVSTCBmb3VuZFwiKTtcbiAgICAgIHRocm93IGMucmVkaXJlY3QoXG4gICAgICAgIGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1wbGVhc2VfcmVzdGFydF90aGVfcHJvY2Vzc2BcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChsaW5rKSB7XG4gICAgICBpZiAoYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93RGlmZmVyZW50RW1haWxzICE9PSB0cnVlICYmIGxpbmsuZW1haWwgIT09IHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImVtYWlsX2RvZXNuJ3RfbWF0Y2hcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBleGlzdGluZ0FjY291bnQgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50KFxuICAgICAgICB1c2VySW5mby5pZFxuICAgICAgKTtcbiAgICAgIGlmIChleGlzdGluZ0FjY291bnQpIHtcbiAgICAgICAgaWYgKGV4aXN0aW5nQWNjb3VudCAmJiBleGlzdGluZ0FjY291bnQudXNlcklkICE9PSBsaW5rLnVzZXJJZCkge1xuICAgICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJhY2NvdW50X2FscmVhZHlfbGlua2VkX3RvX2RpZmZlcmVudF91c2VyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJhY2NvdW50X2FscmVhZHlfbGlua2VkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgbmV3QWNjb3VudCA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlQWNjb3VudCh7XG4gICAgICAgIHVzZXJJZDogbGluay51c2VySWQsXG4gICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLmlkLFxuICAgICAgICAuLi50b2tlbnMsXG4gICAgICAgIHNjb3BlOiB0b2tlbnMuc2NvcGVzPy5qb2luKFwiLFwiKVxuICAgICAgfSk7XG4gICAgICBpZiAoIW5ld0FjY291bnQpIHtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYWJsZV90b19saW5rX2FjY291bnRcIik7XG4gICAgICB9XG4gICAgICBsZXQgdG9SZWRpcmVjdFRvMjtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVybCA9IGNhbGxiYWNrVVJMO1xuICAgICAgICB0b1JlZGlyZWN0VG8yID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgdG9SZWRpcmVjdFRvMiA9IGNhbGxiYWNrVVJMO1xuICAgICAgfVxuICAgICAgdGhyb3cgYy5yZWRpcmVjdCh0b1JlZGlyZWN0VG8yKTtcbiAgICB9XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlT0F1dGhVc2VySW5mbyhjLCB7XG4gICAgICB1c2VySW5mbzoge1xuICAgICAgICAuLi51c2VySW5mbyxcbiAgICAgICAgZW1haWw6IHVzZXJJbmZvLmVtYWlsLFxuICAgICAgICBuYW1lOiB1c2VySW5mby5uYW1lIHx8IHVzZXJJbmZvLmVtYWlsXG4gICAgICB9LFxuICAgICAgYWNjb3VudDoge1xuICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZCxcbiAgICAgICAgLi4udG9rZW5zLFxuICAgICAgICBzY29wZTogdG9rZW5zLnNjb3Blcz8uam9pbihcIixcIilcbiAgICAgIH0sXG4gICAgICBjYWxsYmFja1VSTFxuICAgIH0pO1xuICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IocmVzdWx0LmVycm9yLnNwbGl0KFwiIFwiKS5qb2luKFwiX1wiKSk7XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKHJlc3VsdC5lcnJvci5zcGxpdChcIiBcIikuam9pbihcIl9cIikpO1xuICAgIH1cbiAgICBjb25zdCB7IHNlc3Npb24sIHVzZXIgfSA9IHJlc3VsdC5kYXRhO1xuICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoYywge1xuICAgICAgc2Vzc2lvbixcbiAgICAgIHVzZXJcbiAgICB9KTtcbiAgICBsZXQgdG9SZWRpcmVjdFRvO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cmwgPSByZXN1bHQuaXNSZWdpc3RlciA/IG5ld1VzZXJVUkwgfHwgY2FsbGJhY2tVUkwgOiBjYWxsYmFja1VSTDtcbiAgICAgIHRvUmVkaXJlY3RUbyA9IHVybC50b1N0cmluZygpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgdG9SZWRpcmVjdFRvID0gcmVzdWx0LmlzUmVnaXN0ZXIgPyBuZXdVc2VyVVJMIHx8IGNhbGxiYWNrVVJMIDogY2FsbGJhY2tVUkw7XG4gICAgfVxuICAgIHRocm93IGMucmVkaXJlY3QodG9SZWRpcmVjdFRvKTtcbiAgfVxuKTtcbnZhciBzaWduT3V0ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLW91dFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIG91dCB0aGUgY3VycmVudCB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbkNvb2tpZVRva2VuID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgKTtcbiAgICBpZiAoIXNlc3Npb25Db29raWVUb2tlbikge1xuICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfU0VTU0lPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHNlc3Npb25Db29raWVUb2tlbik7XG4gICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5mdW5jdGlvbiByZWRpcmVjdEVycm9yKGN0eCwgY2FsbGJhY2tVUkwsIHF1ZXJ5KSB7XG4gIGNvbnN0IHVybCA9IGNhbGxiYWNrVVJMID8gbmV3IFVSTChjYWxsYmFja1VSTCwgY3R4LmJhc2VVUkwpIDogbmV3IFVSTChgJHtjdHguYmFzZVVSTH0vZXJyb3JgKTtcbiAgaWYgKHF1ZXJ5KVxuICAgIE9iamVjdC5lbnRyaWVzKHF1ZXJ5KS5mb3JFYWNoKChbaywgdl0pID0+IHVybC5zZWFyY2hQYXJhbXMuc2V0KGssIHYpKTtcbiAgcmV0dXJuIHVybC5ocmVmO1xufVxuZnVuY3Rpb24gcmVkaXJlY3RDYWxsYmFjayhjdHgsIGNhbGxiYWNrVVJMLCBxdWVyeSkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGNhbGxiYWNrVVJMLCBjdHguYmFzZVVSTCk7XG4gIGlmIChxdWVyeSlcbiAgICBPYmplY3QuZW50cmllcyhxdWVyeSkuZm9yRWFjaCgoW2ssIHZdKSA9PiB1cmwuc2VhcmNoUGFyYW1zLnNldChrLCB2KSk7XG4gIHJldHVybiB1cmwuaHJlZjtcbn1cbnZhciBmb3JnZXRQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZm9yZ2V0LXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvLlxuICAgICAgICovXG4gICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgYWRkcmVzcyBvZiB0aGUgdXNlciB0byBzZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG9cIlxuICAgICAgfSkuZW1haWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZC5cbiAgICAgICAqIElmIHRoZSB0b2tlbiBpc24ndCB2YWxpZCBvciBleHBpcmVkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9cbiAgICAgICAqIGVycm9yPUlOVkFMSURfVE9LRU5gLiBJZiB0aGUgdG9rZW4gaXMgdmFsaWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP1xuICAgICAgICogdG9rZW49VkFMSURfVE9LRU5cbiAgICAgICAqL1xuICAgICAgcmVkaXJlY3RUbzogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHJlc2V0IHRoZWlyIHBhc3N3b3JkLiBJZiB0aGUgdG9rZW4gaXNuJ3QgdmFsaWQgb3IgZXhwaXJlZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/ZXJyb3I9SU5WQUxJRF9UT0tFTmAuIElmIHRoZSB0b2tlbiBpcyB2YWxpZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/dG9rZW49VkFMSURfVE9LRU5cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnNlbmRSZXNldFBhc3N3b3JkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUmVzZXQgcGFzc3dvcmQgaXNuJ3QgZW5hYmxlZC5QbGVhc2UgcGFzcyBhbiBlbWFpbEFuZFBhc3N3b3JkLnNlbmRSZXNldFBhc3N3b3JkVG9rZW4gZnVuY3Rpb24gaW4geW91ciBhdXRoIGNvbmZpZyFcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJSZXNldCBwYXNzd29yZCBpc24ndCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsLCByZWRpcmVjdFRvIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCwge1xuICAgICAgaW5jbHVkZUFjY291bnRzOiB0cnVlXG4gICAgfSk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJSZXNldCBQYXNzd29yZDogVXNlciBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbihcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgZGVmYXVsdEV4cGlyZXNJbiA9IDYwICogNjAgKiAxO1xuICAgIGNvbnN0IGV4cGlyZXNBdCA9IGdldERhdGUoXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQucmVzZXRQYXNzd29yZFRva2VuRXhwaXJlc0luIHx8IGRlZmF1bHRFeHBpcmVzSW4sXG4gICAgICBcInNlY1wiXG4gICAgKTtcbiAgICBjb25zdCB2ZXJpZmljYXRpb25Ub2tlbiA9IGdlbmVyYXRlSWQoMjQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgICB2YWx1ZTogdXNlci51c2VyLmlkLnRvU3RyaW5nKCksXG4gICAgICBpZGVudGlmaWVyOiBgcmVzZXQtcGFzc3dvcmQ6JHt2ZXJpZmljYXRpb25Ub2tlbn1gLFxuICAgICAgZXhwaXJlc0F0XG4gICAgfSk7XG4gICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vcmVzZXQtcGFzc3dvcmQvJHt2ZXJpZmljYXRpb25Ub2tlbn0/Y2FsbGJhY2tVUkw9JHtyZWRpcmVjdFRvfWA7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnNlbmRSZXNldFBhc3N3b3JkKFxuICAgICAge1xuICAgICAgICB1c2VyOiB1c2VyLnVzZXIsXG4gICAgICAgIHVybCxcbiAgICAgICAgdG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICB9LFxuICAgICAgY3R4LnJlcXVlc3RcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbnZhciBmb3JnZXRQYXNzd29yZENhbGxiYWNrID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXNldC1wYXNzd29yZC86dG9rZW5cIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlZGlyZWN0cyB0aGUgdXNlciB0byB0aGUgY2FsbGJhY2sgVVJMIHdpdGggdGhlIHRva2VuXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gY3R4LnBhcmFtcztcbiAgICBjb25zdCB7IGNhbGxiYWNrVVJMIH0gPSBjdHgucXVlcnk7XG4gICAgaWYgKCF0b2tlbiB8fCAhY2FsbGJhY2tVUkwpIHtcbiAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgcmVkaXJlY3RFcnJvcihjdHguY29udGV4dCwgY2FsbGJhY2tVUkwsIHsgZXJyb3I6IFwiSU5WQUxJRF9UT0tFTlwiIH0pXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgYHJlc2V0LXBhc3N3b3JkOiR7dG9rZW59YFxuICAgICk7XG4gICAgaWYgKCF2ZXJpZmljYXRpb24gfHwgdmVyaWZpY2F0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgIHJlZGlyZWN0RXJyb3IoY3R4LmNvbnRleHQsIGNhbGxiYWNrVVJMLCB7IGVycm9yOiBcIklOVkFMSURfVE9LRU5cIiB9KVxuICAgICAgKTtcbiAgICB9XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KHJlZGlyZWN0Q2FsbGJhY2soY3R4LmNvbnRleHQsIGNhbGxiYWNrVVJMLCB7IHRva2VuIH0pKTtcbiAgfVxuKTtcbnZhciByZXNldFBhc3N3b3JkID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXNldC1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pLm9wdGlvbmFsKCksXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgbmV3UGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcIlxuICAgICAgfSksXG4gICAgICB0b2tlbjogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gcmVzZXQgdGhlIHBhc3N3b3JkXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXNldCB0aGUgcGFzc3dvcmQgZm9yIGEgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgdG9rZW4gPSBjdHguYm9keS50b2tlbiB8fCBjdHgucXVlcnk/LnRva2VuO1xuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgbWluTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQ/LmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBjb25zdCBtYXhMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZD8uY29uZmlnLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX0xPTkdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBpZCA9IGByZXNldC1wYXNzd29yZDoke3Rva2VufWA7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShpZCk7XG4gICAgaWYgKCF2ZXJpZmljYXRpb24gfHwgdmVyaWZpY2F0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZSh2ZXJpZmljYXRpb24uaWQpO1xuICAgIGNvbnN0IHVzZXJJZCA9IHZlcmlmaWNhdGlvbi52YWx1ZTtcbiAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2gobmV3UGFzc3dvcmQpO1xuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyh1c2VySWQpO1xuICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKChhYykgPT4gYWMucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIpO1xuICAgIGlmICghYWNjb3VudCkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoe1xuICAgICAgICB1c2VySWQsXG4gICAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgICBwYXNzd29yZDogaGFzaGVkUGFzc3dvcmQsXG4gICAgICAgIGFjY291bnRJZDogdXNlcklkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVQYXNzd29yZCh1c2VySWQsIGhhc2hlZFBhc3N3b3JkKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG52YXIgdXBkYXRlVXNlciA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvdXBkYXRlLXVzZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5yZWNvcmQoei5zdHJpbmcoKSwgei5hbnkoKSksXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICAkSW5mZXI6IHtcbiAgICAgICAgYm9keToge31cbiAgICAgIH0sXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlVwZGF0ZSB0aGUgY3VycmVudCB1c2VyXCIsXG4gICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgaW1hZ2Ugb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IGJvZHkgPSBjdHguYm9keTtcbiAgICBpZiAoYm9keS5lbWFpbCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkVNQUlMX0NBTl9OT1RfQkVfVVBEQVRFRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgbmFtZSwgaW1hZ2UsIC4uLnJlc3QgfSA9IGJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgaWYgKGltYWdlID09PSB2b2lkIDAgJiYgbmFtZSA9PT0gdm9pZCAwICYmIE9iamVjdC5rZXlzKHJlc3QpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRkaXRpb25hbEZpZWxkcyA9IHBhcnNlVXNlcklucHV0KFxuICAgICAgY3R4LmNvbnRleHQub3B0aW9ucyxcbiAgICAgIHJlc3QsXG4gICAgICBcInVwZGF0ZVwiXG4gICAgKTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoXG4gICAgICBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICB7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGltYWdlLFxuICAgICAgICAuLi5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9XG4gICAgKTtcbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgc2Vzc2lvbjogc2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgdXNlclxuICAgIH0pO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbnZhciBjaGFuZ2VQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2hhbmdlLXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcbiAgICAgICAqL1xuICAgICAgbmV3UGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBjdXJyZW50IHBhc3N3b3JkIG9mIHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIGN1cnJlbnRQYXNzd29yZDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgY3VycmVudCBwYXNzd29yZFwiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogcmV2b2tlIGFsbCBzZXNzaW9ucyB0aGF0IGFyZSBub3QgdGhlXG4gICAgICAgKiBjdXJyZW50IG9uZSBsb2dnZWQgaW4gYnkgdGhlIHVzZXJcbiAgICAgICAqL1xuICAgICAgcmV2b2tlT3RoZXJTZXNzaW9uczogei5ib29sZWFuKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGFsbCBvdGhlciBzZXNzaW9uc1wiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoYW5nZSB0aGUgcGFzc3dvcmQgb2YgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIG9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IG5ld1Bhc3N3b3JkLCBjdXJyZW50UGFzc3dvcmQsIHJldm9rZU90aGVyU2Vzc2lvbnM6IHJldm9rZU90aGVyU2Vzc2lvbnMyIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoIDwgbWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBzaG9ydFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoID4gbWF4UGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBsb25nXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2NvdW50MikgPT4gYWNjb3VudDIucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIgJiYgYWNjb3VudDIucGFzc3dvcmRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCB8fCAhYWNjb3VudC5wYXNzd29yZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkNSRURFTlRJQUxfQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBjb25zdCB2ZXJpZnkgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgaGFzaDogYWNjb3VudC5wYXNzd29yZCxcbiAgICAgIHBhc3N3b3JkOiBjdXJyZW50UGFzc3dvcmRcbiAgICB9KTtcbiAgICBpZiAoIXZlcmlmeSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChhY2NvdW50LmlkLCB7XG4gICAgICBwYXNzd29yZDogcGFzc3dvcmRIYXNoXG4gICAgfSk7XG4gICAgbGV0IHRva2VuID0gbnVsbDtcbiAgICBpZiAocmV2b2tlT3RoZXJTZXNzaW9uczIpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgICAgY29uc3QgbmV3U2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIGN0eC5oZWFkZXJzXG4gICAgICApO1xuICAgICAgaWYgKCFuZXdTZXNzaW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiBuZXdTZXNzaW9uLFxuICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgIH0pO1xuICAgICAgdG9rZW4gPSBuZXdTZXNzaW9uLnRva2VuO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgdG9rZW4sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICAgIG5hbWU6IHNlc3Npb24udXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogc2Vzc2lvbi51c2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBzZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgY3JlYXRlZEF0OiBzZXNzaW9uLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IHNlc3Npb24udXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcbnZhciBzZXRQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2V0LXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcbiAgICAgICAqL1xuICAgICAgbmV3UGFzc3dvcmQ6IHouc3RyaW5nKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgU0VSVkVSX09OTFk6IHRydWVcbiAgICB9LFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgbWluUGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA8IG1pblBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gc2hvcnRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWF4UGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA+IG1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gbG9uZ1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fTE9OR1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiICYmIGFjY291bnQyLnBhc3N3b3JkXG4gICAgKTtcbiAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudCh7XG4gICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBwcm92aWRlcklkOiBcImNyZWRlbnRpYWxcIixcbiAgICAgICAgYWNjb3VudElkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZEhhc2hcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJ1c2VyIGFscmVhZHkgaGFzIGEgcGFzc3dvcmRcIlxuICAgIH0pO1xuICB9XG4pO1xudmFyIGRlbGV0ZVVzZXIgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2RlbGV0ZS11c2VyXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBjYWxsYmFjayBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHVzZXIgaXMgZGVsZXRlZFxuICAgICAgICogdGhpcyBpcyBvbmx5IHVzZWQgb24gZGVsZXRlIHVzZXIgY2FsbGJhY2tcbiAgICAgICAqL1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyLiBJZiB0aGUgcGFzc3dvcmQgaXNuJ3QgcHJvdmlkZWQsIHNlc3Npb24gZnJlc2huZXNzXG4gICAgICAgKiB3aWxsIGJlIGNoZWNrZWQuXG4gICAgICAgKi9cbiAgICAgIHBhc3N3b3JkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSB0b2tlbiB0byBkZWxldGUgdGhlIHVzZXIuIElmIHRoZSB0b2tlbiBpcyBwcm92aWRlZCwgdGhlIHVzZXIgd2lsbCBiZSBkZWxldGVkXG4gICAgICAgKi9cbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJEZWxldGUgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy51c2VyPy5kZWxldGVVc2VyPy5lbmFibGVkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiRGVsZXRlIHVzZXIgaXMgZGlzYWJsZWQuIEVuYWJsZSBpdCBpbiB0aGUgb3B0aW9uc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgc2Vzc2lvbjogY3R4LmNvbnRleHQuc2Vzc2lvblxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIpO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBpZiAoY3R4LmJvZHkucGFzc3dvcmQpIHtcbiAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAgIChhY2NvdW50MikgPT4gYWNjb3VudDIucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIgJiYgYWNjb3VudDIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoIWFjY291bnQgfHwgIWFjY291bnQucGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuQ1JFREVOVElBTF9BQ0NPVU5UX05PVF9GT1VORFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZlcmlmeSA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgICAgIGhhc2g6IGFjY291bnQucGFzc3dvcmQsXG4gICAgICAgIHBhc3N3b3JkOiBjdHguYm9keS5wYXNzd29yZFxuICAgICAgfSk7XG4gICAgICBpZiAoIXZlcmlmeSkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1BBU1NXT1JEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5zZXNzaW9uPy5mcmVzaEFnZSkge1xuICAgICAgICBjb25zdCBjdXJyZW50QWdlID0gc2Vzc2lvbi5zZXNzaW9uLmNyZWF0ZWRBdC5nZXRUaW1lKCk7XG4gICAgICAgIGNvbnN0IGZyZXNoQWdlID0gY3R4LmNvbnRleHQub3B0aW9ucy5zZXNzaW9uLmZyZXNoQWdlO1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBpZiAobm93IC0gY3VycmVudEFnZSA+IGZyZXNoQWdlKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5TRVNTSU9OX0VYUElSRURcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3R4LmJvZHkudG9rZW4pIHtcbiAgICAgIGF3YWl0IGRlbGV0ZVVzZXJDYWxsYmFjayh7XG4gICAgICAgIC4uLmN0eCxcbiAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICB0b2tlbjogY3R4LmJvZHkudG9rZW5cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5zZW5kRGVsZXRlQWNjb3VudFZlcmlmaWNhdGlvbikge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCIwLTlcIiwgXCJhLXpcIik7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgICAgICB2YWx1ZTogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBpZGVudGlmaWVyOiBgZGVsZXRlLWFjY291bnQtJHt0b2tlbn1gLFxuICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgKyAxZTMgKiA2MCAqIDYwICogMjQpXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2RlbGV0ZS11c2VyL2NhbGxiYWNrP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyLnNlbmREZWxldGVBY2NvdW50VmVyaWZpY2F0aW9uKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICB0b2tlblxuICAgICAgICB9LFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGJlZm9yZURlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5iZWZvcmVEZWxldGU7XG4gICAgaWYgKGJlZm9yZURlbGV0ZSkge1xuICAgICAgYXdhaXQgYmVmb3JlRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVXNlcihzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVBY2NvdW50cyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICBjb25zdCBhZnRlckRlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5hZnRlckRlbGV0ZTtcbiAgICBpZiAoYWZ0ZXJEZWxldGUpIHtcbiAgICAgIGF3YWl0IGFmdGVyRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IFwiVXNlciBkZWxldGVkXCJcbiAgICB9KTtcbiAgfVxuKTtcbnZhciBkZWxldGVVc2VyQ2FsbGJhY2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2RlbGV0ZS11c2VyL2NhbGxiYWNrXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uZGVsZXRlVXNlcj8uZW5hYmxlZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIkRlbGV0ZSB1c2VyIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gdGhlIG9wdGlvbnNcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfVVNFUl9JTkZPXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgYGRlbGV0ZS1hY2NvdW50LSR7Y3R4LnF1ZXJ5LnRva2VufWBcbiAgICApO1xuICAgIGlmICghdG9rZW4gfHwgdG9rZW4uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUodG9rZW4uaWQpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHRva2VuLnZhbHVlICE9PSBzZXNzaW9uLnVzZXIuaWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGJlZm9yZURlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5iZWZvcmVEZWxldGU7XG4gICAgaWYgKGJlZm9yZURlbGV0ZSkge1xuICAgICAgYXdhaXQgYmVmb3JlRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVXNlcihzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVBY2NvdW50cyhzZXNzaW9uLnVzZXIuaWQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZSh0b2tlbi5pZCk7XG4gICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgIGNvbnN0IGFmdGVyRGVsZXRlID0gY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXI/LmFmdGVyRGVsZXRlO1xuICAgIGlmIChhZnRlckRlbGV0ZSkge1xuICAgICAgYXdhaXQgYWZ0ZXJEZWxldGUoc2Vzc2lvbi51c2VyLCBjdHgucmVxdWVzdCk7XG4gICAgfVxuICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgIHRocm93IGN0eC5yZWRpcmVjdChjdHgucXVlcnkuY2FsbGJhY2tVUkwgfHwgXCIvXCIpO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IFwiVXNlciBkZWxldGVkXCJcbiAgICB9KTtcbiAgfVxuKTtcbnZhciBjaGFuZ2VFbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2hhbmdlLWVtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG5ld0VtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgZW1haWwgdG8gc2V0XCJcbiAgICAgIH0pLmVtYWlsKCksXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIGVtYWlsIHZlcmlmaWNhdGlvblwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uY2hhbmdlRW1haWw/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkNoYW5nZSBlbWFpbCBpcyBkaXNhYmxlZC5cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ2hhbmdlIGVtYWlsIGlzIGRpc2FibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmJvZHkubmV3RW1haWwgPT09IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5lbWFpbCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRW1haWwgaXMgdGhlIHNhbWVcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRW1haWwgaXMgdGhlIHNhbWVcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoXG4gICAgICBjdHguYm9keS5uZXdFbWFpbFxuICAgICk7XG4gICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRW1haWwgYWxyZWFkeSBleGlzdHNcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ291bGRuJ3QgdXBkYXRlIHlvdXIgZW1haWxcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCAhPT0gdHJ1ZSkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXJCeUVtYWlsKFxuICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogY3R4LmJvZHkubmV3RW1haWxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmNoYW5nZUVtYWlsLnNlbmRDaGFuZ2VFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWQuXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICBjdHguYm9keS5uZXdFbWFpbCxcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICk7XG4gICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuY2hhbmdlRW1haWwuc2VuZENoYW5nZUVtYWlsVmVyaWZpY2F0aW9uKFxuICAgICAge1xuICAgICAgICB1c2VyOiBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIsXG4gICAgICAgIG5ld0VtYWlsOiBjdHguYm9keS5uZXdFbWFpbCxcbiAgICAgICAgdXJsLFxuICAgICAgICB0b2tlblxuICAgICAgfSxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5cbi8vIHNyYy9hcGkvcm91dGVzL2Vycm9yLnRzXG5mdW5jdGlvbiBzYW5pdGl6ZShpbnB1dCkge1xuICByZXR1cm4gaW5wdXQucmVwbGFjZSgvJi9nLCBcIiZhbXA7XCIpLnJlcGxhY2UoLzwvZywgXCImbHQ7XCIpLnJlcGxhY2UoLz4vZywgXCImZ3Q7XCIpLnJlcGxhY2UoL1wiL2csIFwiJnF1b3Q7XCIpLnJlcGxhY2UoLycvZywgXCImIzM5O1wiKTtcbn1cbnZhciBodG1sID0gKGVycm9yQ29kZSA9IFwiVW5rbm93blwiKSA9PiBgPCFET0NUWVBFIGh0bWw+XG48aHRtbCBsYW5nPVwiZW5cIj5cbjxoZWFkPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPlxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XG4gICAgPHRpdGxlPkF1dGhlbnRpY2F0aW9uIEVycm9yPC90aXRsZT5cbiAgICA8c3R5bGU+XG4gICAgICAgIDpyb290IHtcbiAgICAgICAgICAgIC0tYmctY29sb3I6ICNmOGY5ZmE7XG4gICAgICAgICAgICAtLXRleHQtY29sb3I6ICMyMTI1Mjk7XG4gICAgICAgICAgICAtLWFjY2VudC1jb2xvcjogIzAwMDAwMDtcbiAgICAgICAgICAgIC0tZXJyb3ItY29sb3I6ICNkYzM1NDU7XG4gICAgICAgICAgICAtLWJvcmRlci1jb2xvcjogI2U5ZWNlZjtcbiAgICAgICAgfVxuICAgICAgICBib2R5IHtcbiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICdTZWdvZSBVSScsIFJvYm90bywgJ0hlbHZldGljYSBOZXVlJywgQXJpYWwsIHNhbnMtc2VyaWY7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iZy1jb2xvcik7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgaGVpZ2h0OiAxMDB2aDtcbiAgICAgICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7XG4gICAgICAgIH1cbiAgICAgICAgLmVycm9yLWNvbnRhaW5lciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMDUpO1xuICAgICAgICAgICAgcGFkZGluZzogMi41cmVtO1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgbWF4LXdpZHRoOiA5MCU7XG4gICAgICAgICAgICB3aWR0aDogNDAwcHg7XG4gICAgICAgIH1cbiAgICAgICAgaDEge1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS43NXJlbTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG4gICAgICAgICAgICBmb250LXdlaWdodDogNjAwO1xuICAgICAgICB9XG4gICAgICAgIHAge1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMS41cmVtO1xuICAgICAgICAgICAgY29sb3I6ICM0OTUwNTc7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0biB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpO1xuICAgICAgICAgICAgY29sb3I6ICNmZmZmZmY7XG4gICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gICAgICAgICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7XG4gICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYWNjZW50LWNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICAuYnRuOmhvdmVyIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxMzE3MjE7XG4gICAgICAgIH1cbiAgICAgICAgLmVycm9yLWNvZGUge1xuICAgICAgICAgICAgZm9udC1zaXplOiAwLjg3NXJlbTtcbiAgICAgICAgICAgIGNvbG9yOiAjNmM3NTdkO1xuICAgICAgICAgICAgbWFyZ2luLXRvcDogMS41cmVtO1xuICAgICAgICAgICAgcGFkZGluZy10b3A6IDEuNXJlbTtcbiAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIC5pY29uIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogM3JlbTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XG4gICAgICAgIH1cbiAgICA8L3N0eWxlPlxuPC9oZWFkPlxuPGJvZHk+XG4gICAgPGRpdiBjbGFzcz1cImVycm9yLWNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaWNvblwiPlxcdTI2QTBcXHVGRTBGPC9kaXY+XG4gICAgICAgIDxoMT5CZXR0ZXIgQXV0aCBFcnJvcjwvaDE+XG4gICAgICAgIDxwPldlIGVuY291bnRlcmVkIGFuIGlzc3VlIHdoaWxlIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2UgdHJ5IGFnYWluIG9yIGNvbnRhY3QgdGhlIGFwcGxpY2F0aW9uIG93bmVyIGlmIHRoZSBwcm9ibGVtIHBlcnNpc3RzLjwvcD5cbiAgICAgICAgPGEgaHJlZj1cIi9cIiBpZD1cInJldHVybkxpbmtcIiBjbGFzcz1cImJ0blwiPlJldHVybiB0byBBcHBsaWNhdGlvbjwvYT5cbiAgICAgICAgPGRpdiBjbGFzcz1cImVycm9yLWNvZGVcIj5FcnJvciBDb2RlOiA8c3BhbiBpZD1cImVycm9yQ29kZVwiPiR7c2FuaXRpemUoXG4gIGVycm9yQ29kZVxuKX08L3NwYW4+PC9kaXY+XG4gICAgPC9kaXY+XG48L2JvZHk+XG48L2h0bWw+YDtcbnZhciBlcnJvciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZXJyb3JcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uSElERV9NRVRBREFUQSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzcGxheXMgYW4gZXJyb3IgcGFnZVwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwidGV4dC9odG1sXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSBuZXcgVVJMKGMucmVxdWVzdD8udXJsIHx8IFwiXCIpLnNlYXJjaFBhcmFtcy5nZXQoXCJlcnJvclwiKSB8fCBcIlVua25vd25cIjtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGh0bWwocXVlcnkpLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwidGV4dC9odG1sXCJcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcblxuLy8gc3JjL2FwaS9yb3V0ZXMvb2sudHNcbnZhciBvayA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb2tcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uSElERV9NRVRBREFUQSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2hlY2sgaWYgdGhlIEFQSSBpcyB3b3JraW5nXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG9rOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBvazogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xudmFyIHNpZ25VcEVtYWlsID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLXVwL2VtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoucmVjb3JkKHouc3RyaW5nKCksIHouYW55KCkpLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICAkSW5mZXI6IHtcbiAgICAgICAgYm9keToge31cbiAgICAgIH0sXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gdXAgYSB1c2VyIHVzaW5nIGVtYWlsIGFuZCBwYXNzd29yZFwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcGFzc3dvcmQgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gdXNlIGZvciBlbWFpbCB2ZXJpZmljYXRpb24gY2FsbGJhY2tcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcIm5hbWVcIiwgXCJlbWFpbFwiLCBcInBhc3N3b3JkXCJdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgaWQgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGltYWdlIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIklmIHRoZSBlbWFpbCBpcyB2ZXJpZmllZFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uZW5hYmxlZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGFuZCBwYXNzd29yZCBzaWduIHVwIGlzIG5vdCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBib2R5ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgeyBuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGltYWdlLCBjYWxsYmFja1VSTCwgLi4uYWRkaXRpb25hbEZpZWxkcyB9ID0gYm9keTtcbiAgICBjb25zdCBpc1ZhbGlkRW1haWwgPSB6LnN0cmluZygpLmVtYWlsKCkuc2FmZVBhcnNlKGVtYWlsKTtcbiAgICBpZiAoIWlzVmFsaWRFbWFpbC5zdWNjZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1pblBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1pblBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChwYXNzd29yZC5sZW5ndGggPCBtaW5QYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIHNob3J0XCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19TSE9SVFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1heFBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChwYXNzd29yZC5sZW5ndGggPiBtYXhQYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIGxvbmdcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX0xPTkdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBkYlVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICBpZiAoZGJVc2VyPy51c2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuaW5mbyhgU2lnbi11cCBhdHRlbXB0IGZvciBleGlzdGluZyBlbWFpbDogJHtlbWFpbH1gKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX0FMUkVBRFlfRVhJU1RTXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRkaXRpb25hbERhdGEgPSBwYXJzZVVzZXJJbnB1dChcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMsXG4gICAgICBhZGRpdGlvbmFsRmllbGRzXG4gICAgKTtcbiAgICBsZXQgY3JlYXRlZFVzZXI7XG4gICAgdHJ5IHtcbiAgICAgIGNyZWF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVVzZXIoe1xuICAgICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgaW1hZ2UsXG4gICAgICAgIC4uLmFkZGl0aW9uYWxEYXRhLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICBpZiAoIWNyZWF0ZWRVc2VyKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoaXNEZXZlbG9wbWVudCkge1xuICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIiwgZSk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSLFxuICAgICAgICBkZXRhaWxzOiBlXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFjcmVhdGVkVXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKHBhc3N3b3JkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoe1xuICAgICAgdXNlcklkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgYWNjb3VudElkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgIHBhc3N3b3JkOiBoYXNoXG4gICAgfSk7XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRPblNpZ25VcCB8fCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgY3JlYXRlZFVzZXIuZW1haWwsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICApO1xuICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Ym9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsPy4oXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiBjcmVhdGVkVXNlcixcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgdG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQuYXV0b1NpZ25JbiA9PT0gZmFsc2UgfHwgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgdG9rZW46IG51bGwsXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IGNyZWF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IGNyZWF0ZWRVc2VyLm5hbWUsXG4gICAgICAgICAgaW1hZ2U6IGNyZWF0ZWRVc2VyLmltYWdlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGNyZWF0ZWRVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiBjcmVhdGVkVXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgdXBkYXRlZEF0OiBjcmVhdGVkVXNlci51cGRhdGVkQXRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgIGNyZWF0ZWRVc2VyLmlkLFxuICAgICAgY3R4LnJlcXVlc3RcbiAgICApO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICBzZXNzaW9uLFxuICAgICAgdXNlcjogY3JlYXRlZFVzZXJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgZW1haWw6IGNyZWF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiBjcmVhdGVkVXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogY3JlYXRlZFVzZXIuaW1hZ2UsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IGNyZWF0ZWRVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogY3JlYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IGNyZWF0ZWRVc2VyLnVwZGF0ZWRBdFxuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xudmFyIGxpc3RVc2VyQWNjb3VudHMgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2xpc3QtYWNjb3VudHNcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCBhbGwgYWNjb3VudHMgbGlua2VkIHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGMuY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIHJldHVybiBjLmpzb24oXG4gICAgICBhY2NvdW50cy5tYXAoKGEpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogYS5pZCxcbiAgICAgICAgICBwcm92aWRlcjogYS5wcm92aWRlcklkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogYS5jcmVhdGVkQXQsXG4gICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdCxcbiAgICAgICAgICBhY2NvdW50SWQ6IGEuYWNjb3VudElkLFxuICAgICAgICAgIHNjb3BlczogYS5zY29wZT8uc3BsaXQoXCIsXCIpIHx8IFtdXG4gICAgICAgIH07XG4gICAgICB9KVxuICAgICk7XG4gIH1cbik7XG52YXIgbGlua1NvY2lhbEFjY291bnQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2xpbmstc29jaWFsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGhhcyBzaWduZWQgaW4uXG4gICAgICAgKi9cbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHVzZXIgaGFzIHNpZ25lZCBpblwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBPQXV0aDIgcHJvdmlkZXIgdG8gdXNlYFxuICAgICAgICovXG4gICAgICBwcm92aWRlcjogei5lbnVtKHNvY2lhbFByb3ZpZGVyTGlzdCwge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgT0F1dGgyIHByb3ZpZGVyIHRvIHVzZVwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJMaW5rIGEgc29jaWFsIGFjY291bnQgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1widXJsXCIsIFwicmVkaXJlY3RcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGMuY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgY29uc3QgZXhpc3RpbmdBY2NvdW50ID0gYWNjb3VudC5maW5kKFxuICAgICAgKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gYy5ib2R5LnByb3ZpZGVyXG4gICAgKTtcbiAgICBpZiAoZXhpc3RpbmdBY2NvdW50KSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuU09DSUFMX0FDQ09VTlRfQUxSRUFEWV9MSU5LRURcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLmJvZHkucHJvdmlkZXJcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gYWRkIHRoZSBwcm92aWRlciBpbiB5b3VyIGF1dGggY29uZmlnXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBST1ZJREVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHN0YXRlID0gYXdhaXQgZ2VuZXJhdGVTdGF0ZShjLCB7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWxcbiAgICB9KTtcbiAgICBjb25zdCB1cmwgPSBhd2FpdCBwcm92aWRlci5jcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgIHN0YXRlOiBzdGF0ZS5zdGF0ZSxcbiAgICAgIGNvZGVWZXJpZmllcjogc3RhdGUuY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUkk6IGAke2MuY29udGV4dC5iYXNlVVJMfS9jYWxsYmFjay8ke3Byb3ZpZGVyLmlkfWBcbiAgICB9KTtcbiAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgIHVybDogdXJsLnRvU3RyaW5nKCksXG4gICAgICByZWRpcmVjdDogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xudmFyIHVubGlua0FjY291bnQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3VubGluay1hY2NvdW50XCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHByb3ZpZGVySWQ6IHouc3RyaW5nKClcbiAgICB9KSxcbiAgICB1c2U6IFtmcmVzaFNlc3Npb25NaWRkbGV3YXJlXVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBpZiAoYWNjb3VudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX1VOTElOS19MQVNUX0FDQ09VTlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NvdW50RXhpc3QgPSBhY2NvdW50cy5maW5kKFxuICAgICAgKGFjY291bnQpID0+IGFjY291bnQucHJvdmlkZXJJZCA9PT0gY3R4LmJvZHkucHJvdmlkZXJJZFxuICAgICk7XG4gICAgaWYgKCFhY2NvdW50RXhpc3QpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5BQ0NPVU5UX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVBY2NvdW50KFxuICAgICAgY3R4LmJvZHkucHJvdmlkZXJJZCxcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG4vLyBzcmMvYXBpL3JhdGUtbGltaXRlci9pbmRleC50c1xuZnVuY3Rpb24gc2hvdWxkUmF0ZUxpbWl0KG1heCwgd2luZG93LCByYXRlTGltaXREYXRhKSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IHdpbmRvd0luTXMgPSB3aW5kb3cgKiAxZTM7XG4gIGNvbnN0IHRpbWVTaW5jZUxhc3RSZXF1ZXN0ID0gbm93IC0gcmF0ZUxpbWl0RGF0YS5sYXN0UmVxdWVzdDtcbiAgcmV0dXJuIHRpbWVTaW5jZUxhc3RSZXF1ZXN0IDwgd2luZG93SW5NcyAmJiByYXRlTGltaXREYXRhLmNvdW50ID49IG1heDtcbn1cbmZ1bmN0aW9uIHJhdGVMaW1pdFJlc3BvbnNlKHJldHJ5QWZ0ZXIpIHtcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBtZXNzYWdlOiBcIlRvbyBtYW55IHJlcXVlc3RzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiXG4gICAgfSksXG4gICAge1xuICAgICAgc3RhdHVzOiA0MjksXG4gICAgICBzdGF0dXNUZXh0OiBcIlRvbyBNYW55IFJlcXVlc3RzXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiWC1SZXRyeS1BZnRlclwiOiByZXRyeUFmdGVyLnRvU3RyaW5nKClcbiAgICAgIH1cbiAgICB9XG4gICk7XG59XG5mdW5jdGlvbiBnZXRSZXRyeUFmdGVyKGxhc3RSZXF1ZXN0LCB3aW5kb3cpIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3Qgd2luZG93SW5NcyA9IHdpbmRvdyAqIDFlMztcbiAgcmV0dXJuIE1hdGguY2VpbCgobGFzdFJlcXVlc3QgKyB3aW5kb3dJbk1zIC0gbm93KSAvIDFlMyk7XG59XG5mdW5jdGlvbiBjcmVhdGVEQlN0b3JhZ2UoY3R4LCBtb2RlbE5hbWUpIHtcbiAgY29uc3QgbW9kZWwgPSBjdHgub3B0aW9ucy5yYXRlTGltaXQ/Lm1vZGVsTmFtZSB8fCBcInJhdGVMaW1pdFwiO1xuICBjb25zdCBkYiA9IGN0eC5hZGFwdGVyO1xuICByZXR1cm4ge1xuICAgIGdldDogYXN5bmMgKGtleSkgPT4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmU6IFt7IGZpZWxkOiBcImtleVwiLCB2YWx1ZToga2V5IH1dXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSByZXNbMF07XG4gICAgICBpZiAodHlwZW9mIGRhdGE/Lmxhc3RSZXF1ZXN0ID09PSBcImJpZ2ludFwiKSB7XG4gICAgICAgIGRhdGEubGFzdFJlcXVlc3QgPSBOdW1iZXIoZGF0YS5sYXN0UmVxdWVzdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHNldDogYXN5bmMgKGtleSwgdmFsdWUsIF91cGRhdGUpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChfdXBkYXRlKSB7XG4gICAgICAgICAgYXdhaXQgZGIudXBkYXRlTWFueSh7XG4gICAgICAgICAgICBtb2RlbDogbW9kZWxOYW1lID8/IFwicmF0ZUxpbWl0XCIsXG4gICAgICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwia2V5XCIsIHZhbHVlOiBrZXkgfV0sXG4gICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgY291bnQ6IHZhbHVlLmNvdW50LFxuICAgICAgICAgICAgICBsYXN0UmVxdWVzdDogdmFsdWUubGFzdFJlcXVlc3RcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhd2FpdCBkYi5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZSA/PyBcInJhdGVMaW1pdFwiLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgIGNvdW50OiB2YWx1ZS5jb3VudCxcbiAgICAgICAgICAgICAgbGFzdFJlcXVlc3Q6IHZhbHVlLmxhc3RSZXF1ZXN0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY3R4LmxvZ2dlci5lcnJvcihcIkVycm9yIHNldHRpbmcgcmF0ZSBsaW1pdFwiLCBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG52YXIgbWVtb3J5ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbmZ1bmN0aW9uIGdldFJhdGVMaW1pdFN0b3JhZ2UoY3R4KSB7XG4gIGlmIChjdHgub3B0aW9ucy5yYXRlTGltaXQ/LmN1c3RvbVN0b3JhZ2UpIHtcbiAgICByZXR1cm4gY3R4Lm9wdGlvbnMucmF0ZUxpbWl0LmN1c3RvbVN0b3JhZ2U7XG4gIH1cbiAgaWYgKGN0eC5yYXRlTGltaXQuc3RvcmFnZSA9PT0gXCJzZWNvbmRhcnktc3RvcmFnZVwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGdldDogYXN5bmMgKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBzdHJpbmdpZmllZCA9IGF3YWl0IGN0eC5vcHRpb25zLnNlY29uZGFyeVN0b3JhZ2U/LmdldChrZXkpO1xuICAgICAgICByZXR1cm4gc3RyaW5naWZpZWQgPyBKU09OLnBhcnNlKHN0cmluZ2lmaWVkKSA6IHZvaWQgMDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGFzeW5jIChrZXksIHZhbHVlKSA9PiB7XG4gICAgICAgIGF3YWl0IGN0eC5vcHRpb25zLnNlY29uZGFyeVN0b3JhZ2U/LnNldD8uKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGNvbnN0IHN0b3JhZ2UgPSBjdHgucmF0ZUxpbWl0LnN0b3JhZ2U7XG4gIGlmIChzdG9yYWdlID09PSBcIm1lbW9yeVwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIGdldChrZXkpIHtcbiAgICAgICAgcmV0dXJuIG1lbW9yeS5nZXQoa2V5KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBzZXQoa2V5LCB2YWx1ZSwgX3VwZGF0ZSkge1xuICAgICAgICBtZW1vcnkuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZURCU3RvcmFnZShjdHgsIGN0eC5yYXRlTGltaXQubW9kZWxOYW1lKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIG9uUmVxdWVzdFJhdGVMaW1pdChyZXEsIGN0eCkge1xuICBpZiAoIWN0eC5yYXRlTGltaXQuZW5hYmxlZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBiYXNlVVJMID0gY3R4LmJhc2VVUkw7XG4gIGNvbnN0IHBhdGggPSByZXEudXJsLnJlcGxhY2UoYmFzZVVSTCwgXCJcIikuc3BsaXQoXCI/XCIpWzBdO1xuICBsZXQgd2luZG93ID0gY3R4LnJhdGVMaW1pdC53aW5kb3c7XG4gIGxldCBtYXggPSBjdHgucmF0ZUxpbWl0Lm1heDtcbiAgY29uc3Qga2V5ID0gZ2V0SXAocmVxLCBjdHgub3B0aW9ucykgKyBwYXRoO1xuICBjb25zdCBzcGVjaWFsUnVsZXMgPSBnZXREZWZhdWx0U3BlY2lhbFJ1bGVzKCk7XG4gIGNvbnN0IHNwZWNpYWxSdWxlID0gc3BlY2lhbFJ1bGVzLmZpbmQoKHJ1bGUpID0+IHJ1bGUucGF0aE1hdGNoZXIocGF0aCkpO1xuICBpZiAoc3BlY2lhbFJ1bGUpIHtcbiAgICB3aW5kb3cgPSBzcGVjaWFsUnVsZS53aW5kb3c7XG4gICAgbWF4ID0gc3BlY2lhbFJ1bGUubWF4O1xuICB9XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIGN0eC5vcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICBpZiAocGx1Z2luLnJhdGVMaW1pdCkge1xuICAgICAgY29uc3QgbWF0Y2hlZFJ1bGUgPSBwbHVnaW4ucmF0ZUxpbWl0LmZpbmQoXG4gICAgICAgIChydWxlKSA9PiBydWxlLnBhdGhNYXRjaGVyKHBhdGgpXG4gICAgICApO1xuICAgICAgaWYgKG1hdGNoZWRSdWxlKSB7XG4gICAgICAgIHdpbmRvdyA9IG1hdGNoZWRSdWxlLndpbmRvdztcbiAgICAgICAgbWF4ID0gbWF0Y2hlZFJ1bGUubWF4O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGN0eC5yYXRlTGltaXQuY3VzdG9tUnVsZXMpIHtcbiAgICBjb25zdCBfcGF0aCA9IE9iamVjdC5rZXlzKGN0eC5yYXRlTGltaXQuY3VzdG9tUnVsZXMpLmZpbmQoKHApID0+IHtcbiAgICAgIGlmIChwLmluY2x1ZGVzKFwiKlwiKSkge1xuICAgICAgICBjb25zdCBpc01hdGNoMiA9IHdpbGRjYXJkTWF0Y2gocCkocGF0aCk7XG4gICAgICAgIHJldHVybiBpc01hdGNoMjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwID09PSBwYXRoO1xuICAgIH0pO1xuICAgIGlmIChfcGF0aCkge1xuICAgICAgY29uc3QgY3VzdG9tUnVsZSA9IGN0eC5yYXRlTGltaXQuY3VzdG9tUnVsZXNbX3BhdGhdO1xuICAgICAgY29uc3QgcmVzb2x2ZWQgPSB0eXBlb2YgY3VzdG9tUnVsZSA9PT0gXCJmdW5jdGlvblwiID8gYXdhaXQgY3VzdG9tUnVsZShyZXEpIDogY3VzdG9tUnVsZTtcbiAgICAgIGlmIChyZXNvbHZlZCkge1xuICAgICAgICB3aW5kb3cgPSByZXNvbHZlZC53aW5kb3c7XG4gICAgICAgIG1heCA9IHJlc29sdmVkLm1heDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgY29uc3Qgc3RvcmFnZSA9IGdldFJhdGVMaW1pdFN0b3JhZ2UoY3R4KTtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IHN0b3JhZ2UuZ2V0KGtleSk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGlmICghZGF0YSkge1xuICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KGtleSwge1xuICAgICAga2V5LFxuICAgICAgY291bnQ6IDEsXG4gICAgICBsYXN0UmVxdWVzdDogbm93XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgdGltZVNpbmNlTGFzdFJlcXVlc3QgPSBub3cgLSBkYXRhLmxhc3RSZXF1ZXN0O1xuICAgIGlmIChzaG91bGRSYXRlTGltaXQobWF4LCB3aW5kb3csIGRhdGEpKSB7XG4gICAgICBjb25zdCByZXRyeUFmdGVyID0gZ2V0UmV0cnlBZnRlcihkYXRhLmxhc3RSZXF1ZXN0LCB3aW5kb3cpO1xuICAgICAgcmV0dXJuIHJhdGVMaW1pdFJlc3BvbnNlKHJldHJ5QWZ0ZXIpO1xuICAgIH0gZWxzZSBpZiAodGltZVNpbmNlTGFzdFJlcXVlc3QgPiB3aW5kb3cgKiAxZTMpIHtcbiAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KFxuICAgICAgICBrZXksXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIGNvdW50OiAxLFxuICAgICAgICAgIGxhc3RSZXF1ZXN0OiBub3dcbiAgICAgICAgfSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgc3RvcmFnZS5zZXQoXG4gICAgICAgIGtleSxcbiAgICAgICAge1xuICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgY291bnQ6IGRhdGEuY291bnQgKyAxLFxuICAgICAgICAgIGxhc3RSZXF1ZXN0OiBub3dcbiAgICAgICAgfSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGdldERlZmF1bHRTcGVjaWFsUnVsZXMoKSB7XG4gIGNvbnN0IHNwZWNpYWxSdWxlcyA9IFtcbiAgICB7XG4gICAgICBwYXRoTWF0Y2hlcihwYXRoKSB7XG4gICAgICAgIHJldHVybiBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi1pblwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvc2lnbi11cFwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvY2hhbmdlLXBhc3N3b3JkXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9jaGFuZ2UtZW1haWxcIik7XG4gICAgICB9LFxuICAgICAgd2luZG93OiAxMCxcbiAgICAgIG1heDogM1xuICAgIH1cbiAgXTtcbiAgcmV0dXJuIHNwZWNpYWxSdWxlcztcbn1cbmZ1bmN0aW9uIGdldEVuZHBvaW50cyhjdHgsIG9wdGlvbnMpIHtcbiAgY29uc3QgcGx1Z2luRW5kcG9pbnRzID0gb3B0aW9ucy5wbHVnaW5zPy5yZWR1Y2UoXG4gICAgKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5hY2MsXG4gICAgICAgIC4uLnBsdWdpbi5lbmRwb2ludHNcbiAgICAgIH07XG4gICAgfSxcbiAgICB7fVxuICApO1xuICBjb25zdCBtaWRkbGV3YXJlcyA9IG9wdGlvbnMucGx1Z2lucz8ubWFwKFxuICAgIChwbHVnaW4pID0+IHBsdWdpbi5taWRkbGV3YXJlcz8ubWFwKChtKSA9PiB7XG4gICAgICBjb25zdCBtaWRkbGV3YXJlID0gYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgICAgICAgcmV0dXJuIG0ubWlkZGxld2FyZSh7XG4gICAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAuLi5jdHgsXG4gICAgICAgICAgICAuLi5jb250ZXh0LmNvbnRleHRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIG1pZGRsZXdhcmUucGF0aCA9IG0ucGF0aDtcbiAgICAgIG1pZGRsZXdhcmUub3B0aW9ucyA9IG0ubWlkZGxld2FyZS5vcHRpb25zO1xuICAgICAgbWlkZGxld2FyZS5oZWFkZXJzID0gbS5taWRkbGV3YXJlLmhlYWRlcnM7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRoOiBtLnBhdGgsXG4gICAgICAgIG1pZGRsZXdhcmVcbiAgICAgIH07XG4gICAgfSlcbiAgKS5maWx0ZXIoKHBsdWdpbikgPT4gcGx1Z2luICE9PSB2b2lkIDApLmZsYXQoKSB8fCBbXTtcbiAgY29uc3QgYmFzZUVuZHBvaW50cyA9IHtcbiAgICBzaWduSW5Tb2NpYWwsXG4gICAgY2FsbGJhY2tPQXV0aCxcbiAgICBnZXRTZXNzaW9uOiBnZXRTZXNzaW9uKCksXG4gICAgc2lnbk91dCxcbiAgICBzaWduVXBFbWFpbDogc2lnblVwRW1haWwoKSxcbiAgICBzaWduSW5FbWFpbCxcbiAgICBmb3JnZXRQYXNzd29yZCxcbiAgICByZXNldFBhc3N3b3JkLFxuICAgIHZlcmlmeUVtYWlsLFxuICAgIHNlbmRWZXJpZmljYXRpb25FbWFpbCxcbiAgICBjaGFuZ2VFbWFpbCxcbiAgICBjaGFuZ2VQYXNzd29yZCxcbiAgICBzZXRQYXNzd29yZCxcbiAgICB1cGRhdGVVc2VyOiB1cGRhdGVVc2VyKCksXG4gICAgZGVsZXRlVXNlcixcbiAgICBmb3JnZXRQYXNzd29yZENhbGxiYWNrLFxuICAgIGxpc3RTZXNzaW9uczogbGlzdFNlc3Npb25zKCksXG4gICAgcmV2b2tlU2Vzc2lvbixcbiAgICByZXZva2VTZXNzaW9ucyxcbiAgICByZXZva2VPdGhlclNlc3Npb25zLFxuICAgIGxpbmtTb2NpYWxBY2NvdW50LFxuICAgIGxpc3RVc2VyQWNjb3VudHMsXG4gICAgZGVsZXRlVXNlckNhbGxiYWNrLFxuICAgIHVubGlua0FjY291bnRcbiAgfTtcbiAgY29uc3QgZW5kcG9pbnRzID0ge1xuICAgIC4uLmJhc2VFbmRwb2ludHMsXG4gICAgLi4ucGx1Z2luRW5kcG9pbnRzLFxuICAgIG9rLFxuICAgIGVycm9yXG4gIH07XG4gIGxldCBhcGkgPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCBlbmRwb2ludF0gb2YgT2JqZWN0LmVudHJpZXMoZW5kcG9pbnRzKSkge1xuICAgIGFwaVtrZXldID0gYXN5bmMgKGNvbnRleHQgPSB7fSkgPT4ge1xuICAgICAgZW5kcG9pbnQuaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICBsZXQgaW50ZXJuYWxDdHggPSB7XG4gICAgICAgIHNldEhlYWRlcihrZXkyLCB2YWx1ZSkge1xuICAgICAgICAgIGVuZHBvaW50LmhlYWRlcnMuc2V0KGtleTIsIHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0Q29va2llKGtleTIsIHZhbHVlLCBvcHRpb25zMikge1xuICAgICAgICAgIHNldENvb2tpZShlbmRwb2ludC5oZWFkZXJzLCBrZXkyLCB2YWx1ZSwgb3B0aW9uczIpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRDb29raWUoa2V5MiwgcHJlZml4KSB7XG4gICAgICAgICAgY29uc3QgaGVhZGVyID0gY29udGV4dC5oZWFkZXJzO1xuICAgICAgICAgIGNvbnN0IGNvb2tpZUggPSBoZWFkZXI/LmdldChcImNvb2tpZVwiKTtcbiAgICAgICAgICBjb25zdCBjb29raWUgPSBnZXRDb29raWUoY29va2llSCB8fCBcIlwiLCBrZXkyLCBwcmVmaXgpO1xuICAgICAgICAgIHJldHVybiBjb29raWU7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFNpZ25lZENvb2tpZShrZXkyLCBzZWNyZXQsIHByZWZpeCkge1xuICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGNvbnRleHQuaGVhZGVycztcbiAgICAgICAgICBpZiAoIWhlYWRlcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IGdldFNpZ25lZENvb2tpZShoZWFkZXIsIHNlY3JldCwga2V5MiwgcHJlZml4KTtcbiAgICAgICAgICByZXR1cm4gY29va2llO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBzZXRTaWduZWRDb29raWUoa2V5MiwgdmFsdWUsIHNlY3JldCwgb3B0aW9uczIpIHtcbiAgICAgICAgICBhd2FpdCBzZXRTaWduZWRDb29raWUoZW5kcG9pbnQuaGVhZGVycywga2V5MiwgdmFsdWUsIHNlY3JldCwgb3B0aW9uczIpO1xuICAgICAgICB9LFxuICAgICAgICByZWRpcmVjdCh1cmwpIHtcbiAgICAgICAgICBlbmRwb2ludC5oZWFkZXJzLnNldChcIkxvY2F0aW9uXCIsIHVybCk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBBUElFcnJvcihcIkZPVU5EXCIpO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZUhlYWRlcjogZW5kcG9pbnQuaGVhZGVyc1xuICAgICAgfTtcbiAgICAgIGxldCBhdXRoQ3R4ID0gYXdhaXQgY3R4O1xuICAgICAgbGV0IG5ld1Nlc3Npb24gPSBudWxsO1xuICAgICAgbGV0IGludGVybmFsQ29udGV4dCA9IHtcbiAgICAgICAgLi4uaW50ZXJuYWxDdHgsXG4gICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgIHBhdGg6IGVuZHBvaW50LnBhdGgsXG4gICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAuLi5hdXRoQ3R4LFxuICAgICAgICAgIC4uLmNvbnRleHQuY29udGV4dCxcbiAgICAgICAgICBzZXNzaW9uOiBudWxsLFxuICAgICAgICAgIHNldE5ld1Nlc3Npb246IGZ1bmN0aW9uKHNlc3Npb24pIHtcbiAgICAgICAgICAgIHRoaXMubmV3U2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICAgICAgICBuZXdTZXNzaW9uID0gc2Vzc2lvbjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJldHVybmVkOiB2b2lkIDBcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VIZWFkZXI6IG5ldyBIZWFkZXJzKClcbiAgICAgIH07XG4gICAgICBjb25zdCBwbHVnaW5zID0gb3B0aW9ucy5wbHVnaW5zIHx8IFtdO1xuICAgICAgY29uc3QgYmVmb3JlSG9va3MgPSBwbHVnaW5zLm1hcCgocGx1Z2luKSA9PiB7XG4gICAgICAgIGlmIChwbHVnaW4uaG9va3M/LmJlZm9yZSkge1xuICAgICAgICAgIHJldHVybiBwbHVnaW4uaG9va3MuYmVmb3JlO1xuICAgICAgICB9XG4gICAgICB9KS5maWx0ZXIoKHBsdWdpbikgPT4gcGx1Z2luICE9PSB2b2lkIDApLmZsYXQoKTtcbiAgICAgIGNvbnN0IGFmdGVySG9va3MgPSBwbHVnaW5zLm1hcCgocGx1Z2luKSA9PiB7XG4gICAgICAgIGlmIChwbHVnaW4uaG9va3M/LmFmdGVyKSB7XG4gICAgICAgICAgcmV0dXJuIHBsdWdpbi5ob29rcy5hZnRlcjtcbiAgICAgICAgfVxuICAgICAgfSkuZmlsdGVyKChwbHVnaW4pID0+IHBsdWdpbiAhPT0gdm9pZCAwKS5mbGF0KCk7XG4gICAgICBpZiAob3B0aW9ucy5ob29rcz8uYmVmb3JlKSB7XG4gICAgICAgIGJlZm9yZUhvb2tzLnB1c2goe1xuICAgICAgICAgIG1hdGNoZXI6ICgpID0+IHRydWUsXG4gICAgICAgICAgaGFuZGxlcjogb3B0aW9ucy5ob29rcy5iZWZvcmVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5ob29rcz8uYWZ0ZXIpIHtcbiAgICAgICAgYWZ0ZXJIb29rcy5wdXNoKHtcbiAgICAgICAgICBtYXRjaGVyOiAoKSA9PiB0cnVlLFxuICAgICAgICAgIGhhbmRsZXI6IG9wdGlvbnMuaG9va3MuYWZ0ZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IGhvb2sgb2YgYmVmb3JlSG9va3MpIHtcbiAgICAgICAgaWYgKCFob29rLm1hdGNoZXIoaW50ZXJuYWxDb250ZXh0KSkgY29udGludWU7XG4gICAgICAgIGNvbnN0IGhvb2tSZXMgPSBhd2FpdCBob29rLmhhbmRsZXIoaW50ZXJuYWxDb250ZXh0KTtcbiAgICAgICAgaWYgKGhvb2tSZXMgJiYgXCJjb250ZXh0XCIgaW4gaG9va1Jlcykge1xuICAgICAgICAgIGludGVybmFsQ29udGV4dCA9IHtcbiAgICAgICAgICAgIC4uLmludGVybmFsQ29udGV4dCxcbiAgICAgICAgICAgIC4uLmhvb2tSZXMuY29udGV4dFxuICAgICAgICAgIH07XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhvb2tSZXMpIHtcbiAgICAgICAgICByZXR1cm4gaG9va1JlcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGV0IGVuZHBvaW50UmVzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgZW5kcG9pbnRSZXMgPSBhd2FpdCBlbmRwb2ludChpbnRlcm5hbENvbnRleHQpO1xuICAgICAgICBpZiAobmV3U2Vzc2lvbikge1xuICAgICAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0Lm5ld1Nlc3Npb24gPSBuZXdTZXNzaW9uO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChuZXdTZXNzaW9uKSB7XG4gICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQubmV3U2Vzc2lvbiA9IG5ld1Nlc3Npb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgIGlmICghYWZ0ZXJIb29rcz8ubGVuZ3RoKSB7XG4gICAgICAgICAgICBlLmhlYWRlcnMgPSBlbmRwb2ludC5oZWFkZXJzO1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSBlO1xuICAgICAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkLmhlYWRlcnMgPSBlbmRwb2ludC5oZWFkZXJzO1xuICAgICAgICAgIGZvciAoY29uc3QgaG9vayBvZiBhZnRlckhvb2tzIHx8IFtdKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IGhvb2subWF0Y2hlcihpbnRlcm5hbENvbnRleHQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaG9va1JlcyA9IGF3YWl0IGhvb2suaGFuZGxlcihpbnRlcm5hbENvbnRleHQpO1xuICAgICAgICAgICAgICAgIGlmIChob29rUmVzICYmIFwicmVzcG9uc2VcIiBpbiBob29rUmVzKSB7XG4gICAgICAgICAgICAgICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZCA9IGhvb2tSZXMucmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGNhdGNoIChlMikge1xuICAgICAgICAgICAgICAgIGlmIChlMiBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgICAgICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZCA9IGUyO1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IGUyO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZCBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZC5oZWFkZXJzID0gZW5kcG9pbnQuaGVhZGVycztcbiAgICAgICAgICAgIHRocm93IGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkID0gZW5kcG9pbnRSZXM7XG4gICAgICBpbnRlcm5hbENvbnRleHQucmVzcG9uc2VIZWFkZXIgPSBlbmRwb2ludC5oZWFkZXJzO1xuICAgICAgZm9yIChjb25zdCBob29rIG9mIGFmdGVySG9va3MpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBob29rLm1hdGNoZXIoaW50ZXJuYWxDb250ZXh0KTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGhvb2tSZXMgPSBhd2FpdCBob29rLmhhbmRsZXIoaW50ZXJuYWxDb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChob29rUmVzKSB7XG4gICAgICAgICAgICAgIGlmIChcInJlc3BvbnNlSGVhZGVyXCIgaW4gaG9va1Jlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBob29rUmVzLnJlc3BvbnNlSGVhZGVyO1xuICAgICAgICAgICAgICAgIGludGVybmFsQ29udGV4dC5yZXNwb25zZUhlYWRlciA9IGhlYWRlcnM7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSBob29rUmVzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZCA9IGU7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQ7XG4gICAgICBpZiAocmVzcG9uc2UgaW5zdGFuY2VvZiBSZXNwb25zZSkge1xuICAgICAgICBlbmRwb2ludC5oZWFkZXJzLmZvckVhY2goKHZhbHVlLCBrZXkyKSA9PiB7XG4gICAgICAgICAgaWYgKGtleTIgPT09IFwic2V0LWNvb2tpZVwiKSB7XG4gICAgICAgICAgICByZXNwb25zZS5oZWFkZXJzLmFwcGVuZChrZXkyLCB2YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KGtleTIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3BvbnNlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgcmVzcG9uc2UuaGVhZGVycyA9IGVuZHBvaW50LmhlYWRlcnM7XG4gICAgICAgIHRocm93IHJlc3BvbnNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH07XG4gICAgYXBpW2tleV0ucGF0aCA9IGVuZHBvaW50LnBhdGg7XG4gICAgYXBpW2tleV0ubWV0aG9kID0gZW5kcG9pbnQubWV0aG9kO1xuICAgIGFwaVtrZXldLm9wdGlvbnMgPSBlbmRwb2ludC5vcHRpb25zO1xuICAgIGFwaVtrZXldLmhlYWRlcnMgPSBlbmRwb2ludC5oZWFkZXJzO1xuICB9XG4gIHJldHVybiB7XG4gICAgYXBpLFxuICAgIG1pZGRsZXdhcmVzXG4gIH07XG59XG52YXIgcm91dGVyID0gKGN0eCwgb3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGFwaSwgbWlkZGxld2FyZXMgfSA9IGdldEVuZHBvaW50cyhjdHgsIG9wdGlvbnMpO1xuICBjb25zdCBiYXNlUGF0aCA9IG5ldyBVUkwoY3R4LmJhc2VVUkwpLnBhdGhuYW1lO1xuICByZXR1cm4gY3JlYXRlUm91dGVyKGFwaSwge1xuICAgIGV4dHJhQ29udGV4dDogY3R4LFxuICAgIGJhc2VQYXRoLFxuICAgIHJvdXRlck1pZGRsZXdhcmU6IFtcbiAgICAgIHtcbiAgICAgICAgcGF0aDogXCIvKipcIixcbiAgICAgICAgbWlkZGxld2FyZTogb3JpZ2luQ2hlY2tNaWRkbGV3YXJlXG4gICAgICB9LFxuICAgICAgLi4ubWlkZGxld2FyZXNcbiAgICBdLFxuICAgIGFzeW5jIG9uUmVxdWVzdChyZXEpIHtcbiAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIGN0eC5vcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICAgICAgaWYgKHBsdWdpbi5vblJlcXVlc3QpIHtcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBsdWdpbi5vblJlcXVlc3QocmVxLCBjdHgpO1xuICAgICAgICAgIGlmIChyZXNwb25zZSAmJiBcInJlc3BvbnNlXCIgaW4gcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZXNwb25zZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvblJlcXVlc3RSYXRlTGltaXQocmVxLCBjdHgpO1xuICAgIH0sXG4gICAgYXN5bmMgb25SZXNwb25zZShyZXMpIHtcbiAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIGN0eC5vcHRpb25zLnBsdWdpbnMgfHwgW10pIHtcbiAgICAgICAgaWYgKHBsdWdpbi5vblJlc3BvbnNlKSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwbHVnaW4ub25SZXNwb25zZShyZXMsIGN0eCk7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucmVzcG9uc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgb25FcnJvcihlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yICYmIGUuc3RhdHVzID09PSBcIkZPVU5EXCIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMub25BUElFcnJvcj8udGhyb3cpIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLm9uQVBJRXJyb3I/Lm9uRXJyb3IpIHtcbiAgICAgICAgb3B0aW9ucy5vbkFQSUVycm9yLm9uRXJyb3IoZSwgY3R4KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgb3B0TG9nTGV2ZWwgPSBvcHRpb25zLmxvZ2dlcj8ubGV2ZWw7XG4gICAgICBjb25zdCBsb2cgPSBvcHRMb2dMZXZlbCA9PT0gXCJlcnJvclwiIHx8IG9wdExvZ0xldmVsID09PSBcIndhcm5cIiB8fCBvcHRMb2dMZXZlbCA9PT0gXCJkZWJ1Z1wiID8gbG9nZ2VyIDogdm9pZCAwO1xuICAgICAgaWYgKG9wdGlvbnMubG9nZ2VyPy5kaXNhYmxlZCAhPT0gdHJ1ZSkge1xuICAgICAgICBpZiAoZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm1lc3NhZ2VcIiBpbiBlICYmIHR5cGVvZiBlLm1lc3NhZ2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKFwibm8gY29sdW1uXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcImNvbHVtblwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJyZWxhdGlvblwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJ0YWJsZVwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJkb2VzIG5vdCBleGlzdFwiKSkge1xuICAgICAgICAgICAgY3R4LmxvZ2dlcj8uZXJyb3IoZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgIGlmIChlLnN0YXR1cyA9PT0gXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIikge1xuICAgICAgICAgICAgY3R4LmxvZ2dlci5lcnJvcihlLnN0YXR1cywgZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxvZz8uZXJyb3IoZS5tZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdHgubG9nZ2VyPy5lcnJvcihcbiAgICAgICAgICAgIGUgJiYgdHlwZW9mIGUgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZSA/IGUubmFtZSA6IFwiXCIsXG4gICAgICAgICAgICBlXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5leHBvcnQgeyBCQVNFX0VSUk9SX0NPREVTLCBjYWxsYmFja09BdXRoLCBjaGFuZ2VFbWFpbCwgY2hhbmdlUGFzc3dvcmQsIGNyZWF0ZUF1dGhFbmRwb2ludCwgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4sIGRlbGV0ZVVzZXIsIGRlbGV0ZVVzZXJDYWxsYmFjaywgZXJyb3IsIGZvcmdldFBhc3N3b3JkLCBmb3JnZXRQYXNzd29yZENhbGxiYWNrLCBmcmVzaFNlc3Npb25NaWRkbGV3YXJlLCBnZXRFbmRwb2ludHMsIGdldFNlc3Npb24sIGdldFNlc3Npb25Gcm9tQ3R4LCBoYW5kbGVPQXV0aFVzZXJJbmZvLCBsaW5rU29jaWFsQWNjb3VudCwgbGlzdFNlc3Npb25zLCBsaXN0VXNlckFjY291bnRzLCBvaywgb3B0aW9uc01pZGRsZXdhcmUsIG9yaWdpbkNoZWNrLCBvcmlnaW5DaGVja01pZGRsZXdhcmUsIHJlc2V0UGFzc3dvcmQsIHJldm9rZU90aGVyU2Vzc2lvbnMsIHJldm9rZVNlc3Npb24sIHJldm9rZVNlc3Npb25zLCByb3V0ZXIsIHNlbmRWZXJpZmljYXRpb25FbWFpbCwgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4sIHNlc3Npb25NaWRkbGV3YXJlLCBzZXRQYXNzd29yZCwgc2lnbkluRW1haWwsIHNpZ25JblNvY2lhbCwgc2lnbk91dCwgc2lnblVwRW1haWwsIHVubGlua0FjY291bnQsIHVwZGF0ZVVzZXIsIHZlcmlmeUVtYWlsIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/index.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/index.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BetterAuthError: () => (/* reexport safe */ _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError),\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.HIDE_METADATA),\n/* harmony export */   MissingDependencyError: () => (/* reexport safe */ _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_16__.MissingDependencyError),\n/* harmony export */   betterAuth: () => (/* binding */ betterAuth),\n/* harmony export */   capitalizeFirstLetter: () => (/* reexport safe */ _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_11__.capitalizeFirstLetter),\n/* harmony export */   createCookieGetter: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.createCookieGetter),\n/* harmony export */   createLogger: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.createLogger),\n/* harmony export */   deleteSessionCookie: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.deleteSessionCookie),\n/* harmony export */   generateId: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.generateId),\n/* harmony export */   generateState: () => (/* reexport safe */ _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_9__.generateState),\n/* harmony export */   getCookieCache: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getCookieCache),\n/* harmony export */   getCookies: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getCookies),\n/* harmony export */   getSessionCookie: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getSessionCookie),\n/* harmony export */   levels: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.levels),\n/* harmony export */   logger: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.logger),\n/* harmony export */   parseCookies: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.parseCookies),\n/* harmony export */   parseSetCookieHeader: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.parseSetCookieHeader),\n/* harmony export */   parseState: () => (/* reexport safe */ _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_9__.parseState),\n/* harmony export */   setCookieCache: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.setCookieCache),\n/* harmony export */   setSessionCookie: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.setSessionCookie),\n/* harmony export */   shouldPublishLog: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.shouldPublishLog)\n/* harmony export */ });\n/* harmony import */ var _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TOKZL3ZI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-VXDYNCOX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\");\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-62MWLLEG.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_SK6Y2YH6_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./chunk-SK6Y2YH6.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./chunk-3XTQSPPA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! defu */ \"(action-browser)/./node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// src/utils/constants.ts\nvar DEFAULT_SECRET = \"better-auth-secret-123456789\";\n\n// src/init.ts\nvar init = async (options) => {\n  const adapter = await (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.getAdapter)(options);\n  const plugins = options.plugins || [];\n  const internalPlugins = getInternalPlugins(options);\n  const logger2 = (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.createLogger)(options.logger);\n  const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__.getBaseURL)(options.baseURL, options.basePath);\n  const secret = options.secret || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.env.BETTER_AUTH_SECRET || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.env.AUTH_SECRET || DEFAULT_SECRET;\n  if (secret === DEFAULT_SECRET) {\n    if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.isProduction) {\n      logger2.error(\n        \"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\"\n      );\n    }\n  }\n  options = {\n    ...options,\n    secret,\n    baseURL: baseURL ? new URL(baseURL).origin : \"\",\n    basePath: options.basePath || \"/api/auth\",\n    plugins: plugins.concat(internalPlugins)\n  };\n  const cookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getCookies)(options);\n  const tables = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.getAuthTables)(options);\n  const providers = Object.keys(options.socialProviders || {}).map((key) => {\n    const value = options.socialProviders?.[key];\n    if (!value || value.enabled === false) {\n      return null;\n    }\n    if (!value.clientId) {\n      logger2.warn(\n        `Social provider ${key} is missing clientId or clientSecret`\n      );\n    }\n    return _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_2__.socialProviders[key](\n      value\n      // TODO: fix this\n    );\n  }).filter((x) => x !== null);\n  const generateIdFunc = ({ model, size }) => {\n    if (typeof options?.advanced?.generateId === \"function\") {\n      return options.advanced.generateId({ model, size });\n    }\n    return (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.generateId)(size);\n  };\n  const ctx = {\n    appName: options.appName || \"Better Auth\",\n    socialProviders: providers,\n    options,\n    tables,\n    trustedOrigins: getTrustedOrigins(options),\n    baseURL: baseURL || \"\",\n    sessionConfig: {\n      updateAge: options.session?.updateAge !== void 0 ? options.session.updateAge : 24 * 60 * 60,\n      // 24 hours\n      expiresIn: options.session?.expiresIn || 60 * 60 * 24 * 7,\n      // 7 days\n      freshAge: options.session?.freshAge === void 0 ? 60 * 60 * 24 : options.session.freshAge\n    },\n    secret,\n    rateLimit: {\n      ...options.rateLimit,\n      enabled: options.rateLimit?.enabled ?? _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.isProduction,\n      window: options.rateLimit?.window || 10,\n      max: options.rateLimit?.max || 100,\n      storage: options.rateLimit?.storage || (options.secondaryStorage ? \"secondary-storage\" : \"memory\")\n    },\n    authCookies: cookies,\n    logger: logger2,\n    generateId: generateIdFunc,\n    session: null,\n    secondaryStorage: options.secondaryStorage,\n    password: {\n      hash: options.emailAndPassword?.password?.hash || _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_12__.hashPassword,\n      verify: options.emailAndPassword?.password?.verify || _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_12__.verifyPassword,\n      config: {\n        minPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n        maxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128\n      },\n      checkPassword: _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_0__.checkPassword\n    },\n    setNewSession(session) {\n      this.newSession = session;\n    },\n    newSession: null,\n    adapter,\n    internalAdapter: (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.createInternalAdapter)(adapter, {\n      options,\n      hooks: options.databaseHooks ? [options.databaseHooks] : [],\n      generateId: generateIdFunc\n    }),\n    createAuthCookie: (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.createCookieGetter)(options)\n  };\n  let { context } = runPluginInit(ctx);\n  return context;\n};\nfunction runPluginInit(ctx) {\n  let options = ctx.options;\n  const plugins = options.plugins || [];\n  let context = ctx;\n  const dbHooks = [];\n  for (const plugin of plugins) {\n    if (plugin.init) {\n      const result = plugin.init(ctx);\n      if (typeof result === \"object\") {\n        if (result.options) {\n          const { databaseHooks, ...restOpts } = result.options;\n          if (databaseHooks) {\n            dbHooks.push(databaseHooks);\n          }\n          options = (0,defu__WEBPACK_IMPORTED_MODULE_17__.defu)(options, restOpts);\n        }\n        if (result.context) {\n          context = {\n            ...context,\n            ...result.context\n          };\n        }\n      }\n    }\n  }\n  dbHooks.push(options.databaseHooks);\n  context.internalAdapter = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.createInternalAdapter)(ctx.adapter, {\n    options,\n    hooks: dbHooks.filter((u) => u !== void 0),\n    generateId: ctx.generateId\n  });\n  context.options = options;\n  return { context };\n}\nfunction getInternalPlugins(options) {\n  const plugins = [];\n  if (options.advanced?.crossSubDomainCookies?.enabled) ;\n  return plugins;\n}\nfunction getTrustedOrigins(options) {\n  const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__.getBaseURL)(options.baseURL, options.basePath);\n  if (!baseURL) {\n    return [];\n  }\n  const trustedOrigins = [new URL(baseURL).origin];\n  if (options.trustedOrigins && Array.isArray(options.trustedOrigins)) {\n    trustedOrigins.push(...options.trustedOrigins);\n  }\n  const envTrustedOrigins = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.env.BETTER_AUTH_TRUSTED_ORIGINS;\n  if (envTrustedOrigins) {\n    trustedOrigins.push(...envTrustedOrigins.split(\",\"));\n  }\n  return trustedOrigins;\n}\n\n// src/auth.ts\nvar betterAuth = (options) => {\n  const authContext = init(options);\n  const { api } = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getEndpoints)(authContext, options);\n  const errorCodes = options.plugins?.reduce((acc, plugin) => {\n    if (plugin.$ERROR_CODES) {\n      return {\n        ...acc,\n        ...plugin.$ERROR_CODES\n      };\n    }\n    return acc;\n  }, {});\n  return {\n    handler: async (request) => {\n      const ctx = await authContext;\n      const basePath = ctx.options.basePath || \"/api/auth\";\n      const url = new URL(request.url);\n      if (!ctx.options.baseURL) {\n        const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__.getBaseURL)(void 0, basePath) || `${url.origin}${basePath}`;\n        ctx.options.baseURL = baseURL;\n        ctx.baseURL = baseURL;\n      }\n      ctx.trustedOrigins = [\n        ...options.trustedOrigins ? Array.isArray(options.trustedOrigins) ? options.trustedOrigins : options.trustedOrigins(request) : [],\n        ctx.options.baseURL,\n        url.origin\n      ];\n      const { handler } = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.router)(ctx, options);\n      return handler(request);\n    },\n    api,\n    options,\n    $context: authContext,\n    $Infer: {},\n    $ERROR_CODES: {\n      ...errorCodes,\n      ..._chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.BASE_ERROR_CODES\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW9EO0FBQ3lCO0FBQ3ZCO0FBQ3pCO0FBQ29CO0FBQ29CO0FBQzZIO0FBQzNHO0FBQzFEO0FBQ2tDO0FBQ2lEO0FBQ2hEO0FBQ25DO0FBQytCO0FBQ087QUFDdEM7QUFDQTtBQUMyQjtBQUNzQjtBQUNsRDs7QUFFNUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0JBQXdCLDhEQUFVO0FBQ2xDO0FBQ0E7QUFDQSxrQkFBa0IsZ0VBQVk7QUFDOUIsa0JBQWtCLDhEQUFVO0FBQzVCLG1DQUFtQyxvREFBRyx1QkFBdUIsb0RBQUc7QUFDaEU7QUFDQSxRQUFRLDZEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw4REFBVTtBQUM1QixpQkFBaUIsaUVBQWE7QUFDOUIsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixLQUFLO0FBQ2hDO0FBQ0E7QUFDQSxXQUFXLCtEQUFlO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCw0QkFBNEIsYUFBYTtBQUN6QztBQUNBLDJDQUEyQyxhQUFhO0FBQ3hEO0FBQ0EsV0FBVyw4REFBVTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLDZDQUE2Qyw2REFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELDZEQUFZO0FBQ3BFLDREQUE0RCwrREFBYztBQUMxRTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsbUJBQW1CO0FBQ25CLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxxQkFBcUIseUVBQXFCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxzQkFBc0Isc0VBQWtCO0FBQ3hDO0FBQ0EsUUFBUSxVQUFVO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw2QkFBNkI7QUFDL0M7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJDQUFJO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIseUVBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw4REFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvREFBRztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsTUFBTSxFQUFFLGdFQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLElBQUk7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOERBQVUseUJBQXlCLFdBQVcsRUFBRSxTQUFTO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFVBQVUsRUFBRSwwREFBTTtBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBLFNBQVMsZ0VBQWdCO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFc0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGVja1Bhc3N3b3JkIH0gZnJvbSAnLi9jaHVuay1UT0taTDNaSS5qcyc7XG5pbXBvcnQgeyBnZXRFbmRwb2ludHMsIHJvdXRlciwgQkFTRV9FUlJPUl9DT0RFUyB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgc29jaWFsUHJvdmlkZXJzIH0gZnJvbSAnLi9jaHVuay1WWERZTkNPWC5qcyc7XG5pbXBvcnQgJy4vY2h1bmstR1RRTTdKVTcuanMnO1xuaW1wb3J0IHsgZ2V0QmFzZVVSTCB9IGZyb20gJy4vY2h1bmstWEZDSUFOWlguanMnO1xuaW1wb3J0IHsgZ2V0Q29va2llcywgY3JlYXRlQ29va2llR2V0dGVyIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5leHBvcnQgeyBjcmVhdGVDb29raWVHZXR0ZXIsIGRlbGV0ZVNlc3Npb25Db29raWUsIGdldENvb2tpZUNhY2hlLCBnZXRDb29raWVzLCBnZXRTZXNzaW9uQ29va2llLCBwYXJzZUNvb2tpZXMsIHBhcnNlU2V0Q29va2llSGVhZGVyLCBzZXRDb29raWVDYWNoZSwgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgZ2V0QWRhcHRlciwgZ2V0QXV0aFRhYmxlcywgY3JlYXRlSW50ZXJuYWxBZGFwdGVyIH0gZnJvbSAnLi9jaHVuay02Mk1XTExFRy5qcyc7XG5pbXBvcnQgJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgY3JlYXRlTG9nZ2VyLCBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9jaHVuay1LTERGQkxZTC5qcyc7XG5leHBvcnQgeyBISURFX01FVEFEQVRBLCBjcmVhdGVMb2dnZXIsIGdlbmVyYXRlSWQsIGxldmVscywgbG9nZ2VyLCBzaG91bGRQdWJsaXNoTG9nIH0gZnJvbSAnLi9jaHVuay1LTERGQkxZTC5qcyc7XG5leHBvcnQgeyBnZW5lcmF0ZVN0YXRlLCBwYXJzZVN0YXRlIH0gZnJvbSAnLi9jaHVuay1OUE82NFNWTi5qcyc7XG5pbXBvcnQgJy4vY2h1bmstU0s2WTJZSDYuanMnO1xuZXhwb3J0IHsgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyIH0gZnJvbSAnLi9jaHVuay0zWFRRU1BQQS5qcyc7XG5pbXBvcnQgeyBoYXNoUGFzc3dvcmQsIHZlcmlmeVBhc3N3b3JkIH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgJy4vY2h1bmstNTNJUE8yUEouanMnO1xuaW1wb3J0ICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IGVudiwgaXNQcm9kdWN0aW9uIH0gZnJvbSAnLi9jaHVuay1UUVFTUFBOQS5qcyc7XG5leHBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IsIE1pc3NpbmdEZXBlbmRlbmN5RXJyb3IgfSBmcm9tICcuL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IGRlZnUgfSBmcm9tICdkZWZ1JztcblxuLy8gc3JjL3V0aWxzL2NvbnN0YW50cy50c1xudmFyIERFRkFVTFRfU0VDUkVUID0gXCJiZXR0ZXItYXV0aC1zZWNyZXQtMTIzNDU2Nzg5XCI7XG5cbi8vIHNyYy9pbml0LnRzXG52YXIgaW5pdCA9IGFzeW5jIChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGFkYXB0ZXIgPSBhd2FpdCBnZXRBZGFwdGVyKG9wdGlvbnMpO1xuICBjb25zdCBwbHVnaW5zID0gb3B0aW9ucy5wbHVnaW5zIHx8IFtdO1xuICBjb25zdCBpbnRlcm5hbFBsdWdpbnMgPSBnZXRJbnRlcm5hbFBsdWdpbnMob3B0aW9ucyk7XG4gIGNvbnN0IGxvZ2dlcjIgPSBjcmVhdGVMb2dnZXIob3B0aW9ucy5sb2dnZXIpO1xuICBjb25zdCBiYXNlVVJMID0gZ2V0QmFzZVVSTChvcHRpb25zLmJhc2VVUkwsIG9wdGlvbnMuYmFzZVBhdGgpO1xuICBjb25zdCBzZWNyZXQgPSBvcHRpb25zLnNlY3JldCB8fCBlbnYuQkVUVEVSX0FVVEhfU0VDUkVUIHx8IGVudi5BVVRIX1NFQ1JFVCB8fCBERUZBVUxUX1NFQ1JFVDtcbiAgaWYgKHNlY3JldCA9PT0gREVGQVVMVF9TRUNSRVQpIHtcbiAgICBpZiAoaXNQcm9kdWN0aW9uKSB7XG4gICAgICBsb2dnZXIyLmVycm9yKFxuICAgICAgICBcIllvdSBhcmUgdXNpbmcgdGhlIGRlZmF1bHQgc2VjcmV0LiBQbGVhc2Ugc2V0IGBCRVRURVJfQVVUSF9TRUNSRVRgIGluIHlvdXIgZW52aXJvbm1lbnQgdmFyaWFibGVzIG9yIHBhc3MgYHNlY3JldGAgaW4geW91ciBhdXRoIGNvbmZpZy5cIlxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgb3B0aW9ucyA9IHtcbiAgICAuLi5vcHRpb25zLFxuICAgIHNlY3JldCxcbiAgICBiYXNlVVJMOiBiYXNlVVJMID8gbmV3IFVSTChiYXNlVVJMKS5vcmlnaW4gOiBcIlwiLFxuICAgIGJhc2VQYXRoOiBvcHRpb25zLmJhc2VQYXRoIHx8IFwiL2FwaS9hdXRoXCIsXG4gICAgcGx1Z2luczogcGx1Z2lucy5jb25jYXQoaW50ZXJuYWxQbHVnaW5zKVxuICB9O1xuICBjb25zdCBjb29raWVzID0gZ2V0Q29va2llcyhvcHRpb25zKTtcbiAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgY29uc3QgcHJvdmlkZXJzID0gT2JqZWN0LmtleXMob3B0aW9ucy5zb2NpYWxQcm92aWRlcnMgfHwge30pLm1hcCgoa2V5KSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSBvcHRpb25zLnNvY2lhbFByb3ZpZGVycz8uW2tleV07XG4gICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICghdmFsdWUuY2xpZW50SWQpIHtcbiAgICAgIGxvZ2dlcjIud2FybihcbiAgICAgICAgYFNvY2lhbCBwcm92aWRlciAke2tleX0gaXMgbWlzc2luZyBjbGllbnRJZCBvciBjbGllbnRTZWNyZXRgXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gc29jaWFsUHJvdmlkZXJzW2tleV0oXG4gICAgICB2YWx1ZVxuICAgICAgLy8gVE9ETzogZml4IHRoaXNcbiAgICApO1xuICB9KS5maWx0ZXIoKHgpID0+IHggIT09IG51bGwpO1xuICBjb25zdCBnZW5lcmF0ZUlkRnVuYyA9ICh7IG1vZGVsLCBzaXplIH0pID0+IHtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnM/LmFkdmFuY2VkPy5nZW5lcmF0ZUlkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmFkdmFuY2VkLmdlbmVyYXRlSWQoeyBtb2RlbCwgc2l6ZSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGdlbmVyYXRlSWQoc2l6ZSk7XG4gIH07XG4gIGNvbnN0IGN0eCA9IHtcbiAgICBhcHBOYW1lOiBvcHRpb25zLmFwcE5hbWUgfHwgXCJCZXR0ZXIgQXV0aFwiLFxuICAgIHNvY2lhbFByb3ZpZGVyczogcHJvdmlkZXJzLFxuICAgIG9wdGlvbnMsXG4gICAgdGFibGVzLFxuICAgIHRydXN0ZWRPcmlnaW5zOiBnZXRUcnVzdGVkT3JpZ2lucyhvcHRpb25zKSxcbiAgICBiYXNlVVJMOiBiYXNlVVJMIHx8IFwiXCIsXG4gICAgc2Vzc2lvbkNvbmZpZzoge1xuICAgICAgdXBkYXRlQWdlOiBvcHRpb25zLnNlc3Npb24/LnVwZGF0ZUFnZSAhPT0gdm9pZCAwID8gb3B0aW9ucy5zZXNzaW9uLnVwZGF0ZUFnZSA6IDI0ICogNjAgKiA2MCxcbiAgICAgIC8vIDI0IGhvdXJzXG4gICAgICBleHBpcmVzSW46IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luIHx8IDYwICogNjAgKiAyNCAqIDcsXG4gICAgICAvLyA3IGRheXNcbiAgICAgIGZyZXNoQWdlOiBvcHRpb25zLnNlc3Npb24/LmZyZXNoQWdlID09PSB2b2lkIDAgPyA2MCAqIDYwICogMjQgOiBvcHRpb25zLnNlc3Npb24uZnJlc2hBZ2VcbiAgICB9LFxuICAgIHNlY3JldCxcbiAgICByYXRlTGltaXQ6IHtcbiAgICAgIC4uLm9wdGlvbnMucmF0ZUxpbWl0LFxuICAgICAgZW5hYmxlZDogb3B0aW9ucy5yYXRlTGltaXQ/LmVuYWJsZWQgPz8gaXNQcm9kdWN0aW9uLFxuICAgICAgd2luZG93OiBvcHRpb25zLnJhdGVMaW1pdD8ud2luZG93IHx8IDEwLFxuICAgICAgbWF4OiBvcHRpb25zLnJhdGVMaW1pdD8ubWF4IHx8IDEwMCxcbiAgICAgIHN0b3JhZ2U6IG9wdGlvbnMucmF0ZUxpbWl0Py5zdG9yYWdlIHx8IChvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2UgPyBcInNlY29uZGFyeS1zdG9yYWdlXCIgOiBcIm1lbW9yeVwiKVxuICAgIH0sXG4gICAgYXV0aENvb2tpZXM6IGNvb2tpZXMsXG4gICAgbG9nZ2VyOiBsb2dnZXIyLFxuICAgIGdlbmVyYXRlSWQ6IGdlbmVyYXRlSWRGdW5jLFxuICAgIHNlc3Npb246IG51bGwsXG4gICAgc2Vjb25kYXJ5U3RvcmFnZTogb3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlLFxuICAgIHBhc3N3b3JkOiB7XG4gICAgICBoYXNoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnBhc3N3b3JkPy5oYXNoIHx8IGhhc2hQYXNzd29yZCxcbiAgICAgIHZlcmlmeTogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5wYXNzd29yZD8udmVyaWZ5IHx8IHZlcmlmeVBhc3N3b3JkLFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIG1pblBhc3N3b3JkTGVuZ3RoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm1pblBhc3N3b3JkTGVuZ3RoIHx8IDgsXG4gICAgICAgIG1heFBhc3N3b3JkTGVuZ3RoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm1heFBhc3N3b3JkTGVuZ3RoIHx8IDEyOFxuICAgICAgfSxcbiAgICAgIGNoZWNrUGFzc3dvcmRcbiAgICB9LFxuICAgIHNldE5ld1Nlc3Npb24oc2Vzc2lvbikge1xuICAgICAgdGhpcy5uZXdTZXNzaW9uID0gc2Vzc2lvbjtcbiAgICB9LFxuICAgIG5ld1Nlc3Npb246IG51bGwsXG4gICAgYWRhcHRlcixcbiAgICBpbnRlcm5hbEFkYXB0ZXI6IGNyZWF0ZUludGVybmFsQWRhcHRlcihhZGFwdGVyLCB7XG4gICAgICBvcHRpb25zLFxuICAgICAgaG9va3M6IG9wdGlvbnMuZGF0YWJhc2VIb29rcyA/IFtvcHRpb25zLmRhdGFiYXNlSG9va3NdIDogW10sXG4gICAgICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkRnVuY1xuICAgIH0pLFxuICAgIGNyZWF0ZUF1dGhDb29raWU6IGNyZWF0ZUNvb2tpZUdldHRlcihvcHRpb25zKVxuICB9O1xuICBsZXQgeyBjb250ZXh0IH0gPSBydW5QbHVnaW5Jbml0KGN0eCk7XG4gIHJldHVybiBjb250ZXh0O1xufTtcbmZ1bmN0aW9uIHJ1blBsdWdpbkluaXQoY3R4KSB7XG4gIGxldCBvcHRpb25zID0gY3R4Lm9wdGlvbnM7XG4gIGNvbnN0IHBsdWdpbnMgPSBvcHRpb25zLnBsdWdpbnMgfHwgW107XG4gIGxldCBjb250ZXh0ID0gY3R4O1xuICBjb25zdCBkYkhvb2tzID0gW107XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIHBsdWdpbnMpIHtcbiAgICBpZiAocGx1Z2luLmluaXQpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBsdWdpbi5pbml0KGN0eCk7XG4gICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAocmVzdWx0Lm9wdGlvbnMpIHtcbiAgICAgICAgICBjb25zdCB7IGRhdGFiYXNlSG9va3MsIC4uLnJlc3RPcHRzIH0gPSByZXN1bHQub3B0aW9ucztcbiAgICAgICAgICBpZiAoZGF0YWJhc2VIb29rcykge1xuICAgICAgICAgICAgZGJIb29rcy5wdXNoKGRhdGFiYXNlSG9va3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcHRpb25zID0gZGVmdShvcHRpb25zLCByZXN0T3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdC5jb250ZXh0KSB7XG4gICAgICAgICAgY29udGV4dCA9IHtcbiAgICAgICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgICAgICAuLi5yZXN1bHQuY29udGV4dFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZGJIb29rcy5wdXNoKG9wdGlvbnMuZGF0YWJhc2VIb29rcyk7XG4gIGNvbnRleHQuaW50ZXJuYWxBZGFwdGVyID0gY3JlYXRlSW50ZXJuYWxBZGFwdGVyKGN0eC5hZGFwdGVyLCB7XG4gICAgb3B0aW9ucyxcbiAgICBob29rczogZGJIb29rcy5maWx0ZXIoKHUpID0+IHUgIT09IHZvaWQgMCksXG4gICAgZ2VuZXJhdGVJZDogY3R4LmdlbmVyYXRlSWRcbiAgfSk7XG4gIGNvbnRleHQub3B0aW9ucyA9IG9wdGlvbnM7XG4gIHJldHVybiB7IGNvbnRleHQgfTtcbn1cbmZ1bmN0aW9uIGdldEludGVybmFsUGx1Z2lucyhvcHRpb25zKSB7XG4gIGNvbnN0IHBsdWdpbnMgPSBbXTtcbiAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uZW5hYmxlZCkgO1xuICByZXR1cm4gcGx1Z2lucztcbn1cbmZ1bmN0aW9uIGdldFRydXN0ZWRPcmlnaW5zKG9wdGlvbnMpIHtcbiAgY29uc3QgYmFzZVVSTCA9IGdldEJhc2VVUkwob3B0aW9ucy5iYXNlVVJMLCBvcHRpb25zLmJhc2VQYXRoKTtcbiAgaWYgKCFiYXNlVVJMKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gW25ldyBVUkwoYmFzZVVSTCkub3JpZ2luXTtcbiAgaWYgKG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMgJiYgQXJyYXkuaXNBcnJheShvcHRpb25zLnRydXN0ZWRPcmlnaW5zKSkge1xuICAgIHRydXN0ZWRPcmlnaW5zLnB1c2goLi4ub3B0aW9ucy50cnVzdGVkT3JpZ2lucyk7XG4gIH1cbiAgY29uc3QgZW52VHJ1c3RlZE9yaWdpbnMgPSBlbnYuQkVUVEVSX0FVVEhfVFJVU1RFRF9PUklHSU5TO1xuICBpZiAoZW52VHJ1c3RlZE9yaWdpbnMpIHtcbiAgICB0cnVzdGVkT3JpZ2lucy5wdXNoKC4uLmVudlRydXN0ZWRPcmlnaW5zLnNwbGl0KFwiLFwiKSk7XG4gIH1cbiAgcmV0dXJuIHRydXN0ZWRPcmlnaW5zO1xufVxuXG4vLyBzcmMvYXV0aC50c1xudmFyIGJldHRlckF1dGggPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBhdXRoQ29udGV4dCA9IGluaXQob3B0aW9ucyk7XG4gIGNvbnN0IHsgYXBpIH0gPSBnZXRFbmRwb2ludHMoYXV0aENvbnRleHQsIG9wdGlvbnMpO1xuICBjb25zdCBlcnJvckNvZGVzID0gb3B0aW9ucy5wbHVnaW5zPy5yZWR1Y2UoKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgaWYgKHBsdWdpbi4kRVJST1JfQ09ERVMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmFjYyxcbiAgICAgICAgLi4ucGx1Z2luLiRFUlJPUl9DT0RFU1xuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuICByZXR1cm4ge1xuICAgIGhhbmRsZXI6IGFzeW5jIChyZXF1ZXN0KSA9PiB7XG4gICAgICBjb25zdCBjdHggPSBhd2FpdCBhdXRoQ29udGV4dDtcbiAgICAgIGNvbnN0IGJhc2VQYXRoID0gY3R4Lm9wdGlvbnMuYmFzZVBhdGggfHwgXCIvYXBpL2F1dGhcIjtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgaWYgKCFjdHgub3B0aW9ucy5iYXNlVVJMKSB7XG4gICAgICAgIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKHZvaWQgMCwgYmFzZVBhdGgpIHx8IGAke3VybC5vcmlnaW59JHtiYXNlUGF0aH1gO1xuICAgICAgICBjdHgub3B0aW9ucy5iYXNlVVJMID0gYmFzZVVSTDtcbiAgICAgICAgY3R4LmJhc2VVUkwgPSBiYXNlVVJMO1xuICAgICAgfVxuICAgICAgY3R4LnRydXN0ZWRPcmlnaW5zID0gW1xuICAgICAgICAuLi5vcHRpb25zLnRydXN0ZWRPcmlnaW5zID8gQXJyYXkuaXNBcnJheShvcHRpb25zLnRydXN0ZWRPcmlnaW5zKSA/IG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMgOiBvcHRpb25zLnRydXN0ZWRPcmlnaW5zKHJlcXVlc3QpIDogW10sXG4gICAgICAgIGN0eC5vcHRpb25zLmJhc2VVUkwsXG4gICAgICAgIHVybC5vcmlnaW5cbiAgICAgIF07XG4gICAgICBjb25zdCB7IGhhbmRsZXIgfSA9IHJvdXRlcihjdHgsIG9wdGlvbnMpO1xuICAgICAgcmV0dXJuIGhhbmRsZXIocmVxdWVzdCk7XG4gICAgfSxcbiAgICBhcGksXG4gICAgb3B0aW9ucyxcbiAgICAkY29udGV4dDogYXV0aENvbnRleHQsXG4gICAgJEluZmVyOiB7fSxcbiAgICAkRVJST1JfQ09ERVM6IHtcbiAgICAgIC4uLmVycm9yQ29kZXMsXG4gICAgICAuLi5CQVNFX0VSUk9SX0NPREVTXG4gICAgfVxuICB9O1xufTtcblxuZXhwb3J0IHsgYmV0dGVyQXV0aCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/index.js\n");

/***/ }),

/***/ "(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/plugins.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/plugins.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_28__.HIDE_METADATA),\n/* harmony export */   admin: () => (/* reexport safe */ _chunk_NP2H7VJV_js__WEBPACK_IMPORTED_MODULE_11__.admin),\n/* harmony export */   anonymous: () => (/* reexport safe */ _chunk_PZOB66AP_js__WEBPACK_IMPORTED_MODULE_12__.anonymous),\n/* harmony export */   bearer: () => (/* reexport safe */ _chunk_KKKJI5Y7_js__WEBPACK_IMPORTED_MODULE_13__.bearer),\n/* harmony export */   createAuthEndpoint: () => (/* reexport safe */ _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* reexport safe */ _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthMiddleware),\n/* harmony export */   customSession: () => (/* reexport safe */ _chunk_FR3BYA47_js__WEBPACK_IMPORTED_MODULE_14__.customSession),\n/* harmony export */   emailOTP: () => (/* reexport safe */ _chunk_LNAETVOO_js__WEBPACK_IMPORTED_MODULE_15__.emailOTP),\n/* harmony export */   genericOAuth: () => (/* reexport safe */ _chunk_NIUW4WF7_js__WEBPACK_IMPORTED_MODULE_16__.genericOAuth),\n/* harmony export */   jwt: () => (/* reexport safe */ _chunk_7LU7PVPP_js__WEBPACK_IMPORTED_MODULE_4__.jwt),\n/* harmony export */   magicLink: () => (/* reexport safe */ _chunk_2KOUY3SJ_js__WEBPACK_IMPORTED_MODULE_5__.magicLink),\n/* harmony export */   multiSession: () => (/* reexport safe */ _chunk_6B3UWAJ3_js__WEBPACK_IMPORTED_MODULE_6__.multiSession),\n/* harmony export */   oAuthProxy: () => (/* binding */ oAuthProxy),\n/* harmony export */   oidcProvider: () => (/* reexport safe */ _chunk_KYDZ4BE2_js__WEBPACK_IMPORTED_MODULE_10__.oidcProvider),\n/* harmony export */   oneTap: () => (/* reexport safe */ _chunk_AVAADPGB_js__WEBPACK_IMPORTED_MODULE_7__.oneTap),\n/* harmony export */   openAPI: () => (/* reexport safe */ _chunk_PHHYUVFI_js__WEBPACK_IMPORTED_MODULE_8__.openAPI),\n/* harmony export */   optionsMiddleware: () => (/* reexport safe */ _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.optionsMiddleware),\n/* harmony export */   organization: () => (/* reexport safe */ _chunk_2RDAV2UB_js__WEBPACK_IMPORTED_MODULE_9__.organization),\n/* harmony export */   phoneNumber: () => (/* reexport safe */ _chunk_RBOAD55Y_js__WEBPACK_IMPORTED_MODULE_0__.phoneNumber),\n/* harmony export */   twoFactor: () => (/* reexport safe */ _chunk_VRVK7CFW_js__WEBPACK_IMPORTED_MODULE_1__.twoFactor),\n/* harmony export */   twoFactorClient: () => (/* reexport safe */ _chunk_GYDUPG7X_js__WEBPACK_IMPORTED_MODULE_17__.twoFactorClient),\n/* harmony export */   username: () => (/* reexport safe */ _chunk_M7C7TKIU_js__WEBPACK_IMPORTED_MODULE_2__.username)\n/* harmony export */ });\n/* harmony import */ var _chunk_RBOAD55Y_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-RBOAD55Y.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js\");\n/* harmony import */ var _chunk_VRVK7CFW_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-VRVK7CFW.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js\");\n/* harmony import */ var _chunk_M7C7TKIU_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-M7C7TKIU.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js\");\n/* harmony import */ var _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WMXBA6LX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\");\n/* harmony import */ var _chunk_7LU7PVPP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-7LU7PVPP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js\");\n/* harmony import */ var _chunk_2KOUY3SJ_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-2KOUY3SJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js\");\n/* harmony import */ var _chunk_6B3UWAJ3_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-6B3UWAJ3.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js\");\n/* harmony import */ var _chunk_AVAADPGB_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./chunk-AVAADPGB.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js\");\n/* harmony import */ var _chunk_PHHYUVFI_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./chunk-PHHYUVFI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js\");\n/* harmony import */ var _chunk_2RDAV2UB_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunk-2RDAV2UB.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js\");\n/* harmony import */ var _chunk_KYDZ4BE2_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./chunk-KYDZ4BE2.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js\");\n/* harmony import */ var _chunk_NP2H7VJV_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./chunk-NP2H7VJV.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js\");\n/* harmony import */ var _chunk_PZOB66AP_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./chunk-PZOB66AP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js\");\n/* harmony import */ var _chunk_KKKJI5Y7_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./chunk-KKKJI5Y7.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js\");\n/* harmony import */ var _chunk_FR3BYA47_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./chunk-FR3BYA47.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js\");\n/* harmony import */ var _chunk_LNAETVOO_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./chunk-LNAETVOO.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js\");\n/* harmony import */ var _chunk_NIUW4WF7_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./chunk-NIUW4WF7.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js\");\n/* harmony import */ var _chunk_GYDUPG7X_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./chunk-GYDUPG7X.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js\");\n/* harmony import */ var _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./chunk-GBLEGHZW.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\");\n/* harmony import */ var _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./chunk-TOKZL3ZI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./chunk-VXDYNCOX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\");\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./chunk-HVHN3Y2L.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./chunk-62MWLLEG.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_SK6Y2YH6_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./chunk-SK6Y2YH6.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./chunk-3XTQSPPA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getVenderBaseURL() {\n  const vercel = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.VERCEL_URL;\n  const netlify = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.NETLIFY_URL;\n  const render = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.RENDER_URL;\n  const aws = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.AWS_LAMBDA_FUNCTION_NAME;\n  const google = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.GOOGLE_CLOUD_FUNCTION_NAME;\n  const azure = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.AZURE_FUNCTION_NAME;\n  return vercel || netlify || render || aws || google || azure;\n}\nvar oAuthProxy = (opts) => {\n  return {\n    id: \"oauth-proxy\",\n    endpoints: {\n      oAuthProxy: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthEndpoint)(\n        \"/oauth-proxy-callback\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_37__.z.object({\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_37__.z.string({\n              description: \"The URL to redirect to after the proxy\"\n            }),\n            cookies: zod__WEBPACK_IMPORTED_MODULE_37__.z.string({\n              description: \"The cookies to set after the proxy\"\n            })\n          }),\n          use: [(0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.originCheck)((ctx) => ctx.query.callbackURL)],\n          metadata: {\n            openapi: {\n              description: \"OAuth Proxy Callback\",\n              parameters: [\n                {\n                  in: \"query\",\n                  name: \"callbackURL\",\n                  required: true,\n                  description: \"The URL to redirect to after the proxy\"\n                },\n                {\n                  in: \"query\",\n                  name: \"cookies\",\n                  required: true,\n                  description: \"The cookies to set after the proxy\"\n                }\n              ],\n              responses: {\n                302: {\n                  description: \"Redirect\",\n                  headers: {\n                    Location: {\n                      description: \"The URL to redirect to\",\n                      schema: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const cookies = ctx.query.cookies;\n          const decryptedCookies = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_32__.symmetricDecrypt)({\n            key: ctx.context.secret,\n            data: cookies\n          });\n          ctx.setHeader(\"set-cookie\", decryptedCookies);\n          throw ctx.redirect(ctx.query.callbackURL);\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return context.path?.startsWith(\"/callback\");\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthMiddleware)(async (ctx) => {\n            const response = ctx.context.returned;\n            const headers = response instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.APIError ? response.headers : null;\n            const location = headers?.get(\"location\");\n            if (location?.includes(\"/oauth-proxy-callback?callbackURL\")) {\n              if (!location.startsWith(\"http\")) {\n                return;\n              }\n              const locationURL = new URL(location);\n              const origin = locationURL.origin;\n              if (origin === (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_24__.getOrigin)(ctx.context.baseURL)) {\n                const newLocation = locationURL.searchParams.get(\"callbackURL\");\n                if (!newLocation) {\n                  return;\n                }\n                ctx.setHeader(\"location\", newLocation);\n                return;\n              }\n              const setCookies = headers?.get(\"set-cookie\");\n              if (!setCookies) {\n                return;\n              }\n              const encryptedCookies = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_32__.symmetricEncrypt)({\n                key: ctx.context.secret,\n                data: setCookies\n              });\n              const locationWithCookies = `${location}&cookies=${encodeURIComponent(\n                encryptedCookies\n              )}`;\n              ctx.setHeader(\"location\", locationWithCookies);\n            }\n          })\n        }\n      ],\n      before: [\n        {\n          matcher(context) {\n            return context.path?.startsWith(\"/sign-in/social\");\n          },\n          async handler(ctx) {\n            const url = new URL(\n              opts?.currentURL || ctx.request?.url || getVenderBaseURL() || ctx.context.baseURL\n            );\n            const productionURL = opts?.productionURL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.BETTER_AUTH_URL;\n            if (productionURL === ctx.context.options.baseURL) {\n              return;\n            }\n            ctx.body.callbackURL = `${url.origin}${ctx.context.options.basePath || \"/api/auth\"}/oauth-proxy-callback?callbackURL=${encodeURIComponent(\n              ctx.body.callbackURL || ctx.context.baseURL\n            )}`;\n            return {\n              context: ctx\n            };\n          }\n        }\n      ]\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvcGx1Z2lucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBa0Q7QUFDRjtBQUNEO0FBQ2xCO0FBQ2E7QUFDTTtBQUNHO0FBQ047QUFDQztBQUNLO0FBQ0E7QUFDUDtBQUNJO0FBQ0g7QUFDTztBQUNMO0FBQ0k7QUFDRztBQUN6QjtBQUNBO0FBQ3lFO0FBQ0o7QUFDckU7QUFDQTtBQUNBO0FBQ21CO0FBQ25CO0FBQ0E7QUFDQTtBQUN1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDNEM7QUFDNUM7QUFDQTtBQUNhO0FBQ2I7QUFDTDs7QUFFeEI7QUFDQSxpQkFBaUIsb0RBQUc7QUFDcEIsa0JBQWtCLG9EQUFHO0FBQ3JCLGlCQUFpQixvREFBRztBQUNwQixjQUFjLG9EQUFHO0FBQ2pCLGlCQUFpQixvREFBRztBQUNwQixnQkFBZ0Isb0RBQUc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHVFQUFrQjtBQUNwQztBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsMENBQVE7QUFDekIseUJBQXlCLDBDQUFRO0FBQ2pDO0FBQ0EsYUFBYTtBQUNiLHFCQUFxQiwwQ0FBUTtBQUM3QjtBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1gsZ0JBQWdCLGdFQUFXO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EseUNBQXlDLHFFQUFnQjtBQUN6RDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsbUJBQW1CLHlFQUFvQjtBQUN2QztBQUNBLGdEQUFnRCx5REFBUTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw4REFBUztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHFFQUFnQjtBQUM3RDtBQUNBO0FBQ0EsZUFBZTtBQUNmLDZDQUE2QyxTQUFTLFdBQVc7QUFDakU7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsb0RBQUc7QUFDNUQ7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLFdBQVcsRUFBRSw0Q0FBNEMsb0NBQW9DO0FBQ25JO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9wbHVnaW5zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IHBob25lTnVtYmVyIH0gZnJvbSAnLi9jaHVuay1SQk9BRDU1WS5qcyc7XG5leHBvcnQgeyB0d29GYWN0b3IgfSBmcm9tICcuL2NodW5rLVZSVks3Q0ZXLmpzJztcbmV4cG9ydCB7IHVzZXJuYW1lIH0gZnJvbSAnLi9jaHVuay1NN0M3VEtJVS5qcyc7XG5pbXBvcnQgJy4vY2h1bmstV01YQkE2TFguanMnO1xuZXhwb3J0IHsgand0IH0gZnJvbSAnLi9jaHVuay03TFU3UFZQUC5qcyc7XG5leHBvcnQgeyBtYWdpY0xpbmsgfSBmcm9tICcuL2NodW5rLTJLT1VZM1NKLmpzJztcbmV4cG9ydCB7IG11bHRpU2Vzc2lvbiB9IGZyb20gJy4vY2h1bmstNkIzVVdBSjMuanMnO1xuZXhwb3J0IHsgb25lVGFwIH0gZnJvbSAnLi9jaHVuay1BVkFBRFBHQi5qcyc7XG5leHBvcnQgeyBvcGVuQVBJIH0gZnJvbSAnLi9jaHVuay1QSEhZVVZGSS5qcyc7XG5leHBvcnQgeyBvcmdhbml6YXRpb24gfSBmcm9tICcuL2NodW5rLTJSREFWMlVCLmpzJztcbmV4cG9ydCB7IG9pZGNQcm92aWRlciB9IGZyb20gJy4vY2h1bmstS1lEWjRCRTIuanMnO1xuZXhwb3J0IHsgYWRtaW4gfSBmcm9tICcuL2NodW5rLU5QMkg3VkpWLmpzJztcbmV4cG9ydCB7IGFub255bW91cyB9IGZyb20gJy4vY2h1bmstUFpPQjY2QVAuanMnO1xuZXhwb3J0IHsgYmVhcmVyIH0gZnJvbSAnLi9jaHVuay1LS0tKSTVZNy5qcyc7XG5leHBvcnQgeyBjdXN0b21TZXNzaW9uIH0gZnJvbSAnLi9jaHVuay1GUjNCWUE0Ny5qcyc7XG5leHBvcnQgeyBlbWFpbE9UUCB9IGZyb20gJy4vY2h1bmstTE5BRVRWT08uanMnO1xuZXhwb3J0IHsgZ2VuZXJpY09BdXRoIH0gZnJvbSAnLi9jaHVuay1OSVVXNFdGNy5qcyc7XG5leHBvcnQgeyB0d29GYWN0b3JDbGllbnQgfSBmcm9tICcuL2NodW5rLUdZRFVQRzdYLmpzJztcbmltcG9ydCAnLi9jaHVuay1HQkxFR0haVy5qcyc7XG5pbXBvcnQgJy4vY2h1bmstVE9LWkwzWkkuanMnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBvcmlnaW5DaGVjaywgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIEFQSUVycm9yIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5leHBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBvcHRpb25zTWlkZGxld2FyZSB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0ICcuL2NodW5rLVZYRFlOQ09YLmpzJztcbmltcG9ydCAnLi9jaHVuay1HVFFNN0pVNy5qcyc7XG5pbXBvcnQgJy4vY2h1bmstSFZITjNZMkwuanMnO1xuaW1wb3J0IHsgZ2V0T3JpZ2luIH0gZnJvbSAnLi9jaHVuay1YRkNJQU5aWC5qcyc7XG5pbXBvcnQgJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0ICcuL2NodW5rLTYyTVdMTEVHLmpzJztcbmltcG9ydCAnLi9jaHVuay1XWjZPSVZKSy5qcyc7XG5leHBvcnQgeyBISURFX01FVEFEQVRBIH0gZnJvbSAnLi9jaHVuay1LTERGQkxZTC5qcyc7XG5pbXBvcnQgJy4vY2h1bmstTlBPNjRTVk4uanMnO1xuaW1wb3J0ICcuL2NodW5rLVNLNlkyWUg2LmpzJztcbmltcG9ydCAnLi9jaHVuay0zWFRRU1BQQS5qcyc7XG5pbXBvcnQgeyBzeW1tZXRyaWNEZWNyeXB0LCBzeW1tZXRyaWNFbmNyeXB0IH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgJy4vY2h1bmstNTNJUE8yUEouanMnO1xuaW1wb3J0ICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IGVudiB9IGZyb20gJy4vY2h1bmstVFFRU1BQTkEuanMnO1xuaW1wb3J0ICcuL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG5mdW5jdGlvbiBnZXRWZW5kZXJCYXNlVVJMKCkge1xuICBjb25zdCB2ZXJjZWwgPSBlbnYuVkVSQ0VMX1VSTDtcbiAgY29uc3QgbmV0bGlmeSA9IGVudi5ORVRMSUZZX1VSTDtcbiAgY29uc3QgcmVuZGVyID0gZW52LlJFTkRFUl9VUkw7XG4gIGNvbnN0IGF3cyA9IGVudi5BV1NfTEFNQkRBX0ZVTkNUSU9OX05BTUU7XG4gIGNvbnN0IGdvb2dsZSA9IGVudi5HT09HTEVfQ0xPVURfRlVOQ1RJT05fTkFNRTtcbiAgY29uc3QgYXp1cmUgPSBlbnYuQVpVUkVfRlVOQ1RJT05fTkFNRTtcbiAgcmV0dXJuIHZlcmNlbCB8fCBuZXRsaWZ5IHx8IHJlbmRlciB8fCBhd3MgfHwgZ29vZ2xlIHx8IGF6dXJlO1xufVxudmFyIG9BdXRoUHJveHkgPSAob3B0cykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm9hdXRoLXByb3h5XCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBvQXV0aFByb3h5OiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL29hdXRoLXByb3h5LWNhbGxiYWNrXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHByb3h5XCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY29va2llczogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgY29va2llcyB0byBzZXQgYWZ0ZXIgdGhlIHByb3h5XCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbb3JpZ2luQ2hlY2soKGN0eCkgPT4gY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiT0F1dGggUHJveHkgQ2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgcGFyYW1ldGVyczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGluOiBcInF1ZXJ5XCIsXG4gICAgICAgICAgICAgICAgICBuYW1lOiBcImNhbGxiYWNrVVJMXCIsXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgdGhlIHByb3h5XCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGluOiBcInF1ZXJ5XCIsXG4gICAgICAgICAgICAgICAgICBuYW1lOiBcImNvb2tpZXNcIixcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGNvb2tpZXMgdG8gc2V0IGFmdGVyIHRoZSBwcm94eVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAzMDI6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlZGlyZWN0XCIsXG4gICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0b1wiLFxuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNvb2tpZXMgPSBjdHgucXVlcnkuY29va2llcztcbiAgICAgICAgICBjb25zdCBkZWNyeXB0ZWRDb29raWVzID0gYXdhaXQgc3ltbWV0cmljRGVjcnlwdCh7XG4gICAgICAgICAgICBrZXk6IGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgIGRhdGE6IGNvb2tpZXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjdHguc2V0SGVhZGVyKFwic2V0LWNvb2tpZVwiLCBkZWNyeXB0ZWRDb29raWVzKTtcbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LnBhdGg/LnN0YXJ0c1dpdGgoXCIvY2FsbGJhY2tcIik7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGN0eC5jb250ZXh0LnJldHVybmVkO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHJlc3BvbnNlIGluc3RhbmNlb2YgQVBJRXJyb3IgPyByZXNwb25zZS5oZWFkZXJzIDogbnVsbDtcbiAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gaGVhZGVycz8uZ2V0KFwibG9jYXRpb25cIik7XG4gICAgICAgICAgICBpZiAobG9jYXRpb24/LmluY2x1ZGVzKFwiL29hdXRoLXByb3h5LWNhbGxiYWNrP2NhbGxiYWNrVVJMXCIpKSB7XG4gICAgICAgICAgICAgIGlmICghbG9jYXRpb24uc3RhcnRzV2l0aChcImh0dHBcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb25VUkwgPSBuZXcgVVJMKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luID0gbG9jYXRpb25VUkwub3JpZ2luO1xuICAgICAgICAgICAgICBpZiAob3JpZ2luID09PSBnZXRPcmlnaW4oY3R4LmNvbnRleHQuYmFzZVVSTCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMb2NhdGlvbiA9IGxvY2F0aW9uVVJMLnNlYXJjaFBhcmFtcy5nZXQoXCJjYWxsYmFja1VSTFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoIW5ld0xvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN0eC5zZXRIZWFkZXIoXCJsb2NhdGlvblwiLCBuZXdMb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnN0IHNldENvb2tpZXMgPSBoZWFkZXJzPy5nZXQoXCJzZXQtY29va2llXCIpO1xuICAgICAgICAgICAgICBpZiAoIXNldENvb2tpZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkQ29va2llcyA9IGF3YWl0IHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgICAgICAgICAgICAgIGtleTogY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgICAgIGRhdGE6IHNldENvb2tpZXNcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uV2l0aENvb2tpZXMgPSBgJHtsb2NhdGlvbn0mY29va2llcz0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb29raWVzXG4gICAgICAgICAgICAgICl9YDtcbiAgICAgICAgICAgICAgY3R4LnNldEhlYWRlcihcImxvY2F0aW9uXCIsIGxvY2F0aW9uV2l0aENvb2tpZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICBiZWZvcmU6IFtcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXIoY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQucGF0aD8uc3RhcnRzV2l0aChcIi9zaWduLWluL3NvY2lhbFwiKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFzeW5jIGhhbmRsZXIoY3R4KSB7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKFxuICAgICAgICAgICAgICBvcHRzPy5jdXJyZW50VVJMIHx8IGN0eC5yZXF1ZXN0Py51cmwgfHwgZ2V0VmVuZGVyQmFzZVVSTCgpIHx8IGN0eC5jb250ZXh0LmJhc2VVUkxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBwcm9kdWN0aW9uVVJMID0gb3B0cz8ucHJvZHVjdGlvblVSTCB8fCBlbnYuQkVUVEVSX0FVVEhfVVJMO1xuICAgICAgICAgICAgaWYgKHByb2R1Y3Rpb25VUkwgPT09IGN0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdHguYm9keS5jYWxsYmFja1VSTCA9IGAke3VybC5vcmlnaW59JHtjdHguY29udGV4dC5vcHRpb25zLmJhc2VQYXRoIHx8IFwiL2FwaS9hdXRoXCJ9L29hdXRoLXByb3h5LWNhbGxiYWNrP2NhbGxiYWNrVVJMPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgICAgICBjdHguYm9keS5jYWxsYmFja1VSTCB8fCBjdHguY29udGV4dC5iYXNlVVJMXG4gICAgICAgICAgICApfWA7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBjb250ZXh0OiBjdHhcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfVxuICB9O1xufTtcblxuZXhwb3J0IHsgb0F1dGhQcm94eSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/plugins.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/adapters/drizzle.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/adapters/drizzle.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   drizzleAdapter: () => (/* binding */ drizzleAdapter)\n/* harmony export */ });\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../chunk-62MWLLEG.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../chunk-NPO64SVN.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_SK6Y2YH6_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../chunk-SK6Y2YH6.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../chunk-3XTQSPPA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../chunk-53IPO2PJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3_@neondatabase+serverless@0.10.4_@opentelemetry+api@1.9.0_@types+pg@8_69ac2805d474d60a6d38622a789f6e04/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.39.3_@neondatabase+serverless@0.10.4_@opentelemetry+api@1.9.0_@types+pg@8_69ac2805d474d60a6d38622a789f6e04/node_modules/drizzle-orm/sql/expressions/select.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar createTransform = (db, config, options) => {\n  const schema = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_0__.getAuthTables)(options);\n  function getField(model, field) {\n    if (field === \"id\") {\n      return field;\n    }\n    const f = schema[model].fields[field];\n    return f.fieldName || field;\n  }\n  function getSchema(modelName) {\n    const schema2 = config.schema || db._.fullSchema;\n    if (!schema2) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n        \"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\"\n      );\n    }\n    const model = getModelName(modelName);\n    const schemaModel = schema2[model];\n    if (!schemaModel) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n        `[# Drizzle Adapter]: The model \"${model}\" was not found in the schema object. Please pass the schema directly to the adapter options.`\n      );\n    }\n    return schemaModel;\n  }\n  const getModelName = (model) => {\n    return schema[model].modelName !== model ? schema[model].modelName : config.usePlural ? `${model}s` : model;\n  };\n  function convertWhereClause(where, model) {\n    const schemaModel = getSchema(model);\n    if (!where) return [];\n    if (where.length === 1) {\n      const w = where[0];\n      if (!w) {\n        return [];\n      }\n      const field = getField(model, w.field);\n      if (!schemaModel[field]) {\n        throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n          `The field \"${w.field}\" does not exist in the schema for the model \"${model}\". Please update your schema.`\n        );\n      }\n      if (w.operator === \"in\") {\n        if (!Array.isArray(w.value)) {\n          throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n            `The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`\n          );\n        }\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.inArray)(schemaModel[field], w.value)];\n      }\n      if (w.operator === \"contains\") {\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.like)(schemaModel[field], `%${w.value}%`)];\n      }\n      if (w.operator === \"starts_with\") {\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.like)(schemaModel[field], `${w.value}%`)];\n      }\n      if (w.operator === \"ends_with\") {\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.like)(schemaModel[field], `%${w.value}`)];\n      }\n      return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel[field], w.value)];\n    }\n    const andGroup = where.filter((w) => w.connector === \"AND\" || !w.connector);\n    const orGroup = where.filter((w) => w.connector === \"OR\");\n    const andClause = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.and)(\n      ...andGroup.map((w) => {\n        const field = getField(model, w.field);\n        if (w.operator === \"in\") {\n          if (!Array.isArray(w.value)) {\n            throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n              `The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`\n            );\n          }\n          return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.inArray)(schemaModel[field], w.value);\n        }\n        return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel[field], w.value);\n      })\n    );\n    const orClause = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.or)(\n      ...orGroup.map((w) => {\n        const field = getField(model, w.field);\n        return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel[field], w.value);\n      })\n    );\n    const clause = [];\n    if (andGroup.length) clause.push(andClause);\n    if (orGroup.length) clause.push(orClause);\n    return clause;\n  }\n  const useDatabaseGeneratedId = options?.advanced?.generateId === false;\n  return {\n    getSchema,\n    transformInput(data, model, action) {\n      const transformedData = useDatabaseGeneratedId || action === \"update\" ? {} : {\n        id: options.advanced?.generateId ? options.advanced.generateId({\n          model\n        }) : data.id || (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_2__.generateId)()\n      };\n      const fields = schema[model].fields;\n      for (const field in fields) {\n        const value = data[field];\n        if (value === void 0 && !fields[field].defaultValue) {\n          continue;\n        }\n        transformedData[fields[field].fieldName || field] = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_0__.withApplyDefault)(\n          value,\n          fields[field],\n          action\n        );\n      }\n      return transformedData;\n    },\n    transformOutput(data, model, select = []) {\n      if (!data) return null;\n      const transformedData = data.id || data._id ? select.length === 0 || select.includes(\"id\") ? {\n        id: data.id\n      } : {} : {};\n      const tableSchema = schema[model].fields;\n      for (const key in tableSchema) {\n        if (select.length && !select.includes(key)) {\n          continue;\n        }\n        const field = tableSchema[key];\n        if (field) {\n          transformedData[key] = data[field.fieldName || key];\n        }\n      }\n      return transformedData;\n    },\n    convertWhereClause,\n    withReturning: async (model, builder, data, where) => {\n      if (config.provider !== \"mysql\") {\n        const c = await builder.returning();\n        return c[0];\n      }\n      await builder.execute();\n      const schemaModel = getSchema(model);\n      const builderVal = builder.config?.values;\n      if (where?.length) {\n        const clause = convertWhereClause(where, model);\n        const res = await db.select().from(schemaModel).where(...clause);\n        return res[0];\n      } else if (builderVal) {\n        const tId = builderVal[0]?.id.value;\n        const res = await db.select().from(schemaModel).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel.id, tId));\n        return res[0];\n      } else if (data.id) {\n        const res = await db.select().from(schemaModel).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_11__.eq)(schemaModel.id, data.id));\n        return res[0];\n      }\n    },\n    getField,\n    getModelName\n  };\n};\nfunction checkMissingFields(schema, model, values) {\n  if (!schema) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n      \"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\"\n    );\n  }\n  for (const key in values) {\n    if (!schema[key]) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_10__.BetterAuthError(\n        `The field \"${key}\" does not exist in the \"${model}\" schema. Please update your drizzle schema or re-generate using \"npx @better-auth/cli generate\".`\n      );\n    }\n  }\n}\nvar drizzleAdapter = (db, config) => (options) => {\n  const {\n    transformInput,\n    transformOutput,\n    convertWhereClause,\n    getSchema,\n    withReturning,\n    getField,\n    getModelName\n  } = createTransform(db, config, options);\n  return {\n    id: \"drizzle\",\n    async create(data) {\n      const { model, data: values } = data;\n      const transformed = transformInput(values, model, \"create\");\n      const schemaModel = getSchema(model);\n      checkMissingFields(schemaModel, getModelName(model), transformed);\n      const builder = db.insert(schemaModel).values(transformed);\n      const returned = await withReturning(model, builder, transformed);\n      return transformOutput(returned, model);\n    },\n    async findOne(data) {\n      const { model, where, select } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const res = await db.select().from(schemaModel).where(...clause);\n      if (!res.length) return null;\n      return transformOutput(res[0], model, select);\n    },\n    async findMany(data) {\n      const { model, where, sortBy, limit, offset } = data;\n      const schemaModel = getSchema(model);\n      const clause = where ? convertWhereClause(where, model) : [];\n      const sortFn = sortBy?.direction === \"desc\" ? drizzle_orm__WEBPACK_IMPORTED_MODULE_12__.desc : drizzle_orm__WEBPACK_IMPORTED_MODULE_12__.asc;\n      const builder = db.select().from(schemaModel).limit(limit || 100).offset(offset || 0);\n      if (sortBy?.field) {\n        builder.orderBy(sortFn(schemaModel[getField(model, sortBy?.field)]));\n      }\n      const res = await builder.where(...clause);\n      return res.map((r) => transformOutput(r, model));\n    },\n    async update(data) {\n      const { model, where, update: values } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const transformed = transformInput(values, model, \"update\");\n      const builder = db.update(schemaModel).set(transformed).where(...clause);\n      const returned = await withReturning(\n        model,\n        builder,\n        transformed,\n        where\n      );\n      return transformOutput(returned, model);\n    },\n    async updateMany(data) {\n      const { model, where, update: values } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const transformed = transformInput(values, model, \"update\");\n      const builder = db.update(schemaModel).set(transformed).where(...clause);\n      const res = await builder;\n      return res ? res.changes : 0;\n    },\n    async delete(data) {\n      const { model, where } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const builder = db.delete(schemaModel).where(...clause);\n      await builder;\n    },\n    async deleteMany(data) {\n      const { model, where } = data;\n      const schemaModel = getSchema(model);\n      const clause = convertWhereClause(where, model);\n      const builder = db.delete(schemaModel).where(...clause);\n      const res = await builder;\n      return res ? res.length : 0;\n    },\n    options: config\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2FkYXB0ZXJzL2RyaXp6bGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBdUU7QUFDekM7QUFDb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDeUI7QUFDYTs7QUFFcEU7QUFDQSxpQkFBaUIsaUVBQWE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0VBQWU7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGdFQUFlO0FBQy9CLDJDQUEyQyxNQUFNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRkFBK0YsTUFBTTtBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGdFQUFlO0FBQ2pDLHdCQUF3QixRQUFRLGdEQUFnRCxNQUFNO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGdFQUFlO0FBQ25DLHdDQUF3QyxRQUFRO0FBQ2hEO0FBQ0E7QUFDQSxnQkFBZ0IscURBQU87QUFDdkI7QUFDQTtBQUNBLGdCQUFnQixrREFBSSx5QkFBeUIsUUFBUTtBQUNyRDtBQUNBO0FBQ0EsZ0JBQWdCLGtEQUFJLHdCQUF3QixRQUFRO0FBQ3BEO0FBQ0E7QUFDQSxnQkFBZ0Isa0RBQUkseUJBQXlCLFFBQVE7QUFDckQ7QUFDQSxjQUFjLGdEQUFFO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpREFBRztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixnRUFBZTtBQUNyQywwQ0FBMEMsUUFBUTtBQUNsRDtBQUNBO0FBQ0EsaUJBQWlCLHFEQUFPO0FBQ3hCO0FBQ0EsZUFBZSxnREFBRTtBQUNqQixPQUFPO0FBQ1A7QUFDQSxxQkFBcUIsZ0RBQUU7QUFDdkI7QUFDQTtBQUNBLGVBQWUsZ0RBQUU7QUFDakIsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUZBQWlGO0FBQ2pGO0FBQ0E7QUFDQSxTQUFTLGVBQWUsOERBQVU7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsb0VBQWdCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsS0FBSztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSw4REFBOEQsZ0RBQUU7QUFDaEU7QUFDQSxRQUFRO0FBQ1IsOERBQThELGdEQUFFO0FBQ2hFO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxnRUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGdFQUFlO0FBQy9CLHNCQUFzQixJQUFJLDJCQUEyQixNQUFNO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLGNBQWMsc0JBQXNCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsdUJBQXVCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxjQUFjLHNDQUFzQztBQUNwRDtBQUNBO0FBQ0Esb0RBQW9ELDhDQUFJLEdBQUcsNkNBQUc7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYywrQkFBK0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsK0JBQStCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsZUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsZUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFMEIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hZGFwdGVycy9kcml6emxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEF1dGhUYWJsZXMsIHdpdGhBcHBseURlZmF1bHQgfSBmcm9tICcuLi9jaHVuay02Mk1XTExFRy5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLVdaNk9JVkpLLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlSWQgfSBmcm9tICcuLi9jaHVuay1LTERGQkxZTC5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLU5QTzY0U1ZOLmpzJztcbmltcG9ydCAnLi4vY2h1bmstU0s2WTJZSDYuanMnO1xuaW1wb3J0ICcuLi9jaHVuay0zWFRRU1BQQS5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCAnLi4vY2h1bmstNTNJUE8yUEouanMnO1xuaW1wb3J0ICcuLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4uL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IGRlc2MsIGFzYywgZXEsIGluQXJyYXksIGxpa2UsIGFuZCwgb3IgfSBmcm9tICdkcml6emxlLW9ybSc7XG5cbnZhciBjcmVhdGVUcmFuc2Zvcm0gPSAoZGIsIGNvbmZpZywgb3B0aW9ucykgPT4ge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICBmdW5jdGlvbiBnZXRGaWVsZChtb2RlbCwgZmllbGQpIHtcbiAgICBpZiAoZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbiAgICBjb25zdCBmID0gc2NoZW1hW21vZGVsXS5maWVsZHNbZmllbGRdO1xuICAgIHJldHVybiBmLmZpZWxkTmFtZSB8fCBmaWVsZDtcbiAgfVxuICBmdW5jdGlvbiBnZXRTY2hlbWEobW9kZWxOYW1lKSB7XG4gICAgY29uc3Qgc2NoZW1hMiA9IGNvbmZpZy5zY2hlbWEgfHwgZGIuXy5mdWxsU2NoZW1hO1xuICAgIGlmICghc2NoZW1hMikge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJEcml6emxlIGFkYXB0ZXIgZmFpbGVkIHRvIGluaXRpYWxpemUuIFNjaGVtYSBub3QgZm91bmQuIFBsZWFzZSBwcm92aWRlIGEgc2NoZW1hIG9iamVjdCBpbiB0aGUgYWRhcHRlciBvcHRpb25zIG9iamVjdC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUobW9kZWxOYW1lKTtcbiAgICBjb25zdCBzY2hlbWFNb2RlbCA9IHNjaGVtYTJbbW9kZWxdO1xuICAgIGlmICghc2NoZW1hTW9kZWwpIHtcbiAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgIGBbIyBEcml6emxlIEFkYXB0ZXJdOiBUaGUgbW9kZWwgXCIke21vZGVsfVwiIHdhcyBub3QgZm91bmQgaW4gdGhlIHNjaGVtYSBvYmplY3QuIFBsZWFzZSBwYXNzIHRoZSBzY2hlbWEgZGlyZWN0bHkgdG8gdGhlIGFkYXB0ZXIgb3B0aW9ucy5gXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gc2NoZW1hTW9kZWw7XG4gIH1cbiAgY29uc3QgZ2V0TW9kZWxOYW1lID0gKG1vZGVsKSA9PiB7XG4gICAgcmV0dXJuIHNjaGVtYVttb2RlbF0ubW9kZWxOYW1lICE9PSBtb2RlbCA/IHNjaGVtYVttb2RlbF0ubW9kZWxOYW1lIDogY29uZmlnLnVzZVBsdXJhbCA/IGAke21vZGVsfXNgIDogbW9kZWw7XG4gIH07XG4gIGZ1bmN0aW9uIGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpIHtcbiAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgaWYgKCF3aGVyZSkgcmV0dXJuIFtdO1xuICAgIGlmICh3aGVyZS5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnN0IHcgPSB3aGVyZVswXTtcbiAgICAgIGlmICghdykge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICBjb25zdCBmaWVsZCA9IGdldEZpZWxkKG1vZGVsLCB3LmZpZWxkKTtcbiAgICAgIGlmICghc2NoZW1hTW9kZWxbZmllbGRdKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgYFRoZSBmaWVsZCBcIiR7dy5maWVsZH1cIiBkb2VzIG5vdCBleGlzdCBpbiB0aGUgc2NoZW1hIGZvciB0aGUgbW9kZWwgXCIke21vZGVsfVwiLiBQbGVhc2UgdXBkYXRlIHlvdXIgc2NoZW1hLmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcImluXCIpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHcudmFsdWUpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIGBUaGUgdmFsdWUgZm9yIHRoZSBmaWVsZCBcIiR7dy5maWVsZH1cIiBtdXN0IGJlIGFuIGFycmF5IHdoZW4gdXNpbmcgdGhlIFwiaW5cIiBvcGVyYXRvci5gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2luQXJyYXkoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKV07XG4gICAgICB9XG4gICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJjb250YWluc1wiKSB7XG4gICAgICAgIHJldHVybiBbbGlrZShzY2hlbWFNb2RlbFtmaWVsZF0sIGAlJHt3LnZhbHVlfSVgKV07XG4gICAgICB9XG4gICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJzdGFydHNfd2l0aFwiKSB7XG4gICAgICAgIHJldHVybiBbbGlrZShzY2hlbWFNb2RlbFtmaWVsZF0sIGAke3cudmFsdWV9JWApXTtcbiAgICAgIH1cbiAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcImVuZHNfd2l0aFwiKSB7XG4gICAgICAgIHJldHVybiBbbGlrZShzY2hlbWFNb2RlbFtmaWVsZF0sIGAlJHt3LnZhbHVlfWApXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBbZXEoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKV07XG4gICAgfVxuICAgIGNvbnN0IGFuZEdyb3VwID0gd2hlcmUuZmlsdGVyKCh3KSA9PiB3LmNvbm5lY3RvciA9PT0gXCJBTkRcIiB8fCAhdy5jb25uZWN0b3IpO1xuICAgIGNvbnN0IG9yR3JvdXAgPSB3aGVyZS5maWx0ZXIoKHcpID0+IHcuY29ubmVjdG9yID09PSBcIk9SXCIpO1xuICAgIGNvbnN0IGFuZENsYXVzZSA9IGFuZChcbiAgICAgIC4uLmFuZEdyb3VwLm1hcCgodykgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZCA9IGdldEZpZWxkKG1vZGVsLCB3LmZpZWxkKTtcbiAgICAgICAgaWYgKHcub3BlcmF0b3IgPT09IFwiaW5cIikge1xuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh3LnZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgICAgYFRoZSB2YWx1ZSBmb3IgdGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIG11c3QgYmUgYW4gYXJyYXkgd2hlbiB1c2luZyB0aGUgXCJpblwiIG9wZXJhdG9yLmBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBpbkFycmF5KHNjaGVtYU1vZGVsW2ZpZWxkXSwgdy52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVxKHNjaGVtYU1vZGVsW2ZpZWxkXSwgdy52YWx1ZSk7XG4gICAgICB9KVxuICAgICk7XG4gICAgY29uc3Qgb3JDbGF1c2UgPSBvcihcbiAgICAgIC4uLm9yR3JvdXAubWFwKCh3KSA9PiB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQobW9kZWwsIHcuZmllbGQpO1xuICAgICAgICByZXR1cm4gZXEoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgICBjb25zdCBjbGF1c2UgPSBbXTtcbiAgICBpZiAoYW5kR3JvdXAubGVuZ3RoKSBjbGF1c2UucHVzaChhbmRDbGF1c2UpO1xuICAgIGlmIChvckdyb3VwLmxlbmd0aCkgY2xhdXNlLnB1c2gob3JDbGF1c2UpO1xuICAgIHJldHVybiBjbGF1c2U7XG4gIH1cbiAgY29uc3QgdXNlRGF0YWJhc2VHZW5lcmF0ZWRJZCA9IG9wdGlvbnM/LmFkdmFuY2VkPy5nZW5lcmF0ZUlkID09PSBmYWxzZTtcbiAgcmV0dXJuIHtcbiAgICBnZXRTY2hlbWEsXG4gICAgdHJhbnNmb3JtSW5wdXQoZGF0YSwgbW9kZWwsIGFjdGlvbikge1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gdXNlRGF0YWJhc2VHZW5lcmF0ZWRJZCB8fCBhY3Rpb24gPT09IFwidXBkYXRlXCIgPyB7fSA6IHtcbiAgICAgICAgaWQ6IG9wdGlvbnMuYWR2YW5jZWQ/LmdlbmVyYXRlSWQgPyBvcHRpb25zLmFkdmFuY2VkLmdlbmVyYXRlSWQoe1xuICAgICAgICAgIG1vZGVsXG4gICAgICAgIH0pIDogZGF0YS5pZCB8fCBnZW5lcmF0ZUlkKClcbiAgICAgIH07XG4gICAgICBjb25zdCBmaWVsZHMgPSBzY2hlbWFbbW9kZWxdLmZpZWxkcztcbiAgICAgIGZvciAoY29uc3QgZmllbGQgaW4gZmllbGRzKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtmaWVsZF07XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwICYmICFmaWVsZHNbZmllbGRdLmRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zZm9ybWVkRGF0YVtmaWVsZHNbZmllbGRdLmZpZWxkTmFtZSB8fCBmaWVsZF0gPSB3aXRoQXBwbHlEZWZhdWx0KFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgIGZpZWxkc1tmaWVsZF0sXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWREYXRhO1xuICAgIH0sXG4gICAgdHJhbnNmb3JtT3V0cHV0KGRhdGEsIG1vZGVsLCBzZWxlY3QgPSBbXSkge1xuICAgICAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IGRhdGEuaWQgfHwgZGF0YS5faWQgPyBzZWxlY3QubGVuZ3RoID09PSAwIHx8IHNlbGVjdC5pbmNsdWRlcyhcImlkXCIpID8ge1xuICAgICAgICBpZDogZGF0YS5pZFxuICAgICAgfSA6IHt9IDoge307XG4gICAgICBjb25zdCB0YWJsZVNjaGVtYSA9IHNjaGVtYVttb2RlbF0uZmllbGRzO1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGFibGVTY2hlbWEpIHtcbiAgICAgICAgaWYgKHNlbGVjdC5sZW5ndGggJiYgIXNlbGVjdC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmllbGQgPSB0YWJsZVNjaGVtYVtrZXldO1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICB0cmFuc2Zvcm1lZERhdGFba2V5XSA9IGRhdGFbZmllbGQuZmllbGROYW1lIHx8IGtleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gICAgfSxcbiAgICBjb252ZXJ0V2hlcmVDbGF1c2UsXG4gICAgd2l0aFJldHVybmluZzogYXN5bmMgKG1vZGVsLCBidWlsZGVyLCBkYXRhLCB3aGVyZSkgPT4ge1xuICAgICAgaWYgKGNvbmZpZy5wcm92aWRlciAhPT0gXCJteXNxbFwiKSB7XG4gICAgICAgIGNvbnN0IGMgPSBhd2FpdCBidWlsZGVyLnJldHVybmluZygpO1xuICAgICAgICByZXR1cm4gY1swXTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IGJ1aWxkZXIuZXhlY3V0ZSgpO1xuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgY29uc3QgYnVpbGRlclZhbCA9IGJ1aWxkZXIuY29uZmlnPy52YWx1ZXM7XG4gICAgICBpZiAod2hlcmU/Lmxlbmd0aCkge1xuICAgICAgICBjb25zdCBjbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzY2hlbWFNb2RlbCkud2hlcmUoLi4uY2xhdXNlKTtcbiAgICAgICAgcmV0dXJuIHJlc1swXTtcbiAgICAgIH0gZWxzZSBpZiAoYnVpbGRlclZhbCkge1xuICAgICAgICBjb25zdCB0SWQgPSBidWlsZGVyVmFsWzBdPy5pZC52YWx1ZTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzY2hlbWFNb2RlbCkud2hlcmUoZXEoc2NoZW1hTW9kZWwuaWQsIHRJZCkpO1xuICAgICAgICByZXR1cm4gcmVzWzBdO1xuICAgICAgfSBlbHNlIGlmIChkYXRhLmlkKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20oc2NoZW1hTW9kZWwpLndoZXJlKGVxKHNjaGVtYU1vZGVsLmlkLCBkYXRhLmlkKSk7XG4gICAgICAgIHJldHVybiByZXNbMF07XG4gICAgICB9XG4gICAgfSxcbiAgICBnZXRGaWVsZCxcbiAgICBnZXRNb2RlbE5hbWVcbiAgfTtcbn07XG5mdW5jdGlvbiBjaGVja01pc3NpbmdGaWVsZHMoc2NoZW1hLCBtb2RlbCwgdmFsdWVzKSB7XG4gIGlmICghc2NoZW1hKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIFwiRHJpenpsZSBhZGFwdGVyIGZhaWxlZCB0byBpbml0aWFsaXplLiBTY2hlbWEgbm90IGZvdW5kLiBQbGVhc2UgcHJvdmlkZSBhIHNjaGVtYSBvYmplY3QgaW4gdGhlIGFkYXB0ZXIgb3B0aW9ucyBvYmplY3QuXCJcbiAgICApO1xuICB9XG4gIGZvciAoY29uc3Qga2V5IGluIHZhbHVlcykge1xuICAgIGlmICghc2NoZW1hW2tleV0pIHtcbiAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgIGBUaGUgZmllbGQgXCIke2tleX1cIiBkb2VzIG5vdCBleGlzdCBpbiB0aGUgXCIke21vZGVsfVwiIHNjaGVtYS4gUGxlYXNlIHVwZGF0ZSB5b3VyIGRyaXp6bGUgc2NoZW1hIG9yIHJlLWdlbmVyYXRlIHVzaW5nIFwibnB4IEBiZXR0ZXItYXV0aC9jbGkgZ2VuZXJhdGVcIi5gXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxudmFyIGRyaXp6bGVBZGFwdGVyID0gKGRiLCBjb25maWcpID0+IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHtcbiAgICB0cmFuc2Zvcm1JbnB1dCxcbiAgICB0cmFuc2Zvcm1PdXRwdXQsXG4gICAgY29udmVydFdoZXJlQ2xhdXNlLFxuICAgIGdldFNjaGVtYSxcbiAgICB3aXRoUmV0dXJuaW5nLFxuICAgIGdldEZpZWxkLFxuICAgIGdldE1vZGVsTmFtZVxuICB9ID0gY3JlYXRlVHJhbnNmb3JtKGRiLCBjb25maWcsIG9wdGlvbnMpO1xuICByZXR1cm4ge1xuICAgIGlkOiBcImRyaXp6bGVcIixcbiAgICBhc3luYyBjcmVhdGUoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgZGF0YTogdmFsdWVzIH0gPSBkYXRhO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFuc2Zvcm1JbnB1dCh2YWx1ZXMsIG1vZGVsLCBcImNyZWF0ZVwiKTtcbiAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgIGNoZWNrTWlzc2luZ0ZpZWxkcyhzY2hlbWFNb2RlbCwgZ2V0TW9kZWxOYW1lKG1vZGVsKSwgdHJhbnNmb3JtZWQpO1xuICAgICAgY29uc3QgYnVpbGRlciA9IGRiLmluc2VydChzY2hlbWFNb2RlbCkudmFsdWVzKHRyYW5zZm9ybWVkKTtcbiAgICAgIGNvbnN0IHJldHVybmVkID0gYXdhaXQgd2l0aFJldHVybmluZyhtb2RlbCwgYnVpbGRlciwgdHJhbnNmb3JtZWQpO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybU91dHB1dChyZXR1cm5lZCwgbW9kZWwpO1xuICAgIH0sXG4gICAgYXN5bmMgZmluZE9uZShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSwgc2VsZWN0IH0gPSBkYXRhO1xuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHNjaGVtYU1vZGVsKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgaWYgKCFyZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1PdXRwdXQocmVzWzBdLCBtb2RlbCwgc2VsZWN0KTtcbiAgICB9LFxuICAgIGFzeW5jIGZpbmRNYW55KGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlLCBzb3J0QnksIGxpbWl0LCBvZmZzZXQgfSA9IGRhdGE7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBjb25zdCBjbGF1c2UgPSB3aGVyZSA/IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpIDogW107XG4gICAgICBjb25zdCBzb3J0Rm4gPSBzb3J0Qnk/LmRpcmVjdGlvbiA9PT0gXCJkZXNjXCIgPyBkZXNjIDogYXNjO1xuICAgICAgY29uc3QgYnVpbGRlciA9IGRiLnNlbGVjdCgpLmZyb20oc2NoZW1hTW9kZWwpLmxpbWl0KGxpbWl0IHx8IDEwMCkub2Zmc2V0KG9mZnNldCB8fCAwKTtcbiAgICAgIGlmIChzb3J0Qnk/LmZpZWxkKSB7XG4gICAgICAgIGJ1aWxkZXIub3JkZXJCeShzb3J0Rm4oc2NoZW1hTW9kZWxbZ2V0RmllbGQobW9kZWwsIHNvcnRCeT8uZmllbGQpXSkpO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYnVpbGRlci53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgcmV0dXJuIHJlcy5tYXAoKHIpID0+IHRyYW5zZm9ybU91dHB1dChyLCBtb2RlbCkpO1xuICAgIH0sXG4gICAgYXN5bmMgdXBkYXRlKGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlLCB1cGRhdGU6IHZhbHVlcyB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgIGNvbnN0IGNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFuc2Zvcm1JbnB1dCh2YWx1ZXMsIG1vZGVsLCBcInVwZGF0ZVwiKTtcbiAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi51cGRhdGUoc2NoZW1hTW9kZWwpLnNldCh0cmFuc2Zvcm1lZCkud2hlcmUoLi4uY2xhdXNlKTtcbiAgICAgIGNvbnN0IHJldHVybmVkID0gYXdhaXQgd2l0aFJldHVybmluZyhcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIGJ1aWxkZXIsXG4gICAgICAgIHRyYW5zZm9ybWVkLFxuICAgICAgICB3aGVyZVxuICAgICAgKTtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1PdXRwdXQocmV0dXJuZWQsIG1vZGVsKTtcbiAgICB9LFxuICAgIGFzeW5jIHVwZGF0ZU1hbnkoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZTogdmFsdWVzIH0gPSBkYXRhO1xuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHRyYW5zZm9ybUlucHV0KHZhbHVlcywgbW9kZWwsIFwidXBkYXRlXCIpO1xuICAgICAgY29uc3QgYnVpbGRlciA9IGRiLnVwZGF0ZShzY2hlbWFNb2RlbCkuc2V0KHRyYW5zZm9ybWVkKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYnVpbGRlcjtcbiAgICAgIHJldHVybiByZXMgPyByZXMuY2hhbmdlcyA6IDA7XG4gICAgfSxcbiAgICBhc3luYyBkZWxldGUoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUgfSA9IGRhdGE7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBjb25zdCBjbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi5kZWxldGUoc2NoZW1hTW9kZWwpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICBhd2FpdCBidWlsZGVyO1xuICAgIH0sXG4gICAgYXN5bmMgZGVsZXRlTWFueShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgIGNvbnN0IGNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgY29uc3QgYnVpbGRlciA9IGRiLmRlbGV0ZShzY2hlbWFNb2RlbCkud2hlcmUoLi4uY2xhdXNlKTtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGJ1aWxkZXI7XG4gICAgICByZXR1cm4gcmVzID8gcmVzLmxlbmd0aCA6IDA7XG4gICAgfSxcbiAgICBvcHRpb25zOiBjb25maWdcbiAgfTtcbn07XG5cbmV4cG9ydCB7IGRyaXp6bGVBZGFwdGVyIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/adapters/drizzle.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   magicLink: () => (/* binding */ magicLink)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\nvar magicLink = (options) => {\n  return {\n    id: \"magic-link\",\n    endpoints: {\n      signInMagicLink: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/magic-link\",\n        {\n          method: \"POST\",\n          requireHeaders: true,\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"Email address to send the magic link\"\n            }).email(),\n            name: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"User display name. Only used if the user is registering for the first time.\"\n            }).optional(),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"URL to redirect after magic link verification\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              description: \"Sign in with magic link\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          status: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { email } = ctx.body;\n          if (options.disableSignUp) {\n            const user = await ctx.context.internalAdapter.findUserByEmail(email);\n            if (!user) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_4__.APIError(\"BAD_REQUEST\", {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.USER_NOT_FOUND\n              });\n            }\n          }\n          const verificationToken = options?.generateToken ? await options.generateToken(email) : (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            identifier: verificationToken,\n            value: JSON.stringify({ email, name: ctx.body.name }),\n            expiresAt: new Date(\n              Date.now() + (options.expiresIn || 60 * 5) * 1e3\n            )\n          });\n          const url = `${ctx.context.baseURL}/magic-link/verify?token=${verificationToken}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n          await options.sendMagicLink(\n            {\n              email,\n              url,\n              token: verificationToken\n            },\n            ctx.request\n          );\n          return ctx.json({\n            status: true\n          });\n        }\n      ),\n      magicLinkVerify: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/magic-link/verify\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            token: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"Verification token\"\n            }),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_3__.z.string({\n              description: \"URL to redirect after magic link verification, if not provided will return session\"\n            }).optional()\n          }),\n          use: [(0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.originCheck)((ctx) => ctx.query.callbackURL)],\n          requireHeaders: true,\n          metadata: {\n            openapi: {\n              description: \"Verify magic link\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          },\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { token, callbackURL } = ctx.query;\n          const toRedirectTo = callbackURL?.startsWith(\"http\") ? callbackURL : callbackURL ? `${ctx.context.options.baseURL}${callbackURL}` : ctx.context.options.baseURL;\n          const tokenValue = await ctx.context.internalAdapter.findVerificationValue(token);\n          if (!tokenValue) {\n            throw ctx.redirect(`${toRedirectTo}?error=INVALID_TOKEN`);\n          }\n          if (tokenValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              tokenValue.id\n            );\n            throw ctx.redirect(`${toRedirectTo}?error=EXPIRED_TOKEN`);\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            tokenValue.id\n          );\n          const { email, name } = JSON.parse(tokenValue.value);\n          let user = await ctx.context.internalAdapter.findUserByEmail(email).then((res) => res?.user);\n          if (!user) {\n            if (!options.disableSignUp) {\n              const newUser = await ctx.context.internalAdapter.createUser({\n                email,\n                emailVerified: true,\n                name: name || email\n              });\n              user = newUser;\n              if (!user) {\n                throw ctx.redirect(\n                  `${toRedirectTo}?error=failed_to_create_user`\n                );\n              }\n            } else {\n              throw ctx.redirect(`${toRedirectTo}?error=failed_to_create_user`);\n            }\n          }\n          if (!user.emailVerified) {\n            await ctx.context.internalAdapter.updateUser(user.id, {\n              emailVerified: true\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.headers\n          );\n          if (!session) {\n            throw ctx.redirect(\n              `${toRedirectTo}?error=failed_to_create_session`\n            );\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n            session,\n            user\n          });\n          if (!callbackURL) {\n            return ctx.json({\n              token: session.token,\n              user: {\n                id: user.id,\n                email: user.email,\n                emailVerified: user.emailVerified,\n                name: user.name,\n                image: user.image,\n                createdAt: user.createdAt,\n                updatedAt: user.updatedAt\n              }\n            });\n          }\n          throw ctx.redirect(callbackURL);\n        }\n      )\n    },\n    rateLimit: [\n      {\n        pathMatcher(path) {\n          return path.startsWith(\"/sign-in/magic-link\") || path.startsWith(\"/magic-link/verify\");\n        },\n        window: options.rateLimit?.window || 60,\n        max: options.rateLimit?.max || 5\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTJLT1VZM1NKLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF3RjtBQUNqQztBQUNJO0FBQ25DO0FBQ2U7O0FBRXZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QixtQkFBbUIseUNBQVE7QUFDM0I7QUFDQSxhQUFhO0FBQ2Isa0JBQWtCLHlDQUFRO0FBQzFCO0FBQ0EsYUFBYTtBQUNiLHlCQUF5Qix5Q0FBUTtBQUNqQztBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxrQkFBa0IsUUFBUTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaURBQVE7QUFDaEMseUJBQXlCLGdFQUFnQjtBQUN6QyxlQUFlO0FBQ2Y7QUFDQTtBQUNBLGtHQUFrRyx3RUFBb0I7QUFDdEg7QUFDQTtBQUNBLG9DQUFvQyw0QkFBNEI7QUFDaEU7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLHlCQUF5QixvQkFBb0IsMkJBQTJCLGtCQUFrQixlQUFlLDRCQUE0QjtBQUNySTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSx1QkFBdUIsc0VBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix5Q0FBUTtBQUN6QixtQkFBbUIseUNBQVE7QUFDM0I7QUFDQSxhQUFhO0FBQ2IseUJBQXlCLHlDQUFRO0FBQ2pDO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWCxnQkFBZ0IsK0RBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0Esa0JBQWtCLHFCQUFxQjtBQUN2QyxnR0FBZ0csNEJBQTRCLEVBQUUsWUFBWTtBQUMxSTtBQUNBO0FBQ0Esa0NBQWtDLGFBQWE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxhQUFhO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGNBQWM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLGFBQWE7QUFDbEM7QUFDQTtBQUNBLGNBQWM7QUFDZCxvQ0FBb0MsYUFBYTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGFBQWE7QUFDOUI7QUFDQTtBQUNBLGdCQUFnQixvRUFBZ0I7QUFDaEM7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVxQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTJLT1VZM1NKLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgQkFTRV9FUlJPUl9DT0RFUywgb3JpZ2luQ2hlY2sgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlUmFuZG9tU3RyaW5nIH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG52YXIgbWFnaWNMaW5rID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJtYWdpYy1saW5rXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzaWduSW5NYWdpY0xpbms6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvc2lnbi1pbi9tYWdpYy1saW5rXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gc2VuZCB0aGUgbWFnaWMgbGlua1wiXG4gICAgICAgICAgICB9KS5lbWFpbCgpLFxuICAgICAgICAgICAgbmFtZTogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIGRpc3BsYXkgbmFtZS4gT25seSB1c2VkIGlmIHRoZSB1c2VyIGlzIHJlZ2lzdGVyaW5nIGZvciB0aGUgZmlyc3QgdGltZS5cIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVSTCB0byByZWRpcmVjdCBhZnRlciBtYWdpYyBsaW5rIHZlcmlmaWNhdGlvblwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIG1hZ2ljIGxpbmtcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgeyBlbWFpbCB9ID0gY3R4LmJvZHk7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZVNpZ25VcCkge1xuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfTk9UX0ZPVU5EXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25Ub2tlbiA9IG9wdGlvbnM/LmdlbmVyYXRlVG9rZW4gPyBhd2FpdCBvcHRpb25zLmdlbmVyYXRlVG9rZW4oZW1haWwpIDogZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIsIFwiYS16XCIsIFwiQS1aXCIpO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiB2ZXJpZmljYXRpb25Ub2tlbixcbiAgICAgICAgICAgIHZhbHVlOiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsLCBuYW1lOiBjdHguYm9keS5uYW1lIH0pLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShcbiAgICAgICAgICAgICAgRGF0ZS5ub3coKSArIChvcHRpb25zLmV4cGlyZXNJbiB8fCA2MCAqIDUpICogMWUzXG4gICAgICAgICAgICApXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vbWFnaWMtbGluay92ZXJpZnk/dG9rZW49JHt2ZXJpZmljYXRpb25Ub2tlbn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgICAgIGF3YWl0IG9wdGlvbnMuc2VuZE1hZ2ljTGluayhcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgdG9rZW46IHZlcmlmaWNhdGlvblRva2VuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIG1hZ2ljTGlua1ZlcmlmeTogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9tYWdpYy1saW5rL3ZlcmlmeVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB0b2tlbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJWZXJpZmljYXRpb24gdG9rZW5cIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVUkwgdG8gcmVkaXJlY3QgYWZ0ZXIgbWFnaWMgbGluayB2ZXJpZmljYXRpb24sIGlmIG5vdCBwcm92aWRlZCB3aWxsIHJldHVybiBzZXNzaW9uXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFtvcmlnaW5DaGVjaygoY3R4KSA9PiBjdHgucXVlcnkuY2FsbGJhY2tVUkwpXSxcbiAgICAgICAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJWZXJpZnkgbWFnaWMgbGlua1wiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1Nlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgdG9rZW4sIGNhbGxiYWNrVVJMIH0gPSBjdHgucXVlcnk7XG4gICAgICAgICAgY29uc3QgdG9SZWRpcmVjdFRvID0gY2FsbGJhY2tVUkw/LnN0YXJ0c1dpdGgoXCJodHRwXCIpID8gY2FsbGJhY2tVUkwgOiBjYWxsYmFja1VSTCA/IGAke2N0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTH0ke2NhbGxiYWNrVVJMfWAgOiBjdHguY29udGV4dC5vcHRpb25zLmJhc2VVUkw7XG4gICAgICAgICAgY29uc3QgdG9rZW5WYWx1ZSA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUodG9rZW4pO1xuICAgICAgICAgIGlmICghdG9rZW5WYWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke3RvUmVkaXJlY3RUb30/ZXJyb3I9SU5WQUxJRF9UT0tFTmApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodG9rZW5WYWx1ZS5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgICB0b2tlblZhbHVlLmlkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke3RvUmVkaXJlY3RUb30/ZXJyb3I9RVhQSVJFRF9UT0tFTmApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICB0b2tlblZhbHVlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCB7IGVtYWlsLCBuYW1lIH0gPSBKU09OLnBhcnNlKHRva2VuVmFsdWUudmFsdWUpO1xuICAgICAgICAgIGxldCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCkudGhlbigocmVzKSA9PiByZXM/LnVzZXIpO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zLmRpc2FibGVTaWduVXApIHtcbiAgICAgICAgICAgICAgY29uc3QgbmV3VXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVVc2VyKHtcbiAgICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUgfHwgZW1haWxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHVzZXIgPSBuZXdVc2VyO1xuICAgICAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgICAgICAgICAgICBgJHt0b1JlZGlyZWN0VG99P2Vycm9yPWZhaWxlZF90b19jcmVhdGVfdXNlcmBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7dG9SZWRpcmVjdFRvfT9lcnJvcj1mYWlsZWRfdG9fY3JlYXRlX3VzZXJgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCF1c2VyLmVtYWlsVmVyaWZpZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKHVzZXIuaWQsIHtcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgICBjdHguaGVhZGVyc1xuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgICAgICAgIGAke3RvUmVkaXJlY3RUb30/ZXJyb3I9ZmFpbGVkX3RvX2NyZWF0ZV9zZXNzaW9uYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFjYWxsYmFja1VSTCkge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogdXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGNhbGxiYWNrVVJMKTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgcmF0ZUxpbWl0OiBbXG4gICAgICB7XG4gICAgICAgIHBhdGhNYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgICByZXR1cm4gcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24taW4vbWFnaWMtbGlua1wiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvbWFnaWMtbGluay92ZXJpZnlcIik7XG4gICAgICAgIH0sXG4gICAgICAgIHdpbmRvdzogb3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyB8fCA2MCxcbiAgICAgICAgbWF4OiBvcHRpb25zLnJhdGVMaW1pdD8ubWF4IHx8IDVcbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG5leHBvcnQgeyBtYWdpY0xpbmsgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   organization: () => (/* binding */ organization)\n/* harmony export */ });\n/* harmony import */ var _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-GBLEGHZW.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-HVHN3Y2L.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\n\n\n// src/utils/shim.ts\nvar shimContext = (originalObject, newContext) => {\n  const shimmedObj = {};\n  for (const [key, value] of Object.entries(originalObject)) {\n    shimmedObj[key] = (ctx) => {\n      return value({\n        ...ctx,\n        context: {\n          ...newContext,\n          ...ctx.context\n        }\n      });\n    };\n    shimmedObj[key].path = value.path;\n    shimmedObj[key].method = value.method;\n    shimmedObj[key].options = value.options;\n    shimmedObj[key].headers = value.headers;\n  }\n  return shimmedObj;\n};\n\n// src/plugins/organization/adapter.ts\nvar getOrgAdapter = (context, options) => {\n  const adapter = context.adapter;\n  return {\n    findOrganizationBySlug: async (slug) => {\n      const organization2 = await adapter.findOne({\n        model: \"organization\",\n        where: [\n          {\n            field: \"slug\",\n            value: slug\n          }\n        ]\n      });\n      return organization2;\n    },\n    createOrganization: async (data) => {\n      const organization2 = await adapter.create({\n        model: \"organization\",\n        data: {\n          ...data.organization,\n          metadata: data.organization.metadata ? JSON.stringify(data.organization.metadata) : void 0\n        }\n      });\n      const member = await adapter.create({\n        model: \"member\",\n        data: {\n          organizationId: organization2.id,\n          userId: data.user.id,\n          createdAt: /* @__PURE__ */ new Date(),\n          role: options?.creatorRole || \"owner\"\n        }\n      });\n      return {\n        ...organization2,\n        metadata: organization2.metadata ? JSON.parse(organization2.metadata) : void 0,\n        members: [\n          {\n            ...member,\n            user: {\n              id: data.user.id,\n              name: data.user.name,\n              email: data.user.email,\n              image: data.user.image\n            }\n          }\n        ]\n      };\n    },\n    findMemberByEmail: async (data) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"email\",\n            value: data.email\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const member = await adapter.findOne({\n        model: \"member\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: data.organizationId\n          },\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!member) {\n        return null;\n      }\n      return {\n        ...member,\n        user: {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          image: user.image\n        }\n      };\n    },\n    findMemberByOrgId: async (data) => {\n      const [member, user] = await Promise.all([\n        await adapter.findOne({\n          model: \"member\",\n          where: [\n            {\n              field: \"userId\",\n              value: data.userId\n            },\n            {\n              field: \"organizationId\",\n              value: data.organizationId\n            }\n          ]\n        }),\n        await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              field: \"id\",\n              value: data.userId\n            }\n          ]\n        })\n      ]);\n      if (!user || !member) {\n        return null;\n      }\n      return {\n        ...member,\n        user: {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          image: user.image\n        }\n      };\n    },\n    findMemberById: async (memberId) => {\n      const member = await adapter.findOne({\n        model: \"member\",\n        where: [\n          {\n            field: \"id\",\n            value: memberId\n          }\n        ]\n      });\n      if (!member) {\n        return null;\n      }\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: member.userId\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      return {\n        ...member,\n        user: {\n          id: user.id,\n          name: user.name,\n          email: user.email,\n          image: user.image\n        }\n      };\n    },\n    createMember: async (data) => {\n      const member = await adapter.create({\n        model: \"member\",\n        data\n      });\n      return member;\n    },\n    updateMember: async (memberId, role2) => {\n      const member = await adapter.update({\n        model: \"member\",\n        where: [\n          {\n            field: \"id\",\n            value: memberId\n          }\n        ],\n        update: {\n          role: role2\n        }\n      });\n      return member;\n    },\n    deleteMember: async (memberId) => {\n      const member = await adapter.delete({\n        model: \"member\",\n        where: [\n          {\n            field: \"id\",\n            value: memberId\n          }\n        ]\n      });\n      return member;\n    },\n    updateOrganization: async (organizationId, data) => {\n      const organization2 = await adapter.update({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationId\n          }\n        ],\n        update: {\n          ...data,\n          metadata: typeof data.metadata === \"object\" ? JSON.stringify(data.metadata) : data.metadata\n        }\n      });\n      if (!organization2) {\n        return null;\n      }\n      return {\n        ...organization2,\n        metadata: organization2.metadata ? (0,_chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_2__.parser_default)(organization2.metadata) : void 0\n      };\n    },\n    deleteOrganization: async (organizationId) => {\n      await adapter.delete({\n        model: \"member\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: organizationId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: organizationId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationId\n          }\n        ]\n      });\n      return organizationId;\n    },\n    setActiveOrganization: async (sessionToken, organizationId) => {\n      const session = await context.internalAdapter.updateSession(\n        sessionToken,\n        {\n          activeOrganizationId: organizationId\n        }\n      );\n      return session;\n    },\n    findOrganizationById: async (organizationId) => {\n      const organization2 = await adapter.findOne({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationId\n          }\n        ]\n      });\n      return organization2;\n    },\n    /**\n     * @requires db\n     */\n    findFullOrganization: async ({\n      organizationId,\n      isSlug\n    }) => {\n      const org = await adapter.findOne({\n        model: \"organization\",\n        where: [{ field: isSlug ? \"slug\" : \"id\", value: organizationId }]\n      });\n      if (!org) {\n        return null;\n      }\n      const [invitations, members] = await Promise.all([\n        adapter.findMany({\n          model: \"invitation\",\n          where: [{ field: \"organizationId\", value: org.id }]\n        }),\n        adapter.findMany({\n          model: \"member\",\n          where: [{ field: \"organizationId\", value: org.id }]\n        })\n      ]);\n      if (!org) return null;\n      const userIds = members.map((member) => member.userId);\n      const users = await adapter.findMany({\n        model: \"user\",\n        where: [{ field: \"id\", value: userIds, operator: \"in\" }]\n      });\n      const userMap = new Map(users.map((user) => [user.id, user]));\n      const membersWithUsers = members.map((member) => {\n        const user = userMap.get(member.userId);\n        if (!user) {\n          throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_6__.BetterAuthError(\n            \"Unexpected error: User not found for member\"\n          );\n        }\n        return {\n          ...member,\n          user: {\n            id: user.id,\n            name: user.name,\n            email: user.email,\n            image: user.image\n          }\n        };\n      });\n      return {\n        ...org,\n        invitations,\n        members: membersWithUsers\n      };\n    },\n    listOrganizations: async (userId) => {\n      const members = await adapter.findMany({\n        model: \"member\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      if (!members || members.length === 0) {\n        return [];\n      }\n      const organizationIds = members.map((member) => member.organizationId);\n      const organizations = await adapter.findMany({\n        model: \"organization\",\n        where: [\n          {\n            field: \"id\",\n            value: organizationIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return organizations;\n    },\n    createInvitation: async ({\n      invitation,\n      user\n    }) => {\n      const defaultExpiration = 1e3 * 60 * 60 * 48;\n      const expiresAt = (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_5__.getDate)(\n        options?.invitationExpiresIn || defaultExpiration\n      );\n      const invite = await adapter.create({\n        model: \"invitation\",\n        data: {\n          email: invitation.email,\n          role: invitation.role,\n          organizationId: invitation.organizationId,\n          status: \"pending\",\n          expiresAt,\n          inviterId: user.id\n        }\n      });\n      return invite;\n    },\n    findInvitationById: async (id) => {\n      const invitation = await adapter.findOne({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n      return invitation;\n    },\n    findPendingInvitation: async (data) => {\n      const invitation = await adapter.findMany({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"email\",\n            value: data.email\n          },\n          {\n            field: \"organizationId\",\n            value: data.organizationId\n          },\n          {\n            field: \"status\",\n            value: \"pending\"\n          }\n        ]\n      });\n      return invitation.filter(\n        (invite) => new Date(invite.expiresAt) > /* @__PURE__ */ new Date()\n      );\n    },\n    updateInvitation: async (data) => {\n      const invitation = await adapter.update({\n        model: \"invitation\",\n        where: [\n          {\n            field: \"id\",\n            value: data.invitationId\n          }\n        ],\n        update: {\n          status: data.status\n        }\n      });\n      return invitation;\n    }\n  };\n};\nvar orgMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(async (ctx) => {\n  return {};\n});\nvar orgSessionMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthMiddleware)(\n  {\n    use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.sessionMiddleware]\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    return {\n      session\n    };\n  }\n);\nvar role = zod__WEBPACK_IMPORTED_MODULE_8__.z.string();\nvar invitationStatus = zod__WEBPACK_IMPORTED_MODULE_8__.z[\"enum\"]([\"pending\", \"accepted\", \"rejected\", \"canceled\"]).default(\"pending\");\nzod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().default(_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId),\n  name: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  slug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  logo: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().nullish(),\n  metadata: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string()).or(zod__WEBPACK_IMPORTED_MODULE_8__.z.string().transform((v) => JSON.parse(v))).nullish(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_8__.z.date()\n});\nzod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().default(_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId),\n  organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  role,\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_8__.z.date()\n});\nzod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().default(_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId),\n  organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  email: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  role,\n  status: invitationStatus,\n  /**\n   * The id of the user who invited the user.\n   */\n  inviterId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_8__.z.date()\n});\n\n// src/plugins/organization/error-codes.ts\nvar ORGANIZATION_ERROR_CODES = {\n  YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_ORGANIZATION: \"You are not allowed to create a new organization\",\n  YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_ORGANIZATIONS: \"You have reached the maximum number of organizations\",\n  ORGANIZATION_ALREADY_EXISTS: \"Organization already exists\",\n  ORGANIZATION_NOT_FOUND: \"Organization not found\",\n  USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION: \"User is not a member of the organization\",\n  YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_ORGANIZATION: \"You are not allowed to update this organization\",\n  YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_ORGANIZATION: \"You are not allowed to delete this organization\",\n  NO_ACTIVE_ORGANIZATION: \"No active organization\",\n  USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION: \"User is already a member of this organization\",\n  MEMBER_NOT_FOUND: \"Member not found\",\n  ROLE_NOT_FOUND: \"Role not found\",\n  YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER: \"You cannot leave the organization as the only owner\",\n  YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_MEMBER: \"You are not allowed to delete this member\",\n  YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION: \"You are not allowed to invite users to this organization\",\n  USER_IS_ALREADY_INVITED_TO_THIS_ORGANIZATION: \"User is already invited to this organization\",\n  INVITATION_NOT_FOUND: \"Invitation not found\",\n  YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION: \"You are not the recipient of the invitation\",\n  YOU_ARE_NOT_ALLOWED_TO_CANCEL_THIS_INVITATION: \"You are not allowed to cancel this invitation\",\n  INVITER_IS_NO_LONGER_A_MEMBER_OF_THE_ORGANIZATION: \"Inviter is no longer a member of the organization\",\n  YOU_ARE_NOT_ALLOWED_TO_INVITE_USER_WITH_THIS_ROLE: \"you are not allowed to invite user with this role\"\n};\n\n// src/plugins/organization/routes/crud-invites.ts\nvar createInvitation = (option) => (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/invite-member\",\n  {\n    method: \"POST\",\n    use: [orgMiddleware, orgSessionMiddleware],\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The email address of the user to invite\"\n      }),\n      role: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The role to assign to the user\"\n      }),\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization ID to invite the user to\"\n      }).optional(),\n      resend: zod__WEBPACK_IMPORTED_MODULE_8__.z.boolean({\n        description: \"Resend the invitation email, if the user is already invited\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Invite a user to an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\"\n                    },\n                    email: {\n                      type: \"string\"\n                    },\n                    role: {\n                      type: \"string\"\n                    },\n                    organizationId: {\n                      type: \"string\"\n                    },\n                    inviterId: {\n                      type: \"string\"\n                    },\n                    status: {\n                      type: \"string\"\n                    },\n                    expiresAt: {\n                      type: \"string\"\n                    }\n                  },\n                  required: [\n                    \"id\",\n                    \"email\",\n                    \"role\",\n                    \"organizationId\",\n                    \"inviterId\",\n                    \"status\",\n                    \"expiresAt\"\n                  ]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.orgOptions.sendInvitationEmail) {\n      ctx.context.logger.warn(\n        \"Invitation email is not enabled. Pass `sendInvitationEmail` to the plugin options to enable it.\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: \"Invitation email is not enabled\"\n      });\n    }\n    const session = ctx.context.session;\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ROLE_NOT_FOUND\n      });\n    }\n    const canInvite = role2.authorize({\n      invitation: [\"create\"]\n    });\n    if (canInvite.error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION\n      });\n    }\n    const creatorRole = ctx.context.orgOptions.creatorRole || \"owner\";\n    if (member.role !== creatorRole && ctx.body.role === creatorRole) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_INVITE_USER_WITH_THIS_ROLE\n      });\n    }\n    const alreadyMember = await adapter.findMemberByEmail({\n      email: ctx.body.email,\n      organizationId\n    });\n    if (alreadyMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION\n      });\n    }\n    const alreadyInvited = await adapter.findPendingInvitation({\n      email: ctx.body.email,\n      organizationId\n    });\n    if (alreadyInvited.length && !ctx.body.resend) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_ALREADY_INVITED_TO_THIS_ORGANIZATION\n      });\n    }\n    const invitation = await adapter.createInvitation({\n      invitation: {\n        role: ctx.body.role,\n        email: ctx.body.email,\n        organizationId\n      },\n      user: session.user\n    });\n    const organization2 = await adapter.findOrganizationById(organizationId);\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    await ctx.context.orgOptions.sendInvitationEmail?.(\n      {\n        id: invitation.id,\n        role: invitation.role,\n        email: invitation.email.toLowerCase(),\n        organization: organization2,\n        inviter: {\n          ...member,\n          user: session.user\n        }\n      },\n      ctx.request\n    );\n    return ctx.json(invitation);\n  }\n);\nvar acceptInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/accept-invitation\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      invitationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to accept\"\n      })\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Accept an invitation to an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    invitation: {\n                      type: \"object\"\n                    },\n                    member: {\n                      type: \"object\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.body.invitationId);\n    if (!invitation || invitation.expiresAt < /* @__PURE__ */ new Date() || invitation.status !== \"pending\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.INVITATION_NOT_FOUND\n      });\n    }\n    if (invitation.email !== session.user.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION\n      });\n    }\n    const acceptedI = await adapter.updateInvitation({\n      invitationId: ctx.body.invitationId,\n      status: \"accepted\"\n    });\n    const member = await adapter.createMember({\n      organizationId: invitation.organizationId,\n      userId: session.user.id,\n      role: invitation.role,\n      createdAt: /* @__PURE__ */ new Date()\n    });\n    await adapter.setActiveOrganization(\n      session.session.token,\n      invitation.organizationId\n    );\n    if (!acceptedI) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.INVITATION_NOT_FOUND\n        }\n      });\n    }\n    return ctx.json({\n      invitation: acceptedI,\n      member\n    });\n  }\n);\nvar rejectInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/reject-invitation\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      invitationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to reject\"\n      })\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Reject an invitation to an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    invitation: {\n                      type: \"object\"\n                    },\n                    member: {\n                      type: \"null\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.body.invitationId);\n    if (!invitation || invitation.expiresAt < /* @__PURE__ */ new Date() || invitation.status !== \"pending\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: \"Invitation not found!\"\n      });\n    }\n    if (invitation.email !== session.user.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION\n      });\n    }\n    const rejectedI = await adapter.updateInvitation({\n      invitationId: ctx.body.invitationId,\n      status: \"rejected\"\n    });\n    return ctx.json({\n      invitation: rejectedI,\n      member: null\n    });\n  }\n);\nvar cancelInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/cancel-invitation\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      invitationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to cancel\"\n      })\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    openapi: {\n      description: \"Cancel an invitation to an organization\",\n      responses: {\n        \"200\": {\n          description: \"Success\",\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  invitation: {\n                    type: \"object\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.body.invitationId);\n    if (!invitation) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.INVITATION_NOT_FOUND\n      });\n    }\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId: invitation.organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const canCancel = ctx.context.roles[member.role].authorize({\n      invitation: [\"cancel\"]\n    });\n    if (canCancel.error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CANCEL_THIS_INVITATION\n      });\n    }\n    const canceledI = await adapter.updateInvitation({\n      invitationId: ctx.body.invitationId,\n      status: \"canceled\"\n    });\n    return ctx.json(canceledI);\n  }\n);\nvar getInvitation = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/get-invitation\",\n  {\n    method: \"GET\",\n    use: [orgMiddleware],\n    requireHeaders: true,\n    query: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      id: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the invitation to get\"\n      })\n    }),\n    metadata: {\n      openapi: {\n        description: \"Get an invitation by ID\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\"\n                    },\n                    email: {\n                      type: \"string\"\n                    },\n                    role: {\n                      type: \"string\"\n                    },\n                    organizationId: {\n                      type: \"string\"\n                    },\n                    inviterId: {\n                      type: \"string\"\n                    },\n                    status: {\n                      type: \"string\"\n                    },\n                    expiresAt: {\n                      type: \"string\"\n                    },\n                    organizationName: {\n                      type: \"string\"\n                    },\n                    organizationSlug: {\n                      type: \"string\"\n                    },\n                    inviterEmail: {\n                      type: \"string\"\n                    }\n                  },\n                  required: [\n                    \"id\",\n                    \"email\",\n                    \"role\",\n                    \"organizationId\",\n                    \"inviterId\",\n                    \"status\",\n                    \"expiresAt\",\n                    \"organizationName\",\n                    \"organizationSlug\",\n                    \"inviterEmail\"\n                  ]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n        message: \"Not authenticated\"\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const invitation = await adapter.findInvitationById(ctx.query.id);\n    if (!invitation || invitation.status !== \"pending\" || invitation.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: \"Invitation not found!\"\n      });\n    }\n    if (invitation.email !== session.user.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION\n      });\n    }\n    const organization2 = await adapter.findOrganizationById(\n      invitation.organizationId\n    );\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    const member = await adapter.findMemberByOrgId({\n      userId: invitation.inviterId,\n      organizationId: invitation.organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.INVITER_IS_NO_LONGER_A_MEMBER_OF_THE_ORGANIZATION\n      });\n    }\n    return ctx.json({\n      ...invitation,\n      organizationName: organization2.name,\n      organizationSlug: organization2.slug,\n      inviterEmail: member.user.email\n    });\n  }\n);\nvar addMember = () => (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/add-member\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      userId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      role: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional()\n    }),\n    use: [orgMiddleware],\n    metadata: {\n      SERVER_ONLY: true\n    }\n  },\n  async (ctx) => {\n    const session = ctx.body.userId ? await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(ctx).catch((e) => null) : null;\n    const orgId = ctx.body.organizationId || session?.session.activeOrganizationId;\n    if (!orgId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const user = await ctx.context.internalAdapter.findUserById(\n      ctx.body.userId\n    );\n    if (!user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.BASE_ERROR_CODES.USER_NOT_FOUND\n      });\n    }\n    const alreadyMember = await adapter.findMemberByEmail({\n      email: user.email,\n      organizationId: orgId\n    });\n    if (alreadyMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION\n      });\n    }\n    const createdMember = await adapter.createMember({\n      id: (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId)(),\n      organizationId: orgId,\n      userId: user.id,\n      role: ctx.body.role,\n      createdAt: /* @__PURE__ */ new Date()\n    });\n    return ctx.json(createdMember);\n  }\n);\nvar removeMember = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/remove-member\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      memberIdOrEmail: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID or email of the member to remove\"\n      }),\n      /**\n       * If not provided, the active organization will be used\n       */\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The ID of the organization to remove the member from. If not provided, the active organization will be used\"\n      }).optional()\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Remove a member from an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    member: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        userId: {\n                          type: \"string\"\n                        },\n                        organizationId: {\n                          type: \"string\"\n                        },\n                        role: {\n                          type: \"string\"\n                        }\n                      },\n                      required: [\"id\", \"userId\", \"organizationId\", \"role\"]\n                    }\n                  },\n                  required: [\"member\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ROLE_NOT_FOUND\n      });\n    }\n    const isLeaving = session.user.email === ctx.body.memberIdOrEmail || member.id === ctx.body.memberIdOrEmail;\n    const isOwnerLeaving = isLeaving && member.role === (ctx.context.orgOptions?.creatorRole || \"owner\");\n    if (isOwnerLeaving) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER\n      });\n    }\n    const canDeleteMember = isLeaving || role2.authorize({\n      member: [\"delete\"]\n    }).success;\n    if (!canDeleteMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_MEMBER\n      });\n    }\n    let existing = null;\n    if (ctx.body.memberIdOrEmail.includes(\"@\")) {\n      existing = await adapter.findMemberByEmail({\n        email: ctx.body.memberIdOrEmail,\n        organizationId\n      });\n    } else {\n      existing = await adapter.findMemberById(ctx.body.memberIdOrEmail);\n    }\n    if (existing?.organizationId !== organizationId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    await adapter.deleteMember(existing.id);\n    if (session.user.id === existing.userId && session.session.activeOrganizationId === existing.organizationId) {\n      await adapter.setActiveOrganization(session.session.token, null);\n    }\n    return ctx.json({\n      member: existing\n    });\n  }\n);\nvar updateMemberRole = (option) => (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/update-member-role\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      role: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      memberId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string(),\n      /**\n       * If not provided, the active organization will be used\n       */\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional()\n    }),\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Update the role of a member in an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    member: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        userId: {\n                          type: \"string\"\n                        },\n                        organizationId: {\n                          type: \"string\"\n                        },\n                        role: {\n                          type: \"string\"\n                        }\n                      },\n                      required: [\"id\", \"userId\", \"organizationId\", \"role\"]\n                    }\n                  },\n                  required: [\"member\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n        }\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.ROLE_NOT_FOUND\n        }\n      });\n    }\n    const canUpdateMember = role2.authorize({\n      member: [\"update\"]\n    }).error || ctx.body.role === \"owner\" && member.role !== \"owner\";\n    if (canUpdateMember) {\n      return ctx.json(null, {\n        body: {\n          message: \"You are not allowed to update this member\"\n        },\n        status: 403\n      });\n    }\n    const updatedMember = await adapter.updateMember(\n      ctx.body.memberId,\n      ctx.body.role\n    );\n    if (!updatedMember) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n        }\n      });\n    }\n    return ctx.json(updatedMember);\n  }\n);\nvar getActiveMember = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/get-active-member\",\n  {\n    method: \"GET\",\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Get the active member in the organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\"\n                    },\n                    userId: {\n                      type: \"string\"\n                    },\n                    organizationId: {\n                      type: \"string\"\n                    },\n                    role: {\n                      type: \"string\"\n                    }\n                  },\n                  required: [\"id\", \"userId\", \"organizationId\", \"role\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n        }\n      });\n    }\n    return ctx.json(member);\n  }\n);\nvar leaveOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/leave\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string()\n    }),\n    use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.sessionMiddleware, orgMiddleware]\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const adapter = getOrgAdapter(ctx.context);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId: ctx.body.organizationId\n    });\n    if (!member) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.MEMBER_NOT_FOUND\n      });\n    }\n    const isOwnerLeaving = member.role === (ctx.context.orgOptions?.creatorRole || \"owner\");\n    if (isOwnerLeaving) {\n      const members = await ctx.context.adapter.findMany({\n        model: \"member\",\n        where: [\n          {\n            field: \"organizationId\",\n            value: ctx.body.organizationId\n          }\n        ]\n      });\n      const owners = members.filter(\n        (member2) => member2.role === (ctx.context.orgOptions?.creatorRole || \"owner\")\n      );\n      if (owners.length <= 1) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: ORGANIZATION_ERROR_CODES.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER\n        });\n      }\n    }\n    await adapter.deleteMember(member.id);\n    if (session.session.activeOrganizationId === ctx.body.organizationId) {\n      await adapter.setActiveOrganization(session.session.token, null);\n    }\n    return ctx.json(member);\n  }\n);\nvar createOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/create\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      name: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The name of the organization\"\n      }),\n      slug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The slug of the organization\"\n      }),\n      userId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The user id of the organization creator. If not provided, the current user will be used. Should only be used by admins or when called by the server.\"\n      }).optional(),\n      logo: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The logo of the organization\"\n      }).optional(),\n      metadata: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string(), zod__WEBPACK_IMPORTED_MODULE_8__.z.any(), {\n        description: \"The metadata of the organization\"\n      }).optional()\n    }),\n    use: [orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Create an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The organization that was created\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(ctx);\n    if (!session && (ctx.request || ctx.headers)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\");\n    }\n    let user = session?.user || null;\n    if (!user) {\n      if (!ctx.body.userId) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\");\n      }\n      user = await ctx.context.internalAdapter.findUserById(ctx.body.userId);\n    }\n    if (!user) {\n      return ctx.json(null, {\n        status: 401\n      });\n    }\n    const options = ctx.context.orgOptions;\n    const canCreateOrg = typeof options?.allowUserToCreateOrganization === \"function\" ? await options.allowUserToCreateOrganization(user) : options?.allowUserToCreateOrganization === void 0 ? true : options.allowUserToCreateOrganization;\n    if (!canCreateOrg) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_ORGANIZATION\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, options);\n    const userOrganizations = await adapter.listOrganizations(user.id);\n    const hasReachedOrgLimit = typeof options.organizationLimit === \"number\" ? userOrganizations.length >= options.organizationLimit : typeof options.organizationLimit === \"function\" ? await options.organizationLimit(user) : false;\n    if (hasReachedOrgLimit) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_ORGANIZATIONS\n      });\n    }\n    const existingOrganization = await adapter.findOrganizationBySlug(\n      ctx.body.slug\n    );\n    if (existingOrganization) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_ALREADY_EXISTS\n      });\n    }\n    const organization2 = await adapter.createOrganization({\n      organization: {\n        id: (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId)(),\n        slug: ctx.body.slug,\n        name: ctx.body.name,\n        logo: ctx.body.logo,\n        createdAt: /* @__PURE__ */ new Date(),\n        metadata: ctx.body.metadata\n      },\n      user\n    });\n    if (ctx.context.session) {\n      await adapter.setActiveOrganization(\n        ctx.context.session.session.token,\n        organization2.id\n      );\n    }\n    return ctx.json(organization2);\n  }\n);\nvar updateOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/update\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      data: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n        name: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The name of the organization\"\n        }).optional(),\n        slug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The slug of the organization\"\n        }).optional(),\n        logo: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The logo of the organization\"\n        }).optional(),\n        metadata: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string(), zod__WEBPACK_IMPORTED_MODULE_8__.z.any(), {\n          description: \"The metadata of the organization\"\n        }).optional()\n      }).partial(),\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional()\n    }),\n    requireHeaders: true,\n    use: [orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Update an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The updated organization\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await ctx.context.getSession(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n        message: \"User not found\"\n      });\n    }\n    const organizationId = ctx.body.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n        }\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: \"Role not found!\"\n        }\n      });\n    }\n    const canUpdateOrg = role2.authorize({\n      organization: [\"update\"]\n    });\n    if (canUpdateOrg.error) {\n      return ctx.json(null, {\n        body: {\n          message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_ORGANIZATION\n        },\n        status: 403\n      });\n    }\n    const updatedOrg = await adapter.updateOrganization(\n      organizationId,\n      ctx.body.data\n    );\n    return ctx.json(updatedOrg);\n  }\n);\nvar deleteOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/delete\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization id to delete\"\n      })\n    }),\n    requireHeaders: true,\n    use: [orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Delete an organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"string\",\n                  description: \"The organization id that was deleted\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = await ctx.context.getSession(ctx);\n    if (!session) {\n      return ctx.json(null, {\n        status: 401\n      });\n    }\n    const organizationId = ctx.body.organizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n        }\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const member = await adapter.findMemberByOrgId({\n      userId: session.user.id,\n      organizationId\n    });\n    if (!member) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n        }\n      });\n    }\n    const role2 = ctx.context.roles[member.role];\n    if (!role2) {\n      return ctx.json(null, {\n        status: 400,\n        body: {\n          message: \"Role not found!\"\n        }\n      });\n    }\n    const canDeleteOrg = role2.authorize({\n      organization: [\"delete\"]\n    });\n    if (canDeleteOrg.error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_ORGANIZATION\n      });\n    }\n    if (organizationId === session.session.activeOrganizationId) {\n      await adapter.setActiveOrganization(session.session.token, null);\n    }\n    const option = ctx.context.orgOptions.organizationDeletion;\n    if (option?.disabled) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\");\n    }\n    const org = await adapter.findOrganizationById(organizationId);\n    if (!org) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\");\n    }\n    if (option?.beforeDelete) {\n      await option.beforeDelete({\n        organization: org,\n        user: session.user\n      });\n    }\n    await adapter.deleteOrganization(organizationId);\n    if (option?.afterDelete) {\n      await option.afterDelete({\n        organization: org,\n        user: session.user\n      });\n    }\n    return ctx.json(org);\n  }\n);\nvar getFullOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/get-full-organization\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_8__.z.optional(\n      zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n        organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The organization id to get\"\n        }).optional(),\n        organizationSlug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n          description: \"The organization slug to get\"\n        }).optional()\n      })\n    ),\n    requireHeaders: true,\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Get the full organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The organization\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    const organizationId = ctx.query?.organizationSlug || ctx.query?.organizationId || session.session.activeOrganizationId;\n    if (!organizationId) {\n      return ctx.json(null, {\n        status: 200\n      });\n    }\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const organization2 = await adapter.findFullOrganization({\n      organizationId,\n      isSlug: !!ctx.query?.organizationSlug\n    });\n    const isMember = organization2?.members.find(\n      (member) => member.userId === session.user.id\n    );\n    if (!isMember) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n      });\n    }\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    return ctx.json(organization2);\n  }\n);\nvar setActiveOrganization = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/set-active\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n      organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization id to set as active. It can be null to unset the active organization\"\n      }).nullable().optional(),\n      organizationSlug: zod__WEBPACK_IMPORTED_MODULE_8__.z.string({\n        description: \"The organization slug to set as active. It can be null to unset the active organization if organizationId is not provided\"\n      }).optional()\n    }),\n    use: [orgSessionMiddleware, orgMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Set the active organization\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  description: \"The organization\",\n                  $ref: \"#/components/schemas/Organization\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const session = ctx.context.session;\n    let organizationId = ctx.body.organizationSlug || ctx.body.organizationId;\n    if (organizationId === null) {\n      const sessionOrgId = session.session.activeOrganizationId;\n      if (!sessionOrgId) {\n        return ctx.json(null);\n      }\n      const updatedSession2 = await adapter.setActiveOrganization(\n        session.session.token,\n        null\n      );\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n        session: updatedSession2,\n        user: session.user\n      });\n      return ctx.json(null);\n    }\n    if (!organizationId) {\n      const sessionOrgId = session.session.activeOrganizationId;\n      if (!sessionOrgId) {\n        return ctx.json(null);\n      }\n      organizationId = sessionOrgId;\n    }\n    const organization2 = await adapter.findFullOrganization({\n      organizationId,\n      isSlug: !!ctx.body.organizationSlug\n    });\n    const isMember = organization2?.members.find(\n      (member) => member.userId === session.user.id\n    );\n    if (!isMember) {\n      await adapter.setActiveOrganization(session.session.token, null);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"FORBIDDEN\", {\n        message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n      });\n    }\n    if (!organization2) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n        message: ORGANIZATION_ERROR_CODES.ORGANIZATION_NOT_FOUND\n      });\n    }\n    const updatedSession = await adapter.setActiveOrganization(\n      session.session.token,\n      organization2.id\n    );\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n      session: updatedSession,\n      user: session.user\n    });\n    return ctx.json(organization2);\n  }\n);\nvar listOrganizations = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n  \"/organization/list\",\n  {\n    method: \"GET\",\n    use: [orgMiddleware, orgSessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"List all organizations\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    $ref: \"#/components/schemas/Organization\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const adapter = getOrgAdapter(ctx.context, ctx.context.orgOptions);\n    const organizations = await adapter.listOrganizations(\n      ctx.context.session.user.id\n    );\n    return ctx.json(organizations);\n  }\n);\n\n// src/plugins/organization/organization.ts\nvar organization = (options) => {\n  const endpoints = {\n    createOrganization,\n    updateOrganization,\n    deleteOrganization,\n    setActiveOrganization,\n    getFullOrganization,\n    listOrganizations,\n    createInvitation: createInvitation(),\n    cancelInvitation,\n    acceptInvitation,\n    getInvitation,\n    rejectInvitation,\n    addMember: addMember(),\n    removeMember,\n    updateMemberRole: updateMemberRole(),\n    getActiveMember,\n    leaveOrganization\n  };\n  const roles = {\n    ..._chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_0__.defaultRoles,\n    ...options?.roles\n  };\n  const api = shimContext(endpoints, {\n    orgOptions: options || {},\n    roles,\n    getSession: async (context) => {\n      return await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getSessionFromCtx)(context);\n    }\n  });\n  return {\n    id: \"organization\",\n    endpoints: {\n      ...api,\n      hasPermission: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n        \"/organization/has-permission\",\n        {\n          method: \"POST\",\n          requireHeaders: true,\n          body: zod__WEBPACK_IMPORTED_MODULE_8__.z.object({\n            organizationId: zod__WEBPACK_IMPORTED_MODULE_8__.z.string().optional(),\n            permission: zod__WEBPACK_IMPORTED_MODULE_8__.z.record(zod__WEBPACK_IMPORTED_MODULE_8__.z.string(), zod__WEBPACK_IMPORTED_MODULE_8__.z.array(zod__WEBPACK_IMPORTED_MODULE_8__.z.string()))\n          }),\n          use: [orgSessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Check if the user has permission\",\n              requestBody: {\n                content: {\n                  \"application/json\": {\n                    schema: {\n                      type: \"object\",\n                      properties: {\n                        permission: {\n                          type: \"object\",\n                          description: \"The permission to check\"\n                        }\n                      },\n                      required: [\"permission\"]\n                    }\n                  }\n                }\n              },\n              responses: {\n                \"200\": {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          error: {\n                            type: \"string\"\n                          },\n                          success: {\n                            type: \"boolean\"\n                          }\n                        },\n                        required: [\"success\"]\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!ctx.body.permission || Object.keys(ctx.body.permission).length > 1) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: \"invalid permission check. you can only check one resource permission at a time.\"\n            });\n          }\n          const activeOrganizationId = ctx.body.organizationId || ctx.context.session.session.activeOrganizationId;\n          if (!activeOrganizationId) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: ORGANIZATION_ERROR_CODES.NO_ACTIVE_ORGANIZATION\n            });\n          }\n          const adapter = getOrgAdapter(ctx.context);\n          const member = await adapter.findMemberByOrgId({\n            userId: ctx.context.session.user.id,\n            organizationId: activeOrganizationId\n          });\n          if (!member) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n              message: ORGANIZATION_ERROR_CODES.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION\n            });\n          }\n          const role2 = roles[member.role];\n          const result = role2.authorize(ctx.body.permission);\n          if (result.error) {\n            return ctx.json(\n              {\n                error: result.error,\n                success: false\n              },\n              {\n                status: 403\n              }\n            );\n          }\n          return ctx.json({\n            error: null,\n            success: true\n          });\n        }\n      )\n    },\n    schema: {\n      session: {\n        fields: {\n          activeOrganizationId: {\n            type: \"string\",\n            required: false,\n            fieldName: options?.schema?.session?.fields?.activeOrganizationId\n          }\n        }\n      },\n      organization: {\n        modelName: options?.schema?.organization?.modelName,\n        fields: {\n          name: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            fieldName: options?.schema?.organization?.fields?.name\n          },\n          slug: {\n            type: \"string\",\n            unique: true,\n            sortable: true,\n            fieldName: options?.schema?.organization?.fields?.slug\n          },\n          logo: {\n            type: \"string\",\n            required: false,\n            fieldName: options?.schema?.organization?.fields?.logo\n          },\n          createdAt: {\n            type: \"date\",\n            required: true,\n            fieldName: options?.schema?.organization?.fields?.createdAt\n          },\n          metadata: {\n            type: \"string\",\n            required: false,\n            fieldName: options?.schema?.organization?.fields?.metadata\n          }\n        }\n      },\n      member: {\n        modelName: options?.schema?.member?.modelName,\n        fields: {\n          organizationId: {\n            type: \"string\",\n            required: true,\n            references: {\n              model: \"organization\",\n              field: \"id\"\n            },\n            fieldName: options?.schema?.member?.fields?.organizationId\n          },\n          userId: {\n            type: \"string\",\n            required: true,\n            fieldName: options?.schema?.member?.fields?.userId,\n            references: {\n              model: \"user\",\n              field: \"id\"\n            }\n          },\n          role: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            defaultValue: \"member\",\n            fieldName: options?.schema?.member?.fields?.role\n          },\n          createdAt: {\n            type: \"date\",\n            required: true,\n            fieldName: options?.schema?.member?.fields?.createdAt\n          }\n        }\n      },\n      invitation: {\n        modelName: options?.schema?.invitation?.modelName,\n        fields: {\n          organizationId: {\n            type: \"string\",\n            required: true,\n            references: {\n              model: \"organization\",\n              field: \"id\"\n            },\n            fieldName: options?.schema?.invitation?.fields?.organizationId\n          },\n          email: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            fieldName: options?.schema?.invitation?.fields?.email\n          },\n          role: {\n            type: \"string\",\n            required: false,\n            sortable: true,\n            fieldName: options?.schema?.invitation?.fields?.role\n          },\n          status: {\n            type: \"string\",\n            required: true,\n            sortable: true,\n            defaultValue: \"pending\",\n            fieldName: options?.schema?.invitation?.fields?.status\n          },\n          expiresAt: {\n            type: \"date\",\n            required: true,\n            fieldName: options?.schema?.invitation?.fields?.expiresAt\n          },\n          inviterId: {\n            type: \"string\",\n            references: {\n              model: \"user\",\n              field: \"id\"\n            },\n            fieldName: options?.schema?.invitation?.fields?.inviterId,\n            required: true\n          }\n        }\n      }\n    },\n    $Infer: {\n      Organization: {},\n      Invitation: {},\n      Member: {},\n      ActiveOrganization: {}\n    },\n    $ERROR_CODES: ORGANIZATION_ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTJSREFWMlVCLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBbUQ7QUFDb0Y7QUFDbEY7QUFDRTtBQUNOO0FBQ0g7QUFDUTtBQUNmO0FBQ2Y7O0FBRXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsa0VBQWM7QUFDekQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNB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QVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxzQkFBc0I7QUFDdEIsb0JBQW9CO0FBQ3BCLGdCQUFnQjtBQUNoQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstMlJEQVYyVUIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVmYXVsdFJvbGVzIH0gZnJvbSAnLi9jaHVuay1HQkxFR0haVy5qcyc7XG5pbXBvcnQgeyBjcmVhdGVBdXRoTWlkZGxld2FyZSwgc2Vzc2lvbk1pZGRsZXdhcmUsIGNyZWF0ZUF1dGhFbmRwb2ludCwgZ2V0U2Vzc2lvbkZyb21DdHgsIEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHBhcnNlcl9kZWZhdWx0IH0gZnJvbSAnLi9jaHVuay1IVkhOM1kyTC5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZUlkIH0gZnJvbSAnLi9jaHVuay1LTERGQkxZTC5qcyc7XG5pbXBvcnQgeyBnZXREYXRlIH0gZnJvbSAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICcuL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbi8vIHNyYy91dGlscy9zaGltLnRzXG52YXIgc2hpbUNvbnRleHQgPSAob3JpZ2luYWxPYmplY3QsIG5ld0NvbnRleHQpID0+IHtcbiAgY29uc3Qgc2hpbW1lZE9iaiA9IHt9O1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhvcmlnaW5hbE9iamVjdCkpIHtcbiAgICBzaGltbWVkT2JqW2tleV0gPSAoY3R4KSA9PiB7XG4gICAgICByZXR1cm4gdmFsdWUoe1xuICAgICAgICAuLi5jdHgsXG4gICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAuLi5uZXdDb250ZXh0LFxuICAgICAgICAgIC4uLmN0eC5jb250ZXh0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gICAgc2hpbW1lZE9ialtrZXldLnBhdGggPSB2YWx1ZS5wYXRoO1xuICAgIHNoaW1tZWRPYmpba2V5XS5tZXRob2QgPSB2YWx1ZS5tZXRob2Q7XG4gICAgc2hpbW1lZE9ialtrZXldLm9wdGlvbnMgPSB2YWx1ZS5vcHRpb25zO1xuICAgIHNoaW1tZWRPYmpba2V5XS5oZWFkZXJzID0gdmFsdWUuaGVhZGVycztcbiAgfVxuICByZXR1cm4gc2hpbW1lZE9iajtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9hZGFwdGVyLnRzXG52YXIgZ2V0T3JnQWRhcHRlciA9IChjb250ZXh0LCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGFkYXB0ZXIgPSBjb250ZXh0LmFkYXB0ZXI7XG4gIHJldHVybiB7XG4gICAgZmluZE9yZ2FuaXphdGlvbkJ5U2x1ZzogYXN5bmMgKHNsdWcpID0+IHtcbiAgICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJvcmdhbml6YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJzbHVnXCIsXG4gICAgICAgICAgICB2YWx1ZTogc2x1Z1xuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gb3JnYW5pemF0aW9uMjtcbiAgICB9LFxuICAgIGNyZWF0ZU9yZ2FuaXphdGlvbjogYXN5bmMgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgLi4uZGF0YS5vcmdhbml6YXRpb24sXG4gICAgICAgICAgbWV0YWRhdGE6IGRhdGEub3JnYW5pemF0aW9uLm1ldGFkYXRhID8gSlNPTi5zdHJpbmdpZnkoZGF0YS5vcmdhbml6YXRpb24ubWV0YWRhdGEpIDogdm9pZCAwXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBvcmdhbml6YXRpb24yLmlkLFxuICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VyLmlkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgcm9sZTogb3B0aW9ucz8uY3JlYXRvclJvbGUgfHwgXCJvd25lclwiXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ub3JnYW5pemF0aW9uMixcbiAgICAgICAgbWV0YWRhdGE6IG9yZ2FuaXphdGlvbjIubWV0YWRhdGEgPyBKU09OLnBhcnNlKG9yZ2FuaXphdGlvbjIubWV0YWRhdGEpIDogdm9pZCAwLFxuICAgICAgICBtZW1iZXJzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4ubWVtYmVyLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogZGF0YS51c2VyLmlkLFxuICAgICAgICAgICAgICBuYW1lOiBkYXRhLnVzZXIubmFtZSxcbiAgICAgICAgICAgICAgZW1haWw6IGRhdGEudXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgaW1hZ2U6IGRhdGEudXNlci5pbWFnZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfTtcbiAgICB9LFxuICAgIGZpbmRNZW1iZXJCeUVtYWlsOiBhc3luYyAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGEuZW1haWxcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwib3JnYW5pemF0aW9uSWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBkYXRhLm9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghbWVtYmVyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ubWVtYmVyLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kTWVtYmVyQnlPcmdJZDogYXN5bmMgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IFttZW1iZXIsIHVzZXJdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogZGF0YS51c2VySWRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZpZWxkOiBcIm9yZ2FuaXphdGlvbklkXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBkYXRhLm9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KSxcbiAgICAgICAgYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGRhdGEudXNlcklkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KVxuICAgICAgXSk7XG4gICAgICBpZiAoIXVzZXIgfHwgIW1lbWJlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLm1lbWJlcixcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgZmluZE1lbWJlckJ5SWQ6IGFzeW5jIChtZW1iZXJJZCkgPT4ge1xuICAgICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBtZW1iZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIW1lbWJlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBtZW1iZXIudXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLm1lbWJlcixcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgY3JlYXRlTWVtYmVyOiBhc3luYyAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgZGF0YVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWVtYmVyO1xuICAgIH0sXG4gICAgdXBkYXRlTWVtYmVyOiBhc3luYyAobWVtYmVySWQsIHJvbGUyKSA9PiB7XG4gICAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLnVwZGF0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogbWVtYmVySWRcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIHJvbGU6IHJvbGUyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1lbWJlcjtcbiAgICB9LFxuICAgIGRlbGV0ZU1lbWJlcjogYXN5bmMgKG1lbWJlcklkKSA9PiB7XG4gICAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogbWVtYmVySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1lbWJlcjtcbiAgICB9LFxuICAgIHVwZGF0ZU9yZ2FuaXphdGlvbjogYXN5bmMgKG9yZ2FuaXphdGlvbklkLCBkYXRhKSA9PiB7XG4gICAgICBjb25zdCBvcmdhbml6YXRpb24yID0gYXdhaXQgYWRhcHRlci51cGRhdGUoe1xuICAgICAgICBtb2RlbDogXCJvcmdhbml6YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IG9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIG1ldGFkYXRhOiB0eXBlb2YgZGF0YS5tZXRhZGF0YSA9PT0gXCJvYmplY3RcIiA/IEpTT04uc3RyaW5naWZ5KGRhdGEubWV0YWRhdGEpIDogZGF0YS5tZXRhZGF0YVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghb3JnYW5pemF0aW9uMikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLm9yZ2FuaXphdGlvbjIsXG4gICAgICAgIG1ldGFkYXRhOiBvcmdhbml6YXRpb24yLm1ldGFkYXRhID8gcGFyc2VyX2RlZmF1bHQob3JnYW5pemF0aW9uMi5tZXRhZGF0YSkgOiB2b2lkIDBcbiAgICAgIH07XG4gICAgfSxcbiAgICBkZWxldGVPcmdhbml6YXRpb246IGFzeW5jIChvcmdhbml6YXRpb25JZCkgPT4ge1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJvcmdhbml6YXRpb25JZFwiLFxuICAgICAgICAgICAgdmFsdWU6IG9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwiaW52aXRhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcIm9yZ2FuaXphdGlvbklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogb3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJvcmdhbml6YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IG9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBvcmdhbml6YXRpb25JZDtcbiAgICB9LFxuICAgIHNldEFjdGl2ZU9yZ2FuaXphdGlvbjogYXN5bmMgKHNlc3Npb25Ub2tlbiwgb3JnYW5pemF0aW9uSWQpID0+IHtcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVTZXNzaW9uKFxuICAgICAgICBzZXNzaW9uVG9rZW4sXG4gICAgICAgIHtcbiAgICAgICAgICBhY3RpdmVPcmdhbml6YXRpb25JZDogb3JnYW5pemF0aW9uSWRcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0sXG4gICAgZmluZE9yZ2FuaXphdGlvbkJ5SWQ6IGFzeW5jIChvcmdhbml6YXRpb25JZCkgPT4ge1xuICAgICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogb3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG9yZ2FuaXphdGlvbjI7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBAcmVxdWlyZXMgZGJcbiAgICAgKi9cbiAgICBmaW5kRnVsbE9yZ2FuaXphdGlvbjogYXN5bmMgKHtcbiAgICAgIG9yZ2FuaXphdGlvbklkLFxuICAgICAgaXNTbHVnXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3Qgb3JnID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwib3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbeyBmaWVsZDogaXNTbHVnID8gXCJzbHVnXCIgOiBcImlkXCIsIHZhbHVlOiBvcmdhbml6YXRpb25JZCB9XVxuICAgICAgfSk7XG4gICAgICBpZiAoIW9yZykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFtpbnZpdGF0aW9ucywgbWVtYmVyc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICAgIG1vZGVsOiBcImludml0YXRpb25cIixcbiAgICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwib3JnYW5pemF0aW9uSWRcIiwgdmFsdWU6IG9yZy5pZCB9XVxuICAgICAgICB9KSxcbiAgICAgICAgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgICAgbW9kZWw6IFwibWVtYmVyXCIsXG4gICAgICAgICAgd2hlcmU6IFt7IGZpZWxkOiBcIm9yZ2FuaXphdGlvbklkXCIsIHZhbHVlOiBvcmcuaWQgfV1cbiAgICAgICAgfSlcbiAgICAgIF0pO1xuICAgICAgaWYgKCFvcmcpIHJldHVybiBudWxsO1xuICAgICAgY29uc3QgdXNlcklkcyA9IG1lbWJlcnMubWFwKChtZW1iZXIpID0+IG1lbWJlci51c2VySWQpO1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwiaWRcIiwgdmFsdWU6IHVzZXJJZHMsIG9wZXJhdG9yOiBcImluXCIgfV1cbiAgICAgIH0pO1xuICAgICAgY29uc3QgdXNlck1hcCA9IG5ldyBNYXAodXNlcnMubWFwKCh1c2VyKSA9PiBbdXNlci5pZCwgdXNlcl0pKTtcbiAgICAgIGNvbnN0IG1lbWJlcnNXaXRoVXNlcnMgPSBtZW1iZXJzLm1hcCgobWVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSB1c2VyTWFwLmdldChtZW1iZXIudXNlcklkKTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIFwiVW5leHBlY3RlZCBlcnJvcjogVXNlciBub3QgZm91bmQgZm9yIG1lbWJlclwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm1lbWJlcixcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2VcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLm9yZyxcbiAgICAgICAgaW52aXRhdGlvbnMsXG4gICAgICAgIG1lbWJlcnM6IG1lbWJlcnNXaXRoVXNlcnNcbiAgICAgIH07XG4gICAgfSxcbiAgICBsaXN0T3JnYW5pemF0aW9uczogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgY29uc3QgbWVtYmVycyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJtZW1iZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFtZW1iZXJzIHx8IG1lbWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG9yZ2FuaXphdGlvbklkcyA9IG1lbWJlcnMubWFwKChtZW1iZXIpID0+IG1lbWJlci5vcmdhbml6YXRpb25JZCk7XG4gICAgICBjb25zdCBvcmdhbml6YXRpb25zID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogb3JnYW5pemF0aW9uSWRzLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFwiaW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gb3JnYW5pemF0aW9ucztcbiAgICB9LFxuICAgIGNyZWF0ZUludml0YXRpb246IGFzeW5jICh7XG4gICAgICBpbnZpdGF0aW9uLFxuICAgICAgdXNlclxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IGRlZmF1bHRFeHBpcmF0aW9uID0gMWUzICogNjAgKiA2MCAqIDQ4O1xuICAgICAgY29uc3QgZXhwaXJlc0F0ID0gZ2V0RGF0ZShcbiAgICAgICAgb3B0aW9ucz8uaW52aXRhdGlvbkV4cGlyZXNJbiB8fCBkZWZhdWx0RXhwaXJhdGlvblxuICAgICAgKTtcbiAgICAgIGNvbnN0IGludml0ZSA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgbW9kZWw6IFwiaW52aXRhdGlvblwiLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgZW1haWw6IGludml0YXRpb24uZW1haWwsXG4gICAgICAgICAgcm9sZTogaW52aXRhdGlvbi5yb2xlLFxuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiBpbnZpdGF0aW9uLm9yZ2FuaXphdGlvbklkLFxuICAgICAgICAgIHN0YXR1czogXCJwZW5kaW5nXCIsXG4gICAgICAgICAgZXhwaXJlc0F0LFxuICAgICAgICAgIGludml0ZXJJZDogdXNlci5pZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBpbnZpdGU7XG4gICAgfSxcbiAgICBmaW5kSW52aXRhdGlvbkJ5SWQ6IGFzeW5jIChpZCkgPT4ge1xuICAgICAgY29uc3QgaW52aXRhdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcImludml0YXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBpbnZpdGF0aW9uO1xuICAgIH0sXG4gICAgZmluZFBlbmRpbmdJbnZpdGF0aW9uOiBhc3luYyAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgaW52aXRhdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJpbnZpdGF0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIixcbiAgICAgICAgICAgIHZhbHVlOiBkYXRhLmVtYWlsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJvcmdhbml6YXRpb25JZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGEub3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInN0YXR1c1wiLFxuICAgICAgICAgICAgdmFsdWU6IFwicGVuZGluZ1wiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBpbnZpdGF0aW9uLmZpbHRlcihcbiAgICAgICAgKGludml0ZSkgPT4gbmV3IERhdGUoaW52aXRlLmV4cGlyZXNBdCkgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgKTtcbiAgICB9LFxuICAgIHVwZGF0ZUludml0YXRpb246IGFzeW5jIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci51cGRhdGUoe1xuICAgICAgICBtb2RlbDogXCJpbnZpdGF0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBkYXRhLmludml0YXRpb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgc3RhdHVzOiBkYXRhLnN0YXR1c1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBpbnZpdGF0aW9uO1xuICAgIH1cbiAgfTtcbn07XG52YXIgb3JnTWlkZGxld2FyZSA9IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgcmV0dXJuIHt9O1xufSk7XG52YXIgb3JnU2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShcbiAge1xuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHNlc3Npb25cbiAgICB9O1xuICB9XG4pO1xudmFyIHJvbGUgPSB6LnN0cmluZygpO1xudmFyIGludml0YXRpb25TdGF0dXMgPSB6LmVudW0oW1wicGVuZGluZ1wiLCBcImFjY2VwdGVkXCIsIFwicmVqZWN0ZWRcIiwgXCJjYW5jZWxlZFwiXSkuZGVmYXVsdChcInBlbmRpbmdcIik7XG56Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLmRlZmF1bHQoZ2VuZXJhdGVJZCksXG4gIG5hbWU6IHouc3RyaW5nKCksXG4gIHNsdWc6IHouc3RyaW5nKCksXG4gIGxvZ286IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICBtZXRhZGF0YTogei5yZWNvcmQoei5zdHJpbmcoKSkub3Ioei5zdHJpbmcoKS50cmFuc2Zvcm0oKHYpID0+IEpTT04ucGFyc2UodikpKS5udWxsaXNoKCksXG4gIGNyZWF0ZWRBdDogei5kYXRlKClcbn0pO1xuei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKS5kZWZhdWx0KGdlbmVyYXRlSWQpLFxuICBvcmdhbml6YXRpb25JZDogei5zdHJpbmcoKSxcbiAgdXNlcklkOiB6LnN0cmluZygpLFxuICByb2xlLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpXG59KTtcbnoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCkuZGVmYXVsdChnZW5lcmF0ZUlkKSxcbiAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKCksXG4gIGVtYWlsOiB6LnN0cmluZygpLFxuICByb2xlLFxuICBzdGF0dXM6IGludml0YXRpb25TdGF0dXMsXG4gIC8qKlxuICAgKiBUaGUgaWQgb2YgdGhlIHVzZXIgd2hvIGludml0ZWQgdGhlIHVzZXIuXG4gICAqL1xuICBpbnZpdGVySWQ6IHouc3RyaW5nKCksXG4gIGV4cGlyZXNBdDogei5kYXRlKClcbn0pO1xuXG4vLyBzcmMvcGx1Z2lucy9vcmdhbml6YXRpb24vZXJyb3ItY29kZXMudHNcbnZhciBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMgPSB7XG4gIFlPVV9BUkVfTk9UX0FMTE9XRURfVE9fQ1JFQVRFX0FfTkVXX09SR0FOSVpBVElPTjogXCJZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGNyZWF0ZSBhIG5ldyBvcmdhbml6YXRpb25cIixcbiAgWU9VX0hBVkVfUkVBQ0hFRF9USEVfTUFYSU1VTV9OVU1CRVJfT0ZfT1JHQU5JWkFUSU9OUzogXCJZb3UgaGF2ZSByZWFjaGVkIHRoZSBtYXhpbXVtIG51bWJlciBvZiBvcmdhbml6YXRpb25zXCIsXG4gIE9SR0FOSVpBVElPTl9BTFJFQURZX0VYSVNUUzogXCJPcmdhbml6YXRpb24gYWxyZWFkeSBleGlzdHNcIixcbiAgT1JHQU5JWkFUSU9OX05PVF9GT1VORDogXCJPcmdhbml6YXRpb24gbm90IGZvdW5kXCIsXG4gIFVTRVJfSVNfTk9UX0FfTUVNQkVSX09GX1RIRV9PUkdBTklaQVRJT046IFwiVXNlciBpcyBub3QgYSBtZW1iZXIgb2YgdGhlIG9yZ2FuaXphdGlvblwiLFxuICBZT1VfQVJFX05PVF9BTExPV0VEX1RPX1VQREFURV9USElTX09SR0FOSVpBVElPTjogXCJZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIHVwZGF0ZSB0aGlzIG9yZ2FuaXphdGlvblwiLFxuICBZT1VfQVJFX05PVF9BTExPV0VEX1RPX0RFTEVURV9USElTX09SR0FOSVpBVElPTjogXCJZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGRlbGV0ZSB0aGlzIG9yZ2FuaXphdGlvblwiLFxuICBOT19BQ1RJVkVfT1JHQU5JWkFUSU9OOiBcIk5vIGFjdGl2ZSBvcmdhbml6YXRpb25cIixcbiAgVVNFUl9JU19BTFJFQURZX0FfTUVNQkVSX09GX1RISVNfT1JHQU5JWkFUSU9OOiBcIlVzZXIgaXMgYWxyZWFkeSBhIG1lbWJlciBvZiB0aGlzIG9yZ2FuaXphdGlvblwiLFxuICBNRU1CRVJfTk9UX0ZPVU5EOiBcIk1lbWJlciBub3QgZm91bmRcIixcbiAgUk9MRV9OT1RfRk9VTkQ6IFwiUm9sZSBub3QgZm91bmRcIixcbiAgWU9VX0NBTk5PVF9MRUFWRV9USEVfT1JHQU5JWkFUSU9OX0FTX1RIRV9PTkxZX09XTkVSOiBcIllvdSBjYW5ub3QgbGVhdmUgdGhlIG9yZ2FuaXphdGlvbiBhcyB0aGUgb25seSBvd25lclwiLFxuICBZT1VfQVJFX05PVF9BTExPV0VEX1RPX0RFTEVURV9USElTX01FTUJFUjogXCJZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGRlbGV0ZSB0aGlzIG1lbWJlclwiLFxuICBZT1VfQVJFX05PVF9BTExPV0VEX1RPX0lOVklURV9VU0VSU19UT19USElTX09SR0FOSVpBVElPTjogXCJZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGludml0ZSB1c2VycyB0byB0aGlzIG9yZ2FuaXphdGlvblwiLFxuICBVU0VSX0lTX0FMUkVBRFlfSU5WSVRFRF9UT19USElTX09SR0FOSVpBVElPTjogXCJVc2VyIGlzIGFscmVhZHkgaW52aXRlZCB0byB0aGlzIG9yZ2FuaXphdGlvblwiLFxuICBJTlZJVEFUSU9OX05PVF9GT1VORDogXCJJbnZpdGF0aW9uIG5vdCBmb3VuZFwiLFxuICBZT1VfQVJFX05PVF9USEVfUkVDSVBJRU5UX09GX1RIRV9JTlZJVEFUSU9OOiBcIllvdSBhcmUgbm90IHRoZSByZWNpcGllbnQgb2YgdGhlIGludml0YXRpb25cIixcbiAgWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19DQU5DRUxfVEhJU19JTlZJVEFUSU9OOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gY2FuY2VsIHRoaXMgaW52aXRhdGlvblwiLFxuICBJTlZJVEVSX0lTX05PX0xPTkdFUl9BX01FTUJFUl9PRl9USEVfT1JHQU5JWkFUSU9OOiBcIkludml0ZXIgaXMgbm8gbG9uZ2VyIGEgbWVtYmVyIG9mIHRoZSBvcmdhbml6YXRpb25cIixcbiAgWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19JTlZJVEVfVVNFUl9XSVRIX1RISVNfUk9MRTogXCJ5b3UgYXJlIG5vdCBhbGxvd2VkIHRvIGludml0ZSB1c2VyIHdpdGggdGhpcyByb2xlXCJcbn07XG5cbi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9yb3V0ZXMvY3J1ZC1pbnZpdGVzLnRzXG52YXIgY3JlYXRlSW52aXRhdGlvbiA9IChvcHRpb24pID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2ludml0ZS1tZW1iZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbb3JnTWlkZGxld2FyZSwgb3JnU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyIHRvIGludml0ZVwiXG4gICAgICB9KSxcbiAgICAgIHJvbGU6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHJvbGUgdG8gYXNzaWduIHRvIHRoZSB1c2VyXCJcbiAgICAgIH0pLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9yZ2FuaXphdGlvbiBJRCB0byBpbnZpdGUgdGhlIHVzZXIgdG9cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIHJlc2VuZDogei5ib29sZWFuKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVzZW5kIHRoZSBpbnZpdGF0aW9uIGVtYWlsLCBpZiB0aGUgdXNlciBpcyBhbHJlYWR5IGludml0ZWRcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkludml0ZSBhIHVzZXIgdG8gYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcm9sZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGludml0ZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgXCJyb2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwib3JnYW5pemF0aW9uSWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJpbnZpdGVySWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzdGF0dXNcIixcbiAgICAgICAgICAgICAgICAgICAgXCJleHBpcmVzQXRcIlxuICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3JnT3B0aW9ucy5zZW5kSW52aXRhdGlvbkVtYWlsKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIud2FybihcbiAgICAgICAgXCJJbnZpdGF0aW9uIGVtYWlsIGlzIG5vdCBlbmFibGVkLiBQYXNzIGBzZW5kSW52aXRhdGlvbkVtYWlsYCB0byB0aGUgcGx1Z2luIG9wdGlvbnMgdG8gZW5hYmxlIGl0LlwiXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkludml0YXRpb24gZW1haWwgaXMgbm90IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IG9yZ2FuaXphdGlvbklkID0gY3R4LmJvZHkub3JnYW5pemF0aW9uSWQgfHwgc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkO1xuICAgIGlmICghb3JnYW5pemF0aW9uSWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk9SR0FOSVpBVElPTl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkXG4gICAgfSk7XG4gICAgaWYgKCFtZW1iZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk1FTUJFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCByb2xlMiA9IGN0eC5jb250ZXh0LnJvbGVzW21lbWJlci5yb2xlXTtcbiAgICBpZiAoIXJvbGUyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ST0xFX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhbkludml0ZSA9IHJvbGUyLmF1dGhvcml6ZSh7XG4gICAgICBpbnZpdGF0aW9uOiBbXCJjcmVhdGVcIl1cbiAgICB9KTtcbiAgICBpZiAoY2FuSW52aXRlLmVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19JTlZJVEVfVVNFUlNfVE9fVEhJU19PUkdBTklaQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjcmVhdG9yUm9sZSA9IGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMuY3JlYXRvclJvbGUgfHwgXCJvd25lclwiO1xuICAgIGlmIChtZW1iZXIucm9sZSAhPT0gY3JlYXRvclJvbGUgJiYgY3R4LmJvZHkucm9sZSA9PT0gY3JlYXRvclJvbGUpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9BTExPV0VEX1RPX0lOVklURV9VU0VSX1dJVEhfVEhJU19ST0xFXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWxyZWFkeU1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5RW1haWwoe1xuICAgICAgZW1haWw6IGN0eC5ib2R5LmVtYWlsLFxuICAgICAgb3JnYW5pemF0aW9uSWRcbiAgICB9KTtcbiAgICBpZiAoYWxyZWFkeU1lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuVVNFUl9JU19BTFJFQURZX0FfTUVNQkVSX09GX1RISVNfT1JHQU5JWkFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWxyZWFkeUludml0ZWQgPSBhd2FpdCBhZGFwdGVyLmZpbmRQZW5kaW5nSW52aXRhdGlvbih7XG4gICAgICBlbWFpbDogY3R4LmJvZHkuZW1haWwsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmIChhbHJlYWR5SW52aXRlZC5sZW5ndGggJiYgIWN0eC5ib2R5LnJlc2VuZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuVVNFUl9JU19BTFJFQURZX0lOVklURURfVE9fVEhJU19PUkdBTklaQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci5jcmVhdGVJbnZpdGF0aW9uKHtcbiAgICAgIGludml0YXRpb246IHtcbiAgICAgICAgcm9sZTogY3R4LmJvZHkucm9sZSxcbiAgICAgICAgZW1haWw6IGN0eC5ib2R5LmVtYWlsLFxuICAgICAgICBvcmdhbml6YXRpb25JZFxuICAgICAgfSxcbiAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgIH0pO1xuICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPcmdhbml6YXRpb25CeUlkKG9yZ2FuaXphdGlvbklkKTtcbiAgICBpZiAoIW9yZ2FuaXphdGlvbjIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk9SR0FOSVpBVElPTl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5vcmdPcHRpb25zLnNlbmRJbnZpdGF0aW9uRW1haWw/LihcbiAgICAgIHtcbiAgICAgICAgaWQ6IGludml0YXRpb24uaWQsXG4gICAgICAgIHJvbGU6IGludml0YXRpb24ucm9sZSxcbiAgICAgICAgZW1haWw6IGludml0YXRpb24uZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgb3JnYW5pemF0aW9uOiBvcmdhbml6YXRpb24yLFxuICAgICAgICBpbnZpdGVyOiB7XG4gICAgICAgICAgLi4ubWVtYmVyLFxuICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY3R4LnJlcXVlc3RcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbihpbnZpdGF0aW9uKTtcbiAgfVxuKTtcbnZhciBhY2NlcHRJbnZpdGF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vYWNjZXB0LWludml0YXRpb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgaW52aXRhdGlvbklkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBJRCBvZiB0aGUgaW52aXRhdGlvbiB0byBhY2NlcHRcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQWNjZXB0IGFuIGludml0YXRpb24gdG8gYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGludml0YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBpbnZpdGF0aW9uID0gYXdhaXQgYWRhcHRlci5maW5kSW52aXRhdGlvbkJ5SWQoY3R4LmJvZHkuaW52aXRhdGlvbklkKTtcbiAgICBpZiAoIWludml0YXRpb24gfHwgaW52aXRhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSB8fCBpbnZpdGF0aW9uLnN0YXR1cyAhPT0gXCJwZW5kaW5nXCIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLklOVklUQVRJT05fTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGludml0YXRpb24uZW1haWwgIT09IHNlc3Npb24udXNlci5lbWFpbCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9BUkVfTk9UX1RIRV9SRUNJUElFTlRfT0ZfVEhFX0lOVklUQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NlcHRlZEkgPSBhd2FpdCBhZGFwdGVyLnVwZGF0ZUludml0YXRpb24oe1xuICAgICAgaW52aXRhdGlvbklkOiBjdHguYm9keS5pbnZpdGF0aW9uSWQsXG4gICAgICBzdGF0dXM6IFwiYWNjZXB0ZWRcIlxuICAgIH0pO1xuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlTWVtYmVyKHtcbiAgICAgIG9yZ2FuaXphdGlvbklkOiBpbnZpdGF0aW9uLm9yZ2FuaXphdGlvbklkLFxuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICByb2xlOiBpbnZpdGF0aW9uLnJvbGUsXG4gICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgfSk7XG4gICAgYXdhaXQgYWRhcHRlci5zZXRBY3RpdmVPcmdhbml6YXRpb24oXG4gICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICBpbnZpdGF0aW9uLm9yZ2FuaXphdGlvbklkXG4gICAgKTtcbiAgICBpZiAoIWFjY2VwdGVkSSkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuSU5WSVRBVElPTl9OT1RfRk9VTkRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBpbnZpdGF0aW9uOiBhY2NlcHRlZEksXG4gICAgICBtZW1iZXJcbiAgICB9KTtcbiAgfVxuKTtcbnZhciByZWplY3RJbnZpdGF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vcmVqZWN0LWludml0YXRpb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgaW52aXRhdGlvbklkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBJRCBvZiB0aGUgaW52aXRhdGlvbiB0byByZWplY3RcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVqZWN0IGFuIGludml0YXRpb24gdG8gYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGludml0YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibnVsbFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgaW52aXRhdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZEludml0YXRpb25CeUlkKGN0eC5ib2R5Lmludml0YXRpb25JZCk7XG4gICAgaWYgKCFpbnZpdGF0aW9uIHx8IGludml0YXRpb24uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkgfHwgaW52aXRhdGlvbi5zdGF0dXMgIT09IFwicGVuZGluZ1wiKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiSW52aXRhdGlvbiBub3QgZm91bmQhXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaW52aXRhdGlvbi5lbWFpbCAhPT0gc2Vzc2lvbi51c2VyLmVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfVEhFX1JFQ0lQSUVOVF9PRl9USEVfSU5WSVRBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJlamVjdGVkSSA9IGF3YWl0IGFkYXB0ZXIudXBkYXRlSW52aXRhdGlvbih7XG4gICAgICBpbnZpdGF0aW9uSWQ6IGN0eC5ib2R5Lmludml0YXRpb25JZCxcbiAgICAgIHN0YXR1czogXCJyZWplY3RlZFwiXG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIGludml0YXRpb246IHJlamVjdGVkSSxcbiAgICAgIG1lbWJlcjogbnVsbFxuICAgIH0pO1xuICB9XG4pO1xudmFyIGNhbmNlbEludml0YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9jYW5jZWwtaW52aXRhdGlvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBpbnZpdGF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIElEIG9mIHRoZSBpbnZpdGF0aW9uIHRvIGNhbmNlbFwiXG4gICAgICB9KVxuICAgIH0pLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmUsIG9yZ1Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBvcGVuYXBpOiB7XG4gICAgICBkZXNjcmlwdGlvbjogXCJDYW5jZWwgYW4gaW52aXRhdGlvbiB0byBhbiBvcmdhbml6YXRpb25cIixcbiAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgaW52aXRhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IGludml0YXRpb24gPSBhd2FpdCBhZGFwdGVyLmZpbmRJbnZpdGF0aW9uQnlJZChjdHguYm9keS5pbnZpdGF0aW9uSWQpO1xuICAgIGlmICghaW52aXRhdGlvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuSU5WSVRBVElPTl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRNZW1iZXJCeU9yZ0lkKHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IGludml0YXRpb24ub3JnYW5pemF0aW9uSWRcbiAgICB9KTtcbiAgICBpZiAoIW1lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTUVNQkVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhbkNhbmNlbCA9IGN0eC5jb250ZXh0LnJvbGVzW21lbWJlci5yb2xlXS5hdXRob3JpemUoe1xuICAgICAgaW52aXRhdGlvbjogW1wiY2FuY2VsXCJdXG4gICAgfSk7XG4gICAgaWYgKGNhbkNhbmNlbC5lcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9BUkVfTk9UX0FMTE9XRURfVE9fQ0FOQ0VMX1RISVNfSU5WSVRBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhbmNlbGVkSSA9IGF3YWl0IGFkYXB0ZXIudXBkYXRlSW52aXRhdGlvbih7XG4gICAgICBpbnZpdGF0aW9uSWQ6IGN0eC5ib2R5Lmludml0YXRpb25JZCxcbiAgICAgIHN0YXR1czogXCJjYW5jZWxlZFwiXG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKGNhbmNlbGVkSSk7XG4gIH1cbik7XG52YXIgZ2V0SW52aXRhdGlvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2dldC1pbnZpdGF0aW9uXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbb3JnTWlkZGxld2FyZV0sXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIGlkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBJRCBvZiB0aGUgaW52aXRhdGlvbiB0byBnZXRcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgYW4gaW52aXRhdGlvbiBieSBJRFwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJvbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpbnZpdGVySWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25OYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcmdhbml6YXRpb25TbHVnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpbnZpdGVyRW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgXCJyb2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwib3JnYW5pemF0aW9uSWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJpbnZpdGVySWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzdGF0dXNcIixcbiAgICAgICAgICAgICAgICAgICAgXCJleHBpcmVzQXRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJvcmdhbml6YXRpb25OYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgIFwib3JnYW5pemF0aW9uU2x1Z1wiLFxuICAgICAgICAgICAgICAgICAgICBcImludml0ZXJFbWFpbFwiXG4gICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIk5vdCBhdXRoZW50aWNhdGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgaW52aXRhdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZEludml0YXRpb25CeUlkKGN0eC5xdWVyeS5pZCk7XG4gICAgaWYgKCFpbnZpdGF0aW9uIHx8IGludml0YXRpb24uc3RhdHVzICE9PSBcInBlbmRpbmdcIiB8fCBpbnZpdGF0aW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiSW52aXRhdGlvbiBub3QgZm91bmQhXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaW52aXRhdGlvbi5lbWFpbCAhPT0gc2Vzc2lvbi51c2VyLmVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfVEhFX1JFQ0lQSUVOVF9PRl9USEVfSU5WSVRBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPcmdhbml6YXRpb25CeUlkKFxuICAgICAgaW52aXRhdGlvbi5vcmdhbml6YXRpb25JZFxuICAgICk7XG4gICAgaWYgKCFvcmdhbml6YXRpb24yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5PUkdBTklaQVRJT05fTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IGludml0YXRpb24uaW52aXRlcklkLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IGludml0YXRpb24ub3JnYW5pemF0aW9uSWRcbiAgICB9KTtcbiAgICBpZiAoIW1lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuSU5WSVRFUl9JU19OT19MT05HRVJfQV9NRU1CRVJfT0ZfVEhFX09SR0FOSVpBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAuLi5pbnZpdGF0aW9uLFxuICAgICAgb3JnYW5pemF0aW9uTmFtZTogb3JnYW5pemF0aW9uMi5uYW1lLFxuICAgICAgb3JnYW5pemF0aW9uU2x1Zzogb3JnYW5pemF0aW9uMi5zbHVnLFxuICAgICAgaW52aXRlckVtYWlsOiBtZW1iZXIudXNlci5lbWFpbFxuICAgIH0pO1xuICB9XG4pO1xudmFyIGFkZE1lbWJlciA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2FkZC1tZW1iZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgdXNlcklkOiB6LnN0cmluZygpLFxuICAgICAgcm9sZTogei5zdHJpbmcoKSxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgU0VSVkVSX09OTFk6IHRydWVcbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmJvZHkudXNlcklkID8gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KS5jYXRjaCgoZSkgPT4gbnVsbCkgOiBudWxsO1xuICAgIGNvbnN0IG9yZ0lkID0gY3R4LmJvZHkub3JnYW5pemF0aW9uSWQgfHwgc2Vzc2lvbj8uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICBpZiAoIW9yZ0lkKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5OT19BQ1RJVkVfT1JHQU5JWkFUSU9OXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoXG4gICAgICBjdHguYm9keS51c2VySWRcbiAgICApO1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWxyZWFkeU1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5RW1haWwoe1xuICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICBvcmdhbml6YXRpb25JZDogb3JnSWRcbiAgICB9KTtcbiAgICBpZiAoYWxyZWFkeU1lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuVVNFUl9JU19BTFJFQURZX0FfTUVNQkVSX09GX1RISVNfT1JHQU5JWkFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3JlYXRlZE1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuY3JlYXRlTWVtYmVyKHtcbiAgICAgIGlkOiBnZW5lcmF0ZUlkKCksXG4gICAgICBvcmdhbml6YXRpb25JZDogb3JnSWQsXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICByb2xlOiBjdHguYm9keS5yb2xlLFxuICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgIH0pO1xuICAgIHJldHVybiBjdHguanNvbihjcmVhdGVkTWVtYmVyKTtcbiAgfVxuKTtcbnZhciByZW1vdmVNZW1iZXIgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9yZW1vdmUtbWVtYmVyXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG1lbWJlcklkT3JFbWFpbDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgSUQgb3IgZW1haWwgb2YgdGhlIG1lbWJlciB0byByZW1vdmVcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIElmIG5vdCBwcm92aWRlZCwgdGhlIGFjdGl2ZSBvcmdhbml6YXRpb24gd2lsbCBiZSB1c2VkXG4gICAgICAgKi9cbiAgICAgIG9yZ2FuaXphdGlvbklkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBJRCBvZiB0aGUgb3JnYW5pemF0aW9uIHRvIHJlbW92ZSB0aGUgbWVtYmVyIGZyb20uIElmIG5vdCBwcm92aWRlZCwgdGhlIGFjdGl2ZSBvcmdhbml6YXRpb24gd2lsbCBiZSB1c2VkXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVtb3ZlIGEgbWVtYmVyIGZyb20gYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lbWJlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcImlkXCIsIFwidXNlcklkXCIsIFwib3JnYW5pemF0aW9uSWRcIiwgXCJyb2xlXCJdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wibWVtYmVyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25JZCB8fCBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTk9fQUNUSVZFX09SR0FOSVpBVElPTlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5NRU1CRVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgcm9sZTIgPSBjdHguY29udGV4dC5yb2xlc1ttZW1iZXIucm9sZV07XG4gICAgaWYgKCFyb2xlMikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuUk9MRV9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBpc0xlYXZpbmcgPSBzZXNzaW9uLnVzZXIuZW1haWwgPT09IGN0eC5ib2R5Lm1lbWJlcklkT3JFbWFpbCB8fCBtZW1iZXIuaWQgPT09IGN0eC5ib2R5Lm1lbWJlcklkT3JFbWFpbDtcbiAgICBjb25zdCBpc093bmVyTGVhdmluZyA9IGlzTGVhdmluZyAmJiBtZW1iZXIucm9sZSA9PT0gKGN0eC5jb250ZXh0Lm9yZ09wdGlvbnM/LmNyZWF0b3JSb2xlIHx8IFwib3duZXJcIik7XG4gICAgaWYgKGlzT3duZXJMZWF2aW5nKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQ0FOTk9UX0xFQVZFX1RIRV9PUkdBTklaQVRJT05fQVNfVEhFX09OTFlfT1dORVJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjYW5EZWxldGVNZW1iZXIgPSBpc0xlYXZpbmcgfHwgcm9sZTIuYXV0aG9yaXplKHtcbiAgICAgIG1lbWJlcjogW1wiZGVsZXRlXCJdXG4gICAgfSkuc3VjY2VzcztcbiAgICBpZiAoIWNhbkRlbGV0ZU1lbWJlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9BUkVfTk9UX0FMTE9XRURfVE9fREVMRVRFX1RISVNfTUVNQkVSXG4gICAgICB9KTtcbiAgICB9XG4gICAgbGV0IGV4aXN0aW5nID0gbnVsbDtcbiAgICBpZiAoY3R4LmJvZHkubWVtYmVySWRPckVtYWlsLmluY2x1ZGVzKFwiQFwiKSkge1xuICAgICAgZXhpc3RpbmcgPSBhd2FpdCBhZGFwdGVyLmZpbmRNZW1iZXJCeUVtYWlsKHtcbiAgICAgICAgZW1haWw6IGN0eC5ib2R5Lm1lbWJlcklkT3JFbWFpbCxcbiAgICAgICAgb3JnYW5pemF0aW9uSWRcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBleGlzdGluZyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5SWQoY3R4LmJvZHkubWVtYmVySWRPckVtYWlsKTtcbiAgICB9XG4gICAgaWYgKGV4aXN0aW5nPy5vcmdhbml6YXRpb25JZCAhPT0gb3JnYW5pemF0aW9uSWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk1FTUJFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZU1lbWJlcihleGlzdGluZy5pZCk7XG4gICAgaWYgKHNlc3Npb24udXNlci5pZCA9PT0gZXhpc3RpbmcudXNlcklkICYmIHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZCA9PT0gZXhpc3Rpbmcub3JnYW5pemF0aW9uSWQpIHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuc2V0QWN0aXZlT3JnYW5pemF0aW9uKHNlc3Npb24uc2Vzc2lvbi50b2tlbiwgbnVsbCk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBtZW1iZXI6IGV4aXN0aW5nXG4gICAgfSk7XG4gIH1cbik7XG52YXIgdXBkYXRlTWVtYmVyUm9sZSA9IChvcHRpb24pID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL3VwZGF0ZS1tZW1iZXItcm9sZVwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICByb2xlOiB6LnN0cmluZygpLFxuICAgICAgbWVtYmVySWQ6IHouc3RyaW5nKCksXG4gICAgICAvKipcbiAgICAgICAqIElmIG5vdCBwcm92aWRlZCwgdGhlIGFjdGl2ZSBvcmdhbml6YXRpb24gd2lsbCBiZSB1c2VkXG4gICAgICAgKi9cbiAgICAgIG9yZ2FuaXphdGlvbklkOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlLCBvcmdTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVXBkYXRlIHRoZSByb2xlIG9mIGEgbWVtYmVyIGluIGFuIG9yZ2FuaXphdGlvblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBtZW1iZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICByb2xlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJpZFwiLCBcInVzZXJJZFwiLCBcIm9yZ2FuaXphdGlvbklkXCIsIFwicm9sZVwiXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcIm1lbWJlclwiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IG9yZ2FuaXphdGlvbklkID0gY3R4LmJvZHkub3JnYW5pemF0aW9uSWQgfHwgc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkO1xuICAgIGlmICghb3JnYW5pemF0aW9uSWQpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk5PX0FDVElWRV9PUkdBTklaQVRJT05cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRNZW1iZXJCeU9yZ0lkKHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgb3JnYW5pemF0aW9uSWRcbiAgICB9KTtcbiAgICBpZiAoIW1lbWJlcikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTUVNQkVSX05PVF9GT1VORFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgcm9sZTIgPSBjdHguY29udGV4dC5yb2xlc1ttZW1iZXIucm9sZV07XG4gICAgaWYgKCFyb2xlMikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuUk9MRV9OT1RfRk9VTkRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhblVwZGF0ZU1lbWJlciA9IHJvbGUyLmF1dGhvcml6ZSh7XG4gICAgICBtZW1iZXI6IFtcInVwZGF0ZVwiXVxuICAgIH0pLmVycm9yIHx8IGN0eC5ib2R5LnJvbGUgPT09IFwib3duZXJcIiAmJiBtZW1iZXIucm9sZSAhPT0gXCJvd25lclwiO1xuICAgIGlmIChjYW5VcGRhdGVNZW1iZXIpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBcIllvdSBhcmUgbm90IGFsbG93ZWQgdG8gdXBkYXRlIHRoaXMgbWVtYmVyXCJcbiAgICAgICAgfSxcbiAgICAgICAgc3RhdHVzOiA0MDNcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1cGRhdGVkTWVtYmVyID0gYXdhaXQgYWRhcHRlci51cGRhdGVNZW1iZXIoXG4gICAgICBjdHguYm9keS5tZW1iZXJJZCxcbiAgICAgIGN0eC5ib2R5LnJvbGVcbiAgICApO1xuICAgIGlmICghdXBkYXRlZE1lbWJlcikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTUVNQkVSX05PVF9GT1VORFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHVwZGF0ZWRNZW1iZXIpO1xuICB9XG4pO1xudmFyIGdldEFjdGl2ZU1lbWJlciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2dldC1hY3RpdmUtbWVtYmVyXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbb3JnTWlkZGxld2FyZSwgb3JnU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkdldCB0aGUgYWN0aXZlIG1lbWJlciBpbiB0aGUgb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByb2xlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcImlkXCIsIFwidXNlcklkXCIsIFwib3JnYW5pemF0aW9uSWRcIiwgXCJyb2xlXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuTk9fQUNUSVZFX09SR0FOSVpBVElPTlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5NRU1CRVJfTk9UX0ZPVU5EXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24obWVtYmVyKTtcbiAgfVxuKTtcbnZhciBsZWF2ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL2xlYXZlXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG9yZ2FuaXphdGlvbklkOiB6LnN0cmluZygpXG4gICAgfSksXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmUsIG9yZ01pZGRsZXdhcmVdXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCk7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgYWRhcHRlci5maW5kTWVtYmVyQnlPcmdJZCh7XG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiBjdHguYm9keS5vcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5NRU1CRVJfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgaXNPd25lckxlYXZpbmcgPSBtZW1iZXIucm9sZSA9PT0gKGN0eC5jb250ZXh0Lm9yZ09wdGlvbnM/LmNyZWF0b3JSb2xlIHx8IFwib3duZXJcIik7XG4gICAgaWYgKGlzT3duZXJMZWF2aW5nKSB7XG4gICAgICBjb25zdCBtZW1iZXJzID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcIm1lbWJlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcIm9yZ2FuaXphdGlvbklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogY3R4LmJvZHkub3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgY29uc3Qgb3duZXJzID0gbWVtYmVycy5maWx0ZXIoXG4gICAgICAgIChtZW1iZXIyKSA9PiBtZW1iZXIyLnJvbGUgPT09IChjdHguY29udGV4dC5vcmdPcHRpb25zPy5jcmVhdG9yUm9sZSB8fCBcIm93bmVyXCIpXG4gICAgICApO1xuICAgICAgaWYgKG93bmVycy5sZW5ndGggPD0gMSkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLllPVV9DQU5OT1RfTEVBVkVfVEhFX09SR0FOSVpBVElPTl9BU19USEVfT05MWV9PV05FUlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgYXdhaXQgYWRhcHRlci5kZWxldGVNZW1iZXIobWVtYmVyLmlkKTtcbiAgICBpZiAoc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkID09PSBjdHguYm9keS5vcmdhbml6YXRpb25JZCkge1xuICAgICAgYXdhaXQgYWRhcHRlci5zZXRBY3RpdmVPcmdhbml6YXRpb24oc2Vzc2lvbi5zZXNzaW9uLnRva2VuLCBudWxsKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKG1lbWJlcik7XG4gIH1cbik7XG52YXIgY3JlYXRlT3JnYW5pemF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vY3JlYXRlXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG5hbWU6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIG9yZ2FuaXphdGlvblwiXG4gICAgICB9KSxcbiAgICAgIHNsdWc6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHNsdWcgb2YgdGhlIG9yZ2FuaXphdGlvblwiXG4gICAgICB9KSxcbiAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZCBvZiB0aGUgb3JnYW5pemF0aW9uIGNyZWF0b3IuIElmIG5vdCBwcm92aWRlZCwgdGhlIGN1cnJlbnQgdXNlciB3aWxsIGJlIHVzZWQuIFNob3VsZCBvbmx5IGJlIHVzZWQgYnkgYWRtaW5zIG9yIHdoZW4gY2FsbGVkIGJ5IHRoZSBzZXJ2ZXIuXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICBsb2dvOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBsb2dvIG9mIHRoZSBvcmdhbml6YXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIG1ldGFkYXRhOiB6LnJlY29yZCh6LnN0cmluZygpLCB6LmFueSgpLCB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBtZXRhZGF0YSBvZiB0aGUgb3JnYW5pemF0aW9uXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDcmVhdGUgYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIHRoYXQgd2FzIGNyZWF0ZWRcIixcbiAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvT3JnYW5pemF0aW9uXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAoIXNlc3Npb24gJiYgKGN0eC5yZXF1ZXN0IHx8IGN0eC5oZWFkZXJzKSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICBsZXQgdXNlciA9IHNlc3Npb24/LnVzZXIgfHwgbnVsbDtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIGlmICghY3R4LmJvZHkudXNlcklkKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICAgIH1cbiAgICAgIHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUlkKGN0eC5ib2R5LnVzZXJJZCk7XG4gICAgfVxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDFcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb25zID0gY3R4LmNvbnRleHQub3JnT3B0aW9ucztcbiAgICBjb25zdCBjYW5DcmVhdGVPcmcgPSB0eXBlb2Ygb3B0aW9ucz8uYWxsb3dVc2VyVG9DcmVhdGVPcmdhbml6YXRpb24gPT09IFwiZnVuY3Rpb25cIiA/IGF3YWl0IG9wdGlvbnMuYWxsb3dVc2VyVG9DcmVhdGVPcmdhbml6YXRpb24odXNlcikgOiBvcHRpb25zPy5hbGxvd1VzZXJUb0NyZWF0ZU9yZ2FuaXphdGlvbiA9PT0gdm9pZCAwID8gdHJ1ZSA6IG9wdGlvbnMuYWxsb3dVc2VyVG9DcmVhdGVPcmdhbml6YXRpb247XG4gICAgaWYgKCFjYW5DcmVhdGVPcmcpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9BTExPV0VEX1RPX0NSRUFURV9BX05FV19PUkdBTklaQVRJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgb3B0aW9ucyk7XG4gICAgY29uc3QgdXNlck9yZ2FuaXphdGlvbnMgPSBhd2FpdCBhZGFwdGVyLmxpc3RPcmdhbml6YXRpb25zKHVzZXIuaWQpO1xuICAgIGNvbnN0IGhhc1JlYWNoZWRPcmdMaW1pdCA9IHR5cGVvZiBvcHRpb25zLm9yZ2FuaXphdGlvbkxpbWl0ID09PSBcIm51bWJlclwiID8gdXNlck9yZ2FuaXphdGlvbnMubGVuZ3RoID49IG9wdGlvbnMub3JnYW5pemF0aW9uTGltaXQgOiB0eXBlb2Ygb3B0aW9ucy5vcmdhbml6YXRpb25MaW1pdCA9PT0gXCJmdW5jdGlvblwiID8gYXdhaXQgb3B0aW9ucy5vcmdhbml6YXRpb25MaW1pdCh1c2VyKSA6IGZhbHNlO1xuICAgIGlmIChoYXNSZWFjaGVkT3JnTGltaXQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfSEFWRV9SRUFDSEVEX1RIRV9NQVhJTVVNX05VTUJFUl9PRl9PUkdBTklaQVRJT05TXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgZXhpc3RpbmdPcmdhbml6YXRpb24gPSBhd2FpdCBhZGFwdGVyLmZpbmRPcmdhbml6YXRpb25CeVNsdWcoXG4gICAgICBjdHguYm9keS5zbHVnXG4gICAgKTtcbiAgICBpZiAoZXhpc3RpbmdPcmdhbml6YXRpb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLk9SR0FOSVpBVElPTl9BTFJFQURZX0VYSVNUU1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG9yZ2FuaXphdGlvbjIgPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZU9yZ2FuaXphdGlvbih7XG4gICAgICBvcmdhbml6YXRpb246IHtcbiAgICAgICAgaWQ6IGdlbmVyYXRlSWQoKSxcbiAgICAgICAgc2x1ZzogY3R4LmJvZHkuc2x1ZyxcbiAgICAgICAgbmFtZTogY3R4LmJvZHkubmFtZSxcbiAgICAgICAgbG9nbzogY3R4LmJvZHkubG9nbyxcbiAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgbWV0YWRhdGE6IGN0eC5ib2R5Lm1ldGFkYXRhXG4gICAgICB9LFxuICAgICAgdXNlclxuICAgIH0pO1xuICAgIGlmIChjdHguY29udGV4dC5zZXNzaW9uKSB7XG4gICAgICBhd2FpdCBhZGFwdGVyLnNldEFjdGl2ZU9yZ2FuaXphdGlvbihcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuLFxuICAgICAgICBvcmdhbml6YXRpb24yLmlkXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24ob3JnYW5pemF0aW9uMik7XG4gIH1cbik7XG52YXIgdXBkYXRlT3JnYW5pemF0aW9uID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9vcmdhbml6YXRpb24vdXBkYXRlXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIGRhdGE6IHoub2JqZWN0KHtcbiAgICAgICAgbmFtZTogei5zdHJpbmcoe1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSBvcmdhbml6YXRpb25cIlxuICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICBzbHVnOiB6LnN0cmluZyh7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHNsdWcgb2YgdGhlIG9yZ2FuaXphdGlvblwiXG4gICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgIGxvZ286IHouc3RyaW5nKHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbG9nbyBvZiB0aGUgb3JnYW5pemF0aW9uXCJcbiAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgbWV0YWRhdGE6IHoucmVjb3JkKHouc3RyaW5nKCksIHouYW55KCksIHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbWV0YWRhdGEgb2YgdGhlIG9yZ2FuaXphdGlvblwiXG4gICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgIH0pLnBhcnRpYWwoKSxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJVcGRhdGUgYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXBkYXRlZCBvcmdhbml6YXRpb25cIixcbiAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvT3JnYW5pemF0aW9uXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuZ2V0U2Vzc2lvbihjdHgpO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJVc2VyIG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBjdHguYm9keS5vcmdhbml6YXRpb25JZCB8fCBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuT1JHQU5JWkFUSU9OX05PVF9GT1VORFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX05PVF9BX01FTUJFUl9PRl9USEVfT1JHQU5JWkFUSU9OXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCByb2xlMiA9IGN0eC5jb250ZXh0LnJvbGVzW21lbWJlci5yb2xlXTtcbiAgICBpZiAoIXJvbGUyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiUm9sZSBub3QgZm91bmQhXCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhblVwZGF0ZU9yZyA9IHJvbGUyLmF1dGhvcml6ZSh7XG4gICAgICBvcmdhbml6YXRpb246IFtcInVwZGF0ZVwiXVxuICAgIH0pO1xuICAgIGlmIChjYW5VcGRhdGVPcmcuZXJyb3IpIHtcbiAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuWU9VX0FSRV9OT1RfQUxMT1dFRF9UT19VUERBVEVfVEhJU19PUkdBTklaQVRJT05cbiAgICAgICAgfSxcbiAgICAgICAgc3RhdHVzOiA0MDNcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1cGRhdGVkT3JnID0gYXdhaXQgYWRhcHRlci51cGRhdGVPcmdhbml6YXRpb24oXG4gICAgICBvcmdhbml6YXRpb25JZCxcbiAgICAgIGN0eC5ib2R5LmRhdGFcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih1cGRhdGVkT3JnKTtcbiAgfVxuKTtcbnZhciBkZWxldGVPcmdhbml6YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9kZWxldGVcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9yZ2FuaXphdGlvbiBpZCB0byBkZWxldGVcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICB1c2U6IFtvcmdNaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJEZWxldGUgYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIGlkIHRoYXQgd2FzIGRlbGV0ZWRcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5nZXRTZXNzaW9uKGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG9yZ2FuaXphdGlvbklkID0gY3R4LmJvZHkub3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuT1JHQU5JWkFUSU9OX05PVF9GT1VORFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9yZ09wdGlvbnMpO1xuICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBvcmdhbml6YXRpb25JZFxuICAgIH0pO1xuICAgIGlmICghbWVtYmVyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX05PVF9BX01FTUJFUl9PRl9USEVfT1JHQU5JWkFUSU9OXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCByb2xlMiA9IGN0eC5jb250ZXh0LnJvbGVzW21lbWJlci5yb2xlXTtcbiAgICBpZiAoIXJvbGUyKSB7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiUm9sZSBub3QgZm91bmQhXCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGNhbkRlbGV0ZU9yZyA9IHJvbGUyLmF1dGhvcml6ZSh7XG4gICAgICBvcmdhbml6YXRpb246IFtcImRlbGV0ZVwiXVxuICAgIH0pO1xuICAgIGlmIChjYW5EZWxldGVPcmcuZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5ZT1VfQVJFX05PVF9BTExPV0VEX1RPX0RFTEVURV9USElTX09SR0FOSVpBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChvcmdhbml6YXRpb25JZCA9PT0gc2Vzc2lvbi5zZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkKSB7XG4gICAgICBhd2FpdCBhZGFwdGVyLnNldEFjdGl2ZU9yZ2FuaXphdGlvbihzZXNzaW9uLnNlc3Npb24udG9rZW4sIG51bGwpO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb24gPSBjdHguY29udGV4dC5vcmdPcHRpb25zLm9yZ2FuaXphdGlvbkRlbGV0aW9uO1xuICAgIGlmIChvcHRpb24/LmRpc2FibGVkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIik7XG4gICAgfVxuICAgIGNvbnN0IG9yZyA9IGF3YWl0IGFkYXB0ZXIuZmluZE9yZ2FuaXphdGlvbkJ5SWQob3JnYW5pemF0aW9uSWQpO1xuICAgIGlmICghb3JnKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbj8uYmVmb3JlRGVsZXRlKSB7XG4gICAgICBhd2FpdCBvcHRpb24uYmVmb3JlRGVsZXRlKHtcbiAgICAgICAgb3JnYW5pemF0aW9uOiBvcmcsXG4gICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlT3JnYW5pemF0aW9uKG9yZ2FuaXphdGlvbklkKTtcbiAgICBpZiAob3B0aW9uPy5hZnRlckRlbGV0ZSkge1xuICAgICAgYXdhaXQgb3B0aW9uLmFmdGVyRGVsZXRlKHtcbiAgICAgICAgb3JnYW5pemF0aW9uOiBvcmcsXG4gICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbihvcmcpO1xuICB9XG4pO1xudmFyIGdldEZ1bGxPcmdhbml6YXRpb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9nZXQtZnVsbC1vcmdhbml6YXRpb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBxdWVyeTogei5vcHRpb25hbChcbiAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIGlkIHRvIGdldFwiXG4gICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgIG9yZ2FuaXphdGlvblNsdWc6IHouc3RyaW5nKHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uIHNsdWcgdG8gZ2V0XCJcbiAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgfSlcbiAgICApLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIHVzZTogW29yZ01pZGRsZXdhcmUsIG9yZ1Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGZ1bGwgb3JnYW5pemF0aW9uXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgb3JnYW5pemF0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL09yZ2FuaXphdGlvblwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBjdHgucXVlcnk/Lm9yZ2FuaXphdGlvblNsdWcgfHwgY3R4LnF1ZXJ5Py5vcmdhbml6YXRpb25JZCB8fCBzZXNzaW9uLnNlc3Npb24uYWN0aXZlT3JnYW5pemF0aW9uSWQ7XG4gICAgaWYgKCFvcmdhbml6YXRpb25JZCkge1xuICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgc3RhdHVzOiAyMDBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uMiA9IGF3YWl0IGFkYXB0ZXIuZmluZEZ1bGxPcmdhbml6YXRpb24oe1xuICAgICAgb3JnYW5pemF0aW9uSWQsXG4gICAgICBpc1NsdWc6ICEhY3R4LnF1ZXJ5Py5vcmdhbml6YXRpb25TbHVnXG4gICAgfSk7XG4gICAgY29uc3QgaXNNZW1iZXIgPSBvcmdhbml6YXRpb24yPy5tZW1iZXJzLmZpbmQoXG4gICAgICAobWVtYmVyKSA9PiBtZW1iZXIudXNlcklkID09PSBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGlmICghaXNNZW1iZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5VU0VSX0lTX05PVF9BX01FTUJFUl9PRl9USEVfT1JHQU5JWkFUSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFvcmdhbml6YXRpb24yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5PUkdBTklaQVRJT05fTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKG9yZ2FuaXphdGlvbjIpO1xuICB9XG4pO1xudmFyIHNldEFjdGl2ZU9yZ2FuaXphdGlvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvb3JnYW5pemF0aW9uL3NldC1hY3RpdmVcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG9yZ2FuaXphdGlvbiBpZCB0byBzZXQgYXMgYWN0aXZlLiBJdCBjYW4gYmUgbnVsbCB0byB1bnNldCB0aGUgYWN0aXZlIG9yZ2FuaXphdGlvblwiXG4gICAgICB9KS5udWxsYWJsZSgpLm9wdGlvbmFsKCksXG4gICAgICBvcmdhbml6YXRpb25TbHVnOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb24gc2x1ZyB0byBzZXQgYXMgYWN0aXZlLiBJdCBjYW4gYmUgbnVsbCB0byB1bnNldCB0aGUgYWN0aXZlIG9yZ2FuaXphdGlvbiBpZiBvcmdhbml6YXRpb25JZCBpcyBub3QgcHJvdmlkZWRcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yZ1Nlc3Npb25NaWRkbGV3YXJlLCBvcmdNaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXQgdGhlIGFjdGl2ZSBvcmdhbml6YXRpb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcmdhbml6YXRpb25cIixcbiAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvT3JnYW5pemF0aW9uXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBhZGFwdGVyID0gZ2V0T3JnQWRhcHRlcihjdHguY29udGV4dCwgY3R4LmNvbnRleHQub3JnT3B0aW9ucyk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgbGV0IG9yZ2FuaXphdGlvbklkID0gY3R4LmJvZHkub3JnYW5pemF0aW9uU2x1ZyB8fCBjdHguYm9keS5vcmdhbml6YXRpb25JZDtcbiAgICBpZiAob3JnYW5pemF0aW9uSWQgPT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHNlc3Npb25PcmdJZCA9IHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICAgIGlmICghc2Vzc2lvbk9yZ0lkKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9uMiA9IGF3YWl0IGFkYXB0ZXIuc2V0QWN0aXZlT3JnYW5pemF0aW9uKFxuICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgIG51bGxcbiAgICAgICk7XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiB1cGRhdGVkU2Vzc2lvbjIsXG4gICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCk7XG4gICAgfVxuICAgIGlmICghb3JnYW5pemF0aW9uSWQpIHtcbiAgICAgIGNvbnN0IHNlc3Npb25PcmdJZCA9IHNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICAgIGlmICghc2Vzc2lvbk9yZ0lkKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgIH1cbiAgICAgIG9yZ2FuaXphdGlvbklkID0gc2Vzc2lvbk9yZ0lkO1xuICAgIH1cbiAgICBjb25zdCBvcmdhbml6YXRpb24yID0gYXdhaXQgYWRhcHRlci5maW5kRnVsbE9yZ2FuaXphdGlvbih7XG4gICAgICBvcmdhbml6YXRpb25JZCxcbiAgICAgIGlzU2x1ZzogISFjdHguYm9keS5vcmdhbml6YXRpb25TbHVnXG4gICAgfSk7XG4gICAgY29uc3QgaXNNZW1iZXIgPSBvcmdhbml6YXRpb24yPy5tZW1iZXJzLmZpbmQoXG4gICAgICAobWVtYmVyKSA9PiBtZW1iZXIudXNlcklkID09PSBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGlmICghaXNNZW1iZXIpIHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuc2V0QWN0aXZlT3JnYW5pemF0aW9uKHNlc3Npb24uc2Vzc2lvbi50b2tlbiwgbnVsbCk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuVVNFUl9JU19OT1RfQV9NRU1CRVJfT0ZfVEhFX09SR0FOSVpBVElPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghb3JnYW5pemF0aW9uMikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVMuT1JHQU5JWkFUSU9OX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9uID0gYXdhaXQgYWRhcHRlci5zZXRBY3RpdmVPcmdhbml6YXRpb24oXG4gICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICBvcmdhbml6YXRpb24yLmlkXG4gICAgKTtcbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgc2Vzc2lvbjogdXBkYXRlZFNlc3Npb24sXG4gICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24ob3JnYW5pemF0aW9uMik7XG4gIH1cbik7XG52YXIgbGlzdE9yZ2FuaXphdGlvbnMgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29yZ2FuaXphdGlvbi9saXN0XCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbb3JnTWlkZGxld2FyZSwgb3JnU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3QgYWxsIG9yZ2FuaXphdGlvbnNcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Pcmdhbml6YXRpb25cIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBnZXRPcmdBZGFwdGVyKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcmdPcHRpb25zKTtcbiAgICBjb25zdCBvcmdhbml6YXRpb25zID0gYXdhaXQgYWRhcHRlci5saXN0T3JnYW5pemF0aW9ucyhcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKG9yZ2FuaXphdGlvbnMpO1xuICB9XG4pO1xuXG4vLyBzcmMvcGx1Z2lucy9vcmdhbml6YXRpb24vb3JnYW5pemF0aW9uLnRzXG52YXIgb3JnYW5pemF0aW9uID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgZW5kcG9pbnRzID0ge1xuICAgIGNyZWF0ZU9yZ2FuaXphdGlvbixcbiAgICB1cGRhdGVPcmdhbml6YXRpb24sXG4gICAgZGVsZXRlT3JnYW5pemF0aW9uLFxuICAgIHNldEFjdGl2ZU9yZ2FuaXphdGlvbixcbiAgICBnZXRGdWxsT3JnYW5pemF0aW9uLFxuICAgIGxpc3RPcmdhbml6YXRpb25zLFxuICAgIGNyZWF0ZUludml0YXRpb246IGNyZWF0ZUludml0YXRpb24oKSxcbiAgICBjYW5jZWxJbnZpdGF0aW9uLFxuICAgIGFjY2VwdEludml0YXRpb24sXG4gICAgZ2V0SW52aXRhdGlvbixcbiAgICByZWplY3RJbnZpdGF0aW9uLFxuICAgIGFkZE1lbWJlcjogYWRkTWVtYmVyKCksXG4gICAgcmVtb3ZlTWVtYmVyLFxuICAgIHVwZGF0ZU1lbWJlclJvbGU6IHVwZGF0ZU1lbWJlclJvbGUoKSxcbiAgICBnZXRBY3RpdmVNZW1iZXIsXG4gICAgbGVhdmVPcmdhbml6YXRpb25cbiAgfTtcbiAgY29uc3Qgcm9sZXMgPSB7XG4gICAgLi4uZGVmYXVsdFJvbGVzLFxuICAgIC4uLm9wdGlvbnM/LnJvbGVzXG4gIH07XG4gIGNvbnN0IGFwaSA9IHNoaW1Db250ZXh0KGVuZHBvaW50cywge1xuICAgIG9yZ09wdGlvbnM6IG9wdGlvbnMgfHwge30sXG4gICAgcm9sZXMsXG4gICAgZ2V0U2Vzc2lvbjogYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjb250ZXh0KTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm9yZ2FuaXphdGlvblwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgLi4uYXBpLFxuICAgICAgaGFzUGVybWlzc2lvbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vcmdhbml6YXRpb24vaGFzLXBlcm1pc3Npb25cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIHBlcm1pc3Npb246IHoucmVjb3JkKHouc3RyaW5nKCksIHouYXJyYXkoei5zdHJpbmcoKSkpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbb3JnU2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoZWNrIGlmIHRoZSB1c2VyIGhhcyBwZXJtaXNzaW9uXCIsXG4gICAgICAgICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwZXJtaXNzaW9uIHRvIGNoZWNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJwZXJtaXNzaW9uXCJdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJzdWNjZXNzXCJdXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKCFjdHguYm9keS5wZXJtaXNzaW9uIHx8IE9iamVjdC5rZXlzKGN0eC5ib2R5LnBlcm1pc3Npb24pLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJpbnZhbGlkIHBlcm1pc3Npb24gY2hlY2suIHlvdSBjYW4gb25seSBjaGVjayBvbmUgcmVzb3VyY2UgcGVybWlzc2lvbiBhdCBhIHRpbWUuXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhY3RpdmVPcmdhbml6YXRpb25JZCA9IGN0eC5ib2R5Lm9yZ2FuaXphdGlvbklkIHx8IGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgICAgICAgICBpZiAoIWFjdGl2ZU9yZ2FuaXphdGlvbklkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IE9SR0FOSVpBVElPTl9FUlJPUl9DT0RFUy5OT19BQ1RJVkVfT1JHQU5JWkFUSU9OXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgYWRhcHRlciA9IGdldE9yZ0FkYXB0ZXIoY3R4LmNvbnRleHQpO1xuICAgICAgICAgIGNvbnN0IG1lbWJlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE1lbWJlckJ5T3JnSWQoe1xuICAgICAgICAgICAgdXNlcklkOiBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICBvcmdhbml6YXRpb25JZDogYWN0aXZlT3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIW1lbWJlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogT1JHQU5JWkFUSU9OX0VSUk9SX0NPREVTLlVTRVJfSVNfTk9UX0FfTUVNQkVSX09GX1RIRV9PUkdBTklaQVRJT05cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByb2xlMiA9IHJvbGVzW21lbWJlci5yb2xlXTtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSByb2xlMi5hdXRob3JpemUoY3R4LmJvZHkucGVybWlzc2lvbik7XG4gICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZXJyb3I6IHJlc3VsdC5lcnJvcixcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiA0MDNcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHNlc3Npb246IHtcbiAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgYWN0aXZlT3JnYW5pemF0aW9uSWQ6IHtcbiAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8uc2Vzc2lvbj8uZmllbGRzPy5hY3RpdmVPcmdhbml6YXRpb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9yZ2FuaXphdGlvbjoge1xuICAgICAgICBtb2RlbE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ub3JnYW5pemF0aW9uPy5tb2RlbE5hbWUsXG4gICAgICAgIGZpZWxkczoge1xuICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm9yZ2FuaXphdGlvbj8uZmllbGRzPy5uYW1lXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzbHVnOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ub3JnYW5pemF0aW9uPy5maWVsZHM/LnNsdWdcbiAgICAgICAgICB9LFxuICAgICAgICAgIGxvZ286IHtcbiAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ub3JnYW5pemF0aW9uPy5maWVsZHM/LmxvZ29cbiAgICAgICAgICB9LFxuICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5vcmdhbml6YXRpb24/LmZpZWxkcz8uY3JlYXRlZEF0XG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5vcmdhbml6YXRpb24/LmZpZWxkcz8ubWV0YWRhdGFcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBtZW1iZXI6IHtcbiAgICAgICAgbW9kZWxOYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm1lbWJlcj8ubW9kZWxOYW1lLFxuICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDoge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICAgICAgICBtb2RlbDogXCJvcmdhbml6YXRpb25cIixcbiAgICAgICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5tZW1iZXI/LmZpZWxkcz8ub3JnYW5pemF0aW9uSWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lm1lbWJlcj8uZmllbGRzPy51c2VySWQsXG4gICAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcm9sZToge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IFwibWVtYmVyXCIsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8ubWVtYmVyPy5maWVsZHM/LnJvbGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5tZW1iZXI/LmZpZWxkcz8uY3JlYXRlZEF0XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaW52aXRhdGlvbjoge1xuICAgICAgICBtb2RlbE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8uaW52aXRhdGlvbj8ubW9kZWxOYW1lLFxuICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDoge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICAgICAgICBtb2RlbDogXCJvcmdhbml6YXRpb25cIixcbiAgICAgICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5pbnZpdGF0aW9uPy5maWVsZHM/Lm9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgfSxcbiAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8uaW52aXRhdGlvbj8uZmllbGRzPy5lbWFpbFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcm9sZToge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zPy5zY2hlbWE/Lmludml0YXRpb24/LmZpZWxkcz8ucm9sZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogXCJwZW5kaW5nXCIsXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8uaW52aXRhdGlvbj8uZmllbGRzPy5zdGF0dXNcbiAgICAgICAgICB9LFxuICAgICAgICAgIGV4cGlyZXNBdDoge1xuICAgICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucz8uc2NoZW1hPy5pbnZpdGF0aW9uPy5maWVsZHM/LmV4cGlyZXNBdFxuICAgICAgICAgIH0sXG4gICAgICAgICAgaW52aXRlcklkOiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgICAgIGZpZWxkOiBcImlkXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnM/LnNjaGVtYT8uaW52aXRhdGlvbj8uZmllbGRzPy5pbnZpdGVySWQsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgJEluZmVyOiB7XG4gICAgICBPcmdhbml6YXRpb246IHt9LFxuICAgICAgSW52aXRhdGlvbjoge30sXG4gICAgICBNZW1iZXI6IHt9LFxuICAgICAgQWN0aXZlT3JnYW5pemF0aW9uOiB7fVxuICAgIH0sXG4gICAgJEVSUk9SX0NPREVTOiBPUkdBTklaQVRJT05fRVJST1JfQ09ERVNcbiAgfTtcbn07XG5cbmV4cG9ydCB7IG9yZ2FuaXphdGlvbiB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter)\n/* harmony export */ });\n// src/utils/misc.ts\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTNYVFFTUFBBLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFaUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay0zWFRRU1BQQS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvbWlzYy50c1xuZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cikge1xuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpO1xufVxuXG5leHBvcnQgeyBjYXBpdGFsaXplRmlyc3RMZXR0ZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   safeJSONParse: () => (/* binding */ safeJSONParse)\n/* harmony export */ });\n// src/utils/json.ts\nfunction safeJSONParse(data) {\n  function reviver(_, value) {\n    if (typeof value === \"string\") {\n      const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z$/;\n      if (iso8601Regex.test(value)) {\n        const date = new Date(value);\n        if (!isNaN(date.getTime())) {\n          return date;\n        }\n      }\n    }\n    return value;\n  }\n  try {\n    return JSON.parse(data, reviver);\n  } catch {\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTUzSVBPMlBKLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUU7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRXlCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstNTNJUE8yUEouanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3V0aWxzL2pzb24udHNcbmZ1bmN0aW9uIHNhZmVKU09OUGFyc2UoZGF0YSkge1xuICBmdW5jdGlvbiByZXZpdmVyKF8sIHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgaXNvODYwMVJlZ2V4ID0gL15cXGR7NH0tXFxkezJ9LVxcZHsyfVRcXGR7Mn06XFxkezJ9OlxcZHsyfSg/OlxcLlxcZCspP1okLztcbiAgICAgIGlmIChpc284NjAxUmVnZXgudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICAgICAgaWYgKCFpc05hTihkYXRlLmdldFRpbWUoKSkpIHtcbiAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhLCByZXZpdmVyKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IHsgc2FmZUpTT05QYXJzZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertFromDB: () => (/* binding */ convertFromDB),\n/* harmony export */   convertToDB: () => (/* binding */ convertToDB),\n/* harmony export */   createFieldAttribute: () => (/* binding */ createFieldAttribute),\n/* harmony export */   createInternalAdapter: () => (/* binding */ createInternalAdapter),\n/* harmony export */   createKyselyAdapter: () => (/* binding */ createKyselyAdapter),\n/* harmony export */   getAdapter: () => (/* binding */ getAdapter),\n/* harmony export */   getAuthTables: () => (/* binding */ getAuthTables),\n/* harmony export */   getMigrations: () => (/* binding */ getMigrations),\n/* harmony export */   getSchema: () => (/* binding */ getSchema),\n/* harmony export */   getWithHooks: () => (/* binding */ getWithHooks),\n/* harmony export */   kyselyAdapter: () => (/* binding */ kyselyAdapter),\n/* harmony export */   matchType: () => (/* binding */ matchType),\n/* harmony export */   memoryAdapter: () => (/* binding */ memoryAdapter),\n/* harmony export */   toZodSchema: () => (/* binding */ toZodSchema),\n/* harmony export */   withApplyDefault: () => (/* binding */ withApplyDefault)\n/* harmony export */ });\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/dialect/mssql/mssql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/.pnpm/kysely@0.27.5/node_modules/kysely/dist/esm/kysely.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\nfunction getDatabaseType(db) {\n  if (!db) {\n    return null;\n  }\n  if (\"dialect\" in db) {\n    return getDatabaseType(db.dialect);\n  }\n  if (\"createDriver\" in db) {\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_6__.SqliteDialect) {\n      return \"sqlite\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_7__.MysqlDialect) {\n      return \"mysql\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_8__.PostgresDialect) {\n      return \"postgres\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_9__.MssqlDialect) {\n      return \"mssql\";\n    }\n  }\n  if (\"aggregate\" in db) {\n    return \"sqlite\";\n  }\n  if (\"getConnection\" in db) {\n    return \"mysql\";\n  }\n  if (\"connect\" in db) {\n    return \"postgres\";\n  }\n  return null;\n}\nvar createKyselyAdapter = async (config) => {\n  const db = config.database;\n  if (!db) {\n    return {\n      kysely: null,\n      databaseType: null\n    };\n  }\n  if (\"db\" in db) {\n    return {\n      kysely: db.db,\n      databaseType: db.type\n    };\n  }\n  if (\"dialect\" in db) {\n    return {\n      kysely: new kysely__WEBPACK_IMPORTED_MODULE_10__.Kysely({ dialect: db.dialect }),\n      databaseType: db.type\n    };\n  }\n  let dialect = void 0;\n  const databaseType = getDatabaseType(db);\n  if (\"createDriver\" in db) {\n    dialect = db;\n  }\n  if (\"aggregate\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_6__.SqliteDialect({\n      database: db\n    });\n  }\n  if (\"getConnection\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_7__.MysqlDialect(db);\n  }\n  if (\"connect\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_8__.PostgresDialect({\n      pool: db\n    });\n  }\n  return {\n    kysely: dialect ? new kysely__WEBPACK_IMPORTED_MODULE_10__.Kysely({ dialect }) : null,\n    databaseType\n  };\n};\n\n// src/db/with-hooks.ts\nfunction getWithHooks(adapter, ctx) {\n  const hooks = ctx.hooks;\n  async function createWithHooks(data, model, customCreateFn) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.before;\n      if (toRun) {\n        const result = await toRun(actualData);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\" && \"data\" in result;\n        if (isObject) {\n          actualData = {\n            ...actualData,\n            ...result.data\n          };\n        }\n      }\n    }\n    const customCreated = customCreateFn ? await customCreateFn.fn(actualData) : null;\n    const created = !customCreateFn || customCreateFn.executeMainFn ? await adapter.create({\n      model,\n      data: actualData\n    }) : customCreated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.after;\n      if (toRun) {\n        await toRun(created);\n      }\n    }\n    return created;\n  }\n  async function updateWithHooks(data, where, model, customUpdateFn) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await adapter.update({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated);\n      }\n    }\n    return updated;\n  }\n  async function updateManyWithHooks(data, where, model, customUpdateFn) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await adapter.updateMany({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated);\n      }\n    }\n    return updated;\n  }\n  return {\n    createWithHooks,\n    updateWithHooks,\n    updateManyWithHooks\n  };\n}\n\n// src/db/internal-adapter.ts\nvar createInternalAdapter = (adapter, ctx) => {\n  const options = ctx.options;\n  const secondaryStorage = options.secondaryStorage;\n  const sessionExpiration = options.session?.expiresIn || 60 * 60 * 24 * 7;\n  const { createWithHooks, updateWithHooks, updateManyWithHooks } = getWithHooks(adapter, ctx);\n  return {\n    createOAuthUser: async (user, account) => {\n      const createdUser = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...user\n        },\n        \"user\"\n      );\n      const createdAccount = await createWithHooks(\n        {\n          ...account,\n          userId: createdUser.id || user.id,\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date()\n        },\n        \"account\"\n      );\n      return {\n        user: createdUser,\n        account: createdAccount\n      };\n    },\n    createUser: async (user) => {\n      const createdUser = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          emailVerified: false,\n          ...user,\n          email: user.email.toLowerCase()\n        },\n        \"user\"\n      );\n      return createdUser;\n    },\n    createAccount: async (account) => {\n      const createdAccount = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\"\n      );\n      return createdAccount;\n    },\n    listSessions: async (userId) => {\n      if (secondaryStorage) {\n        const currentList = await secondaryStorage.get(\n          `active-sessions-${userId}`\n        );\n        if (!currentList) return [];\n        const list = (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__.safeJSONParse)(currentList) || [];\n        const now = Date.now();\n        const validSessions = list.filter((s) => s.expiresAt > now);\n        const sessions2 = [];\n        for (const session of validSessions) {\n          const sessionStringified = await secondaryStorage.get(session.token);\n          if (sessionStringified) {\n            const s = JSON.parse(sessionStringified);\n            const parsedSession = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseSessionOutput)(ctx.options, {\n              ...s.session,\n              expiresAt: new Date(s.session.expiresAt)\n            });\n            sessions2.push(parsedSession);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await adapter.findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return sessions;\n    },\n    listUsers: async (limit, offset, sortBy, where) => {\n      const users = await adapter.findMany({\n        model: \"user\",\n        limit,\n        offset,\n        sortBy,\n        where\n      });\n      return users;\n    },\n    deleteUser: async (userId) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(`active-sessions-${userId}`);\n      }\n      if (!secondaryStorage || options.session?.storeSessionInDatabase) {\n        await adapter.deleteMany({\n          model: \"session\",\n          where: [\n            {\n              field: \"userId\",\n              value: userId\n            }\n          ]\n        });\n      }\n      await adapter.deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n    },\n    createSession: async (userId, request, dontRememberMe, override, overrideAll) => {\n      const headers = request instanceof Request ? request.headers : request;\n      const { id: _, ...rest } = override || {};\n      const data = {\n        ipAddress: request ? (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.getIp)(request, ctx.options) || \"\" : \"\",\n        userAgent: headers?.get(\"user-agent\") || \"\",\n        ...rest,\n        /**\n         * If the user doesn't want to be remembered\n         * set the session to expire in 1 day.\n         * The cookie will be set to expire at the end of the session\n         */\n        expiresAt: dontRememberMe ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(60 * 60 * 24, \"sec\") : (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(sessionExpiration, \"sec\"),\n        userId,\n        token: (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.generateId)(32),\n        createdAt: /* @__PURE__ */ new Date(),\n        updatedAt: /* @__PURE__ */ new Date(),\n        ...overrideAll ? rest : {}\n      };\n      const res = await createWithHooks(\n        data,\n        \"session\",\n        secondaryStorage ? {\n          fn: async (sessionData) => {\n            const currentList = await secondaryStorage.get(\n              `active-sessions-${userId}`\n            );\n            let list = [];\n            const now = Date.now();\n            if (currentList) {\n              list = (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__.safeJSONParse)(currentList) || [];\n              list = list.filter((session) => session.expiresAt > now);\n            }\n            list.push({\n              token: data.token,\n              expiresAt: now + sessionExpiration * 1e3\n            });\n            await secondaryStorage.set(\n              `active-sessions-${userId}`,\n              JSON.stringify(list),\n              sessionExpiration\n            );\n            return sessionData;\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0\n      );\n      return res;\n    },\n    findSession: async (token) => {\n      if (secondaryStorage) {\n        const sessionStringified = await secondaryStorage.get(token);\n        if (!sessionStringified) {\n          return null;\n        }\n        const s = JSON.parse(sessionStringified);\n        const parsedSession2 = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseSessionOutput)(ctx.options, {\n          ...s.session,\n          expiresAt: new Date(s.session.expiresAt),\n          createdAt: new Date(s.session.createdAt),\n          updatedAt: new Date(s.session.updatedAt)\n        });\n        const parsedUser2 = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseUserOutput)(ctx.options, {\n          ...s.user,\n          createdAt: new Date(s.user.createdAt),\n          updatedAt: new Date(s.user.updatedAt)\n        });\n        return {\n          session: parsedSession2,\n          user: parsedUser2\n        };\n      }\n      const session = await adapter.findOne({\n        model: \"session\",\n        where: [\n          {\n            value: token,\n            field: \"token\"\n          }\n        ]\n      });\n      if (!session) {\n        return null;\n      }\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            value: session.userId,\n            field: \"id\"\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const parsedSession = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseSessionOutput)(ctx.options, session);\n      const parsedUser = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_0__.parseUserOutput)(ctx.options, user);\n      return {\n        session: parsedSession,\n        user: parsedUser\n      };\n    },\n    findSessions: async (sessionTokens) => {\n      if (secondaryStorage) {\n        const sessions2 = [];\n        for (const sessionToken of sessionTokens) {\n          const sessionStringified = await secondaryStorage.get(sessionToken);\n          if (sessionStringified) {\n            const s = JSON.parse(sessionStringified);\n            const session = {\n              session: {\n                ...s.session,\n                expiresAt: new Date(s.session.expiresAt)\n              },\n              user: {\n                ...s.user,\n                createdAt: new Date(s.user.createdAt),\n                updatedAt: new Date(s.user.updatedAt)\n              }\n            };\n            sessions2.push(session);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await adapter.findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: sessionTokens,\n            operator: \"in\"\n          }\n        ]\n      });\n      const userIds = sessions.map((session) => {\n        return session.userId;\n      });\n      if (!userIds.length) return [];\n      const users = await adapter.findMany({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return sessions.map((session) => {\n        const user = users.find((u) => u.id === session.userId);\n        if (!user) return null;\n        return {\n          session,\n          user\n        };\n      });\n    },\n    updateSession: async (sessionToken, session) => {\n      const updatedSession = await updateWithHooks(\n        session,\n        [{ field: \"token\", value: sessionToken }],\n        \"session\",\n        secondaryStorage ? {\n          async fn(data) {\n            const currentSession = await secondaryStorage.get(sessionToken);\n            let updatedSession2 = null;\n            if (currentSession) {\n              const parsedSession = JSON.parse(currentSession);\n              updatedSession2 = {\n                ...parsedSession.session,\n                ...data\n              };\n              return updatedSession2;\n            } else {\n              return null;\n            }\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0\n      );\n      return updatedSession;\n    },\n    deleteSession: async (token) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(token);\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await adapter.delete({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: token\n          }\n        ]\n      });\n    },\n    deleteAccounts: async (userId) => {\n      await adapter.deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteAccount: async (providerId, userId) => {\n      await adapter.delete({\n        model: \"account\",\n        where: [\n          {\n            field: \"providerId\",\n            value: providerId\n          },\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteSessions: async (userIdOrSessionTokens) => {\n      if (secondaryStorage) {\n        if (typeof userIdOrSessionTokens === \"string\") {\n          const activeSession = await secondaryStorage.get(\n            `active-sessions-${userIdOrSessionTokens}`\n          );\n          const sessions = activeSession ? (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_2__.safeJSONParse)(activeSession) : [];\n          if (!sessions) return;\n          for (const session of sessions) {\n            await secondaryStorage.delete(session.token);\n          }\n        } else {\n          for (const sessionToken of userIdOrSessionTokens) {\n            const session = await secondaryStorage.get(sessionToken);\n            if (session) {\n              await secondaryStorage.delete(sessionToken);\n            }\n          }\n        }\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await adapter.deleteMany({\n        model: \"session\",\n        where: [\n          {\n            field: Array.isArray(userIdOrSessionTokens) ? \"token\" : \"userId\",\n            value: userIdOrSessionTokens,\n            operator: Array.isArray(userIdOrSessionTokens) ? \"in\" : void 0\n          }\n        ]\n      });\n    },\n    findOAuthUser: async (email, accountId, providerId) => {\n      const account = await adapter.findOne({\n        model: \"account\",\n        where: [\n          {\n            value: accountId,\n            field: \"accountId\"\n          },\n          {\n            value: providerId,\n            field: \"providerId\"\n          }\n        ]\n      });\n      if (account) {\n        const user = await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              value: account.userId,\n              field: \"id\"\n            }\n          ]\n        });\n        if (user) {\n          return {\n            user,\n            accounts: [account]\n          };\n        } else {\n          return null;\n        }\n      } else {\n        const user = await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              value: email.toLowerCase(),\n              field: \"email\"\n            }\n          ]\n        });\n        if (user) {\n          const accounts = await adapter.findMany({\n            model: \"account\",\n            where: [\n              {\n                value: user.id,\n                field: \"userId\"\n              }\n            ]\n          });\n          return {\n            user,\n            accounts: accounts || []\n          };\n        } else {\n          return null;\n        }\n      }\n    },\n    findUserByEmail: async (email, options2) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            value: email.toLowerCase(),\n            field: \"email\"\n          }\n        ]\n      });\n      if (!user) return null;\n      if (options2?.includeAccounts) {\n        const accounts = await adapter.findMany({\n          model: \"account\",\n          where: [\n            {\n              value: user.id,\n              field: \"userId\"\n            }\n          ]\n        });\n        return {\n          user,\n          accounts\n        };\n      }\n      return {\n        user,\n        accounts: []\n      };\n    },\n    findUserById: async (userId) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n      return user;\n    },\n    linkAccount: async (account) => {\n      const _account = await createWithHooks(\n        {\n          ...account,\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date()\n        },\n        \"account\"\n      );\n      return _account;\n    },\n    updateUser: async (userId, data) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ],\n        \"user\"\n      );\n      return user;\n    },\n    updateUserByEmail: async (email, data) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"email\",\n            value: email.toLowerCase()\n          }\n        ],\n        \"user\"\n      );\n      return user;\n    },\n    updatePassword: async (userId, password) => {\n      await updateManyWithHooks(\n        {\n          password\n        },\n        [\n          {\n            field: \"userId\",\n            value: userId\n          },\n          {\n            field: \"providerId\",\n            value: \"credential\"\n          }\n        ],\n        \"account\"\n      );\n    },\n    findAccounts: async (userId) => {\n      const accounts = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return accounts;\n    },\n    findAccount: async (accountId) => {\n      const account = await adapter.findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByUserId: async (userId) => {\n      const account = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return account;\n    },\n    updateAccount: async (accountId, data) => {\n      const account = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: accountId }],\n        \"account\"\n      );\n      return account;\n    },\n    createVerificationValue: async (data) => {\n      const verification = await createWithHooks(\n        {\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...data\n        },\n        \"verification\"\n      );\n      return verification;\n    },\n    findVerificationValue: async (identifier) => {\n      const verification = await adapter.findMany({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ],\n        sortBy: {\n          field: \"createdAt\",\n          direction: \"desc\"\n        },\n        limit: 1\n      });\n      const lastVerification = verification[0];\n      return lastVerification;\n    },\n    deleteVerificationValue: async (id) => {\n      await adapter.delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n    },\n    deleteVerificationByIdentifier: async (identifier) => {\n      await adapter.delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ]\n      });\n    },\n    updateVerificationValue: async (id, data) => {\n      const verification = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"verification\"\n      );\n      return verification;\n    }\n  };\n};\n\n// src/db/field.ts\nvar createFieldAttribute = (type, config) => {\n  return {\n    type,\n    ...config\n  };\n};\n\n// src/db/get-tables.ts\nvar getAuthTables = (options) => {\n  const pluginSchema = options.plugins?.reduce(\n    (acc, plugin) => {\n      const schema = plugin.schema;\n      if (!schema) return acc;\n      for (const [key, value] of Object.entries(schema)) {\n        acc[key] = {\n          fields: {\n            ...acc[key]?.fields,\n            ...value.fields\n          },\n          modelName: value.modelName || key\n        };\n      }\n      return acc;\n    },\n    {}\n  );\n  const shouldAddRateLimitTable = options.rateLimit?.storage === \"database\";\n  const rateLimitTable = {\n    rateLimit: {\n      modelName: options.rateLimit?.modelName || \"rateLimit\",\n      fields: {\n        key: {\n          type: \"string\",\n          fieldName: options.rateLimit?.fields?.key || \"key\"\n        },\n        count: {\n          type: \"number\",\n          fieldName: options.rateLimit?.fields?.count || \"count\"\n        },\n        lastRequest: {\n          type: \"number\",\n          bigint: true,\n          fieldName: options.rateLimit?.fields?.lastRequest || \"lastRequest\"\n        }\n      }\n    }\n  };\n  const { user, session, account, ...pluginTables } = pluginSchema || {};\n  const sessionTable = {\n    session: {\n      modelName: options.session?.modelName || \"session\",\n      fields: {\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.expiresAt || \"expiresAt\"\n        },\n        token: {\n          type: \"string\",\n          required: true,\n          fieldName: options.session?.fields?.token || \"token\",\n          unique: true\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.updatedAt || \"updatedAt\"\n        },\n        ipAddress: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.ipAddress || \"ipAddress\"\n        },\n        userAgent: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.userAgent || \"userAgent\"\n        },\n        userId: {\n          type: \"string\",\n          fieldName: options.session?.fields?.userId || \"userId\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true\n        },\n        ...session?.fields,\n        ...options.session?.additionalFields\n      },\n      order: 2\n    }\n  };\n  return {\n    user: {\n      modelName: options.user?.modelName || \"user\",\n      fields: {\n        name: {\n          type: \"string\",\n          required: true,\n          fieldName: options.user?.fields?.name || \"name\",\n          sortable: true\n        },\n        email: {\n          type: \"string\",\n          unique: true,\n          required: true,\n          fieldName: options.user?.fields?.email || \"email\",\n          sortable: true\n        },\n        emailVerified: {\n          type: \"boolean\",\n          defaultValue: () => false,\n          required: true,\n          fieldName: options.user?.fields?.emailVerified || \"emailVerified\"\n        },\n        image: {\n          type: \"string\",\n          required: false,\n          fieldName: options.user?.fields?.image || \"image\"\n        },\n        createdAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...user?.fields,\n        ...options.user?.additionalFields\n      },\n      order: 1\n    },\n    //only add session table if it's not stored in secondary storage\n    ...!options.secondaryStorage || options.session?.storeSessionInDatabase ? sessionTable : {},\n    account: {\n      modelName: options.account?.modelName || \"account\",\n      fields: {\n        accountId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.accountId || \"accountId\"\n        },\n        providerId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.providerId || \"providerId\"\n        },\n        userId: {\n          type: \"string\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true,\n          fieldName: options.account?.fields?.userId || \"userId\"\n        },\n        accessToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.accessToken || \"accessToken\"\n        },\n        refreshToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.refreshToken || \"refreshToken\"\n        },\n        idToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.idToken || \"idToken\"\n        },\n        accessTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"accessTokenExpiresAt\"\n        },\n        refreshTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"refreshTokenExpiresAt\"\n        },\n        scope: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.scope || \"scope\"\n        },\n        password: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.password || \"password\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...account?.fields\n      },\n      order: 3\n    },\n    verification: {\n      modelName: options.verification?.modelName || \"verification\",\n      fields: {\n        identifier: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.identifier || \"identifier\"\n        },\n        value: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.value || \"value\"\n        },\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.verification?.fields?.expiresAt || \"expiresAt\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: false,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: false,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.updatedAt || \"updatedAt\"\n        }\n      },\n      order: 4\n    },\n    ...pluginTables,\n    ...shouldAddRateLimitTable ? rateLimitTable : {}\n  };\n};\nfunction toZodSchema(fields) {\n  const schema = zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n    ...Object.keys(fields).reduce((acc, key) => {\n      const field = fields[key];\n      if (!field) {\n        return acc;\n      }\n      if (field.type === \"string[]\" || field.type === \"number[]\") {\n        return {\n          ...acc,\n          [key]: zod__WEBPACK_IMPORTED_MODULE_5__.z.array(field.type === \"string[]\" ? zod__WEBPACK_IMPORTED_MODULE_5__.z.string() : zod__WEBPACK_IMPORTED_MODULE_5__.z.number())\n        };\n      }\n      if (Array.isArray(field.type)) {\n        return {\n          ...acc,\n          [key]: zod__WEBPACK_IMPORTED_MODULE_5__.z.any()\n        };\n      }\n      let schema2 = zod__WEBPACK_IMPORTED_MODULE_5__.z[field.type]();\n      if (field?.required === false) {\n        schema2 = schema2.optional();\n      }\n      if (field?.returned === false) {\n        return acc;\n      }\n      return {\n        ...acc,\n        [key]: schema2\n      };\n    }, {})\n  });\n  return schema;\n}\n\n// src/adapters/utils.ts\nfunction withApplyDefault(value, field, action) {\n  if (action === \"update\") {\n    return value;\n  }\n  if (value === void 0 || value === null) {\n    if (field.defaultValue) {\n      if (typeof field.defaultValue === \"function\") {\n        return field.defaultValue();\n      }\n      return field.defaultValue;\n    }\n  }\n  return value;\n}\n\n// src/adapters/memory-adapter/memory-adapter.ts\nvar createTransform = (options) => {\n  const schema = getAuthTables(options);\n  function getField(model, field) {\n    if (field === \"id\") {\n      return field;\n    }\n    const f = schema[model].fields[field];\n    return f.fieldName || field;\n  }\n  return {\n    transformInput(data, model, action) {\n      const transformedData = action === \"update\" ? {} : {\n        id: options.advanced?.generateId ? options.advanced.generateId({\n          model\n        }) : data.id || (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.generateId)()\n      };\n      const fields = schema[model].fields;\n      for (const field in fields) {\n        const value = data[field];\n        if (value === void 0 && !fields[field].defaultValue) {\n          continue;\n        }\n        transformedData[fields[field].fieldName || field] = withApplyDefault(\n          value,\n          fields[field],\n          action\n        );\n      }\n      return transformedData;\n    },\n    transformOutput(data, model, select = []) {\n      if (!data) return null;\n      const transformedData = data.id || data._id ? select.length === 0 || select.includes(\"id\") ? {\n        id: data.id\n      } : {} : {};\n      const tableSchema = schema[model].fields;\n      for (const key in tableSchema) {\n        if (select.length && !select.includes(key)) {\n          continue;\n        }\n        const field = tableSchema[key];\n        if (field) {\n          transformedData[key] = data[field.fieldName || key];\n        }\n      }\n      return transformedData;\n    },\n    convertWhereClause(where, table, model) {\n      return table.filter((record) => {\n        return where.every((clause) => {\n          const { field: _field, value, operator } = clause;\n          const field = getField(model, _field);\n          if (operator === \"in\") {\n            if (!Array.isArray(value)) {\n              throw new Error(\"Value must be an array\");\n            }\n            return value.includes(record[field]);\n          } else if (operator === \"contains\") {\n            return record[field].includes(value);\n          } else if (operator === \"starts_with\") {\n            return record[field].startsWith(value);\n          } else if (operator === \"ends_with\") {\n            return record[field].endsWith(value);\n          } else {\n            return record[field] === value;\n          }\n        });\n      });\n    },\n    getField\n  };\n};\nvar memoryAdapter = (db) => (options) => {\n  const { transformInput, transformOutput, convertWhereClause, getField } = createTransform(options);\n  return {\n    id: \"memory\",\n    create: async ({ model, data }) => {\n      const transformed = transformInput(data, model, \"create\");\n      db[model].push(transformed);\n      return transformOutput(transformed, model);\n    },\n    findOne: async ({ model, where, select }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      const record = res[0] || null;\n      return transformOutput(record, model, select);\n    },\n    findMany: async ({ model, where, sortBy, limit, offset }) => {\n      let table = db[model];\n      if (where) {\n        table = convertWhereClause(where, table, model);\n      }\n      if (sortBy) {\n        table = table.sort((a, b) => {\n          const field = getField(model, sortBy.field);\n          if (sortBy.direction === \"asc\") {\n            return a[field] > b[field] ? 1 : -1;\n          } else {\n            return a[field] < b[field] ? 1 : -1;\n          }\n        });\n      }\n      if (offset !== void 0) {\n        table = table.slice(offset);\n      }\n      if (limit !== void 0) {\n        table = table.slice(0, limit);\n      }\n      return table.map((record) => transformOutput(record, model));\n    },\n    update: async ({ model, where, update }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      res.forEach((record) => {\n        Object.assign(record, transformInput(update, model, \"update\"));\n      });\n      return transformOutput(res[0], model);\n    },\n    delete: async ({ model, where }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      db[model] = table.filter((record) => !res.includes(record));\n    },\n    deleteMany: async ({ model, where }) => {\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      let count = 0;\n      db[model] = table.filter((record) => {\n        if (res.includes(record)) {\n          count++;\n          return false;\n        }\n        return !res.includes(record);\n      });\n      return count;\n    },\n    updateMany(data) {\n      const { model, where, update } = data;\n      const table = db[model];\n      const res = convertWhereClause(where, table, model);\n      res.forEach((record) => {\n        Object.assign(record, update);\n      });\n      return res[0] || null;\n    }\n  };\n};\n\n// src/db/utils.ts\nasync function getAdapter(options) {\n  if (!options.database) {\n    const tables = getAuthTables(options);\n    const memoryDB = Object.keys(tables).reduce((acc, key) => {\n      acc[key] = [];\n      return acc;\n    }, {});\n    _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.warn(\n      \"No database configuration provided. Using memory adapter in development\"\n    );\n    return memoryAdapter(memoryDB)(options);\n  }\n  if (typeof options.database === \"function\") {\n    return options.database(options);\n  }\n  const { kysely, databaseType } = await createKyselyAdapter(options);\n  if (!kysely) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_4__.BetterAuthError(\"Failed to initialize database adapter\");\n  }\n  return kyselyAdapter(kysely, {\n    type: databaseType || \"sqlite\"\n  })(options);\n}\nfunction convertToDB(fields, values) {\n  let result = values.id ? {\n    id: values.id\n  } : {};\n  for (const key in fields) {\n    const field = fields[key];\n    const value = values[key];\n    if (value === void 0) {\n      continue;\n    }\n    result[field.fieldName || key] = value;\n  }\n  return result;\n}\nfunction convertFromDB(fields, values) {\n  if (!values) {\n    return null;\n  }\n  let result = {\n    id: values.id\n  };\n  for (const [key, value] of Object.entries(fields)) {\n    result[key] = values[value.fieldName || key];\n  }\n  return result;\n}\n\n// src/db/get-schema.ts\nfunction getSchema(config) {\n  const tables = getAuthTables(config);\n  let schema = {};\n  for (const key in tables) {\n    const table = tables[key];\n    const fields = table.fields;\n    let actualFields = {};\n    Object.entries(fields).forEach(([key2, field]) => {\n      actualFields[field.fieldName || key2] = field;\n      if (field.references) {\n        const refTable = tables[field.references.model];\n        if (refTable) {\n          actualFields[field.fieldName || key2].references = {\n            model: refTable.modelName,\n            field: field.references.field\n          };\n        }\n      }\n    });\n    if (schema[table.modelName]) {\n      schema[table.modelName].fields = {\n        ...schema[table.modelName].fields,\n        ...actualFields\n      };\n      continue;\n    }\n    schema[table.modelName] = {\n      fields: actualFields,\n      order: table.order || Infinity\n    };\n  }\n  return schema;\n}\n\n// src/db/get-migration.ts\nvar postgresMap = {\n  string: [\"character varying\", \"text\"],\n  number: [\n    \"int4\",\n    \"integer\",\n    \"bigint\",\n    \"smallint\",\n    \"numeric\",\n    \"real\",\n    \"double precision\"\n  ],\n  boolean: [\"bool\", \"boolean\"],\n  date: [\"timestamp\", \"date\"]\n};\nvar mysqlMap = {\n  string: [\"varchar\", \"text\"],\n  number: [\n    \"integer\",\n    \"int\",\n    \"bigint\",\n    \"smallint\",\n    \"decimal\",\n    \"float\",\n    \"double\"\n  ],\n  boolean: [\"boolean\", \"tinyint\"],\n  date: [\"timestamp\", \"datetime\", \"date\"]\n};\nvar sqliteMap = {\n  string: [\"TEXT\"],\n  number: [\"INTEGER\", \"REAL\"],\n  boolean: [\"INTEGER\", \"BOOLEAN\"],\n  // 0 or 1\n  date: [\"DATE\", \"INTEGER\"]\n};\nvar mssqlMap = {\n  string: [\"text\", \"varchar\"],\n  number: [\"int\", \"bigint\", \"smallint\", \"decimal\", \"float\", \"double\"],\n  boolean: [\"bit\", \"smallint\"],\n  date: [\"datetime\", \"date\"]\n};\nvar map = {\n  postgres: postgresMap,\n  mysql: mysqlMap,\n  sqlite: sqliteMap,\n  mssql: mssqlMap\n};\nfunction matchType(columnDataType, fieldType, dbType) {\n  if (fieldType === \"string[]\" || fieldType === \"number[]\") {\n    return columnDataType.toLowerCase().includes(\"json\");\n  }\n  const types = map[dbType];\n  const type = Array.isArray(fieldType) ? types[\"string\"].map((t) => t.toLowerCase()) : types[fieldType].map((t) => t.toLowerCase());\n  const matches = type.includes(columnDataType.toLowerCase());\n  return matches;\n}\nasync function getMigrations(config) {\n  const betterAuthSchema = getSchema(config);\n  const logger2 = (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.createLogger)(config.logger);\n  let { kysely: db, databaseType: dbType } = await createKyselyAdapter(config);\n  if (!dbType) {\n    logger2.warn(\n      \"Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this.\"\n    );\n    dbType = \"sqlite\";\n  }\n  if (!db) {\n    logger2.error(\n      \"Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter.\"\n    );\n    process.exit(1);\n  }\n  const tableMetadata = await db.introspection.getTables();\n  const toBeCreated = [];\n  const toBeAdded = [];\n  for (const [key, value] of Object.entries(betterAuthSchema)) {\n    const table = tableMetadata.find((t) => t.name === key);\n    if (!table) {\n      const tIndex = toBeCreated.findIndex((t) => t.table === key);\n      const tableData = {\n        table: key,\n        fields: value.fields,\n        order: value.order || Infinity\n      };\n      const insertIndex = toBeCreated.findIndex(\n        (t) => (t.order || Infinity) > tableData.order\n      );\n      if (insertIndex === -1) {\n        if (tIndex === -1) {\n          toBeCreated.push(tableData);\n        } else {\n          toBeCreated[tIndex].fields = {\n            ...toBeCreated[tIndex].fields,\n            ...value.fields\n          };\n        }\n      } else {\n        toBeCreated.splice(insertIndex, 0, tableData);\n      }\n      continue;\n    }\n    let toBeAddedFields = {};\n    for (const [fieldName, field] of Object.entries(value.fields)) {\n      const column = table.columns.find((c) => c.name === fieldName);\n      if (!column) {\n        toBeAddedFields[fieldName] = field;\n        continue;\n      }\n      if (matchType(column.dataType, field.type, dbType)) {\n        continue;\n      } else {\n        logger2.warn(\n          `Field ${fieldName} in table ${key} has a different type in the database. Expected ${field.type} but got ${column.dataType}.`\n        );\n      }\n    }\n    if (Object.keys(toBeAddedFields).length > 0) {\n      toBeAdded.push({\n        table: key,\n        fields: toBeAddedFields,\n        order: value.order || Infinity\n      });\n    }\n  }\n  const migrations = [];\n  function getType(field) {\n    const type = field.type;\n    const typeMap = {\n      string: {\n        sqlite: \"text\",\n        postgres: \"text\",\n        mysql: field.unique ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\",\n        mssql: field.unique || field.sortable ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\"\n      },\n      boolean: {\n        sqlite: \"integer\",\n        postgres: \"boolean\",\n        mysql: \"boolean\",\n        mssql: \"smallint\"\n      },\n      number: {\n        sqlite: field.bigint ? \"bigint\" : \"integer\",\n        postgres: field.bigint ? \"bigint\" : \"integer\",\n        mysql: field.bigint ? \"bigint\" : \"integer\",\n        mssql: field.bigint ? \"bigint\" : \"integer\"\n      },\n      date: {\n        sqlite: \"date\",\n        postgres: \"timestamp\",\n        mysql: \"datetime\",\n        mssql: \"datetime\"\n      }\n    };\n    if (dbType === \"sqlite\" && (type === \"string[]\" || type === \"number[]\")) {\n      return \"text\";\n    }\n    if (type === \"string[]\" || type === \"number[]\") {\n      return \"jsonb\";\n    }\n    if (Array.isArray(type)) {\n      return \"text\";\n    }\n    return typeMap[type][dbType || \"sqlite\"];\n  }\n  if (toBeAdded.length) {\n    for (const table of toBeAdded) {\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field);\n        const exec = db.schema.alterTable(table.table).addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            );\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          return col;\n        });\n        migrations.push(exec);\n      }\n    }\n  }\n  if (toBeCreated.length) {\n    for (const table of toBeCreated) {\n      let dbT = db.schema.createTable(table.table).addColumn(\n        \"id\",\n        dbType === \"mysql\" || dbType === \"mssql\" ? \"varchar(36)\" : \"text\",\n        (col) => col.primaryKey().notNull()\n      );\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field);\n        dbT = dbT.addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            );\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          return col;\n        });\n      }\n      migrations.push(dbT);\n    }\n  }\n  async function runMigrations() {\n    for (const migration of migrations) {\n      await migration.execute();\n    }\n  }\n  async function compileMigrations() {\n    const compiled = migrations.map((m) => m.compile().sql);\n    return compiled.join(\";\\n\\n\");\n  }\n  return { toBeCreated, toBeAdded, runMigrations, compileMigrations };\n}\n\n// src/adapters/kysely-adapter/kysely-adapter.ts\nvar createTransform2 = (db, options, config) => {\n  const schema = getAuthTables(options);\n  function getField(model, field) {\n    if (field === \"id\") {\n      return field;\n    }\n    const f = schema[model].fields[field];\n    if (!f) {\n      console.log(\"Field not found\", model, field);\n    }\n    return f.fieldName || field;\n  }\n  function transformValueToDB(value, model, field) {\n    const { type = \"sqlite\" } = config || {};\n    const f = schema[model].fields[field];\n    if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null && value !== void 0) {\n      return value ? 1 : 0;\n    }\n    if (f.type === \"date\" && value && value instanceof Date) {\n      return type === \"sqlite\" ? value.toISOString() : value;\n    }\n    return value;\n  }\n  function transformValueFromDB(value, model, field) {\n    const { type = \"sqlite\" } = config || {};\n    const f = schema[model].fields[field];\n    if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null) {\n      return value === 1;\n    }\n    if (f.type === \"date\" && value) {\n      return new Date(value);\n    }\n    return value;\n  }\n  function getModelName(model) {\n    return schema[model].modelName;\n  }\n  const useDatabaseGeneratedId = options?.advanced?.generateId === false;\n  return {\n    transformInput(data, model, action) {\n      const transformedData = useDatabaseGeneratedId || action === \"update\" ? {} : {\n        id: options.advanced?.generateId ? options.advanced.generateId({\n          model\n        }) : data.id || (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.generateId)()\n      };\n      const fields = schema[model].fields;\n      for (const field in fields) {\n        const value = data[field];\n        transformedData[fields[field].fieldName || field] = withApplyDefault(\n          transformValueToDB(value, model, field),\n          fields[field],\n          action\n        );\n      }\n      return transformedData;\n    },\n    transformOutput(data, model, select = []) {\n      if (!data) return null;\n      const transformedData = data.id ? select.length === 0 || select.includes(\"id\") ? {\n        id: data.id\n      } : {} : {};\n      const tableSchema = schema[model].fields;\n      for (const key in tableSchema) {\n        if (select.length && !select.includes(key)) {\n          continue;\n        }\n        const field = tableSchema[key];\n        if (field) {\n          transformedData[key] = transformValueFromDB(\n            data[field.fieldName || key],\n            model,\n            key\n          );\n        }\n      }\n      return transformedData;\n    },\n    convertWhereClause(model, w) {\n      if (!w)\n        return {\n          and: null,\n          or: null\n        };\n      const conditions = {\n        and: [],\n        or: []\n      };\n      w.forEach((condition) => {\n        const {\n          field: _field,\n          value,\n          operator = \"=\",\n          connector = \"AND\"\n        } = condition;\n        const field = getField(model, _field);\n        const expr = (eb) => {\n          if (operator.toLowerCase() === \"in\") {\n            return eb(field, \"in\", Array.isArray(value) ? value : [value]);\n          }\n          if (operator === \"contains\") {\n            return eb(field, \"like\", `%${value}%`);\n          }\n          if (operator === \"starts_with\") {\n            return eb(field, \"like\", `${value}%`);\n          }\n          if (operator === \"ends_with\") {\n            return eb(field, \"like\", `%${value}`);\n          }\n          if (operator === \"eq\") {\n            return eb(field, \"=\", value);\n          }\n          if (operator === \"ne\") {\n            return eb(field, \"<>\", value);\n          }\n          if (operator === \"gt\") {\n            return eb(field, \">\", value);\n          }\n          if (operator === \"gte\") {\n            return eb(field, \">=\", value);\n          }\n          if (operator === \"lt\") {\n            return eb(field, \"<\", value);\n          }\n          if (operator === \"lte\") {\n            return eb(field, \"<=\", value);\n          }\n          return eb(field, operator, value);\n        };\n        if (connector === \"OR\") {\n          conditions.or.push(expr);\n        } else {\n          conditions.and.push(expr);\n        }\n      });\n      return {\n        and: conditions.and.length ? conditions.and : null,\n        or: conditions.or.length ? conditions.or : null\n      };\n    },\n    async withReturning(values, builder, model, where) {\n      let res;\n      if (config?.type === \"mysql\") {\n        await builder.execute();\n        const field = values.id ? \"id\" : where[0].field ? where[0].field : \"id\";\n        const value = values[field] || where[0].value;\n        res = await db.selectFrom(getModelName(model)).selectAll().where(getField(model, field), \"=\", value).executeTakeFirst();\n        return res;\n      }\n      if (config?.type === \"mssql\") {\n        res = await builder.outputAll(\"inserted\").executeTakeFirst();\n        return res;\n      }\n      res = await builder.returningAll().executeTakeFirst();\n      return res;\n    },\n    getModelName,\n    getField\n  };\n};\nvar kyselyAdapter = (db, config) => (opts) => {\n  const {\n    transformInput,\n    withReturning,\n    transformOutput,\n    convertWhereClause,\n    getModelName,\n    getField\n  } = createTransform2(db, opts, config);\n  return {\n    id: \"kysely\",\n    async create(data) {\n      const { model, data: values, select } = data;\n      const transformed = transformInput(values, model, \"create\");\n      const builder = db.insertInto(getModelName(model)).values(transformed);\n      return transformOutput(\n        await withReturning(transformed, builder, model, []),\n        model,\n        select\n      );\n    },\n    async findOne(data) {\n      const { model, where, select } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.selectFrom(getModelName(model)).selectAll();\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      const res = await query.executeTakeFirst();\n      if (!res) return null;\n      return transformOutput(res, model, select);\n    },\n    async findMany(data) {\n      const { model, where, limit, offset, sortBy } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.selectFrom(getModelName(model));\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      if (config?.type === \"mssql\") {\n        if (!offset) {\n          query = query.top(limit || 100);\n        }\n      } else {\n        query = query.limit(limit || 100);\n      }\n      if (sortBy) {\n        query = query.orderBy(\n          getField(model, sortBy.field),\n          sortBy.direction\n        );\n      }\n      if (offset) {\n        if (config?.type === \"mssql\") {\n          if (!sortBy) {\n            query = query.orderBy(getField(model, \"id\"));\n          }\n          query = query.offset(offset).fetch(limit || 100);\n        } else {\n          query = query.offset(offset);\n        }\n      }\n      const res = await query.selectAll().execute();\n      if (!res) return [];\n      return res.map((r) => transformOutput(r, model));\n    },\n    async update(data) {\n      const { model, where, update: values } = data;\n      const { and, or } = convertWhereClause(model, where);\n      const transformedData = transformInput(values, model, \"update\");\n      let query = db.updateTable(getModelName(model)).set(transformedData);\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      const res = await transformOutput(\n        await withReturning(transformedData, query, model, where),\n        model\n      );\n      return res;\n    },\n    async updateMany(data) {\n      const { model, where, update: values } = data;\n      const { and, or } = convertWhereClause(model, where);\n      const transformedData = transformInput(values, model, \"update\");\n      let query = db.updateTable(getModelName(model)).set(transformedData);\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      const res = await query.execute();\n      return res.length;\n    },\n    async delete(data) {\n      const { model, where } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.deleteFrom(getModelName(model));\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      await query.execute();\n    },\n    async deleteMany(data) {\n      const { model, where } = data;\n      const { and, or } = convertWhereClause(model, where);\n      let query = db.deleteFrom(getModelName(model));\n      if (and) {\n        query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n      }\n      if (or) {\n        query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n      }\n      return (await query.execute()).length;\n    },\n    options: config\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTYyTVdMTEVHLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWlGO0FBQ1Y7QUFDbkI7QUFDTjtBQUNRO0FBQ3NDO0FBQ3BFOztBQUV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFhO0FBQ25DO0FBQ0E7QUFDQSxzQkFBc0IsZ0RBQVk7QUFDbEM7QUFDQTtBQUNBLHNCQUFzQixtREFBZTtBQUNyQztBQUNBO0FBQ0Esc0JBQXNCLGdEQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwyQ0FBTSxHQUFHLHFCQUFxQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQWE7QUFDL0I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGtCQUFrQixnREFBWTtBQUM5QjtBQUNBO0FBQ0Esa0JBQWtCLG1EQUFlO0FBQ2pDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwwQkFBMEIsMkNBQU0sR0FBRyxTQUFTO0FBQzVDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsV0FBVywrQkFBK0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFdBQVcsd0JBQXdCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSwwQ0FBMEM7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0EsK0ZBQStGO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNU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QUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhCQUE4QjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsdUJBQXVCO0FBQ3JDLGNBQWMsVUFBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsc0NBQXNDO0FBQ3BELGNBQWMsVUFBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYywrQkFBK0I7QUFDN0MsY0FBYyxVQUFVO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYywrQkFBK0I7QUFDN0MsY0FBYyxVQUFVO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYyxlQUFlO0FBQzdCLGNBQWMsVUFBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYyxlQUFlO0FBQzdCLGNBQWMsVUFBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFbVAiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay02Mk1XTExFRy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXJzZVNlc3Npb25PdXRwdXQsIGdldElwLCBwYXJzZVVzZXJPdXRwdXQgfSBmcm9tICcuL2NodW5rLVdaNk9JVkpLLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlSWQsIGxvZ2dlciwgY3JlYXRlTG9nZ2VyIH0gZnJvbSAnLi9jaHVuay1LTERGQkxZTC5qcyc7XG5pbXBvcnQgeyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi9jaHVuay01M0lQTzJQSi5qcyc7XG5pbXBvcnQgeyBnZXREYXRlIH0gZnJvbSAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICcuL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IEt5c2VseSwgU3FsaXRlRGlhbGVjdCwgTXlzcWxEaWFsZWN0LCBQb3N0Z3Jlc0RpYWxlY3QsIE1zc3FsRGlhbGVjdCB9IGZyb20gJ2t5c2VseSc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuZnVuY3Rpb24gZ2V0RGF0YWJhc2VUeXBlKGRiKSB7XG4gIGlmICghZGIpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoXCJkaWFsZWN0XCIgaW4gZGIpIHtcbiAgICByZXR1cm4gZ2V0RGF0YWJhc2VUeXBlKGRiLmRpYWxlY3QpO1xuICB9XG4gIGlmIChcImNyZWF0ZURyaXZlclwiIGluIGRiKSB7XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgU3FsaXRlRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwic3FsaXRlXCI7XG4gICAgfVxuICAgIGlmIChkYiBpbnN0YW5jZW9mIE15c3FsRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwibXlzcWxcIjtcbiAgICB9XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgUG9zdGdyZXNEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJwb3N0Z3Jlc1wiO1xuICAgIH1cbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBNc3NxbERpYWxlY3QpIHtcbiAgICAgIHJldHVybiBcIm1zc3FsXCI7XG4gICAgfVxuICB9XG4gIGlmIChcImFnZ3JlZ2F0ZVwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwic3FsaXRlXCI7XG4gIH1cbiAgaWYgKFwiZ2V0Q29ubmVjdGlvblwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwibXlzcWxcIjtcbiAgfVxuICBpZiAoXCJjb25uZWN0XCIgaW4gZGIpIHtcbiAgICByZXR1cm4gXCJwb3N0Z3Jlc1wiO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxudmFyIGNyZWF0ZUt5c2VseUFkYXB0ZXIgPSBhc3luYyAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGRiID0gY29uZmlnLmRhdGFiYXNlO1xuICBpZiAoIWRiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGt5c2VseTogbnVsbCxcbiAgICAgIGRhdGFiYXNlVHlwZTogbnVsbFxuICAgIH07XG4gIH1cbiAgaWYgKFwiZGJcIiBpbiBkYikge1xuICAgIHJldHVybiB7XG4gICAgICBreXNlbHk6IGRiLmRiLFxuICAgICAgZGF0YWJhc2VUeXBlOiBkYi50eXBlXG4gICAgfTtcbiAgfVxuICBpZiAoXCJkaWFsZWN0XCIgaW4gZGIpIHtcbiAgICByZXR1cm4ge1xuICAgICAga3lzZWx5OiBuZXcgS3lzZWx5KHsgZGlhbGVjdDogZGIuZGlhbGVjdCB9KSxcbiAgICAgIGRhdGFiYXNlVHlwZTogZGIudHlwZVxuICAgIH07XG4gIH1cbiAgbGV0IGRpYWxlY3QgPSB2b2lkIDA7XG4gIGNvbnN0IGRhdGFiYXNlVHlwZSA9IGdldERhdGFiYXNlVHlwZShkYik7XG4gIGlmIChcImNyZWF0ZURyaXZlclwiIGluIGRiKSB7XG4gICAgZGlhbGVjdCA9IGRiO1xuICB9XG4gIGlmIChcImFnZ3JlZ2F0ZVwiIGluIGRiKSB7XG4gICAgZGlhbGVjdCA9IG5ldyBTcWxpdGVEaWFsZWN0KHtcbiAgICAgIGRhdGFiYXNlOiBkYlxuICAgIH0pO1xuICB9XG4gIGlmIChcImdldENvbm5lY3Rpb25cIiBpbiBkYikge1xuICAgIGRpYWxlY3QgPSBuZXcgTXlzcWxEaWFsZWN0KGRiKTtcbiAgfVxuICBpZiAoXCJjb25uZWN0XCIgaW4gZGIpIHtcbiAgICBkaWFsZWN0ID0gbmV3IFBvc3RncmVzRGlhbGVjdCh7XG4gICAgICBwb29sOiBkYlxuICAgIH0pO1xuICB9XG4gIHJldHVybiB7XG4gICAga3lzZWx5OiBkaWFsZWN0ID8gbmV3IEt5c2VseSh7IGRpYWxlY3QgfSkgOiBudWxsLFxuICAgIGRhdGFiYXNlVHlwZVxuICB9O1xufTtcblxuLy8gc3JjL2RiL3dpdGgtaG9va3MudHNcbmZ1bmN0aW9uIGdldFdpdGhIb29rcyhhZGFwdGVyLCBjdHgpIHtcbiAgY29uc3QgaG9va3MgPSBjdHguaG9va3M7XG4gIGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVdpdGhIb29rcyhkYXRhLCBtb2RlbCwgY3VzdG9tQ3JlYXRlRm4pIHtcbiAgICBsZXQgYWN0dWFsRGF0YSA9IGRhdGE7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy5jcmVhdGU/LmJlZm9yZTtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b1J1bihhY3R1YWxEYXRhKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc09iamVjdCA9IHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCIgJiYgXCJkYXRhXCIgaW4gcmVzdWx0O1xuICAgICAgICBpZiAoaXNPYmplY3QpIHtcbiAgICAgICAgICBhY3R1YWxEYXRhID0ge1xuICAgICAgICAgICAgLi4uYWN0dWFsRGF0YSxcbiAgICAgICAgICAgIC4uLnJlc3VsdC5kYXRhXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjdXN0b21DcmVhdGVkID0gY3VzdG9tQ3JlYXRlRm4gPyBhd2FpdCBjdXN0b21DcmVhdGVGbi5mbihhY3R1YWxEYXRhKSA6IG51bGw7XG4gICAgY29uc3QgY3JlYXRlZCA9ICFjdXN0b21DcmVhdGVGbiB8fCBjdXN0b21DcmVhdGVGbi5leGVjdXRlTWFpbkZuID8gYXdhaXQgYWRhcHRlci5jcmVhdGUoe1xuICAgICAgbW9kZWwsXG4gICAgICBkYXRhOiBhY3R1YWxEYXRhXG4gICAgfSkgOiBjdXN0b21DcmVhdGVkO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8uY3JlYXRlPy5hZnRlcjtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBhd2FpdCB0b1J1bihjcmVhdGVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZWQ7XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlV2l0aEhvb2tzKGRhdGEsIHdoZXJlLCBtb2RlbCwgY3VzdG9tVXBkYXRlRm4pIHtcbiAgICBsZXQgYWN0dWFsRGF0YSA9IGRhdGE7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy51cGRhdGU/LmJlZm9yZTtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b1J1bihkYXRhKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc09iamVjdCA9IHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCI7XG4gICAgICAgIGFjdHVhbERhdGEgPSBpc09iamVjdCA/IHJlc3VsdC5kYXRhIDogcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjdXN0b21VcGRhdGVkID0gY3VzdG9tVXBkYXRlRm4gPyBhd2FpdCBjdXN0b21VcGRhdGVGbi5mbihhY3R1YWxEYXRhKSA6IG51bGw7XG4gICAgY29uc3QgdXBkYXRlZCA9ICFjdXN0b21VcGRhdGVGbiB8fCBjdXN0b21VcGRhdGVGbi5leGVjdXRlTWFpbkZuID8gYXdhaXQgYWRhcHRlci51cGRhdGUoe1xuICAgICAgbW9kZWwsXG4gICAgICB1cGRhdGU6IGFjdHVhbERhdGEsXG4gICAgICB3aGVyZVxuICAgIH0pIDogY3VzdG9tVXBkYXRlZDtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYWZ0ZXI7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgYXdhaXQgdG9SdW4odXBkYXRlZCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVkO1xuICB9XG4gIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU1hbnlXaXRoSG9va3MoZGF0YSwgd2hlcmUsIG1vZGVsLCBjdXN0b21VcGRhdGVGbikge1xuICAgIGxldCBhY3R1YWxEYXRhID0gZGF0YTtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYmVmb3JlO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvUnVuKGRhdGEpO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzT2JqZWN0ID0gdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIjtcbiAgICAgICAgYWN0dWFsRGF0YSA9IGlzT2JqZWN0ID8gcmVzdWx0LmRhdGEgOiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbVVwZGF0ZWQgPSBjdXN0b21VcGRhdGVGbiA/IGF3YWl0IGN1c3RvbVVwZGF0ZUZuLmZuKGFjdHVhbERhdGEpIDogbnVsbDtcbiAgICBjb25zdCB1cGRhdGVkID0gIWN1c3RvbVVwZGF0ZUZuIHx8IGN1c3RvbVVwZGF0ZUZuLmV4ZWN1dGVNYWluRm4gPyBhd2FpdCBhZGFwdGVyLnVwZGF0ZU1hbnkoe1xuICAgICAgbW9kZWwsXG4gICAgICB1cGRhdGU6IGFjdHVhbERhdGEsXG4gICAgICB3aGVyZVxuICAgIH0pIDogY3VzdG9tVXBkYXRlZDtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LnVwZGF0ZT8uYWZ0ZXI7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgYXdhaXQgdG9SdW4odXBkYXRlZCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVkO1xuICB9XG4gIHJldHVybiB7XG4gICAgY3JlYXRlV2l0aEhvb2tzLFxuICAgIHVwZGF0ZVdpdGhIb29rcyxcbiAgICB1cGRhdGVNYW55V2l0aEhvb2tzXG4gIH07XG59XG5cbi8vIHNyYy9kYi9pbnRlcm5hbC1hZGFwdGVyLnRzXG52YXIgY3JlYXRlSW50ZXJuYWxBZGFwdGVyID0gKGFkYXB0ZXIsIGN0eCkgPT4ge1xuICBjb25zdCBvcHRpb25zID0gY3R4Lm9wdGlvbnM7XG4gIGNvbnN0IHNlY29uZGFyeVN0b3JhZ2UgPSBvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2U7XG4gIGNvbnN0IHNlc3Npb25FeHBpcmF0aW9uID0gb3B0aW9ucy5zZXNzaW9uPy5leHBpcmVzSW4gfHwgNjAgKiA2MCAqIDI0ICogNztcbiAgY29uc3QgeyBjcmVhdGVXaXRoSG9va3MsIHVwZGF0ZVdpdGhIb29rcywgdXBkYXRlTWFueVdpdGhIb29rcyB9ID0gZ2V0V2l0aEhvb2tzKGFkYXB0ZXIsIGN0eCk7XG4gIHJldHVybiB7XG4gICAgY3JlYXRlT0F1dGhVc2VyOiBhc3luYyAodXNlciwgYWNjb3VudCkgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlZFVzZXIgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgLi4udXNlclxuICAgICAgICB9LFxuICAgICAgICBcInVzZXJcIlxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNyZWF0ZWRBY2NvdW50ID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLi4uYWNjb3VudCxcbiAgICAgICAgICB1c2VySWQ6IGNyZWF0ZWRVc2VyLmlkIHx8IHVzZXIuaWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIFwiYWNjb3VudFwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgIGFjY291bnQ6IGNyZWF0ZWRBY2NvdW50XG4gICAgICB9O1xuICAgIH0sXG4gICAgY3JlYXRlVXNlcjogYXN5bmMgKHVzZXIpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZWRVc2VyID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgIC4uLnVzZXIsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwudG9Mb3dlckNhc2UoKVxuICAgICAgICB9LFxuICAgICAgICBcInVzZXJcIlxuICAgICAgKTtcbiAgICAgIHJldHVybiBjcmVhdGVkVXNlcjtcbiAgICB9LFxuICAgIGNyZWF0ZUFjY291bnQ6IGFzeW5jIChhY2NvdW50KSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVkQWNjb3VudCA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5hY2NvdW50XG4gICAgICAgIH0sXG4gICAgICAgIFwiYWNjb3VudFwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIGNyZWF0ZWRBY2NvdW50O1xuICAgIH0sXG4gICAgbGlzdFNlc3Npb25zOiBhc3luYyAodXNlcklkKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBjb25zdCBjdXJyZW50TGlzdCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KFxuICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YFxuICAgICAgICApO1xuICAgICAgICBpZiAoIWN1cnJlbnRMaXN0KSByZXR1cm4gW107XG4gICAgICAgIGNvbnN0IGxpc3QgPSBzYWZlSlNPTlBhcnNlKGN1cnJlbnRMaXN0KSB8fCBbXTtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgY29uc3QgdmFsaWRTZXNzaW9ucyA9IGxpc3QuZmlsdGVyKChzKSA9PiBzLmV4cGlyZXNBdCA+IG5vdyk7XG4gICAgICAgIGNvbnN0IHNlc3Npb25zMiA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb24gb2YgdmFsaWRTZXNzaW9ucykge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25TdHJpbmdpZmllZCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHNlc3Npb24udG9rZW4pO1xuICAgICAgICAgIGlmIChzZXNzaW9uU3RyaW5naWZpZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBKU09OLnBhcnNlKHNlc3Npb25TdHJpbmdpZmllZCk7XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRTZXNzaW9uID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCB7XG4gICAgICAgICAgICAgIC4uLnMuc2Vzc2lvbixcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXNzaW9uczIucHVzaChwYXJzZWRTZXNzaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlc3Npb25zMjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNlc3Npb25zO1xuICAgIH0sXG4gICAgbGlzdFVzZXJzOiBhc3luYyAobGltaXQsIG9mZnNldCwgc29ydEJ5LCB3aGVyZSkgPT4ge1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgb2Zmc2V0LFxuICAgICAgICBzb3J0QnksXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1c2VycztcbiAgICB9LFxuICAgIGRlbGV0ZVVzZXI6IGFzeW5jICh1c2VySWQpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCk7XG4gICAgICB9XG4gICAgICBpZiAoIXNlY29uZGFyeVN0b3JhZ2UgfHwgb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlTWFueSh7XG4gICAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY3JlYXRlU2Vzc2lvbjogYXN5bmMgKHVzZXJJZCwgcmVxdWVzdCwgZG9udFJlbWVtYmVyTWUsIG92ZXJyaWRlLCBvdmVycmlkZUFsbCkgPT4ge1xuICAgICAgY29uc3QgaGVhZGVycyA9IHJlcXVlc3QgaW5zdGFuY2VvZiBSZXF1ZXN0ID8gcmVxdWVzdC5oZWFkZXJzIDogcmVxdWVzdDtcbiAgICAgIGNvbnN0IHsgaWQ6IF8sIC4uLnJlc3QgfSA9IG92ZXJyaWRlIHx8IHt9O1xuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgaXBBZGRyZXNzOiByZXF1ZXN0ID8gZ2V0SXAocmVxdWVzdCwgY3R4Lm9wdGlvbnMpIHx8IFwiXCIgOiBcIlwiLFxuICAgICAgICB1c2VyQWdlbnQ6IGhlYWRlcnM/LmdldChcInVzZXItYWdlbnRcIikgfHwgXCJcIixcbiAgICAgICAgLi4ucmVzdCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRoZSB1c2VyIGRvZXNuJ3Qgd2FudCB0byBiZSByZW1lbWJlcmVkXG4gICAgICAgICAqIHNldCB0aGUgc2Vzc2lvbiB0byBleHBpcmUgaW4gMSBkYXkuXG4gICAgICAgICAqIFRoZSBjb29raWUgd2lsbCBiZSBzZXQgdG8gZXhwaXJlIGF0IHRoZSBlbmQgb2YgdGhlIHNlc3Npb25cbiAgICAgICAgICovXG4gICAgICAgIGV4cGlyZXNBdDogZG9udFJlbWVtYmVyTWUgPyBnZXREYXRlKDYwICogNjAgKiAyNCwgXCJzZWNcIikgOiBnZXREYXRlKHNlc3Npb25FeHBpcmF0aW9uLCBcInNlY1wiKSxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICB0b2tlbjogZ2VuZXJhdGVJZCgzMiksXG4gICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIC4uLm92ZXJyaWRlQWxsID8gcmVzdCA6IHt9XG4gICAgICB9O1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBcInNlc3Npb25cIixcbiAgICAgICAgc2Vjb25kYXJ5U3RvcmFnZSA/IHtcbiAgICAgICAgICBmbjogYXN5bmMgKHNlc3Npb25EYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50TGlzdCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KFxuICAgICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBsZXQgbGlzdCA9IFtdO1xuICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50TGlzdCkge1xuICAgICAgICAgICAgICBsaXN0ID0gc2FmZUpTT05QYXJzZShjdXJyZW50TGlzdCkgfHwgW107XG4gICAgICAgICAgICAgIGxpc3QgPSBsaXN0LmZpbHRlcigoc2Vzc2lvbikgPT4gc2Vzc2lvbi5leHBpcmVzQXQgPiBub3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGlzdC5wdXNoKHtcbiAgICAgICAgICAgICAgdG9rZW46IGRhdGEudG9rZW4sXG4gICAgICAgICAgICAgIGV4cGlyZXNBdDogbm93ICsgc2Vzc2lvbkV4cGlyYXRpb24gKiAxZTNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5zZXQoXG4gICAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCxcbiAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkobGlzdCksXG4gICAgICAgICAgICAgIHNlc3Npb25FeHBpcmF0aW9uXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIHNlc3Npb25EYXRhO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0ZU1haW5Gbjogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlXG4gICAgICAgIH0gOiB2b2lkIDBcbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgZmluZFNlc3Npb246IGFzeW5jICh0b2tlbikgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQodG9rZW4pO1xuICAgICAgICBpZiAoIXNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHMgPSBKU09OLnBhcnNlKHNlc3Npb25TdHJpbmdpZmllZCk7XG4gICAgICAgIGNvbnN0IHBhcnNlZFNlc3Npb24yID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCB7XG4gICAgICAgICAgLi4ucy5zZXNzaW9uLFxuICAgICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUocy5zZXNzaW9uLmV4cGlyZXNBdCksXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShzLnNlc3Npb24uY3JlYXRlZEF0KSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi51cGRhdGVkQXQpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwYXJzZWRVc2VyMiA9IHBhcnNlVXNlck91dHB1dChjdHgub3B0aW9ucywge1xuICAgICAgICAgIC4uLnMudXNlcixcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHMudXNlci5jcmVhdGVkQXQpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocy51c2VyLnVwZGF0ZWRBdClcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc2Vzc2lvbjogcGFyc2VkU2Vzc2lvbjIsXG4gICAgICAgICAgdXNlcjogcGFyc2VkVXNlcjJcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IHRva2VuLFxuICAgICAgICAgICAgZmllbGQ6IFwidG9rZW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uLnVzZXJJZCxcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbiA9IHBhcnNlU2Vzc2lvbk91dHB1dChjdHgub3B0aW9ucywgc2Vzc2lvbik7XG4gICAgICBjb25zdCBwYXJzZWRVc2VyID0gcGFyc2VVc2VyT3V0cHV0KGN0eC5vcHRpb25zLCB1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNlc3Npb246IHBhcnNlZFNlc3Npb24sXG4gICAgICAgIHVzZXI6IHBhcnNlZFVzZXJcbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kU2Vzc2lvbnM6IGFzeW5jIChzZXNzaW9uVG9rZW5zKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBjb25zdCBzZXNzaW9uczIgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzZXNzaW9uVG9rZW4gb2Ygc2Vzc2lvblRva2Vucykge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25TdHJpbmdpZmllZCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHNlc3Npb25Ub2tlbik7XG4gICAgICAgICAgaWYgKHNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0cmluZ2lmaWVkKTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSB7XG4gICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAuLi5zLnNlc3Npb24sXG4gICAgICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgLi4ucy51c2VyLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy51c2VyLmNyZWF0ZWRBdCksXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShzLnVzZXIudXBkYXRlZEF0KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2Vzc2lvbnMyLnB1c2goc2Vzc2lvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXNzaW9uczI7XG4gICAgICB9XG4gICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidG9rZW5cIixcbiAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uVG9rZW5zLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFwiaW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBjb25zdCB1c2VySWRzID0gc2Vzc2lvbnMubWFwKChzZXNzaW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBzZXNzaW9uLnVzZXJJZDtcbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VySWRzLmxlbmd0aCkgcmV0dXJuIFtdO1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkcyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBcImluXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNlc3Npb25zLm1hcCgoc2Vzc2lvbikgPT4ge1xuICAgICAgICBjb25zdCB1c2VyID0gdXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gc2Vzc2lvbi51c2VySWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgdXNlclxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSxcbiAgICB1cGRhdGVTZXNzaW9uOiBhc3luYyAoc2Vzc2lvblRva2VuLCBzZXNzaW9uKSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbiA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgW3sgZmllbGQ6IFwidG9rZW5cIiwgdmFsdWU6IHNlc3Npb25Ub2tlbiB9XSxcbiAgICAgICAgXCJzZXNzaW9uXCIsXG4gICAgICAgIHNlY29uZGFyeVN0b3JhZ2UgPyB7XG4gICAgICAgICAgYXN5bmMgZm4oZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgbGV0IHVwZGF0ZWRTZXNzaW9uMiA9IG51bGw7XG4gICAgICAgICAgICBpZiAoY3VycmVudFNlc3Npb24pIHtcbiAgICAgICAgICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbiA9IEpTT04ucGFyc2UoY3VycmVudFNlc3Npb24pO1xuICAgICAgICAgICAgICB1cGRhdGVkU2Vzc2lvbjIgPSB7XG4gICAgICAgICAgICAgICAgLi4ucGFyc2VkU2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgICAgICAgICAgIC4uLmRhdGFcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9uMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0ZU1haW5Gbjogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlXG4gICAgICAgIH0gOiB2b2lkIDBcbiAgICAgICk7XG4gICAgICByZXR1cm4gdXBkYXRlZFNlc3Npb247XG4gICAgfSxcbiAgICBkZWxldGVTZXNzaW9uOiBhc3luYyAodG9rZW4pID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKHRva2VuKTtcbiAgICAgICAgaWYgKCFvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgfHwgY3R4Lm9wdGlvbnMuc2Vzc2lvbj8ucHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidG9rZW5cIixcbiAgICAgICAgICAgIHZhbHVlOiB0b2tlblxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGVBY2NvdW50czogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGVBY2NvdW50OiBhc3luYyAocHJvdmlkZXJJZCwgdXNlcklkKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogcHJvdmlkZXJJZFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZVNlc3Npb25zOiBhc3luYyAodXNlcklkT3JTZXNzaW9uVG9rZW5zKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBpZiAodHlwZW9mIHVzZXJJZE9yU2Vzc2lvblRva2VucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGNvbnN0IGFjdGl2ZVNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChcbiAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWRPclNlc3Npb25Ub2tlbnN9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhY3RpdmVTZXNzaW9uID8gc2FmZUpTT05QYXJzZShhY3RpdmVTZXNzaW9uKSA6IFtdO1xuICAgICAgICAgIGlmICghc2Vzc2lvbnMpIHJldHVybjtcbiAgICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb24gb2Ygc2Vzc2lvbnMpIHtcbiAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKHNlc3Npb24udG9rZW4pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb25Ub2tlbiBvZiB1c2VySWRPclNlc3Npb25Ub2tlbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgaWYgKHNlc3Npb24pIHtcbiAgICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgfHwgY3R4Lm9wdGlvbnMuc2Vzc2lvbj8ucHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBBcnJheS5pc0FycmF5KHVzZXJJZE9yU2Vzc2lvblRva2VucykgPyBcInRva2VuXCIgOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZE9yU2Vzc2lvblRva2VucyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBBcnJheS5pc0FycmF5KHVzZXJJZE9yU2Vzc2lvblRva2VucykgPyBcImluXCIgOiB2b2lkIDBcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZmluZE9BdXRoVXNlcjogYXN5bmMgKGVtYWlsLCBhY2NvdW50SWQsIHByb3ZpZGVySWQpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFsdWU6IGFjY291bnRJZCxcbiAgICAgICAgICAgIGZpZWxkOiBcImFjY291bnRJZFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB2YWx1ZTogcHJvdmlkZXJJZCxcbiAgICAgICAgICAgIGZpZWxkOiBcInByb3ZpZGVySWRcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoYWNjb3VudCkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IGFjY291bnQudXNlcklkLFxuICAgICAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgIGFjY291bnRzOiBbYWNjb3VudF1cbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWQsXG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYWNjb3VudHM6IGFjY291bnRzIHx8IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgZmluZFVzZXJCeUVtYWlsOiBhc3luYyAoZW1haWwsIG9wdGlvbnMyKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBlbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuICAgICAgaWYgKG9wdGlvbnMyPy5pbmNsdWRlQWNjb3VudHMpIHtcbiAgICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWQsXG4gICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIGFjY291bnRzXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyLFxuICAgICAgICBhY2NvdW50czogW11cbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kVXNlckJ5SWQ6IGFzeW5jICh1c2VySWQpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSxcbiAgICBsaW5rQWNjb3VudDogYXN5bmMgKGFjY291bnQpID0+IHtcbiAgICAgIGNvbnN0IF9hY2NvdW50ID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLi4uYWNjb3VudCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgfSxcbiAgICAgICAgXCJhY2NvdW50XCJcbiAgICAgICk7XG4gICAgICByZXR1cm4gX2FjY291bnQ7XG4gICAgfSxcbiAgICB1cGRhdGVVc2VyOiBhc3luYyAodXNlcklkLCBkYXRhKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwidXNlclwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSxcbiAgICB1cGRhdGVVc2VyQnlFbWFpbDogYXN5bmMgKGVtYWlsLCBkYXRhKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIixcbiAgICAgICAgICAgIHZhbHVlOiBlbWFpbC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcInVzZXJcIlxuICAgICAgKTtcbiAgICAgIHJldHVybiB1c2VyO1xuICAgIH0sXG4gICAgdXBkYXRlUGFzc3dvcmQ6IGFzeW5jICh1c2VySWQsIHBhc3N3b3JkKSA9PiB7XG4gICAgICBhd2FpdCB1cGRhdGVNYW55V2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgcGFzc3dvcmRcbiAgICAgICAgfSxcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwicHJvdmlkZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IFwiY3JlZGVudGlhbFwiXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcImFjY291bnRcIlxuICAgICAgKTtcbiAgICB9LFxuICAgIGZpbmRBY2NvdW50czogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjb3VudHM7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudDogYXN5bmMgKGFjY291bnRJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJhY2NvdW50SWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBhY2NvdW50SWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudEJ5VXNlcklkOiBhc3luYyAodXNlcklkKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICB1cGRhdGVBY2NvdW50OiBhc3luYyAoYWNjb3VudElkLCBkYXRhKSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbeyBmaWVsZDogXCJpZFwiLCB2YWx1ZTogYWNjb3VudElkIH1dLFxuICAgICAgICBcImFjY291bnRcIlxuICAgICAgKTtcbiAgICAgIHJldHVybiBhY2NvdW50O1xuICAgIH0sXG4gICAgY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWU6IGFzeW5jIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgLi4uZGF0YVxuICAgICAgICB9LFxuICAgICAgICBcInZlcmlmaWNhdGlvblwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHZlcmlmaWNhdGlvbjtcbiAgICB9LFxuICAgIGZpbmRWZXJpZmljYXRpb25WYWx1ZTogYXN5bmMgKGlkZW50aWZpZXIpID0+IHtcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZGVudGlmaWVyXCIsXG4gICAgICAgICAgICB2YWx1ZTogaWRlbnRpZmllclxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgc29ydEJ5OiB7XG4gICAgICAgICAgZmllbGQ6IFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgZGlyZWN0aW9uOiBcImRlc2NcIlxuICAgICAgICB9LFxuICAgICAgICBsaW1pdDogMVxuICAgICAgfSk7XG4gICAgICBjb25zdCBsYXN0VmVyaWZpY2F0aW9uID0gdmVyaWZpY2F0aW9uWzBdO1xuICAgICAgcmV0dXJuIGxhc3RWZXJpZmljYXRpb247XG4gICAgfSxcbiAgICBkZWxldGVWZXJpZmljYXRpb25WYWx1ZTogYXN5bmMgKGlkKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogaWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlVmVyaWZpY2F0aW9uQnlJZGVudGlmaWVyOiBhc3luYyAoaWRlbnRpZmllcikgPT4ge1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJpZGVudGlmaWVyXCIsXG4gICAgICAgICAgICB2YWx1ZTogaWRlbnRpZmllclxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB1cGRhdGVWZXJpZmljYXRpb25WYWx1ZTogYXN5bmMgKGlkLCBkYXRhKSA9PiB7XG4gICAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFt7IGZpZWxkOiBcImlkXCIsIHZhbHVlOiBpZCB9XSxcbiAgICAgICAgXCJ2ZXJpZmljYXRpb25cIlxuICAgICAgKTtcbiAgICAgIHJldHVybiB2ZXJpZmljYXRpb247XG4gICAgfVxuICB9O1xufTtcblxuLy8gc3JjL2RiL2ZpZWxkLnRzXG52YXIgY3JlYXRlRmllbGRBdHRyaWJ1dGUgPSAodHlwZSwgY29uZmlnKSA9PiB7XG4gIHJldHVybiB7XG4gICAgdHlwZSxcbiAgICAuLi5jb25maWdcbiAgfTtcbn07XG5cbi8vIHNyYy9kYi9nZXQtdGFibGVzLnRzXG52YXIgZ2V0QXV0aFRhYmxlcyA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHBsdWdpblNjaGVtYSA9IG9wdGlvbnMucGx1Z2lucz8ucmVkdWNlKFxuICAgIChhY2MsIHBsdWdpbikgPT4ge1xuICAgICAgY29uc3Qgc2NoZW1hID0gcGx1Z2luLnNjaGVtYTtcbiAgICAgIGlmICghc2NoZW1hKSByZXR1cm4gYWNjO1xuICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc2NoZW1hKSkge1xuICAgICAgICBhY2Nba2V5XSA9IHtcbiAgICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICAgIC4uLmFjY1trZXldPy5maWVsZHMsXG4gICAgICAgICAgICAuLi52YWx1ZS5maWVsZHNcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1vZGVsTmFtZTogdmFsdWUubW9kZWxOYW1lIHx8IGtleVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LFxuICAgIHt9XG4gICk7XG4gIGNvbnN0IHNob3VsZEFkZFJhdGVMaW1pdFRhYmxlID0gb3B0aW9ucy5yYXRlTGltaXQ/LnN0b3JhZ2UgPT09IFwiZGF0YWJhc2VcIjtcbiAgY29uc3QgcmF0ZUxpbWl0VGFibGUgPSB7XG4gICAgcmF0ZUxpbWl0OiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5tb2RlbE5hbWUgfHwgXCJyYXRlTGltaXRcIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBrZXk6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/LmZpZWxkcz8ua2V5IHx8IFwia2V5XCJcbiAgICAgICAgfSxcbiAgICAgICAgY291bnQ6IHtcbiAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/LmZpZWxkcz8uY291bnQgfHwgXCJjb3VudFwiXG4gICAgICAgIH0sXG4gICAgICAgIGxhc3RSZXF1ZXN0OiB7XG4gICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICBiaWdpbnQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5sYXN0UmVxdWVzdCB8fCBcImxhc3RSZXF1ZXN0XCJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgeyB1c2VyLCBzZXNzaW9uLCBhY2NvdW50LCAuLi5wbHVnaW5UYWJsZXMgfSA9IHBsdWdpblNjaGVtYSB8fCB7fTtcbiAgY29uc3Qgc2Vzc2lvblRhYmxlID0ge1xuICAgIHNlc3Npb246IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5tb2RlbE5hbWUgfHwgXCJzZXNzaW9uXCIsXG4gICAgICBmaWVsZHM6IHtcbiAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8uZXhwaXJlc0F0IHx8IFwiZXhwaXJlc0F0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnRva2VuIHx8IFwidG9rZW5cIixcbiAgICAgICAgICB1bmlxdWU6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8uY3JlYXRlZEF0IHx8IFwiY3JlYXRlZEF0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCJcbiAgICAgICAgfSxcbiAgICAgICAgaXBBZGRyZXNzOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8uaXBBZGRyZXNzIHx8IFwiaXBBZGRyZXNzXCJcbiAgICAgICAgfSxcbiAgICAgICAgdXNlckFnZW50OiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udXNlckFnZW50IHx8IFwidXNlckFnZW50XCJcbiAgICAgICAgfSxcbiAgICAgICAgdXNlcklkOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy51c2VySWQgfHwgXCJ1c2VySWRcIixcbiAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICBtb2RlbDogb3B0aW9ucy51c2VyPy5tb2RlbE5hbWUgfHwgXCJ1c2VyXCIsXG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiLFxuICAgICAgICAgICAgb25EZWxldGU6IFwiY2FzY2FkZVwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICAuLi5zZXNzaW9uPy5maWVsZHMsXG4gICAgICAgIC4uLm9wdGlvbnMuc2Vzc2lvbj8uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfSxcbiAgICAgIG9yZGVyOiAyXG4gICAgfVxuICB9O1xuICByZXR1cm4ge1xuICAgIHVzZXI6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy51c2VyPy5tb2RlbE5hbWUgfHwgXCJ1c2VyXCIsXG4gICAgICBmaWVsZHM6IHtcbiAgICAgICAgbmFtZToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8ubmFtZSB8fCBcIm5hbWVcIixcbiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBlbWFpbDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy51c2VyPy5maWVsZHM/LmVtYWlsIHx8IFwiZW1haWxcIixcbiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiB7XG4gICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiBmYWxzZSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5lbWFpbFZlcmlmaWVkIHx8IFwiZW1haWxWZXJpZmllZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uaW1hZ2UgfHwgXCJpbWFnZVwiXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uY3JlYXRlZEF0IHx8IFwiY3JlYXRlZEF0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy51cGRhdGVkQXQgfHwgXCJ1cGRhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICAuLi51c2VyPy5maWVsZHMsXG4gICAgICAgIC4uLm9wdGlvbnMudXNlcj8uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfSxcbiAgICAgIG9yZGVyOiAxXG4gICAgfSxcbiAgICAvL29ubHkgYWRkIHNlc3Npb24gdGFibGUgaWYgaXQncyBub3Qgc3RvcmVkIGluIHNlY29uZGFyeSBzdG9yYWdlXG4gICAgLi4uIW9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSB8fCBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgPyBzZXNzaW9uVGFibGUgOiB7fSxcbiAgICBhY2NvdW50OiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMuYWNjb3VudD8ubW9kZWxOYW1lIHx8IFwiYWNjb3VudFwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGFjY291bnRJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjb3VudElkIHx8IFwiYWNjb3VudElkXCJcbiAgICAgICAgfSxcbiAgICAgICAgcHJvdmlkZXJJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucHJvdmlkZXJJZCB8fCBcInByb3ZpZGVySWRcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICBvbkRlbGV0ZTogXCJjYXNjYWRlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnVzZXJJZCB8fCBcInVzZXJJZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjZXNzVG9rZW4gfHwgXCJhY2Nlc3NUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnJlZnJlc2hUb2tlbiB8fCBcInJlZnJlc2hUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIGlkVG9rZW46IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5pZFRva2VuIHx8IFwiaWRUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmFjY2Vzc1Rva2VuRXhwaXJlc0F0IHx8IFwiYWNjZXNzVG9rZW5FeHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjZXNzVG9rZW5FeHBpcmVzQXQgfHwgXCJyZWZyZXNoVG9rZW5FeHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnNjb3BlIHx8IFwic2NvcGVcIlxuICAgICAgICB9LFxuICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnBhc3N3b3JkIHx8IFwicGFzc3dvcmRcIlxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy51cGRhdGVkQXQgfHwgXCJ1cGRhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICAuLi5hY2NvdW50Py5maWVsZHNcbiAgICAgIH0sXG4gICAgICBvcmRlcjogM1xuICAgIH0sXG4gICAgdmVyaWZpY2F0aW9uOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5tb2RlbE5hbWUgfHwgXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBpZGVudGlmaWVyOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmlkZW50aWZpZXIgfHwgXCJpZGVudGlmaWVyXCJcbiAgICAgICAgfSxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8udmFsdWUgfHwgXCJ2YWx1ZVwiXG4gICAgICAgIH0sXG4gICAgICAgIGV4cGlyZXNBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8uZXhwaXJlc0F0IHx8IFwiZXhwaXJlc0F0XCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvcmRlcjogNFxuICAgIH0sXG4gICAgLi4ucGx1Z2luVGFibGVzLFxuICAgIC4uLnNob3VsZEFkZFJhdGVMaW1pdFRhYmxlID8gcmF0ZUxpbWl0VGFibGUgOiB7fVxuICB9O1xufTtcbmZ1bmN0aW9uIHRvWm9kU2NoZW1hKGZpZWxkcykge1xuICBjb25zdCBzY2hlbWEgPSB6Lm9iamVjdCh7XG4gICAgLi4uT2JqZWN0LmtleXMoZmllbGRzKS5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1trZXldO1xuICAgICAgaWYgKCFmaWVsZCkge1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfVxuICAgICAgaWYgKGZpZWxkLnR5cGUgPT09IFwic3RyaW5nW11cIiB8fCBmaWVsZC50eXBlID09PSBcIm51bWJlcltdXCIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5hY2MsXG4gICAgICAgICAgW2tleV06IHouYXJyYXkoZmllbGQudHlwZSA9PT0gXCJzdHJpbmdbXVwiID8gei5zdHJpbmcoKSA6IHoubnVtYmVyKCkpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWVsZC50eXBlKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICBba2V5XTogei5hbnkoKVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgbGV0IHNjaGVtYTIgPSB6W2ZpZWxkLnR5cGVdKCk7XG4gICAgICBpZiAoZmllbGQ/LnJlcXVpcmVkID09PSBmYWxzZSkge1xuICAgICAgICBzY2hlbWEyID0gc2NoZW1hMi5vcHRpb25hbCgpO1xuICAgICAgfVxuICAgICAgaWYgKGZpZWxkPy5yZXR1cm5lZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmFjYyxcbiAgICAgICAgW2tleV06IHNjaGVtYTJcbiAgICAgIH07XG4gICAgfSwge30pXG4gIH0pO1xuICByZXR1cm4gc2NoZW1hO1xufVxuXG4vLyBzcmMvYWRhcHRlcnMvdXRpbHMudHNcbmZ1bmN0aW9uIHdpdGhBcHBseURlZmF1bHQodmFsdWUsIGZpZWxkLCBhY3Rpb24pIHtcbiAgaWYgKGFjdGlvbiA9PT0gXCJ1cGRhdGVcIikge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBpZiAodmFsdWUgPT09IHZvaWQgMCB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgIGlmIChmaWVsZC5kZWZhdWx0VmFsdWUpIHtcbiAgICAgIGlmICh0eXBlb2YgZmllbGQuZGVmYXVsdFZhbHVlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGZpZWxkLmRlZmF1bHRWYWx1ZSgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZpZWxkLmRlZmF1bHRWYWx1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG4vLyBzcmMvYWRhcHRlcnMvbWVtb3J5LWFkYXB0ZXIvbWVtb3J5LWFkYXB0ZXIudHNcbnZhciBjcmVhdGVUcmFuc2Zvcm0gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICBmdW5jdGlvbiBnZXRGaWVsZChtb2RlbCwgZmllbGQpIHtcbiAgICBpZiAoZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbiAgICBjb25zdCBmID0gc2NoZW1hW21vZGVsXS5maWVsZHNbZmllbGRdO1xuICAgIHJldHVybiBmLmZpZWxkTmFtZSB8fCBmaWVsZDtcbiAgfVxuICByZXR1cm4ge1xuICAgIHRyYW5zZm9ybUlucHV0KGRhdGEsIG1vZGVsLCBhY3Rpb24pIHtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IGFjdGlvbiA9PT0gXCJ1cGRhdGVcIiA/IHt9IDoge1xuICAgICAgICBpZDogb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCA/IG9wdGlvbnMuYWR2YW5jZWQuZ2VuZXJhdGVJZCh7XG4gICAgICAgICAgbW9kZWxcbiAgICAgICAgfSkgOiBkYXRhLmlkIHx8IGdlbmVyYXRlSWQoKVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGZpZWxkcyA9IHNjaGVtYVttb2RlbF0uZmllbGRzO1xuICAgICAgZm9yIChjb25zdCBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2ZpZWxkXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgJiYgIWZpZWxkc1tmaWVsZF0uZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdHJhbnNmb3JtZWREYXRhW2ZpZWxkc1tmaWVsZF0uZmllbGROYW1lIHx8IGZpZWxkXSA9IHdpdGhBcHBseURlZmF1bHQoXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgZmllbGRzW2ZpZWxkXSxcbiAgICAgICAgICBhY3Rpb25cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gICAgfSxcbiAgICB0cmFuc2Zvcm1PdXRwdXQoZGF0YSwgbW9kZWwsIHNlbGVjdCA9IFtdKSB7XG4gICAgICBpZiAoIWRhdGEpIHJldHVybiBudWxsO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gZGF0YS5pZCB8fCBkYXRhLl9pZCA/IHNlbGVjdC5sZW5ndGggPT09IDAgfHwgc2VsZWN0LmluY2x1ZGVzKFwiaWRcIikgPyB7XG4gICAgICAgIGlkOiBkYXRhLmlkXG4gICAgICB9IDoge30gOiB7fTtcbiAgICAgIGNvbnN0IHRhYmxlU2NoZW1hID0gc2NoZW1hW21vZGVsXS5maWVsZHM7XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0YWJsZVNjaGVtYSkge1xuICAgICAgICBpZiAoc2VsZWN0Lmxlbmd0aCAmJiAhc2VsZWN0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWVsZCA9IHRhYmxlU2NoZW1hW2tleV07XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgIHRyYW5zZm9ybWVkRGF0YVtrZXldID0gZGF0YVtmaWVsZC5maWVsZE5hbWUgfHwga2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkRGF0YTtcbiAgICB9LFxuICAgIGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgdGFibGUsIG1vZGVsKSB7XG4gICAgICByZXR1cm4gdGFibGUuZmlsdGVyKChyZWNvcmQpID0+IHtcbiAgICAgICAgcmV0dXJuIHdoZXJlLmV2ZXJ5KChjbGF1c2UpID0+IHtcbiAgICAgICAgICBjb25zdCB7IGZpZWxkOiBfZmllbGQsIHZhbHVlLCBvcGVyYXRvciB9ID0gY2xhdXNlO1xuICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQobW9kZWwsIF9maWVsZCk7XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImluXCIpIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgbXVzdCBiZSBhbiBhcnJheVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5pbmNsdWRlcyhyZWNvcmRbZmllbGRdKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSBcImNvbnRhaW5zXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLmluY2x1ZGVzKHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSBcInN0YXJ0c193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLnN0YXJ0c1dpdGgodmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IFwiZW5kc193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLmVuZHNXaXRoKHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0gPT09IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEZpZWxkXG4gIH07XG59O1xudmFyIG1lbW9yeUFkYXB0ZXIgPSAoZGIpID0+IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHsgdHJhbnNmb3JtSW5wdXQsIHRyYW5zZm9ybU91dHB1dCwgY29udmVydFdoZXJlQ2xhdXNlLCBnZXRGaWVsZCB9ID0gY3JlYXRlVHJhbnNmb3JtKG9wdGlvbnMpO1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm1lbW9yeVwiLFxuICAgIGNyZWF0ZTogYXN5bmMgKHsgbW9kZWwsIGRhdGEgfSkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFuc2Zvcm1JbnB1dChkYXRhLCBtb2RlbCwgXCJjcmVhdGVcIik7XG4gICAgICBkYlttb2RlbF0ucHVzaCh0cmFuc2Zvcm1lZCk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtT3V0cHV0KHRyYW5zZm9ybWVkLCBtb2RlbCk7XG4gICAgfSxcbiAgICBmaW5kT25lOiBhc3luYyAoeyBtb2RlbCwgd2hlcmUsIHNlbGVjdCB9KSA9PiB7XG4gICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgdGFibGUsIG1vZGVsKTtcbiAgICAgIGNvbnN0IHJlY29yZCA9IHJlc1swXSB8fCBudWxsO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybU91dHB1dChyZWNvcmQsIG1vZGVsLCBzZWxlY3QpO1xuICAgIH0sXG4gICAgZmluZE1hbnk6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSwgc29ydEJ5LCBsaW1pdCwgb2Zmc2V0IH0pID0+IHtcbiAgICAgIGxldCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgIGlmICh3aGVyZSkge1xuICAgICAgICB0YWJsZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgdGFibGUsIG1vZGVsKTtcbiAgICAgIH1cbiAgICAgIGlmIChzb3J0QnkpIHtcbiAgICAgICAgdGFibGUgPSB0YWJsZS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChtb2RlbCwgc29ydEJ5LmZpZWxkKTtcbiAgICAgICAgICBpZiAoc29ydEJ5LmRpcmVjdGlvbiA9PT0gXCJhc2NcIikge1xuICAgICAgICAgICAgcmV0dXJuIGFbZmllbGRdID4gYltmaWVsZF0gPyAxIDogLTE7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhW2ZpZWxkXSA8IGJbZmllbGRdID8gMSA6IC0xO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAob2Zmc2V0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgdGFibGUgPSB0YWJsZS5zbGljZShvZmZzZXQpO1xuICAgICAgfVxuICAgICAgaWYgKGxpbWl0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgdGFibGUgPSB0YWJsZS5zbGljZSgwLCBsaW1pdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFibGUubWFwKChyZWNvcmQpID0+IHRyYW5zZm9ybU91dHB1dChyZWNvcmQsIG1vZGVsKSk7XG4gICAgfSxcbiAgICB1cGRhdGU6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSwgdXBkYXRlIH0pID0+IHtcbiAgICAgIGNvbnN0IHRhYmxlID0gZGJbbW9kZWxdO1xuICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCB0YWJsZSwgbW9kZWwpO1xuICAgICAgcmVzLmZvckVhY2goKHJlY29yZCkgPT4ge1xuICAgICAgICBPYmplY3QuYXNzaWduKHJlY29yZCwgdHJhbnNmb3JtSW5wdXQodXBkYXRlLCBtb2RlbCwgXCJ1cGRhdGVcIikpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtT3V0cHV0KHJlc1swXSwgbW9kZWwpO1xuICAgIH0sXG4gICAgZGVsZXRlOiBhc3luYyAoeyBtb2RlbCwgd2hlcmUgfSkgPT4ge1xuICAgICAgY29uc3QgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIHRhYmxlLCBtb2RlbCk7XG4gICAgICBkYlttb2RlbF0gPSB0YWJsZS5maWx0ZXIoKHJlY29yZCkgPT4gIXJlcy5pbmNsdWRlcyhyZWNvcmQpKTtcbiAgICB9LFxuICAgIGRlbGV0ZU1hbnk6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSB9KSA9PiB7XG4gICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgdGFibGUsIG1vZGVsKTtcbiAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICBkYlttb2RlbF0gPSB0YWJsZS5maWx0ZXIoKHJlY29yZCkgPT4ge1xuICAgICAgICBpZiAocmVzLmluY2x1ZGVzKHJlY29yZCkpIHtcbiAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIXJlcy5pbmNsdWRlcyhyZWNvcmQpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gY291bnQ7XG4gICAgfSxcbiAgICB1cGRhdGVNYW55KGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlLCB1cGRhdGUgfSA9IGRhdGE7XG4gICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgdGFibGUsIG1vZGVsKTtcbiAgICAgIHJlcy5mb3JFYWNoKChyZWNvcmQpID0+IHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihyZWNvcmQsIHVwZGF0ZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNbMF0gfHwgbnVsbDtcbiAgICB9XG4gIH07XG59O1xuXG4vLyBzcmMvZGIvdXRpbHMudHNcbmFzeW5jIGZ1bmN0aW9uIGdldEFkYXB0ZXIob3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMuZGF0YWJhc2UpIHtcbiAgICBjb25zdCB0YWJsZXMgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICAgIGNvbnN0IG1lbW9yeURCID0gT2JqZWN0LmtleXModGFibGVzKS5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgICBhY2Nba2V5XSA9IFtdO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG4gICAgbG9nZ2VyLndhcm4oXG4gICAgICBcIk5vIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24gcHJvdmlkZWQuIFVzaW5nIG1lbW9yeSBhZGFwdGVyIGluIGRldmVsb3BtZW50XCJcbiAgICApO1xuICAgIHJldHVybiBtZW1vcnlBZGFwdGVyKG1lbW9yeURCKShvcHRpb25zKTtcbiAgfVxuICBpZiAodHlwZW9mIG9wdGlvbnMuZGF0YWJhc2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIHJldHVybiBvcHRpb25zLmRhdGFiYXNlKG9wdGlvbnMpO1xuICB9XG4gIGNvbnN0IHsga3lzZWx5LCBkYXRhYmFzZVR5cGUgfSA9IGF3YWl0IGNyZWF0ZUt5c2VseUFkYXB0ZXIob3B0aW9ucyk7XG4gIGlmICgha3lzZWx5KSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIGRhdGFiYXNlIGFkYXB0ZXJcIik7XG4gIH1cbiAgcmV0dXJuIGt5c2VseUFkYXB0ZXIoa3lzZWx5LCB7XG4gICAgdHlwZTogZGF0YWJhc2VUeXBlIHx8IFwic3FsaXRlXCJcbiAgfSkob3B0aW9ucyk7XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9EQihmaWVsZHMsIHZhbHVlcykge1xuICBsZXQgcmVzdWx0ID0gdmFsdWVzLmlkID8ge1xuICAgIGlkOiB2YWx1ZXMuaWRcbiAgfSA6IHt9O1xuICBmb3IgKGNvbnN0IGtleSBpbiBmaWVsZHMpIHtcbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1trZXldO1xuICAgIGNvbnN0IHZhbHVlID0gdmFsdWVzW2tleV07XG4gICAgaWYgKHZhbHVlID09PSB2b2lkIDApIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICByZXN1bHRbZmllbGQuZmllbGROYW1lIHx8IGtleV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY29udmVydEZyb21EQihmaWVsZHMsIHZhbHVlcykge1xuICBpZiAoIXZhbHVlcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGxldCByZXN1bHQgPSB7XG4gICAgaWQ6IHZhbHVlcy5pZFxuICB9O1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhmaWVsZHMpKSB7XG4gICAgcmVzdWx0W2tleV0gPSB2YWx1ZXNbdmFsdWUuZmllbGROYW1lIHx8IGtleV07XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gc3JjL2RiL2dldC1zY2hlbWEudHNcbmZ1bmN0aW9uIGdldFNjaGVtYShjb25maWcpIHtcbiAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhjb25maWcpO1xuICBsZXQgc2NoZW1hID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIHRhYmxlcykge1xuICAgIGNvbnN0IHRhYmxlID0gdGFibGVzW2tleV07XG4gICAgY29uc3QgZmllbGRzID0gdGFibGUuZmllbGRzO1xuICAgIGxldCBhY3R1YWxGaWVsZHMgPSB7fTtcbiAgICBPYmplY3QuZW50cmllcyhmaWVsZHMpLmZvckVhY2goKFtrZXkyLCBmaWVsZF0pID0+IHtcbiAgICAgIGFjdHVhbEZpZWxkc1tmaWVsZC5maWVsZE5hbWUgfHwga2V5Ml0gPSBmaWVsZDtcbiAgICAgIGlmIChmaWVsZC5yZWZlcmVuY2VzKSB7XG4gICAgICAgIGNvbnN0IHJlZlRhYmxlID0gdGFibGVzW2ZpZWxkLnJlZmVyZW5jZXMubW9kZWxdO1xuICAgICAgICBpZiAocmVmVGFibGUpIHtcbiAgICAgICAgICBhY3R1YWxGaWVsZHNbZmllbGQuZmllbGROYW1lIHx8IGtleTJdLnJlZmVyZW5jZXMgPSB7XG4gICAgICAgICAgICBtb2RlbDogcmVmVGFibGUubW9kZWxOYW1lLFxuICAgICAgICAgICAgZmllbGQ6IGZpZWxkLnJlZmVyZW5jZXMuZmllbGRcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdKSB7XG4gICAgICBzY2hlbWFbdGFibGUubW9kZWxOYW1lXS5maWVsZHMgPSB7XG4gICAgICAgIC4uLnNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdLmZpZWxkcyxcbiAgICAgICAgLi4uYWN0dWFsRmllbGRzXG4gICAgICB9O1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdID0ge1xuICAgICAgZmllbGRzOiBhY3R1YWxGaWVsZHMsXG4gICAgICBvcmRlcjogdGFibGUub3JkZXIgfHwgSW5maW5pdHlcbiAgICB9O1xuICB9XG4gIHJldHVybiBzY2hlbWE7XG59XG5cbi8vIHNyYy9kYi9nZXQtbWlncmF0aW9uLnRzXG52YXIgcG9zdGdyZXNNYXAgPSB7XG4gIHN0cmluZzogW1wiY2hhcmFjdGVyIHZhcnlpbmdcIiwgXCJ0ZXh0XCJdLFxuICBudW1iZXI6IFtcbiAgICBcImludDRcIixcbiAgICBcImludGVnZXJcIixcbiAgICBcImJpZ2ludFwiLFxuICAgIFwic21hbGxpbnRcIixcbiAgICBcIm51bWVyaWNcIixcbiAgICBcInJlYWxcIixcbiAgICBcImRvdWJsZSBwcmVjaXNpb25cIlxuICBdLFxuICBib29sZWFuOiBbXCJib29sXCIsIFwiYm9vbGVhblwiXSxcbiAgZGF0ZTogW1widGltZXN0YW1wXCIsIFwiZGF0ZVwiXVxufTtcbnZhciBteXNxbE1hcCA9IHtcbiAgc3RyaW5nOiBbXCJ2YXJjaGFyXCIsIFwidGV4dFwiXSxcbiAgbnVtYmVyOiBbXG4gICAgXCJpbnRlZ2VyXCIsXG4gICAgXCJpbnRcIixcbiAgICBcImJpZ2ludFwiLFxuICAgIFwic21hbGxpbnRcIixcbiAgICBcImRlY2ltYWxcIixcbiAgICBcImZsb2F0XCIsXG4gICAgXCJkb3VibGVcIlxuICBdLFxuICBib29sZWFuOiBbXCJib29sZWFuXCIsIFwidGlueWludFwiXSxcbiAgZGF0ZTogW1widGltZXN0YW1wXCIsIFwiZGF0ZXRpbWVcIiwgXCJkYXRlXCJdXG59O1xudmFyIHNxbGl0ZU1hcCA9IHtcbiAgc3RyaW5nOiBbXCJURVhUXCJdLFxuICBudW1iZXI6IFtcIklOVEVHRVJcIiwgXCJSRUFMXCJdLFxuICBib29sZWFuOiBbXCJJTlRFR0VSXCIsIFwiQk9PTEVBTlwiXSxcbiAgLy8gMCBvciAxXG4gIGRhdGU6IFtcIkRBVEVcIiwgXCJJTlRFR0VSXCJdXG59O1xudmFyIG1zc3FsTWFwID0ge1xuICBzdHJpbmc6IFtcInRleHRcIiwgXCJ2YXJjaGFyXCJdLFxuICBudW1iZXI6IFtcImludFwiLCBcImJpZ2ludFwiLCBcInNtYWxsaW50XCIsIFwiZGVjaW1hbFwiLCBcImZsb2F0XCIsIFwiZG91YmxlXCJdLFxuICBib29sZWFuOiBbXCJiaXRcIiwgXCJzbWFsbGludFwiXSxcbiAgZGF0ZTogW1wiZGF0ZXRpbWVcIiwgXCJkYXRlXCJdXG59O1xudmFyIG1hcCA9IHtcbiAgcG9zdGdyZXM6IHBvc3RncmVzTWFwLFxuICBteXNxbDogbXlzcWxNYXAsXG4gIHNxbGl0ZTogc3FsaXRlTWFwLFxuICBtc3NxbDogbXNzcWxNYXBcbn07XG5mdW5jdGlvbiBtYXRjaFR5cGUoY29sdW1uRGF0YVR5cGUsIGZpZWxkVHlwZSwgZGJUeXBlKSB7XG4gIGlmIChmaWVsZFR5cGUgPT09IFwic3RyaW5nW11cIiB8fCBmaWVsZFR5cGUgPT09IFwibnVtYmVyW11cIikge1xuICAgIHJldHVybiBjb2x1bW5EYXRhVHlwZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwianNvblwiKTtcbiAgfVxuICBjb25zdCB0eXBlcyA9IG1hcFtkYlR5cGVdO1xuICBjb25zdCB0eXBlID0gQXJyYXkuaXNBcnJheShmaWVsZFR5cGUpID8gdHlwZXNbXCJzdHJpbmdcIl0ubWFwKCh0KSA9PiB0LnRvTG93ZXJDYXNlKCkpIDogdHlwZXNbZmllbGRUeXBlXS5tYXAoKHQpID0+IHQudG9Mb3dlckNhc2UoKSk7XG4gIGNvbnN0IG1hdGNoZXMgPSB0eXBlLmluY2x1ZGVzKGNvbHVtbkRhdGFUeXBlLnRvTG93ZXJDYXNlKCkpO1xuICByZXR1cm4gbWF0Y2hlcztcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldE1pZ3JhdGlvbnMoY29uZmlnKSB7XG4gIGNvbnN0IGJldHRlckF1dGhTY2hlbWEgPSBnZXRTY2hlbWEoY29uZmlnKTtcbiAgY29uc3QgbG9nZ2VyMiA9IGNyZWF0ZUxvZ2dlcihjb25maWcubG9nZ2VyKTtcbiAgbGV0IHsga3lzZWx5OiBkYiwgZGF0YWJhc2VUeXBlOiBkYlR5cGUgfSA9IGF3YWl0IGNyZWF0ZUt5c2VseUFkYXB0ZXIoY29uZmlnKTtcbiAgaWYgKCFkYlR5cGUpIHtcbiAgICBsb2dnZXIyLndhcm4oXG4gICAgICBcIkNvdWxkIG5vdCBkZXRlcm1pbmUgZGF0YWJhc2UgdHlwZSwgZGVmYXVsdGluZyB0byBzcWxpdGUuIFBsZWFzZSBwcm92aWRlIGEgdHlwZSBpbiB0aGUgZGF0YWJhc2Ugb3B0aW9ucyB0byBhdm9pZCB0aGlzLlwiXG4gICAgKTtcbiAgICBkYlR5cGUgPSBcInNxbGl0ZVwiO1xuICB9XG4gIGlmICghZGIpIHtcbiAgICBsb2dnZXIyLmVycm9yKFxuICAgICAgXCJPbmx5IGt5c2VseSBhZGFwdGVyIGlzIHN1cHBvcnRlZCBmb3IgbWlncmF0aW9ucy4gWW91IGNhbiB1c2UgYGdlbmVyYXRlYCBjb21tYW5kIHRvIGdlbmVyYXRlIHRoZSBzY2hlbWEsIGlmIHlvdSdyZSB1c2luZyBhIGRpZmZlcmVudCBhZGFwdGVyLlwiXG4gICAgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbiAgY29uc3QgdGFibGVNZXRhZGF0YSA9IGF3YWl0IGRiLmludHJvc3BlY3Rpb24uZ2V0VGFibGVzKCk7XG4gIGNvbnN0IHRvQmVDcmVhdGVkID0gW107XG4gIGNvbnN0IHRvQmVBZGRlZCA9IFtdO1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhiZXR0ZXJBdXRoU2NoZW1hKSkge1xuICAgIGNvbnN0IHRhYmxlID0gdGFibGVNZXRhZGF0YS5maW5kKCh0KSA9PiB0Lm5hbWUgPT09IGtleSk7XG4gICAgaWYgKCF0YWJsZSkge1xuICAgICAgY29uc3QgdEluZGV4ID0gdG9CZUNyZWF0ZWQuZmluZEluZGV4KCh0KSA9PiB0LnRhYmxlID09PSBrZXkpO1xuICAgICAgY29uc3QgdGFibGVEYXRhID0ge1xuICAgICAgICB0YWJsZToga2V5LFxuICAgICAgICBmaWVsZHM6IHZhbHVlLmZpZWxkcyxcbiAgICAgICAgb3JkZXI6IHZhbHVlLm9yZGVyIHx8IEluZmluaXR5XG4gICAgICB9O1xuICAgICAgY29uc3QgaW5zZXJ0SW5kZXggPSB0b0JlQ3JlYXRlZC5maW5kSW5kZXgoXG4gICAgICAgICh0KSA9PiAodC5vcmRlciB8fCBJbmZpbml0eSkgPiB0YWJsZURhdGEub3JkZXJcbiAgICAgICk7XG4gICAgICBpZiAoaW5zZXJ0SW5kZXggPT09IC0xKSB7XG4gICAgICAgIGlmICh0SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgdG9CZUNyZWF0ZWQucHVzaCh0YWJsZURhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRvQmVDcmVhdGVkW3RJbmRleF0uZmllbGRzID0ge1xuICAgICAgICAgICAgLi4udG9CZUNyZWF0ZWRbdEluZGV4XS5maWVsZHMsXG4gICAgICAgICAgICAuLi52YWx1ZS5maWVsZHNcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b0JlQ3JlYXRlZC5zcGxpY2UoaW5zZXJ0SW5kZXgsIDAsIHRhYmxlRGF0YSk7XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgbGV0IHRvQmVBZGRlZEZpZWxkcyA9IHt9O1xuICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgZmllbGRdIG9mIE9iamVjdC5lbnRyaWVzKHZhbHVlLmZpZWxkcykpIHtcbiAgICAgIGNvbnN0IGNvbHVtbiA9IHRhYmxlLmNvbHVtbnMuZmluZCgoYykgPT4gYy5uYW1lID09PSBmaWVsZE5hbWUpO1xuICAgICAgaWYgKCFjb2x1bW4pIHtcbiAgICAgICAgdG9CZUFkZGVkRmllbGRzW2ZpZWxkTmFtZV0gPSBmaWVsZDtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAobWF0Y2hUeXBlKGNvbHVtbi5kYXRhVHlwZSwgZmllbGQudHlwZSwgZGJUeXBlKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlcjIud2FybihcbiAgICAgICAgICBgRmllbGQgJHtmaWVsZE5hbWV9IGluIHRhYmxlICR7a2V5fSBoYXMgYSBkaWZmZXJlbnQgdHlwZSBpbiB0aGUgZGF0YWJhc2UuIEV4cGVjdGVkICR7ZmllbGQudHlwZX0gYnV0IGdvdCAke2NvbHVtbi5kYXRhVHlwZX0uYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoT2JqZWN0LmtleXModG9CZUFkZGVkRmllbGRzKS5sZW5ndGggPiAwKSB7XG4gICAgICB0b0JlQWRkZWQucHVzaCh7XG4gICAgICAgIHRhYmxlOiBrZXksXG4gICAgICAgIGZpZWxkczogdG9CZUFkZGVkRmllbGRzLFxuICAgICAgICBvcmRlcjogdmFsdWUub3JkZXIgfHwgSW5maW5pdHlcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBjb25zdCBtaWdyYXRpb25zID0gW107XG4gIGZ1bmN0aW9uIGdldFR5cGUoZmllbGQpIHtcbiAgICBjb25zdCB0eXBlID0gZmllbGQudHlwZTtcbiAgICBjb25zdCB0eXBlTWFwID0ge1xuICAgICAgc3RyaW5nOiB7XG4gICAgICAgIHNxbGl0ZTogXCJ0ZXh0XCIsXG4gICAgICAgIHBvc3RncmVzOiBcInRleHRcIixcbiAgICAgICAgbXlzcWw6IGZpZWxkLnVuaXF1ZSA/IFwidmFyY2hhcigyNTUpXCIgOiBmaWVsZC5yZWZlcmVuY2VzID8gXCJ2YXJjaGFyKDM2KVwiIDogXCJ0ZXh0XCIsXG4gICAgICAgIG1zc3FsOiBmaWVsZC51bmlxdWUgfHwgZmllbGQuc29ydGFibGUgPyBcInZhcmNoYXIoMjU1KVwiIDogZmllbGQucmVmZXJlbmNlcyA/IFwidmFyY2hhcigzNilcIiA6IFwidGV4dFwiXG4gICAgICB9LFxuICAgICAgYm9vbGVhbjoge1xuICAgICAgICBzcWxpdGU6IFwiaW50ZWdlclwiLFxuICAgICAgICBwb3N0Z3JlczogXCJib29sZWFuXCIsXG4gICAgICAgIG15c3FsOiBcImJvb2xlYW5cIixcbiAgICAgICAgbXNzcWw6IFwic21hbGxpbnRcIlxuICAgICAgfSxcbiAgICAgIG51bWJlcjoge1xuICAgICAgICBzcWxpdGU6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIixcbiAgICAgICAgcG9zdGdyZXM6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIixcbiAgICAgICAgbXlzcWw6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIixcbiAgICAgICAgbXNzcWw6IGZpZWxkLmJpZ2ludCA/IFwiYmlnaW50XCIgOiBcImludGVnZXJcIlxuICAgICAgfSxcbiAgICAgIGRhdGU6IHtcbiAgICAgICAgc3FsaXRlOiBcImRhdGVcIixcbiAgICAgICAgcG9zdGdyZXM6IFwidGltZXN0YW1wXCIsXG4gICAgICAgIG15c3FsOiBcImRhdGV0aW1lXCIsXG4gICAgICAgIG1zc3FsOiBcImRhdGV0aW1lXCJcbiAgICAgIH1cbiAgICB9O1xuICAgIGlmIChkYlR5cGUgPT09IFwic3FsaXRlXCIgJiYgKHR5cGUgPT09IFwic3RyaW5nW11cIiB8fCB0eXBlID09PSBcIm51bWJlcltdXCIpKSB7XG4gICAgICByZXR1cm4gXCJ0ZXh0XCI7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSBcInN0cmluZ1tdXCIgfHwgdHlwZSA9PT0gXCJudW1iZXJbXVwiKSB7XG4gICAgICByZXR1cm4gXCJqc29uYlwiO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheSh0eXBlKSkge1xuICAgICAgcmV0dXJuIFwidGV4dFwiO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZU1hcFt0eXBlXVtkYlR5cGUgfHwgXCJzcWxpdGVcIl07XG4gIH1cbiAgaWYgKHRvQmVBZGRlZC5sZW5ndGgpIHtcbiAgICBmb3IgKGNvbnN0IHRhYmxlIG9mIHRvQmVBZGRlZCkge1xuICAgICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModGFibGUuZmllbGRzKSkge1xuICAgICAgICBjb25zdCB0eXBlID0gZ2V0VHlwZShmaWVsZCk7XG4gICAgICAgIGNvbnN0IGV4ZWMgPSBkYi5zY2hlbWEuYWx0ZXJUYWJsZSh0YWJsZS50YWJsZSkuYWRkQ29sdW1uKGZpZWxkTmFtZSwgdHlwZSwgKGNvbCkgPT4ge1xuICAgICAgICAgIGNvbCA9IGZpZWxkLnJlcXVpcmVkICE9PSBmYWxzZSA/IGNvbC5ub3ROdWxsKCkgOiBjb2w7XG4gICAgICAgICAgaWYgKGZpZWxkLnJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNvbCA9IGNvbC5yZWZlcmVuY2VzKFxuICAgICAgICAgICAgICBgJHtmaWVsZC5yZWZlcmVuY2VzLm1vZGVsfS4ke2ZpZWxkLnJlZmVyZW5jZXMuZmllbGR9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnVuaXF1ZSkge1xuICAgICAgICAgICAgY29sID0gY29sLnVuaXF1ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY29sO1xuICAgICAgICB9KTtcbiAgICAgICAgbWlncmF0aW9ucy5wdXNoKGV4ZWMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAodG9CZUNyZWF0ZWQubGVuZ3RoKSB7XG4gICAgZm9yIChjb25zdCB0YWJsZSBvZiB0b0JlQ3JlYXRlZCkge1xuICAgICAgbGV0IGRiVCA9IGRiLnNjaGVtYS5jcmVhdGVUYWJsZSh0YWJsZS50YWJsZSkuYWRkQ29sdW1uKFxuICAgICAgICBcImlkXCIsXG4gICAgICAgIGRiVHlwZSA9PT0gXCJteXNxbFwiIHx8IGRiVHlwZSA9PT0gXCJtc3NxbFwiID8gXCJ2YXJjaGFyKDM2KVwiIDogXCJ0ZXh0XCIsXG4gICAgICAgIChjb2wpID0+IGNvbC5wcmltYXJ5S2V5KCkubm90TnVsbCgpXG4gICAgICApO1xuICAgICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModGFibGUuZmllbGRzKSkge1xuICAgICAgICBjb25zdCB0eXBlID0gZ2V0VHlwZShmaWVsZCk7XG4gICAgICAgIGRiVCA9IGRiVC5hZGRDb2x1bW4oZmllbGROYW1lLCB0eXBlLCAoY29sKSA9PiB7XG4gICAgICAgICAgY29sID0gZmllbGQucmVxdWlyZWQgIT09IGZhbHNlID8gY29sLm5vdE51bGwoKSA6IGNvbDtcbiAgICAgICAgICBpZiAoZmllbGQucmVmZXJlbmNlcykge1xuICAgICAgICAgICAgY29sID0gY29sLnJlZmVyZW5jZXMoXG4gICAgICAgICAgICAgIGAke2ZpZWxkLnJlZmVyZW5jZXMubW9kZWx9LiR7ZmllbGQucmVmZXJlbmNlcy5maWVsZH1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudW5pcXVlKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wudW5pcXVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjb2w7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgbWlncmF0aW9ucy5wdXNoKGRiVCk7XG4gICAgfVxuICB9XG4gIGFzeW5jIGZ1bmN0aW9uIHJ1bk1pZ3JhdGlvbnMoKSB7XG4gICAgZm9yIChjb25zdCBtaWdyYXRpb24gb2YgbWlncmF0aW9ucykge1xuICAgICAgYXdhaXQgbWlncmF0aW9uLmV4ZWN1dGUoKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gY29tcGlsZU1pZ3JhdGlvbnMoKSB7XG4gICAgY29uc3QgY29tcGlsZWQgPSBtaWdyYXRpb25zLm1hcCgobSkgPT4gbS5jb21waWxlKCkuc3FsKTtcbiAgICByZXR1cm4gY29tcGlsZWQuam9pbihcIjtcXG5cXG5cIik7XG4gIH1cbiAgcmV0dXJuIHsgdG9CZUNyZWF0ZWQsIHRvQmVBZGRlZCwgcnVuTWlncmF0aW9ucywgY29tcGlsZU1pZ3JhdGlvbnMgfTtcbn1cblxuLy8gc3JjL2FkYXB0ZXJzL2t5c2VseS1hZGFwdGVyL2t5c2VseS1hZGFwdGVyLnRzXG52YXIgY3JlYXRlVHJhbnNmb3JtMiA9IChkYiwgb3B0aW9ucywgY29uZmlnKSA9PiB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGZ1bmN0aW9uIGdldEZpZWxkKG1vZGVsLCBmaWVsZCkge1xuICAgIGlmIChmaWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxuICAgIGNvbnN0IGYgPSBzY2hlbWFbbW9kZWxdLmZpZWxkc1tmaWVsZF07XG4gICAgaWYgKCFmKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkZpZWxkIG5vdCBmb3VuZFwiLCBtb2RlbCwgZmllbGQpO1xuICAgIH1cbiAgICByZXR1cm4gZi5maWVsZE5hbWUgfHwgZmllbGQ7XG4gIH1cbiAgZnVuY3Rpb24gdHJhbnNmb3JtVmFsdWVUb0RCKHZhbHVlLCBtb2RlbCwgZmllbGQpIHtcbiAgICBjb25zdCB7IHR5cGUgPSBcInNxbGl0ZVwiIH0gPSBjb25maWcgfHwge307XG4gICAgY29uc3QgZiA9IHNjaGVtYVttb2RlbF0uZmllbGRzW2ZpZWxkXTtcbiAgICBpZiAoZi50eXBlID09PSBcImJvb2xlYW5cIiAmJiAodHlwZSA9PT0gXCJzcWxpdGVcIiB8fCB0eXBlID09PSBcIm1zc3FsXCIpICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiB2YWx1ZSA/IDEgOiAwO1xuICAgIH1cbiAgICBpZiAoZi50eXBlID09PSBcImRhdGVcIiAmJiB2YWx1ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgIHJldHVybiB0eXBlID09PSBcInNxbGl0ZVwiID8gdmFsdWUudG9JU09TdHJpbmcoKSA6IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgZnVuY3Rpb24gdHJhbnNmb3JtVmFsdWVGcm9tREIodmFsdWUsIG1vZGVsLCBmaWVsZCkge1xuICAgIGNvbnN0IHsgdHlwZSA9IFwic3FsaXRlXCIgfSA9IGNvbmZpZyB8fCB7fTtcbiAgICBjb25zdCBmID0gc2NoZW1hW21vZGVsXS5maWVsZHNbZmllbGRdO1xuICAgIGlmIChmLnR5cGUgPT09IFwiYm9vbGVhblwiICYmICh0eXBlID09PSBcInNxbGl0ZVwiIHx8IHR5cGUgPT09IFwibXNzcWxcIikgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gMTtcbiAgICB9XG4gICAgaWYgKGYudHlwZSA9PT0gXCJkYXRlXCIgJiYgdmFsdWUpIHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZSh2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBmdW5jdGlvbiBnZXRNb2RlbE5hbWUobW9kZWwpIHtcbiAgICByZXR1cm4gc2NoZW1hW21vZGVsXS5tb2RlbE5hbWU7XG4gIH1cbiAgY29uc3QgdXNlRGF0YWJhc2VHZW5lcmF0ZWRJZCA9IG9wdGlvbnM/LmFkdmFuY2VkPy5nZW5lcmF0ZUlkID09PSBmYWxzZTtcbiAgcmV0dXJuIHtcbiAgICB0cmFuc2Zvcm1JbnB1dChkYXRhLCBtb2RlbCwgYWN0aW9uKSB7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSB1c2VEYXRhYmFzZUdlbmVyYXRlZElkIHx8IGFjdGlvbiA9PT0gXCJ1cGRhdGVcIiA/IHt9IDoge1xuICAgICAgICBpZDogb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCA/IG9wdGlvbnMuYWR2YW5jZWQuZ2VuZXJhdGVJZCh7XG4gICAgICAgICAgbW9kZWxcbiAgICAgICAgfSkgOiBkYXRhLmlkIHx8IGdlbmVyYXRlSWQoKVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGZpZWxkcyA9IHNjaGVtYVttb2RlbF0uZmllbGRzO1xuICAgICAgZm9yIChjb25zdCBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2ZpZWxkXTtcbiAgICAgICAgdHJhbnNmb3JtZWREYXRhW2ZpZWxkc1tmaWVsZF0uZmllbGROYW1lIHx8IGZpZWxkXSA9IHdpdGhBcHBseURlZmF1bHQoXG4gICAgICAgICAgdHJhbnNmb3JtVmFsdWVUb0RCKHZhbHVlLCBtb2RlbCwgZmllbGQpLFxuICAgICAgICAgIGZpZWxkc1tmaWVsZF0sXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWREYXRhO1xuICAgIH0sXG4gICAgdHJhbnNmb3JtT3V0cHV0KGRhdGEsIG1vZGVsLCBzZWxlY3QgPSBbXSkge1xuICAgICAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IGRhdGEuaWQgPyBzZWxlY3QubGVuZ3RoID09PSAwIHx8IHNlbGVjdC5pbmNsdWRlcyhcImlkXCIpID8ge1xuICAgICAgICBpZDogZGF0YS5pZFxuICAgICAgfSA6IHt9IDoge307XG4gICAgICBjb25zdCB0YWJsZVNjaGVtYSA9IHNjaGVtYVttb2RlbF0uZmllbGRzO1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGFibGVTY2hlbWEpIHtcbiAgICAgICAgaWYgKHNlbGVjdC5sZW5ndGggJiYgIXNlbGVjdC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmllbGQgPSB0YWJsZVNjaGVtYVtrZXldO1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICB0cmFuc2Zvcm1lZERhdGFba2V5XSA9IHRyYW5zZm9ybVZhbHVlRnJvbURCKFxuICAgICAgICAgICAgZGF0YVtmaWVsZC5maWVsZE5hbWUgfHwga2V5XSxcbiAgICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgICAga2V5XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkRGF0YTtcbiAgICB9LFxuICAgIGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgdykge1xuICAgICAgaWYgKCF3KVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFuZDogbnVsbCxcbiAgICAgICAgICBvcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHtcbiAgICAgICAgYW5kOiBbXSxcbiAgICAgICAgb3I6IFtdXG4gICAgICB9O1xuICAgICAgdy5mb3JFYWNoKChjb25kaXRpb24pID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGZpZWxkOiBfZmllbGQsXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgb3BlcmF0b3IgPSBcIj1cIixcbiAgICAgICAgICBjb25uZWN0b3IgPSBcIkFORFwiXG4gICAgICAgIH0gPSBjb25kaXRpb247XG4gICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQobW9kZWwsIF9maWVsZCk7XG4gICAgICAgIGNvbnN0IGV4cHIgPSAoZWIpID0+IHtcbiAgICAgICAgICBpZiAob3BlcmF0b3IudG9Mb3dlckNhc2UoKSA9PT0gXCJpblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiaW5cIiwgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiY29udGFpbnNcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcImxpa2VcIiwgYCUke3ZhbHVlfSVgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcInN0YXJ0c193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCJsaWtlXCIsIGAke3ZhbHVlfSVgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImVuZHNfd2l0aFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwibGlrZVwiLCBgJSR7dmFsdWV9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJlcVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPVwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJuZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPD5cIiwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZ3RcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIj5cIiwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZ3RlXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI+PVwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJsdFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPFwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJsdGVcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIjw9XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBvcGVyYXRvciwgdmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoY29ubmVjdG9yID09PSBcIk9SXCIpIHtcbiAgICAgICAgICBjb25kaXRpb25zLm9yLnB1c2goZXhwcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uZGl0aW9ucy5hbmQucHVzaChleHByKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbmQ6IGNvbmRpdGlvbnMuYW5kLmxlbmd0aCA/IGNvbmRpdGlvbnMuYW5kIDogbnVsbCxcbiAgICAgICAgb3I6IGNvbmRpdGlvbnMub3IubGVuZ3RoID8gY29uZGl0aW9ucy5vciA6IG51bGxcbiAgICAgIH07XG4gICAgfSxcbiAgICBhc3luYyB3aXRoUmV0dXJuaW5nKHZhbHVlcywgYnVpbGRlciwgbW9kZWwsIHdoZXJlKSB7XG4gICAgICBsZXQgcmVzO1xuICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJteXNxbFwiKSB7XG4gICAgICAgIGF3YWl0IGJ1aWxkZXIuZXhlY3V0ZSgpO1xuICAgICAgICBjb25zdCBmaWVsZCA9IHZhbHVlcy5pZCA/IFwiaWRcIiA6IHdoZXJlWzBdLmZpZWxkID8gd2hlcmVbMF0uZmllbGQgOiBcImlkXCI7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdmFsdWVzW2ZpZWxkXSB8fCB3aGVyZVswXS52YWx1ZTtcbiAgICAgICAgcmVzID0gYXdhaXQgZGIuc2VsZWN0RnJvbShnZXRNb2RlbE5hbWUobW9kZWwpKS5zZWxlY3RBbGwoKS53aGVyZShnZXRGaWVsZChtb2RlbCwgZmllbGQpLCBcIj1cIiwgdmFsdWUpLmV4ZWN1dGVUYWtlRmlyc3QoKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH1cbiAgICAgIGlmIChjb25maWc/LnR5cGUgPT09IFwibXNzcWxcIikge1xuICAgICAgICByZXMgPSBhd2FpdCBidWlsZGVyLm91dHB1dEFsbChcImluc2VydGVkXCIpLmV4ZWN1dGVUYWtlRmlyc3QoKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH1cbiAgICAgIHJlcyA9IGF3YWl0IGJ1aWxkZXIucmV0dXJuaW5nQWxsKCkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9LFxuICAgIGdldE1vZGVsTmFtZSxcbiAgICBnZXRGaWVsZFxuICB9O1xufTtcbnZhciBreXNlbHlBZGFwdGVyID0gKGRiLCBjb25maWcpID0+IChvcHRzKSA9PiB7XG4gIGNvbnN0IHtcbiAgICB0cmFuc2Zvcm1JbnB1dCxcbiAgICB3aXRoUmV0dXJuaW5nLFxuICAgIHRyYW5zZm9ybU91dHB1dCxcbiAgICBjb252ZXJ0V2hlcmVDbGF1c2UsXG4gICAgZ2V0TW9kZWxOYW1lLFxuICAgIGdldEZpZWxkXG4gIH0gPSBjcmVhdGVUcmFuc2Zvcm0yKGRiLCBvcHRzLCBjb25maWcpO1xuICByZXR1cm4ge1xuICAgIGlkOiBcImt5c2VseVwiLFxuICAgIGFzeW5jIGNyZWF0ZShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCBkYXRhOiB2YWx1ZXMsIHNlbGVjdCB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gdHJhbnNmb3JtSW5wdXQodmFsdWVzLCBtb2RlbCwgXCJjcmVhdGVcIik7XG4gICAgICBjb25zdCBidWlsZGVyID0gZGIuaW5zZXJ0SW50byhnZXRNb2RlbE5hbWUobW9kZWwpKS52YWx1ZXModHJhbnNmb3JtZWQpO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybU91dHB1dChcbiAgICAgICAgYXdhaXQgd2l0aFJldHVybmluZyh0cmFuc2Zvcm1lZCwgYnVpbGRlciwgbW9kZWwsIFtdKSxcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHNlbGVjdFxuICAgICAgKTtcbiAgICB9LFxuICAgIGFzeW5jIGZpbmRPbmUoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIHNlbGVjdCB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICBsZXQgcXVlcnkgPSBkYi5zZWxlY3RGcm9tKGdldE1vZGVsTmFtZShtb2RlbCkpLnNlbGVjdEFsbCgpO1xuICAgICAgaWYgKGFuZCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgfVxuICAgICAgaWYgKG9yKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgaWYgKCFyZXMpIHJldHVybiBudWxsO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybU91dHB1dChyZXMsIG1vZGVsLCBzZWxlY3QpO1xuICAgIH0sXG4gICAgYXN5bmMgZmluZE1hbnkoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIGxpbWl0LCBvZmZzZXQsIHNvcnRCeSB9ID0gZGF0YTtcbiAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICBsZXQgcXVlcnkgPSBkYi5zZWxlY3RGcm9tKGdldE1vZGVsTmFtZShtb2RlbCkpO1xuICAgICAgaWYgKGFuZCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgfVxuICAgICAgaWYgKG9yKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgfVxuICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJtc3NxbFwiKSB7XG4gICAgICAgIGlmICghb2Zmc2V0KSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS50b3AobGltaXQgfHwgMTAwKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5saW1pdChsaW1pdCB8fCAxMDApO1xuICAgICAgfVxuICAgICAgaWYgKHNvcnRCeSkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyQnkoXG4gICAgICAgICAgZ2V0RmllbGQobW9kZWwsIHNvcnRCeS5maWVsZCksXG4gICAgICAgICAgc29ydEJ5LmRpcmVjdGlvblxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgICBpZiAoIXNvcnRCeSkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5vcmRlckJ5KGdldEZpZWxkKG1vZGVsLCBcImlkXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5vZmZzZXQob2Zmc2V0KS5mZXRjaChsaW1pdCB8fCAxMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkub2Zmc2V0KG9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHF1ZXJ5LnNlbGVjdEFsbCgpLmV4ZWN1dGUoKTtcbiAgICAgIGlmICghcmVzKSByZXR1cm4gW107XG4gICAgICByZXR1cm4gcmVzLm1hcCgocikgPT4gdHJhbnNmb3JtT3V0cHV0KHIsIG1vZGVsKSk7XG4gICAgfSxcbiAgICBhc3luYyB1cGRhdGUoZGF0YSkge1xuICAgICAgY29uc3QgeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZTogdmFsdWVzIH0gPSBkYXRhO1xuICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IHRyYW5zZm9ybUlucHV0KHZhbHVlcywgbW9kZWwsIFwidXBkYXRlXCIpO1xuICAgICAgbGV0IHF1ZXJ5ID0gZGIudXBkYXRlVGFibGUoZ2V0TW9kZWxOYW1lKG1vZGVsKSkuc2V0KHRyYW5zZm9ybWVkRGF0YSk7XG4gICAgICBpZiAoYW5kKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBpZiAob3IpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB0cmFuc2Zvcm1PdXRwdXQoXG4gICAgICAgIGF3YWl0IHdpdGhSZXR1cm5pbmcodHJhbnNmb3JtZWREYXRhLCBxdWVyeSwgbW9kZWwsIHdoZXJlKSxcbiAgICAgICAgbW9kZWxcbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgYXN5bmMgdXBkYXRlTWFueShkYXRhKSB7XG4gICAgICBjb25zdCB7IG1vZGVsLCB3aGVyZSwgdXBkYXRlOiB2YWx1ZXMgfSA9IGRhdGE7XG4gICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gdHJhbnNmb3JtSW5wdXQodmFsdWVzLCBtb2RlbCwgXCJ1cGRhdGVcIik7XG4gICAgICBsZXQgcXVlcnkgPSBkYi51cGRhdGVUYWJsZShnZXRNb2RlbE5hbWUobW9kZWwpKS5zZXQodHJhbnNmb3JtZWREYXRhKTtcbiAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcikge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICAgIHJldHVybiByZXMubGVuZ3RoO1xuICAgIH0sXG4gICAgYXN5bmMgZGVsZXRlKGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlIH0gPSBkYXRhO1xuICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgIGxldCBxdWVyeSA9IGRiLmRlbGV0ZUZyb20oZ2V0TW9kZWxOYW1lKG1vZGVsKSk7XG4gICAgICBpZiAoYW5kKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBpZiAob3IpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBxdWVyeS5leGVjdXRlKCk7XG4gICAgfSxcbiAgICBhc3luYyBkZWxldGVNYW55KGRhdGEpIHtcbiAgICAgIGNvbnN0IHsgbW9kZWwsIHdoZXJlIH0gPSBkYXRhO1xuICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgIGxldCBxdWVyeSA9IGRiLmRlbGV0ZUZyb20oZ2V0TW9kZWxOYW1lKG1vZGVsKSk7XG4gICAgICBpZiAoYW5kKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICBpZiAob3IpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gKGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKSkubGVuZ3RoO1xuICAgIH0sXG4gICAgb3B0aW9uczogY29uZmlnXG4gIH07XG59O1xuXG5leHBvcnQgeyBjb252ZXJ0RnJvbURCLCBjb252ZXJ0VG9EQiwgY3JlYXRlRmllbGRBdHRyaWJ1dGUsIGNyZWF0ZUludGVybmFsQWRhcHRlciwgY3JlYXRlS3lzZWx5QWRhcHRlciwgZ2V0QWRhcHRlciwgZ2V0QXV0aFRhYmxlcywgZ2V0TWlncmF0aW9ucywgZ2V0U2NoZW1hLCBnZXRXaXRoSG9va3MsIGt5c2VseUFkYXB0ZXIsIG1hdGNoVHlwZSwgbWVtb3J5QWRhcHRlciwgdG9ab2RTY2hlbWEsIHdpdGhBcHBseURlZmF1bHQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   multiSession: () => (/* binding */ multiSession)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\nvar multiSession = (options) => {\n  const opts = {\n    maximumSessions: 5,\n    ...options\n  };\n  const isMultiSessionCookie = (key) => key.includes(\"_multi-\");\n  const ERROR_CODES = {\n    INVALID_SESSION_TOKEN: \"Invalid session token\"\n  };\n  return {\n    id: \"multi-session\",\n    endpoints: {\n      listDeviceSessions: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/multi-session/list-device-sessions\",\n        {\n          method: \"GET\",\n          requireHeaders: true\n        },\n        async (ctx) => {\n          const cookieHeader = ctx.headers?.get(\"cookie\");\n          if (!cookieHeader) return ctx.json([]);\n          const cookies = Object.fromEntries((0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(cookieHeader));\n          const sessionTokens = (await Promise.all(\n            Object.entries(cookies).filter(([key]) => isMultiSessionCookie(key)).map(\n              async ([key]) => await ctx.getSignedCookie(key, ctx.context.secret)\n            )\n          )).filter((v) => v !== void 0);\n          if (!sessionTokens.length) return ctx.json([]);\n          const sessions = await ctx.context.internalAdapter.findSessions(sessionTokens);\n          const validSessions = sessions.filter(\n            (session) => session && session.session.expiresAt > /* @__PURE__ */ new Date()\n          );\n          return ctx.json(validSessions);\n        }\n      ),\n      setActiveSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/multi-session/set-active\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n            sessionToken: zod__WEBPACK_IMPORTED_MODULE_2__.z.string({\n              description: \"The session token to set as active\"\n            })\n          }),\n          requireHeaders: true,\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Set the active session\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const sessionToken = ctx.body.sessionToken;\n          const multiSessionCookieName = `${ctx.context.authCookies.sessionToken.name}_multi-${sessionToken}`;\n          const sessionCookie = await ctx.getSignedCookie(\n            multiSessionCookieName,\n            ctx.context.secret\n          );\n          if (!sessionCookie) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_SESSION_TOKEN\n            });\n          }\n          const session = await ctx.context.internalAdapter.findSession(sessionToken);\n          if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n            ctx.setCookie(multiSessionCookieName, \"\", {\n              ...ctx.context.authCookies.sessionToken.options,\n              maxAge: 0\n            });\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_SESSION_TOKEN\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, session);\n          return ctx.json(session);\n        }\n      ),\n      revokeDeviceSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/multi-session/revoke\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n            sessionToken: zod__WEBPACK_IMPORTED_MODULE_2__.z.string({\n              description: \"The session token to revoke\"\n            })\n          }),\n          requireHeaders: true,\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Revoke a device session\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          status: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const sessionToken = ctx.body.sessionToken;\n          const multiSessionCookieName = `${ctx.context.authCookies.sessionToken.name}_multi-${sessionToken}`;\n          const sessionCookie = await ctx.getSignedCookie(\n            multiSessionCookieName,\n            ctx.context.secret\n          );\n          if (!sessionCookie) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_SESSION_TOKEN\n            });\n          }\n          await ctx.context.internalAdapter.deleteSession(sessionToken);\n          ctx.setCookie(multiSessionCookieName, \"\", {\n            ...ctx.context.authCookies.sessionToken.options,\n            maxAge: 0\n          });\n          const isActive = ctx.context.session?.session.token === sessionToken;\n          if (!isActive) return ctx.json({ status: true });\n          const cookieHeader = ctx.headers?.get(\"cookie\");\n          if (cookieHeader) {\n            const cookies = Object.fromEntries((0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(cookieHeader));\n            const sessionTokens = (await Promise.all(\n              Object.entries(cookies).filter(([key]) => isMultiSessionCookie(key)).map(\n                async ([key]) => await ctx.getSignedCookie(key, ctx.context.secret)\n              )\n            )).filter((v) => v !== void 0);\n            const internalAdapter = ctx.context.internalAdapter;\n            if (sessionTokens.length > 0) {\n              const sessions = await internalAdapter.findSessions(sessionTokens);\n              const validSessions = sessions.filter(\n                (session) => session && session.session.expiresAt > /* @__PURE__ */ new Date()\n              );\n              if (validSessions.length > 0) {\n                const nextSession = validSessions[0];\n                await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, nextSession);\n              } else {\n                (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n              }\n            } else {\n              (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n            }\n          } else {\n            (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n          }\n          return ctx.json({\n            status: true\n          });\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher: () => true,\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const headers = ctx.context.returned instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError ? ctx.context.returned.headers : ctx.responseHeader;\n            const cookieString = headers.get(\"set-cookie\");\n            if (!cookieString) return;\n            const setCookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseSetCookieHeader)(cookieString);\n            const sessionCookieConfig = ctx.context.authCookies.sessionToken;\n            const sessionToken = setCookies.get(\n              sessionCookieConfig.name\n            )?.value;\n            if (!sessionToken) return;\n            const cookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(ctx.headers?.get(\"cookie\") || \"\");\n            const rawSession = sessionToken.split(\".\")[0];\n            if (!rawSession) {\n              return;\n            }\n            const cookieName = `${sessionCookieConfig.name}_multi-${rawSession}`;\n            if (setCookies.get(cookieName) || cookies.get(cookieName)) return;\n            const currentMultiSessions = Object.keys(Object.fromEntries(cookies)).filter(\n              isMultiSessionCookie\n            ).length + (cookieString.includes(\"session_token\") ? 1 : 0);\n            if (currentMultiSessions > opts.maximumSessions) {\n              return;\n            }\n            await ctx.setSignedCookie(\n              cookieName,\n              rawSession,\n              ctx.context.secret,\n              sessionCookieConfig.options\n            );\n          })\n        },\n        {\n          matcher: (context) => context.path === \"/sign-out\",\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const cookieHeader = ctx.headers?.get(\"cookie\");\n            if (!cookieHeader) return;\n            const cookies = Object.fromEntries((0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseCookies)(cookieHeader));\n            const ids = Object.keys(cookies).map((key) => {\n              if (isMultiSessionCookie(key)) {\n                ctx.setCookie(key, \"\", { maxAge: 0 });\n                const id = key.split(\"_multi-\")[1];\n                return id;\n              }\n              return null;\n            }).filter((v) => v !== null);\n            await ctx.context.internalAdapter.deleteSessions(ids);\n          })\n        }\n      ]\n    },\n    $ERROR_CODES: ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTZCM1VXQUozLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEc7QUFDSTtBQUN4Rjs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHNFQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsZ0VBQVk7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0VBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QiwwQkFBMEIseUNBQVE7QUFDbEM7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0EsZ0JBQWdCLGlFQUFpQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsNENBQTRDLDBDQUEwQyxTQUFTLGFBQWE7QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2Isc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0VBQWtCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QiwwQkFBMEIseUNBQVE7QUFDbEM7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0EsZ0JBQWdCLGlFQUFpQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsNENBQTRDLDBDQUEwQyxTQUFTLGFBQWE7QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsMkNBQTJDLGNBQWM7QUFDekQ7QUFDQTtBQUNBLCtDQUErQyxnRUFBWTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixvRUFBZ0I7QUFDdEMsZ0JBQWdCO0FBQ2hCLGdCQUFnQix1RUFBbUI7QUFDbkM7QUFDQSxjQUFjO0FBQ2QsY0FBYyx1RUFBbUI7QUFDakM7QUFDQSxZQUFZO0FBQ1osWUFBWSx1RUFBbUI7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsd0VBQW9CO0FBQ3ZDLDREQUE0RCx3REFBUTtBQUNwRTtBQUNBO0FBQ0EsK0JBQStCLHdFQUFvQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGdFQUFZO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHlCQUF5QixTQUFTLFdBQVc7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQSxtQkFBbUIsd0VBQW9CO0FBQ3ZDO0FBQ0E7QUFDQSwrQ0FBK0MsZ0VBQVk7QUFDM0Q7QUFDQTtBQUNBLHlDQUF5QyxXQUFXO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUV3QiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTZCM1VXQUozLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgc2Vzc2lvbk1pZGRsZXdhcmUsIEFQSUVycm9yLCBjcmVhdGVBdXRoTWlkZGxld2FyZSB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgcGFyc2VDb29raWVzLCBzZXRTZXNzaW9uQ29va2llLCBkZWxldGVTZXNzaW9uQ29va2llLCBwYXJzZVNldENvb2tpZUhlYWRlciB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbnZhciBtdWx0aVNlc3Npb24gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBvcHRzID0ge1xuICAgIG1heGltdW1TZXNzaW9uczogNSxcbiAgICAuLi5vcHRpb25zXG4gIH07XG4gIGNvbnN0IGlzTXVsdGlTZXNzaW9uQ29va2llID0gKGtleSkgPT4ga2V5LmluY2x1ZGVzKFwiX211bHRpLVwiKTtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgSU5WQUxJRF9TRVNTSU9OX1RPS0VOOiBcIkludmFsaWQgc2Vzc2lvbiB0b2tlblwiXG4gIH07XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibXVsdGktc2Vzc2lvblwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgbGlzdERldmljZVNlc3Npb25zOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL211bHRpLXNlc3Npb24vbGlzdC1kZXZpY2Utc2Vzc2lvbnNcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICByZXF1aXJlSGVhZGVyczogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgY29va2llSGVhZGVyID0gY3R4LmhlYWRlcnM/LmdldChcImNvb2tpZVwiKTtcbiAgICAgICAgICBpZiAoIWNvb2tpZUhlYWRlcikgcmV0dXJuIGN0eC5qc29uKFtdKTtcbiAgICAgICAgICBjb25zdCBjb29raWVzID0gT2JqZWN0LmZyb21FbnRyaWVzKHBhcnNlQ29va2llcyhjb29raWVIZWFkZXIpKTtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uVG9rZW5zID0gKGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29va2llcykuZmlsdGVyKChba2V5XSkgPT4gaXNNdWx0aVNlc3Npb25Db29raWUoa2V5KSkubWFwKFxuICAgICAgICAgICAgICBhc3luYyAoW2tleV0pID0+IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoa2V5LCBjdHguY29udGV4dC5zZWNyZXQpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSkuZmlsdGVyKCh2KSA9PiB2ICE9PSB2b2lkIDApO1xuICAgICAgICAgIGlmICghc2Vzc2lvblRva2Vucy5sZW5ndGgpIHJldHVybiBjdHguanNvbihbXSk7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb25zKHNlc3Npb25Ub2tlbnMpO1xuICAgICAgICAgIGNvbnN0IHZhbGlkU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIoXG4gICAgICAgICAgICAoc2Vzc2lvbikgPT4gc2Vzc2lvbiAmJiBzZXNzaW9uLnNlc3Npb24uZXhwaXJlc0F0ID4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih2YWxpZFNlc3Npb25zKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHNldEFjdGl2ZVNlc3Npb246IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvbXVsdGktc2Vzc2lvbi9zZXQtYWN0aXZlXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHNlc3Npb25Ub2tlbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgc2Vzc2lvbiB0b2tlbiB0byBzZXQgYXMgYWN0aXZlXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgICAgICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNldCB0aGUgYWN0aXZlIHNlc3Npb25cIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGN0eC5ib2R5LnNlc3Npb25Ub2tlbjtcbiAgICAgICAgICBjb25zdCBtdWx0aVNlc3Npb25Db29raWVOYW1lID0gYCR7Y3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWV9X211bHRpLSR7c2Vzc2lvblRva2VufWA7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICBtdWx0aVNlc3Npb25Db29raWVOYW1lLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb25Db29raWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfU0VTU0lPTl9UT0tFTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24oc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24gfHwgc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBjdHguc2V0Q29va2llKG11bHRpU2Vzc2lvbkNvb2tpZU5hbWUsIFwiXCIsIHtcbiAgICAgICAgICAgICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm9wdGlvbnMsXG4gICAgICAgICAgICAgIG1heEFnZTogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1NFU1NJT05fVE9LRU5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwgc2Vzc2lvbik7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHNlc3Npb24pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgcmV2b2tlRGV2aWNlU2Vzc2lvbjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9tdWx0aS1zZXNzaW9uL3Jldm9rZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBzZXNzaW9uVG9rZW46IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHNlc3Npb24gdG9rZW4gdG8gcmV2b2tlXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgICAgICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhIGRldmljZSBzZXNzaW9uXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGN0eC5ib2R5LnNlc3Npb25Ub2tlbjtcbiAgICAgICAgICBjb25zdCBtdWx0aVNlc3Npb25Db29raWVOYW1lID0gYCR7Y3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWV9X211bHRpLSR7c2Vzc2lvblRva2VufWA7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICBtdWx0aVNlc3Npb25Db29raWVOYW1lLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb25Db29raWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfU0VTU0lPTl9UT0tFTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHNlc3Npb25Ub2tlbik7XG4gICAgICAgICAgY3R4LnNldENvb2tpZShtdWx0aVNlc3Npb25Db29raWVOYW1lLCBcIlwiLCB7XG4gICAgICAgICAgICAuLi5jdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ub3B0aW9ucyxcbiAgICAgICAgICAgIG1heEFnZTogMFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IGlzQWN0aXZlID0gY3R4LmNvbnRleHQuc2Vzc2lvbj8uc2Vzc2lvbi50b2tlbiA9PT0gc2Vzc2lvblRva2VuO1xuICAgICAgICAgIGlmICghaXNBY3RpdmUpIHJldHVybiBjdHguanNvbih7IHN0YXR1czogdHJ1ZSB9KTtcbiAgICAgICAgICBjb25zdCBjb29raWVIZWFkZXIgPSBjdHguaGVhZGVycz8uZ2V0KFwiY29va2llXCIpO1xuICAgICAgICAgIGlmIChjb29raWVIZWFkZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZXMgPSBPYmplY3QuZnJvbUVudHJpZXMocGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikpO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvblRva2VucyA9IChhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29va2llcykuZmlsdGVyKChba2V5XSkgPT4gaXNNdWx0aVNlc3Npb25Db29raWUoa2V5KSkubWFwKFxuICAgICAgICAgICAgICAgIGFzeW5jIChba2V5XSkgPT4gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShrZXksIGN0eC5jb250ZXh0LnNlY3JldClcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSkuZmlsdGVyKCh2KSA9PiB2ICE9PSB2b2lkIDApO1xuICAgICAgICAgICAgY29uc3QgaW50ZXJuYWxBZGFwdGVyID0gY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyO1xuICAgICAgICAgICAgaWYgKHNlc3Npb25Ub2tlbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbnMoc2Vzc2lvblRva2Vucyk7XG4gICAgICAgICAgICAgIGNvbnN0IHZhbGlkU2Vzc2lvbnMgPSBzZXNzaW9ucy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgKHNlc3Npb24pID0+IHNlc3Npb24gJiYgc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdCA+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGlmICh2YWxpZFNlc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0U2Vzc2lvbiA9IHZhbGlkU2Vzc2lvbnNbMF07XG4gICAgICAgICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIG5leHRTZXNzaW9uKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIGhvb2tzOiB7XG4gICAgICBhZnRlcjogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcjogKCkgPT4gdHJ1ZSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gY3R4LmNvbnRleHQucmV0dXJuZWQgaW5zdGFuY2VvZiBBUElFcnJvciA/IGN0eC5jb250ZXh0LnJldHVybmVkLmhlYWRlcnMgOiBjdHgucmVzcG9uc2VIZWFkZXI7XG4gICAgICAgICAgICBjb25zdCBjb29raWVTdHJpbmcgPSBoZWFkZXJzLmdldChcInNldC1jb29raWVcIik7XG4gICAgICAgICAgICBpZiAoIWNvb2tpZVN0cmluZykgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3Qgc2V0Q29va2llcyA9IHBhcnNlU2V0Q29va2llSGVhZGVyKGNvb2tpZVN0cmluZyk7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uQ29va2llQ29uZmlnID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvblRva2VuID0gc2V0Q29va2llcy5nZXQoXG4gICAgICAgICAgICAgIHNlc3Npb25Db29raWVDb25maWcubmFtZVxuICAgICAgICAgICAgKT8udmFsdWU7XG4gICAgICAgICAgICBpZiAoIXNlc3Npb25Ub2tlbikgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgY29va2llcyA9IHBhcnNlQ29va2llcyhjdHguaGVhZGVycz8uZ2V0KFwiY29va2llXCIpIHx8IFwiXCIpO1xuICAgICAgICAgICAgY29uc3QgcmF3U2Vzc2lvbiA9IHNlc3Npb25Ub2tlbi5zcGxpdChcIi5cIilbMF07XG4gICAgICAgICAgICBpZiAoIXJhd1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY29va2llTmFtZSA9IGAke3Nlc3Npb25Db29raWVDb25maWcubmFtZX1fbXVsdGktJHtyYXdTZXNzaW9ufWA7XG4gICAgICAgICAgICBpZiAoc2V0Q29va2llcy5nZXQoY29va2llTmFtZSkgfHwgY29va2llcy5nZXQoY29va2llTmFtZSkpIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRNdWx0aVNlc3Npb25zID0gT2JqZWN0LmtleXMoT2JqZWN0LmZyb21FbnRyaWVzKGNvb2tpZXMpKS5maWx0ZXIoXG4gICAgICAgICAgICAgIGlzTXVsdGlTZXNzaW9uQ29va2llXG4gICAgICAgICAgICApLmxlbmd0aCArIChjb29raWVTdHJpbmcuaW5jbHVkZXMoXCJzZXNzaW9uX3Rva2VuXCIpID8gMSA6IDApO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRNdWx0aVNlc3Npb25zID4gb3B0cy5tYXhpbXVtU2Vzc2lvbnMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICAgICAgICAgICAgY29va2llTmFtZSxcbiAgICAgICAgICAgICAgcmF3U2Vzc2lvbixcbiAgICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgICBzZXNzaW9uQ29va2llQ29uZmlnLm9wdGlvbnNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXI6IChjb250ZXh0KSA9PiBjb250ZXh0LnBhdGggPT09IFwiL3NpZ24tb3V0XCIsXG4gICAgICAgICAgaGFuZGxlcjogY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29va2llSGVhZGVyID0gY3R4LmhlYWRlcnM/LmdldChcImNvb2tpZVwiKTtcbiAgICAgICAgICAgIGlmICghY29va2llSGVhZGVyKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBjb29raWVzID0gT2JqZWN0LmZyb21FbnRyaWVzKHBhcnNlQ29va2llcyhjb29raWVIZWFkZXIpKTtcbiAgICAgICAgICAgIGNvbnN0IGlkcyA9IE9iamVjdC5rZXlzKGNvb2tpZXMpLm1hcCgoa2V5KSA9PiB7XG4gICAgICAgICAgICAgIGlmIChpc011bHRpU2Vzc2lvbkNvb2tpZShrZXkpKSB7XG4gICAgICAgICAgICAgICAgY3R4LnNldENvb2tpZShrZXksIFwiXCIsIHsgbWF4QWdlOiAwIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0ga2V5LnNwbGl0KFwiX211bHRpLVwiKVsxXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9KS5maWx0ZXIoKHYpID0+IHYgIT09IG51bGwpO1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKGlkcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0sXG4gICAgJEVSUk9SX0NPREVTOiBFUlJPUl9DT0RFU1xuICB9O1xufTtcblxuZXhwb3J0IHsgbXVsdGlTZXNzaW9uIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   jwt: () => (/* binding */ jwt)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/generate_key_pair.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/export.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n\n\n\n\n\n\nvar schema = {\n  jwks: {\n    fields: {\n      publicKey: {\n        type: \"string\",\n        required: true\n      },\n      privateKey: {\n        type: \"string\",\n        required: true\n      },\n      createdAt: {\n        type: \"date\",\n        required: true\n      }\n    }\n  }\n};\nzod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n  publicKey: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n  privateKey: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_3__.z.date()\n});\n\n// src/plugins/jwt/adapter.ts\nvar getJwksAdapter = (adapter) => {\n  return {\n    getAllKeys: async () => {\n      return await adapter.findMany({\n        model: \"jwks\"\n      });\n    },\n    getLatestKey: async () => {\n      const key = await adapter.findMany({\n        model: \"jwks\",\n        sortBy: {\n          field: \"createdAt\",\n          direction: \"desc\"\n        },\n        limit: 1\n      });\n      return key[0];\n    },\n    createJwk: async (webKey) => {\n      const jwk2 = await adapter.create({\n        model: \"jwks\",\n        data: {\n          ...webKey,\n          createdAt: /* @__PURE__ */ new Date()\n        }\n      });\n      return jwk2;\n    }\n  };\n};\nvar jwt = (options) => {\n  return {\n    id: \"jwt\",\n    endpoints: {\n      getJwks: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/jwks\",\n        {\n          method: \"GET\",\n          metadata: {\n            openapi: {\n              description: \"Get the JSON Web Key Set\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          keys: {\n                            type: \"array\",\n                            items: {\n                              type: \"object\",\n                              properties: {\n                                kid: {\n                                  type: \"string\"\n                                },\n                                kty: {\n                                  type: \"string\"\n                                },\n                                use: {\n                                  type: \"string\"\n                                },\n                                alg: {\n                                  type: \"string\"\n                                },\n                                n: {\n                                  type: \"string\"\n                                },\n                                e: {\n                                  type: \"string\"\n                                }\n                              }\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const adapter = getJwksAdapter(ctx.context.adapter);\n          const keySets = await adapter.getAllKeys();\n          if (keySets.length === 0) {\n            const alg = options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\";\n            const { publicKey, privateKey } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.generateKeyPair)(\n              alg,\n              options?.jwks?.keyPairConfig ?? {\n                crv: \"Ed25519\",\n                extractable: true\n              }\n            );\n            const publicWebKey = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(publicKey);\n            const privateWebKey = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(privateKey);\n            const stringifiedPrivateWebKey = JSON.stringify(privateWebKey);\n            const privateKeyEncryptionEnabled = !options?.jwks?.disablePrivateKeyEncryption;\n            let jwk2 = {\n              id: ctx.context.generateId({\n                model: \"jwks\"\n              }),\n              publicKey: JSON.stringify({ alg, ...publicWebKey }),\n              privateKey: privateKeyEncryptionEnabled ? JSON.stringify(\n                await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.symmetricEncrypt)({\n                  key: ctx.context.options.secret,\n                  data: stringifiedPrivateWebKey\n                })\n              ) : stringifiedPrivateWebKey,\n              createdAt: /* @__PURE__ */ new Date()\n            };\n            await adapter.createJwk(jwk2);\n            return ctx.json({\n              keys: [\n                {\n                  ...publicWebKey,\n                  alg,\n                  kid: jwk2.id\n                }\n              ]\n            });\n          }\n          return ctx.json({\n            keys: keySets.map((keySet) => ({\n              ...JSON.parse(keySet.publicKey),\n              kid: keySet.id\n            }))\n          });\n        }\n      ),\n      getToken: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/token\",\n        {\n          method: \"GET\",\n          requireHeaders: true,\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              description: \"Get a JWT token\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          token: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const adapter = getJwksAdapter(ctx.context.adapter);\n          let key = await adapter.getLatestKey();\n          const privateKeyEncryptionEnabled = !options?.jwks?.disablePrivateKeyEncryption;\n          if (key === void 0) {\n            const { publicKey, privateKey: privateKey2 } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.generateKeyPair)(\n              options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\",\n              options?.jwks?.keyPairConfig ?? {\n                crv: \"Ed25519\",\n                extractable: true\n              }\n            );\n            const publicWebKey = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(publicKey);\n            const privateWebKey2 = await (0,jose__WEBPACK_IMPORTED_MODULE_5__.exportJWK)(privateKey2);\n            const stringifiedPrivateWebKey = JSON.stringify(privateWebKey2);\n            let jwk2 = {\n              id: ctx.context.generateId({\n                model: \"jwks\"\n              }),\n              publicKey: JSON.stringify(publicWebKey),\n              privateKey: privateKeyEncryptionEnabled ? JSON.stringify(\n                await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.symmetricEncrypt)({\n                  key: ctx.context.options.secret,\n                  data: stringifiedPrivateWebKey\n                })\n              ) : stringifiedPrivateWebKey,\n              createdAt: /* @__PURE__ */ new Date()\n            };\n            key = await adapter.createJwk(jwk2);\n          }\n          let privateWebKey = privateKeyEncryptionEnabled ? await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.symmetricDecrypt)({\n            key: ctx.context.options.secret,\n            data: JSON.parse(key.privateKey)\n          }) : key.privateKey;\n          const privateKey = await (0,jose__WEBPACK_IMPORTED_MODULE_6__.importJWK)(\n            JSON.parse(privateWebKey),\n            options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\"\n          );\n          const payload = !options?.jwt?.definePayload ? ctx.context.session.user : await options?.jwt.definePayload(ctx.context.session);\n          const jwt2 = await new jose__WEBPACK_IMPORTED_MODULE_7__.SignJWT({\n            ...payload,\n            // I am aware that this is not the best way to handle this, but this is the only way I know to get the impersonatedBy field\n            ...ctx.context.session.session.impersonatedBy ? {\n              impersonatedBy: ctx.context.session.session.impersonatedBy\n            } : {}\n          }).setProtectedHeader({\n            alg: options?.jwks?.keyPairConfig?.alg ?? \"EdDSA\",\n            kid: key.id\n          }).setIssuedAt().setIssuer(options?.jwt?.issuer ?? ctx.context.options.baseURL).setAudience(options?.jwt?.audience ?? ctx.context.options.baseURL).setExpirationTime(options?.jwt?.expirationTime ?? \"15m\").setSubject(ctx.context.session.user.id).sign(privateKey);\n          return ctx.json({\n            token: jwt2\n          });\n        }\n      )\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_1__.mergeSchema)(schema, options?.schema)\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTdMVTdQVlBQLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUE0RTtBQUMxQjtBQUN1QjtBQUNqRDtBQUM4Qzs7QUFFdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUFRO0FBQ1IsTUFBTSx5Q0FBUTtBQUNkLGFBQWEseUNBQVE7QUFDckIsY0FBYyx5Q0FBUTtBQUN0QixhQUFhLHVDQUFNO0FBQ25CLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsc0VBQWtCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix3QkFBd0IsUUFBUSxxREFBZTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsK0NBQVM7QUFDaEQsd0NBQXdDLCtDQUFTO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsMENBQTBDLHNCQUFzQjtBQUNoRTtBQUNBLHNCQUFzQixvRUFBZ0I7QUFDdEM7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBLGdCQUFnQixzRUFBa0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUVBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IscUNBQXFDLFFBQVEscURBQWU7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLCtDQUFTO0FBQ2hELHlDQUF5QywrQ0FBUztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0Esc0JBQXNCLG9FQUFnQjtBQUN0QztBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0Usb0VBQWdCO0FBQ2xGO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsbUNBQW1DLCtDQUFTO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHlDQUFPO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkLFdBQVc7QUFDWDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZLCtEQUFXO0FBQ3ZCO0FBQ0E7O0FBRWUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay03TFU3UFZQUC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIHNlc3Npb25NaWRkbGV3YXJlIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBtZXJnZVNjaGVtYSB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgc3ltbWV0cmljRW5jcnlwdCwgc3ltbWV0cmljRGVjcnlwdCB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBnZW5lcmF0ZUtleVBhaXIsIGV4cG9ydEpXSywgaW1wb3J0SldLLCBTaWduSldUIH0gZnJvbSAnam9zZSc7XG5cbnZhciBzY2hlbWEgPSB7XG4gIGp3a3M6IHtcbiAgICBmaWVsZHM6IHtcbiAgICAgIHB1YmxpY0tleToge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgfSxcbiAgICAgIHByaXZhdGVLZXk6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgIH0sXG4gICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgcHVibGljS2V5OiB6LnN0cmluZygpLFxuICBwcml2YXRlS2V5OiB6LnN0cmluZygpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpXG59KTtcblxuLy8gc3JjL3BsdWdpbnMvand0L2FkYXB0ZXIudHNcbnZhciBnZXRKd2tzQWRhcHRlciA9IChhZGFwdGVyKSA9PiB7XG4gIHJldHVybiB7XG4gICAgZ2V0QWxsS2V5czogYXN5bmMgKCkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJqd2tzXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0TGF0ZXN0S2V5OiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiandrc1wiLFxuICAgICAgICBzb3J0Qnk6IHtcbiAgICAgICAgICBmaWVsZDogXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICBkaXJlY3Rpb246IFwiZGVzY1wiXG4gICAgICAgIH0sXG4gICAgICAgIGxpbWl0OiAxXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBrZXlbMF07XG4gICAgfSxcbiAgICBjcmVhdGVKd2s6IGFzeW5jICh3ZWJLZXkpID0+IHtcbiAgICAgIGNvbnN0IGp3azIgPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZSh7XG4gICAgICAgIG1vZGVsOiBcImp3a3NcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIC4uLndlYktleSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGp3azI7XG4gICAgfVxuICB9O1xufTtcbnZhciBqd3QgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImp3dFwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgZ2V0SndrczogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9qd2tzXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSBKU09OIFdlYiBLZXkgU2V0XCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAga2V5czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2lkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrdHk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgYWRhcHRlciA9IGdldEp3a3NBZGFwdGVyKGN0eC5jb250ZXh0LmFkYXB0ZXIpO1xuICAgICAgICAgIGNvbnN0IGtleVNldHMgPSBhd2FpdCBhZGFwdGVyLmdldEFsbEtleXMoKTtcbiAgICAgICAgICBpZiAoa2V5U2V0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGFsZyA9IG9wdGlvbnM/Lmp3a3M/LmtleVBhaXJDb25maWc/LmFsZyA/PyBcIkVkRFNBXCI7XG4gICAgICAgICAgICBjb25zdCB7IHB1YmxpY0tleSwgcHJpdmF0ZUtleSB9ID0gYXdhaXQgZ2VuZXJhdGVLZXlQYWlyKFxuICAgICAgICAgICAgICBhbGcsXG4gICAgICAgICAgICAgIG9wdGlvbnM/Lmp3a3M/LmtleVBhaXJDb25maWcgPz8ge1xuICAgICAgICAgICAgICAgIGNydjogXCJFZDI1NTE5XCIsXG4gICAgICAgICAgICAgICAgZXh0cmFjdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHB1YmxpY1dlYktleSA9IGF3YWl0IGV4cG9ydEpXSyhwdWJsaWNLZXkpO1xuICAgICAgICAgICAgY29uc3QgcHJpdmF0ZVdlYktleSA9IGF3YWl0IGV4cG9ydEpXSyhwcml2YXRlS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ2lmaWVkUHJpdmF0ZVdlYktleSA9IEpTT04uc3RyaW5naWZ5KHByaXZhdGVXZWJLZXkpO1xuICAgICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUVuY3J5cHRpb25FbmFibGVkID0gIW9wdGlvbnM/Lmp3a3M/LmRpc2FibGVQcml2YXRlS2V5RW5jcnlwdGlvbjtcbiAgICAgICAgICAgIGxldCBqd2syID0ge1xuICAgICAgICAgICAgICBpZDogY3R4LmNvbnRleHQuZ2VuZXJhdGVJZCh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IFwiandrc1wiXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBwdWJsaWNLZXk6IEpTT04uc3RyaW5naWZ5KHsgYWxnLCAuLi5wdWJsaWNXZWJLZXkgfSksXG4gICAgICAgICAgICAgIHByaXZhdGVLZXk6IHByaXZhdGVLZXlFbmNyeXB0aW9uRW5hYmxlZCA/IEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgICAgIGF3YWl0IHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgICAgICAgICAgICAgICAga2V5OiBjdHguY29udGV4dC5vcHRpb25zLnNlY3JldCxcbiAgICAgICAgICAgICAgICAgIGRhdGE6IHN0cmluZ2lmaWVkUHJpdmF0ZVdlYktleVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICkgOiBzdHJpbmdpZmllZFByaXZhdGVXZWJLZXksXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhd2FpdCBhZGFwdGVyLmNyZWF0ZUp3ayhqd2syKTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAgIGtleXM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAuLi5wdWJsaWNXZWJLZXksXG4gICAgICAgICAgICAgICAgICBhbGcsXG4gICAgICAgICAgICAgICAgICBraWQ6IGp3azIuaWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAga2V5czoga2V5U2V0cy5tYXAoKGtleVNldCkgPT4gKHtcbiAgICAgICAgICAgICAgLi4uSlNPTi5wYXJzZShrZXlTZXQucHVibGljS2V5KSxcbiAgICAgICAgICAgICAga2lkOiBrZXlTZXQuaWRcbiAgICAgICAgICAgIH0pKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgZ2V0VG9rZW46IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvdG9rZW5cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICAgICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IGEgSldUIHRva2VuXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBhZGFwdGVyID0gZ2V0Sndrc0FkYXB0ZXIoY3R4LmNvbnRleHQuYWRhcHRlcik7XG4gICAgICAgICAgbGV0IGtleSA9IGF3YWl0IGFkYXB0ZXIuZ2V0TGF0ZXN0S2V5KCk7XG4gICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUVuY3J5cHRpb25FbmFibGVkID0gIW9wdGlvbnM/Lmp3a3M/LmRpc2FibGVQcml2YXRlS2V5RW5jcnlwdGlvbjtcbiAgICAgICAgICBpZiAoa2V5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbnN0IHsgcHVibGljS2V5LCBwcml2YXRlS2V5OiBwcml2YXRlS2V5MiB9ID0gYXdhaXQgZ2VuZXJhdGVLZXlQYWlyKFxuICAgICAgICAgICAgICBvcHRpb25zPy5qd2tzPy5rZXlQYWlyQ29uZmlnPy5hbGcgPz8gXCJFZERTQVwiLFxuICAgICAgICAgICAgICBvcHRpb25zPy5qd2tzPy5rZXlQYWlyQ29uZmlnID8/IHtcbiAgICAgICAgICAgICAgICBjcnY6IFwiRWQyNTUxOVwiLFxuICAgICAgICAgICAgICAgIGV4dHJhY3RhYmxlOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBwdWJsaWNXZWJLZXkgPSBhd2FpdCBleHBvcnRKV0socHVibGljS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IHByaXZhdGVXZWJLZXkyID0gYXdhaXQgZXhwb3J0SldLKHByaXZhdGVLZXkyKTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ2lmaWVkUHJpdmF0ZVdlYktleSA9IEpTT04uc3RyaW5naWZ5KHByaXZhdGVXZWJLZXkyKTtcbiAgICAgICAgICAgIGxldCBqd2syID0ge1xuICAgICAgICAgICAgICBpZDogY3R4LmNvbnRleHQuZ2VuZXJhdGVJZCh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IFwiandrc1wiXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBwdWJsaWNLZXk6IEpTT04uc3RyaW5naWZ5KHB1YmxpY1dlYktleSksXG4gICAgICAgICAgICAgIHByaXZhdGVLZXk6IHByaXZhdGVLZXlFbmNyeXB0aW9uRW5hYmxlZCA/IEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgICAgIGF3YWl0IHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgICAgICAgICAgICAgICAga2V5OiBjdHguY29udGV4dC5vcHRpb25zLnNlY3JldCxcbiAgICAgICAgICAgICAgICAgIGRhdGE6IHN0cmluZ2lmaWVkUHJpdmF0ZVdlYktleVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICkgOiBzdHJpbmdpZmllZFByaXZhdGVXZWJLZXksXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBrZXkgPSBhd2FpdCBhZGFwdGVyLmNyZWF0ZUp3ayhqd2syKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IHByaXZhdGVXZWJLZXkgPSBwcml2YXRlS2V5RW5jcnlwdGlvbkVuYWJsZWQgPyBhd2FpdCBzeW1tZXRyaWNEZWNyeXB0KHtcbiAgICAgICAgICAgIGtleTogY3R4LmNvbnRleHQub3B0aW9ucy5zZWNyZXQsXG4gICAgICAgICAgICBkYXRhOiBKU09OLnBhcnNlKGtleS5wcml2YXRlS2V5KVxuICAgICAgICAgIH0pIDoga2V5LnByaXZhdGVLZXk7XG4gICAgICAgICAgY29uc3QgcHJpdmF0ZUtleSA9IGF3YWl0IGltcG9ydEpXSyhcbiAgICAgICAgICAgIEpTT04ucGFyc2UocHJpdmF0ZVdlYktleSksXG4gICAgICAgICAgICBvcHRpb25zPy5qd2tzPy5rZXlQYWlyQ29uZmlnPy5hbGcgPz8gXCJFZERTQVwiXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBwYXlsb2FkID0gIW9wdGlvbnM/Lmp3dD8uZGVmaW5lUGF5bG9hZCA/IGN0eC5jb250ZXh0LnNlc3Npb24udXNlciA6IGF3YWl0IG9wdGlvbnM/Lmp3dC5kZWZpbmVQYXlsb2FkKGN0eC5jb250ZXh0LnNlc3Npb24pO1xuICAgICAgICAgIGNvbnN0IGp3dDIgPSBhd2FpdCBuZXcgU2lnbkpXVCh7XG4gICAgICAgICAgICAuLi5wYXlsb2FkLFxuICAgICAgICAgICAgLy8gSSBhbSBhd2FyZSB0aGF0IHRoaXMgaXMgbm90IHRoZSBiZXN0IHdheSB0byBoYW5kbGUgdGhpcywgYnV0IHRoaXMgaXMgdGhlIG9ubHkgd2F5IEkga25vdyB0byBnZXQgdGhlIGltcGVyc29uYXRlZEJ5IGZpZWxkXG4gICAgICAgICAgICAuLi5jdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24uaW1wZXJzb25hdGVkQnkgPyB7XG4gICAgICAgICAgICAgIGltcGVyc29uYXRlZEJ5OiBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24uaW1wZXJzb25hdGVkQnlcbiAgICAgICAgICAgIH0gOiB7fVxuICAgICAgICAgIH0pLnNldFByb3RlY3RlZEhlYWRlcih7XG4gICAgICAgICAgICBhbGc6IG9wdGlvbnM/Lmp3a3M/LmtleVBhaXJDb25maWc/LmFsZyA/PyBcIkVkRFNBXCIsXG4gICAgICAgICAgICBraWQ6IGtleS5pZFxuICAgICAgICAgIH0pLnNldElzc3VlZEF0KCkuc2V0SXNzdWVyKG9wdGlvbnM/Lmp3dD8uaXNzdWVyID8/IGN0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTCkuc2V0QXVkaWVuY2Uob3B0aW9ucz8uand0Py5hdWRpZW5jZSA/PyBjdHguY29udGV4dC5vcHRpb25zLmJhc2VVUkwpLnNldEV4cGlyYXRpb25UaW1lKG9wdGlvbnM/Lmp3dD8uZXhwaXJhdGlvblRpbWUgPz8gXCIxNW1cIikuc2V0U3ViamVjdChjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWQpLnNpZ24ocHJpdmF0ZUtleSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHRva2VuOiBqd3QyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIHNjaGVtYTogbWVyZ2VTY2hlbWEoc2NoZW1hLCBvcHRpb25zPy5zY2hlbWEpXG4gIH07XG59O1xuXG5leHBvcnQgeyBqd3QgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   oneTap: () => (/* binding */ oneTap)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwks/remote.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n\n\n\n\n\n// src/utils/boolean.ts\nfunction toBoolean(value) {\n  return value === \"true\" || value === true;\n}\n\n// src/plugins/one-tap/index.ts\nvar oneTap = (options) => ({\n  id: \"one-tap\",\n  endpoints: {\n    oneTapCallback: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n      \"/one-tap/callback\",\n      {\n        method: \"POST\",\n        body: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n          idToken: zod__WEBPACK_IMPORTED_MODULE_2__.z.string({\n            description: \"Google ID token, which the client obtains from the One Tap API\"\n          })\n        }),\n        metadata: {\n          openapi: {\n            summary: \"One tap callback\",\n            description: \"Use this endpoint to authenticate with Google One Tap\",\n            responses: {\n              200: {\n                description: \"Successful response\",\n                content: {\n                  \"application/json\": {\n                    schema: {\n                      type: \"object\",\n                      properties: {\n                        session: {\n                          $ref: \"#/components/schemas/Session\"\n                        },\n                        user: {\n                          $ref: \"#/components/schemas/User\"\n                        }\n                      }\n                    }\n                  }\n                }\n              },\n              400: {\n                description: \"Invalid token\"\n              }\n            }\n          }\n        }\n      },\n      async (ctx) => {\n        const { idToken } = ctx.body;\n        let payload;\n        try {\n          const JWKS = (0,jose__WEBPACK_IMPORTED_MODULE_3__.createRemoteJWKSet)(\n            new URL(\"https://www.googleapis.com/oauth2/v3/certs\")\n          );\n          const { payload: verifiedPayload } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.jwtVerify)(\n            idToken,\n            JWKS,\n            {\n              issuer: [\"https://accounts.google.com\", \"accounts.google.com\"],\n              audience: options?.clientId || ctx.context.options.socialProviders?.google?.clientId\n            }\n          );\n          payload = verifiedPayload;\n        } catch (error) {\n          throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n            message: \"invalid id token\"\n          });\n        }\n        const { email, email_verified, name, picture, sub } = payload;\n        if (!email) {\n          return ctx.json({ error: \"Email not available in token\" });\n        }\n        const user = await ctx.context.internalAdapter.findUserByEmail(email);\n        if (!user) {\n          if (options?.disableSignup) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_GATEWAY\", {\n              message: \"User not found\"\n            });\n          }\n          const newUser = await ctx.context.internalAdapter.createOAuthUser(\n            {\n              email,\n              emailVerified: typeof email_verified === \"boolean\" ? email_verified : toBoolean(email_verified),\n              name,\n              image: picture\n            },\n            {\n              providerId: \"google\",\n              accountId: sub\n            }\n          );\n          if (!newUser) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Could not create user\"\n            });\n          }\n          const session2 = await ctx.context.internalAdapter.createSession(\n            newUser.user.id,\n            ctx.request\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n            user: newUser.user,\n            session: session2\n          });\n          return ctx.json({\n            token: session2.token,\n            user: {\n              id: newUser.user.id,\n              email: newUser.user.email,\n              emailVerified: newUser.user.emailVerified,\n              name: newUser.user.name,\n              image: newUser.user.image,\n              createdAt: newUser.user.createdAt,\n              updatedAt: newUser.user.updatedAt\n            }\n          });\n        }\n        const account = await ctx.context.internalAdapter.findAccount(sub);\n        if (!account) {\n          throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n            message: \"Google sub doesn't match\"\n          });\n        }\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx.request\n        );\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n          user: user.user,\n          session\n        });\n        return ctx.json({\n          token: session.token,\n          user: {\n            id: user.user.id,\n            email: user.user.email,\n            emailVerified: user.user.emailVerified,\n            name: user.user.name,\n            image: user.user.image,\n            createdAt: user.user.createdAt,\n            updatedAt: user.user.updatedAt\n          }\n        });\n      }\n    )\n  }\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUFWQUFEUEdCLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFtRTtBQUNaO0FBQy9CO0FBQzZCOztBQUVyRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzRUFBa0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5Q0FBUTtBQUN0QixtQkFBbUIseUNBQVE7QUFDM0I7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUI7QUFDQTtBQUNBLHVCQUF1Qix3REFBa0I7QUFDekM7QUFDQTtBQUNBLGtCQUFrQiwyQkFBMkIsUUFBUSwrQ0FBUztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLG9CQUFvQix3REFBUTtBQUM1QjtBQUNBLFdBQVc7QUFDWDtBQUNBLGdCQUFnQiw0Q0FBNEM7QUFDNUQ7QUFDQSw0QkFBNEIsdUNBQXVDO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHdEQUFRO0FBQzVCO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9FQUFnQjtBQUM5QjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFaUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1BVkFBRFBHQi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIEFQSUVycm9yIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IGNyZWF0ZVJlbW90ZUpXS1NldCwgand0VmVyaWZ5IH0gZnJvbSAnam9zZSc7XG5cbi8vIHNyYy91dGlscy9ib29sZWFuLnRzXG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlID09PSBcInRydWVcIiB8fCB2YWx1ZSA9PT0gdHJ1ZTtcbn1cblxuLy8gc3JjL3BsdWdpbnMvb25lLXRhcC9pbmRleC50c1xudmFyIG9uZVRhcCA9IChvcHRpb25zKSA9PiAoe1xuICBpZDogXCJvbmUtdGFwXCIsXG4gIGVuZHBvaW50czoge1xuICAgIG9uZVRhcENhbGxiYWNrOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICBcIi9vbmUtdGFwL2NhbGxiYWNrXCIsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICBpZFRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJHb29nbGUgSUQgdG9rZW4sIHdoaWNoIHRoZSBjbGllbnQgb2J0YWlucyBmcm9tIHRoZSBPbmUgVGFwIEFQSVwiXG4gICAgICAgICAgfSlcbiAgICAgICAgfSksXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgc3VtbWFyeTogXCJPbmUgdGFwIGNhbGxiYWNrXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2UgdGhpcyBlbmRwb2ludCB0byBhdXRoZW50aWNhdGUgd2l0aCBHb29nbGUgT25lIFRhcFwiLFxuICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NmdWwgcmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICA0MDA6IHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbnZhbGlkIHRva2VuXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgY29uc3QgeyBpZFRva2VuIH0gPSBjdHguYm9keTtcbiAgICAgICAgbGV0IHBheWxvYWQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgSldLUyA9IGNyZWF0ZVJlbW90ZUpXS1NldChcbiAgICAgICAgICAgIG5ldyBVUkwoXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjMvY2VydHNcIilcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHsgcGF5bG9hZDogdmVyaWZpZWRQYXlsb2FkIH0gPSBhd2FpdCBqd3RWZXJpZnkoXG4gICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgSldLUyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaXNzdWVyOiBbXCJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb21cIiwgXCJhY2NvdW50cy5nb29nbGUuY29tXCJdLFxuICAgICAgICAgICAgICBhdWRpZW5jZTogb3B0aW9ucz8uY2xpZW50SWQgfHwgY3R4LmNvbnRleHQub3B0aW9ucy5zb2NpYWxQcm92aWRlcnM/Lmdvb2dsZT8uY2xpZW50SWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIHBheWxvYWQgPSB2ZXJpZmllZFBheWxvYWQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgbWVzc2FnZTogXCJpbnZhbGlkIGlkIHRva2VuXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGVtYWlsLCBlbWFpbF92ZXJpZmllZCwgbmFtZSwgcGljdHVyZSwgc3ViIH0gPSBwYXlsb2FkO1xuICAgICAgICBpZiAoIWVtYWlsKSB7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHsgZXJyb3I6IFwiRW1haWwgbm90IGF2YWlsYWJsZSBpbiB0b2tlblwiIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgaWYgKG9wdGlvbnM/LmRpc2FibGVTaWdudXApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9HQVRFV0FZXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIG5vdCBmb3VuZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbmV3VXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVPQXV0aFVzZXIoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0eXBlb2YgZW1haWxfdmVyaWZpZWQgPT09IFwiYm9vbGVhblwiID8gZW1haWxfdmVyaWZpZWQgOiB0b0Jvb2xlYW4oZW1haWxfdmVyaWZpZWQpLFxuICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogcGljdHVyZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcHJvdmlkZXJJZDogXCJnb29nbGVcIixcbiAgICAgICAgICAgICAgYWNjb3VudElkOiBzdWJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghbmV3VXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJDb3VsZCBub3QgY3JlYXRlIHVzZXJcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHNlc3Npb24yID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICBuZXdVc2VyLnVzZXIuaWQsXG4gICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgIHVzZXI6IG5ld1VzZXIudXNlcixcbiAgICAgICAgICAgIHNlc3Npb246IHNlc3Npb24yXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uMi50b2tlbixcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IG5ld1VzZXIudXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IG5ld1VzZXIudXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogbmV3VXNlci51c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgIG5hbWU6IG5ld1VzZXIudXNlci5uYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogbmV3VXNlci51c2VyLmltYWdlLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IG5ld1VzZXIudXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3VXNlci51c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnQoc3ViKTtcbiAgICAgICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiR29vZ2xlIHN1YiBkb2Vzbid0IG1hdGNoXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgdXNlci51c2VyLmlkLFxuICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgdXNlcjogdXNlci51c2VyLFxuICAgICAgICAgIHNlc3Npb25cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHVzZXIudXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLnVzZXIuZW1haWwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgIG5hbWU6IHVzZXIudXNlci5uYW1lLFxuICAgICAgICAgICAgaW1hZ2U6IHVzZXIudXNlci5pbWFnZSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogdXNlci51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogdXNlci51c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgKVxuICB9XG59KTtcblxuZXhwb3J0IHsgb25lVGFwIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compareHash: () => (/* binding */ compareHash),\n/* harmony export */   constantTimeEqual: () => (/* binding */ constantTimeEqual),\n/* harmony export */   generateRandomString: () => (/* binding */ generateRandomString),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   hashToBase64: () => (/* binding */ hashToBase64),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   symmetricDecrypt: () => (/* binding */ symmetricDecrypt),\n/* harmony export */   symmetricEncrypt: () => (/* binding */ symmetricEncrypt),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/ciphers/chacha */ \"(rsc)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @noble/ciphers/utils */ \"(rsc)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/utils.js\");\n/* harmony import */ var _noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @noble/ciphers/webcrypto */ \"(rsc)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/webcrypto.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var _noble_hashes_scrypt__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @noble/hashes/scrypt */ \"(rsc)/./node_modules/.pnpm/@noble+hashes@1.7.1/node_modules/@noble/hashes/esm/scrypt.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n\n\n\n\n\n\n\n\n// src/crypto/index.ts\n\n// src/crypto/buffer.ts\nfunction constantTimeEqual(a, b) {\n  const aBuffer = new Uint8Array(a);\n  const bBuffer = new Uint8Array(b);\n  if (aBuffer.length !== bBuffer.length) {\n    return false;\n  }\n  let c = 0;\n  for (let i = 0; i < aBuffer.length; i++) {\n    c |= aBuffer[i] ^ bBuffer[i];\n  }\n  return c === 0;\n}\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(data);\n  return Buffer.from(buffer).toString(\"base64\");\n}\nasync function compareHash(data, hash) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(\n    typeof data === \"string\" ? new TextEncoder().encode(data) : data\n  );\n  const hashBuffer = Buffer.from(hash, \"base64\");\n  return constantTimeEqual(buffer, hashBuffer);\n}\nasync function signJWT(payload, secret, expiresIn = 3600) {\n  const jwt = await new jose__WEBPACK_IMPORTED_MODULE_4__.SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n  return jwt;\n}\nvar config = {\n  N: 16384,\n  r: 16,\n  p: 1,\n  dkLen: 64\n};\nasync function generateKey(password, salt) {\n  return await (0,_noble_hashes_scrypt__WEBPACK_IMPORTED_MODULE_5__.scryptAsync)(password.normalize(\"NFKC\"), salt, {\n    N: config.N,\n    p: config.p,\n    r: config.r,\n    dkLen: config.dkLen,\n    maxmem: 128 * config.N * config.r * 2\n  });\n}\nvar hashPassword = async (password) => {\n  const salt = _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode((0,_better_auth_utils__WEBPACK_IMPORTED_MODULE_1__.getRandomValues)(new Uint8Array(16)));\n  const key = await generateKey(password, salt);\n  return `${salt}:${_better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(key)}`;\n};\nvar verifyPassword = async ({\n  hash,\n  password\n}) => {\n  const [salt, key] = hash.split(\":\");\n  const targetKey = await generateKey(password, salt);\n  return constantTimeEqual(targetKey, new Uint8Array(Buffer.from(key, \"hex\")));\n};\nvar generateRandomString = (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__.createRandomStringGenerator)(\n  \"a-z\",\n  \"0-9\",\n  \"A-Z\",\n  \"-_\"\n);\n\n// src/crypto/index.ts\nvar symmetricEncrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.utf8ToBytes)(data);\n  const chacha = (0,_noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__.managedNonce)(_noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.bytesToHex)(chacha.encrypt(dataAsBytes));\n};\nvar symmetricDecrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.hexToBytes)(data);\n  const chacha = (0,_noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__.managedNonce)(_noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLURCUE9aUk1TLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRDtBQUNLO0FBQ2lCO0FBQ25CO0FBQ3pCO0FBQ29CO0FBQ0U7QUFDUjtBQUMyQjs7QUFFeEU7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixvQkFBb0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixtRUFBVTtBQUNqQztBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQVU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlDQUFPLCtCQUErQixjQUFjO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUVBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsZUFBZSx1REFBRyxRQUFRLG1FQUFlO0FBQ3pDO0FBQ0EsWUFBWSxLQUFLLEdBQUcsdURBQUcsYUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzRkFBMkI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwyQkFBMkIsbUVBQVU7QUFDckMsc0JBQXNCLGlFQUFXO0FBQ2pDLGlCQUFpQixzRUFBWSxDQUFDLG9FQUFpQjtBQUMvQyxTQUFTLGdFQUFVO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDJCQUEyQixtRUFBVTtBQUNyQyxzQkFBc0IsZ0VBQVU7QUFDaEMsaUJBQWlCLHNFQUFZLENBQUMsb0VBQWlCO0FBQy9DO0FBQ0E7O0FBRXlKIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstREJQT1pSTVMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCB7IHhjaGFjaGEyMHBvbHkxMzA1IH0gZnJvbSAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhJztcbmltcG9ydCB7IHV0ZjhUb0J5dGVzLCBieXRlc1RvSGV4LCBoZXhUb0J5dGVzIH0gZnJvbSAnQG5vYmxlL2NpcGhlcnMvdXRpbHMnO1xuaW1wb3J0IHsgbWFuYWdlZE5vbmNlIH0gZnJvbSAnQG5vYmxlL2NpcGhlcnMvd2ViY3J5cHRvJztcbmltcG9ydCB7IFNpZ25KV1QgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHNjcnlwdEFzeW5jIH0gZnJvbSAnQG5vYmxlL2hhc2hlcy9zY3J5cHQnO1xuaW1wb3J0IHsgZ2V0UmFuZG9tVmFsdWVzIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzJztcbmltcG9ydCB7IGhleCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0IHsgY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbi8vIHNyYy9jcnlwdG8vaW5kZXgudHNcblxuLy8gc3JjL2NyeXB0by9idWZmZXIudHNcbmZ1bmN0aW9uIGNvbnN0YW50VGltZUVxdWFsKGEsIGIpIHtcbiAgY29uc3QgYUJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGEpO1xuICBjb25zdCBiQnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYik7XG4gIGlmIChhQnVmZmVyLmxlbmd0aCAhPT0gYkJ1ZmZlci5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgbGV0IGMgPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFCdWZmZXIubGVuZ3RoOyBpKyspIHtcbiAgICBjIHw9IGFCdWZmZXJbaV0gXiBiQnVmZmVyW2ldO1xuICB9XG4gIHJldHVybiBjID09PSAwO1xufVxuYXN5bmMgZnVuY3Rpb24gaGFzaFRvQmFzZTY0KGRhdGEpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGRhdGEpO1xuICByZXR1cm4gQnVmZmVyLmZyb20oYnVmZmVyKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbXBhcmVIYXNoKGRhdGEsIGhhc2gpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KFxuICAgIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpIDogZGF0YVxuICApO1xuICBjb25zdCBoYXNoQnVmZmVyID0gQnVmZmVyLmZyb20oaGFzaCwgXCJiYXNlNjRcIik7XG4gIHJldHVybiBjb25zdGFudFRpbWVFcXVhbChidWZmZXIsIGhhc2hCdWZmZXIpO1xufVxuYXN5bmMgZnVuY3Rpb24gc2lnbkpXVChwYXlsb2FkLCBzZWNyZXQsIGV4cGlyZXNJbiA9IDM2MDApIHtcbiAgY29uc3Qgand0ID0gYXdhaXQgbmV3IFNpZ25KV1QocGF5bG9hZCkuc2V0UHJvdGVjdGVkSGVhZGVyKHsgYWxnOiBcIkhTMjU2XCIgfSkuc2V0SXNzdWVkQXQoKS5zZXRFeHBpcmF0aW9uVGltZShNYXRoLmZsb29yKERhdGUubm93KCkgLyAxZTMpICsgZXhwaXJlc0luKS5zaWduKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzZWNyZXQpKTtcbiAgcmV0dXJuIGp3dDtcbn1cbnZhciBjb25maWcgPSB7XG4gIE46IDE2Mzg0LFxuICByOiAxNixcbiAgcDogMSxcbiAgZGtMZW46IDY0XG59O1xuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpIHtcbiAgcmV0dXJuIGF3YWl0IHNjcnlwdEFzeW5jKHBhc3N3b3JkLm5vcm1hbGl6ZShcIk5GS0NcIiksIHNhbHQsIHtcbiAgICBOOiBjb25maWcuTixcbiAgICBwOiBjb25maWcucCxcbiAgICByOiBjb25maWcucixcbiAgICBka0xlbjogY29uZmlnLmRrTGVuLFxuICAgIG1heG1lbTogMTI4ICogY29uZmlnLk4gKiBjb25maWcuciAqIDJcbiAgfSk7XG59XG52YXIgaGFzaFBhc3N3b3JkID0gYXN5bmMgKHBhc3N3b3JkKSA9PiB7XG4gIGNvbnN0IHNhbHQgPSBoZXguZW5jb2RlKGdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxNikpKTtcbiAgY29uc3Qga2V5ID0gYXdhaXQgZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpO1xuICByZXR1cm4gYCR7c2FsdH06JHtoZXguZW5jb2RlKGtleSl9YDtcbn07XG52YXIgdmVyaWZ5UGFzc3dvcmQgPSBhc3luYyAoe1xuICBoYXNoLFxuICBwYXNzd29yZFxufSkgPT4ge1xuICBjb25zdCBbc2FsdCwga2V5XSA9IGhhc2guc3BsaXQoXCI6XCIpO1xuICBjb25zdCB0YXJnZXRLZXkgPSBhd2FpdCBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCk7XG4gIHJldHVybiBjb25zdGFudFRpbWVFcXVhbCh0YXJnZXRLZXksIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKGtleSwgXCJoZXhcIikpKTtcbn07XG52YXIgZ2VuZXJhdGVSYW5kb21TdHJpbmcgPSBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IoXG4gIFwiYS16XCIsXG4gIFwiMC05XCIsXG4gIFwiQS1aXCIsXG4gIFwiLV9cIlxuKTtcblxuLy8gc3JjL2NyeXB0by9pbmRleC50c1xudmFyIHN5bW1ldHJpY0VuY3J5cHQgPSBhc3luYyAoe1xuICBrZXksXG4gIGRhdGFcbn0pID0+IHtcbiAgY29uc3Qga2V5QXNCeXRlcyA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChrZXkpO1xuICBjb25zdCBkYXRhQXNCeXRlcyA9IHV0ZjhUb0J5dGVzKGRhdGEpO1xuICBjb25zdCBjaGFjaGEgPSBtYW5hZ2VkTm9uY2UoeGNoYWNoYTIwcG9seTEzMDUpKG5ldyBVaW50OEFycmF5KGtleUFzQnl0ZXMpKTtcbiAgcmV0dXJuIGJ5dGVzVG9IZXgoY2hhY2hhLmVuY3J5cHQoZGF0YUFzQnl0ZXMpKTtcbn07XG52YXIgc3ltbWV0cmljRGVjcnlwdCA9IGFzeW5jICh7XG4gIGtleSxcbiAgZGF0YVxufSkgPT4ge1xuICBjb25zdCBrZXlBc0J5dGVzID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGtleSk7XG4gIGNvbnN0IGRhdGFBc0J5dGVzID0gaGV4VG9CeXRlcyhkYXRhKTtcbiAgY29uc3QgY2hhY2hhID0gbWFuYWdlZE5vbmNlKHhjaGFjaGEyMHBvbHkxMzA1KShuZXcgVWludDhBcnJheShrZXlBc0J5dGVzKSk7XG4gIHJldHVybiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoY2hhY2hhLmRlY3J5cHQoZGF0YUFzQnl0ZXMpKTtcbn07XG5cbmV4cG9ydCB7IGNvbXBhcmVIYXNoLCBjb25zdGFudFRpbWVFcXVhbCwgZ2VuZXJhdGVSYW5kb21TdHJpbmcsIGhhc2hQYXNzd29yZCwgaGFzaFRvQmFzZTY0LCBzaWduSldULCBzeW1tZXRyaWNEZWNyeXB0LCBzeW1tZXRyaWNFbmNyeXB0LCB2ZXJpZnlQYXNzd29yZCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   customSession: () => (/* binding */ customSession)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\nvar customSession = (fn, options) => {\n  return {\n    id: \"custom-session\",\n    endpoints: {\n      getSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/get-session\",\n        {\n          method: \"GET\",\n          metadata: {\n            CUSTOM_SESSION: true\n          },\n          query: zod__WEBPACK_IMPORTED_MODULE_1__.z.optional(\n            zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n              /**\n               * If cookie cache is enabled, it will disable the cache\n               * and fetch the session from the database\n               */\n              disableCookieCache: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean({\n                description: \"Disable cookie cache and fetch session from database\"\n              }).or(zod__WEBPACK_IMPORTED_MODULE_1__.z.string().transform((v) => v === \"true\")).optional(),\n              disableRefresh: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean({\n                description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n              }).optional()\n            })\n          )\n        },\n        async (ctx) => {\n          const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n          if (!session) {\n            return ctx.json(null);\n          }\n          const fnResult = await fn(session);\n          return ctx.json(fnResult);\n        }\n      )\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUZSM0JZQTQ3LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE0RTtBQUNwRDs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isc0VBQWtCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsaUJBQWlCLDJDQUFVO0FBQzNCLFlBQVkseUNBQVE7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsMENBQVM7QUFDM0M7QUFDQSxlQUFlLEtBQUsseUNBQVE7QUFDNUIsOEJBQThCLDBDQUFTO0FBQ3ZDO0FBQ0EsZUFBZTtBQUNmLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBLGdDQUFnQyxxRUFBaUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXlCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstRlIzQllBNDcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBnZXRTZXNzaW9uRnJvbUN0eCB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbnZhciBjdXN0b21TZXNzaW9uID0gKGZuLCBvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiY3VzdG9tLXNlc3Npb25cIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIGdldFNlc3Npb246IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvZ2V0LXNlc3Npb25cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgQ1VTVE9NX1NFU1NJT046IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHF1ZXJ5OiB6Lm9wdGlvbmFsKFxuICAgICAgICAgICAgei5vYmplY3Qoe1xuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogSWYgY29va2llIGNhY2hlIGlzIGVuYWJsZWQsIGl0IHdpbGwgZGlzYWJsZSB0aGUgY2FjaGVcbiAgICAgICAgICAgICAgICogYW5kIGZldGNoIHRoZSBzZXNzaW9uIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICBkaXNhYmxlQ29va2llQ2FjaGU6IHouYm9vbGVhbih7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBjb29raWUgY2FjaGUgYW5kIGZldGNoIHNlc3Npb24gZnJvbSBkYXRhYmFzZVwiXG4gICAgICAgICAgICAgIH0pLm9yKHouc3RyaW5nKCkudHJhbnNmb3JtKCh2KSA9PiB2ID09PSBcInRydWVcIikpLm9wdGlvbmFsKCksXG4gICAgICAgICAgICAgIGRpc2FibGVSZWZyZXNoOiB6LmJvb2xlYW4oe1xuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2FibGUgc2Vzc2lvbiByZWZyZXNoLiBVc2VmdWwgZm9yIGNoZWNraW5nIHNlc3Npb24gc3RhdHVzLCB3aXRob3V0IHVwZGF0aW5nIHRoZSBzZXNzaW9uXCJcbiAgICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICApXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZm5SZXN1bHQgPSBhd2FpdCBmbihzZXNzaW9uKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oZm5SZXN1bHQpO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfVxuICB9O1xufTtcblxuZXhwb3J0IHsgY3VzdG9tU2Vzc2lvbiB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDate: () => (/* binding */ getDate)\n/* harmony export */ });\n// src/utils/date.ts\nvar getDate = (span, unit = \"ms\") => {\n  return new Date(Date.now() + (unit === \"sec\" ? span * 1e3 : span));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUZVUk5BNkhZLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFbUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1GVVJOQTZIWS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvZGF0ZS50c1xudmFyIGdldERhdGUgPSAoc3BhbiwgdW5pdCA9IFwibXNcIikgPT4ge1xuICByZXR1cm4gbmV3IERhdGUoRGF0ZS5ub3coKSArICh1bml0ID09PSBcInNlY1wiID8gc3BhbiAqIDFlMyA6IHNwYW4pKTtcbn07XG5cbmV4cG9ydCB7IGdldERhdGUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminAc: () => (/* binding */ adminAc),\n/* harmony export */   createAccessControl: () => (/* binding */ createAccessControl),\n/* harmony export */   defaultAc: () => (/* binding */ defaultAc),\n/* harmony export */   defaultRoles: () => (/* binding */ defaultRoles),\n/* harmony export */   defaultStatements: () => (/* binding */ defaultStatements),\n/* harmony export */   memberAc: () => (/* binding */ memberAc),\n/* harmony export */   ownerAc: () => (/* binding */ ownerAc),\n/* harmony export */   role: () => (/* binding */ role)\n/* harmony export */ });\n// src/plugins/organization/access/access.ts\nfunction createAccessControl(s) {\n  return {\n    newRole(statements2) {\n      return role(statements2);\n    }\n  };\n}\nfunction role(statements) {\n  return {\n    statements,\n    authorize(request, connector) {\n      for (const [requestedResource, requestedActions] of Object.entries(\n        request\n      )) {\n        const allowedActions = statements[requestedResource];\n        if (!allowedActions) {\n          return {\n            success: false,\n            error: `You are not allowed to access resource: ${requestedResource}`\n          };\n        }\n        const success = connector === \"OR\" ? requestedActions.some(\n          (requestedAction) => allowedActions.includes(requestedAction)\n        ) : requestedActions.every(\n          (requestedAction) => allowedActions.includes(requestedAction)\n        );\n        if (success) {\n          return { success: true };\n        }\n        return {\n          success: false,\n          error: `Unauthorized to access resource \"${requestedResource}\"`\n        };\n      }\n      return {\n        success: false,\n        error: \"Not authorized\"\n      };\n    }\n  };\n}\n\n// src/plugins/organization/access/statement.ts\nvar defaultStatements = {\n  organization: [\"update\", \"delete\"],\n  member: [\"create\", \"update\", \"delete\"],\n  invitation: [\"create\", \"cancel\"]\n};\nvar defaultAc = createAccessControl();\nvar adminAc = defaultAc.newRole({\n  organization: [\"update\"],\n  invitation: [\"create\", \"cancel\"],\n  member: [\"create\", \"update\", \"delete\"]\n});\nvar ownerAc = defaultAc.newRole({\n  organization: [\"update\", \"delete\"],\n  member: [\"create\", \"update\", \"delete\"],\n  invitation: [\"create\", \"cancel\"]\n});\nvar memberAc = defaultAc.newRole({\n  organization: [],\n  member: [],\n  invitation: []\n});\nvar defaultRoles = {\n  admin: adminAc,\n  owner: ownerAc,\n  member: memberAc\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdCTEVHSFpXLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQsa0JBQWtCO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EscURBQXFELGtCQUFrQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2RyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdCTEVHSFpXLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9hY2Nlc3MvYWNjZXNzLnRzXG5mdW5jdGlvbiBjcmVhdGVBY2Nlc3NDb250cm9sKHMpIHtcbiAgcmV0dXJuIHtcbiAgICBuZXdSb2xlKHN0YXRlbWVudHMyKSB7XG4gICAgICByZXR1cm4gcm9sZShzdGF0ZW1lbnRzMik7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gcm9sZShzdGF0ZW1lbnRzKSB7XG4gIHJldHVybiB7XG4gICAgc3RhdGVtZW50cyxcbiAgICBhdXRob3JpemUocmVxdWVzdCwgY29ubmVjdG9yKSB7XG4gICAgICBmb3IgKGNvbnN0IFtyZXF1ZXN0ZWRSZXNvdXJjZSwgcmVxdWVzdGVkQWN0aW9uc10gb2YgT2JqZWN0LmVudHJpZXMoXG4gICAgICAgIHJlcXVlc3RcbiAgICAgICkpIHtcbiAgICAgICAgY29uc3QgYWxsb3dlZEFjdGlvbnMgPSBzdGF0ZW1lbnRzW3JlcXVlc3RlZFJlc291cmNlXTtcbiAgICAgICAgaWYgKCFhbGxvd2VkQWN0aW9ucykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBgWW91IGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MgcmVzb3VyY2U6ICR7cmVxdWVzdGVkUmVzb3VyY2V9YFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGNvbm5lY3RvciA9PT0gXCJPUlwiID8gcmVxdWVzdGVkQWN0aW9ucy5zb21lKFxuICAgICAgICAgIChyZXF1ZXN0ZWRBY3Rpb24pID0+IGFsbG93ZWRBY3Rpb25zLmluY2x1ZGVzKHJlcXVlc3RlZEFjdGlvbilcbiAgICAgICAgKSA6IHJlcXVlc3RlZEFjdGlvbnMuZXZlcnkoXG4gICAgICAgICAgKHJlcXVlc3RlZEFjdGlvbikgPT4gYWxsb3dlZEFjdGlvbnMuaW5jbHVkZXMocmVxdWVzdGVkQWN0aW9uKVxuICAgICAgICApO1xuICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBgVW5hdXRob3JpemVkIHRvIGFjY2VzcyByZXNvdXJjZSBcIiR7cmVxdWVzdGVkUmVzb3VyY2V9XCJgXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IFwiTm90IGF1dGhvcml6ZWRcIlxuICAgICAgfTtcbiAgICB9XG4gIH07XG59XG5cbi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9hY2Nlc3Mvc3RhdGVtZW50LnRzXG52YXIgZGVmYXVsdFN0YXRlbWVudHMgPSB7XG4gIG9yZ2FuaXphdGlvbjogW1widXBkYXRlXCIsIFwiZGVsZXRlXCJdLFxuICBtZW1iZXI6IFtcImNyZWF0ZVwiLCBcInVwZGF0ZVwiLCBcImRlbGV0ZVwiXSxcbiAgaW52aXRhdGlvbjogW1wiY3JlYXRlXCIsIFwiY2FuY2VsXCJdXG59O1xudmFyIGRlZmF1bHRBYyA9IGNyZWF0ZUFjY2Vzc0NvbnRyb2woKTtcbnZhciBhZG1pbkFjID0gZGVmYXVsdEFjLm5ld1JvbGUoe1xuICBvcmdhbml6YXRpb246IFtcInVwZGF0ZVwiXSxcbiAgaW52aXRhdGlvbjogW1wiY3JlYXRlXCIsIFwiY2FuY2VsXCJdLFxuICBtZW1iZXI6IFtcImNyZWF0ZVwiLCBcInVwZGF0ZVwiLCBcImRlbGV0ZVwiXVxufSk7XG52YXIgb3duZXJBYyA9IGRlZmF1bHRBYy5uZXdSb2xlKHtcbiAgb3JnYW5pemF0aW9uOiBbXCJ1cGRhdGVcIiwgXCJkZWxldGVcIl0sXG4gIG1lbWJlcjogW1wiY3JlYXRlXCIsIFwidXBkYXRlXCIsIFwiZGVsZXRlXCJdLFxuICBpbnZpdGF0aW9uOiBbXCJjcmVhdGVcIiwgXCJjYW5jZWxcIl1cbn0pO1xudmFyIG1lbWJlckFjID0gZGVmYXVsdEFjLm5ld1JvbGUoe1xuICBvcmdhbml6YXRpb246IFtdLFxuICBtZW1iZXI6IFtdLFxuICBpbnZpdGF0aW9uOiBbXVxufSk7XG52YXIgZGVmYXVsdFJvbGVzID0ge1xuICBhZG1pbjogYWRtaW5BYyxcbiAgb3duZXI6IG93bmVyQWMsXG4gIG1lbWJlcjogbWVtYmVyQWNcbn07XG5cbmV4cG9ydCB7IGFkbWluQWMsIGNyZWF0ZUFjY2Vzc0NvbnRyb2wsIGRlZmF1bHRBYywgZGVmYXVsdFJvbGVzLCBkZWZhdWx0U3RhdGVtZW50cywgbWVtYmVyQWMsIG93bmVyQWMsIHJvbGUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuthorizationURL: () => (/* binding */ createAuthorizationURL),\n/* harmony export */   generateCodeChallenge: () => (/* binding */ generateCodeChallenge),\n/* harmony export */   getOAuth2Tokens: () => (/* binding */ getOAuth2Tokens),\n/* harmony export */   validateAuthorizationCode: () => (/* binding */ validateAuthorizationCode),\n/* harmony export */   validateToken: () => (/* binding */ validateToken)\n/* harmony export */ });\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n\n\n\n\n\n\nasync function generateCodeChallenge(codeVerifier) {\n  const codeChallengeBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_1__.createHash)(\"SHA-256\").digest(codeVerifier);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_2__.base64Url.encode(new Uint8Array(codeChallengeBytes), {\n    padding: false\n  });\n}\nfunction getOAuth2Tokens(data) {\n  return {\n    tokenType: data.token_type,\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    accessTokenExpiresAt: data.expires_in ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_0__.getDate)(data.expires_in, \"sec\") : void 0,\n    scopes: data?.scope ? typeof data.scope === \"string\" ? data.scope.split(\" \") : data.scope : [],\n    idToken: data.id_token\n  };\n}\n\n// src/oauth2/create-authorization-url.ts\nasync function createAuthorizationURL({\n  id,\n  options,\n  authorizationEndpoint,\n  state,\n  codeVerifier,\n  scopes,\n  claims,\n  redirectURI,\n  duration,\n  prompt\n}) {\n  const url = new URL(authorizationEndpoint);\n  url.searchParams.set(\"response_type\", \"code\");\n  url.searchParams.set(\"client_id\", options.clientId);\n  url.searchParams.set(\"state\", state);\n  url.searchParams.set(\"scope\", scopes.join(\" \"));\n  url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (codeVerifier) {\n    const codeChallenge = await generateCodeChallenge(codeVerifier);\n    url.searchParams.set(\"code_challenge_method\", \"S256\");\n    url.searchParams.set(\"code_challenge\", codeChallenge);\n  }\n  if (claims) {\n    const claimsObj = claims.reduce(\n      (acc, claim) => {\n        acc[claim] = null;\n        return acc;\n      },\n      {}\n    );\n    url.searchParams.set(\n      \"claims\",\n      JSON.stringify({\n        id_token: { email: null, email_verified: null, ...claimsObj }\n      })\n    );\n  }\n  if (duration) {\n    url.searchParams.set(\"duration\", duration);\n  }\n  if (prompt) {\n    url.searchParams.set(\"prompt\", \"select_account\");\n  }\n  return url;\n}\nasync function validateAuthorizationCode({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  tokenEndpoint,\n  authentication\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\",\n    \"user-agent\": \"better-auth\"\n  };\n  body.set(\"grant_type\", \"authorization_code\");\n  body.set(\"code\", code);\n  codeVerifier && body.set(\"code_verifier\", codeVerifier);\n  body.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (authentication === \"basic\") {\n    const encodedCredentials = btoa(\n      `${options.clientId}:${options.clientSecret}`\n    );\n    headers[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    body.set(\"client_id\", options.clientId);\n    body.set(\"client_secret\", options.clientSecret);\n  }\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = getOAuth2Tokens(data);\n  return tokens;\n}\nasync function validateToken(token, jwksEndpoint) {\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(jwksEndpoint, {\n    method: \"GET\",\n    headers: {\n      accept: \"application/json\",\n      \"user-agent\": \"better-auth\"\n    }\n  });\n  if (error) {\n    throw error;\n  }\n  const keys = data[\"keys\"];\n  const header = JSON.parse(atob(token.split(\".\")[0]));\n  const key = keys.find((key2) => key2.kid === header.kid);\n  if (!key) {\n    throw new Error(\"Key not found\");\n  }\n  const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.jwtVerify)(token, key);\n  return verified;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdUUU03SlU3LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBOEM7QUFDTztBQUNDO0FBQ0o7QUFDakI7O0FBRWpDO0FBQ0EsbUNBQW1DLG1FQUFVO0FBQzdDLFNBQVMsZ0VBQVM7QUFDbEI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLDJEQUFPO0FBQ25EO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsaUJBQWlCLEdBQUcscUJBQXFCO0FBQ2xEO0FBQ0Esd0NBQXdDLG1CQUFtQjtBQUMzRCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsVUFBVSxjQUFjLFFBQVEsZ0VBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxjQUFjLFFBQVEsZ0VBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsK0NBQVM7QUFDbEM7QUFDQTs7QUFFb0giLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1HVFFNN0pVNy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXREYXRlIH0gZnJvbSAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0IHsgYmFzZTY0VXJsIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgeyBiZXR0ZXJGZXRjaCB9IGZyb20gJ0BiZXR0ZXItZmV0Y2gvZmV0Y2gnO1xuaW1wb3J0IHsgand0VmVyaWZ5IH0gZnJvbSAnam9zZSc7XG5cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQ29kZUNoYWxsZW5nZShjb2RlVmVyaWZpZXIpIHtcbiAgY29uc3QgY29kZUNoYWxsZW5nZUJ5dGVzID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGNvZGVWZXJpZmllcik7XG4gIHJldHVybiBiYXNlNjRVcmwuZW5jb2RlKG5ldyBVaW50OEFycmF5KGNvZGVDaGFsbGVuZ2VCeXRlcyksIHtcbiAgICBwYWRkaW5nOiBmYWxzZVxuICB9KTtcbn1cbmZ1bmN0aW9uIGdldE9BdXRoMlRva2VucyhkYXRhKSB7XG4gIHJldHVybiB7XG4gICAgdG9rZW5UeXBlOiBkYXRhLnRva2VuX3R5cGUsXG4gICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgIHJlZnJlc2hUb2tlbjogZGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBkYXRhLmV4cGlyZXNfaW4gPyBnZXREYXRlKGRhdGEuZXhwaXJlc19pbiwgXCJzZWNcIikgOiB2b2lkIDAsXG4gICAgc2NvcGVzOiBkYXRhPy5zY29wZSA/IHR5cGVvZiBkYXRhLnNjb3BlID09PSBcInN0cmluZ1wiID8gZGF0YS5zY29wZS5zcGxpdChcIiBcIikgOiBkYXRhLnNjb3BlIDogW10sXG4gICAgaWRUb2tlbjogZGF0YS5pZF90b2tlblxuICB9O1xufVxuXG4vLyBzcmMvb2F1dGgyL2NyZWF0ZS1hdXRob3JpemF0aW9uLXVybC50c1xuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gIGlkLFxuICBvcHRpb25zLFxuICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gIHN0YXRlLFxuICBjb2RlVmVyaWZpZXIsXG4gIHNjb3BlcyxcbiAgY2xhaW1zLFxuICByZWRpcmVjdFVSSSxcbiAgZHVyYXRpb24sXG4gIHByb21wdFxufSkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGF1dGhvcml6YXRpb25FbmRwb2ludCk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVzcG9uc2VfdHlwZVwiLCBcImNvZGVcIik7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInN0YXRlXCIsIHN0YXRlKTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJzY29wZVwiLCBzY29wZXMuam9pbihcIiBcIikpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInJlZGlyZWN0X3VyaVwiLCBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJKTtcbiAgaWYgKGNvZGVWZXJpZmllcikge1xuICAgIGNvbnN0IGNvZGVDaGFsbGVuZ2UgPSBhd2FpdCBnZW5lcmF0ZUNvZGVDaGFsbGVuZ2UoY29kZVZlcmlmaWVyKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImNvZGVfY2hhbGxlbmdlX21ldGhvZFwiLCBcIlMyNTZcIik7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJjb2RlX2NoYWxsZW5nZVwiLCBjb2RlQ2hhbGxlbmdlKTtcbiAgfVxuICBpZiAoY2xhaW1zKSB7XG4gICAgY29uc3QgY2xhaW1zT2JqID0gY2xhaW1zLnJlZHVjZShcbiAgICAgIChhY2MsIGNsYWltKSA9PiB7XG4gICAgICAgIGFjY1tjbGFpbV0gPSBudWxsO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcbiAgICAgIFwiY2xhaW1zXCIsXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGlkX3Rva2VuOiB7IGVtYWlsOiBudWxsLCBlbWFpbF92ZXJpZmllZDogbnVsbCwgLi4uY2xhaW1zT2JqIH1cbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuICBpZiAoZHVyYXRpb24pIHtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImR1cmF0aW9uXCIsIGR1cmF0aW9uKTtcbiAgfVxuICBpZiAocHJvbXB0KSB7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJwcm9tcHRcIiwgXCJzZWxlY3RfYWNjb3VudFwiKTtcbiAgfVxuICByZXR1cm4gdXJsO1xufVxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gIGNvZGUsXG4gIGNvZGVWZXJpZmllcixcbiAgcmVkaXJlY3RVUkksXG4gIG9wdGlvbnMsXG4gIHRva2VuRW5kcG9pbnQsXG4gIGF1dGhlbnRpY2F0aW9uXG59KSB7XG4gIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcbiAgICBhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgIFwidXNlci1hZ2VudFwiOiBcImJldHRlci1hdXRoXCJcbiAgfTtcbiAgYm9keS5zZXQoXCJncmFudF90eXBlXCIsIFwiYXV0aG9yaXphdGlvbl9jb2RlXCIpO1xuICBib2R5LnNldChcImNvZGVcIiwgY29kZSk7XG4gIGNvZGVWZXJpZmllciAmJiBib2R5LnNldChcImNvZGVfdmVyaWZpZXJcIiwgY29kZVZlcmlmaWVyKTtcbiAgYm9keS5zZXQoXCJyZWRpcmVjdF91cmlcIiwgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSk7XG4gIGlmIChhdXRoZW50aWNhdGlvbiA9PT0gXCJiYXNpY1wiKSB7XG4gICAgY29uc3QgZW5jb2RlZENyZWRlbnRpYWxzID0gYnRvYShcbiAgICAgIGAke29wdGlvbnMuY2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXR9YFxuICAgICk7XG4gICAgaGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBgQmFzaWMgJHtlbmNvZGVkQ3JlZGVudGlhbHN9YDtcbiAgfSBlbHNlIHtcbiAgICBib2R5LnNldChcImNsaWVudF9pZFwiLCBvcHRpb25zLmNsaWVudElkKTtcbiAgICBib2R5LnNldChcImNsaWVudF9zZWNyZXRcIiwgb3B0aW9ucy5jbGllbnRTZWNyZXQpO1xuICB9XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKHRva2VuRW5kcG9pbnQsIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHksXG4gICAgaGVhZGVyc1xuICB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3QgdG9rZW5zID0gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpO1xuICByZXR1cm4gdG9rZW5zO1xufVxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVUb2tlbih0b2tlbiwgandrc0VuZHBvaW50KSB7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKGp3a3NFbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICAgIH1cbiAgfSk7XG4gIGlmIChlcnJvcikge1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIGNvbnN0IGtleXMgPSBkYXRhW1wia2V5c1wiXTtcbiAgY29uc3QgaGVhZGVyID0gSlNPTi5wYXJzZShhdG9iKHRva2VuLnNwbGl0KFwiLlwiKVswXSkpO1xuICBjb25zdCBrZXkgPSBrZXlzLmZpbmQoKGtleTIpID0+IGtleTIua2lkID09PSBoZWFkZXIua2lkKTtcbiAgaWYgKCFrZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJLZXkgbm90IGZvdW5kXCIpO1xuICB9XG4gIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBrZXkpO1xuICByZXR1cm4gdmVyaWZpZWQ7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwsIGdlbmVyYXRlQ29kZUNoYWxsZW5nZSwgZ2V0T0F1dGgyVG9rZW5zLCB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlLCB2YWxpZGF0ZVRva2VuIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   twoFactorClient: () => (/* binding */ twoFactorClient)\n/* harmony export */ });\n// src/plugins/two-factor/client.ts\nvar twoFactorClient = (options) => {\n  return {\n    id: \"two-factor\",\n    $InferServerPlugin: {},\n    atomListeners: [\n      {\n        matcher: (path) => path.startsWith(\"/two-factor/\"),\n        signal: \"$sessionSignal\"\n      }\n    ],\n    pathMethods: {\n      \"/two-factor/disable\": \"POST\",\n      \"/two-factor/enable\": \"POST\",\n      \"/two-factor/send-otp\": \"POST\",\n      \"/two-factor/generate-backup-codes\": \"POST\"\n    },\n    fetchPlugins: [\n      {\n        id: \"two-factor\",\n        name: \"two-factor\",\n        hooks: {\n          async onSuccess(context) {\n            if (context.data?.twoFactorRedirect) {\n              if (options?.onTwoFactorRedirect) {\n                await options.onTwoFactorRedirect();\n              }\n            }\n          }\n        }\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdZRFVQRzdYLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTJCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstR1lEVVBHN1guanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3BsdWdpbnMvdHdvLWZhY3Rvci9jbGllbnQudHNcbnZhciB0d29GYWN0b3JDbGllbnQgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInR3by1mYWN0b3JcIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9LFxuICAgIGF0b21MaXN0ZW5lcnM6IFtcbiAgICAgIHtcbiAgICAgICAgbWF0Y2hlcjogKHBhdGgpID0+IHBhdGguc3RhcnRzV2l0aChcIi90d28tZmFjdG9yL1wiKSxcbiAgICAgICAgc2lnbmFsOiBcIiRzZXNzaW9uU2lnbmFsXCJcbiAgICAgIH1cbiAgICBdLFxuICAgIHBhdGhNZXRob2RzOiB7XG4gICAgICBcIi90d28tZmFjdG9yL2Rpc2FibGVcIjogXCJQT1NUXCIsXG4gICAgICBcIi90d28tZmFjdG9yL2VuYWJsZVwiOiBcIlBPU1RcIixcbiAgICAgIFwiL3R3by1mYWN0b3Ivc2VuZC1vdHBcIjogXCJQT1NUXCIsXG4gICAgICBcIi90d28tZmFjdG9yL2dlbmVyYXRlLWJhY2t1cC1jb2Rlc1wiOiBcIlBPU1RcIlxuICAgIH0sXG4gICAgZmV0Y2hQbHVnaW5zOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiBcInR3by1mYWN0b3JcIixcbiAgICAgICAgbmFtZTogXCJ0d28tZmFjdG9yXCIsXG4gICAgICAgIGhvb2tzOiB7XG4gICAgICAgICAgYXN5bmMgb25TdWNjZXNzKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmRhdGE/LnR3b0ZhY3RvclJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgIGlmIChvcHRpb25zPy5vblR3b0ZhY3RvclJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgb3B0aW9ucy5vblR3b0ZhY3RvclJlZGlyZWN0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG5leHBvcnQgeyB0d29GYWN0b3JDbGllbnQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseJSON: () => (/* binding */ parseJSON),\n/* harmony export */   parser_default: () => (/* binding */ parser_default)\n/* harmony export */ });\n// src/client/parser.ts\nvar PROTO_POLLUTION_PATTERNS = {\n  proto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n  constructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n  protoShort: /\"__proto__\"\\s*:/,\n  constructorShort: /\"constructor\"\\s*:/\n};\nvar JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nvar SPECIAL_VALUES = {\n  true: true,\n  false: false,\n  null: null,\n  undefined: void 0,\n  nan: Number.NaN,\n  infinity: Number.POSITIVE_INFINITY,\n  \"-infinity\": Number.NEGATIVE_INFINITY\n};\nvar ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n  return date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n  const match = ISO_DATE_REGEX.exec(value);\n  if (!match) return null;\n  const [\n    ,\n    year,\n    month,\n    day,\n    hour,\n    minute,\n    second,\n    ms,\n    offsetSign,\n    offsetHour,\n    offsetMinute\n  ] = match;\n  let date = new Date(\n    Date.UTC(\n      parseInt(year, 10),\n      parseInt(month, 10) - 1,\n      parseInt(day, 10),\n      parseInt(hour, 10),\n      parseInt(minute, 10),\n      parseInt(second, 10),\n      ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0\n    )\n  );\n  if (offsetSign) {\n    const offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n    date.setUTCMinutes(date.getUTCMinutes() + offset);\n  }\n  return isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n  const {\n    strict = false,\n    warnings = false,\n    reviver,\n    parseDates = true\n  } = options;\n  if (typeof value !== \"string\") {\n    return value;\n  }\n  const trimmed = value.trim();\n  if (trimmed[0] === '\"' && trimmed.endsWith('\"') && !trimmed.slice(1, -1).includes('\"')) {\n    return trimmed.slice(1, -1);\n  }\n  const lowerValue = trimmed.toLowerCase();\n  if (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n    return SPECIAL_VALUES[lowerValue];\n  }\n  if (!JSON_SIGNATURE.test(trimmed)) {\n    if (strict) {\n      throw new SyntaxError(\"[better-json] Invalid JSON\");\n    }\n    return value;\n  }\n  const hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n    ([key, pattern]) => {\n      const matches = pattern.test(trimmed);\n      if (matches && warnings) {\n        console.warn(\n          `[better-json] Detected potential prototype pollution attempt using ${key} pattern`\n        );\n      }\n      return matches;\n    }\n  );\n  if (hasProtoPattern && strict) {\n    throw new Error(\n      \"[better-json] Potential prototype pollution attempt detected\"\n    );\n  }\n  try {\n    const secureReviver = (key, value2) => {\n      if (key === \"__proto__\" || key === \"constructor\" && value2 && typeof value2 === \"object\" && \"prototype\" in value2) {\n        if (warnings) {\n          console.warn(\n            `[better-json] Dropping \"${key}\" key to prevent prototype pollution`\n          );\n        }\n        return void 0;\n      }\n      if (parseDates && typeof value2 === \"string\") {\n        const date = parseISODate(value2);\n        if (date) {\n          return date;\n        }\n      }\n      return reviver ? reviver(key, value2) : value2;\n    };\n    return JSON.parse(trimmed, secureReviver);\n  } catch (error) {\n    if (strict) {\n      throw error;\n    }\n    return value;\n  }\n}\nfunction parseJSON(value, options = { strict: true }) {\n  return betterJSONParse(value, options);\n}\nvar parser_default = parseJSON;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUhWSE4zWTJMLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBLHFCQUFxQixFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLFdBQVcsS0FBSyxNQUFNLEtBQUs7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLElBQUksa0JBQWtCLEVBQUUsTUFBTSxFQUFFO0FBQy9HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0ZBQWdGLEtBQUs7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGNBQWM7QUFDcEQ7QUFDQTtBQUNBOztBQUVxQyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUhWSE4zWTJMLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jbGllbnQvcGFyc2VyLnRzXG52YXIgUFJPVE9fUE9MTFVUSU9OX1BBVFRFUk5TID0ge1xuICBwcm90bzogL1wiKD86X3xcXFxcdTB7Mn01W0ZmXSl7Mn0oPzpwfFxcXFx1MHsyfTcwKSg/OnJ8XFxcXHUwezJ9NzIpKD86b3xcXFxcdTB7Mn02W0ZmXSkoPzp0fFxcXFx1MHsyfTc0KSg/Om98XFxcXHUwezJ9NltGZl0pKD86X3xcXFxcdTB7Mn01W0ZmXSl7Mn1cIlxccyo6LyxcbiAgY29uc3RydWN0b3I6IC9cIig/OmN8XFxcXHUwMDYzKSg/Om98XFxcXHUwMDZbRmZdKSg/Om58XFxcXHUwMDZbRWVdKSg/OnN8XFxcXHUwMDczKSg/OnR8XFxcXHUwMDc0KSg/OnJ8XFxcXHUwMDcyKSg/OnV8XFxcXHUwMDc1KSg/OmN8XFxcXHUwMDYzKSg/OnR8XFxcXHUwMDc0KSg/Om98XFxcXHUwMDZbRmZdKSg/OnJ8XFxcXHUwMDcyKVwiXFxzKjovLFxuICBwcm90b1Nob3J0OiAvXCJfX3Byb3RvX19cIlxccyo6LyxcbiAgY29uc3RydWN0b3JTaG9ydDogL1wiY29uc3RydWN0b3JcIlxccyo6L1xufTtcbnZhciBKU09OX1NJR05BVFVSRSA9IC9eXFxzKltcIlt7XXxeXFxzKi0/XFxkezEsMTZ9KFxcLlxcZHsxLDE3fSk/KFtFZV1bKy1dP1xcZCspP1xccyokLztcbnZhciBTUEVDSUFMX1ZBTFVFUyA9IHtcbiAgdHJ1ZTogdHJ1ZSxcbiAgZmFsc2U6IGZhbHNlLFxuICBudWxsOiBudWxsLFxuICB1bmRlZmluZWQ6IHZvaWQgMCxcbiAgbmFuOiBOdW1iZXIuTmFOLFxuICBpbmZpbml0eTogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxuICBcIi1pbmZpbml0eVwiOiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFlcbn07XG52YXIgSVNPX0RBVEVfUkVHRVggPSAvXihcXGR7NH0pLShcXGR7Mn0pLShcXGR7Mn0pVChcXGR7Mn0pOihcXGR7Mn0pOihcXGR7Mn0pKD86XFwuKFxcZHsxLDd9KSk/KD86WnwoWystXSkoXFxkezJ9KTooXFxkezJ9KSkkLztcbmZ1bmN0aW9uIGlzVmFsaWREYXRlKGRhdGUpIHtcbiAgcmV0dXJuIGRhdGUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTihkYXRlLmdldFRpbWUoKSk7XG59XG5mdW5jdGlvbiBwYXJzZUlTT0RhdGUodmFsdWUpIHtcbiAgY29uc3QgbWF0Y2ggPSBJU09fREFURV9SRUdFWC5leGVjKHZhbHVlKTtcbiAgaWYgKCFtYXRjaCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IFtcbiAgICAsXG4gICAgeWVhcixcbiAgICBtb250aCxcbiAgICBkYXksXG4gICAgaG91cixcbiAgICBtaW51dGUsXG4gICAgc2Vjb25kLFxuICAgIG1zLFxuICAgIG9mZnNldFNpZ24sXG4gICAgb2Zmc2V0SG91cixcbiAgICBvZmZzZXRNaW51dGVcbiAgXSA9IG1hdGNoO1xuICBsZXQgZGF0ZSA9IG5ldyBEYXRlKFxuICAgIERhdGUuVVRDKFxuICAgICAgcGFyc2VJbnQoeWVhciwgMTApLFxuICAgICAgcGFyc2VJbnQobW9udGgsIDEwKSAtIDEsXG4gICAgICBwYXJzZUludChkYXksIDEwKSxcbiAgICAgIHBhcnNlSW50KGhvdXIsIDEwKSxcbiAgICAgIHBhcnNlSW50KG1pbnV0ZSwgMTApLFxuICAgICAgcGFyc2VJbnQoc2Vjb25kLCAxMCksXG4gICAgICBtcyA/IHBhcnNlSW50KG1zLnBhZEVuZCgzLCBcIjBcIiksIDEwKSA6IDBcbiAgICApXG4gICk7XG4gIGlmIChvZmZzZXRTaWduKSB7XG4gICAgY29uc3Qgb2Zmc2V0ID0gKHBhcnNlSW50KG9mZnNldEhvdXIsIDEwKSAqIDYwICsgcGFyc2VJbnQob2Zmc2V0TWludXRlLCAxMCkpICogKG9mZnNldFNpZ24gPT09IFwiK1wiID8gLTEgOiAxKTtcbiAgICBkYXRlLnNldFVUQ01pbnV0ZXMoZGF0ZS5nZXRVVENNaW51dGVzKCkgKyBvZmZzZXQpO1xuICB9XG4gIHJldHVybiBpc1ZhbGlkRGF0ZShkYXRlKSA/IGRhdGUgOiBudWxsO1xufVxuZnVuY3Rpb24gYmV0dGVySlNPTlBhcnNlKHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHN0cmljdCA9IGZhbHNlLFxuICAgIHdhcm5pbmdzID0gZmFsc2UsXG4gICAgcmV2aXZlcixcbiAgICBwYXJzZURhdGVzID0gdHJ1ZVxuICB9ID0gb3B0aW9ucztcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBjb25zdCB0cmltbWVkID0gdmFsdWUudHJpbSgpO1xuICBpZiAodHJpbW1lZFswXSA9PT0gJ1wiJyAmJiB0cmltbWVkLmVuZHNXaXRoKCdcIicpICYmICF0cmltbWVkLnNsaWNlKDEsIC0xKS5pbmNsdWRlcygnXCInKSkge1xuICAgIHJldHVybiB0cmltbWVkLnNsaWNlKDEsIC0xKTtcbiAgfVxuICBjb25zdCBsb3dlclZhbHVlID0gdHJpbW1lZC50b0xvd2VyQ2FzZSgpO1xuICBpZiAobG93ZXJWYWx1ZS5sZW5ndGggPD0gOSAmJiBsb3dlclZhbHVlIGluIFNQRUNJQUxfVkFMVUVTKSB7XG4gICAgcmV0dXJuIFNQRUNJQUxfVkFMVUVTW2xvd2VyVmFsdWVdO1xuICB9XG4gIGlmICghSlNPTl9TSUdOQVRVUkUudGVzdCh0cmltbWVkKSkge1xuICAgIGlmIChzdHJpY3QpIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcIltiZXR0ZXItanNvbl0gSW52YWxpZCBKU09OXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgY29uc3QgaGFzUHJvdG9QYXR0ZXJuID0gT2JqZWN0LmVudHJpZXMoUFJPVE9fUE9MTFVUSU9OX1BBVFRFUk5TKS5zb21lKFxuICAgIChba2V5LCBwYXR0ZXJuXSkgPT4ge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IHBhdHRlcm4udGVzdCh0cmltbWVkKTtcbiAgICAgIGlmIChtYXRjaGVzICYmIHdhcm5pbmdzKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICBgW2JldHRlci1qc29uXSBEZXRlY3RlZCBwb3RlbnRpYWwgcHJvdG90eXBlIHBvbGx1dGlvbiBhdHRlbXB0IHVzaW5nICR7a2V5fSBwYXR0ZXJuYFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgfVxuICApO1xuICBpZiAoaGFzUHJvdG9QYXR0ZXJuICYmIHN0cmljdCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiW2JldHRlci1qc29uXSBQb3RlbnRpYWwgcHJvdG90eXBlIHBvbGx1dGlvbiBhdHRlbXB0IGRldGVjdGVkXCJcbiAgICApO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3Qgc2VjdXJlUmV2aXZlciA9IChrZXksIHZhbHVlMikgPT4ge1xuICAgICAgaWYgKGtleSA9PT0gXCJfX3Byb3RvX19cIiB8fCBrZXkgPT09IFwiY29uc3RydWN0b3JcIiAmJiB2YWx1ZTIgJiYgdHlwZW9mIHZhbHVlMiA9PT0gXCJvYmplY3RcIiAmJiBcInByb3RvdHlwZVwiIGluIHZhbHVlMikge1xuICAgICAgICBpZiAod2FybmluZ3MpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICBgW2JldHRlci1qc29uXSBEcm9wcGluZyBcIiR7a2V5fVwiIGtleSB0byBwcmV2ZW50IHByb3RvdHlwZSBwb2xsdXRpb25gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgfVxuICAgICAgaWYgKHBhcnNlRGF0ZXMgJiYgdHlwZW9mIHZhbHVlMiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBjb25zdCBkYXRlID0gcGFyc2VJU09EYXRlKHZhbHVlMik7XG4gICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXZpdmVyID8gcmV2aXZlcihrZXksIHZhbHVlMikgOiB2YWx1ZTI7XG4gICAgfTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZSh0cmltbWVkLCBzZWN1cmVSZXZpdmVyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoc3RyaWN0KSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5mdW5jdGlvbiBwYXJzZUpTT04odmFsdWUsIG9wdGlvbnMgPSB7IHN0cmljdDogdHJ1ZSB9KSB7XG4gIHJldHVybiBiZXR0ZXJKU09OUGFyc2UodmFsdWUsIG9wdGlvbnMpO1xufVxudmFyIHBhcnNlcl9kZWZhdWx0ID0gcGFyc2VKU09OO1xuXG5leHBvcnQgeyBwYXJzZUpTT04sIHBhcnNlcl9kZWZhdWx0IH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bearer: () => (/* binding */ bearer)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n\n\n\n\n\nvar bearer = (options) => {\n  return {\n    id: \"bearer\",\n    hooks: {\n      before: [\n        {\n          matcher(context) {\n            return Boolean(\n              context.request?.headers.get(\"authorization\") || context.headers?.get(\"authorization\")\n            );\n          },\n          handler: async (c) => {\n            const token = c.request?.headers.get(\"authorization\")?.replace(\"Bearer \", \"\") || c.headers?.get(\"authorization\")?.replace(\"Bearer \", \"\");\n            if (!token) {\n              return;\n            }\n            let signedToken = \"\";\n            if (token.includes(\".\")) {\n              signedToken = token.replace(\"=\", \"\");\n            } else {\n              if (options?.requireSignature) {\n                return;\n              }\n              signedToken = (await (0,better_call__WEBPACK_IMPORTED_MODULE_2__.serializeSigned)(\"\", token, c.context.secret)).replace(\"=\", \"\");\n            }\n            try {\n              const decodedToken = decodeURIComponent(signedToken);\n              const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_3__.createHMAC)(\n                \"SHA-256\",\n                \"base64urlnopad\"\n              ).verify(\n                c.context.secret,\n                decodedToken.split(\".\")[0],\n                decodedToken.split(\".\")[1]\n              );\n              if (!isValid) {\n                return;\n              }\n            } catch (e) {\n              return;\n            }\n            if (c.request) {\n              c.request.headers.append(\n                \"cookie\",\n                `${c.context.authCookies.sessionToken.name}=${signedToken}`\n              );\n            }\n            if (c.headers) {\n              c.headers.append(\n                \"cookie\",\n                `${c.context.authCookies.sessionToken.name}=${signedToken}`\n              );\n            }\n            return {\n              context: c\n            };\n          }\n        }\n      ],\n      after: [\n        {\n          matcher(context) {\n            return !!context.responseHeader.get(\"set-cookie\");\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const setCookie = ctx.responseHeader.get(\"set-cookie\");\n            if (!setCookie) {\n              return;\n            }\n            const parsedCookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseSetCookieHeader)(setCookie);\n            const cookieName = ctx.context.authCookies.sessionToken.name;\n            const sessionCookie = parsedCookies.get(cookieName);\n            if (!sessionCookie || !sessionCookie.value || sessionCookie[\"max-age\"] === 0) {\n              return;\n            }\n            const token = sessionCookie.value;\n            ctx.responseHeader.set(\"set-auth-token\", token);\n            ctx.responseHeader.set(\n              \"Access-Control-Expose-Headers\",\n              \"set-auth-token\"\n            );\n            return {\n              responseHeader: ctx.responseHeader\n            };\n          })\n        }\n      ]\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUtLS0pJNVk3LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJEO0FBQ0E7QUFDYjtBQUNPOztBQUVyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyw0REFBZTtBQUNsRDtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsbUVBQVU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix3Q0FBd0MsR0FBRyxZQUFZO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsd0NBQXdDLEdBQUcsWUFBWTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsbUJBQW1CLHdFQUFvQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyx3RUFBb0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVrQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUtLS0pJNVk3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhNaWRkbGV3YXJlIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBwYXJzZVNldENvb2tpZUhlYWRlciB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgc2VyaWFsaXplU2lnbmVkIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgY3JlYXRlSE1BQyB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcblxudmFyIGJlYXJlciA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYmVhcmVyXCIsXG4gICAgaG9va3M6IHtcbiAgICAgIGJlZm9yZTogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcihjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gQm9vbGVhbihcbiAgICAgICAgICAgICAgY29udGV4dC5yZXF1ZXN0Py5oZWFkZXJzLmdldChcImF1dGhvcml6YXRpb25cIikgfHwgY29udGV4dC5oZWFkZXJzPy5nZXQoXCJhdXRob3JpemF0aW9uXCIpXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaGFuZGxlcjogYXN5bmMgKGMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gYy5yZXF1ZXN0Py5oZWFkZXJzLmdldChcImF1dGhvcml6YXRpb25cIik/LnJlcGxhY2UoXCJCZWFyZXIgXCIsIFwiXCIpIHx8IGMuaGVhZGVycz8uZ2V0KFwiYXV0aG9yaXphdGlvblwiKT8ucmVwbGFjZShcIkJlYXJlciBcIiwgXCJcIik7XG4gICAgICAgICAgICBpZiAoIXRva2VuKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBzaWduZWRUb2tlbiA9IFwiXCI7XG4gICAgICAgICAgICBpZiAodG9rZW4uaW5jbHVkZXMoXCIuXCIpKSB7XG4gICAgICAgICAgICAgIHNpZ25lZFRva2VuID0gdG9rZW4ucmVwbGFjZShcIj1cIiwgXCJcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAob3B0aW9ucz8ucmVxdWlyZVNpZ25hdHVyZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzaWduZWRUb2tlbiA9IChhd2FpdCBzZXJpYWxpemVTaWduZWQoXCJcIiwgdG9rZW4sIGMuY29udGV4dC5zZWNyZXQpKS5yZXBsYWNlKFwiPVwiLCBcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGRlY29kZWRUb2tlbiA9IGRlY29kZVVSSUNvbXBvbmVudChzaWduZWRUb2tlbik7XG4gICAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBjcmVhdGVITUFDKFxuICAgICAgICAgICAgICAgIFwiU0hBLTI1NlwiLFxuICAgICAgICAgICAgICAgIFwiYmFzZTY0dXJsbm9wYWRcIlxuICAgICAgICAgICAgICApLnZlcmlmeShcbiAgICAgICAgICAgICAgICBjLmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgICAgIGRlY29kZWRUb2tlbi5zcGxpdChcIi5cIilbMF0sXG4gICAgICAgICAgICAgICAgZGVjb2RlZFRva2VuLnNwbGl0KFwiLlwiKVsxXVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGMucmVxdWVzdCkge1xuICAgICAgICAgICAgICBjLnJlcXVlc3QuaGVhZGVycy5hcHBlbmQoXG4gICAgICAgICAgICAgICAgXCJjb29raWVcIixcbiAgICAgICAgICAgICAgICBgJHtjLmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWV9PSR7c2lnbmVkVG9rZW59YFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGMuaGVhZGVycykge1xuICAgICAgICAgICAgICBjLmhlYWRlcnMuYXBwZW5kKFxuICAgICAgICAgICAgICAgIFwiY29va2llXCIsXG4gICAgICAgICAgICAgICAgYCR7Yy5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lfT0ke3NpZ25lZFRva2VufWBcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGNvbnRleHQ6IGNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgYWZ0ZXI6IFtcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXIoY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuICEhY29udGV4dC5yZXNwb25zZUhlYWRlci5nZXQoXCJzZXQtY29va2llXCIpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaGFuZGxlcjogY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2V0Q29va2llID0gY3R4LnJlc3BvbnNlSGVhZGVyLmdldChcInNldC1jb29raWVcIik7XG4gICAgICAgICAgICBpZiAoIXNldENvb2tpZSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb29raWVzID0gcGFyc2VTZXRDb29raWVIZWFkZXIoc2V0Q29va2llKTtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZU5hbWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25Db29raWUgPSBwYXJzZWRDb29raWVzLmdldChjb29raWVOYW1lKTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvbkNvb2tpZSB8fCAhc2Vzc2lvbkNvb2tpZS52YWx1ZSB8fCBzZXNzaW9uQ29va2llW1wibWF4LWFnZVwiXSA9PT0gMCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IHNlc3Npb25Db29raWUudmFsdWU7XG4gICAgICAgICAgICBjdHgucmVzcG9uc2VIZWFkZXIuc2V0KFwic2V0LWF1dGgtdG9rZW5cIiwgdG9rZW4pO1xuICAgICAgICAgICAgY3R4LnJlc3BvbnNlSGVhZGVyLnNldChcbiAgICAgICAgICAgICAgXCJBY2Nlc3MtQ29udHJvbC1FeHBvc2UtSGVhZGVyc1wiLFxuICAgICAgICAgICAgICBcInNldC1hdXRoLXRva2VuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICByZXNwb25zZUhlYWRlcjogY3R4LnJlc3BvbnNlSGVhZGVyXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgeyBiZWFyZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HIDE_METADATA: () => (/* binding */ HIDE_METADATA),\n/* harmony export */   createLogger: () => (/* binding */ createLogger),\n/* harmony export */   generateId: () => (/* binding */ generateId),\n/* harmony export */   levels: () => (/* binding */ levels),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   shouldPublishLog: () => (/* binding */ shouldPublishLog)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n// src/utils/logger.ts\nvar levels = [\"info\", \"success\", \"warn\", \"error\", \"debug\"];\nfunction shouldPublishLog(currentLogLevel, logLevel) {\n  return levels.indexOf(logLevel) <= levels.indexOf(currentLogLevel);\n}\nvar colors = {\n  reset: \"\\x1B[0m\",\n  bright: \"\\x1B[1m\",\n  dim: \"\\x1B[2m\",\n  underscore: \"\\x1B[4m\",\n  blink: \"\\x1B[5m\",\n  reverse: \"\\x1B[7m\",\n  hidden: \"\\x1B[8m\",\n  fg: {\n    black: \"\\x1B[30m\",\n    red: \"\\x1B[31m\",\n    green: \"\\x1B[32m\",\n    yellow: \"\\x1B[33m\",\n    blue: \"\\x1B[34m\",\n    magenta: \"\\x1B[35m\",\n    cyan: \"\\x1B[36m\",\n    white: \"\\x1B[37m\"\n  },\n  bg: {\n    black: \"\\x1B[40m\",\n    red: \"\\x1B[41m\",\n    green: \"\\x1B[42m\",\n    yellow: \"\\x1B[43m\",\n    blue: \"\\x1B[44m\",\n    magenta: \"\\x1B[45m\",\n    cyan: \"\\x1B[46m\",\n    white: \"\\x1B[47m\"\n  }\n};\nvar levelColors = {\n  info: colors.fg.blue,\n  success: colors.fg.green,\n  warn: colors.fg.yellow,\n  error: colors.fg.red,\n  debug: colors.fg.magenta\n};\nvar formatMessage = (level, message) => {\n  const timestamp = (/* @__PURE__ */ new Date()).toISOString();\n  return `${colors.dim}${timestamp}${colors.reset} ${levelColors[level]}${level.toUpperCase()}${colors.reset} ${colors.bright}[Better Auth]:${colors.reset} ${message}`;\n};\nvar createLogger = (options) => {\n  const enabled = options?.disabled !== true;\n  const logLevel = options?.level ?? \"error\";\n  const LogFunc = (level, message, args = []) => {\n    if (!enabled || !shouldPublishLog(logLevel, level)) {\n      return;\n    }\n    const formattedMessage = formatMessage(level, message);\n    if (!options || typeof options.log !== \"function\") {\n      if (level === \"error\") {\n        console.error(formattedMessage, ...args);\n      } else if (level === \"warn\") {\n        console.warn(formattedMessage, ...args);\n      } else {\n        console.log(formattedMessage, ...args);\n      }\n      return;\n    }\n    options.log(level === \"success\" ? \"info\" : level, message, ...args);\n  };\n  return Object.fromEntries(\n    levels.map((level) => [\n      level,\n      (...[message, ...args]) => LogFunc(level, message, args)\n    ])\n  );\n};\nvar logger = createLogger();\n\n// src/utils/hide-metadata.ts\nvar HIDE_METADATA = {\n  isAction: false\n};\nvar generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUtMREZCTFlMLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBd0U7O0FBRXhFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFdBQVcsRUFBRSxVQUFVLEVBQUUsY0FBYyxFQUFFLG1CQUFtQixFQUFFLG9CQUFvQixFQUFFLGNBQWMsRUFBRSxjQUFjLGdCQUFnQixjQUFjLEVBQUUsUUFBUTtBQUN0SztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxzRkFBMkI7QUFDcEM7O0FBRXFGIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstS0xERkJMWUwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbi8vIHNyYy91dGlscy9sb2dnZXIudHNcbnZhciBsZXZlbHMgPSBbXCJpbmZvXCIsIFwic3VjY2Vzc1wiLCBcIndhcm5cIiwgXCJlcnJvclwiLCBcImRlYnVnXCJdO1xuZnVuY3Rpb24gc2hvdWxkUHVibGlzaExvZyhjdXJyZW50TG9nTGV2ZWwsIGxvZ0xldmVsKSB7XG4gIHJldHVybiBsZXZlbHMuaW5kZXhPZihsb2dMZXZlbCkgPD0gbGV2ZWxzLmluZGV4T2YoY3VycmVudExvZ0xldmVsKTtcbn1cbnZhciBjb2xvcnMgPSB7XG4gIHJlc2V0OiBcIlxceDFCWzBtXCIsXG4gIGJyaWdodDogXCJcXHgxQlsxbVwiLFxuICBkaW06IFwiXFx4MUJbMm1cIixcbiAgdW5kZXJzY29yZTogXCJcXHgxQls0bVwiLFxuICBibGluazogXCJcXHgxQls1bVwiLFxuICByZXZlcnNlOiBcIlxceDFCWzdtXCIsXG4gIGhpZGRlbjogXCJcXHgxQls4bVwiLFxuICBmZzoge1xuICAgIGJsYWNrOiBcIlxceDFCWzMwbVwiLFxuICAgIHJlZDogXCJcXHgxQlszMW1cIixcbiAgICBncmVlbjogXCJcXHgxQlszMm1cIixcbiAgICB5ZWxsb3c6IFwiXFx4MUJbMzNtXCIsXG4gICAgYmx1ZTogXCJcXHgxQlszNG1cIixcbiAgICBtYWdlbnRhOiBcIlxceDFCWzM1bVwiLFxuICAgIGN5YW46IFwiXFx4MUJbMzZtXCIsXG4gICAgd2hpdGU6IFwiXFx4MUJbMzdtXCJcbiAgfSxcbiAgYmc6IHtcbiAgICBibGFjazogXCJcXHgxQls0MG1cIixcbiAgICByZWQ6IFwiXFx4MUJbNDFtXCIsXG4gICAgZ3JlZW46IFwiXFx4MUJbNDJtXCIsXG4gICAgeWVsbG93OiBcIlxceDFCWzQzbVwiLFxuICAgIGJsdWU6IFwiXFx4MUJbNDRtXCIsXG4gICAgbWFnZW50YTogXCJcXHgxQls0NW1cIixcbiAgICBjeWFuOiBcIlxceDFCWzQ2bVwiLFxuICAgIHdoaXRlOiBcIlxceDFCWzQ3bVwiXG4gIH1cbn07XG52YXIgbGV2ZWxDb2xvcnMgPSB7XG4gIGluZm86IGNvbG9ycy5mZy5ibHVlLFxuICBzdWNjZXNzOiBjb2xvcnMuZmcuZ3JlZW4sXG4gIHdhcm46IGNvbG9ycy5mZy55ZWxsb3csXG4gIGVycm9yOiBjb2xvcnMuZmcucmVkLFxuICBkZWJ1ZzogY29sb3JzLmZnLm1hZ2VudGFcbn07XG52YXIgZm9ybWF0TWVzc2FnZSA9IChsZXZlbCwgbWVzc2FnZSkgPT4ge1xuICBjb25zdCB0aW1lc3RhbXAgPSAoLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLnRvSVNPU3RyaW5nKCk7XG4gIHJldHVybiBgJHtjb2xvcnMuZGltfSR7dGltZXN0YW1wfSR7Y29sb3JzLnJlc2V0fSAke2xldmVsQ29sb3JzW2xldmVsXX0ke2xldmVsLnRvVXBwZXJDYXNlKCl9JHtjb2xvcnMucmVzZXR9ICR7Y29sb3JzLmJyaWdodH1bQmV0dGVyIEF1dGhdOiR7Y29sb3JzLnJlc2V0fSAke21lc3NhZ2V9YDtcbn07XG52YXIgY3JlYXRlTG9nZ2VyID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgZW5hYmxlZCA9IG9wdGlvbnM/LmRpc2FibGVkICE9PSB0cnVlO1xuICBjb25zdCBsb2dMZXZlbCA9IG9wdGlvbnM/LmxldmVsID8/IFwiZXJyb3JcIjtcbiAgY29uc3QgTG9nRnVuYyA9IChsZXZlbCwgbWVzc2FnZSwgYXJncyA9IFtdKSA9PiB7XG4gICAgaWYgKCFlbmFibGVkIHx8ICFzaG91bGRQdWJsaXNoTG9nKGxvZ0xldmVsLCBsZXZlbCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZm9ybWF0dGVkTWVzc2FnZSA9IGZvcm1hdE1lc3NhZ2UobGV2ZWwsIG1lc3NhZ2UpO1xuICAgIGlmICghb3B0aW9ucyB8fCB0eXBlb2Ygb3B0aW9ucy5sb2cgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKGxldmVsID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXR0ZWRNZXNzYWdlLCAuLi5hcmdzKTtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT09IFwid2FyblwiKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybihmb3JtYXR0ZWRNZXNzYWdlLCAuLi5hcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGZvcm1hdHRlZE1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBvcHRpb25zLmxvZyhsZXZlbCA9PT0gXCJzdWNjZXNzXCIgPyBcImluZm9cIiA6IGxldmVsLCBtZXNzYWdlLCAuLi5hcmdzKTtcbiAgfTtcbiAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhcbiAgICBsZXZlbHMubWFwKChsZXZlbCkgPT4gW1xuICAgICAgbGV2ZWwsXG4gICAgICAoLi4uW21lc3NhZ2UsIC4uLmFyZ3NdKSA9PiBMb2dGdW5jKGxldmVsLCBtZXNzYWdlLCBhcmdzKVxuICAgIF0pXG4gICk7XG59O1xudmFyIGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcigpO1xuXG4vLyBzcmMvdXRpbHMvaGlkZS1tZXRhZGF0YS50c1xudmFyIEhJREVfTUVUQURBVEEgPSB7XG4gIGlzQWN0aW9uOiBmYWxzZVxufTtcbnZhciBnZW5lcmF0ZUlkID0gKHNpemUpID0+IHtcbiAgcmV0dXJuIGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvcihcImEtelwiLCBcIkEtWlwiLCBcIjAtOVwiKShzaXplIHx8IDMyKTtcbn07XG5cbmV4cG9ydCB7IEhJREVfTUVUQURBVEEsIGNyZWF0ZUxvZ2dlciwgZ2VuZXJhdGVJZCwgbGV2ZWxzLCBsb2dnZXIsIHNob3VsZFB1Ymxpc2hMb2cgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   oidcProvider: () => (/* binding */ oidcProvider)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n\n\n\n\n\n\n\n\n\n// src/plugins/oidc-provider/schema.ts\nvar schema = {\n  oauthApplication: {\n    modelName: \"oauthApplication\",\n    fields: {\n      name: {\n        type: \"string\"\n      },\n      icon: {\n        type: \"string\",\n        required: false\n      },\n      metadata: {\n        type: \"string\",\n        required: false\n      },\n      clientId: {\n        type: \"string\",\n        unique: true\n      },\n      clientSecret: {\n        type: \"string\"\n      },\n      redirectURLs: {\n        type: \"string\"\n      },\n      type: {\n        type: \"string\"\n      },\n      disabled: {\n        type: \"boolean\",\n        required: false,\n        defaultValue: false\n      },\n      userId: {\n        type: \"string\",\n        required: false\n      },\n      createdAt: {\n        type: \"date\"\n      },\n      updatedAt: {\n        type: \"date\"\n      }\n    }\n  },\n  oauthAccessToken: {\n    modelName: \"oauthAccessToken\",\n    fields: {\n      accessToken: {\n        type: \"string\",\n        unique: true\n      },\n      refreshToken: {\n        type: \"string\",\n        unique: true\n      },\n      accessTokenExpiresAt: {\n        type: \"date\"\n      },\n      refreshTokenExpiresAt: {\n        type: \"date\"\n      },\n      clientId: {\n        type: \"string\"\n      },\n      userId: {\n        type: \"string\",\n        required: false\n      },\n      scopes: {\n        type: \"string\"\n      },\n      createdAt: {\n        type: \"date\"\n      },\n      updatedAt: {\n        type: \"date\"\n      }\n    }\n  },\n  oauthConsent: {\n    modelName: \"oauthConsent\",\n    fields: {\n      clientId: {\n        type: \"string\"\n      },\n      userId: {\n        type: \"string\"\n      },\n      scopes: {\n        type: \"string\"\n      },\n      createdAt: {\n        type: \"date\"\n      },\n      updatedAt: {\n        type: \"date\"\n      },\n      consentGiven: {\n        type: \"boolean\"\n      }\n    }\n  }\n};\nfunction redirectErrorURL(url, error, description) {\n  return `${url.includes(\"?\") ? \"&\" : \"?\"}error=${error}&error_description=${description}`;\n}\nasync function authorize(ctx, options) {\n  const opts = {\n    codeExpiresIn: 600,\n    defaultScope: \"openid\",\n    ...options,\n    scopes: [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"offline_access\",\n      ...options?.scopes || []\n    ]\n  };\n  if (!ctx.request) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n      error_description: \"request not found\",\n      error: \"invalid_request\"\n    });\n  }\n  const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n  if (!session) {\n    await ctx.setSignedCookie(\n      \"oidc_login_prompt\",\n      JSON.stringify(ctx.query),\n      ctx.context.secret,\n      {\n        maxAge: 600\n      }\n    );\n    const queryFromURL = ctx.request.url?.split(\"?\")[1];\n    throw ctx.redirect(`${options.loginPage}?${queryFromURL}`);\n  }\n  const query = ctx.query;\n  if (!query.client_id) {\n    throw ctx.redirect(`${ctx.context.baseURL}/error?error=invalid_client`);\n  }\n  if (!query.response_type) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        `${ctx.context.baseURL}/error`,\n        \"invalid_request\",\n        \"response_type is required\"\n      )\n    );\n  }\n  const client = await ctx.context.adapter.findOne({\n    model: \"oauthApplication\",\n    where: [\n      {\n        field: \"clientId\",\n        value: ctx.query.client_id\n      }\n    ]\n  }).then((res) => {\n    if (!res) {\n      return null;\n    }\n    return {\n      ...res,\n      redirectURLs: res.redirectURLs.split(\",\"),\n      metadata: res.metadata ? JSON.parse(res.metadata) : {}\n    };\n  });\n  if (!client) {\n    throw ctx.redirect(`${ctx.context.baseURL}/error?error=invalid_client`);\n  }\n  const redirectURI = client.redirectURLs.find(\n    (url) => url === ctx.query.redirect_uri\n  );\n  if (!redirectURI || !query.redirect_uri) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid redirect URI\"\n    });\n  }\n  if (client.disabled) {\n    throw ctx.redirect(`${ctx.context.baseURL}/error?error=client_disabled`);\n  }\n  if (query.response_type !== \"code\") {\n    throw ctx.redirect(\n      `${ctx.context.baseURL}/error?error=unsupported_response_type`\n    );\n  }\n  const requestScope = query.scope?.split(\" \").filter((s) => s) || opts.defaultScope.split(\" \");\n  const invalidScopes = requestScope.filter((scope) => {\n    const isInvalid = !opts.scopes.includes(scope) || scope === \"offline_access\" && query.prompt !== \"consent\";\n    return isInvalid;\n  });\n  if (invalidScopes.length) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"invalid_scope\",\n        `The following scopes are invalid: ${invalidScopes.join(\", \")}`\n      )\n    );\n  }\n  if ((!query.code_challenge || !query.code_challenge_method) && options.requirePKCE) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"invalid_request\",\n        \"pkce is required\"\n      )\n    );\n  }\n  if (![\n    \"s256\",\n    options.allowPlainCodeChallengeMethod ? \"plain\" : \"s256\"\n  ].includes(query.code_challenge_method?.toLowerCase() || \"\")) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"invalid_request\",\n        \"invalid code_challenge method\"\n      )\n    );\n  }\n  const code = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\", \"0-9\");\n  const codeExpiresInMs = opts.codeExpiresIn * 1e3;\n  const expiresAt = new Date(Date.now() + codeExpiresInMs);\n  try {\n    await ctx.context.internalAdapter.createVerificationValue({\n      value: JSON.stringify({\n        clientId: client.clientId,\n        redirectURI: query.redirect_uri,\n        scope: requestScope,\n        userId: session.user.id,\n        authTime: session.session.createdAt.getTime(),\n        /**\n         * If the prompt is set to `consent`, then we need\n         * to require the user to consent to the scopes.\n         *\n         * This means the code now needs to be treated as a\n         * consent request.\n         *\n         * once the user consents, teh code will be updated\n         * with the actual code. This is to prevent the\n         * client from using the code before the user\n         * consents.\n         */\n        requireConsent: query.prompt === \"consent\",\n        state: query.prompt === \"consent\" ? query.state : null,\n        codeChallenge: query.code_challenge,\n        codeChallengeMethod: query.code_challenge_method,\n        nonce: query.nonce\n      }),\n      identifier: code,\n      expiresAt\n    });\n  } catch (e) {\n    throw ctx.redirect(\n      redirectErrorURL(\n        query.redirect_uri,\n        \"server_error\",\n        \"An error occurred while processing the request\"\n      )\n    );\n  }\n  const redirectURIWithCode = new URL(redirectURI);\n  redirectURIWithCode.searchParams.set(\"code\", code);\n  redirectURIWithCode.searchParams.set(\"state\", ctx.query.state);\n  if (query.prompt !== \"consent\") {\n    throw ctx.redirect(redirectURIWithCode.toString());\n  }\n  const hasAlreadyConsented = await ctx.context.adapter.findOne({\n    model: \"oauthConsent\",\n    where: [\n      {\n        field: \"clientId\",\n        value: client.clientId\n      },\n      {\n        field: \"userId\",\n        value: session.user.id\n      }\n    ]\n  }).then((res) => !!res?.consentGiven);\n  if (hasAlreadyConsented) {\n    throw ctx.redirect(redirectURIWithCode.toString());\n  }\n  if (options?.consentPage) {\n    await ctx.setSignedCookie(\"oidc_consent_prompt\", code, ctx.context.secret, {\n      maxAge: 600\n    });\n    const conceptURI = `${options.consentPage}?client_id=${client.clientId}&scope=${requestScope.join(\" \")}`;\n    throw ctx.redirect(conceptURI);\n  }\n  const htmlFn = options?.getConsentHTML;\n  if (!htmlFn) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"No consent page provided\"\n    });\n  }\n  return new Response(\n    htmlFn({\n      scopes: requestScope,\n      clientMetadata: client.metadata,\n      clientIcon: client?.icon,\n      clientId: client.clientId,\n      clientName: client.name,\n      code\n    }),\n    {\n      headers: {\n        \"content-type\": \"text/html\"\n      }\n    }\n  );\n}\nvar getMetadata = (ctx, options) => {\n  const issuer = ctx.context.options.baseURL;\n  const baseURL = ctx.context.baseURL;\n  return {\n    issuer,\n    authorization_endpoint: `${baseURL}/oauth2/authorize`,\n    token_endpoint: `${baseURL}/oauth2/token`,\n    userinfo_endpoint: `${baseURL}/oauth2/userinfo`,\n    jwks_uri: `${baseURL}/jwks`,\n    registration_endpoint: `${baseURL}/oauth2/register`,\n    scopes_supported: [\"openid\", \"profile\", \"email\", \"offline_access\"],\n    response_types_supported: [\"code\"],\n    response_modes_supported: [\"query\"],\n    grant_types_supported: [\"authorization_code\"],\n    acr_values_supported: [\n      \"urn:mace:incommon:iap:silver\",\n      \"urn:mace:incommon:iap:bronze\"\n    ],\n    subject_types_supported: [\"public\"],\n    id_token_signing_alg_values_supported: [\"RS256\", \"none\"],\n    token_endpoint_auth_methods_supported: [\n      \"client_secret_basic\",\n      \"client_secret_post\"\n    ],\n    claims_supported: [\n      \"sub\",\n      \"iss\",\n      \"aud\",\n      \"exp\",\n      \"nbf\",\n      \"iat\",\n      \"jti\",\n      \"email\",\n      \"email_verified\",\n      \"name\"\n    ],\n    ...options?.metadata\n  };\n};\nvar oidcProvider = (options) => {\n  const modelName = {\n    oauthClient: \"oauthApplication\",\n    oauthAccessToken: \"oauthAccessToken\",\n    oauthConsent: \"oauthConsent\"\n  };\n  const opts = {\n    codeExpiresIn: 600,\n    defaultScope: \"openid\",\n    accessTokenExpiresIn: 3600,\n    refreshTokenExpiresIn: 604800,\n    ...options,\n    scopes: [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"offline_access\",\n      ...options?.scopes || []\n    ]\n  };\n  return {\n    id: \"oidc\",\n    hooks: {\n      after: [\n        {\n          matcher() {\n            return true;\n          },\n          handler: async (ctx) => {\n            const cookie = await ctx.getSignedCookie(\n              \"oidc_login_prompt\",\n              ctx.context.secret\n            );\n            const cookieName = ctx.context.authCookies.sessionToken.name;\n            const parsedSetCookieHeader = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.parseSetCookieHeader)(\n              ctx.responseHeader.get(\"set-cookie\") || \"\"\n            );\n            const hasSessionToken = parsedSetCookieHeader.has(cookieName);\n            if (!cookie || !hasSessionToken) {\n              return;\n            }\n            ctx.setCookie(\"oidc_login_prompt\", \"\", {\n              maxAge: 0\n            });\n            const sessionCookie = parsedSetCookieHeader.get(cookieName)?.value;\n            const sessionToken = sessionCookie?.split(\".\")[0];\n            if (!sessionToken) {\n              return;\n            }\n            const session = await ctx.context.internalAdapter.findSession(sessionToken);\n            if (!session) {\n              return;\n            }\n            ctx.query = JSON.parse(cookie);\n            ctx.query.prompt = \"consent\";\n            ctx.context.session = session;\n            const response = await authorize(ctx, opts);\n            return response;\n          }\n        }\n      ]\n    },\n    endpoints: {\n      getOpenIdConfig: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/.well-known/openid-configuration\",\n        {\n          method: \"GET\"\n        },\n        async (ctx) => {\n          const metadata = getMetadata(ctx, options);\n          return ctx.json(metadata);\n        }\n      ),\n      oAuth2authorize: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/authorize\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_3__.z.record(zod__WEBPACK_IMPORTED_MODULE_3__.z.string(), zod__WEBPACK_IMPORTED_MODULE_3__.z.any())\n        },\n        async (ctx) => {\n          return authorize(ctx, opts);\n        }\n      ),\n      oAuthConsent: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/consent\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            accept: zod__WEBPACK_IMPORTED_MODULE_3__.z.boolean()\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware]\n        },\n        async (ctx) => {\n          const storedCode = await ctx.getSignedCookie(\n            \"oidc_consent_prompt\",\n            ctx.context.secret\n          );\n          if (!storedCode) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"No consent prompt found\",\n              error: \"invalid_grant\"\n            });\n          }\n          const verification = await ctx.context.internalAdapter.findVerificationValue(storedCode);\n          if (!verification) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"Invalid code\",\n              error: \"invalid_grant\"\n            });\n          }\n          if (verification.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verification.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"Code expired\",\n              error: \"invalid_grant\"\n            });\n          }\n          const value = JSON.parse(verification.value);\n          if (!value.requireConsent || !value.state) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"Consent not required\",\n              error: \"invalid_grant\"\n            });\n          }\n          if (!ctx.body.accept) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verification.id\n            );\n            return ctx.json({\n              redirectURI: `${value.redirectURI}?error=access_denied&error_description=User denied access`\n            });\n          }\n          const code = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\", \"0-9\");\n          const codeExpiresInMs = opts.codeExpiresIn * 1e3;\n          const expiresAt = new Date(Date.now() + codeExpiresInMs);\n          await ctx.context.internalAdapter.updateVerificationValue(\n            verification.id,\n            {\n              value: JSON.stringify({\n                ...value,\n                requireConsent: false\n              }),\n              identifier: code,\n              expiresAt\n            }\n          );\n          await ctx.context.adapter.create({\n            model: modelName.oauthConsent,\n            data: {\n              clientId: value.clientId,\n              userId: value.userId,\n              scopes: value.scope.join(\" \"),\n              consentGiven: true,\n              createdAt: /* @__PURE__ */ new Date(),\n              updatedAt: /* @__PURE__ */ new Date()\n            }\n          });\n          const redirectURI = new URL(value.redirectURI);\n          redirectURI.searchParams.set(\"code\", code);\n          redirectURI.searchParams.set(\"state\", value.state);\n          return ctx.json({\n            redirectURI: redirectURI.toString()\n          });\n        }\n      ),\n      oAuth2token: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/token\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.any(),\n          metadata: {\n            isAction: false\n          }\n        },\n        async (ctx) => {\n          let { body } = ctx;\n          if (!body) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"request body not found\",\n              error: \"invalid_request\"\n            });\n          }\n          if (body instanceof FormData) {\n            body = Object.fromEntries(body.entries());\n          }\n          if (!(body instanceof Object)) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"request body is not an object\",\n              error: \"invalid_request\"\n            });\n          }\n          const {\n            client_id,\n            client_secret,\n            grant_type,\n            code,\n            redirect_uri,\n            refresh_token,\n            code_verifier\n          } = body;\n          if (grant_type === \"refresh_token\") {\n            if (!refresh_token) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n                error_description: \"refresh_token is required\",\n                error: \"invalid_request\"\n              });\n            }\n            const token = await ctx.context.adapter.findOne({\n              model: modelName.oauthAccessToken,\n              where: [\n                {\n                  field: \"refreshToken\",\n                  value: refresh_token.toString()\n                }\n              ]\n            });\n            if (!token) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n                error_description: \"invalid refresh token\",\n                error: \"invalid_grant\"\n              });\n            }\n            if (token.clientId !== client_id?.toString()) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n                error_description: \"invalid client_id\",\n                error: \"invalid_client\"\n              });\n            }\n            if (token.refreshTokenExpiresAt < /* @__PURE__ */ new Date()) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n                error_description: \"refresh token expired\",\n                error: \"invalid_grant\"\n              });\n            }\n            const accessToken2 = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n            const newRefreshToken = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n            const accessTokenExpiresAt2 = new Date(\n              Date.now() + opts.accessTokenExpiresIn * 1e3\n            );\n            const refreshTokenExpiresAt2 = new Date(\n              Date.now() + opts.refreshTokenExpiresIn * 1e3\n            );\n            await ctx.context.adapter.create({\n              model: modelName.oauthAccessToken,\n              data: {\n                accessToken: accessToken2,\n                refreshToken: newRefreshToken,\n                accessTokenExpiresAt: accessTokenExpiresAt2,\n                refreshTokenExpiresAt: refreshTokenExpiresAt2,\n                clientId: client_id.toString(),\n                userId: token.userId,\n                scopes: token.scopes,\n                createdAt: /* @__PURE__ */ new Date(),\n                updatedAt: /* @__PURE__ */ new Date()\n              }\n            });\n            return ctx.json({\n              access_token: accessToken2,\n              token_type: \"bearer\",\n              expires_in: opts.accessTokenExpiresIn,\n              refresh_token: newRefreshToken,\n              scope: token.scopes\n            });\n          }\n          if (!code) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"code is required\",\n              error: \"invalid_request\"\n            });\n          }\n          if (options.requirePKCE && !code_verifier) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"code verifier is missing\",\n              error: \"invalid_request\"\n            });\n          }\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            code.toString()\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid code\",\n              error: \"invalid_grant\"\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"code expired\",\n              error: \"invalid_grant\"\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          if (!client_id || !client_secret) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"client_id and client_secret are required\",\n              error: \"invalid_client\"\n            });\n          }\n          if (!grant_type) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"grant_type is required\",\n              error: \"invalid_request\"\n            });\n          }\n          if (grant_type !== \"authorization_code\") {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"grant_type must be 'authorization_code'\",\n              error: \"unsupported_grant_type\"\n            });\n          }\n          if (!redirect_uri) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"redirect_uri is required\",\n              error: \"invalid_request\"\n            });\n          }\n          const client = await ctx.context.adapter.findOne({\n            model: modelName.oauthClient,\n            where: [{ field: \"clientId\", value: client_id.toString() }]\n          }).then((res) => {\n            if (!res) {\n              return null;\n            }\n            return {\n              ...res,\n              redirectURLs: res.redirectURLs.split(\",\"),\n              metadata: res.metadata ? JSON.parse(res.metadata) : {}\n            };\n          });\n          if (!client) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid client_id\",\n              error: \"invalid_client\"\n            });\n          }\n          if (client.disabled) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"client is disabled\",\n              error: \"invalid_client\"\n            });\n          }\n          const isValidSecret = client.clientSecret === client_secret.toString();\n          if (!isValidSecret) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid client_secret\",\n              error: \"invalid_client\"\n            });\n          }\n          const value = JSON.parse(\n            verificationValue.value\n          );\n          if (value.clientId !== client_id.toString()) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid client_id\",\n              error: \"invalid_client\"\n            });\n          }\n          if (value.redirectURI !== redirect_uri.toString()) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid redirect_uri\",\n              error: \"invalid_client\"\n            });\n          }\n          if (value.codeChallenge && !code_verifier) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              error_description: \"code verifier is missing\",\n              error: \"invalid_request\"\n            });\n          }\n          const challenge = value.codeChallengeMethod === \"plain\" ? code_verifier : await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_6__.createHash)(\"SHA-256\", \"base64urlnopad\").digest(\n            code_verifier\n          );\n          if (challenge !== value.codeChallenge) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"code verification failed\",\n              error: \"invalid_request\"\n            });\n          }\n          const requestedScopes = value.scope;\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const accessToken = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          const refreshToken = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"A-Z\", \"a-z\");\n          const accessTokenExpiresAt = new Date(\n            Date.now() + opts.accessTokenExpiresIn * 1e3\n          );\n          const refreshTokenExpiresAt = new Date(\n            Date.now() + opts.refreshTokenExpiresIn * 1e3\n          );\n          await ctx.context.adapter.create({\n            model: modelName.oauthAccessToken,\n            data: {\n              accessToken,\n              refreshToken,\n              accessTokenExpiresAt,\n              refreshTokenExpiresAt,\n              clientId: client_id.toString(),\n              userId: value.userId,\n              scopes: requestedScopes.join(\" \"),\n              createdAt: /* @__PURE__ */ new Date(),\n              updatedAt: /* @__PURE__ */ new Date()\n            }\n          });\n          const user = await ctx.context.internalAdapter.findUserById(\n            value.userId\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"user not found\",\n              error: \"invalid_grant\"\n            });\n          }\n          let secretKey = {\n            alg: \"HS256\",\n            key: await _better_auth_utils__WEBPACK_IMPORTED_MODULE_4__.subtle.generateKey(\n              {\n                name: \"HMAC\",\n                hash: \"SHA-256\"\n              },\n              true,\n              [\"sign\", \"verify\"]\n            )\n          };\n          const profile = {\n            given_name: user.name.split(\" \")[0],\n            family_name: user.name.split(\" \")[1],\n            name: user.name,\n            profile: user.image,\n            updated_at: user.updatedAt.toISOString()\n          };\n          const email = {\n            email: user.email,\n            email_verified: user.emailVerified\n          };\n          const userClaims = {\n            ...requestedScopes.includes(\"profile\") ? profile : {},\n            ...requestedScopes.includes(\"email\") ? email : {}\n          };\n          const idToken = await new jose__WEBPACK_IMPORTED_MODULE_7__.SignJWT({\n            sub: user.id,\n            aud: client_id.toString(),\n            iat: Date.now(),\n            auth_time: ctx.context.session?.session.createdAt.getTime(),\n            nonce: value.nonce,\n            acr: \"urn:mace:incommon:iap:silver\",\n            // default to silver - ⚠︎ this should be configurable and should be validated against the client's metadata\n            ...userClaims\n          }).setProtectedHeader({ alg: secretKey.alg }).setIssuedAt().setExpirationTime(\n            Math.floor(Date.now() / 1e3) + opts.accessTokenExpiresIn\n          ).sign(secretKey.key);\n          return ctx.json(\n            {\n              access_token: accessToken,\n              token_type: \"Bearer\",\n              expires_in: opts.accessTokenExpiresIn,\n              refresh_token: requestedScopes.includes(\"offline_access\") ? refreshToken : void 0,\n              scope: requestedScopes.join(\" \"),\n              id_token: requestedScopes.includes(\"openid\") ? idToken : void 0\n            },\n            {\n              headers: {\n                \"Cache-Control\": \"no-store\",\n                Pragma: \"no-cache\"\n              }\n            }\n          );\n        }\n      ),\n      oAuth2userInfo: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/userinfo\",\n        {\n          method: \"GET\",\n          metadata: {\n            isAction: false\n          }\n        },\n        async (ctx) => {\n          if (!ctx.request) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"request not found\",\n              error: \"invalid_request\"\n            });\n          }\n          const authorization = ctx.request.headers.get(\"authorization\");\n          if (!authorization) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"authorization header not found\",\n              error: \"invalid_request\"\n            });\n          }\n          const token = authorization.replace(\"Bearer \", \"\");\n          const accessToken = await ctx.context.adapter.findOne({\n            model: modelName.oauthAccessToken,\n            where: [\n              {\n                field: \"accessToken\",\n                value: token\n              }\n            ]\n          });\n          if (!accessToken) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"invalid access token\",\n              error: \"invalid_token\"\n            });\n          }\n          if (accessToken.accessTokenExpiresAt < /* @__PURE__ */ new Date()) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"The Access Token expired\",\n              error: \"invalid_token\"\n            });\n          }\n          const user = await ctx.context.internalAdapter.findUserById(\n            accessToken.userId\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              error_description: \"user not found\",\n              error: \"invalid_token\"\n            });\n          }\n          const requestedScopes = accessToken.scopes.split(\" \");\n          const userClaims = {\n            sub: user.id,\n            email: requestedScopes.includes(\"email\") ? user.email : void 0,\n            name: requestedScopes.includes(\"profile\") ? user.name : void 0,\n            picture: requestedScopes.includes(\"profile\") ? user.image : void 0,\n            given_name: requestedScopes.includes(\"profile\") ? user.name.split(\" \")[0] : void 0,\n            family_name: requestedScopes.includes(\"profile\") ? user.name.split(\" \")[1] : void 0,\n            email_verified: requestedScopes.includes(\"email\") ? user.emailVerified : void 0\n          };\n          return ctx.json(userClaims);\n        }\n      ),\n      registerOAuthApplication: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/register\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n            name: zod__WEBPACK_IMPORTED_MODULE_3__.z.string(),\n            icon: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().optional(),\n            metadata: zod__WEBPACK_IMPORTED_MODULE_3__.z.record(zod__WEBPACK_IMPORTED_MODULE_3__.z.any()).optional(),\n            redirectURLs: zod__WEBPACK_IMPORTED_MODULE_3__.z.array(zod__WEBPACK_IMPORTED_MODULE_3__.z.string())\n          })\n        },\n        async (ctx) => {\n          const body = ctx.body;\n          const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n          if (!session && !options.allowDynamicClientRegistration) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\", {\n              message: \"Unauthorized\"\n            });\n          }\n          const clientId = options.generateClientId?.() || (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          const clientSecret = options.generateClientSecret?.() || (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(32, \"a-z\", \"A-Z\");\n          const client = await ctx.context.adapter.create({\n            model: modelName.oauthClient,\n            data: {\n              name: body.name,\n              icon: body.icon,\n              metadata: body.metadata ? JSON.stringify(body.metadata) : null,\n              clientId,\n              clientSecret,\n              redirectURLs: body.redirectURLs.join(\",\"),\n              type: \"web\",\n              authenticationScheme: \"client_secret\",\n              disabled: false,\n              userId: session?.session.userId,\n              createdAt: /* @__PURE__ */ new Date(),\n              updatedAt: /* @__PURE__ */ new Date()\n            }\n          });\n          return ctx.json({\n            ...client,\n            redirectURLs: client.redirectURLs.split(\",\"),\n            metadata: client.metadata ? JSON.parse(client.metadata) : null\n          });\n        }\n      ),\n      getOAuthClient: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/client/:id\",\n        {\n          method: \"GET\",\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware]\n        },\n        async (ctx) => {\n          const client = await ctx.context.adapter.findOne(\n            {\n              model: modelName.oauthClient,\n              where: [{ field: \"clientId\", value: ctx.params.id }]\n            }\n          );\n          if (!client) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"NOT_FOUND\", {\n              error_description: \"client not found\",\n              error: \"not_found\"\n            });\n          }\n          return ctx.json({\n            clientId: client.clientId,\n            name: client.name,\n            icon: client.icon\n          });\n        }\n      )\n    },\n    schema\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUtZRFo0QkUyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF5RztBQUM5QztBQUNBO0FBQzVCO0FBQ1A7QUFDb0I7QUFDUztBQUNBOztBQUVyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4QkFBOEIsUUFBUSxNQUFNLHFCQUFxQixZQUFZO0FBQ3pGO0FBQ0E7QUFDQTtBQUNB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Qix5Q0FBUTtBQUN4QixrQkFBa0IseUNBQVE7QUFDMUIsa0JBQWtCLHlDQUFRO0FBQzFCLHNCQUFzQix5Q0FBUSxDQUFDLHNDQUFLO0FBQ3BDLDBCQUEwQix3Q0FBTyxDQUFDLHlDQUFRO0FBQzFDLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGdDQUFnQyxxRUFBaUI7QUFDakQ7QUFDQSxzQkFBc0Isd0RBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQSwyREFBMkQsd0VBQW9CO0FBQy9FLG1FQUFtRSx3RUFBb0I7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLHNCQUFzQixzRUFBa0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlFQUFpQjtBQUNqQyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUNBQXlDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstS1lEWjRCRTIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBzZXNzaW9uTWlkZGxld2FyZSwgQVBJRXJyb3IsIGdldFNlc3Npb25Gcm9tQ3R4IH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBwYXJzZVNldENvb2tpZUhlYWRlciB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCB7IFNpZ25KV1QgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgc3VidGxlIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzJztcbmltcG9ydCB7IEFQSUVycm9yIGFzIEFQSUVycm9yJDEgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuXG4vLyBzcmMvcGx1Z2lucy9vaWRjLXByb3ZpZGVyL3NjaGVtYS50c1xudmFyIHNjaGVtYSA9IHtcbiAgb2F1dGhBcHBsaWNhdGlvbjoge1xuICAgIG1vZGVsTmFtZTogXCJvYXV0aEFwcGxpY2F0aW9uXCIsXG4gICAgZmllbGRzOiB7XG4gICAgICBuYW1lOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICBpY29uOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGNsaWVudElkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgfSxcbiAgICAgIGNsaWVudFNlY3JldDoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICB9LFxuICAgICAgcmVkaXJlY3RVUkxzOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICB0eXBlOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICBkaXNhYmxlZDoge1xuICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGZhbHNlXG4gICAgICB9LFxuICAgICAgdXNlcklkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIlxuICAgICAgfSxcbiAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIlxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgb2F1dGhBY2Nlc3NUb2tlbjoge1xuICAgIG1vZGVsTmFtZTogXCJvYXV0aEFjY2Vzc1Rva2VuXCIsXG4gICAgZmllbGRzOiB7XG4gICAgICBhY2Nlc3NUb2tlbjoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICB1bmlxdWU6IHRydWVcbiAgICAgIH0sXG4gICAgICByZWZyZXNoVG9rZW46IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgdW5pcXVlOiB0cnVlXG4gICAgICB9LFxuICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCJcbiAgICAgIH0sXG4gICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCJcbiAgICAgIH0sXG4gICAgICBjbGllbnRJZDoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICB9LFxuICAgICAgdXNlcklkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIHNjb3Blczoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICB9LFxuICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgIHR5cGU6IFwiZGF0ZVwiXG4gICAgICB9LFxuICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgIHR5cGU6IFwiZGF0ZVwiXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBvYXV0aENvbnNlbnQ6IHtcbiAgICBtb2RlbE5hbWU6IFwib2F1dGhDb25zZW50XCIsXG4gICAgZmllbGRzOiB7XG4gICAgICBjbGllbnRJZDoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICB9LFxuICAgICAgdXNlcklkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICBzY29wZXM6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgfSxcbiAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIlxuICAgICAgfSxcbiAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICB0eXBlOiBcImRhdGVcIlxuICAgICAgfSxcbiAgICAgIGNvbnNlbnRHaXZlbjoge1xuICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcbmZ1bmN0aW9uIHJlZGlyZWN0RXJyb3JVUkwodXJsLCBlcnJvciwgZGVzY3JpcHRpb24pIHtcbiAgcmV0dXJuIGAke3VybC5pbmNsdWRlcyhcIj9cIikgPyBcIiZcIiA6IFwiP1wifWVycm9yPSR7ZXJyb3J9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZGVzY3JpcHRpb259YDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGF1dGhvcml6ZShjdHgsIG9wdGlvbnMpIHtcbiAgY29uc3Qgb3B0cyA9IHtcbiAgICBjb2RlRXhwaXJlc0luOiA2MDAsXG4gICAgZGVmYXVsdFNjb3BlOiBcIm9wZW5pZFwiLFxuICAgIC4uLm9wdGlvbnMsXG4gICAgc2NvcGVzOiBbXG4gICAgICBcIm9wZW5pZFwiLFxuICAgICAgXCJwcm9maWxlXCIsXG4gICAgICBcImVtYWlsXCIsXG4gICAgICBcIm9mZmxpbmVfYWNjZXNzXCIsXG4gICAgICAuLi5vcHRpb25zPy5zY29wZXMgfHwgW11cbiAgICBdXG4gIH07XG4gIGlmICghY3R4LnJlcXVlc3QpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IkMShcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJyZXF1ZXN0IG5vdCBmb3VuZFwiLFxuICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgYXdhaXQgY3R4LnNldFNpZ25lZENvb2tpZShcbiAgICAgIFwib2lkY19sb2dpbl9wcm9tcHRcIixcbiAgICAgIEpTT04uc3RyaW5naWZ5KGN0eC5xdWVyeSksXG4gICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICB7XG4gICAgICAgIG1heEFnZTogNjAwXG4gICAgICB9XG4gICAgKTtcbiAgICBjb25zdCBxdWVyeUZyb21VUkwgPSBjdHgucmVxdWVzdC51cmw/LnNwbGl0KFwiP1wiKVsxXTtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7b3B0aW9ucy5sb2dpblBhZ2V9PyR7cXVlcnlGcm9tVVJMfWApO1xuICB9XG4gIGNvbnN0IHF1ZXJ5ID0gY3R4LnF1ZXJ5O1xuICBpZiAoIXF1ZXJ5LmNsaWVudF9pZCkge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHguY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1pbnZhbGlkX2NsaWVudGApO1xuICB9XG4gIGlmICghcXVlcnkucmVzcG9uc2VfdHlwZSkge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgIHJlZGlyZWN0RXJyb3JVUkwoXG4gICAgICAgIGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYCxcbiAgICAgICAgXCJpbnZhbGlkX3JlcXVlc3RcIixcbiAgICAgICAgXCJyZXNwb25zZV90eXBlIGlzIHJlcXVpcmVkXCJcbiAgICAgIClcbiAgICApO1xuICB9XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgbW9kZWw6IFwib2F1dGhBcHBsaWNhdGlvblwiLFxuICAgIHdoZXJlOiBbXG4gICAgICB7XG4gICAgICAgIGZpZWxkOiBcImNsaWVudElkXCIsXG4gICAgICAgIHZhbHVlOiBjdHgucXVlcnkuY2xpZW50X2lkXG4gICAgICB9XG4gICAgXVxuICB9KS50aGVuKChyZXMpID0+IHtcbiAgICBpZiAoIXJlcykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAuLi5yZXMsXG4gICAgICByZWRpcmVjdFVSTHM6IHJlcy5yZWRpcmVjdFVSTHMuc3BsaXQoXCIsXCIpLFxuICAgICAgbWV0YWRhdGE6IHJlcy5tZXRhZGF0YSA/IEpTT04ucGFyc2UocmVzLm1ldGFkYXRhKSA6IHt9XG4gICAgfTtcbiAgfSk7XG4gIGlmICghY2xpZW50KSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPWludmFsaWRfY2xpZW50YCk7XG4gIH1cbiAgY29uc3QgcmVkaXJlY3RVUkkgPSBjbGllbnQucmVkaXJlY3RVUkxzLmZpbmQoXG4gICAgKHVybCkgPT4gdXJsID09PSBjdHgucXVlcnkucmVkaXJlY3RfdXJpXG4gICk7XG4gIGlmICghcmVkaXJlY3RVUkkgfHwgIXF1ZXJ5LnJlZGlyZWN0X3VyaSkge1xuICAgIHRocm93IG5ldyBBUElFcnJvciQxKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIHJlZGlyZWN0IFVSSVwiXG4gICAgfSk7XG4gIH1cbiAgaWYgKGNsaWVudC5kaXNhYmxlZCkge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHguY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1jbGllbnRfZGlzYWJsZWRgKTtcbiAgfVxuICBpZiAocXVlcnkucmVzcG9uc2VfdHlwZSAhPT0gXCJjb2RlXCIpIHtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj11bnN1cHBvcnRlZF9yZXNwb25zZV90eXBlYFxuICAgICk7XG4gIH1cbiAgY29uc3QgcmVxdWVzdFNjb3BlID0gcXVlcnkuc2NvcGU/LnNwbGl0KFwiIFwiKS5maWx0ZXIoKHMpID0+IHMpIHx8IG9wdHMuZGVmYXVsdFNjb3BlLnNwbGl0KFwiIFwiKTtcbiAgY29uc3QgaW52YWxpZFNjb3BlcyA9IHJlcXVlc3RTY29wZS5maWx0ZXIoKHNjb3BlKSA9PiB7XG4gICAgY29uc3QgaXNJbnZhbGlkID0gIW9wdHMuc2NvcGVzLmluY2x1ZGVzKHNjb3BlKSB8fCBzY29wZSA9PT0gXCJvZmZsaW5lX2FjY2Vzc1wiICYmIHF1ZXJ5LnByb21wdCAhPT0gXCJjb25zZW50XCI7XG4gICAgcmV0dXJuIGlzSW52YWxpZDtcbiAgfSk7XG4gIGlmIChpbnZhbGlkU2NvcGVzLmxlbmd0aCkge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgIHJlZGlyZWN0RXJyb3JVUkwoXG4gICAgICAgIHF1ZXJ5LnJlZGlyZWN0X3VyaSxcbiAgICAgICAgXCJpbnZhbGlkX3Njb3BlXCIsXG4gICAgICAgIGBUaGUgZm9sbG93aW5nIHNjb3BlcyBhcmUgaW52YWxpZDogJHtpbnZhbGlkU2NvcGVzLmpvaW4oXCIsIFwiKX1gXG4gICAgICApXG4gICAgKTtcbiAgfVxuICBpZiAoKCFxdWVyeS5jb2RlX2NoYWxsZW5nZSB8fCAhcXVlcnkuY29kZV9jaGFsbGVuZ2VfbWV0aG9kKSAmJiBvcHRpb25zLnJlcXVpcmVQS0NFKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgcmVkaXJlY3RFcnJvclVSTChcbiAgICAgICAgcXVlcnkucmVkaXJlY3RfdXJpLFxuICAgICAgICBcImludmFsaWRfcmVxdWVzdFwiLFxuICAgICAgICBcInBrY2UgaXMgcmVxdWlyZWRcIlxuICAgICAgKVxuICAgICk7XG4gIH1cbiAgaWYgKCFbXG4gICAgXCJzMjU2XCIsXG4gICAgb3B0aW9ucy5hbGxvd1BsYWluQ29kZUNoYWxsZW5nZU1ldGhvZCA/IFwicGxhaW5cIiA6IFwiczI1NlwiXG4gIF0uaW5jbHVkZXMocXVlcnkuY29kZV9jaGFsbGVuZ2VfbWV0aG9kPy50b0xvd2VyQ2FzZSgpIHx8IFwiXCIpKSB7XG4gICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgcmVkaXJlY3RFcnJvclVSTChcbiAgICAgICAgcXVlcnkucmVkaXJlY3RfdXJpLFxuICAgICAgICBcImludmFsaWRfcmVxdWVzdFwiLFxuICAgICAgICBcImludmFsaWQgY29kZV9jaGFsbGVuZ2UgbWV0aG9kXCJcbiAgICAgIClcbiAgICApO1xuICB9XG4gIGNvbnN0IGNvZGUgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIiwgXCIwLTlcIik7XG4gIGNvbnN0IGNvZGVFeHBpcmVzSW5NcyA9IG9wdHMuY29kZUV4cGlyZXNJbiAqIDFlMztcbiAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIGNvZGVFeHBpcmVzSW5Ncyk7XG4gIHRyeSB7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgIHZhbHVlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGNsaWVudElkOiBjbGllbnQuY2xpZW50SWQsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBxdWVyeS5yZWRpcmVjdF91cmksXG4gICAgICAgIHNjb3BlOiByZXF1ZXN0U2NvcGUsXG4gICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBhdXRoVGltZTogc2Vzc2lvbi5zZXNzaW9uLmNyZWF0ZWRBdC5nZXRUaW1lKCksXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGUgcHJvbXB0IGlzIHNldCB0byBgY29uc2VudGAsIHRoZW4gd2UgbmVlZFxuICAgICAgICAgKiB0byByZXF1aXJlIHRoZSB1c2VyIHRvIGNvbnNlbnQgdG8gdGhlIHNjb3Blcy5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBtZWFucyB0aGUgY29kZSBub3cgbmVlZHMgdG8gYmUgdHJlYXRlZCBhcyBhXG4gICAgICAgICAqIGNvbnNlbnQgcmVxdWVzdC5cbiAgICAgICAgICpcbiAgICAgICAgICogb25jZSB0aGUgdXNlciBjb25zZW50cywgdGVoIGNvZGUgd2lsbCBiZSB1cGRhdGVkXG4gICAgICAgICAqIHdpdGggdGhlIGFjdHVhbCBjb2RlLiBUaGlzIGlzIHRvIHByZXZlbnQgdGhlXG4gICAgICAgICAqIGNsaWVudCBmcm9tIHVzaW5nIHRoZSBjb2RlIGJlZm9yZSB0aGUgdXNlclxuICAgICAgICAgKiBjb25zZW50cy5cbiAgICAgICAgICovXG4gICAgICAgIHJlcXVpcmVDb25zZW50OiBxdWVyeS5wcm9tcHQgPT09IFwiY29uc2VudFwiLFxuICAgICAgICBzdGF0ZTogcXVlcnkucHJvbXB0ID09PSBcImNvbnNlbnRcIiA/IHF1ZXJ5LnN0YXRlIDogbnVsbCxcbiAgICAgICAgY29kZUNoYWxsZW5nZTogcXVlcnkuY29kZV9jaGFsbGVuZ2UsXG4gICAgICAgIGNvZGVDaGFsbGVuZ2VNZXRob2Q6IHF1ZXJ5LmNvZGVfY2hhbGxlbmdlX21ldGhvZCxcbiAgICAgICAgbm9uY2U6IHF1ZXJ5Lm5vbmNlXG4gICAgICB9KSxcbiAgICAgIGlkZW50aWZpZXI6IGNvZGUsXG4gICAgICBleHBpcmVzQXRcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgIHJlZGlyZWN0RXJyb3JVUkwoXG4gICAgICAgIHF1ZXJ5LnJlZGlyZWN0X3VyaSxcbiAgICAgICAgXCJzZXJ2ZXJfZXJyb3JcIixcbiAgICAgICAgXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nIHRoZSByZXF1ZXN0XCJcbiAgICAgIClcbiAgICApO1xuICB9XG4gIGNvbnN0IHJlZGlyZWN0VVJJV2l0aENvZGUgPSBuZXcgVVJMKHJlZGlyZWN0VVJJKTtcbiAgcmVkaXJlY3RVUklXaXRoQ29kZS5zZWFyY2hQYXJhbXMuc2V0KFwiY29kZVwiLCBjb2RlKTtcbiAgcmVkaXJlY3RVUklXaXRoQ29kZS5zZWFyY2hQYXJhbXMuc2V0KFwic3RhdGVcIiwgY3R4LnF1ZXJ5LnN0YXRlKTtcbiAgaWYgKHF1ZXJ5LnByb21wdCAhPT0gXCJjb25zZW50XCIpIHtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QocmVkaXJlY3RVUklXaXRoQ29kZS50b1N0cmluZygpKTtcbiAgfVxuICBjb25zdCBoYXNBbHJlYWR5Q29uc2VudGVkID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICBtb2RlbDogXCJvYXV0aENvbnNlbnRcIixcbiAgICB3aGVyZTogW1xuICAgICAge1xuICAgICAgICBmaWVsZDogXCJjbGllbnRJZFwiLFxuICAgICAgICB2YWx1ZTogY2xpZW50LmNsaWVudElkXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgdmFsdWU6IHNlc3Npb24udXNlci5pZFxuICAgICAgfVxuICAgIF1cbiAgfSkudGhlbigocmVzKSA9PiAhIXJlcz8uY29uc2VudEdpdmVuKTtcbiAgaWYgKGhhc0FscmVhZHlDb25zZW50ZWQpIHtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QocmVkaXJlY3RVUklXaXRoQ29kZS50b1N0cmluZygpKTtcbiAgfVxuICBpZiAob3B0aW9ucz8uY29uc2VudFBhZ2UpIHtcbiAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFwib2lkY19jb25zZW50X3Byb21wdFwiLCBjb2RlLCBjdHguY29udGV4dC5zZWNyZXQsIHtcbiAgICAgIG1heEFnZTogNjAwXG4gICAgfSk7XG4gICAgY29uc3QgY29uY2VwdFVSSSA9IGAke29wdGlvbnMuY29uc2VudFBhZ2V9P2NsaWVudF9pZD0ke2NsaWVudC5jbGllbnRJZH0mc2NvcGU9JHtyZXF1ZXN0U2NvcGUuam9pbihcIiBcIil9YDtcbiAgICB0aHJvdyBjdHgucmVkaXJlY3QoY29uY2VwdFVSSSk7XG4gIH1cbiAgY29uc3QgaHRtbEZuID0gb3B0aW9ucz8uZ2V0Q29uc2VudEhUTUw7XG4gIGlmICghaHRtbEZuKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yJDEoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgbWVzc2FnZTogXCJObyBjb25zZW50IHBhZ2UgcHJvdmlkZWRcIlxuICAgIH0pO1xuICB9XG4gIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgaHRtbEZuKHtcbiAgICAgIHNjb3BlczogcmVxdWVzdFNjb3BlLFxuICAgICAgY2xpZW50TWV0YWRhdGE6IGNsaWVudC5tZXRhZGF0YSxcbiAgICAgIGNsaWVudEljb246IGNsaWVudD8uaWNvbixcbiAgICAgIGNsaWVudElkOiBjbGllbnQuY2xpZW50SWQsXG4gICAgICBjbGllbnROYW1lOiBjbGllbnQubmFtZSxcbiAgICAgIGNvZGVcbiAgICB9KSxcbiAgICB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwidGV4dC9odG1sXCJcbiAgICAgIH1cbiAgICB9XG4gICk7XG59XG52YXIgZ2V0TWV0YWRhdGEgPSAoY3R4LCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGlzc3VlciA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTDtcbiAgY29uc3QgYmFzZVVSTCA9IGN0eC5jb250ZXh0LmJhc2VVUkw7XG4gIHJldHVybiB7XG4gICAgaXNzdWVyLFxuICAgIGF1dGhvcml6YXRpb25fZW5kcG9pbnQ6IGAke2Jhc2VVUkx9L29hdXRoMi9hdXRob3JpemVgLFxuICAgIHRva2VuX2VuZHBvaW50OiBgJHtiYXNlVVJMfS9vYXV0aDIvdG9rZW5gLFxuICAgIHVzZXJpbmZvX2VuZHBvaW50OiBgJHtiYXNlVVJMfS9vYXV0aDIvdXNlcmluZm9gLFxuICAgIGp3a3NfdXJpOiBgJHtiYXNlVVJMfS9qd2tzYCxcbiAgICByZWdpc3RyYXRpb25fZW5kcG9pbnQ6IGAke2Jhc2VVUkx9L29hdXRoMi9yZWdpc3RlcmAsXG4gICAgc2NvcGVzX3N1cHBvcnRlZDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCIsIFwib2ZmbGluZV9hY2Nlc3NcIl0sXG4gICAgcmVzcG9uc2VfdHlwZXNfc3VwcG9ydGVkOiBbXCJjb2RlXCJdLFxuICAgIHJlc3BvbnNlX21vZGVzX3N1cHBvcnRlZDogW1wicXVlcnlcIl0sXG4gICAgZ3JhbnRfdHlwZXNfc3VwcG9ydGVkOiBbXCJhdXRob3JpemF0aW9uX2NvZGVcIl0sXG4gICAgYWNyX3ZhbHVlc19zdXBwb3J0ZWQ6IFtcbiAgICAgIFwidXJuOm1hY2U6aW5jb21tb246aWFwOnNpbHZlclwiLFxuICAgICAgXCJ1cm46bWFjZTppbmNvbW1vbjppYXA6YnJvbnplXCJcbiAgICBdLFxuICAgIHN1YmplY3RfdHlwZXNfc3VwcG9ydGVkOiBbXCJwdWJsaWNcIl0sXG4gICAgaWRfdG9rZW5fc2lnbmluZ19hbGdfdmFsdWVzX3N1cHBvcnRlZDogW1wiUlMyNTZcIiwgXCJub25lXCJdLFxuICAgIHRva2VuX2VuZHBvaW50X2F1dGhfbWV0aG9kc19zdXBwb3J0ZWQ6IFtcbiAgICAgIFwiY2xpZW50X3NlY3JldF9iYXNpY1wiLFxuICAgICAgXCJjbGllbnRfc2VjcmV0X3Bvc3RcIlxuICAgIF0sXG4gICAgY2xhaW1zX3N1cHBvcnRlZDogW1xuICAgICAgXCJzdWJcIixcbiAgICAgIFwiaXNzXCIsXG4gICAgICBcImF1ZFwiLFxuICAgICAgXCJleHBcIixcbiAgICAgIFwibmJmXCIsXG4gICAgICBcImlhdFwiLFxuICAgICAgXCJqdGlcIixcbiAgICAgIFwiZW1haWxcIixcbiAgICAgIFwiZW1haWxfdmVyaWZpZWRcIixcbiAgICAgIFwibmFtZVwiXG4gICAgXSxcbiAgICAuLi5vcHRpb25zPy5tZXRhZGF0YVxuICB9O1xufTtcbnZhciBvaWRjUHJvdmlkZXIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBtb2RlbE5hbWUgPSB7XG4gICAgb2F1dGhDbGllbnQ6IFwib2F1dGhBcHBsaWNhdGlvblwiLFxuICAgIG9hdXRoQWNjZXNzVG9rZW46IFwib2F1dGhBY2Nlc3NUb2tlblwiLFxuICAgIG9hdXRoQ29uc2VudDogXCJvYXV0aENvbnNlbnRcIlxuICB9O1xuICBjb25zdCBvcHRzID0ge1xuICAgIGNvZGVFeHBpcmVzSW46IDYwMCxcbiAgICBkZWZhdWx0U2NvcGU6IFwib3BlbmlkXCIsXG4gICAgYWNjZXNzVG9rZW5FeHBpcmVzSW46IDM2MDAsXG4gICAgcmVmcmVzaFRva2VuRXhwaXJlc0luOiA2MDQ4MDAsXG4gICAgLi4ub3B0aW9ucyxcbiAgICBzY29wZXM6IFtcbiAgICAgIFwib3BlbmlkXCIsXG4gICAgICBcInByb2ZpbGVcIixcbiAgICAgIFwiZW1haWxcIixcbiAgICAgIFwib2ZmbGluZV9hY2Nlc3NcIixcbiAgICAgIC4uLm9wdGlvbnM/LnNjb3BlcyB8fCBbXVxuICAgIF1cbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJvaWRjXCIsXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb29raWUgPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgICAgICAgICAgICBcIm9pZGNfbG9naW5fcHJvbXB0XCIsXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZU5hbWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFNldENvb2tpZUhlYWRlciA9IHBhcnNlU2V0Q29va2llSGVhZGVyKFxuICAgICAgICAgICAgICBjdHgucmVzcG9uc2VIZWFkZXIuZ2V0KFwic2V0LWNvb2tpZVwiKSB8fCBcIlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgaGFzU2Vzc2lvblRva2VuID0gcGFyc2VkU2V0Q29va2llSGVhZGVyLmhhcyhjb29raWVOYW1lKTtcbiAgICAgICAgICAgIGlmICghY29va2llIHx8ICFoYXNTZXNzaW9uVG9rZW4pIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3R4LnNldENvb2tpZShcIm9pZGNfbG9naW5fcHJvbXB0XCIsIFwiXCIsIHtcbiAgICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25Db29raWUgPSBwYXJzZWRTZXRDb29raWVIZWFkZXIuZ2V0KGNvb2tpZU5hbWUpPy52YWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbiA9IHNlc3Npb25Db29raWU/LnNwbGl0KFwiLlwiKVswXTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvblRva2VuKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24oc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdHgucXVlcnkgPSBKU09OLnBhcnNlKGNvb2tpZSk7XG4gICAgICAgICAgICBjdHgucXVlcnkucHJvbXB0ID0gXCJjb25zZW50XCI7XG4gICAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXV0aG9yaXplKGN0eCwgb3B0cyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSxcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIGdldE9wZW5JZENvbmZpZzogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi8ud2VsbC1rbm93bi9vcGVuaWQtY29uZmlndXJhdGlvblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGdldE1ldGFkYXRhKGN0eCwgb3B0aW9ucyk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG1ldGFkYXRhKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIG9BdXRoMmF1dGhvcml6ZTogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvYXV0aG9yaXplXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgcXVlcnk6IHoucmVjb3JkKHouc3RyaW5nKCksIHouYW55KCkpXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICByZXR1cm4gYXV0aG9yaXplKGN0eCwgb3B0cyk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBvQXV0aENvbnNlbnQ6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvb2F1dGgyL2NvbnNlbnRcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgYWNjZXB0OiB6LmJvb2xlYW4oKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RvcmVkQ29kZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICBcIm9pZGNfY29uc2VudF9wcm9tcHRcIixcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFzdG9yZWRDb2RlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJObyBjb25zZW50IHByb21wdCBmb3VuZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKHN0b3JlZENvZGUpO1xuICAgICAgICAgIGlmICghdmVyaWZpY2F0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJJbnZhbGlkIGNvZGVcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9ncmFudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgICB2ZXJpZmljYXRpb24uaWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJDb2RlIGV4cGlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9ncmFudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdmFsdWUgPSBKU09OLnBhcnNlKHZlcmlmaWNhdGlvbi52YWx1ZSk7XG4gICAgICAgICAgaWYgKCF2YWx1ZS5yZXF1aXJlQ29uc2VudCB8fCAhdmFsdWUuc3RhdGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcIkNvbnNlbnQgbm90IHJlcXVpcmVkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfZ3JhbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghY3R4LmJvZHkuYWNjZXB0KSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvbi5pZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiBgJHt2YWx1ZS5yZWRpcmVjdFVSSX0/ZXJyb3I9YWNjZXNzX2RlbmllZCZlcnJvcl9kZXNjcmlwdGlvbj1Vc2VyIGRlbmllZCBhY2Nlc3NgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgY29kZSA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcImEtelwiLCBcIkEtWlwiLCBcIjAtOVwiKTtcbiAgICAgICAgICBjb25zdCBjb2RlRXhwaXJlc0luTXMgPSBvcHRzLmNvZGVFeHBpcmVzSW4gKiAxZTM7XG4gICAgICAgICAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIGNvZGVFeHBpcmVzSW5Ncyk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVDb25zZW50OiBmYWxzZVxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgaWRlbnRpZmllcjogY29kZSxcbiAgICAgICAgICAgICAgZXhwaXJlc0F0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmNyZWF0ZSh7XG4gICAgICAgICAgICBtb2RlbDogbW9kZWxOYW1lLm9hdXRoQ29uc2VudCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgY2xpZW50SWQ6IHZhbHVlLmNsaWVudElkLFxuICAgICAgICAgICAgICB1c2VySWQ6IHZhbHVlLnVzZXJJZCxcbiAgICAgICAgICAgICAgc2NvcGVzOiB2YWx1ZS5zY29wZS5qb2luKFwiIFwiKSxcbiAgICAgICAgICAgICAgY29uc2VudEdpdmVuOiB0cnVlLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgcmVkaXJlY3RVUkkgPSBuZXcgVVJMKHZhbHVlLnJlZGlyZWN0VVJJKTtcbiAgICAgICAgICByZWRpcmVjdFVSSS5zZWFyY2hQYXJhbXMuc2V0KFwiY29kZVwiLCBjb2RlKTtcbiAgICAgICAgICByZWRpcmVjdFVSSS5zZWFyY2hQYXJhbXMuc2V0KFwic3RhdGVcIiwgdmFsdWUuc3RhdGUpO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICByZWRpcmVjdFVSSTogcmVkaXJlY3RVUkkudG9TdHJpbmcoKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgb0F1dGgydG9rZW46IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvb2F1dGgyL3Rva2VuXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHouYW55KCksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIGlzQWN0aW9uOiBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGxldCB7IGJvZHkgfSA9IGN0eDtcbiAgICAgICAgICBpZiAoIWJvZHkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwicmVxdWVzdCBib2R5IG5vdCBmb3VuZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChib2R5IGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgICAgICAgIGJvZHkgPSBPYmplY3QuZnJvbUVudHJpZXMoYm9keS5lbnRyaWVzKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIShib2R5IGluc3RhbmNlb2YgT2JqZWN0KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJyZXF1ZXN0IGJvZHkgaXMgbm90IGFuIG9iamVjdFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNsaWVudF9pZCxcbiAgICAgICAgICAgIGNsaWVudF9zZWNyZXQsXG4gICAgICAgICAgICBncmFudF90eXBlLFxuICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgIHJlZGlyZWN0X3VyaSxcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW4sXG4gICAgICAgICAgICBjb2RlX3ZlcmlmaWVyXG4gICAgICAgICAgfSA9IGJvZHk7XG4gICAgICAgICAgaWYgKGdyYW50X3R5cGUgPT09IFwicmVmcmVzaF90b2tlblwiKSB7XG4gICAgICAgICAgICBpZiAoIXJlZnJlc2hfdG9rZW4pIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcInJlZnJlc2hfdG9rZW4gaXMgcmVxdWlyZWRcIixcbiAgICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZS5vYXV0aEFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGZpZWxkOiBcInJlZnJlc2hUb2tlblwiLFxuICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlZnJlc2hfdG9rZW4udG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIXRva2VuKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiaW52YWxpZCByZWZyZXNoIHRva2VuXCIsXG4gICAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9ncmFudFwiXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRva2VuLmNsaWVudElkICE9PSBjbGllbnRfaWQ/LnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJpbnZhbGlkIGNsaWVudF9pZFwiLFxuICAgICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfY2xpZW50XCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodG9rZW4ucmVmcmVzaFRva2VuRXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJyZWZyZXNoIHRva2VuIGV4cGlyZWRcIixcbiAgICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbjIgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIik7XG4gICAgICAgICAgICBjb25zdCBuZXdSZWZyZXNoVG9rZW4gPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIik7XG4gICAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbkV4cGlyZXNBdDIgPSBuZXcgRGF0ZShcbiAgICAgICAgICAgICAgRGF0ZS5ub3coKSArIG9wdHMuYWNjZXNzVG9rZW5FeHBpcmVzSW4gKiAxZTNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCByZWZyZXNoVG9rZW5FeHBpcmVzQXQyID0gbmV3IERhdGUoXG4gICAgICAgICAgICAgIERhdGUubm93KCkgKyBvcHRzLnJlZnJlc2hUb2tlbkV4cGlyZXNJbiAqIDFlM1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZS5vYXV0aEFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VuMixcbiAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW46IG5ld1JlZnJlc2hUb2tlbixcbiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogYWNjZXNzVG9rZW5FeHBpcmVzQXQyLFxuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogcmVmcmVzaFRva2VuRXhwaXJlc0F0MixcbiAgICAgICAgICAgICAgICBjbGllbnRJZDogY2xpZW50X2lkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgdXNlcklkOiB0b2tlbi51c2VySWQsXG4gICAgICAgICAgICAgICAgc2NvcGVzOiB0b2tlbi5zY29wZXMsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiBhY2Nlc3NUb2tlbjIsXG4gICAgICAgICAgICAgIHRva2VuX3R5cGU6IFwiYmVhcmVyXCIsXG4gICAgICAgICAgICAgIGV4cGlyZXNfaW46IG9wdHMuYWNjZXNzVG9rZW5FeHBpcmVzSW4sXG4gICAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46IG5ld1JlZnJlc2hUb2tlbixcbiAgICAgICAgICAgICAgc2NvcGU6IHRva2VuLnNjb3Blc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghY29kZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjb2RlIGlzIHJlcXVpcmVkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wdGlvbnMucmVxdWlyZVBLQ0UgJiYgIWNvZGVfdmVyaWZpZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiY29kZSB2ZXJpZmllciBpcyBtaXNzaW5nXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uVmFsdWUgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgY29kZS50b1N0cmluZygpXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJpbnZhbGlkIGNvZGVcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9ncmFudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblZhbHVlLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiY29kZSBleHBpcmVkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfZ3JhbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIWNsaWVudF9pZCB8fCAhY2xpZW50X3NlY3JldCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiY2xpZW50X2lkIGFuZCBjbGllbnRfc2VjcmV0IGFyZSByZXF1aXJlZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2NsaWVudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFncmFudF90eXBlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImdyYW50X3R5cGUgaXMgcmVxdWlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZ3JhbnRfdHlwZSAhPT0gXCJhdXRob3JpemF0aW9uX2NvZGVcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJncmFudF90eXBlIG11c3QgYmUgJ2F1dGhvcml6YXRpb25fY29kZSdcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwidW5zdXBwb3J0ZWRfZ3JhbnRfdHlwZVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFyZWRpcmVjdF91cmkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwicmVkaXJlY3RfdXJpIGlzIHJlcXVpcmVkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUub2F1dGhDbGllbnQsXG4gICAgICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwiY2xpZW50SWRcIiwgdmFsdWU6IGNsaWVudF9pZC50b1N0cmluZygpIH1dXG4gICAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXJlcykge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIC4uLnJlcyxcbiAgICAgICAgICAgICAgcmVkaXJlY3RVUkxzOiByZXMucmVkaXJlY3RVUkxzLnNwbGl0KFwiLFwiKSxcbiAgICAgICAgICAgICAgbWV0YWRhdGE6IHJlcy5tZXRhZGF0YSA/IEpTT04ucGFyc2UocmVzLm1ldGFkYXRhKSA6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJpbnZhbGlkIGNsaWVudF9pZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2NsaWVudFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNsaWVudC5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiY2xpZW50IGlzIGRpc2FibGVkXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfY2xpZW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBpc1ZhbGlkU2VjcmV0ID0gY2xpZW50LmNsaWVudFNlY3JldCA9PT0gY2xpZW50X3NlY3JldC50b1N0cmluZygpO1xuICAgICAgICAgIGlmICghaXNWYWxpZFNlY3JldCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiaW52YWxpZCBjbGllbnRfc2VjcmV0XCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfY2xpZW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IEpTT04ucGFyc2UoXG4gICAgICAgICAgICB2ZXJpZmljYXRpb25WYWx1ZS52YWx1ZVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKHZhbHVlLmNsaWVudElkICE9PSBjbGllbnRfaWQudG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwiaW52YWxpZCBjbGllbnRfaWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9jbGllbnRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2YWx1ZS5yZWRpcmVjdFVSSSAhPT0gcmVkaXJlY3RfdXJpLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImludmFsaWQgcmVkaXJlY3RfdXJpXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfY2xpZW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodmFsdWUuY29kZUNoYWxsZW5nZSAmJiAhY29kZV92ZXJpZmllcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjb2RlIHZlcmlmaWVyIGlzIG1pc3NpbmdcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjaGFsbGVuZ2UgPSB2YWx1ZS5jb2RlQ2hhbGxlbmdlTWV0aG9kID09PSBcInBsYWluXCIgPyBjb2RlX3ZlcmlmaWVyIDogYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS5kaWdlc3QoXG4gICAgICAgICAgICBjb2RlX3ZlcmlmaWVyXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoY2hhbGxlbmdlICE9PSB2YWx1ZS5jb2RlQ2hhbGxlbmdlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjb2RlIHZlcmlmaWNhdGlvbiBmYWlsZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF9yZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXF1ZXN0ZWRTY29wZXMgPSB2YWx1ZS5zY29wZTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICB2ZXJpZmljYXRpb25WYWx1ZS5pZFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIik7XG4gICAgICAgICAgY29uc3QgcmVmcmVzaFRva2VuID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIsIFwiQS1aXCIsIFwiYS16XCIpO1xuICAgICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuRXhwaXJlc0F0ID0gbmV3IERhdGUoXG4gICAgICAgICAgICBEYXRlLm5vdygpICsgb3B0cy5hY2Nlc3NUb2tlbkV4cGlyZXNJbiAqIDFlM1xuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgcmVmcmVzaFRva2VuRXhwaXJlc0F0ID0gbmV3IERhdGUoXG4gICAgICAgICAgICBEYXRlLm5vdygpICsgb3B0cy5yZWZyZXNoVG9rZW5FeHBpcmVzSW4gKiAxZTNcbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUub2F1dGhBY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgYWNjZXNzVG9rZW4sXG4gICAgICAgICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICAgICAgY2xpZW50SWQ6IGNsaWVudF9pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgICB1c2VySWQ6IHZhbHVlLnVzZXJJZCxcbiAgICAgICAgICAgICAgc2NvcGVzOiByZXF1ZXN0ZWRTY29wZXMuam9pbihcIiBcIiksXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZChcbiAgICAgICAgICAgIHZhbHVlLnVzZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJ1c2VyIG5vdCBmb3VuZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX2dyYW50XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgc2VjcmV0S2V5ID0ge1xuICAgICAgICAgICAgYWxnOiBcIkhTMjU2XCIsXG4gICAgICAgICAgICBrZXk6IGF3YWl0IHN1YnRsZS5nZW5lcmF0ZUtleShcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgIGhhc2g6IFwiU0hBLTI1NlwiXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgIFtcInNpZ25cIiwgXCJ2ZXJpZnlcIl1cbiAgICAgICAgICAgIClcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnN0IHByb2ZpbGUgPSB7XG4gICAgICAgICAgICBnaXZlbl9uYW1lOiB1c2VyLm5hbWUuc3BsaXQoXCIgXCIpWzBdLFxuICAgICAgICAgICAgZmFtaWx5X25hbWU6IHVzZXIubmFtZS5zcGxpdChcIiBcIilbMV0sXG4gICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgICBwcm9maWxlOiB1c2VyLmltYWdlLFxuICAgICAgICAgICAgdXBkYXRlZF9hdDogdXNlci51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgZW1haWwgPSB7XG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIGVtYWlsX3ZlcmlmaWVkOiB1c2VyLmVtYWlsVmVyaWZpZWRcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnN0IHVzZXJDbGFpbXMgPSB7XG4gICAgICAgICAgICAuLi5yZXF1ZXN0ZWRTY29wZXMuaW5jbHVkZXMoXCJwcm9maWxlXCIpID8gcHJvZmlsZSA6IHt9LFxuICAgICAgICAgICAgLi4ucmVxdWVzdGVkU2NvcGVzLmluY2x1ZGVzKFwiZW1haWxcIikgPyBlbWFpbCA6IHt9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgbmV3IFNpZ25KV1Qoe1xuICAgICAgICAgICAgc3ViOiB1c2VyLmlkLFxuICAgICAgICAgICAgYXVkOiBjbGllbnRfaWQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGlhdDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIGF1dGhfdGltZTogY3R4LmNvbnRleHQuc2Vzc2lvbj8uc2Vzc2lvbi5jcmVhdGVkQXQuZ2V0VGltZSgpLFxuICAgICAgICAgICAgbm9uY2U6IHZhbHVlLm5vbmNlLFxuICAgICAgICAgICAgYWNyOiBcInVybjptYWNlOmluY29tbW9uOmlhcDpzaWx2ZXJcIixcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgdG8gc2lsdmVyIC0g4pqg77iOIHRoaXMgc2hvdWxkIGJlIGNvbmZpZ3VyYWJsZSBhbmQgc2hvdWxkIGJlIHZhbGlkYXRlZCBhZ2FpbnN0IHRoZSBjbGllbnQncyBtZXRhZGF0YVxuICAgICAgICAgICAgLi4udXNlckNsYWltc1xuICAgICAgICAgIH0pLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogc2VjcmV0S2V5LmFsZyB9KS5zZXRJc3N1ZWRBdCgpLnNldEV4cGlyYXRpb25UaW1lKFxuICAgICAgICAgICAgTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMWUzKSArIG9wdHMuYWNjZXNzVG9rZW5FeHBpcmVzSW5cbiAgICAgICAgICApLnNpZ24oc2VjcmV0S2V5LmtleSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBhY2Nlc3NfdG9rZW46IGFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICB0b2tlbl90eXBlOiBcIkJlYXJlclwiLFxuICAgICAgICAgICAgICBleHBpcmVzX2luOiBvcHRzLmFjY2Vzc1Rva2VuRXhwaXJlc0luLFxuICAgICAgICAgICAgICByZWZyZXNoX3Rva2VuOiByZXF1ZXN0ZWRTY29wZXMuaW5jbHVkZXMoXCJvZmZsaW5lX2FjY2Vzc1wiKSA/IHJlZnJlc2hUb2tlbiA6IHZvaWQgMCxcbiAgICAgICAgICAgICAgc2NvcGU6IHJlcXVlc3RlZFNjb3Blcy5qb2luKFwiIFwiKSxcbiAgICAgICAgICAgICAgaWRfdG9rZW46IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcIm9wZW5pZFwiKSA/IGlkVG9rZW4gOiB2b2lkIDBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkNhY2hlLUNvbnRyb2xcIjogXCJuby1zdG9yZVwiLFxuICAgICAgICAgICAgICAgIFByYWdtYTogXCJuby1jYWNoZVwiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgb0F1dGgydXNlckluZm86IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvb2F1dGgyL3VzZXJpbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIGlzQWN0aW9uOiBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGlmICghY3R4LnJlcXVlc3QpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcInJlcXVlc3Qgbm90IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfcmVxdWVzdFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgYXV0aG9yaXphdGlvbiA9IGN0eC5yZXF1ZXN0LmhlYWRlcnMuZ2V0KFwiYXV0aG9yaXphdGlvblwiKTtcbiAgICAgICAgICBpZiAoIWF1dGhvcml6YXRpb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImF1dGhvcml6YXRpb24gaGVhZGVyIG5vdCBmb3VuZFwiLFxuICAgICAgICAgICAgICBlcnJvcjogXCJpbnZhbGlkX3JlcXVlc3RcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHRva2VuID0gYXV0aG9yaXphdGlvbi5yZXBsYWNlKFwiQmVhcmVyIFwiLCBcIlwiKTtcbiAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgICAgICBtb2RlbDogbW9kZWxOYW1lLm9hdXRoQWNjZXNzVG9rZW4sXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IFwiYWNjZXNzVG9rZW5cIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogdG9rZW5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiBcImludmFsaWQgYWNjZXNzIHRva2VuXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcImludmFsaWRfdG9rZW5cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbi5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJUaGUgQWNjZXNzIFRva2VuIGV4cGlyZWRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF90b2tlblwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbi51c2VySWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb246IFwidXNlciBub3QgZm91bmRcIixcbiAgICAgICAgICAgICAgZXJyb3I6IFwiaW52YWxpZF90b2tlblwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcmVxdWVzdGVkU2NvcGVzID0gYWNjZXNzVG9rZW4uc2NvcGVzLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICBjb25zdCB1c2VyQ2xhaW1zID0ge1xuICAgICAgICAgICAgc3ViOiB1c2VyLmlkLFxuICAgICAgICAgICAgZW1haWw6IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcImVtYWlsXCIpID8gdXNlci5lbWFpbCA6IHZvaWQgMCxcbiAgICAgICAgICAgIG5hbWU6IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcInByb2ZpbGVcIikgPyB1c2VyLm5hbWUgOiB2b2lkIDAsXG4gICAgICAgICAgICBwaWN0dXJlOiByZXF1ZXN0ZWRTY29wZXMuaW5jbHVkZXMoXCJwcm9maWxlXCIpID8gdXNlci5pbWFnZSA6IHZvaWQgMCxcbiAgICAgICAgICAgIGdpdmVuX25hbWU6IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcInByb2ZpbGVcIikgPyB1c2VyLm5hbWUuc3BsaXQoXCIgXCIpWzBdIDogdm9pZCAwLFxuICAgICAgICAgICAgZmFtaWx5X25hbWU6IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcInByb2ZpbGVcIikgPyB1c2VyLm5hbWUuc3BsaXQoXCIgXCIpWzFdIDogdm9pZCAwLFxuICAgICAgICAgICAgZW1haWxfdmVyaWZpZWQ6IHJlcXVlc3RlZFNjb3Blcy5pbmNsdWRlcyhcImVtYWlsXCIpID8gdXNlci5lbWFpbFZlcmlmaWVkIDogdm9pZCAwXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24odXNlckNsYWltcyk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICByZWdpc3Rlck9BdXRoQXBwbGljYXRpb246IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvb2F1dGgyL3JlZ2lzdGVyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIG5hbWU6IHouc3RyaW5nKCksXG4gICAgICAgICAgICBpY29uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBtZXRhZGF0YTogei5yZWNvcmQoei5hbnkoKSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIHJlZGlyZWN0VVJMczogei5hcnJheSh6LnN0cmluZygpKVxuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBib2R5ID0gY3R4LmJvZHk7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uICYmICFvcHRpb25zLmFsbG93RHluYW1pY0NsaWVudFJlZ2lzdHJhdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJVbmF1dGhvcml6ZWRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGNsaWVudElkID0gb3B0aW9ucy5nZW5lcmF0ZUNsaWVudElkPy4oKSB8fCBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMiwgXCJhLXpcIiwgXCJBLVpcIik7XG4gICAgICAgICAgY29uc3QgY2xpZW50U2VjcmV0ID0gb3B0aW9ucy5nZW5lcmF0ZUNsaWVudFNlY3JldD8uKCkgfHwgZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIsIFwiYS16XCIsIFwiQS1aXCIpO1xuICAgICAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUub2F1dGhDbGllbnQsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIG5hbWU6IGJvZHkubmFtZSxcbiAgICAgICAgICAgICAgaWNvbjogYm9keS5pY29uLFxuICAgICAgICAgICAgICBtZXRhZGF0YTogYm9keS5tZXRhZGF0YSA/IEpTT04uc3RyaW5naWZ5KGJvZHkubWV0YWRhdGEpIDogbnVsbCxcbiAgICAgICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgICAgIGNsaWVudFNlY3JldCxcbiAgICAgICAgICAgICAgcmVkaXJlY3RVUkxzOiBib2R5LnJlZGlyZWN0VVJMcy5qb2luKFwiLFwiKSxcbiAgICAgICAgICAgICAgdHlwZTogXCJ3ZWJcIixcbiAgICAgICAgICAgICAgYXV0aGVudGljYXRpb25TY2hlbWU6IFwiY2xpZW50X3NlY3JldFwiLFxuICAgICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbj8uc2Vzc2lvbi51c2VySWQsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgLi4uY2xpZW50LFxuICAgICAgICAgICAgcmVkaXJlY3RVUkxzOiBjbGllbnQucmVkaXJlY3RVUkxzLnNwbGl0KFwiLFwiKSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiBjbGllbnQubWV0YWRhdGEgPyBKU09OLnBhcnNlKGNsaWVudC5tZXRhZGF0YSkgOiBudWxsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBnZXRPQXV0aENsaWVudDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvY2xpZW50LzppZFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtb2RlbDogbW9kZWxOYW1lLm9hdXRoQ2xpZW50LFxuICAgICAgICAgICAgICB3aGVyZTogW3sgZmllbGQ6IFwiY2xpZW50SWRcIiwgdmFsdWU6IGN0eC5wYXJhbXMuaWQgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbjogXCJjbGllbnQgbm90IGZvdW5kXCIsXG4gICAgICAgICAgICAgIGVycm9yOiBcIm5vdF9mb3VuZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIGNsaWVudElkOiBjbGllbnQuY2xpZW50SWQsXG4gICAgICAgICAgICBuYW1lOiBjbGllbnQubmFtZSxcbiAgICAgICAgICAgIGljb246IGNsaWVudC5pY29uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIHNjaGVtYVxuICB9O1xufTtcblxuZXhwb3J0IHsgb2lkY1Byb3ZpZGVyIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   emailOTP: () => (/* binding */ emailOTP)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\nvar types = [\"email-verification\", \"sign-in\", \"forget-password\"];\nvar emailOTP = (options) => {\n  const opts = {\n    expiresIn: 5 * 60,\n    otpLength: 6,\n    ...options\n  };\n  const ERROR_CODES = {\n    OTP_EXPIRED: \"otp expired\",\n    INVALID_OTP: \"invalid otp\",\n    INVALID_EMAIL: \"invalid email\",\n    USER_NOT_FOUND: \"user not found\"\n  };\n  return {\n    id: \"email-otp\",\n    endpoints: {\n      sendVerificationOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/send-verification-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to send the OTP\"\n            }),\n            type: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](types, {\n              description: \"Type of the OTP\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Send verification OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!options?.sendVerificationOTP) {\n            ctx.context.logger.error(\n              \"send email verification is not implemented\"\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: \"send email verification is not implemented\"\n            });\n          }\n          const email = ctx.body.email;\n          const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n          if (!emailRegex.test(email)) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_EMAIL\n            });\n          }\n          if (ctx.body.type === \"forget-password\" || opts.disableSignUp) {\n            const user = await ctx.context.internalAdapter.findUserByEmail(email);\n            if (!user) {\n              return ctx.json({\n                success: true\n              });\n            }\n          }\n          const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: otp,\n            identifier: `${ctx.body.type}-otp-${email}`,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n          }).catch(async (error) => {\n            await ctx.context.internalAdapter.deleteVerificationByIdentifier(\n              `${ctx.body.type}-otp-${email}`\n            );\n            await ctx.context.internalAdapter.createVerificationValue({\n              value: otp,\n              identifier: `${ctx.body.type}-otp-${email}`,\n              expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n            });\n          });\n          await options.sendVerificationOTP(\n            {\n              email,\n              otp,\n              type: ctx.body.type\n            },\n            ctx.request\n          );\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      createVerificationOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/create-verification-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to send the OTP\"\n            }),\n            type: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](types, {\n              description: \"Type of the OTP\"\n            })\n          }),\n          metadata: {\n            SERVER_ONLY: true,\n            openapi: {\n              description: \"Create verification OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: otp,\n            identifier: `${ctx.body.type}-otp-${email}`,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n          });\n          return otp;\n        }\n      ),\n      getVerificationOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/get-verification-otp\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to get the OTP\"\n            }),\n            type: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](types)\n          }),\n          metadata: {\n            SERVER_ONLY: true,\n            openapi: {\n              description: \"Get verification OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          otp: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.query.email;\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `${ctx.query.type}-otp-${email}`\n          );\n          if (!verificationValue || verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            return ctx.json({\n              otp: null\n            });\n          }\n          return ctx.json({\n            otp: verificationValue.value\n          });\n        }\n      ),\n      verifyEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/verify-email\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to verify\"\n            }),\n            otp: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"OTP to verify\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Verify email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n          if (!emailRegex.test(email)) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_EMAIL\n            });\n          }\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `email-verification-otp-${email}`\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_EXPIRED\n            });\n          }\n          const otp = ctx.body.otp;\n          if (verificationValue.value !== otp) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const user = await ctx.context.internalAdapter.findUserByEmail(email);\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_NOT_FOUND\n            });\n          }\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            user.user.id,\n            {\n              email,\n              emailVerified: true\n            }\n          );\n          if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n            const session = await ctx.context.internalAdapter.createSession(\n              updatedUser.id,\n              ctx.request\n            );\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n              session,\n              user: updatedUser\n            });\n            return ctx.json({\n              status: true,\n              token: session.token,\n              user: {\n                id: updatedUser.id,\n                email: updatedUser.email,\n                emailVerified: updatedUser.emailVerified,\n                name: updatedUser.name,\n                image: updatedUser.image,\n                createdAt: updatedUser.createdAt,\n                updatedAt: updatedUser.updatedAt\n              }\n            });\n          }\n          return ctx.json({\n            status: true,\n            token: null,\n            user: {\n              id: updatedUser.id,\n              email: updatedUser.email,\n              emailVerified: updatedUser.emailVerified,\n              name: updatedUser.name,\n              image: updatedUser.image,\n              createdAt: updatedUser.createdAt,\n              updatedAt: updatedUser.updatedAt\n            }\n          });\n        }\n      ),\n      signInEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/email-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to sign in\"\n            }),\n            otp: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"OTP sent to the email\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Sign in with email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `sign-in-otp-${email}`\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_EXPIRED\n            });\n          }\n          const otp = ctx.body.otp;\n          if (verificationValue.value !== otp) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const user = await ctx.context.internalAdapter.findUserByEmail(email);\n          if (!user) {\n            if (opts.disableSignUp) {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.USER_NOT_FOUND\n              });\n            }\n            const newUser = await ctx.context.internalAdapter.createUser({\n              email,\n              emailVerified: true,\n              name: \"\"\n            });\n            const session2 = await ctx.context.internalAdapter.createSession(\n              newUser.id,\n              ctx.request\n            );\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n              session: session2,\n              user: newUser\n            });\n            return ctx.json({\n              token: session2.token,\n              user: {\n                id: newUser.id,\n                email: newUser.email,\n                emailVerified: newUser.emailVerified,\n                name: newUser.name,\n                image: newUser.image,\n                createdAt: newUser.createdAt,\n                updatedAt: newUser.updatedAt\n              }\n            });\n          }\n          if (!user.user.emailVerified) {\n            await ctx.context.internalAdapter.updateUser(user.user.id, {\n              emailVerified: true\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.user.id,\n            ctx.request\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n            session,\n            user: user.user\n          });\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: user.user.id,\n              email: user.user.email,\n              emailVerified: user.user.emailVerified,\n              name: user.user.name,\n              image: user.user.image,\n              createdAt: user.user.createdAt,\n              updatedAt: user.user.updatedAt\n            }\n          });\n        }\n      ),\n      forgetPasswordEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/forget-password/email-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to send the OTP\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Forget password with email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const user = await ctx.context.internalAdapter.findUserByEmail(email);\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_NOT_FOUND\n            });\n          }\n          const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: otp,\n            identifier: `forget-password-otp-${email}`,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n          });\n          await options.sendVerificationOTP(\n            {\n              email,\n              otp,\n              type: \"forget-password\"\n            },\n            ctx.request\n          );\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      resetPasswordEmailOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/email-otp/reset-password\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"Email address to reset the password\"\n            }),\n            otp: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"OTP sent to the email\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"New password\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              description: \"Reset password with email OTP\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const email = ctx.body.email;\n          const user = await ctx.context.internalAdapter.findUserByEmail(\n            email,\n            {\n              includeAccounts: true\n            }\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_NOT_FOUND\n            });\n          }\n          const verificationValue = await ctx.context.internalAdapter.findVerificationValue(\n            `forget-password-otp-${email}`\n          );\n          if (!verificationValue) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          if (verificationValue.expiresAt < /* @__PURE__ */ new Date()) {\n            await ctx.context.internalAdapter.deleteVerificationValue(\n              verificationValue.id\n            );\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_EXPIRED\n            });\n          }\n          const otp = ctx.body.otp;\n          if (verificationValue.value !== otp) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OTP\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(\n            verificationValue.id\n          );\n          const passwordHash = await ctx.context.password.hash(\n            ctx.body.password\n          );\n          const account = user.accounts.find(\n            (account2) => account2.providerId === \"credential\"\n          );\n          if (!account) {\n            await ctx.context.internalAdapter.createAccount({\n              userId: user.user.id,\n              providerId: \"credential\",\n              accountId: user.user.id,\n              password: passwordHash\n            });\n          } else {\n            await ctx.context.internalAdapter.updatePassword(\n              user.user.id,\n              passwordHash\n            );\n          }\n          return ctx.json({\n            success: true\n          });\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return !!(context.path?.startsWith(\"/sign-up\") && opts.sendVerificationOnSignUp);\n          },\n          async handler(ctx) {\n            const response = ctx.context.returned;\n            if (response instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n              return;\n            }\n            const email = response && \"email\" in response ? response.email : response instanceof Response ? response.status === 200 ? ctx.body.email : null : null;\n            if (email) {\n              const otp = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_2__.generateRandomString)(opts.otpLength, \"0-9\");\n              await ctx.context.internalAdapter.createVerificationValue({\n                value: otp,\n                identifier: `email-verification-otp-${email}`,\n                expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(opts.expiresIn, \"sec\")\n              });\n              await options.sendVerificationOTP(\n                {\n                  email,\n                  otp,\n                  type: \"email-verification\"\n                },\n                ctx.request\n              );\n            }\n          }\n        }\n      ]\n    },\n    $ERROR_CODES: ERROR_CODES,\n    rateLimit: [\n      {\n        pathMatcher(path) {\n          return path === \"/email-otp/send-verification-otp\";\n        },\n        window: 60,\n        max: 3\n      },\n      {\n        pathMatcher(path) {\n          return path === \"/email-otp/verify-email\";\n        },\n        window: 60,\n        max: 3\n      },\n      {\n        pathMatcher(path) {\n          return path === \"/sign-in/email-otp\";\n        },\n        window: 60,\n        max: 3\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUxOQUVUVk9PLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFtRTtBQUNaO0FBQ0k7QUFDYjtBQUN0Qjs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0VBQWtCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4QixtQkFBbUIseUNBQVE7QUFDM0I7QUFDQSxhQUFhO0FBQ2Isa0JBQWtCLDBDQUFNO0FBQ3hCO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHdEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSwwRUFBMEUsR0FBRztBQUM3RTtBQUNBLHNCQUFzQix3REFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLHNCQUFzQix3RUFBb0I7QUFDMUM7QUFDQTtBQUNBLDJCQUEyQixjQUFjLE9BQU8sTUFBTTtBQUN0RCx1QkFBdUIsMkRBQU87QUFDOUIsV0FBVztBQUNYO0FBQ0EsaUJBQWlCLGNBQWMsT0FBTyxNQUFNO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixjQUFjLE9BQU8sTUFBTTtBQUN4RCx5QkFBeUIsMkRBQU87QUFDaEMsYUFBYTtBQUNiLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUNYO0FBQ0E7QUFDQSxvQ0FBb0Msd0RBQVE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsd0VBQW9CO0FBQzlDO0FBQ0E7QUFDQSxzREFBc0QsTUFBTTtBQUM1RCwyQkFBMkIsMkRBQU87QUFDbEMsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVvQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUxOQUVUVk9PLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgQVBJRXJyb3IgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlUmFuZG9tU3RyaW5nIH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgeyBnZXREYXRlIH0gZnJvbSAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxudmFyIHR5cGVzID0gW1wiZW1haWwtdmVyaWZpY2F0aW9uXCIsIFwic2lnbi1pblwiLCBcImZvcmdldC1wYXNzd29yZFwiXTtcbnZhciBlbWFpbE9UUCA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgZXhwaXJlc0luOiA1ICogNjAsXG4gICAgb3RwTGVuZ3RoOiA2LFxuICAgIC4uLm9wdGlvbnNcbiAgfTtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgT1RQX0VYUElSRUQ6IFwib3RwIGV4cGlyZWRcIixcbiAgICBJTlZBTElEX09UUDogXCJpbnZhbGlkIG90cFwiLFxuICAgIElOVkFMSURfRU1BSUw6IFwiaW52YWxpZCBlbWFpbFwiLFxuICAgIFVTRVJfTk9UX0ZPVU5EOiBcInVzZXIgbm90IGZvdW5kXCJcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJlbWFpbC1vdHBcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHNlbmRWZXJpZmljYXRpb25PVFA6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvZW1haWwtb3RwL3NlbmQtdmVyaWZpY2F0aW9uLW90cFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBhZGRyZXNzIHRvIHNlbmQgdGhlIE9UUFwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHR5cGU6IHouZW51bSh0eXBlcywge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUeXBlIG9mIHRoZSBPVFBcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZW5kIHZlcmlmaWNhdGlvbiBPVFBcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGlmICghb3B0aW9ucz8uc2VuZFZlcmlmaWNhdGlvbk9UUCkge1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICBcInNlbmQgZW1haWwgdmVyaWZpY2F0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZFwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcInNlbmQgZW1haWwgdmVyaWZpY2F0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZW1haWwgPSBjdHguYm9keS5lbWFpbDtcbiAgICAgICAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bYS16QS1aMC05Ll8lKy1dK0BbYS16QS1aMC05Li1dK1xcLlthLXpBLVpdezIsfSQvO1xuICAgICAgICAgIGlmICghZW1haWxSZWdleC50ZXN0KGVtYWlsKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGN0eC5ib2R5LnR5cGUgPT09IFwiZm9yZ2V0LXBhc3N3b3JkXCIgfHwgb3B0cy5kaXNhYmxlU2lnblVwKSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBvdHAgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZyhvcHRzLm90cExlbmd0aCwgXCIwLTlcIik7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdHAsXG4gICAgICAgICAgICBpZGVudGlmaWVyOiBgJHtjdHguYm9keS50eXBlfS1vdHAtJHtlbWFpbH1gLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKG9wdHMuZXhwaXJlc0luLCBcInNlY1wiKVxuICAgICAgICAgIH0pLmNhdGNoKGFzeW5jIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvbkJ5SWRlbnRpZmllcihcbiAgICAgICAgICAgICAgYCR7Y3R4LmJvZHkudHlwZX0tb3RwLSR7ZW1haWx9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgICAgICAgICAgIHZhbHVlOiBvdHAsXG4gICAgICAgICAgICAgIGlkZW50aWZpZXI6IGAke2N0eC5ib2R5LnR5cGV9LW90cC0ke2VtYWlsfWAsXG4gICAgICAgICAgICAgIGV4cGlyZXNBdDogZ2V0RGF0ZShvcHRzLmV4cGlyZXNJbiwgXCJzZWNcIilcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGF3YWl0IG9wdGlvbnMuc2VuZFZlcmlmaWNhdGlvbk9UUChcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAgIG90cCxcbiAgICAgICAgICAgICAgdHlwZTogY3R4LmJvZHkudHlwZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgY3JlYXRlVmVyaWZpY2F0aW9uT1RQOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2VtYWlsLW90cC9jcmVhdGUtdmVyaWZpY2F0aW9uLW90cFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBhZGRyZXNzIHRvIHNlbmQgdGhlIE9UUFwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHR5cGU6IHouZW51bSh0eXBlcywge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUeXBlIG9mIHRoZSBPVFBcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgU0VSVkVSX09OTFk6IHRydWUsXG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNyZWF0ZSB2ZXJpZmljYXRpb24gT1RQXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gY3R4LmJvZHkuZW1haWw7XG4gICAgICAgICAgY29uc3Qgb3RwID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcob3B0cy5vdHBMZW5ndGgsIFwiMC05XCIpO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3RwLFxuICAgICAgICAgICAgaWRlbnRpZmllcjogYCR7Y3R4LmJvZHkudHlwZX0tb3RwLSR7ZW1haWx9YCxcbiAgICAgICAgICAgIGV4cGlyZXNBdDogZ2V0RGF0ZShvcHRzLmV4cGlyZXNJbiwgXCJzZWNcIilcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gb3RwO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgZ2V0VmVyaWZpY2F0aW9uT1RQOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2VtYWlsLW90cC9nZXQtdmVyaWZpY2F0aW9uLW90cFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBhZGRyZXNzIHRvIGdldCB0aGUgT1RQXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdHlwZTogei5lbnVtKHR5cGVzKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBTRVJWRVJfT05MWTogdHJ1ZSxcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHZlcmlmaWNhdGlvbiBPVFBcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBvdHA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IGN0eC5xdWVyeS5lbWFpbDtcbiAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25WYWx1ZSA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICBgJHtjdHgucXVlcnkudHlwZX0tb3RwLSR7ZW1haWx9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF2ZXJpZmljYXRpb25WYWx1ZSB8fCB2ZXJpZmljYXRpb25WYWx1ZS5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgb3RwOiBudWxsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIG90cDogdmVyaWZpY2F0aW9uVmFsdWUudmFsdWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHZlcmlmeUVtYWlsT1RQOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2VtYWlsLW90cC92ZXJpZnktZW1haWxcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgYWRkcmVzcyB0byB2ZXJpZnlcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBvdHA6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiT1RQIHRvIHZlcmlmeVwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmeSBlbWFpbCBPVFBcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gY3R4LmJvZHkuZW1haWw7XG4gICAgICAgICAgY29uc3QgZW1haWxSZWdleCA9IC9eW2EtekEtWjAtOS5fJSstXStAW2EtekEtWjAtOS4tXStcXC5bYS16QS1aXXsyLH0kLztcbiAgICAgICAgICBpZiAoIWVtYWlsUmVnZXgudGVzdChlbWFpbCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblZhbHVlID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIGBlbWFpbC12ZXJpZmljYXRpb24tb3RwLSR7ZW1haWx9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF2ZXJpZmljYXRpb25WYWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX09UUFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2ZXJpZmljYXRpb25WYWx1ZS5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgICB2ZXJpZmljYXRpb25WYWx1ZS5pZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuT1RQX0VYUElSRURcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBvdHAgPSBjdHguYm9keS5vdHA7XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblZhbHVlLnZhbHVlICE9PSBvdHApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9PVFBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICB2ZXJpZmljYXRpb25WYWx1ZS5pZFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSX05PVF9GT1VORFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoXG4gICAgICAgICAgICB1c2VyLnVzZXIuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uYXV0b1NpZ25JbkFmdGVyVmVyaWZpY2F0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICAgIHVwZGF0ZWRVc2VyLmlkLFxuICAgICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogdXBkYXRlZFVzZXIuaWQsXG4gICAgICAgICAgICAgICAgZW1haWw6IHVwZGF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVwZGF0ZWRVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgICAgbmFtZTogdXBkYXRlZFVzZXIubmFtZSxcbiAgICAgICAgICAgICAgICBpbWFnZTogdXBkYXRlZFVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1cGRhdGVkVXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1cGRhdGVkVXNlci51cGRhdGVkQXRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgICB0b2tlbjogbnVsbCxcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IHVwZGF0ZWRVc2VyLmlkLFxuICAgICAgICAgICAgICBlbWFpbDogdXBkYXRlZFVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVwZGF0ZWRVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZWRVc2VyLm5hbWUsXG4gICAgICAgICAgICAgIGltYWdlOiB1cGRhdGVkVXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1cGRhdGVkVXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogdXBkYXRlZFVzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBzaWduSW5FbWFpbE9UUDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9zaWduLWluL2VtYWlsLW90cFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBlbWFpbDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBhZGRyZXNzIHRvIHNpZ24gaW5cIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBvdHA6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiT1RQIHNlbnQgdG8gdGhlIGVtYWlsXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIGVtYWlsIE9UUFwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gY3R4LmJvZHkuZW1haWw7XG4gICAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uVmFsdWUgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgYHNpZ24taW4tb3RwLSR7ZW1haWx9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF2ZXJpZmljYXRpb25WYWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX09UUFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2ZXJpZmljYXRpb25WYWx1ZS5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgICB2ZXJpZmljYXRpb25WYWx1ZS5pZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuT1RQX0VYUElSRURcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBvdHAgPSBjdHguYm9keS5vdHA7XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblZhbHVlLnZhbHVlICE9PSBvdHApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9PVFBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICB2ZXJpZmljYXRpb25WYWx1ZS5pZFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgaWYgKG9wdHMuZGlzYWJsZVNpZ25VcCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUl9OT1RfRk9VTkRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBuZXdVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVVzZXIoe1xuICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmFtZTogXCJcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uMiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgICBuZXdVc2VyLmlkLFxuICAgICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICAgIHNlc3Npb246IHNlc3Npb24yLFxuICAgICAgICAgICAgICB1c2VyOiBuZXdVc2VyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uMi50b2tlbixcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiBuZXdVc2VyLmlkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiBuZXdVc2VyLmVtYWlsLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IG5ld1VzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBuZXdVc2VyLm5hbWUsXG4gICAgICAgICAgICAgICAgaW1hZ2U6IG5ld1VzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXdVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ld1VzZXIudXBkYXRlZEF0XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXVzZXIudXNlci5lbWFpbFZlcmlmaWVkKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcih1c2VyLnVzZXIuaWQsIHtcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHVzZXIudXNlci5pZCxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXI6IHVzZXIudXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IHVzZXIudXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIudXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci51c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgIG5hbWU6IHVzZXIudXNlci5uYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogdXNlci51c2VyLmltYWdlLFxuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHVzZXIudXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogdXNlci51c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgZm9yZ2V0UGFzc3dvcmRFbWFpbE9UUDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9mb3JnZXQtcGFzc3dvcmQvZW1haWwtb3RwXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gc2VuZCB0aGUgT1RQXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRm9yZ2V0IHBhc3N3b3JkIHdpdGggZW1haWwgT1RQXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IGN0eC5ib2R5LmVtYWlsO1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUl9OT1RfRk9VTkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBvdHAgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZyhvcHRzLm90cExlbmd0aCwgXCIwLTlcIik7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdHAsXG4gICAgICAgICAgICBpZGVudGlmaWVyOiBgZm9yZ2V0LXBhc3N3b3JkLW90cC0ke2VtYWlsfWAsXG4gICAgICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUob3B0cy5leHBpcmVzSW4sIFwic2VjXCIpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgb3B0aW9ucy5zZW5kVmVyaWZpY2F0aW9uT1RQKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgb3RwLFxuICAgICAgICAgICAgICB0eXBlOiBcImZvcmdldC1wYXNzd29yZFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICByZXNldFBhc3N3b3JkRW1haWxPVFA6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvZW1haWwtb3RwL3Jlc2V0LXBhc3N3b3JkXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVtYWlsIGFkZHJlc3MgdG8gcmVzZXQgdGhlIHBhc3N3b3JkXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb3RwOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk9UUCBzZW50IHRvIHRoZSBlbWFpbFwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk5ldyBwYXNzd29yZFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlc2V0IHBhc3N3b3JkIHdpdGggZW1haWwgT1RQXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IGN0eC5ib2R5LmVtYWlsO1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKFxuICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGluY2x1ZGVBY2NvdW50czogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLlVTRVJfTk9UX0ZPVU5EXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uVmFsdWUgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICAgICAgYGZvcmdldC1wYXNzd29yZC1vdHAtJHtlbWFpbH1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT1RQXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblZhbHVlLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5PVFBfRVhQSVJFRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG90cCA9IGN0eC5ib2R5Lm90cDtcbiAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uVmFsdWUudmFsdWUgIT09IG90cCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX09UUFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblZhbHVlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKFxuICAgICAgICAgICAgY3R4LmJvZHkucGFzc3dvcmRcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IGFjY291bnQgPSB1c2VyLmFjY291bnRzLmZpbmQoXG4gICAgICAgICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVBY2NvdW50KHtcbiAgICAgICAgICAgICAgdXNlcklkOiB1c2VyLnVzZXIuaWQsXG4gICAgICAgICAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVzZXIudXNlci5pZCxcbiAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkSGFzaFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVQYXNzd29yZChcbiAgICAgICAgICAgICAgdXNlci51c2VyLmlkLFxuICAgICAgICAgICAgICBwYXNzd29yZEhhc2hcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIGhvb2tzOiB7XG4gICAgICBhZnRlcjogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcihjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gISEoY29udGV4dC5wYXRoPy5zdGFydHNXaXRoKFwiL3NpZ24tdXBcIikgJiYgb3B0cy5zZW5kVmVyaWZpY2F0aW9uT25TaWduVXApO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgaGFuZGxlcihjdHgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gY3R4LmNvbnRleHQucmV0dXJuZWQ7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBlbWFpbCA9IHJlc3BvbnNlICYmIFwiZW1haWxcIiBpbiByZXNwb25zZSA/IHJlc3BvbnNlLmVtYWlsIDogcmVzcG9uc2UgaW5zdGFuY2VvZiBSZXNwb25zZSA/IHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwID8gY3R4LmJvZHkuZW1haWwgOiBudWxsIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChlbWFpbCkge1xuICAgICAgICAgICAgICBjb25zdCBvdHAgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZyhvcHRzLm90cExlbmd0aCwgXCIwLTlcIik7XG4gICAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IG90cCxcbiAgICAgICAgICAgICAgICBpZGVudGlmaWVyOiBgZW1haWwtdmVyaWZpY2F0aW9uLW90cC0ke2VtYWlsfWAsXG4gICAgICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKG9wdHMuZXhwaXJlc0luLCBcInNlY1wiKVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYXdhaXQgb3B0aW9ucy5zZW5kVmVyaWZpY2F0aW9uT1RQKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICAgICAgb3RwLFxuICAgICAgICAgICAgICAgICAgdHlwZTogXCJlbWFpbC12ZXJpZmljYXRpb25cIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9LFxuICAgICRFUlJPUl9DT0RFUzogRVJST1JfQ09ERVMsXG4gICAgcmF0ZUxpbWl0OiBbXG4gICAgICB7XG4gICAgICAgIHBhdGhNYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgICByZXR1cm4gcGF0aCA9PT0gXCIvZW1haWwtb3RwL3NlbmQtdmVyaWZpY2F0aW9uLW90cFwiO1xuICAgICAgICB9LFxuICAgICAgICB3aW5kb3c6IDYwLFxuICAgICAgICBtYXg6IDNcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHBhdGhNYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgICByZXR1cm4gcGF0aCA9PT0gXCIvZW1haWwtb3RwL3ZlcmlmeS1lbWFpbFwiO1xuICAgICAgICB9LFxuICAgICAgICB3aW5kb3c6IDYwLFxuICAgICAgICBtYXg6IDNcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHBhdGhNYXRjaGVyKHBhdGgpIHtcbiAgICAgICAgICByZXR1cm4gcGF0aCA9PT0gXCIvc2lnbi1pbi9lbWFpbC1vdHBcIjtcbiAgICAgICAgfSxcbiAgICAgICAgd2luZG93OiA2MCxcbiAgICAgICAgbWF4OiAzXG4gICAgICB9XG4gICAgXVxuICB9O1xufTtcblxuZXhwb3J0IHsgZW1haWxPVFAgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   username: () => (/* binding */ username)\n/* harmony export */ });\n/* harmony import */ var _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-WMXBA6LX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\n\n// src/plugins/username/schema.ts\nvar schema = {\n  user: {\n    fields: {\n      username: {\n        type: \"string\",\n        required: false,\n        sortable: true,\n        unique: true,\n        returned: true,\n        transform: {\n          input(value) {\n            return value?.toString().toLowerCase();\n          }\n        }\n      }\n    }\n  }\n};\n\n// src/plugins/username/index.ts\nfunction defaultUsernameValidator(username2) {\n  return /^[a-zA-Z0-9_]+$/.test(username2);\n}\nvar username = (options) => {\n  const ERROR_CODES = {\n    INVALID_USERNAME_OR_PASSWORD: \"invalid username or password\",\n    EMAIL_NOT_VERIFIED: \"email not verified\",\n    UNEXPECTED_ERROR: \"unexpected error\",\n    USERNAME_IS_ALREADY_TAKEN: \"username is already taken. please try another.\",\n    USERNAME_TOO_SHORT: \"username is too short\",\n    USERNAME_TOO_LONG: \"username is too long\",\n    INVALID_USERNAME: \"username is invalid\"\n  };\n  return {\n    id: \"username\",\n    endpoints: {\n      signInUsername: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.createAuthEndpoint)(\n        \"/sign-in/username\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            username: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The username of the user\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The password of the user\"\n            }),\n            rememberMe: zod__WEBPACK_IMPORTED_MODULE_4__.z.boolean({\n              description: \"Remember the user session\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Sign in with username\",\n              description: \"Sign in with username\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!ctx.body.username || !ctx.body.password) {\n            ctx.context.logger.error(\"Username or password not found\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const minUsernameLength = options?.minUsernameLength || 3;\n          const maxUsernameLength = options?.maxUsernameLength || 30;\n          if (ctx.body.username.length < minUsernameLength) {\n            ctx.context.logger.error(\"Username too short\", {\n              username: ctx.body.username\n            });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n              message: ERROR_CODES.USERNAME_TOO_SHORT\n            });\n          }\n          if (ctx.body.username.length > maxUsernameLength) {\n            ctx.context.logger.error(\"Username too long\", {\n              username: ctx.body.username\n            });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n              message: ERROR_CODES.USERNAME_TOO_LONG\n            });\n          }\n          const validator = options?.usernameValidator || defaultUsernameValidator;\n          if (!validator(ctx.body.username)) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n              message: ERROR_CODES.INVALID_USERNAME\n            });\n          }\n          const user = await ctx.context.adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                field: \"username\",\n                value: ctx.body.username.toLowerCase()\n              }\n            ]\n          });\n          if (!user) {\n            await ctx.context.password.hash(ctx.body.password);\n            ctx.context.logger.error(\"User not found\", { username });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          if (!user.emailVerified && ctx.context.options.emailAndPassword?.requireEmailVerification) {\n            await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.sendVerificationEmailFn)(ctx, user);\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"FORBIDDEN\", {\n              message: ERROR_CODES.EMAIL_NOT_VERIFIED\n            });\n          }\n          const account = await ctx.context.adapter.findOne({\n            model: \"account\",\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              },\n              {\n                field: \"providerId\",\n                value: \"credential\"\n              }\n            ]\n          });\n          if (!account) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const currentPassword = account?.password;\n          if (!currentPassword) {\n            ctx.context.logger.error(\"Password not found\", { username });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const validPassword = await ctx.context.password.verify({\n            hash: currentPassword,\n            password: ctx.body.password\n          });\n          if (!validPassword) {\n            ctx.context.logger.error(\"Invalid password\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_USERNAME_OR_PASSWORD\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.request,\n            ctx.body.rememberMe === false\n          );\n          if (!session) {\n            return ctx.json(null, {\n              status: 500,\n              body: {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION,\n                status: 500\n              }\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(\n            ctx,\n            { session, user },\n            ctx.body.rememberMe === false\n          );\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        }\n      )\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.mergeSchema)(schema, options?.schema),\n    hooks: {\n      before: [\n        {\n          matcher(context) {\n            return context.path === \"/sign-up/email\" || context.path === \"/update-user\";\n          },\n          async handler(ctx) {\n            const username2 = ctx.body.username;\n            if (username2) {\n              const minUsernameLength = options?.minUsernameLength || 3;\n              const maxUsernameLength = options?.maxUsernameLength || 30;\n              if (username2.length < minUsernameLength) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.USERNAME_TOO_SHORT\n                });\n              }\n              if (username2.length > maxUsernameLength) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.USERNAME_TOO_LONG\n                });\n              }\n              const validator = options?.usernameValidator || defaultUsernameValidator;\n              const valid = await validator(username2);\n              if (!valid) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.INVALID_USERNAME\n                });\n              }\n              const user = await ctx.context.adapter.findOne({\n                model: \"user\",\n                where: [\n                  {\n                    field: \"username\",\n                    value: username2.toLowerCase()\n                  }\n                ]\n              });\n              if (user) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"UNPROCESSABLE_ENTITY\", {\n                  message: ERROR_CODES.USERNAME_IS_ALREADY_TAKEN\n                });\n              }\n            }\n          }\n        }\n      ]\n    },\n    $ERROR_CODES: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU03QzdUS0lVLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBNkQ7QUFDdUM7QUFDN0M7QUFDTDtBQUMxQjtBQUNlOztBQUV2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHNFQUFrQjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IseUNBQVE7QUFDeEIsc0JBQXNCLHlDQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiLHNCQUFzQix5Q0FBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYix3QkFBd0IsMENBQVM7QUFDakM7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixzQkFBc0IsaURBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EseURBQXlELFVBQVU7QUFDbkUsc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxrQkFBa0IsMkVBQXVCO0FBQ3pDLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxVQUFVO0FBQ3ZFLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLGdFQUFnQjtBQUN6QztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBLGNBQWMsZUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVksK0RBQVc7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsaURBQVE7QUFDbEM7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLDBCQUEwQixpREFBUTtBQUNsQztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixpREFBUTtBQUNsQztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSwwQkFBMEIsaURBQVE7QUFDbEM7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQkFBa0Isc0VBQXNCO0FBQ3hDO0FBQ0E7O0FBRW9CIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstTTdDN1RLSVUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUyB9IGZyb20gJy4vY2h1bmstV01YQkE2TFguanMnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbiwgQkFTRV9FUlJPUl9DT0RFUyB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgbWVyZ2VTY2hlbWEgfSBmcm9tICcuL2NodW5rLVdaNk9JVkpLLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbi8vIHNyYy9wbHVnaW5zL3VzZXJuYW1lL3NjaGVtYS50c1xudmFyIHNjaGVtYSA9IHtcbiAgdXNlcjoge1xuICAgIGZpZWxkczoge1xuICAgICAgdXNlcm5hbWU6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgICByZXR1cm5lZDogdHJ1ZSxcbiAgICAgICAgdHJhbnNmb3JtOiB7XG4gICAgICAgICAgaW5wdXQodmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZT8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuLy8gc3JjL3BsdWdpbnMvdXNlcm5hbWUvaW5kZXgudHNcbmZ1bmN0aW9uIGRlZmF1bHRVc2VybmFtZVZhbGlkYXRvcih1c2VybmFtZTIpIHtcbiAgcmV0dXJuIC9eW2EtekEtWjAtOV9dKyQvLnRlc3QodXNlcm5hbWUyKTtcbn1cbnZhciB1c2VybmFtZSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IEVSUk9SX0NPREVTID0ge1xuICAgIElOVkFMSURfVVNFUk5BTUVfT1JfUEFTU1dPUkQ6IFwiaW52YWxpZCB1c2VybmFtZSBvciBwYXNzd29yZFwiLFxuICAgIEVNQUlMX05PVF9WRVJJRklFRDogXCJlbWFpbCBub3QgdmVyaWZpZWRcIixcbiAgICBVTkVYUEVDVEVEX0VSUk9SOiBcInVuZXhwZWN0ZWQgZXJyb3JcIixcbiAgICBVU0VSTkFNRV9JU19BTFJFQURZX1RBS0VOOiBcInVzZXJuYW1lIGlzIGFscmVhZHkgdGFrZW4uIHBsZWFzZSB0cnkgYW5vdGhlci5cIixcbiAgICBVU0VSTkFNRV9UT09fU0hPUlQ6IFwidXNlcm5hbWUgaXMgdG9vIHNob3J0XCIsXG4gICAgVVNFUk5BTUVfVE9PX0xPTkc6IFwidXNlcm5hbWUgaXMgdG9vIGxvbmdcIixcbiAgICBJTlZBTElEX1VTRVJOQU1FOiBcInVzZXJuYW1lIGlzIGludmFsaWRcIlxuICB9O1xuICByZXR1cm4ge1xuICAgIGlkOiBcInVzZXJuYW1lXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzaWduSW5Vc2VybmFtZTogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9zaWduLWluL3VzZXJuYW1lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VybmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwYXNzd29yZCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlbWVtYmVyTWU6IHouYm9vbGVhbih7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlbWVtYmVyIHRoZSB1c2VyIHNlc3Npb25cIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiU2lnbiBpbiB3aXRoIHVzZXJuYW1lXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gaW4gd2l0aCB1c2VybmFtZVwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGlmICghY3R4LmJvZHkudXNlcm5hbWUgfHwgIWN0eC5ib2R5LnBhc3N3b3JkKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VybmFtZSBvciBwYXNzd29yZCBub3QgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1VTRVJOQU1FX09SX1BBU1NXT1JEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbWluVXNlcm5hbWVMZW5ndGggPSBvcHRpb25zPy5taW5Vc2VybmFtZUxlbmd0aCB8fCAzO1xuICAgICAgICAgIGNvbnN0IG1heFVzZXJuYW1lTGVuZ3RoID0gb3B0aW9ucz8ubWF4VXNlcm5hbWVMZW5ndGggfHwgMzA7XG4gICAgICAgICAgaWYgKGN0eC5ib2R5LnVzZXJuYW1lLmxlbmd0aCA8IG1pblVzZXJuYW1lTGVuZ3RoKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VybmFtZSB0b28gc2hvcnRcIiwge1xuICAgICAgICAgICAgICB1c2VybmFtZTogY3R4LmJvZHkudXNlcm5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSTkFNRV9UT09fU0hPUlRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY3R4LmJvZHkudXNlcm5hbWUubGVuZ3RoID4gbWF4VXNlcm5hbWVMZW5ndGgpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXJuYW1lIHRvbyBsb25nXCIsIHtcbiAgICAgICAgICAgICAgdXNlcm5hbWU6IGN0eC5ib2R5LnVzZXJuYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUk5BTUVfVE9PX0xPTkdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSBvcHRpb25zPy51c2VybmFtZVZhbGlkYXRvciB8fCBkZWZhdWx0VXNlcm5hbWVWYWxpZGF0b3I7XG4gICAgICAgICAgaWYgKCF2YWxpZGF0b3IoY3R4LmJvZHkudXNlcm5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VybmFtZVwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBjdHguYm9keS51c2VybmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmhhc2goY3R4LmJvZHkucGFzc3dvcmQpO1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlciBub3QgZm91bmRcIiwgeyB1c2VybmFtZSB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXVzZXIuZW1haWxWZXJpZmllZCAmJiBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgICAgICAgYXdhaXQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4oY3R4LCB1c2VyKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLkVNQUlMX05PVF9WRVJJRklFRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IFwiY3JlZGVudGlhbFwiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfVVNFUk5BTUVfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBhY2NvdW50Py5wYXNzd29yZDtcbiAgICAgICAgICBpZiAoIWN1cnJlbnRQYXNzd29yZCkge1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgbm90IGZvdW5kXCIsIHsgdXNlcm5hbWUgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1VTRVJOQU1FX09SX1BBU1NXT1JEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdmFsaWRQYXNzd29yZCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgICAgICAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgICAgICAgICBwYXNzd29yZDogY3R4LmJvZHkucGFzc3dvcmRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIXZhbGlkUGFzc3dvcmQpIHtcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkludmFsaWQgcGFzc3dvcmRcIik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1VTRVJOQU1FX09SX1BBU1NXT1JEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0LFxuICAgICAgICAgICAgY3R4LmJvZHkucmVtZW1iZXJNZSA9PT0gZmFsc2VcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHtcbiAgICAgICAgICAgICAgc3RhdHVzOiA1MDAsXG4gICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTixcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgICAgICAgIGN0eCxcbiAgICAgICAgICAgIHsgc2Vzc2lvbiwgdXNlciB9LFxuICAgICAgICAgICAgY3R4LmJvZHkucmVtZW1iZXJNZSA9PT0gZmFsc2VcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogdXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogdXNlci51cGRhdGVkQXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgc2NoZW1hOiBtZXJnZVNjaGVtYShzY2hlbWEsIG9wdGlvbnM/LnNjaGVtYSksXG4gICAgaG9va3M6IHtcbiAgICAgIGJlZm9yZTogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcihjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5wYXRoID09PSBcIi9zaWduLXVwL2VtYWlsXCIgfHwgY29udGV4dC5wYXRoID09PSBcIi91cGRhdGUtdXNlclwiO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgaGFuZGxlcihjdHgpIHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJuYW1lMiA9IGN0eC5ib2R5LnVzZXJuYW1lO1xuICAgICAgICAgICAgaWYgKHVzZXJuYW1lMikge1xuICAgICAgICAgICAgICBjb25zdCBtaW5Vc2VybmFtZUxlbmd0aCA9IG9wdGlvbnM/Lm1pblVzZXJuYW1lTGVuZ3RoIHx8IDM7XG4gICAgICAgICAgICAgIGNvbnN0IG1heFVzZXJuYW1lTGVuZ3RoID0gb3B0aW9ucz8ubWF4VXNlcm5hbWVMZW5ndGggfHwgMzA7XG4gICAgICAgICAgICAgIGlmICh1c2VybmFtZTIubGVuZ3RoIDwgbWluVXNlcm5hbWVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5VU0VSTkFNRV9UT09fU0hPUlRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAodXNlcm5hbWUyLmxlbmd0aCA+IG1heFVzZXJuYW1lTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUk5BTUVfVE9PX0xPTkdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSBvcHRpb25zPy51c2VybmFtZVZhbGlkYXRvciB8fCBkZWZhdWx0VXNlcm5hbWVWYWxpZGF0b3I7XG4gICAgICAgICAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgdmFsaWRhdG9yKHVzZXJuYW1lMik7XG4gICAgICAgICAgICAgIGlmICghdmFsaWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1VTRVJOQU1FXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJuYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VybmFtZTIudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUk5BTUVfSVNfQUxSRUFEWV9UQUtFTlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSxcbiAgICAkRVJST1JfQ09ERVM6IFRXT19GQUNUT1JfRVJST1JfQ09ERVNcbiAgfTtcbn07XG5cbmV4cG9ydCB7IHVzZXJuYW1lIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   genericOAuth: () => (/* binding */ genericOAuth)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/decode_jwt.js\");\n\n\n\n\n\n\n\n\n\nasync function getUserInfo(tokens, finalUserInfoUrl) {\n  if (tokens.idToken) {\n    const decoded = (0,jose__WEBPACK_IMPORTED_MODULE_7__.decodeJwt)(tokens.idToken);\n    if (decoded) {\n      if (decoded.sub && decoded.email) {\n        return {\n          id: decoded.sub,\n          emailVerified: decoded.email_verified,\n          image: decoded.picture,\n          ...decoded\n        };\n      }\n    }\n  }\n  if (!finalUserInfoUrl) {\n    return null;\n  }\n  const userInfo = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(finalUserInfoUrl, {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${tokens.accessToken}`\n    }\n  });\n  return {\n    id: userInfo.data?.sub,\n    emailVerified: userInfo.data?.email_verified,\n    email: userInfo.data?.email,\n    image: userInfo.data?.picture,\n    name: userInfo.data?.name,\n    ...userInfo.data\n  };\n}\nvar genericOAuth = (options) => {\n  const ERROR_CODES = {\n    INVALID_OAUTH_CONFIGURATION: \"Invalid OAuth configuration\"\n  };\n  return {\n    id: \"generic-oauth\",\n    init: (ctx) => {\n      const genericProviders = options.config.map((c) => {\n        let finalUserInfoUrl = c.userInfoUrl;\n        return {\n          id: c.providerId,\n          name: c.providerId,\n          createAuthorizationURL(data) {\n            return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.createAuthorizationURL)({\n              id: c.providerId,\n              options: {\n                clientId: c.clientId,\n                clientSecret: c.clientSecret,\n                redirectURI: c.redirectURI\n              },\n              authorizationEndpoint: c.authorizationUrl,\n              state: data.state,\n              codeVerifier: c.pkce ? data.codeVerifier : void 0,\n              scopes: c.scopes || [],\n              redirectURI: `${ctx.baseURL}/oauth2/callback/${c.providerId}`\n            });\n          },\n          async validateAuthorizationCode(data) {\n            let finalTokenUrl = c.tokenUrl;\n            if (c.discoveryUrl) {\n              const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(c.discoveryUrl, {\n                method: \"GET\"\n              });\n              if (discovery.data) {\n                finalTokenUrl = discovery.data.token_endpoint;\n                finalUserInfoUrl = discovery.data.userinfo_endpoint;\n              }\n            }\n            if (!finalTokenUrl) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n                message: \"Invalid OAuth configuration. Token URL not found.\"\n              });\n            }\n            return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.validateAuthorizationCode)({\n              code: data.code,\n              codeVerifier: data.codeVerifier,\n              redirectURI: data.redirectURI,\n              options: {\n                clientId: c.clientId,\n                clientSecret: c.clientSecret,\n                redirectURI: c.redirectURI\n              },\n              tokenEndpoint: finalTokenUrl\n            });\n          },\n          async getUserInfo(tokens) {\n            if (!finalUserInfoUrl) {\n              return null;\n            }\n            const userInfo = c.getUserInfo ? await c.getUserInfo(tokens) : await getUserInfo(tokens, finalUserInfoUrl);\n            if (!userInfo) {\n              return null;\n            }\n            return {\n              user: {\n                id: userInfo?.id,\n                email: userInfo?.email,\n                emailVerified: userInfo?.emailVerified,\n                image: userInfo?.image,\n                name: userInfo?.name,\n                ...c.mapProfileToUser?.(userInfo)\n              },\n              data: userInfo\n            };\n          }\n        };\n      });\n      return {\n        context: {\n          socialProviders: genericProviders.concat(ctx.socialProviders)\n        }\n      };\n    },\n    endpoints: {\n      signInWithOAuth2: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/oauth2\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            providerId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The provider ID for the OAuth provider\"\n            }),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The URL to redirect to after sign in\"\n            }).optional(),\n            errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The URL to redirect to if an error occurs\"\n            }).optional(),\n            newUserCallbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The URL to redirect to after login if the user is new\"\n            }).optional(),\n            disableRedirect: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean({\n              description: \"Disable redirect\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              description: \"Sign in with OAuth2\",\n              responses: {\n                200: {\n                  description: \"Sign in with OAuth2\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          url: {\n                            type: \"string\"\n                          },\n                          redirect: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { providerId } = ctx.body;\n          const config = options.config.find(\n            (c) => c.providerId === providerId\n          );\n          if (!config) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: `No config found for provider ${providerId}`\n            });\n          }\n          const {\n            discoveryUrl,\n            authorizationUrl,\n            tokenUrl,\n            clientId,\n            clientSecret,\n            scopes,\n            redirectURI,\n            responseType,\n            pkce,\n            prompt,\n            accessType,\n            authorizationUrlParams\n          } = config;\n          let finalAuthUrl = authorizationUrl;\n          let finalTokenUrl = tokenUrl;\n          if (discoveryUrl) {\n            const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(discoveryUrl, {\n              onError(context) {\n                ctx.context.logger.error(context.error.message, context.error, {\n                  discoveryUrl\n                });\n              }\n            });\n            if (discovery.data) {\n              finalAuthUrl = discovery.data.authorization_endpoint;\n              finalTokenUrl = discovery.data.token_endpoint;\n            }\n          }\n          if (!finalAuthUrl || !finalTokenUrl) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OAUTH_CONFIGURATION\n            });\n          }\n          if (authorizationUrlParams) {\n            const withAdditionalParams = new URL(finalAuthUrl);\n            for (const [paramName, paramValue] of Object.entries(\n              authorizationUrlParams\n            )) {\n              withAdditionalParams.searchParams.set(paramName, paramValue);\n            }\n            finalAuthUrl = withAdditionalParams.toString();\n          }\n          const { state, codeVerifier } = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__.generateState)(ctx);\n          const authUrl = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.createAuthorizationURL)({\n            id: providerId,\n            options: {\n              clientId,\n              clientSecret,\n              redirectURI\n            },\n            authorizationEndpoint: finalAuthUrl,\n            state,\n            codeVerifier: pkce ? codeVerifier : void 0,\n            scopes: scopes || [],\n            redirectURI: `${ctx.context.baseURL}/oauth2/callback/${providerId}`\n          });\n          if (responseType && responseType !== \"code\") {\n            authUrl.searchParams.set(\"response_type\", responseType);\n          }\n          if (prompt) {\n            authUrl.searchParams.set(\"prompt\", prompt);\n          }\n          if (accessType) {\n            authUrl.searchParams.set(\"access_type\", accessType);\n          }\n          return ctx.json({\n            url: authUrl.toString(),\n            redirect: !ctx.body.disableRedirect\n          });\n        }\n      ),\n      oAuth2Callback: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/callback/:providerId\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The OAuth2 code\"\n            }).optional(),\n            error: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The error message, if any\"\n            }).optional(),\n            state: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"The state parameter from the OAuth2 request\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              description: \"OAuth2 callback\",\n              responses: {\n                200: {\n                  description: \"OAuth2 callback\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          url: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (ctx.query.error || !ctx.query.code) {\n            throw ctx.redirect(\n              `${ctx.context.options.baseURL}?error=${ctx.query.error || \"oAuth_code_missing\"}`\n            );\n          }\n          const provider = options.config.find(\n            (p) => p.providerId === ctx.params.providerId\n          );\n          if (!provider) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: `No config found for provider ${ctx.params.providerId}`\n            });\n          }\n          let tokens = void 0;\n          const parsedState = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__.parseState)(ctx);\n          const { callbackURL, codeVerifier, errorURL, newUserURL, link } = parsedState;\n          const code = ctx.query.code;\n          let finalTokenUrl = provider.tokenUrl;\n          let finalUserInfoUrl = provider.userInfoUrl;\n          if (provider.discoveryUrl) {\n            const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(provider.discoveryUrl, {\n              method: \"GET\"\n            });\n            if (discovery.data) {\n              finalTokenUrl = discovery.data.token_endpoint;\n              finalUserInfoUrl = discovery.data.userinfo_endpoint;\n            }\n          }\n          try {\n            if (!finalTokenUrl) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n                message: \"Invalid OAuth configuration.\"\n              });\n            }\n            tokens = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.validateAuthorizationCode)({\n              code,\n              codeVerifier: provider.pkce ? codeVerifier : void 0,\n              redirectURI: `${ctx.context.baseURL}/oauth2/callback/${provider.providerId}`,\n              options: {\n                clientId: provider.clientId,\n                clientSecret: provider.clientSecret,\n                redirectURI: provider.redirectURI\n              },\n              tokenEndpoint: finalTokenUrl\n            });\n          } catch (e) {\n            ctx.context.logger.error(\n              e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n              e\n            );\n            throw ctx.redirect(\n              `${errorURL}?error=oauth_code_verification_failed`\n            );\n          }\n          if (!tokens) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: \"Invalid OAuth configuration.\"\n            });\n          }\n          const userInfo = provider.getUserInfo ? await provider.getUserInfo(tokens) : await getUserInfo(tokens, finalUserInfoUrl);\n          if (!userInfo?.email) {\n            ctx.context.logger.error(\"Unable to get user info\", userInfo);\n            throw ctx.redirect(\n              `${ctx.context.baseURL}/error?error=email_is_missing`\n            );\n          }\n          const mapUser = provider.mapProfileToUser ? await provider.mapProfileToUser(userInfo) : null;\n          if (link) {\n            if (ctx.context.options.account?.accountLinking?.allowDifferentEmails !== true && link.email !== userInfo.email.toLowerCase()) {\n              return redirectOnError(\"email_doesn't_match\");\n            }\n            const newAccount = await ctx.context.internalAdapter.createAccount({\n              userId: link.userId,\n              providerId: provider.providerId,\n              accountId: userInfo.id\n            });\n            if (!newAccount) {\n              return redirectOnError(\"unable_to_link_account\");\n            }\n            let toRedirectTo2;\n            try {\n              const url = callbackURL;\n              toRedirectTo2 = url.toString();\n            } catch {\n              toRedirectTo2 = callbackURL;\n            }\n            throw ctx.redirect(toRedirectTo2);\n          }\n          const result = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.handleOAuthUserInfo)(ctx, {\n            userInfo: {\n              ...userInfo,\n              ...mapUser\n            },\n            account: {\n              providerId: provider.providerId,\n              accountId: userInfo.id,\n              ...tokens,\n              scope: tokens.scopes?.join(\",\")\n            }\n          });\n          function redirectOnError(error) {\n            throw ctx.redirect(\n              `${errorURL || callbackURL || `${ctx.context.baseURL}/error`}?error=${error}`\n            );\n          }\n          if (result.error) {\n            return redirectOnError(result.error.split(\" \").join(\"_\"));\n          }\n          const { session, user } = result.data;\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n            session,\n            user\n          });\n          let toRedirectTo;\n          try {\n            const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n            toRedirectTo = url.toString();\n          } catch {\n            toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n          }\n          throw ctx.redirect(toRedirectTo);\n        }\n      ),\n      oAuth2LinkAccount: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/oauth2/link\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            providerId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string(),\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_6__.z.string()\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.sessionMiddleware]\n        },\n        async (c) => {\n          const session = c.context.session;\n          const account = await c.context.internalAdapter.findAccounts(\n            session.user.id\n          );\n          const existingAccount = account.find(\n            (a) => a.providerId === c.body.providerId\n          );\n          if (existingAccount) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.SOCIAL_ACCOUNT_ALREADY_LINKED\n            });\n          }\n          const provider = options.config.find(\n            (p) => p.providerId === c.body.providerId\n          );\n          if (!provider) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"NOT_FOUND\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n            });\n          }\n          const {\n            providerId,\n            clientId,\n            clientSecret,\n            redirectURI,\n            authorizationUrl,\n            discoveryUrl,\n            pkce,\n            scopes\n          } = provider;\n          let finalAuthUrl = authorizationUrl;\n          if (!finalAuthUrl) {\n            if (!discoveryUrl) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.INVALID_OAUTH_CONFIGURATION\n              });\n            }\n            const discovery = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(discoveryUrl, {\n              onError(context) {\n                c.context.logger.error(context.error.message, context.error, {\n                  discoveryUrl\n                });\n              }\n            });\n            if (discovery.data) {\n              finalAuthUrl = discovery.data.authorization_endpoint;\n            }\n          }\n          if (!finalAuthUrl) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_5__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.INVALID_OAUTH_CONFIGURATION\n            });\n          }\n          const state = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_3__.generateState)(c, {\n            userId: session.user.id,\n            email: session.user.email\n          });\n          const url = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_1__.createAuthorizationURL)({\n            id: providerId,\n            options: {\n              clientId,\n              clientSecret,\n              redirectURI: redirectURI || `${c.context.baseURL}/oauth2/callback`\n            },\n            authorizationEndpoint: finalAuthUrl,\n            state: state.state,\n            codeVerifier: pkce ? state.codeVerifier : void 0,\n            scopes: scopes || [],\n            redirectURI: `${c.context.baseURL}/oauth2/callback/${providerId}`\n          });\n          return c.json({\n            url: url.toString(),\n            redirect: true\n          });\n        }\n      )\n    },\n    $ERROR_CODES: ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU5JVVc0V0Y3LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFtSDtBQUMzQjtBQUNqQztBQUNTO0FBQ2Q7QUFDWDtBQUNmO0FBQ1M7O0FBRWpDO0FBQ0E7QUFDQSxvQkFBb0IsK0NBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixnRUFBVztBQUNwQztBQUNBO0FBQ0EsK0JBQStCLG1CQUFtQjtBQUNsRDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwwRUFBc0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixZQUFZLG1CQUFtQixhQUFhO0FBQzFFLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGdFQUFXO0FBQ2pEO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpREFBUTtBQUNoQztBQUNBLGVBQWU7QUFDZjtBQUNBLG1CQUFtQiw2RUFBeUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNB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O0FBQy9DO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlEQUFRO0FBQzlCO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsOEJBQThCLGlFQUFhO0FBQzNDO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsNEJBQTRCLDBFQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxrQkFBa0I7QUFDL0QsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGtCQUFrQixtQkFBbUIsV0FBVztBQUM1RSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUV3QiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU5JVVc0V0Y3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgaGFuZGxlT0F1dGhVc2VySW5mbywgc2Vzc2lvbk1pZGRsZXdhcmUsIEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwsIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUgfSBmcm9tICcuL2NodW5rLUdUUU03SlU3LmpzJztcbmltcG9ydCB7IHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlU3RhdGUsIHBhcnNlU3RhdGUgfSBmcm9tICcuL2NodW5rLU5QTzY0U1ZOLmpzJztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgZGVjb2RlSnd0IH0gZnJvbSAnam9zZSc7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFVzZXJJbmZvKHRva2VucywgZmluYWxVc2VySW5mb1VybCkge1xuICBpZiAodG9rZW5zLmlkVG9rZW4pIHtcbiAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlSnd0KHRva2Vucy5pZFRva2VuKTtcbiAgICBpZiAoZGVjb2RlZCkge1xuICAgICAgaWYgKGRlY29kZWQuc3ViICYmIGRlY29kZWQuZW1haWwpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogZGVjb2RlZC5zdWIsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZGVjb2RlZC5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICBpbWFnZTogZGVjb2RlZC5waWN0dXJlLFxuICAgICAgICAgIC4uLmRlY29kZWRcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKCFmaW5hbFVzZXJJbmZvVXJsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgdXNlckluZm8gPSBhd2FpdCBiZXR0ZXJGZXRjaChmaW5hbFVzZXJJbmZvVXJsLCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbnMuYWNjZXNzVG9rZW59YFxuICAgIH1cbiAgfSk7XG4gIHJldHVybiB7XG4gICAgaWQ6IHVzZXJJbmZvLmRhdGE/LnN1YixcbiAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby5kYXRhPy5lbWFpbF92ZXJpZmllZCxcbiAgICBlbWFpbDogdXNlckluZm8uZGF0YT8uZW1haWwsXG4gICAgaW1hZ2U6IHVzZXJJbmZvLmRhdGE/LnBpY3R1cmUsXG4gICAgbmFtZTogdXNlckluZm8uZGF0YT8ubmFtZSxcbiAgICAuLi51c2VySW5mby5kYXRhXG4gIH07XG59XG52YXIgZ2VuZXJpY09BdXRoID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgSU5WQUxJRF9PQVVUSF9DT05GSUdVUkFUSU9OOiBcIkludmFsaWQgT0F1dGggY29uZmlndXJhdGlvblwiXG4gIH07XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZ2VuZXJpYy1vYXV0aFwiLFxuICAgIGluaXQ6IChjdHgpID0+IHtcbiAgICAgIGNvbnN0IGdlbmVyaWNQcm92aWRlcnMgPSBvcHRpb25zLmNvbmZpZy5tYXAoKGMpID0+IHtcbiAgICAgICAgbGV0IGZpbmFsVXNlckluZm9VcmwgPSBjLnVzZXJJbmZvVXJsO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBjLnByb3ZpZGVySWQsXG4gICAgICAgICAgbmFtZTogYy5wcm92aWRlcklkLFxuICAgICAgICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICAgICAgICBpZDogYy5wcm92aWRlcklkLFxuICAgICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgY2xpZW50SWQ6IGMuY2xpZW50SWQsXG4gICAgICAgICAgICAgICAgY2xpZW50U2VjcmV0OiBjLmNsaWVudFNlY3JldCxcbiAgICAgICAgICAgICAgICByZWRpcmVjdFVSSTogYy5yZWRpcmVjdFVSSVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IGMuYXV0aG9yaXphdGlvblVybCxcbiAgICAgICAgICAgICAgc3RhdGU6IGRhdGEuc3RhdGUsXG4gICAgICAgICAgICAgIGNvZGVWZXJpZmllcjogYy5wa2NlID8gZGF0YS5jb2RlVmVyaWZpZXIgOiB2b2lkIDAsXG4gICAgICAgICAgICAgIHNjb3BlczogYy5zY29wZXMgfHwgW10sXG4gICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiBgJHtjdHguYmFzZVVSTH0vb2F1dGgyL2NhbGxiYWNrLyR7Yy5wcm92aWRlcklkfWBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZShkYXRhKSB7XG4gICAgICAgICAgICBsZXQgZmluYWxUb2tlblVybCA9IGMudG9rZW5Vcmw7XG4gICAgICAgICAgICBpZiAoYy5kaXNjb3ZlcnlVcmwpIHtcbiAgICAgICAgICAgICAgY29uc3QgZGlzY292ZXJ5ID0gYXdhaXQgYmV0dGVyRmV0Y2goYy5kaXNjb3ZlcnlVcmwsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGlmIChkaXNjb3ZlcnkuZGF0YSkge1xuICAgICAgICAgICAgICAgIGZpbmFsVG9rZW5VcmwgPSBkaXNjb3ZlcnkuZGF0YS50b2tlbl9lbmRwb2ludDtcbiAgICAgICAgICAgICAgICBmaW5hbFVzZXJJbmZvVXJsID0gZGlzY292ZXJ5LmRhdGEudXNlcmluZm9fZW5kcG9pbnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZmluYWxUb2tlblVybCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIE9BdXRoIGNvbmZpZ3VyYXRpb24uIFRva2VuIFVSTCBub3QgZm91bmQuXCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgICAgICAgIGNvZGU6IGRhdGEuY29kZSxcbiAgICAgICAgICAgICAgY29kZVZlcmlmaWVyOiBkYXRhLmNvZGVWZXJpZmllcixcbiAgICAgICAgICAgICAgcmVkaXJlY3RVUkk6IGRhdGEucmVkaXJlY3RVUkksXG4gICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBjbGllbnRJZDogYy5jbGllbnRJZCxcbiAgICAgICAgICAgICAgICBjbGllbnRTZWNyZXQ6IGMuY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiBjLnJlZGlyZWN0VVJJXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRva2VuRW5kcG9pbnQ6IGZpbmFsVG9rZW5VcmxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW5zKSB7XG4gICAgICAgICAgICBpZiAoIWZpbmFsVXNlckluZm9VcmwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB1c2VySW5mbyA9IGMuZ2V0VXNlckluZm8gPyBhd2FpdCBjLmdldFVzZXJJbmZvKHRva2VucykgOiBhd2FpdCBnZXRVc2VySW5mbyh0b2tlbnMsIGZpbmFsVXNlckluZm9VcmwpO1xuICAgICAgICAgICAgaWYgKCF1c2VySW5mbykge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogdXNlckluZm8/LmlkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VySW5mbz8uZW1haWwsXG4gICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlckluZm8/LmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgICAgaW1hZ2U6IHVzZXJJbmZvPy5pbWFnZSxcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VySW5mbz8ubmFtZSxcbiAgICAgICAgICAgICAgICAuLi5jLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VySW5mbylcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGF0YTogdXNlckluZm9cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgc29jaWFsUHJvdmlkZXJzOiBnZW5lcmljUHJvdmlkZXJzLmNvbmNhdChjdHguc29jaWFsUHJvdmlkZXJzKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzaWduSW5XaXRoT0F1dGgyOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3NpZ24taW4vb2F1dGgyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHByb3ZpZGVyIElEIGZvciB0aGUgT0F1dGggcHJvdmlkZXJcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHNpZ24gaW5cIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGVycm9yQ2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBpZiBhbiBlcnJvciBvY2N1cnNcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIG5ld1VzZXJDYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIGxvZ2luIGlmIHRoZSB1c2VyIGlzIG5ld1wiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgZGlzYWJsZVJlZGlyZWN0OiB6LmJvb2xlYW4oe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJEaXNhYmxlIHJlZGlyZWN0XCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggT0F1dGgyXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIE9BdXRoMlwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB7IHByb3ZpZGVySWQgfSA9IGN0eC5ib2R5O1xuICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IG9wdGlvbnMuY29uZmlnLmZpbmQoXG4gICAgICAgICAgICAoYykgPT4gYy5wcm92aWRlcklkID09PSBwcm92aWRlcklkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIWNvbmZpZykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBgTm8gY29uZmlnIGZvdW5kIGZvciBwcm92aWRlciAke3Byb3ZpZGVySWR9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGRpc2NvdmVyeVVybCxcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb25VcmwsXG4gICAgICAgICAgICB0b2tlblVybCxcbiAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICAgICAgY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgc2NvcGVzLFxuICAgICAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgICAgICByZXNwb25zZVR5cGUsXG4gICAgICAgICAgICBwa2NlLFxuICAgICAgICAgICAgcHJvbXB0LFxuICAgICAgICAgICAgYWNjZXNzVHlwZSxcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb25VcmxQYXJhbXNcbiAgICAgICAgICB9ID0gY29uZmlnO1xuICAgICAgICAgIGxldCBmaW5hbEF1dGhVcmwgPSBhdXRob3JpemF0aW9uVXJsO1xuICAgICAgICAgIGxldCBmaW5hbFRva2VuVXJsID0gdG9rZW5Vcmw7XG4gICAgICAgICAgaWYgKGRpc2NvdmVyeVVybCkge1xuICAgICAgICAgICAgY29uc3QgZGlzY292ZXJ5ID0gYXdhaXQgYmV0dGVyRmV0Y2goZGlzY292ZXJ5VXJsLCB7XG4gICAgICAgICAgICAgIG9uRXJyb3IoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihjb250ZXh0LmVycm9yLm1lc3NhZ2UsIGNvbnRleHQuZXJyb3IsIHtcbiAgICAgICAgICAgICAgICAgIGRpc2NvdmVyeVVybFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChkaXNjb3ZlcnkuZGF0YSkge1xuICAgICAgICAgICAgICBmaW5hbEF1dGhVcmwgPSBkaXNjb3ZlcnkuZGF0YS5hdXRob3JpemF0aW9uX2VuZHBvaW50O1xuICAgICAgICAgICAgICBmaW5hbFRva2VuVXJsID0gZGlzY292ZXJ5LmRhdGEudG9rZW5fZW5kcG9pbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZmluYWxBdXRoVXJsIHx8ICFmaW5hbFRva2VuVXJsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT0FVVEhfQ09ORklHVVJBVElPTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhdXRob3JpemF0aW9uVXJsUGFyYW1zKSB7XG4gICAgICAgICAgICBjb25zdCB3aXRoQWRkaXRpb25hbFBhcmFtcyA9IG5ldyBVUkwoZmluYWxBdXRoVXJsKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW3BhcmFtTmFtZSwgcGFyYW1WYWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoXG4gICAgICAgICAgICAgIGF1dGhvcml6YXRpb25VcmxQYXJhbXNcbiAgICAgICAgICAgICkpIHtcbiAgICAgICAgICAgICAgd2l0aEFkZGl0aW9uYWxQYXJhbXMuc2VhcmNoUGFyYW1zLnNldChwYXJhbU5hbWUsIHBhcmFtVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxBdXRoVXJsID0gd2l0aEFkZGl0aW9uYWxQYXJhbXMudG9TdHJpbmcoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgeyBzdGF0ZSwgY29kZVZlcmlmaWVyIH0gPSBhd2FpdCBnZW5lcmF0ZVN0YXRlKGN0eCk7XG4gICAgICAgICAgY29uc3QgYXV0aFVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICAgICAgaWQ6IHByb3ZpZGVySWQsXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICAgICAgICBjbGllbnRTZWNyZXQsXG4gICAgICAgICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBmaW5hbEF1dGhVcmwsXG4gICAgICAgICAgICBzdGF0ZSxcbiAgICAgICAgICAgIGNvZGVWZXJpZmllcjogcGtjZSA/IGNvZGVWZXJpZmllciA6IHZvaWQgMCxcbiAgICAgICAgICAgIHNjb3Blczogc2NvcGVzIHx8IFtdLFxuICAgICAgICAgICAgcmVkaXJlY3RVUkk6IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L29hdXRoMi9jYWxsYmFjay8ke3Byb3ZpZGVySWR9YFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmIChyZXNwb25zZVR5cGUgJiYgcmVzcG9uc2VUeXBlICE9PSBcImNvZGVcIikge1xuICAgICAgICAgICAgYXV0aFVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVzcG9uc2VfdHlwZVwiLCByZXNwb25zZVR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocHJvbXB0KSB7XG4gICAgICAgICAgICBhdXRoVXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJwcm9tcHRcIiwgcHJvbXB0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGFjY2Vzc1R5cGUpIHtcbiAgICAgICAgICAgIGF1dGhVcmwuc2VhcmNoUGFyYW1zLnNldChcImFjY2Vzc190eXBlXCIsIGFjY2Vzc1R5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdXJsOiBhdXRoVXJsLnRvU3RyaW5nKCksXG4gICAgICAgICAgICByZWRpcmVjdDogIWN0eC5ib2R5LmRpc2FibGVSZWRpcmVjdFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgb0F1dGgyQ2FsbGJhY2s6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvb2F1dGgyL2NhbGxiYWNrLzpwcm92aWRlcklkXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGNvZGU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIE9BdXRoMiBjb2RlXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBlcnJvcjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZXJyb3IgbWVzc2FnZSwgaWYgYW55XCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBzdGF0ZTogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgc3RhdGUgcGFyYW1ldGVyIGZyb20gdGhlIE9BdXRoMiByZXF1ZXN0XCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJPQXV0aDIgY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJPQXV0aDIgY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGlmIChjdHgucXVlcnkuZXJyb3IgfHwgIWN0eC5xdWVyeS5jb2RlKSB7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgICAgICAgIGAke2N0eC5jb250ZXh0Lm9wdGlvbnMuYmFzZVVSTH0/ZXJyb3I9JHtjdHgucXVlcnkuZXJyb3IgfHwgXCJvQXV0aF9jb2RlX21pc3NpbmdcIn1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBwcm92aWRlciA9IG9wdGlvbnMuY29uZmlnLmZpbmQoXG4gICAgICAgICAgICAocCkgPT4gcC5wcm92aWRlcklkID09PSBjdHgucGFyYW1zLnByb3ZpZGVySWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogYE5vIGNvbmZpZyBmb3VuZCBmb3IgcHJvdmlkZXIgJHtjdHgucGFyYW1zLnByb3ZpZGVySWR9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCB0b2tlbnMgPSB2b2lkIDA7XG4gICAgICAgICAgY29uc3QgcGFyc2VkU3RhdGUgPSBhd2FpdCBwYXJzZVN0YXRlKGN0eCk7XG4gICAgICAgICAgY29uc3QgeyBjYWxsYmFja1VSTCwgY29kZVZlcmlmaWVyLCBlcnJvclVSTCwgbmV3VXNlclVSTCwgbGluayB9ID0gcGFyc2VkU3RhdGU7XG4gICAgICAgICAgY29uc3QgY29kZSA9IGN0eC5xdWVyeS5jb2RlO1xuICAgICAgICAgIGxldCBmaW5hbFRva2VuVXJsID0gcHJvdmlkZXIudG9rZW5Vcmw7XG4gICAgICAgICAgbGV0IGZpbmFsVXNlckluZm9VcmwgPSBwcm92aWRlci51c2VySW5mb1VybDtcbiAgICAgICAgICBpZiAocHJvdmlkZXIuZGlzY292ZXJ5VXJsKSB7XG4gICAgICAgICAgICBjb25zdCBkaXNjb3ZlcnkgPSBhd2FpdCBiZXR0ZXJGZXRjaChwcm92aWRlci5kaXNjb3ZlcnlVcmwsIHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChkaXNjb3ZlcnkuZGF0YSkge1xuICAgICAgICAgICAgICBmaW5hbFRva2VuVXJsID0gZGlzY292ZXJ5LmRhdGEudG9rZW5fZW5kcG9pbnQ7XG4gICAgICAgICAgICAgIGZpbmFsVXNlckluZm9VcmwgPSBkaXNjb3ZlcnkuZGF0YS51c2VyaW5mb19lbmRwb2ludDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghZmluYWxUb2tlblVybCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIE9BdXRoIGNvbmZpZ3VyYXRpb24uXCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b2tlbnMgPSBhd2FpdCB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgY29kZVZlcmlmaWVyOiBwcm92aWRlci5wa2NlID8gY29kZVZlcmlmaWVyIDogdm9pZCAwLFxuICAgICAgICAgICAgICByZWRpcmVjdFVSSTogYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vb2F1dGgyL2NhbGxiYWNrLyR7cHJvdmlkZXIucHJvdmlkZXJJZH1gLFxuICAgICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgY2xpZW50SWQ6IHByb3ZpZGVyLmNsaWVudElkLFxuICAgICAgICAgICAgICAgIGNsaWVudFNlY3JldDogcHJvdmlkZXIuY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VVJJOiBwcm92aWRlci5yZWRpcmVjdFVSSVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0b2tlbkVuZHBvaW50OiBmaW5hbFRva2VuVXJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgIGUgJiYgdHlwZW9mIGUgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZSA/IGUubmFtZSA6IFwiXCIsXG4gICAgICAgICAgICAgIGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgICAgICAgIGAke2Vycm9yVVJMfT9lcnJvcj1vYXV0aF9jb2RlX3ZlcmlmaWNhdGlvbl9mYWlsZWRgXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXRva2Vucykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgT0F1dGggY29uZmlndXJhdGlvbi5cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXJJbmZvID0gcHJvdmlkZXIuZ2V0VXNlckluZm8gPyBhd2FpdCBwcm92aWRlci5nZXRVc2VySW5mbyh0b2tlbnMpIDogYXdhaXQgZ2V0VXNlckluZm8odG9rZW5zLCBmaW5hbFVzZXJJbmZvVXJsKTtcbiAgICAgICAgICBpZiAoIXVzZXJJbmZvPy5lbWFpbCkge1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVW5hYmxlIHRvIGdldCB1c2VyIGluZm9cIiwgdXNlckluZm8pO1xuICAgICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgICAgICAgICBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1lbWFpbF9pc19taXNzaW5nYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbWFwVXNlciA9IHByb3ZpZGVyLm1hcFByb2ZpbGVUb1VzZXIgPyBhd2FpdCBwcm92aWRlci5tYXBQcm9maWxlVG9Vc2VyKHVzZXJJbmZvKSA6IG51bGw7XG4gICAgICAgICAgaWYgKGxpbmspIHtcbiAgICAgICAgICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5hbGxvd0RpZmZlcmVudEVtYWlscyAhPT0gdHJ1ZSAmJiBsaW5rLmVtYWlsICE9PSB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJlbWFpbF9kb2Vzbid0X21hdGNoXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbmV3QWNjb3VudCA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVBY2NvdW50KHtcbiAgICAgICAgICAgICAgdXNlcklkOiBsaW5rLnVzZXJJZCxcbiAgICAgICAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIucHJvdmlkZXJJZCxcbiAgICAgICAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIW5ld0FjY291bnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYWJsZV90b19saW5rX2FjY291bnRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgdG9SZWRpcmVjdFRvMjtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IHVybCA9IGNhbGxiYWNrVVJMO1xuICAgICAgICAgICAgICB0b1JlZGlyZWN0VG8yID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgdG9SZWRpcmVjdFRvMiA9IGNhbGxiYWNrVVJMO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KHRvUmVkaXJlY3RUbzIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVPQXV0aFVzZXJJbmZvKGN0eCwge1xuICAgICAgICAgICAgdXNlckluZm86IHtcbiAgICAgICAgICAgICAgLi4udXNlckluZm8sXG4gICAgICAgICAgICAgIC4uLm1hcFVzZXJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhY2NvdW50OiB7XG4gICAgICAgICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLnByb3ZpZGVySWQsXG4gICAgICAgICAgICAgIGFjY291bnRJZDogdXNlckluZm8uaWQsXG4gICAgICAgICAgICAgIC4uLnRva2VucyxcbiAgICAgICAgICAgICAgc2NvcGU6IHRva2Vucy5zY29wZXM/LmpvaW4oXCIsXCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZnVuY3Rpb24gcmVkaXJlY3RPbkVycm9yKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgICAgICAgIGAke2Vycm9yVVJMIHx8IGNhbGxiYWNrVVJMIHx8IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYH0/ZXJyb3I9JHtlcnJvcn1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKHJlc3VsdC5lcnJvci5zcGxpdChcIiBcIikuam9pbihcIl9cIikpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB7IHNlc3Npb24sIHVzZXIgfSA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgICAgdXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGxldCB0b1JlZGlyZWN0VG87XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IHJlc3VsdC5pc1JlZ2lzdGVyID8gbmV3VXNlclVSTCB8fCBjYWxsYmFja1VSTCA6IGNhbGxiYWNrVVJMO1xuICAgICAgICAgICAgdG9SZWRpcmVjdFRvID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICB0b1JlZGlyZWN0VG8gPSByZXN1bHQuaXNSZWdpc3RlciA/IG5ld1VzZXJVUkwgfHwgY2FsbGJhY2tVUkwgOiBjYWxsYmFja1VSTDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KHRvUmVkaXJlY3RUbyk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBvQXV0aDJMaW5rQWNjb3VudDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aDIvbGlua1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpLFxuICAgICAgICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGMpID0+IHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYy5jb250ZXh0LnNlc3Npb247XG4gICAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBleGlzdGluZ0FjY291bnQgPSBhY2NvdW50LmZpbmQoXG4gICAgICAgICAgICAoYSkgPT4gYS5wcm92aWRlcklkID09PSBjLmJvZHkucHJvdmlkZXJJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKGV4aXN0aW5nQWNjb3VudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlNPQ0lBTF9BQ0NPVU5UX0FMUkVBRFlfTElOS0VEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcHJvdmlkZXIgPSBvcHRpb25zLmNvbmZpZy5maW5kKFxuICAgICAgICAgICAgKHApID0+IHAucHJvdmlkZXJJZCA9PT0gYy5ib2R5LnByb3ZpZGVySWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUFJPVklERVJfTk9UX0ZPVU5EXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgcHJvdmlkZXJJZCxcbiAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICAgICAgY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uVXJsLFxuICAgICAgICAgICAgZGlzY292ZXJ5VXJsLFxuICAgICAgICAgICAgcGtjZSxcbiAgICAgICAgICAgIHNjb3Blc1xuICAgICAgICAgIH0gPSBwcm92aWRlcjtcbiAgICAgICAgICBsZXQgZmluYWxBdXRoVXJsID0gYXV0aG9yaXphdGlvblVybDtcbiAgICAgICAgICBpZiAoIWZpbmFsQXV0aFVybCkge1xuICAgICAgICAgICAgaWYgKCFkaXNjb3ZlcnlVcmwpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT0FVVEhfQ09ORklHVVJBVElPTlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRpc2NvdmVyeSA9IGF3YWl0IGJldHRlckZldGNoKGRpc2NvdmVyeVVybCwge1xuICAgICAgICAgICAgICBvbkVycm9yKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKGNvbnRleHQuZXJyb3IubWVzc2FnZSwgY29udGV4dC5lcnJvciwge1xuICAgICAgICAgICAgICAgICAgZGlzY292ZXJ5VXJsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhKSB7XG4gICAgICAgICAgICAgIGZpbmFsQXV0aFVybCA9IGRpc2NvdmVyeS5kYXRhLmF1dGhvcml6YXRpb25fZW5kcG9pbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZmluYWxBdXRoVXJsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfT0FVVEhfQ09ORklHVVJBVElPTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHN0YXRlID0gYXdhaXQgZ2VuZXJhdGVTdGF0ZShjLCB7XG4gICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCB1cmwgPSBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgICAgIGlkOiBwcm92aWRlcklkLFxuICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICAgICAgY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgICByZWRpcmVjdFVSSTogcmVkaXJlY3RVUkkgfHwgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L29hdXRoMi9jYWxsYmFja2BcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IGZpbmFsQXV0aFVybCxcbiAgICAgICAgICAgIHN0YXRlOiBzdGF0ZS5zdGF0ZSxcbiAgICAgICAgICAgIGNvZGVWZXJpZmllcjogcGtjZSA/IHN0YXRlLmNvZGVWZXJpZmllciA6IHZvaWQgMCxcbiAgICAgICAgICAgIHNjb3Blczogc2NvcGVzIHx8IFtdLFxuICAgICAgICAgICAgcmVkaXJlY3RVUkk6IGAke2MuY29udGV4dC5iYXNlVVJMfS9vYXV0aDIvY2FsbGJhY2svJHtwcm92aWRlcklkfWBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgICAgICAgIHVybDogdXJsLnRvU3RyaW5nKCksXG4gICAgICAgICAgICByZWRpcmVjdDogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICAkRVJST1JfQ09ERVM6IEVSUk9SX0NPREVTXG4gIH07XG59O1xuXG5leHBvcnQgeyBnZW5lcmljT0F1dGggfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   admin: () => (/* binding */ admin)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\n\nvar getEndpointResponse = async (ctx) => {\n  const returned = ctx.context.returned;\n  if (!returned) {\n    return null;\n  }\n  if (returned instanceof Response) {\n    if (returned.status !== 200) {\n      return null;\n    }\n    return await returned.clone().json();\n  }\n  if (returned instanceof better_call__WEBPACK_IMPORTED_MODULE_5__.APIError) {\n    return null;\n  }\n  return returned;\n};\n\n// src/plugins/admin/index.ts\nvar admin = (options) => {\n  const opts = {\n    defaultRole: \"user\",\n    adminRole: \"admin\",\n    ...options\n  };\n  const ERROR_CODES = {\n    FAILED_TO_CREATE_USER: \"Failed to create user\",\n    USER_ALREADY_EXISTS: \"User already exists\",\n    USER_NOT_FOUND: \"User not found\",\n    YOU_CANNOT_BAN_YOURSELF: \"You cannot ban yourself\",\n    ONLY_ADMINS_CAN_ACCESS_THIS_ENDPOINT: \"Only admins can access this endpoint\"\n  };\n  const adminMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n    if (!session?.session) {\n      throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    const user = session.user;\n    if (!user.role || (Array.isArray(opts.adminRole) ? !opts.adminRole.includes(user.role) : user.role !== opts.adminRole)) {\n      throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"FORBIDDEN\", {\n        message: \"Only admins can access this endpoint\"\n      });\n    }\n    return {\n      session: {\n        user,\n        session: session.session\n      }\n    };\n  });\n  return {\n    id: \"admin\",\n    init(ctx) {\n      return {\n        options: {\n          databaseHooks: {\n            user: {\n              create: {\n                async before(user) {\n                  if (options?.defaultRole === false) {\n                    return;\n                  }\n                  return {\n                    data: {\n                      role: options?.defaultRole ?? \"user\"\n                    }\n                  };\n                }\n              }\n            },\n            session: {\n              create: {\n                async before(session) {\n                  const user = await ctx.internalAdapter.findUserById(\n                    session.userId\n                  );\n                  if (user.banned) {\n                    if (user.banExpires && user.banExpires.getTime() < Date.now()) {\n                      await ctx.internalAdapter.updateUser(session.userId, {\n                        banned: false,\n                        banReason: null,\n                        banExpires: null\n                      });\n                      return;\n                    }\n                    return false;\n                  }\n                }\n              }\n            }\n          }\n        }\n      };\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return context.path === \"/list-sessions\";\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const response = await getEndpointResponse(ctx);\n            if (!response) {\n              return;\n            }\n            const newJson = response.filter((session) => {\n              return !session.impersonatedBy;\n            });\n            return ctx.json(newJson);\n          })\n        }\n      ]\n    },\n    endpoints: {\n      setRole: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/set-role\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            }),\n            role: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The role to set. `admin` or `user` by default\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"setRole\",\n              summary: \"Set the role of a user\",\n              description: \"Set the role of a user\",\n              responses: {\n                200: {\n                  description: \"User role updated\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            ctx.body.userId,\n            {\n              role: ctx.body.role\n            }\n          );\n          return ctx.json({\n            user: updatedUser\n          });\n        }\n      ),\n      createUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/create-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            email: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The email of the user\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The password of the user\"\n            }),\n            name: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The name of the user\"\n            }),\n            role: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The role of the user\"\n            }),\n            /**\n             * extra fields for user\n             */\n            data: zod__WEBPACK_IMPORTED_MODULE_4__.z.optional(\n              zod__WEBPACK_IMPORTED_MODULE_4__.z.record(zod__WEBPACK_IMPORTED_MODULE_4__.z.any(), {\n                description: \"Extra fields for the user. Including custom additional fields.\"\n              })\n            )\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"createUser\",\n              summary: \"Create a new user\",\n              description: \"Create a new user\",\n              responses: {\n                200: {\n                  description: \"User created\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const existUser = await ctx.context.internalAdapter.findUserByEmail(\n            ctx.body.email\n          );\n          if (existUser) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.USER_ALREADY_EXISTS\n            });\n          }\n          const user = await ctx.context.internalAdapter.createUser({\n            email: ctx.body.email,\n            name: ctx.body.name,\n            role: ctx.body.role,\n            ...ctx.body.data\n          });\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: ERROR_CODES.FAILED_TO_CREATE_USER\n            });\n          }\n          const hashedPassword = await ctx.context.password.hash(\n            ctx.body.password\n          );\n          await ctx.context.internalAdapter.linkAccount({\n            accountId: user.id,\n            providerId: \"credential\",\n            password: hashedPassword,\n            userId: user.id\n          });\n          return ctx.json({\n            user\n          });\n        }\n      ),\n      listUsers: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/list-users\",\n        {\n          method: \"GET\",\n          use: [adminMiddleware],\n          query: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            searchValue: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The value to search for\"\n            }).optional(),\n            searchField: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"email\", \"name\"], {\n              description: \"The field to search in, defaults to email. Can be `email` or `name`\"\n            }).optional(),\n            searchOperator: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"contains\", \"starts_with\", \"ends_with\"], {\n              description: \"The operator to use for the search. Can be `contains`, `starts_with` or `ends_with`\"\n            }).optional(),\n            limit: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The number of users to return\"\n            }).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.number()).optional(),\n            offset: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The offset to start from\"\n            }).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.number()).optional(),\n            sortBy: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The field to sort by\"\n            }).optional(),\n            sortDirection: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"asc\", \"desc\"], {\n              description: \"The direction to sort by\"\n            }).optional(),\n            filterField: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The field to filter by\"\n            }).optional(),\n            filterValue: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The value to filter by\"\n            }).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.number()).or(zod__WEBPACK_IMPORTED_MODULE_4__.z.boolean()).optional(),\n            filterOperator: zod__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"]([\"eq\", \"ne\", \"lt\", \"lte\", \"gt\", \"gte\"], {\n              description: \"The operator to use for the filter\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              operationId: \"listUsers\",\n              summary: \"List users\",\n              description: \"List users\",\n              responses: {\n                200: {\n                  description: \"List of users\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          users: {\n                            type: \"array\",\n                            items: {\n                              $ref: \"#/components/schemas/User\"\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const where = [];\n          if (ctx.query?.searchValue) {\n            where.push({\n              field: ctx.query.searchField || \"email\",\n              operator: ctx.query.searchOperator || \"contains\",\n              value: ctx.query.searchValue\n            });\n          }\n          if (ctx.query?.filterValue) {\n            where.push({\n              field: ctx.query.filterField || \"email\",\n              operator: ctx.query.filterOperator || \"eq\",\n              value: ctx.query.filterValue\n            });\n          }\n          try {\n            const users = await ctx.context.internalAdapter.listUsers(\n              Number(ctx.query?.limit) || void 0,\n              Number(ctx.query?.offset) || void 0,\n              ctx.query?.sortBy ? {\n                field: ctx.query.sortBy,\n                direction: ctx.query.sortDirection || \"asc\"\n              } : void 0,\n              where.length ? where : void 0\n            );\n            return ctx.json({\n              users\n            });\n          } catch (e) {\n            return ctx.json({\n              users: []\n            });\n          }\n        }\n      ),\n      listUserSessions: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/list-user-sessions\",\n        {\n          method: \"POST\",\n          use: [adminMiddleware],\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              operationId: \"listUserSessions\",\n              summary: \"List user sessions\",\n              description: \"List user sessions\",\n              responses: {\n                200: {\n                  description: \"List of user sessions\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          sessions: {\n                            type: \"array\",\n                            items: {\n                              $ref: \"#/components/schemas/Session\"\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const sessions = await ctx.context.internalAdapter.listSessions(\n            ctx.body.userId\n          );\n          return {\n            sessions\n          };\n        }\n      ),\n      unbanUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/unban-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"unbanUser\",\n              summary: \"Unban a user\",\n              description: \"Unban a user\",\n              responses: {\n                200: {\n                  description: \"User unbanned\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const user = await ctx.context.internalAdapter.updateUser(\n            ctx.body.userId,\n            {\n              banned: false,\n              banExpires: null,\n              banReason: null\n            }\n          );\n          return ctx.json({\n            user\n          });\n        }\n      ),\n      banUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/ban-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            }),\n            /**\n             * Reason for the ban\n             */\n            banReason: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The reason for the ban\"\n            }).optional(),\n            /**\n             * Number of seconds until the ban expires\n             */\n            banExpiresIn: zod__WEBPACK_IMPORTED_MODULE_4__.z.number({\n              description: \"The number of seconds until the ban expires\"\n            }).optional()\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"banUser\",\n              summary: \"Ban a user\",\n              description: \"Ban a user\",\n              responses: {\n                200: {\n                  description: \"User banned\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (ctx.body.userId === ctx.context.session.user.id) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.YOU_CANNOT_BAN_YOURSELF\n            });\n          }\n          const user = await ctx.context.internalAdapter.updateUser(\n            ctx.body.userId,\n            {\n              banned: true,\n              banReason: ctx.body.banReason || options?.defaultBanReason || \"No reason\",\n              banExpires: ctx.body.banExpiresIn ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(ctx.body.banExpiresIn, \"sec\") : options?.defaultBanExpiresIn ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(options.defaultBanExpiresIn, \"sec\") : void 0\n            }\n          );\n          await ctx.context.internalAdapter.deleteSessions(ctx.body.userId);\n          return ctx.json({\n            user\n          });\n        }\n      ),\n      impersonateUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/impersonate-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"impersonateUser\",\n              summary: \"Impersonate a user\",\n              description: \"Impersonate a user\",\n              responses: {\n                200: {\n                  description: \"Impersonation session created\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          },\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const targetUser = await ctx.context.internalAdapter.findUserById(\n            ctx.body.userId\n          );\n          if (!targetUser) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"NOT_FOUND\", {\n              message: \"User not found\"\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            targetUser.id,\n            void 0,\n            true,\n            {\n              impersonatedBy: ctx.context.session.user.id,\n              expiresAt: options?.impersonationSessionDuration ? (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(options.impersonationSessionDuration, \"sec\") : (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_3__.getDate)(60 * 60, \"sec\")\n              // 1 hour\n            },\n            true\n          );\n          if (!session) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: ERROR_CODES.FAILED_TO_CREATE_USER\n            });\n          }\n          const authCookies = ctx.context.authCookies;\n          (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.deleteSessionCookie)(ctx);\n          await ctx.setSignedCookie(\n            \"admin_session\",\n            ctx.context.session.session.token,\n            ctx.context.secret,\n            authCookies.sessionToken.options\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(\n            ctx,\n            {\n              session,\n              user: targetUser\n            },\n            true\n          );\n          return ctx.json({\n            session,\n            user: targetUser\n          });\n        }\n      ),\n      stopImpersonating: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/stop-impersonating\",\n        {\n          method: \"POST\"\n        },\n        async (ctx) => {\n          const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n          if (!session) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n          }\n          if (!session.session.impersonatedBy) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n              message: \"You are not impersonating anyone\"\n            });\n          }\n          const user = await ctx.context.internalAdapter.findUserById(\n            session.session.impersonatedBy\n          );\n          if (!user) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Failed to find user\"\n            });\n          }\n          const adminCookie = await ctx.getSignedCookie(\n            \"admin_session\",\n            ctx.context.secret\n          );\n          if (!adminCookie) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Failed to find admin session\"\n            });\n          }\n          const adminSession = await ctx.context.internalAdapter.findSession(adminCookie);\n          if (!adminSession || adminSession.session.userId !== user.id) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: \"Failed to find admin session\"\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, adminSession);\n          return ctx.json(adminSession);\n        }\n      ),\n      revokeUserSession: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/revoke-user-session\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            sessionToken: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The session token\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"revokeUserSession\",\n              summary: \"Revoke a user session\",\n              description: \"Revoke a user session\",\n              responses: {\n                200: {\n                  description: \"Session revoked\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          await ctx.context.internalAdapter.deleteSession(\n            ctx.body.sessionToken\n          );\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      revokeUserSessions: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/revoke-user-sessions\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"revokeUserSessions\",\n              summary: \"Revoke all user sessions\",\n              description: \"Revoke all user sessions\",\n              responses: {\n                200: {\n                  description: \"Sessions revoked\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          await ctx.context.internalAdapter.deleteSessions(ctx.body.userId);\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      removeUser: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/remove-user\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string({\n              description: \"The user id\"\n            })\n          }),\n          use: [adminMiddleware],\n          metadata: {\n            openapi: {\n              operationId: \"removeUser\",\n              summary: \"Remove a user\",\n              description: \"Delete a user and all their sessions and accounts. Cannot be undone.\",\n              responses: {\n                200: {\n                  description: \"User removed\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          success: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          await ctx.context.internalAdapter.deleteUser(ctx.body.userId);\n          return ctx.json({\n            success: true\n          });\n        }\n      ),\n      setUserPassword: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/admin/set-user-password\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_4__.z.object({\n            newPassword: zod__WEBPACK_IMPORTED_MODULE_4__.z.string(),\n            userId: zod__WEBPACK_IMPORTED_MODULE_4__.z.string()\n          }),\n          use: [adminMiddleware]\n        },\n        async (ctx) => {\n          const hashedPassword = await ctx.context.password.hash(\n            ctx.body.newPassword\n          );\n          await ctx.context.internalAdapter.updatePassword(\n            ctx.body.userId,\n            hashedPassword\n          );\n          return ctx.json({\n            status: true\n          });\n        }\n      )\n    },\n    $ERROR_CODES: ERROR_CODES,\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__.mergeSchema)(schema, opts.schema)\n  };\n};\nvar schema = {\n  user: {\n    fields: {\n      role: {\n        type: \"string\",\n        required: false,\n        input: false\n      },\n      banned: {\n        type: \"boolean\",\n        defaultValue: false,\n        required: false,\n        input: false\n      },\n      banReason: {\n        type: \"string\",\n        required: false,\n        input: false\n      },\n      banExpires: {\n        type: \"date\",\n        required: false,\n        input: false\n      }\n    }\n  },\n  session: {\n    fields: {\n      impersonatedBy: {\n        type: \"string\",\n        required: false\n      }\n    }\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU5QMkg3VkpWLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBNEc7QUFDaEM7QUFDMUI7QUFDSjtBQUN0QjtBQUM2Qjs7QUFFckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixpREFBVTtBQUNwQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHdFQUFvQjtBQUM5QywwQkFBMEIscUVBQWlCO0FBQzNDO0FBQ0EsZ0JBQWdCLHdEQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3REFBUTtBQUN4QjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxtQkFBbUIsd0VBQW9CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZUFBZSxzRUFBa0I7QUFDakM7QUFDQTtB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSx1QkFBdUIsc0VBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5Q0FBUTtBQUN4Qix5QkFBeUIseUNBQVE7QUFDakMsb0JBQW9CLHlDQUFRO0FBQzVCLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsWUFBWSwrREFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVpQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU5QMkg3VkpWLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBnZXRTZXNzaW9uRnJvbUN0eCwgQVBJRXJyb3IsIGNyZWF0ZUF1dGhFbmRwb2ludCB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgZGVsZXRlU2Vzc2lvbkNvb2tpZSwgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgbWVyZ2VTY2hlbWEgfSBmcm9tICcuL2NodW5rLVdaNk9JVkpLLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQVBJRXJyb3IgYXMgQVBJRXJyb3IkMSB9IGZyb20gJ2JldHRlci1jYWxsJztcblxudmFyIGdldEVuZHBvaW50UmVzcG9uc2UgPSBhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHJldHVybmVkID0gY3R4LmNvbnRleHQucmV0dXJuZWQ7XG4gIGlmICghcmV0dXJuZWQpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAocmV0dXJuZWQgaW5zdGFuY2VvZiBSZXNwb25zZSkge1xuICAgIGlmIChyZXR1cm5lZC5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCByZXR1cm5lZC5jbG9uZSgpLmpzb24oKTtcbiAgfVxuICBpZiAocmV0dXJuZWQgaW5zdGFuY2VvZiBBUElFcnJvciQxKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHJldHVybmVkO1xufTtcblxuLy8gc3JjL3BsdWdpbnMvYWRtaW4vaW5kZXgudHNcbnZhciBhZG1pbiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgZGVmYXVsdFJvbGU6IFwidXNlclwiLFxuICAgIGFkbWluUm9sZTogXCJhZG1pblwiLFxuICAgIC4uLm9wdGlvbnNcbiAgfTtcbiAgY29uc3QgRVJST1JfQ09ERVMgPSB7XG4gICAgRkFJTEVEX1RPX0NSRUFURV9VU0VSOiBcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiLFxuICAgIFVTRVJfQUxSRUFEWV9FWElTVFM6IFwiVXNlciBhbHJlYWR5IGV4aXN0c1wiLFxuICAgIFVTRVJfTk9UX0ZPVU5EOiBcIlVzZXIgbm90IGZvdW5kXCIsXG4gICAgWU9VX0NBTk5PVF9CQU5fWU9VUlNFTEY6IFwiWW91IGNhbm5vdCBiYW4geW91cnNlbGZcIixcbiAgICBPTkxZX0FETUlOU19DQU5fQUNDRVNTX1RISVNfRU5EUE9JTlQ6IFwiT25seSBhZG1pbnMgY2FuIGFjY2VzcyB0aGlzIGVuZHBvaW50XCJcbiAgfTtcbiAgY29uc3QgYWRtaW5NaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbj8uc2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICBjb25zdCB1c2VyID0gc2Vzc2lvbi51c2VyO1xuICAgIGlmICghdXNlci5yb2xlIHx8IChBcnJheS5pc0FycmF5KG9wdHMuYWRtaW5Sb2xlKSA/ICFvcHRzLmFkbWluUm9sZS5pbmNsdWRlcyh1c2VyLnJvbGUpIDogdXNlci5yb2xlICE9PSBvcHRzLmFkbWluUm9sZSkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiT25seSBhZG1pbnMgY2FuIGFjY2VzcyB0aGlzIGVuZHBvaW50XCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvbjoge1xuICAgICAgICB1c2VyLFxuICAgICAgICBzZXNzaW9uOiBzZXNzaW9uLnNlc3Npb25cbiAgICAgIH1cbiAgICB9O1xuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJhZG1pblwiLFxuICAgIGluaXQoY3R4KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgZGF0YWJhc2VIb29rczoge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICAgICAgICBhc3luYyBiZWZvcmUodXNlcikge1xuICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnM/LmRlZmF1bHRSb2xlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgcm9sZTogb3B0aW9ucz8uZGVmYXVsdFJvbGUgPz8gXCJ1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgICAgICAgIGFzeW5jIGJlZm9yZShzZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoXG4gICAgICAgICAgICAgICAgICAgIHNlc3Npb24udXNlcklkXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgaWYgKHVzZXIuYmFubmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyLmJhbkV4cGlyZXMgJiYgdXNlci5iYW5FeHBpcmVzLmdldFRpbWUoKSA8IERhdGUubm93KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjdHguaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoc2Vzc2lvbi51c2VySWQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBiYW5SZWFzb246IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBiYW5FeHBpcmVzOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBob29rczoge1xuICAgICAgYWZ0ZXI6IFtcbiAgICAgICAge1xuICAgICAgICAgIG1hdGNoZXIoY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQucGF0aCA9PT0gXCIvbGlzdC1zZXNzaW9uc1wiO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaGFuZGxlcjogY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRFbmRwb2ludFJlc3BvbnNlKGN0eCk7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG5ld0pzb24gPSByZXNwb25zZS5maWx0ZXIoKHNlc3Npb24pID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuICFzZXNzaW9uLmltcGVyc29uYXRlZEJ5O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obmV3SnNvbik7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0sXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzZXRSb2xlOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL3NldC1yb2xlXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZFwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJvbGU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHJvbGUgdG8gc2V0LiBgYWRtaW5gIG9yIGB1c2VyYCBieSBkZWZhdWx0XCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbYWRtaW5NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBvcGVyYXRpb25JZDogXCJzZXRSb2xlXCIsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IFwiU2V0IHRoZSByb2xlIG9mIGEgdXNlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXQgdGhlIHJvbGUgb2YgYSB1c2VyXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciByb2xlIHVwZGF0ZWRcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgIGN0eC5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcm9sZTogY3R4LmJvZHkucm9sZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBjcmVhdGVVc2VyOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL2NyZWF0ZS11c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGVtYWlsOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwYXNzd29yZCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5hbWU6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICByb2xlOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSByb2xlIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBleHRyYSBmaWVsZHMgZm9yIHVzZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZGF0YTogei5vcHRpb25hbChcbiAgICAgICAgICAgICAgei5yZWNvcmQoei5hbnkoKSwge1xuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkV4dHJhIGZpZWxkcyBmb3IgdGhlIHVzZXIuIEluY2x1ZGluZyBjdXN0b20gYWRkaXRpb25hbCBmaWVsZHMuXCJcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcImNyZWF0ZVVzZXJcIixcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJDcmVhdGUgYSBuZXcgdXNlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJDcmVhdGUgYSBuZXcgdXNlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgY3JlYXRlZFwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBleGlzdFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKFxuICAgICAgICAgICAgY3R4LmJvZHkuZW1haWxcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChleGlzdFVzZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuVVNFUl9BTFJFQURZX0VYSVNUU1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVXNlcih7XG4gICAgICAgICAgICBlbWFpbDogY3R4LmJvZHkuZW1haWwsXG4gICAgICAgICAgICBuYW1lOiBjdHguYm9keS5uYW1lLFxuICAgICAgICAgICAgcm9sZTogY3R4LmJvZHkucm9sZSxcbiAgICAgICAgICAgIC4uLmN0eC5ib2R5LmRhdGFcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChcbiAgICAgICAgICAgIGN0eC5ib2R5LnBhc3N3b3JkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoe1xuICAgICAgICAgICAgYWNjb3VudElkOiB1c2VyLmlkLFxuICAgICAgICAgICAgcHJvdmlkZXJJZDogXCJjcmVkZW50aWFsXCIsXG4gICAgICAgICAgICBwYXNzd29yZDogaGFzaGVkUGFzc3dvcmQsXG4gICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgbGlzdFVzZXJzOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL2xpc3QtdXNlcnNcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBzZWFyY2hWYWx1ZTogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgdG8gc2VhcmNoIGZvclwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgc2VhcmNoRmllbGQ6IHouZW51bShbXCJlbWFpbFwiLCBcIm5hbWVcIl0sIHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGZpZWxkIHRvIHNlYXJjaCBpbiwgZGVmYXVsdHMgdG8gZW1haWwuIENhbiBiZSBgZW1haWxgIG9yIGBuYW1lYFwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgc2VhcmNoT3BlcmF0b3I6IHouZW51bShbXCJjb250YWluc1wiLCBcInN0YXJ0c193aXRoXCIsIFwiZW5kc193aXRoXCJdLCB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcGVyYXRvciB0byB1c2UgZm9yIHRoZSBzZWFyY2guIENhbiBiZSBgY29udGFpbnNgLCBgc3RhcnRzX3dpdGhgIG9yIGBlbmRzX3dpdGhgXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBsaW1pdDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbnVtYmVyIG9mIHVzZXJzIHRvIHJldHVyblwiXG4gICAgICAgICAgICB9KS5vcih6Lm51bWJlcigpKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgb2Zmc2V0OiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvZmZzZXQgdG8gc3RhcnQgZnJvbVwiXG4gICAgICAgICAgICB9KS5vcih6Lm51bWJlcigpKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgc29ydEJ5OiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBmaWVsZCB0byBzb3J0IGJ5XCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBzb3J0RGlyZWN0aW9uOiB6LmVudW0oW1wiYXNjXCIsIFwiZGVzY1wiXSwge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZGlyZWN0aW9uIHRvIHNvcnQgYnlcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGZpbHRlckZpZWxkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBmaWVsZCB0byBmaWx0ZXIgYnlcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGZpbHRlclZhbHVlOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSB0byBmaWx0ZXIgYnlcIlxuICAgICAgICAgICAgfSkub3Ioei5udW1iZXIoKSkub3Ioei5ib29sZWFuKCkpLm9wdGlvbmFsKCksXG4gICAgICAgICAgICBmaWx0ZXJPcGVyYXRvcjogei5lbnVtKFtcImVxXCIsIFwibmVcIiwgXCJsdFwiLCBcImx0ZVwiLCBcImd0XCIsIFwiZ3RlXCJdLCB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvcGVyYXRvciB0byB1c2UgZm9yIHRoZSBmaWx0ZXJcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcImxpc3RVc2Vyc1wiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkxpc3QgdXNlcnNcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCB1c2Vyc1wiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3Qgb2YgdXNlcnNcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHdoZXJlID0gW107XG4gICAgICAgICAgaWYgKGN0eC5xdWVyeT8uc2VhcmNoVmFsdWUpIHtcbiAgICAgICAgICAgIHdoZXJlLnB1c2goe1xuICAgICAgICAgICAgICBmaWVsZDogY3R4LnF1ZXJ5LnNlYXJjaEZpZWxkIHx8IFwiZW1haWxcIixcbiAgICAgICAgICAgICAgb3BlcmF0b3I6IGN0eC5xdWVyeS5zZWFyY2hPcGVyYXRvciB8fCBcImNvbnRhaW5zXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBjdHgucXVlcnkuc2VhcmNoVmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY3R4LnF1ZXJ5Py5maWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgd2hlcmUucHVzaCh7XG4gICAgICAgICAgICAgIGZpZWxkOiBjdHgucXVlcnkuZmlsdGVyRmllbGQgfHwgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICBvcGVyYXRvcjogY3R4LnF1ZXJ5LmZpbHRlck9wZXJhdG9yIHx8IFwiZXFcIixcbiAgICAgICAgICAgICAgdmFsdWU6IGN0eC5xdWVyeS5maWx0ZXJWYWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB1c2VycyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saXN0VXNlcnMoXG4gICAgICAgICAgICAgIE51bWJlcihjdHgucXVlcnk/LmxpbWl0KSB8fCB2b2lkIDAsXG4gICAgICAgICAgICAgIE51bWJlcihjdHgucXVlcnk/Lm9mZnNldCkgfHwgdm9pZCAwLFxuICAgICAgICAgICAgICBjdHgucXVlcnk/LnNvcnRCeSA/IHtcbiAgICAgICAgICAgICAgICBmaWVsZDogY3R4LnF1ZXJ5LnNvcnRCeSxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGN0eC5xdWVyeS5zb3J0RGlyZWN0aW9uIHx8IFwiYXNjXCJcbiAgICAgICAgICAgICAgfSA6IHZvaWQgMCxcbiAgICAgICAgICAgICAgd2hlcmUubGVuZ3RoID8gd2hlcmUgOiB2b2lkIDBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICB1c2Vyc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgdXNlcnM6IFtdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBsaXN0VXNlclNlc3Npb25zOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL2xpc3QtdXNlci1zZXNzaW9uc1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBpZFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcImxpc3RVc2VyU2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJMaXN0IHVzZXIgc2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCB1c2VyIHNlc3Npb25zXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCBvZiB1c2VyIHNlc3Npb25zXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saXN0U2Vzc2lvbnMoXG4gICAgICAgICAgICBjdHguYm9keS51c2VySWRcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZXNzaW9uc1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB1bmJhblVzZXI6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vdW5iYW4tdXNlclwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgaWRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcInVuYmFuVXNlclwiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlVuYmFuIGEgdXNlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVbmJhbiBhIHVzZXJcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHVuYmFubmVkXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgIGN0eC5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYmFubmVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgYmFuRXhwaXJlczogbnVsbCxcbiAgICAgICAgICAgICAgYmFuUmVhc29uOiBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgYmFuVXNlcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi9iYW4tdXNlclwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgaWRcIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlYXNvbiBmb3IgdGhlIGJhblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBiYW5SZWFzb246IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHJlYXNvbiBmb3IgdGhlIGJhblwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBOdW1iZXIgb2Ygc2Vjb25kcyB1bnRpbCB0aGUgYmFuIGV4cGlyZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgYmFuRXhwaXJlc0luOiB6Lm51bWJlcih7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBudW1iZXIgb2Ygc2Vjb25kcyB1bnRpbCB0aGUgYmFuIGV4cGlyZXNcIlxuICAgICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6IFwiYmFuVXNlclwiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkJhbiBhIHVzZXJcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQmFuIGEgdXNlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgYmFubmVkXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGlmIChjdHguYm9keS51c2VySWQgPT09IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5ZT1VfQ0FOTk9UX0JBTl9ZT1VSU0VMRlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgIGN0eC5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYmFubmVkOiB0cnVlLFxuICAgICAgICAgICAgICBiYW5SZWFzb246IGN0eC5ib2R5LmJhblJlYXNvbiB8fCBvcHRpb25zPy5kZWZhdWx0QmFuUmVhc29uIHx8IFwiTm8gcmVhc29uXCIsXG4gICAgICAgICAgICAgIGJhbkV4cGlyZXM6IGN0eC5ib2R5LmJhbkV4cGlyZXNJbiA/IGdldERhdGUoY3R4LmJvZHkuYmFuRXhwaXJlc0luLCBcInNlY1wiKSA6IG9wdGlvbnM/LmRlZmF1bHRCYW5FeHBpcmVzSW4gPyBnZXREYXRlKG9wdGlvbnMuZGVmYXVsdEJhbkV4cGlyZXNJbiwgXCJzZWNcIikgOiB2b2lkIDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhjdHguYm9keS51c2VySWQpO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBpbXBlcnNvbmF0ZVVzZXI6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vaW1wZXJzb25hdGUtdXNlclwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgaWRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcImltcGVyc29uYXRlVXNlclwiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkltcGVyc29uYXRlIGEgdXNlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbXBlcnNvbmF0ZSBhIHVzZXJcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbXBlcnNvbmF0aW9uIHNlc3Npb24gY3JlYXRlZFwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvU2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3QgdGFyZ2V0VXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoXG4gICAgICAgICAgICBjdHguYm9keS51c2VySWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghdGFyZ2V0VXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIG5vdCBmb3VuZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgdGFyZ2V0VXNlci5pZCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGltcGVyc29uYXRlZEJ5OiBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICAgIGV4cGlyZXNBdDogb3B0aW9ucz8uaW1wZXJzb25hdGlvblNlc3Npb25EdXJhdGlvbiA/IGdldERhdGUob3B0aW9ucy5pbXBlcnNvbmF0aW9uU2Vzc2lvbkR1cmF0aW9uLCBcInNlY1wiKSA6IGdldERhdGUoNjAgKiA2MCwgXCJzZWNcIilcbiAgICAgICAgICAgICAgLy8gMSBob3VyXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhdXRoQ29va2llcyA9IGN0eC5jb250ZXh0LmF1dGhDb29raWVzO1xuICAgICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgICAgICAgICAgXCJhZG1pbl9zZXNzaW9uXCIsXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICBhdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ub3B0aW9uc1xuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgICAgICAgIGN0eCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgICAgdXNlcjogdGFyZ2V0VXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzZXNzaW9uLFxuICAgICAgICAgICAgdXNlcjogdGFyZ2V0VXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgc3RvcEltcGVyc29uYXRpbmc6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vc3RvcC1pbXBlcnNvbmF0aW5nXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFzZXNzaW9uLnNlc3Npb24uaW1wZXJzb25hdGVkQnkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJZb3UgYXJlIG5vdCBpbXBlcnNvbmF0aW5nIGFueW9uZVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5SWQoXG4gICAgICAgICAgICBzZXNzaW9uLnNlc3Npb24uaW1wZXJzb25hdGVkQnlcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gZmluZCB1c2VyXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhZG1pbkNvb2tpZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICBcImFkbWluX3Nlc3Npb25cIixcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFhZG1pbkNvb2tpZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gZmluZCBhZG1pbiBzZXNzaW9uXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhZG1pblNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24oYWRtaW5Db29raWUpO1xuICAgICAgICAgIGlmICghYWRtaW5TZXNzaW9uIHx8IGFkbWluU2Vzc2lvbi5zZXNzaW9uLnVzZXJJZCAhPT0gdXNlci5pZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gZmluZCBhZG1pbiBzZXNzaW9uXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwgYWRtaW5TZXNzaW9uKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oYWRtaW5TZXNzaW9uKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHJldm9rZVVzZXJTZXNzaW9uOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL2FkbWluL3Jldm9rZS11c2VyLXNlc3Npb25cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgc2Vzc2lvblRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBzZXNzaW9uIHRva2VuXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbYWRtaW5NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBvcGVyYXRpb25JZDogXCJyZXZva2VVc2VyU2Vzc2lvblwiLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlJldm9rZSBhIHVzZXIgc2Vzc2lvblwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYSB1c2VyIHNlc3Npb25cIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXNzaW9uIHJldm9rZWRcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgICBjdHguYm9keS5zZXNzaW9uVG9rZW5cbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICByZXZva2VVc2VyU2Vzc2lvbnM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvYWRtaW4vcmV2b2tlLXVzZXItc2Vzc2lvbnNcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgdXNlcklkOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIGlkXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdXNlOiBbYWRtaW5NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBvcGVyYXRpb25JZDogXCJyZXZva2VVc2VyU2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJSZXZva2UgYWxsIHVzZXIgc2Vzc2lvbnNcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGFsbCB1c2VyIHNlc3Npb25zXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2Vzc2lvbnMgcmV2b2tlZFwiLFxuICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoY3R4LmJvZHkudXNlcklkKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgcmVtb3ZlVXNlcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi9yZW1vdmUtdXNlclwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVzZXIgaWRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFthZG1pbk1pZGRsZXdhcmVdLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIG9wZXJhdGlvbklkOiBcInJlbW92ZVVzZXJcIixcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJSZW1vdmUgYSB1c2VyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRlbGV0ZSBhIHVzZXIgYW5kIGFsbCB0aGVpciBzZXNzaW9ucyBhbmQgYWNjb3VudHMuIENhbm5vdCBiZSB1bmRvbmUuXCIsXG4gICAgICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciByZW1vdmVkXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVVc2VyKGN0eC5ib2R5LnVzZXJJZCk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHNldFVzZXJQYXNzd29yZDogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9hZG1pbi9zZXQtdXNlci1wYXNzd29yZFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBuZXdQYXNzd29yZDogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIHVzZXJJZDogei5zdHJpbmcoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW2FkbWluTWlkZGxld2FyZV1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChcbiAgICAgICAgICAgIGN0eC5ib2R5Lm5ld1Bhc3N3b3JkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlUGFzc3dvcmQoXG4gICAgICAgICAgICBjdHguYm9keS51c2VySWQsXG4gICAgICAgICAgICBoYXNoZWRQYXNzd29yZFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICAkRVJST1JfQ09ERVM6IEVSUk9SX0NPREVTLFxuICAgIHNjaGVtYTogbWVyZ2VTY2hlbWEoc2NoZW1hLCBvcHRzLnNjaGVtYSlcbiAgfTtcbn07XG52YXIgc2NoZW1hID0ge1xuICB1c2VyOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICByb2xlOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgaW5wdXQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgYmFubmVkOiB7XG4gICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGZhbHNlLFxuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGlucHV0OiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGJhblJlYXNvbjoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGlucHV0OiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGJhbkV4cGlyZXM6IHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgaW5wdXQ6IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBzZXNzaW9uOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICBpbXBlcnNvbmF0ZWRCeToge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCB7IGFkbWluIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateState: () => (/* binding */ generateState),\n/* harmony export */   parseState: () => (/* binding */ parseState)\n/* harmony export */ });\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\nasync function generateState(c, link) {\n  const callbackURL = c.body?.callbackURL || c.context.options.baseURL;\n  if (!callbackURL) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n      message: \"callbackURL is required\"\n    });\n  }\n  const codeVerifier = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_0__.generateRandomString)(128);\n  const state = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_0__.generateRandomString)(32);\n  const data = JSON.stringify({\n    callbackURL,\n    codeVerifier,\n    errorURL: c.body?.errorCallbackURL,\n    newUserURL: c.body?.newUserCallbackURL,\n    link,\n    /**\n     * This is the actual expiry time of the state\n     */\n    expiresAt: Date.now() + 10 * 60 * 1e3\n  });\n  const expiresAt = /* @__PURE__ */ new Date();\n  expiresAt.setMinutes(expiresAt.getMinutes() + 10);\n  const verification = await c.context.internalAdapter.createVerificationValue({\n    value: data,\n    identifier: state,\n    expiresAt\n  });\n  if (!verification) {\n    c.context.logger.error(\n      \"Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database\"\n    );\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"Unable to create verification\"\n    });\n  }\n  return {\n    state: verification.identifier,\n    codeVerifier\n  };\n}\nasync function parseState(c) {\n  const state = c.query.state || c.body.state;\n  const data = await c.context.internalAdapter.findVerificationValue(state);\n  if (!data) {\n    c.context.logger.error(\"State Mismatch. Verification not found\", {\n      state\n    });\n    throw c.redirect(\n      `${c.context.baseURL}/error?error=please_restart_the_process`\n    );\n  }\n  const parsedData = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n    callbackURL: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n    codeVerifier: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n    errorURL: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n    newUserURL: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n    expiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n    link: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n      userId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n    }).optional()\n  }).parse(JSON.parse(data.value));\n  if (!parsedData.errorURL) {\n    parsedData.errorURL = `${c.context.baseURL}/error`;\n  }\n  if (parsedData.expiresAt < Date.now()) {\n    await c.context.internalAdapter.deleteVerificationValue(data.id);\n    c.context.logger.error(\"State expired.\", {\n      state\n    });\n    throw c.redirect(\n      `${c.context.baseURL}/error?error=please_restart_the_process`\n    );\n  }\n  await c.context.internalAdapter.deleteVerificationValue(data.id);\n  return parsedData;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLU5QTzY0U1ZOLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJEO0FBQ25DO0FBQ2U7O0FBRXZDO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaURBQVE7QUFDdEI7QUFDQSxLQUFLO0FBQ0w7QUFDQSx1QkFBdUIsd0VBQW9CO0FBQzNDLGdCQUFnQix3RUFBb0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpREFBUTtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxTQUFTLGtCQUFrQjtBQUMzQjtBQUNBO0FBQ0EscUJBQXFCLHlDQUFRO0FBQzdCLGlCQUFpQix5Q0FBUTtBQUN6QixrQkFBa0IseUNBQVE7QUFDMUIsY0FBYyx5Q0FBUTtBQUN0QixnQkFBZ0IseUNBQVE7QUFDeEIsZUFBZSx5Q0FBUTtBQUN2QixVQUFVLHlDQUFRO0FBQ2xCLGFBQWEseUNBQVE7QUFDckIsY0FBYyx5Q0FBUTtBQUN0QixLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsNkJBQTZCLGtCQUFrQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsU0FBUyxrQkFBa0I7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFcUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1OUE82NFNWTi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZW5lcmF0ZVJhbmRvbVN0cmluZyB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTdGF0ZShjLCBsaW5rKSB7XG4gIGNvbnN0IGNhbGxiYWNrVVJMID0gYy5ib2R5Py5jYWxsYmFja1VSTCB8fCBjLmNvbnRleHQub3B0aW9ucy5iYXNlVVJMO1xuICBpZiAoIWNhbGxiYWNrVVJMKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJjYWxsYmFja1VSTCBpcyByZXF1aXJlZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgY29kZVZlcmlmaWVyID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMTI4KTtcbiAgY29uc3Qgc3RhdGUgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygzMik7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgY2FsbGJhY2tVUkwsXG4gICAgY29kZVZlcmlmaWVyLFxuICAgIGVycm9yVVJMOiBjLmJvZHk/LmVycm9yQ2FsbGJhY2tVUkwsXG4gICAgbmV3VXNlclVSTDogYy5ib2R5Py5uZXdVc2VyQ2FsbGJhY2tVUkwsXG4gICAgbGluayxcbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIHRoZSBhY3R1YWwgZXhwaXJ5IHRpbWUgb2YgdGhlIHN0YXRlXG4gICAgICovXG4gICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgMTAgKiA2MCAqIDFlM1xuICB9KTtcbiAgY29uc3QgZXhwaXJlc0F0ID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gIGV4cGlyZXNBdC5zZXRNaW51dGVzKGV4cGlyZXNBdC5nZXRNaW51dGVzKCkgKyAxMCk7XG4gIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgIHZhbHVlOiBkYXRhLFxuICAgIGlkZW50aWZpZXI6IHN0YXRlLFxuICAgIGV4cGlyZXNBdFxuICB9KTtcbiAgaWYgKCF2ZXJpZmljYXRpb24pIHtcbiAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgXCJVbmFibGUgdG8gY3JlYXRlIHZlcmlmaWNhdGlvbi4gTWFrZSBzdXJlIHRoZSBkYXRhYmFzZSBhZGFwdGVyIGlzIHByb3Blcmx5IHdvcmtpbmcgYW5kIHRoZXJlIGlzIGEgdmVyaWZpY2F0aW9uIHRhYmxlIGluIHRoZSBkYXRhYmFzZVwiXG4gICAgKTtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gY3JlYXRlIHZlcmlmaWNhdGlvblwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzdGF0ZTogdmVyaWZpY2F0aW9uLmlkZW50aWZpZXIsXG4gICAgY29kZVZlcmlmaWVyXG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiBwYXJzZVN0YXRlKGMpIHtcbiAgY29uc3Qgc3RhdGUgPSBjLnF1ZXJ5LnN0YXRlIHx8IGMuYm9keS5zdGF0ZTtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKHN0YXRlKTtcbiAgaWYgKCFkYXRhKSB7XG4gICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlN0YXRlIE1pc21hdGNoLiBWZXJpZmljYXRpb24gbm90IGZvdW5kXCIsIHtcbiAgICAgIHN0YXRlXG4gICAgfSk7XG4gICAgdGhyb3cgYy5yZWRpcmVjdChcbiAgICAgIGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1wbGVhc2VfcmVzdGFydF90aGVfcHJvY2Vzc2BcbiAgICApO1xuICB9XG4gIGNvbnN0IHBhcnNlZERhdGEgPSB6Lm9iamVjdCh7XG4gICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCksXG4gICAgY29kZVZlcmlmaWVyOiB6LnN0cmluZygpLFxuICAgIGVycm9yVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgbmV3VXNlclVSTDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIGV4cGlyZXNBdDogei5udW1iZXIoKSxcbiAgICBsaW5rOiB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5zdHJpbmcoKSxcbiAgICAgIHVzZXJJZDogei5zdHJpbmcoKVxuICAgIH0pLm9wdGlvbmFsKClcbiAgfSkucGFyc2UoSlNPTi5wYXJzZShkYXRhLnZhbHVlKSk7XG4gIGlmICghcGFyc2VkRGF0YS5lcnJvclVSTCkge1xuICAgIHBhcnNlZERhdGEuZXJyb3JVUkwgPSBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3JgO1xuICB9XG4gIGlmIChwYXJzZWREYXRhLmV4cGlyZXNBdCA8IERhdGUubm93KCkpIHtcbiAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKGRhdGEuaWQpO1xuICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJTdGF0ZSBleHBpcmVkLlwiLCB7XG4gICAgICBzdGF0ZVxuICAgIH0pO1xuICAgIHRocm93IGMucmVkaXJlY3QoXG4gICAgICBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9cGxlYXNlX3Jlc3RhcnRfdGhlX3Byb2Nlc3NgXG4gICAgKTtcbiAgfVxuICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKGRhdGEuaWQpO1xuICByZXR1cm4gcGFyc2VkRGF0YTtcbn1cblxuZXhwb3J0IHsgZ2VuZXJhdGVTdGF0ZSwgcGFyc2VTdGF0ZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   openAPI: () => (/* binding */ openAPI)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-62MWLLEG.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\nvar paths = {};\nfunction getTypeFromZodType(zodType) {\n  switch (zodType.constructor.name) {\n    case \"ZodString\":\n      return \"string\";\n    case \"ZodNumber\":\n      return \"number\";\n    case \"ZodBoolean\":\n      return \"boolean\";\n    case \"ZodObject\":\n      return \"object\";\n    case \"ZodArray\":\n      return \"array\";\n    default:\n      return \"string\";\n  }\n}\nfunction getParameters(options) {\n  const parameters = [];\n  if (options.metadata?.openapi?.parameters) {\n    parameters.push(...options.metadata.openapi.parameters);\n    return parameters;\n  }\n  if (options.query instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodObject) {\n    Object.entries(options.query.shape).forEach(([key, value]) => {\n      if (value instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodSchema) {\n        parameters.push({\n          name: key,\n          in: \"query\",\n          schema: {\n            type: getTypeFromZodType(value),\n            ...\"minLength\" in value && value.minLength ? {\n              minLength: value.minLength\n            } : {},\n            description: value.description\n          }\n        });\n      }\n    });\n  }\n  return parameters;\n}\nfunction getRequestBody(options) {\n  if (options.metadata?.openapi?.requestBody) {\n    return options.metadata.openapi.requestBody;\n  }\n  if (!options.body) return void 0;\n  if (options.body instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodObject || options.body instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodOptional) {\n    const shape = options.body.shape;\n    if (!shape) return void 0;\n    const properties = {};\n    const required = [];\n    Object.entries(shape).forEach(([key, value]) => {\n      if (value instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodSchema) {\n        properties[key] = {\n          type: getTypeFromZodType(value),\n          description: value.description\n        };\n        if (!(value instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodOptional)) {\n          required.push(key);\n        }\n      }\n    });\n    return {\n      required: options.body instanceof zod__WEBPACK_IMPORTED_MODULE_2__.ZodOptional ? false : options.body ? true : false,\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties,\n            required\n          }\n        }\n      }\n    };\n  }\n  return void 0;\n}\nfunction getResponse(responses) {\n  return {\n    \"400\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            },\n            required: [\"message\"]\n          }\n        }\n      },\n      description: \"Bad Request. Usually due to missing parameters, or invalid parameters.\"\n    },\n    \"401\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            },\n            required: [\"message\"]\n          }\n        }\n      },\n      description: \"Unauthorized. Due to missing or invalid authentication.\"\n    },\n    \"403\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Forbidden. You do not have permission to access this resource or to perform this action.\"\n    },\n    \"404\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Not Found. The requested resource was not found.\"\n    },\n    \"429\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Too Many Requests. You have exceeded the rate limit. Try again later.\"\n    },\n    \"500\": {\n      content: {\n        \"application/json\": {\n          schema: {\n            type: \"object\",\n            properties: {\n              message: {\n                type: \"string\"\n              }\n            }\n          }\n        }\n      },\n      description: \"Internal Server Error. This is a problem with the server that you cannot fix.\"\n    },\n    ...responses\n  };\n}\nfunction toOpenApiPath(path) {\n  return path.split(\"/\").map((part) => part.startsWith(\":\") ? `{${part.slice(1)}}` : part).join(\"/\");\n}\nasync function generator(ctx, options) {\n  const baseEndpoints = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(ctx, {\n    ...options,\n    plugins: []\n  });\n  const tables = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_1__.getAuthTables)(options);\n  const models = Object.entries(tables).reduce((acc, [key, value]) => {\n    const modelName = key.charAt(0).toUpperCase() + key.slice(1);\n    acc[modelName] = {\n      type: \"object\",\n      properties: Object.entries(value.fields).reduce(\n        (acc2, [key2, value2]) => {\n          acc2[key2] = {\n            type: value2.type\n          };\n          return acc2;\n        },\n        { id: { type: \"string\" } }\n      )\n    };\n    return acc;\n  }, {});\n  const components = {\n    schemas: {\n      ...models\n    }\n  };\n  Object.entries(baseEndpoints.api).forEach(([_, value]) => {\n    const options2 = value.options;\n    if (options2.metadata?.SERVER_ONLY) return;\n    const path = toOpenApiPath(value.path);\n    if (options2.method === \"GET\") {\n      paths[path] = {\n        get: {\n          tags: [\"Default\", ...options2.metadata?.openapi?.tags || []],\n          description: options2.metadata?.openapi?.description,\n          operationId: options2.metadata?.openapi?.operationId,\n          security: [\n            {\n              bearerAuth: []\n            }\n          ],\n          parameters: getParameters(options2),\n          responses: getResponse(options2.metadata?.openapi?.responses)\n        }\n      };\n    }\n    if (options2.method === \"POST\") {\n      const body = getRequestBody(options2);\n      paths[path] = {\n        post: {\n          tags: [\"Default\", ...options2.metadata?.openapi?.tags || []],\n          description: options2.metadata?.openapi?.description,\n          operationId: options2.metadata?.openapi?.operationId,\n          security: [\n            {\n              bearerAuth: []\n            }\n          ],\n          parameters: getParameters(options2),\n          ...body ? { requestBody: body } : {\n            requestBody: {\n              //set body none\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {}\n                  }\n                }\n              }\n            }\n          },\n          responses: getResponse(options2.metadata?.openapi?.responses)\n        }\n      };\n    }\n  });\n  for (const plugin of options.plugins || []) {\n    if (plugin.id === \"open-api\") {\n      continue;\n    }\n    const pluginEndpoints = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(ctx, {\n      ...options,\n      plugins: [plugin]\n    });\n    const api = Object.keys(pluginEndpoints.api).map((key) => {\n      if (baseEndpoints.api[key] === void 0) {\n        return pluginEndpoints.api[key];\n      }\n      return null;\n    }).filter((x) => x !== null);\n    Object.entries(api).forEach(([key, value]) => {\n      const options2 = value.options;\n      if (options2.metadata?.SERVER_ONLY) return;\n      const path = toOpenApiPath(value.path);\n      if (options2.method === \"GET\") {\n        paths[path] = {\n          get: {\n            tags: options2.metadata?.openapi?.tags || [\n              plugin.id.charAt(0).toUpperCase() + plugin.id.slice(1)\n            ],\n            description: options2.metadata?.openapi?.description,\n            operationId: options2.metadata?.openapi?.operationId,\n            security: [\n              {\n                bearerAuth: []\n              }\n            ],\n            parameters: getParameters(options2),\n            responses: getResponse(options2.metadata?.openapi?.responses)\n          }\n        };\n      }\n      if (options2.method === \"POST\") {\n        paths[path] = {\n          post: {\n            tags: options2.metadata?.openapi?.tags || [\n              plugin.id.charAt(0).toUpperCase() + plugin.id.slice(1)\n            ],\n            description: options2.metadata?.openapi?.description,\n            operationId: options2.metadata?.openapi?.operationId,\n            security: [\n              {\n                bearerAuth: []\n              }\n            ],\n            parameters: getParameters(options2),\n            requestBody: getRequestBody(options2),\n            responses: getResponse(options2.metadata?.openapi?.responses)\n          }\n        };\n      }\n    });\n  }\n  const res = {\n    openapi: \"3.1.1\",\n    info: {\n      title: \"Better Auth\",\n      description: \"API Reference for your Better Auth Instance\",\n      version: \"1.1.0\"\n    },\n    components,\n    security: [\n      {\n        apiKeyCookie: []\n      }\n    ],\n    servers: [\n      {\n        url: ctx.baseURL\n      }\n    ],\n    tags: [\n      {\n        name: \"Default\",\n        description: \"Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin.\"\n      }\n    ],\n    paths\n  };\n  return res;\n}\n\n// src/plugins/open-api/logo.ts\nvar logo = `<svg width=\"75\" height=\"75\" viewBox=\"0 0 75 75\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<rect width=\"75\" height=\"75\" fill=\"url(#pattern0_21_12)\"/>\n<defs>\n<pattern id=\"pattern0_21_12\" patternContentUnits=\"objectBoundingBox\" width=\"1\" height=\"1\">\n<use xlink:href=\"#image0_21_12\" transform=\"scale(0.00094697)\"/>\n</pattern>\n<image id=\"image0_21_12\" width=\"1056\" height=\"1056\" xlink:href=\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QBARXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAEIKADAAQAAAABAAAEIAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/+ICKElDQ19QUk9GSUxFAAEBAAACGGFwcGwEAAAAbW50clJHQiBYWVogB+YAAQABAAAAAAAAYWNzcEFQUEwAAAAAQVBQTAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1hcHBs7P2jjjiFR8NttL1PetoYLwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKZGVzYwAAAPwAAAAwY3BydAAAASwAAABQd3RwdAAAAXwAAAAUclhZWgAAAZAAAAAUZ1hZWgAAAaQAAAAUYlhZWgAAAbgAAAAUclRSQwAAAcwAAAAgY2hhZAAAAewAAAAsYlRSQwAAAcwAAAAgZ1RSQwAAAcwAAAAgbWx1YwAAAAAAAAABAAAADGVuVVMAAAAUAAAAHABEAGkAcwBwAGwAYQB5ACAAUAAzbWx1YwAAAAAAAAABAAAADGVuVVMAAAA0AAAAHABDAG8AcAB5AHIAaQBnAGgAdAAgAEEAcABwAGwAZQAgAEkAbgBjAC4ALAAgADIAMAAyADJYWVogAAAAAAAA9tUAAQAAAADTLFhZWiAAAAAAAACD3wAAPb////+7WFlaIAAAAAAAAEq/AACxNwAACrlYWVogAAAAAAAAKDgAABELAADIuXBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbc2YzMgAAAAAAAQxCAAAF3v//8yYAAAeTAAD9kP//+6L///2jAAAD3AAAwG7/wAARCAQgBCADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9sAQwACAgICAgIDAgIDBAMDAwQFBAQEBAUHBQUFBQUHCAcHBwcHBwgICAgICAgICgoKCgoKCwsLCwsNDQ0NDQ0NDQ0N/9sAQwECAgIDAwMGAwMGDQkHCQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0N/90ABABC/9oADAMBAAIRAxEAPwD9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9L9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//T/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9T9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Ln/gq38a/in8Dvgp4T8R/CfxFdeG9SvvFMdlcXFoELyW5srqQxnzEcY3op4Gciv1Gr8Z/+C2X/JvXgj/sc4v/AE33lAH4z/8ADwv9tD/oq2tf9823/wAZo/4eF/tof9FW1r/vm2/+M18Z0UAfZn/Dwv8AbQ/6KtrX/fNt/wDGaP8Ah4X+2h/0VbWv++bb/wCM18Z0UAfZn/Dwv9tD/oq2tf8AfNt/8Zo/4eF/tof9FW1r/vm2/wDjNfGdFAH2Z/w8L/bQ/wCira1/3zbf/GaP+Hhf7aH/AEVbWv8Avm2/+M18Z0UAfZn/AA8L/bQ/6KtrX/fNt/8AGaP+Hhf7aH/RVta/75tv/jNfGdFAH2Z/w8L/AG0P+ira1/3zbf8Axmj/AIeF/tof9FW1r/vm2/8AjNfGdFAH63/sVftq/tTfEb9qb4deCfG3xF1TVtD1bVGgvbKdYBHPGIJW2ttiVsblB4I6V/UbX8Z//BPT/k9D4U/9hpv/AEmmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+M/wD4eF/tof8ARVta/wC+bb/4zR/w8L/bQ/6KtrX/AHzbf/Ga+M6KAPsz/h4X+2h/0VbWv++bb/4zR/w8L/bQ/wCira1/3zbf/Ga+M6KAPsz/AIeF/tof9FW1r/vm2/8AjNH/AA8L/bQ/6KtrX/fNt/8AGa+M6KAPsz/h4X+2h/0VbWv++bb/AOM0f8PC/wBtD/oq2tf9823/AMZr4zooA+zP+Hhf7aH/AEVbWv8Avm2/+M0f8PC/20P+ira1/wB823/xmvjOigD7M/4eF/tof9FW1r/vm2/+M0f8PC/20P8Aoq2tf9823/xmvjOigD7M/wCHhf7aH/RVta/75tv/AIzR/wAPC/20P+ira1/3zbf/ABmvjOigD7M/4eF/tof9FW1r/vm2/wDjNH/Dwv8AbQ/6KtrX/fNt/wDGa+M6KAPsz/h4X+2h/wBFW1r/AL5tv/jNH/Dwv9tD/oq2tf8AfNt/8Zr4zooA+zP+Hhf7aH/RVta/75tv/jNH/Dwv9tD/AKKtrX/fNt/8Zr4zooA+zP8Ah4X+2h/0VbWv++bb/wCM0f8ADwv9tD/oq2tf9823/wAZr4zooA+zP+Hhf7aH/RVta/75tv8A4zR/w8L/AG0P+ira1/3zbf8AxmvjOigD7M/4eF/tof8ARVta/wC+bb/4zR/w8L/bQ/6KtrX/AHzbf/Ga+M6KAP6tv+CUnxr+Kfxx+CnizxH8WPEV14k1Kx8UyWVvcXYQPHbiytZBGPLRBje7HkZya/Uavxn/AOCJv/JvXjf/ALHOX/032dfsxQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfxn/APBPT/k9D4U/9hpv/Saav7MKACiiigAooooAKKKKACiiigAooooAKKKKAP4A6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfwq/BT4r638Dvin4d+LHhy0tb7UvDd0bu3t70ObeRzG0eJBGyPjDnowOa/Ub/h9l+0L/ANCR4M/79ah/8m0Af0yUV/M3/wAPsv2hf+hI8Gf9+tQ/+TaP+H2X7Qv/AEJHgz/v1qH/AMm0Af0yUV/M3/w+y/aF/wChI8Gf9+tQ/wDk2j/h9l+0L/0JHgz/AL9ah/8AJtAH9MlFfzN/8Psv2hf+hI8Gf9+tQ/8Ak2j/AIfZftC/9CR4M/79ah/8m0Af0yUV/M3/AMPsv2hf+hI8Gf8AfrUP/k2j/h9l+0L/ANCR4M/79ah/8m0Af0yUV/M3/wAPsv2hf+hI8Gf9+tQ/+TaP+H2X7Qv/AEJHgz/v1qH/AMm0Af0yUV/M3/w+y/aF/wChI8Gf9+tQ/wDk2j/h9l+0L/0JHgz/AL9ah/8AJtAH4z0V/TJ/w5N/Z6/6Hfxn/wB/dP8A/kKj/hyb+z1/0O/jP/v7p/8A8hUAfzN0V/TJ/wAOTf2ev+h38Z/9/dP/APkKj/hyb+z1/wBDv4z/AO/un/8AyFQB/M3RX9Mn/Dk39nr/AKHfxn/390//AOQqP+HJv7PX/Q7+M/8Av7p//wAhUAfzN0V/TJ/w5N/Z6/6Hfxn/AN/dP/8AkKj/AIcm/s9f9Dv4z/7+6f8A/IVAH8zdFf0yf8OTf2ev+h38Z/8Af3T/AP5Co/4cm/s9f9Dv4z/7+6f/APIVAH8zdFf0yf8ADk39nr/od/Gf/f3T/wD5Co/4cm/s9f8AQ7+M/wDv7p//AMhUAfzN0V/TJ/w5N/Z6/wCh38Z/9/dP/wDkKvwV/ag+FGifA74++M/hP4cu7q+03w3fi0t7i9KG4kQxRyZkMaomcueigYoA8FooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/AOxzl/8ATfZ1+zFfjP8A8ETf+TevG/8A2Ocv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/v8ooooAKKKKACiiigAooooAKKKKACiiigAr+M//goX/wAnofFb/sNL/wCk0Nf2YV/Gf/wUL/5PQ+K3/YaX/wBJoaAPjOiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP7/KKKKACiiigAooooAKKKKACiiigAooooAK/jP/4KF/8AJ6HxW/7DS/8ApNDX9mFfxn/8FC/+T0Pit/2Gl/8ASaGgD4zooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+/yiiigAooooAKKKKACiiigAooooAKKKKACv4z/+Chf/ACeh8Vv+w0v/AKTQ1/ZhX8Z//BQv/k9D4rf9hpf/AEmhoA+M6KKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/v8ooooAKKKKACiiigAooooAKKKKACiiigAr+M//goX/wAnofFb/sNL/wCk0Nf2YV/Gf/wUL/5PQ+K3/YaX/wBJoaAPjOiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP7/KKKKACiiigAooooAKKKKACiiigAooooAK/jP/4KF/8AJ6HxW/7DS/8ApNDX9mFfxn/8FC/+T0Pit/2Gl/8ASaGgD4zooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+/yiiigAooooAKKKKACiiigAooooAKKKKACv4z/+Chf/ACeh8Vv+w0v/AKTQ1/ZhX8Z//BQv/k9D4rf9hpf/AEmhoA+M6KKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD1L4KfCjW/jj8U/Dvwn8OXdrY6l4kujaW9xelxbxuI2kzIY1d8YQ9FJzX6jf8OTf2hf8Aod/Bn/f3UP8A5Cr4z/4J6f8AJ6Hwp/7DTf8ApNNX9mFAH8zf/Dk39oX/AKHfwZ/391D/AOQqP+HJv7Qv/Q7+DP8Av7qH/wAhV/TJRQB/M3/w5N/aF/6HfwZ/391D/wCQqP8Ahyb+0L/0O/gz/v7qH/yFX9MlFAH8zf8Aw5N/aF/6HfwZ/wB/dQ/+QqP+HJv7Qv8A0O/gz/v7qH/yFX9MlFAH8zf/AA5N/aF/6HfwZ/391D/5Co/4cm/tC/8AQ7+DP+/uof8AyFX9MlFAH8zf/Dk39oX/AKHfwZ/391D/AOQqP+HJv7Qv/Q7+DP8Av7qH/wAhV/TJRQB/M3/w5N/aF/6HfwZ/391D/wCQqP8Ahyb+0L/0O/gz/v7qH/yFX9MlFAH4z/8AD7L9nr/oSPGf/frT/wD5No/4fZfs9f8AQkeM/wDv1p//AMm1/M3RQB/TJ/w+y/Z6/wChI8Z/9+tP/wDk2j/h9l+z1/0JHjP/AL9af/8AJtfzN0UAf0yf8Psv2ev+hI8Z/wDfrT//AJNo/wCH2X7PX/QkeM/+/Wn/APybX8zdFAH9Mn/D7L9nr/oSPGf/AH60/wD+TaP+H2X7PX/QkeM/+/Wn/wDybX8zdFAH9Mn/AA+y/Z6/6Ejxn/360/8A+TaP+H2X7PX/AEJHjP8A79af/wDJtfzN0UAf0yf8Psv2ev8AoSPGf/frT/8A5No/4fZfs9f9CR4z/wC/Wn//ACbX8zdFAH9Mn/D7L9nr/oSPGf8A360//wCTa/BX9qD4r6J8cfj74z+LHhy0urHTfEl+Lu3t70ILiNBFHHiQRs6Zyh6MRivBaKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/ACb143/7HOX/ANN9nX7MV+M//BE3/k3rxv8A9jnL/wCm+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfxn/APBPT/k9D4U/9hpv/Saav7MKACiiigAooooAKKKKACiiigAooooAKKKKAP4A6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+XP/BVv4KfFP44/BTwn4c+E/h268SalY+KY724t7QoHjtxZXUZkPmOgxvdRwc5NAH8pNFfZn/DvT9tD/olOtf99W3/AMeo/wCHen7aH/RKda/76tv/AI9QB8Z0V9mf8O9P20P+iU61/wB9W3/x6j/h3p+2h/0SnWv++rb/AOPUAfGdFfZn/DvT9tD/AKJTrX/fVt/8eo/4d6ftof8ARKda/wC+rb/49QB8Z0V9mf8ADvT9tD/olOtf99W3/wAeo/4d6ftof9Ep1r/vq2/+PUAfGdFfZn/DvT9tD/olOtf99W3/AMeo/wCHen7aH/RKda/76tv/AI9QB8Z0V9mf8O9P20P+iU61/wB9W3/x6j/h3p+2h/0SnWv++rb/AOPUAH/BPT/k9D4U/wDYab/0mmr+zCv5cv2Kv2Kv2pvhz+1N8OvG3jb4dappOh6TqjT3t7O0BjgjMEq7m2ys2NzAcA9a/qNoAKKKKACiiigAooooAKKKKACiiigAooooA/gDor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD9mP+CJv/JvXjf8A7HOX/wBN9nX7MV+XP/BKT4KfFP4HfBTxZ4c+LHh268N6lfeKZL23t7soXktzZWsYkHlu4xvRhyc5FfqNQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9L9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//T/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9T9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9f9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==\"/>\n</defs>\n</svg>\n`;\n\n// src/plugins/open-api/index.ts\nvar getHTML = (apiReference) => `<!doctype html>\n<html>\n  <head>\n    <title>Scalar API Reference</title>\n    <meta charset=\"utf-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1\" />\n  </head>\n  <body>\n    <script\n      id=\"api-reference\"\n      type=\"application/json\">\n    ${JSON.stringify(apiReference)}\n    </script>\n\t <script>\n      var configuration = {\n\t  \tfavicon: \"data:image/svg+xml;utf8,${encodeURIComponent(logo)}\",\n\t   \ttheme: \"saturn\",\n        metaData: {\n\t\t\ttitle: \"Better Auth API\",\n\t\t\tdescription: \"API Reference for your Better Auth Instance\",\n\t\t}\n      }\n\n      document.getElementById('api-reference').dataset.configuration =\n        JSON.stringify(configuration)\n    </script>\n\t  <script src=\"https://cdn.jsdelivr.net/npm/@scalar/api-reference\"></script>\n  </body>\n</html>`;\nvar openAPI = (options) => {\n  const path = options?.path ?? \"/reference\";\n  return {\n    id: \"open-api\",\n    endpoints: {\n      generateOpenAPISchema: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/open-api/generate-schema\",\n        {\n          method: \"GET\"\n        },\n        async (ctx) => {\n          const schema = await generator(ctx.context, ctx.context.options);\n          return ctx.json(schema);\n        }\n      ),\n      openAPIReference: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        path,\n        {\n          method: \"GET\",\n          metadata: {\n            isAction: false\n          }\n        },\n        async (ctx) => {\n          if (options?.disableDefaultReference) {\n            throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"NOT_FOUND\");\n          }\n          const schema = await generator(ctx.context, ctx.context.options);\n          return new Response(getHTML(schema), {\n            headers: {\n              \"Content-Type\": \"text/html\"\n            }\n          });\n        }\n      )\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVBISFlVVkZJLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBaUY7QUFDN0I7QUFDSTs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwwQ0FBUztBQUN4QztBQUNBLDJCQUEyQiwwQ0FBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsSUFBSTtBQUNsQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsMENBQVMsNEJBQTRCLDRDQUFXO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMENBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsNENBQVc7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0NBQXdDLDRDQUFXO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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OlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVBISFlVVkZJLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgQVBJRXJyb3IsIGdldEVuZHBvaW50cyB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgZ2V0QXV0aFRhYmxlcyB9IGZyb20gJy4vY2h1bmstNjJNV0xMRUcuanMnO1xuaW1wb3J0IHsgWm9kT2JqZWN0LCBab2RTY2hlbWEsIFpvZE9wdGlvbmFsIH0gZnJvbSAnem9kJztcblxudmFyIHBhdGhzID0ge307XG5mdW5jdGlvbiBnZXRUeXBlRnJvbVpvZFR5cGUoem9kVHlwZSkge1xuICBzd2l0Y2ggKHpvZFR5cGUuY29uc3RydWN0b3IubmFtZSkge1xuICAgIGNhc2UgXCJab2RTdHJpbmdcIjpcbiAgICAgIHJldHVybiBcInN0cmluZ1wiO1xuICAgIGNhc2UgXCJab2ROdW1iZXJcIjpcbiAgICAgIHJldHVybiBcIm51bWJlclwiO1xuICAgIGNhc2UgXCJab2RCb29sZWFuXCI6XG4gICAgICByZXR1cm4gXCJib29sZWFuXCI7XG4gICAgY2FzZSBcIlpvZE9iamVjdFwiOlxuICAgICAgcmV0dXJuIFwib2JqZWN0XCI7XG4gICAgY2FzZSBcIlpvZEFycmF5XCI6XG4gICAgICByZXR1cm4gXCJhcnJheVwiO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0UGFyYW1ldGVycyhvcHRpb25zKSB7XG4gIGNvbnN0IHBhcmFtZXRlcnMgPSBbXTtcbiAgaWYgKG9wdGlvbnMubWV0YWRhdGE/Lm9wZW5hcGk/LnBhcmFtZXRlcnMpIHtcbiAgICBwYXJhbWV0ZXJzLnB1c2goLi4ub3B0aW9ucy5tZXRhZGF0YS5vcGVuYXBpLnBhcmFtZXRlcnMpO1xuICAgIHJldHVybiBwYXJhbWV0ZXJzO1xuICB9XG4gIGlmIChvcHRpb25zLnF1ZXJ5IGluc3RhbmNlb2YgWm9kT2JqZWN0KSB7XG4gICAgT2JqZWN0LmVudHJpZXMob3B0aW9ucy5xdWVyeS5zaGFwZSkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBab2RTY2hlbWEpIHtcbiAgICAgICAgcGFyYW1ldGVycy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiBrZXksXG4gICAgICAgICAgaW46IFwicXVlcnlcIixcbiAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgIHR5cGU6IGdldFR5cGVGcm9tWm9kVHlwZSh2YWx1ZSksXG4gICAgICAgICAgICAuLi5cIm1pbkxlbmd0aFwiIGluIHZhbHVlICYmIHZhbHVlLm1pbkxlbmd0aCA/IHtcbiAgICAgICAgICAgICAgbWluTGVuZ3RoOiB2YWx1ZS5taW5MZW5ndGhcbiAgICAgICAgICAgIH0gOiB7fSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB2YWx1ZS5kZXNjcmlwdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHBhcmFtZXRlcnM7XG59XG5mdW5jdGlvbiBnZXRSZXF1ZXN0Qm9keShvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zLm1ldGFkYXRhPy5vcGVuYXBpPy5yZXF1ZXN0Qm9keSkge1xuICAgIHJldHVybiBvcHRpb25zLm1ldGFkYXRhLm9wZW5hcGkucmVxdWVzdEJvZHk7XG4gIH1cbiAgaWYgKCFvcHRpb25zLmJvZHkpIHJldHVybiB2b2lkIDA7XG4gIGlmIChvcHRpb25zLmJvZHkgaW5zdGFuY2VvZiBab2RPYmplY3QgfHwgb3B0aW9ucy5ib2R5IGluc3RhbmNlb2YgWm9kT3B0aW9uYWwpIHtcbiAgICBjb25zdCBzaGFwZSA9IG9wdGlvbnMuYm9keS5zaGFwZTtcbiAgICBpZiAoIXNoYXBlKSByZXR1cm4gdm9pZCAwO1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTtcbiAgICBjb25zdCByZXF1aXJlZCA9IFtdO1xuICAgIE9iamVjdC5lbnRyaWVzKHNoYXBlKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFpvZFNjaGVtYSkge1xuICAgICAgICBwcm9wZXJ0aWVzW2tleV0gPSB7XG4gICAgICAgICAgdHlwZTogZ2V0VHlwZUZyb21ab2RUeXBlKHZhbHVlKSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdmFsdWUuZGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBab2RPcHRpb25hbCkpIHtcbiAgICAgICAgICByZXF1aXJlZC5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgcmVxdWlyZWQ6IG9wdGlvbnMuYm9keSBpbnN0YW5jZW9mIFpvZE9wdGlvbmFsID8gZmFsc2UgOiBvcHRpb25zLmJvZHkgPyB0cnVlIDogZmFsc2UsXG4gICAgICBjb250ZW50OiB7XG4gICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgcHJvcGVydGllcyxcbiAgICAgICAgICAgIHJlcXVpcmVkXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4gdm9pZCAwO1xufVxuZnVuY3Rpb24gZ2V0UmVzcG9uc2UocmVzcG9uc2VzKSB7XG4gIHJldHVybiB7XG4gICAgXCI0MDBcIjoge1xuICAgICAgY29udGVudDoge1xuICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJtZXNzYWdlXCJdXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVzY3JpcHRpb246IFwiQmFkIFJlcXVlc3QuIFVzdWFsbHkgZHVlIHRvIG1pc3NpbmcgcGFyYW1ldGVycywgb3IgaW52YWxpZCBwYXJhbWV0ZXJzLlwiXG4gICAgfSxcbiAgICBcIjQwMVwiOiB7XG4gICAgICBjb250ZW50OiB7XG4gICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVxdWlyZWQ6IFtcIm1lc3NhZ2VcIl1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjogXCJVbmF1dGhvcml6ZWQuIER1ZSB0byBtaXNzaW5nIG9yIGludmFsaWQgYXV0aGVudGljYXRpb24uXCJcbiAgICB9LFxuICAgIFwiNDAzXCI6IHtcbiAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjogXCJGb3JiaWRkZW4uIFlvdSBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyB0aGlzIHJlc291cmNlIG9yIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uXCJcbiAgICB9LFxuICAgIFwiNDA0XCI6IHtcbiAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjogXCJOb3QgRm91bmQuIFRoZSByZXF1ZXN0ZWQgcmVzb3VyY2Ugd2FzIG5vdCBmb3VuZC5cIlxuICAgIH0sXG4gICAgXCI0MjlcIjoge1xuICAgICAgY29udGVudDoge1xuICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiBcIlRvbyBNYW55IFJlcXVlc3RzLiBZb3UgaGF2ZSBleGNlZWRlZCB0aGUgcmF0ZSBsaW1pdC4gVHJ5IGFnYWluIGxhdGVyLlwiXG4gICAgfSxcbiAgICBcIjUwMFwiOiB7XG4gICAgICBjb250ZW50OiB7XG4gICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVzY3JpcHRpb246IFwiSW50ZXJuYWwgU2VydmVyIEVycm9yLiBUaGlzIGlzIGEgcHJvYmxlbSB3aXRoIHRoZSBzZXJ2ZXIgdGhhdCB5b3UgY2Fubm90IGZpeC5cIlxuICAgIH0sXG4gICAgLi4ucmVzcG9uc2VzXG4gIH07XG59XG5mdW5jdGlvbiB0b09wZW5BcGlQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGguc3BsaXQoXCIvXCIpLm1hcCgocGFydCkgPT4gcGFydC5zdGFydHNXaXRoKFwiOlwiKSA/IGB7JHtwYXJ0LnNsaWNlKDEpfX1gIDogcGFydCkuam9pbihcIi9cIik7XG59XG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0b3IoY3R4LCBvcHRpb25zKSB7XG4gIGNvbnN0IGJhc2VFbmRwb2ludHMgPSBnZXRFbmRwb2ludHMoY3R4LCB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBwbHVnaW5zOiBbXVxuICB9KTtcbiAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgY29uc3QgbW9kZWxzID0gT2JqZWN0LmVudHJpZXModGFibGVzKS5yZWR1Y2UoKGFjYywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgY29uc3QgbW9kZWxOYW1lID0ga2V5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsga2V5LnNsaWNlKDEpO1xuICAgIGFjY1ttb2RlbE5hbWVdID0ge1xuICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgIHByb3BlcnRpZXM6IE9iamVjdC5lbnRyaWVzKHZhbHVlLmZpZWxkcykucmVkdWNlKFxuICAgICAgICAoYWNjMiwgW2tleTIsIHZhbHVlMl0pID0+IHtcbiAgICAgICAgICBhY2MyW2tleTJdID0ge1xuICAgICAgICAgICAgdHlwZTogdmFsdWUyLnR5cGVcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBhY2MyO1xuICAgICAgICB9LFxuICAgICAgICB7IGlkOiB7IHR5cGU6IFwic3RyaW5nXCIgfSB9XG4gICAgICApXG4gICAgfTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIGNvbnN0IGNvbXBvbmVudHMgPSB7XG4gICAgc2NoZW1hczoge1xuICAgICAgLi4ubW9kZWxzXG4gICAgfVxuICB9O1xuICBPYmplY3QuZW50cmllcyhiYXNlRW5kcG9pbnRzLmFwaSkuZm9yRWFjaCgoW18sIHZhbHVlXSkgPT4ge1xuICAgIGNvbnN0IG9wdGlvbnMyID0gdmFsdWUub3B0aW9ucztcbiAgICBpZiAob3B0aW9uczIubWV0YWRhdGE/LlNFUlZFUl9PTkxZKSByZXR1cm47XG4gICAgY29uc3QgcGF0aCA9IHRvT3BlbkFwaVBhdGgodmFsdWUucGF0aCk7XG4gICAgaWYgKG9wdGlvbnMyLm1ldGhvZCA9PT0gXCJHRVRcIikge1xuICAgICAgcGF0aHNbcGF0aF0gPSB7XG4gICAgICAgIGdldDoge1xuICAgICAgICAgIHRhZ3M6IFtcIkRlZmF1bHRcIiwgLi4ub3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LnRhZ3MgfHwgW11dLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8uZGVzY3JpcHRpb24sXG4gICAgICAgICAgb3BlcmF0aW9uSWQ6IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5vcGVyYXRpb25JZCxcbiAgICAgICAgICBzZWN1cml0eTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBiZWFyZXJBdXRoOiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF0sXG4gICAgICAgICAgcGFyYW1ldGVyczogZ2V0UGFyYW1ldGVycyhvcHRpb25zMiksXG4gICAgICAgICAgcmVzcG9uc2VzOiBnZXRSZXNwb25zZShvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8ucmVzcG9uc2VzKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAob3B0aW9uczIubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgICAgY29uc3QgYm9keSA9IGdldFJlcXVlc3RCb2R5KG9wdGlvbnMyKTtcbiAgICAgIHBhdGhzW3BhdGhdID0ge1xuICAgICAgICBwb3N0OiB7XG4gICAgICAgICAgdGFnczogW1wiRGVmYXVsdFwiLCAuLi5vcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8udGFncyB8fCBbXV0sXG4gICAgICAgICAgZGVzY3JpcHRpb246IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5kZXNjcmlwdGlvbixcbiAgICAgICAgICBvcGVyYXRpb25JZDogb3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/Lm9wZXJhdGlvbklkLFxuICAgICAgICAgIHNlY3VyaXR5OiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJlYXJlckF1dGg6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXSxcbiAgICAgICAgICBwYXJhbWV0ZXJzOiBnZXRQYXJhbWV0ZXJzKG9wdGlvbnMyKSxcbiAgICAgICAgICAuLi5ib2R5ID8geyByZXF1ZXN0Qm9keTogYm9keSB9IDoge1xuICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgLy9zZXQgYm9keSBub25lXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXNwb25zZXM6IGdldFJlc3BvbnNlKG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5yZXNwb25zZXMpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9KTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2Ygb3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgaWYgKHBsdWdpbi5pZCA9PT0gXCJvcGVuLWFwaVwiKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgcGx1Z2luRW5kcG9pbnRzID0gZ2V0RW5kcG9pbnRzKGN0eCwge1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIHBsdWdpbnM6IFtwbHVnaW5dXG4gICAgfSk7XG4gICAgY29uc3QgYXBpID0gT2JqZWN0LmtleXMocGx1Z2luRW5kcG9pbnRzLmFwaSkubWFwKChrZXkpID0+IHtcbiAgICAgIGlmIChiYXNlRW5kcG9pbnRzLmFwaVtrZXldID09PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuIHBsdWdpbkVuZHBvaW50cy5hcGlba2V5XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0pLmZpbHRlcigoeCkgPT4geCAhPT0gbnVsbCk7XG4gICAgT2JqZWN0LmVudHJpZXMoYXBpKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGNvbnN0IG9wdGlvbnMyID0gdmFsdWUub3B0aW9ucztcbiAgICAgIGlmIChvcHRpb25zMi5tZXRhZGF0YT8uU0VSVkVSX09OTFkpIHJldHVybjtcbiAgICAgIGNvbnN0IHBhdGggPSB0b09wZW5BcGlQYXRoKHZhbHVlLnBhdGgpO1xuICAgICAgaWYgKG9wdGlvbnMyLm1ldGhvZCA9PT0gXCJHRVRcIikge1xuICAgICAgICBwYXRoc1twYXRoXSA9IHtcbiAgICAgICAgICBnZXQ6IHtcbiAgICAgICAgICAgIHRhZ3M6IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy50YWdzIHx8IFtcbiAgICAgICAgICAgICAgcGx1Z2luLmlkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcGx1Z2luLmlkLnNsaWNlKDEpXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIG9wZXJhdGlvbklkOiBvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8ub3BlcmF0aW9uSWQsXG4gICAgICAgICAgICBzZWN1cml0eTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmVhcmVyQXV0aDogW11cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IGdldFBhcmFtZXRlcnMob3B0aW9uczIpLFxuICAgICAgICAgICAgcmVzcG9uc2VzOiBnZXRSZXNwb25zZShvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8ucmVzcG9uc2VzKVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zMi5tZXRob2QgPT09IFwiUE9TVFwiKSB7XG4gICAgICAgIHBhdGhzW3BhdGhdID0ge1xuICAgICAgICAgIHBvc3Q6IHtcbiAgICAgICAgICAgIHRhZ3M6IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy50YWdzIHx8IFtcbiAgICAgICAgICAgICAgcGx1Z2luLmlkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcGx1Z2luLmlkLnNsaWNlKDEpXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IG9wdGlvbnMyLm1ldGFkYXRhPy5vcGVuYXBpPy5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIG9wZXJhdGlvbklkOiBvcHRpb25zMi5tZXRhZGF0YT8ub3BlbmFwaT8ub3BlcmF0aW9uSWQsXG4gICAgICAgICAgICBzZWN1cml0eTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmVhcmVyQXV0aDogW11cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IGdldFBhcmFtZXRlcnMob3B0aW9uczIpLFxuICAgICAgICAgICAgcmVxdWVzdEJvZHk6IGdldFJlcXVlc3RCb2R5KG9wdGlvbnMyKSxcbiAgICAgICAgICAgIHJlc3BvbnNlczogZ2V0UmVzcG9uc2Uob3B0aW9uczIubWV0YWRhdGE/Lm9wZW5hcGk/LnJlc3BvbnNlcylcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgY29uc3QgcmVzID0ge1xuICAgIG9wZW5hcGk6IFwiMy4xLjFcIixcbiAgICBpbmZvOiB7XG4gICAgICB0aXRsZTogXCJCZXR0ZXIgQXV0aFwiLFxuICAgICAgZGVzY3JpcHRpb246IFwiQVBJIFJlZmVyZW5jZSBmb3IgeW91ciBCZXR0ZXIgQXV0aCBJbnN0YW5jZVwiLFxuICAgICAgdmVyc2lvbjogXCIxLjEuMFwiXG4gICAgfSxcbiAgICBjb21wb25lbnRzLFxuICAgIHNlY3VyaXR5OiBbXG4gICAgICB7XG4gICAgICAgIGFwaUtleUNvb2tpZTogW11cbiAgICAgIH1cbiAgICBdLFxuICAgIHNlcnZlcnM6IFtcbiAgICAgIHtcbiAgICAgICAgdXJsOiBjdHguYmFzZVVSTFxuICAgICAgfVxuICAgIF0sXG4gICAgdGFnczogW1xuICAgICAge1xuICAgICAgICBuYW1lOiBcIkRlZmF1bHRcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGVmYXVsdCBlbmRwb2ludHMgdGhhdCBhcmUgaW5jbHVkZWQgd2l0aCBCZXR0ZXIgQXV0aCBieSBkZWZhdWx0LiBUaGVzZSBlbmRwb2ludHMgYXJlIG5vdCBwYXJ0IG9mIGFueSBwbHVnaW4uXCJcbiAgICAgIH1cbiAgICBdLFxuICAgIHBhdGhzXG4gIH07XG4gIHJldHVybiByZXM7XG59XG5cbi8vIHNyYy9wbHVnaW5zL29wZW4tYXBpL2xvZ28udHNcbnZhciBsb2dvID0gYDxzdmcgd2lkdGg9XCI3NVwiIGhlaWdodD1cIjc1XCIgdmlld0JveD1cIjAgMCA3NSA3NVwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHhtbG5zOnhsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiPlxuPHJlY3Qgd2lkdGg9XCI3NVwiIGhlaWdodD1cIjc1XCIgZmlsbD1cInVybCgjcGF0dGVybjBfMjFfMTIpXCIvPlxuPGRlZnM+XG48cGF0dGVybiBpZD1cInBhdHRlcm4wXzIxXzEyXCIgcGF0dGVybkNvbnRlbnRVbml0cz1cIm9iamVjdEJvdW5kaW5nQm94XCIgd2lkdGg9XCIxXCIgaGVpZ2h0PVwiMVwiPlxuPHVzZSB4bGluazpocmVmPVwiI2ltYWdlMF8yMV8xMlwiIHRyYW5zZm9ybT1cInNjYWxlKDAuMDAwOTQ2OTcpXCIvPlxuPC9wYXR0ZXJuPlxuPGltYWdlIGlkPVwiaW1hZ2UwXzIxXzEyXCIgd2lkdGg9XCIxMDU2XCIgaGVpZ2h0PVwiMTA1NlwiIHhsaW5rOmhyZWY9XCJkYXRhOmltYWdlL2pwZWc7YmFzZTY0LC85ai80QUFRU2taSlJnQUJBUUFBU0FCSUFBRC80UUJBUlhocFpnQUFUVTBBS2dBQUFBZ0FBWWRwQUFRQUFBQUJBQUFBR2dBQUFBQUFBcUFDQUFRQUFBQUJBQUFFSUtBREFBUUFBQUFCQUFBRUlBQUFBQUQvN1FBNFVHaHZkRzl6YUc5d0lETXVNQUE0UWtsTkJBUUFBQUFBQUFBNFFrbE5CQ1VBQUFBQUFCRFVIWXpaandDeUJPbUFDWmpzK0VKKy8rSUNLRWxEUTE5UVVrOUdTVXhGQUFFQkFBQUNHR0Z3Y0d3RUFBQUFiVzUwY2xKSFFpQllXVm9nQitZQUFRQUJBQUFBQUFBQVlXTnpjRUZRVUV3QUFBQUFRVkJRVEFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVBiV0FBRUFBQUFBMHkxaGNIQnM3UDJqamppRlI4TnR0TDFQZXRvWUx3QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFLWkdWell3QUFBUHdBQUFBd1kzQnlkQUFBQVN3QUFBQlFkM1J3ZEFBQUFYd0FBQUFVY2xoWldnQUFBWkFBQUFBVVoxaFpXZ0FBQWFRQUFBQVVZbGhaV2dBQUFiZ0FBQUFVY2xSU1F3QUFBY3dBQUFBZ1kyaGhaQUFBQWV3QUFBQXNZbFJTUXdBQUFjd0FBQUFnWjFSU1F3QUFBY3dBQUFBZ2JXeDFZd0FBQUFBQUFBQUJBQUFBREdWdVZWTUFBQUFVQUFBQUhBQkVBR2tBY3dCd0FHd0FZUUI1QUNBQVVBQXpiV3gxWXdBQUFBQUFBQUFCQUFBQURHVnVWVk1BQUFBMEFBQUFIQUJEQUc4QWNBQjVBSElBYVFCbkFHZ0FkQUFnQUVFQWNBQndBR3dBWlFBZ0FFa0FiZ0JqQUM0QUxBQWdBRElBTUFBeUFESllXVm9nQUFBQUFBQUE5dFVBQVFBQUFBRFRMRmhaV2lBQUFBQUFBQUNEM3dBQVBiLy8vLys3V0ZsYUlBQUFBQUFBQUVxL0FBQ3hOd0FBQ3JsWVdWb2dBQUFBQUFBQUtEZ0FBQkVMQUFESXVYQmhjbUVBQUFBQUFBTUFBQUFDWm1ZQUFQS25BQUFOV1FBQUU5QUFBQXBiYzJZek1nQUFBQUFBQVF4Q0FBQUYzdi8vOHlZQUFBZVRBQUQ5a1AvLys2TC8vLzJqQUFBRDNBQUF3Rzcvd0FBUkNBUWdCQ0FEQVNJQUFoRUJBeEVCLzhRQUh3QUFBUVVCQVFFQkFRRUFBQUFBQUFBQUFBRUNBd1FGQmdjSUNRb0wvOFFBdFJBQUFnRURBd0lFQXdVRkJBUUFBQUY5QVFJREFBUVJCUkloTVVFR0UxRmhCeUp4RkRLQmthRUlJMEt4d1JWUzBmQWtNMkp5Z2drS0ZoY1lHUm9sSmljb0tTbzBOVFkzT0RrNlEwUkZSa2RJU1VwVFZGVldWMWhaV21Oa1pXWm5hR2xxYzNSMWRuZDRlWHFEaElXR2g0aUppcEtUbEpXV2w1aVptcUtqcEtXbXA2aXBxckt6dExXMnQ3aTV1c0xEeE1YR3g4akp5dExUMU5YVzE5aloydUhpNCtUbDV1Zm82ZXJ4OHZQMDlmYjMrUG42LzhRQUh3RUFBd0VCQVFFQkFRRUJBUUFBQUFBQUFBRUNBd1FGQmdjSUNRb0wvOFFBdFJFQUFnRUNCQVFEQkFjRkJBUUFBUUozQUFFQ0F4RUVCU0V4QmhKQlVRZGhjUk1pTW9FSUZFS1JvYkhCQ1NNelV2QVZZbkxSQ2hZa05PRWw4UmNZR1JvbUp5Z3BLalUyTnpnNU9rTkVSVVpIU0VsS1UxUlZWbGRZV1ZwalpHVm1aMmhwYW5OMGRYWjNlSGw2Z29PRWhZYUhpSW1La3BPVWxaYVhtSm1hb3FPa3BhYW5xS21xc3JPMHRiYTN1TG02d3NQRXhjYkh5TW5LMHRQVTFkYlgyTm5hNHVQazVlYm42T25xOHZQMDlmYjMrUG42LzlzQVF3QUNBZ0lDQWdJREFnSURCQU1EQXdRRkJBUUVCQVVIQlFVRkJRVUhDQWNIQndjSEJ3Z0lDQWdJQ0FnSUNnb0tDZ29LQ3dzTEN3c05EUTBORFEwTkRRME4vOXNBUXdFQ0FnSURBd01HQXdNR0RRa0hDUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTkRRME5EUTBORFEwTi85MEFCQUJDLzlvQURBTUJBQUlSQXhFQVB3RDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vUS9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMGYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOUw5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1QvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzFQMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlYOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9XL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8xLzM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85RDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vUi9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMHYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOVA5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1UvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzFmMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzliOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9YL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8wUDM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85SDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vUy9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMC8zOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOVQ5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1YvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzF2Mzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUsvTG4vZ3EzOGEvaW44RHZncDRUOFIvQ2Z4RmRlRzlTdnZGTWRsY1hGb0VMeVc1c3JxUXhuekVjWTNvcDRHY2l2MUdyOFovK0MyWC9Kdlhnai9zYzR2L0FFMzNsQUg0ei84QUR3djl0RC9vcTJ0Zjk4MjMvd0Faby80ZUYvdG9mOUZXMXIvdm0yLytNMThaMFVBZlpuL0R3djhBYlEvNkt0clgvZk50L3dER2FQOEFoNFgrMmgvMFZiV3YrK2JiL3dDTTE4WjBVQWZabi9Ed3Y5dEQvb3EydGY4QWZOdC84Wm8vNGVGL3RvZjlGVzFyL3ZtMi93RGpOZkdkRkFIMlovdzhML2JRL3dDaXJhMS8zemJmL0dhUCtIaGY3YUgvQUVWYld2OEF2bTIvK00xOFowVUFmWm4vQUE4TC9iUS82S3RyWC9mTnQvOEFHYVArSGhmN2FIL1JWdGEvNzV0di9qTmZHZEZBSDJaL3c4TC9BRzBQK2lyYTEvM3piZjhBeG1qL0FJZUYvdG9mOUZXMXIvdm0yLzhBak5mR2RGQUg2My9zVmZ0cS90VGZFYjlxYjRkZUNmRzN4RjFUVnREMWJWR2d2YktkWUJIUEdJSlcydHRpVnNibEI0STZWL1ViWDhaLy9CUFQvazlENFUvOWhwdi9BRW1tcit6Q2dBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrTS93RDRlRi90b2Y4QVJWdGEvd0MrYmIvNHpSL3c4TC9iUS82S3RyWC9BSHpiZi9HYStNNktBUHN6L2g0WCsyaC8wVmJXdisrYmIvNHpSL3c4TC9iUS93Q2lyYTEvM3piZi9HYStNNktBUHN6L0FJZUYvdG9mOUZXMXIvdm0yLzhBak5IL0FBOEwvYlEvNkt0clgvZk50LzhBR2ErTTZLQVBzei9oNFgrMmgvMFZiV3YrK2JiL0FPTTBmOFBDL3dCdEQvb3EydGY5ODIzL0FNWnI0em9vQSt6UCtIaGY3YUgvQUVWYld2OEF2bTIvK00wZjhQQy8yMFAraXJhMS93QjgyMy94bXZqT2lnRDdNLzRlRi90b2Y5Rlcxci92bTIvK00wZjhQQy8yMFA4QW9xMnRmOTgyMy94bXZqT2lnRDdNL3dDSGhmN2FIL1JWdGEvNzV0di9BSXpSL3dBUEMvMjBQK2lyYTEvM3piZi9BQm12ak9pZ0Q3TS80ZUYvdG9mOUZXMXIvdm0yL3dEak5IL0R3djhBYlEvNkt0clgvZk50L3dER2ErTTZLQVBzei9oNFgrMmgvd0JGVzFyL0FMNXR2L2pOSC9Ed3Y5dEQvb3EydGY4QWZOdC84WnI0em9vQSt6UCtIaGY3YUgvUlZ0YS83NXR2L2pOSC9Ed3Y5dEQvQUtLdHJYL2ZOdC84WnI0em9vQSt6UDhBaDRYKzJoLzBWYld2KytiYi93Q00wZjhBRHd2OXREL29xMnRmOTgyMy93QVpyNHpvb0ErelArSGhmN2FIL1JWdGEvNzV0djhBNHpSL3c4TC9BRzBQK2lyYTEvM3piZjhBeG12ak9pZ0Q3TS80ZUYvdG9mOEFSVnRhL3dDK2JiLzR6Ui93OEwvYlEvNkt0clgvQUh6YmYvR2ErTTZLQVA2dHYrQ1VueHIrS2Z4eCtDbml6eEg4V1BFVjE0azFLeDhVeVdWdmNYWVFQSGJpeXRaQkdQTFJCamU3SGtaeWEvVWF2eG4vQU9DSnYvSnZYamYvQUxIT1gvMDMyZGZzeFFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFmLy9YL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0FyOFovK0MyWC9Kdlhnai9zYzR2L0FFMzNsZnN4WDR6L0FQQmJML2szcndSLzJPY1gvcHZ2S0FQNW02S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQSt6UCtDZW4vSjZId3AvN0RUZitrMDFmMllWL0dmOEE4RTlQK1QwUGhULzJHbS85SnBxL3N3b0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9nRG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9way80SW0vOG05ZU4vOEFzYzVmL1RmWjErekZmalAvQU1FVGYrVGV2Ry8vQUdPY3YvcHZzNi9aaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvOUQ5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ3Z4bi80TFpmOG05ZUNQK3h6aS84QVRmZVYrekZmalA4QThGc3YrVGV2QkgvWTV4ZittKzhvQS9tYm9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEN00vNEo2Zjhub2ZDbi9zTk4vNlRUVi9aaFg4Wi93RHdUMC81UFErRlAvWWFiLzBtbXIrekNnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK0FPaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK21UL2dpYi95YjE0My93Q3h6bC85TjluWDdNVitNLzhBd1JOLzVONjhiLzhBWTV5LyttK3pyOW1LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC8wZjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLL0dmL2d0bC95YjE0SS83SE9ML3dCTjk1WDdNVitNL3dEd1d5LzVONjhFZjlqbkYvNmI3eWdEK1p1aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVBzei9nbnAveWVoOEtmK3cwMy9wTk5YOW1GZnhuL0FQQlBUL2s5RDRVLzlocHYvU2FhdjdNS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA0QTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA2WlArQ0p2L0p2WGpmL0FMSE9YLzAzMmRmc3hYNHovd0RCRTMvazNyeHYvd0JqbkwvNmI3T3YyWW9BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQL1MvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQXI4Wi8rQzJYL0p2WGdqL3NjNHYvQUUzM2xmc3hYNHovQVBCYkwvazNyd1IvMk9jWC9wdnZLQVA1bTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BK3pQK0Nlbi9KNkh3cC83RFRmK2swMWYyWVYvR2Y4QThFOVArVDBQaFQvMkdtLzlKcHEvc3dvQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL2dEb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL3BrLzRJbS84bTllTi84QXNjNWYvVGZaMSt6RmZqUC9BTUVUZitUZXZHLy9BR09jdi9wdnM2L1ppZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS85UDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDdnhuLzRMWmY4bTllQ1AreHppLzhBVGZlVit6RmZqUDhBOEZzditUZXZCSC9ZNXhmK20rOG9BL21ib29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Q3TS80SjZmOG5vZkNuL3NOTi82VFRWL1poWDhaL3dEd1QwLzVQUStGUC9ZYWIvMG1tcit6Q2dBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrQU9paWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QrbVQvZ2liL3liMTQzL3dDeHpsLzlOOW5YN01WK00vOEF3Uk4vNU42OGIvOEFZNXkvK20renI5bUtBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzFQMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUsvR2YvZ3RsL3liMTRJLzdIT0wvd0JOOTVYN01WK00vd0R3V3kvNU42OEVmOWpuRi82Yjd5Z0QrWnVpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUHN6L2ducC95ZWg4S2YrdzAzL3BOTlg5bUZmd3EvQlQ0cjYzOER2aW40ZCtMSGh5MHRiN1V2RGQwYnUzdDcwT2JlUnpHMGVKQkd5UGpEbm93T2EvVWIvaDlsKzBML0FOQ1I0TS83OWFoLzhtMEFmMHlVVi9NMy93QVBzdjJoZitoSThHZjkrdFEvK1RhUCtIMlg3UXYvQUVKSGd6L3YxcUgvQU1tMEFmMHlVVi9NMy93K3kvYUYvd0NoSThHZjkrdFEvd0RrMmovaDlsKzBMLzBKSGd6L0FMOWFoLzhBSnRBSDlNbEZmek4vOFBzdjJoZitoSThHZjkrdFEvOEFrMmovQUlmWmZ0Qy85Q1I0TS83OWFoLzhtMEFmMHlVVi9NMy9BTVBzdjJoZitoSThHZjhBZnJVUC9rMmovaDlsKzBML0FOQ1I0TS83OWFoLzhtMEFmMHlVVi9NMy93QVBzdjJoZitoSThHZjkrdFEvK1RhUCtIMlg3UXYvQUVKSGd6L3YxcUgvQU1tMEFmMHlVVi9NMy93K3kvYUYvd0NoSThHZjkrdFEvd0RrMmovaDlsKzBMLzBKSGd6L0FMOWFoLzhBSnRBSDR6MFYvVEovdzVOL1o2LzZIZnhuL3dCL2RQOEEva0tqL2h5Yit6MS8wTy9qUC92N3AvOEE4aFVBZnpOMFYvVEovd0FPVGYyZXYraDM4Wi85L2RQL0FQa0tqL2h5Yit6MS93QkR2NHovQU8vdW4vOEF5RlFCL00zUlg5TW4vRGszOW5yL0FLSGZ4bi8zOTAvL0FPUXFQK0hKdjdQWC9RNytNLzhBdjdwLy93QWhVQWZ6TjBWL1RKL3c1Ti9aNi82SGZ4bi9BTi9kUC84QWtLai9BSWNtL3M5ZjlEdjR6LzcrNmY4QS9JVkFIOHpkRmYweWY4T1RmMmV2K2gzOFovOEFmM1QvQVA1Q28vNGNtL3M5ZjlEdjR6LzcrNmYvQVBJVkFIOHpkRmYweWY4QURrMzluci9vZC9HZi9mM1Qvd0Q1Q28vNGNtL3M5ZjhBUTcrTS93RHY3cC8vQU1oVUFmek4wVi9USi93NU4vWjYvd0NoMzhaLzkvZFAvd0RrS3Z3Vi9hZytGR2lmQTc0KytNL2hQNGN1N3ErMDN3M2ZpMHQ3aTlLRzRrUXhSeVprTWFvbWN1ZWlnWW9BOEZvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCttVC9naWIveWIxNDMvQU94emwvOEFUZloxK3pGZmpQOEE4RVRmK1RldkcvOEEyT2N2L3B2czYvWmlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy85WDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDdnhuLzRMWmY4bTllQ1AreHppLzhBVGZlVit6RmZqUDhBOEZzditUZXZCSC9ZNXhmK20rOG9BL21ib29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BL3Y4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0FyK00vL2dvWC93QW5vZkZiL3NOTC93Q2swTmYyWVYvR2Yvd1VMLzVQUStLMy9ZYVgvd0JKb2FBUGpPaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA2WlArQ0p2L0p2WGpmL0FMSE9YLzAzMmRmc3hYNHovd0RCRTMvazNyeHYvd0JqbkwvNmI3T3YyWW9BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQL1cvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQXI4Wi8rQzJYL0p2WGdqL3NjNHYvQUUzM2xmc3hYNHovQVBCYkwvazNyd1IvMk9jWC9wdnZLQVA1bTZLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA3L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BSy9qUC80S0YvOEFKNkh4Vy83RFMvOEFwTkRYOW1GZnhuLzhGQy8rVDBQaXQvMkdsLzhBU2FHZ0Q0em9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK21UL2dpYi95YjE0My93Q3h6bC85TjluWDdNVitNLzhBd1JOLzVONjhiLzhBWTV5LyttK3pyOW1LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC8xLzM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLL0dmL2d0bC95YjE0SS83SE9ML3dCTjk1WDdNVitNL3dEd1d5LzVONjhFZjlqbkYvNmI3eWdEK1p1aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEKy95aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUN2NHovK0NoZi9BQ2VoOFZ2K3cwdi9BS1RRMS9aaFg4Wi8vQlF2L2s5RDRyZjlocGYvQUVtaG9BK002S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9way80SW0vOG05ZU4vOEFzYzVmL1RmWjErekZmalAvQU1FVGYrVGV2Ry8vQUdPY3YvcHZzNi9aaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvOUQ5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ3Z4bi80TFpmOG05ZUNQK3h6aS84QVRmZVYrekZmalA4QThGc3YrVGV2QkgvWTV4ZittKzhvQS9tYm9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS92OG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBcitNLy9nb1gvd0Fub2ZGYi9zTkwvd0NrME5mMllWL0dmL3dVTC81UFErSzMvWWFYL3dCSm9hQVBqT2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQNlpQK0NKdi9KdlhqZi9BTEhPWC8wMzJkZnN4WDR6L3dEQkUzL2szcnh2L3dCam5MLzZiN092MllvQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC9SL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0FyOFovK0MyWC9Kdlhnai9zYzR2L0FFMzNsZnN4WDR6L0FQQmJML2szcndSLzJPY1gvcHZ2S0FQNW02S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQNy9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUsvalAvNEtGLzhBSjZIeFcvN0RTLzhBcE5EWDltRmZ4bi84RkMvK1QwUGl0LzJHbC84QVNhR2dENHpvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCttVC9naWIveWIxNDMvd0N4emwvOU45blg3TVYrTS84QXdSTi81TjY4Yi84QVk1eS8rbSt6cjltS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvMHYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BSy9HZi9ndGwveWIxNEkvN0hPTC93Qk45NVg3TVYrTS93RHdXeS81TjY4RWY5am5GLzZiN3lnRCtadWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCsveWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDdjR6LytDaGYvQUNlaDhWdit3MHYvQUtUUTEvWmhYOFovL0JRdi9rOUQ0cmY5aHBmL0FFbWhvQStNNktLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvcGsvNEltLzhtOWVOLzhBc2M1Zi9UZloxK3pGZmpQL0FNRVRmK1RldkcvL0FHT2N2L3B2czYvWmlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLzlQOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUN2eG4vNExaZjhtOWVDUCt4emkvOEFUZmVWK3pGZmpQOEE4RnN2K1RldkJIL1k1eGYrbSs4b0EvbWJvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRDFMNEtmQ2pXL2pqOFUvRHZ3bjhPWGRyWTZsNGt1amFXOXhlbHhieHVJMmt6SVkxZDhZUTlGSnpYNmpmOE9UZjJoZjhBb2QvQm4vZjNVUDhBNUNyNHovNEo2ZjhBSjZId3AvN0RUZjhBcE5OWDltRkFIOHpmL0RrMzlvWC9BS0hmd1ovMzkxRC9BT1FxUCtISnY3UXYvUTcrRFA4QXY3cUgvd0FoVi9USlJRQi9NMy93NU4vYUYvNkhmd1ovMzkxRC93Q1FxUDhBaHliKzBMLzBPL2d6L3Y3cUgveUZYOU1sRkFIOHpmOEF3NU4vYUYvNkhmd1ovd0IvZFEvK1FxUCtISnY3UXY4QTBPL2d6L3Y3cUgveUZYOU1sRkFIOHpmL0FBNU4vYUYvNkhmd1ovMzkxRC81Q28vNGNtL3RDLzhBUTcrRFArL3VvZjhBeUZYOU1sRkFIOHpmL0RrMzlvWC9BS0hmd1ovMzkxRC9BT1FxUCtISnY3UXYvUTcrRFA4QXY3cUgvd0FoVi9USlJRQi9NMy93NU4vYUYvNkhmd1ovMzkxRC93Q1FxUDhBaHliKzBMLzBPL2d6L3Y3cUgveUZYOU1sRkFINHovOEFEN0w5bnIvb1NQR2YvZnJUL3dENU5vLzRmWmZzOWY4QVFrZU0vd0R2MXAvL0FNbTEvTTNSUUIvVEovdyt5L1o2L3dDaEk4Wi85K3RQL3dEazJqL2g5bCt6MS8wSkhqUC9BTDlhZi84QUp0ZnpOMFVBZjB5ZjhQc3YyZXYraEk4Wi93RGZyVC8vQUpOby93Q0gyWDdQWC9Ra2VNLysvV24vQVB5Ylg4emRGQUg5TW4vRDdMOW5yL29TUEdmL0FINjAvd0QrVGFQK0gyWDdQWC9Ra2VNLysvV24vd0R5Ylg4emRGQUg5TW4vQUEreS9aNi82RWp4bi8zNjAvOEErVGFQK0gyWDdQWC9BRUpIalA4QTc5YWYvd0RKdGZ6TjBVQWYweWY4UHN2MmV2OEFvU1BHZi9mclQvOEE1Tm8vNGZaZnM5ZjlDUjR6L3dDL1duLy9BQ2JYOHpkRkFIOU1uL0Q3TDluci9vU1BHZjhBMzYwLy93Q1RhL0JYOXFENHI2SjhjZmo3NHorTEhoeTB1ckhUZkVsK0x1M3Q3MElMaU5CRkhIaVFSczZaeWg2TVJpdkJhS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVA2WlArQ0p2L0FDYjE0My83SE9YL0FOTjluWDdNVitNLy9CRTMvazNyeHY4QTlqbkwvd0NtK3pyOW1LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC8vVS9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBcjhaLytDMlgvSnZYZ2ovc2M0di9BRTMzbGZzeFg0ei9BUEJiTC9rM3J3Ui8yT2NYL3B2dktBUDVtNktLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0ErelArQ2VuL0o2SHdwLzdEVGYrazAxZjJZVi9HZjhBOEU5UCtUMFBoVC8yR20vOUpwcS9zd29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvZ0Rvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvcGsvNEltLzhtOWVOLzhBc2M1Zi9UZloxK3pGZmpQL0FNRVRmK1RldkcvL0FHT2N2L3B2czYvWmlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLzlYOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUN2eG4vNExaZjhtOWVDUCt4emkvOEFUZmVWK3pGZmpQOEE4RnN2K1RldkJIL1k1eGYrbSs4b0EvbWJvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRDdNLzRKNmY4bm9mQ24vc05OLzZUVFYvWmhYOFovd0R3VDAvNVBRK0ZQL1lhYi8wbW1yK3pDZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCtBT2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRCttVC9naWIveWIxNDMvd0N4emwvOU45blg3TVYrTS84QXdSTi81TjY4Yi84QVk1eS8rbSt6cjltS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvMXYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BSy9HZi9ndGwveWIxNEkvN0hPTC93Qk45NVg3TVYrTS93RHdXeS81TjY4RWY5am5GLzZiN3lnRCtadWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQc3ovZ25wL3llaDhLZit3MDMvcE5OWDltRmZ4bi9BUEJQVC9rOUQ0VS85aHB2L1NhYXY3TUtBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQNEE2S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQNlpQK0NKdi9KdlhqZi9BTEhPWC8wMzJkZnN4WDR6L3dEQkUzL2szcnh2L3dCam5MLzZiN092MllvQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC9YL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0FyOFovK0MyWC9Kdlhnai9zYzR2L0FFMzNsZnN4WDR6L0FQQmJML2szcndSLzJPY1gvcHZ2S0FQNW02S0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQSt6UCtDZW4vSjZId3AvN0RUZitrMDFmMllWL0dmOEE4RTlQK1QwUGhULzJHbS85SnBxL3N3b0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9nRG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9way80SW0vOG05ZU4vOEFzYzVmL1RmWjErekZmalAvQU1FVGYrVGV2Ry8vQUdPY3YvcHZzNi9aaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvOUQ5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ3Z4bi80TFpmOG05ZUNQK3h6aS84QVRmZVYrekZmalA4QThGc3YrVGV2QkgvWTV4ZittKzhvQS9tYm9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEN00vNEo2Zjhub2ZDbi9zTk4vNlRUVi9aaFg4Wi93RHdUMC81UFErRlAvWWFiLzBtbXIrekNnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK0FPaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdEK21UL2dpYi95YjE0My93Q3h6bC85TjluWDdNVitNLzhBd1JOLzVONjhiLzhBWTV5LyttK3pyOW1LQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC8wZjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLL0dmL2d0bC95YjE0SS83SE9ML3dCTjk1WDdNVitYUC9CVnY0S2ZGUDQ0L0JUd240YytFL2gyNjhTYWxZK0tZNzI0dDdRb0hqdHhaWFVaa1BtT2d4dmRSd2M1TkFIOHBORmZabi9EdlQ5dEQvb2xPdGY5OVczL0FNZW8vd0NIZW43YUgvUktkYS83NnR2L0FJOVFCOFowVjltZjhPOVAyMFAraVU2MS93QjlXMy94NmovaDNwKzJoLzBTbld2KytyYi9BT1BVQWZHZEZmWm4vRHZUOXREL0FLSlRyWC9mVnQvOGVvLzRkNmZ0b2Y4QVJLZGEvd0MrcmIvNDlRQjhaMFY5bWY4QUR2VDl0RC9vbE90Zjk5VzMvd0Flby80ZDZmdG9mOUVwMXIvdnEyLytQVUFmR2RGZlpuL0R2VDl0RC9vbE90Zjk5VzMvQU1lby93Q0hlbjdhSC9SS2RhLzc2dHYvQUk5UUI4WjBWOW1mOE85UDIwUCtpVTYxL3dCOVczL3g2ai9oM3ArMmgvMFNuV3YrK3JiL0FPUFVBSC9CUFQvazlENFUvd0RZYWIvMG1tcit6Q3Y1Y3YyS3YyS3YycHZoeisxTjhPdkczamI0ZGFwcE9oNlRxalQzdDdPMEJqZ2pNRXE3bTJ5czJOekFjQTlhL3FOb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS9nRG9yN00vd0NIZW43YUgvUktkYS83NnR2L0FJOVIvd0FPOVAyMFAraVU2MS8zMWJmL0FCNmdENHpvcjdNLzRkNmZ0b2Y5RXAxci92cTIvd0RqMUgvRHZUOXREL29sT3RmOTlXMy9BTWVvQStNNksrelArSGVuN2FIL0FFU25XdjhBdnEyLytQVWY4TzlQMjBQK2lVNjEvd0I5VzMveDZnRDR6b3I3TS80ZDZmdG9mOUVwMXIvdnEyLytQVWY4TzlQMjBQOEFvbE90Zjk5VzMveDZnRDR6b3I3TS93Q0hlbjdhSC9SS2RhLzc2dHYvQUk5Ui93QU85UDIwUCtpVTYxLzMxYmYvQUI2Z0Q0em9yN00vNGQ2ZnRvZjlFcDFyL3ZxMi93RGoxSC9EdlQ5dEQvb2xPdGY5OVczL0FNZW9BK002Syt6UCtIZW43YUgvQUVTbld2OEF2cTIvK1BVZjhPOVAyMFAraVU2MS93QjlXMy94NmdENHpvcjdNLzRkNmZ0b2Y5RXAxci92cTIvK1BVZjhPOVAyMFA4QW9sT3RmOTlXMy94NmdENHpvcjdNL3dDSGVuN2FIL1JLZGEvNzZ0di9BSTlSL3dBTzlQMjBQK2lVNjEvMzFiZi9BQjZnRDR6b3I3TS80ZDZmdG9mOUVwMXIvdnEyL3dEajFIL0R2VDl0RC9vbE90Zjk5VzMvQU1lb0ErTTZLK3pQK0hlbjdhSC9BRVNuV3Y4QXZxMi8rUFVmOE85UDIwUCtpVTYxL3dCOVczL3g2Z0Q0em9yN00vNGQ2ZnRvZjlFcDFyL3ZxMi8rUFVmOE85UDIwUDhBb2xPdGY5OVczL3g2Z0Q0em9yN00vd0NIZW43YUgvUktkYS83NnR2L0FJOVIvd0FPOVAyMFAraVU2MS8zMWJmL0FCNmdEOW1QK0NKdi9KdlhqZjhBN0hPWC93Qk45blg3TVYrWFAvQktUNEtmRlA0SGZCVHhaNGMrTEhoMjY4TjZsZmVLWkwyM3Q3c29Ya3R6WldzWWtIbHU0eHZSaHljNUZmcU5RQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBRkZGRkFCUlJSUUFVVVVVQUZGRkZBQlJSUlFBVVVVVUFGRkZGQUJSUlJRQVVVVVVBZi85TDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVC9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMVAzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOVg5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1cvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzEvMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlEOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9SL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8wdjM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85UDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVS9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMWYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOWI5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1gvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzBQMzhvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdELzlIOS9LS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BLy9TL2Z5aWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBUC8wLzM4b29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnRC85VDkvS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQS8vVi9meWlpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQVAvMXYzOG9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0QvOWY5L0tLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0EvL1EvZnlpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FDaWlpZ0Fvb29vQUtLS0tBQ2lpaWdBb29vb0FLS0tLQUNpaWlnQW9vb29BS0tLS0FQLzJRPT1cIi8+XG48L2RlZnM+XG48L3N2Zz5cbmA7XG5cbi8vIHNyYy9wbHVnaW5zL29wZW4tYXBpL2luZGV4LnRzXG52YXIgZ2V0SFRNTCA9IChhcGlSZWZlcmVuY2UpID0+IGA8IWRvY3R5cGUgaHRtbD5cbjxodG1sPlxuICA8aGVhZD5cbiAgICA8dGl0bGU+U2NhbGFyIEFQSSBSZWZlcmVuY2U8L3RpdGxlPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJ1dGYtOFwiIC8+XG4gICAgPG1ldGFcbiAgICAgIG5hbWU9XCJ2aWV3cG9ydFwiXG4gICAgICBjb250ZW50PVwid2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTFcIiAvPlxuICA8L2hlYWQ+XG4gIDxib2R5PlxuICAgIDxzY3JpcHRcbiAgICAgIGlkPVwiYXBpLXJlZmVyZW5jZVwiXG4gICAgICB0eXBlPVwiYXBwbGljYXRpb24vanNvblwiPlxuICAgICR7SlNPTi5zdHJpbmdpZnkoYXBpUmVmZXJlbmNlKX1cbiAgICA8L3NjcmlwdD5cblx0IDxzY3JpcHQ+XG4gICAgICB2YXIgY29uZmlndXJhdGlvbiA9IHtcblx0ICBcdGZhdmljb246IFwiZGF0YTppbWFnZS9zdmcreG1sO3V0ZjgsJHtlbmNvZGVVUklDb21wb25lbnQobG9nbyl9XCIsXG5cdCAgIFx0dGhlbWU6IFwic2F0dXJuXCIsXG4gICAgICAgIG1ldGFEYXRhOiB7XG5cdFx0XHR0aXRsZTogXCJCZXR0ZXIgQXV0aCBBUElcIixcblx0XHRcdGRlc2NyaXB0aW9uOiBcIkFQSSBSZWZlcmVuY2UgZm9yIHlvdXIgQmV0dGVyIEF1dGggSW5zdGFuY2VcIixcblx0XHR9XG4gICAgICB9XG5cbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcGktcmVmZXJlbmNlJykuZGF0YXNldC5jb25maWd1cmF0aW9uID1cbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoY29uZmlndXJhdGlvbilcbiAgICA8L3NjcmlwdD5cblx0ICA8c2NyaXB0IHNyYz1cImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vQHNjYWxhci9hcGktcmVmZXJlbmNlXCI+PC9zY3JpcHQ+XG4gIDwvYm9keT5cbjwvaHRtbD5gO1xudmFyIG9wZW5BUEkgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBwYXRoID0gb3B0aW9ucz8ucGF0aCA/PyBcIi9yZWZlcmVuY2VcIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJvcGVuLWFwaVwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgZ2VuZXJhdGVPcGVuQVBJU2NoZW1hOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL29wZW4tYXBpL2dlbmVyYXRlLXNjaGVtYVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBzY2hlbWEgPSBhd2FpdCBnZW5lcmF0b3IoY3R4LmNvbnRleHQsIGN0eC5jb250ZXh0Lm9wdGlvbnMpO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihzY2hlbWEpO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgb3BlbkFQSVJlZmVyZW5jZTogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBwYXRoLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBpc0FjdGlvbjogZmFsc2VcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBpZiAob3B0aW9ucz8uZGlzYWJsZURlZmF1bHRSZWZlcmVuY2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2NoZW1hID0gYXdhaXQgZ2VuZXJhdG9yKGN0eC5jb250ZXh0LCBjdHguY29udGV4dC5vcHRpb25zKTtcbiAgICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGdldEhUTUwoc2NoZW1hKSwge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcInRleHQvaHRtbFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgeyBvcGVuQVBJIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   anonymous: () => (/* binding */ anonymous)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n\n\n\n\n\n// src/plugins/anonymous/index.ts\nvar schema = {\n  user: {\n    fields: {\n      isAnonymous: {\n        type: \"boolean\",\n        required: false\n      }\n    }\n  }\n};\nvar anonymous = (options) => {\n  const ERROR_CODES = {\n    FAILED_TO_CREATE_USER: \"Failed to create user\",\n    COULD_NOT_CREATE_SESSION: \"Could not create session\",\n    ANONYMOUS_USERS_CANNOT_SIGN_IN_AGAIN_ANONYMOUSLY: \"Anonymous users cannot sign in again anonymously\"\n  };\n  return {\n    id: \"anonymous\",\n    endpoints: {\n      signInAnonymous: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/anonymous\",\n        {\n          method: \"POST\",\n          metadata: {\n            openapi: {\n              description: \"Sign in anonymously\",\n              responses: {\n                200: {\n                  description: \"Sign in anonymously\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { emailDomainName = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getOrigin)(ctx.context.baseURL) } = options || {};\n          const id = ctx.context.generateId({ model: \"user\" });\n          const email = `temp-${id}@${emailDomainName}`;\n          const newUser = await ctx.context.internalAdapter.createUser({\n            id,\n            email,\n            emailVerified: false,\n            isAnonymous: true,\n            name: \"Anonymous\",\n            createdAt: /* @__PURE__ */ new Date(),\n            updatedAt: /* @__PURE__ */ new Date()\n          });\n          if (!newUser) {\n            return ctx.json(null, {\n              status: 500,\n              body: {\n                message: ERROR_CODES.FAILED_TO_CREATE_USER,\n                status: 500\n              }\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            newUser.id,\n            ctx.request\n          );\n          if (!session) {\n            return ctx.json(null, {\n              status: 400,\n              body: {\n                message: ERROR_CODES.COULD_NOT_CREATE_SESSION\n              }\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n            session,\n            user: newUser\n          });\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: newUser.id,\n              email: newUser.email,\n              emailVerified: newUser.emailVerified,\n              name: newUser.name,\n              createdAt: newUser.createdAt,\n              updatedAt: newUser.updatedAt\n            }\n          });\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            const setCookie = context.responseHeader.get(\"set-cookie\");\n            setCookie?.includes(\n              context.context.authCookies.sessionToken.name\n            );\n            return context.path.startsWith(\"/sign-in\") || context.path.startsWith(\"/sign-up\") || context.path.startsWith(\"/callback\") || context.path.startsWith(\"/oauth2/callback\") || context.path.startsWith(\"/magic-link/verify\") || context.path.startsWith(\"/email-otp/verify-email\");\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthMiddleware)(async (ctx) => {\n            const headers = ctx.context.returned instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError ? ctx.context.returned.headers : ctx.responseHeader;\n            const setCookie = headers.get(\"set-cookie\");\n            const sessionTokenName = ctx.context.authCookies.sessionToken.name;\n            const sessionCookie = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.parseSetCookieHeader)(setCookie || \"\").get(sessionTokenName)?.value.split(\".\")[0];\n            if (!sessionCookie) {\n              return;\n            }\n            const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(\n              ctx,\n              {\n                disableRefresh: true\n              }\n            );\n            if (!session || !session.user.isAnonymous) {\n              return;\n            }\n            if (ctx.path === \"/sign-in/anonymous\") {\n              throw new _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.ANONYMOUS_USERS_CANNOT_SIGN_IN_AGAIN_ANONYMOUSLY\n              });\n            }\n            const newSession = ctx.context.newSession;\n            if (!newSession) {\n              return;\n            }\n            if (options?.onLinkAccount) {\n              await options?.onLinkAccount?.({\n                anonymousUser: session,\n                newUser: newSession\n              });\n            }\n            if (!options?.disableDeleteAnonymousUser) {\n              await ctx.context.internalAdapter.deleteUser(session.user.id);\n            }\n          })\n        }\n      ]\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.mergeSchema)(schema, options?.schema),\n    $ERROR_CODES: ERROR_CODES\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVBaT0I2NkFQLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTRHO0FBQzVEO0FBQzZCO0FBQzNCOztBQUVsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0Esa0JBQWtCLGtCQUFrQiw2REFBUyx3QkFBd0I7QUFDckUsOENBQThDLGVBQWU7QUFDN0QsZ0NBQWdDLEdBQUcsR0FBRyxnQkFBZ0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLG1CQUFtQix3RUFBb0I7QUFDdkMsNERBQTRELHdEQUFRO0FBQ3BFO0FBQ0E7QUFDQSxrQ0FBa0Msd0VBQW9CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxxRUFBaUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHdEQUFRO0FBQ2hDO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVksK0RBQVc7QUFDdkI7QUFDQTtBQUNBOztBQUVxQiIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVBaT0I2NkFQLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIEFQSUVycm9yLCBnZXRTZXNzaW9uRnJvbUN0eCB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuaW1wb3J0IHsgZ2V0T3JpZ2luIH0gZnJvbSAnLi9jaHVuay1YRkNJQU5aWC5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llLCBwYXJzZVNldENvb2tpZUhlYWRlciB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgbWVyZ2VTY2hlbWEgfSBmcm9tICcuL2NodW5rLVdaNk9JVkpLLmpzJztcblxuLy8gc3JjL3BsdWdpbnMvYW5vbnltb3VzL2luZGV4LnRzXG52YXIgc2NoZW1hID0ge1xuICB1c2VyOiB7XG4gICAgZmllbGRzOiB7XG4gICAgICBpc0Fub255bW91czoge1xuICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG59O1xudmFyIGFub255bW91cyA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IEVSUk9SX0NPREVTID0ge1xuICAgIEZBSUxFRF9UT19DUkVBVEVfVVNFUjogXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIixcbiAgICBDT1VMRF9OT1RfQ1JFQVRFX1NFU1NJT046IFwiQ291bGQgbm90IGNyZWF0ZSBzZXNzaW9uXCIsXG4gICAgQU5PTllNT1VTX1VTRVJTX0NBTk5PVF9TSUdOX0lOX0FHQUlOX0FOT05ZTU9VU0xZOiBcIkFub255bW91cyB1c2VycyBjYW5ub3Qgc2lnbiBpbiBhZ2FpbiBhbm9ueW1vdXNseVwiXG4gIH07XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYW5vbnltb3VzXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzaWduSW5Bbm9ueW1vdXM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvc2lnbi1pbi9hbm9ueW1vdXNcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiBhbm9ueW1vdXNseVwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gaW4gYW5vbnltb3VzbHlcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgZW1haWxEb21haW5OYW1lID0gZ2V0T3JpZ2luKGN0eC5jb250ZXh0LmJhc2VVUkwpIH0gPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgIGNvbnN0IGlkID0gY3R4LmNvbnRleHQuZ2VuZXJhdGVJZCh7IG1vZGVsOiBcInVzZXJcIiB9KTtcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IGB0ZW1wLSR7aWR9QCR7ZW1haWxEb21haW5OYW1lfWA7XG4gICAgICAgICAgY29uc3QgbmV3VXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVVc2VyKHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQW5vbnltb3VzOiB0cnVlLFxuICAgICAgICAgICAgbmFtZTogXCJBbm9ueW1vdXNcIixcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFuZXdVc2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwge1xuICAgICAgICAgICAgICBzdGF0dXM6IDUwMCxcbiAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUixcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgICAgbmV3VXNlci5pZCxcbiAgICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsLCB7XG4gICAgICAgICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuQ09VTERfTk9UX0NSRUFURV9TRVNTSU9OXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXI6IG5ld1VzZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgIGlkOiBuZXdVc2VyLmlkLFxuICAgICAgICAgICAgICBlbWFpbDogbmV3VXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogbmV3VXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgICBuYW1lOiBuZXdVc2VyLm5hbWUsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3VXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3VXNlci51cGRhdGVkQXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0sXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNldENvb2tpZSA9IGNvbnRleHQucmVzcG9uc2VIZWFkZXIuZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICAgICAgICAgIHNldENvb2tpZT8uaW5jbHVkZXMoXG4gICAgICAgICAgICAgIGNvbnRleHQuY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LnBhdGguc3RhcnRzV2l0aChcIi9zaWduLWluXCIpIHx8IGNvbnRleHQucGF0aC5zdGFydHNXaXRoKFwiL3NpZ24tdXBcIikgfHwgY29udGV4dC5wYXRoLnN0YXJ0c1dpdGgoXCIvY2FsbGJhY2tcIikgfHwgY29udGV4dC5wYXRoLnN0YXJ0c1dpdGgoXCIvb2F1dGgyL2NhbGxiYWNrXCIpIHx8IGNvbnRleHQucGF0aC5zdGFydHNXaXRoKFwiL21hZ2ljLWxpbmsvdmVyaWZ5XCIpIHx8IGNvbnRleHQucGF0aC5zdGFydHNXaXRoKFwiL2VtYWlsLW90cC92ZXJpZnktZW1haWxcIik7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gY3R4LmNvbnRleHQucmV0dXJuZWQgaW5zdGFuY2VvZiBBUElFcnJvciA/IGN0eC5jb250ZXh0LnJldHVybmVkLmhlYWRlcnMgOiBjdHgucmVzcG9uc2VIZWFkZXI7XG4gICAgICAgICAgICBjb25zdCBzZXRDb29raWUgPSBoZWFkZXJzLmdldChcInNldC1jb29raWVcIik7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uVG9rZW5OYW1lID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWU7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gcGFyc2VTZXRDb29raWVIZWFkZXIoc2V0Q29va2llIHx8IFwiXCIpLmdldChzZXNzaW9uVG9rZW5OYW1lKT8udmFsdWUuc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICAgICAgaWYgKCFzZXNzaW9uQ29va2llKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChcbiAgICAgICAgICAgICAgY3R4LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGlzYWJsZVJlZnJlc2g6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvbiB8fCAhc2Vzc2lvbi51c2VyLmlzQW5vbnltb3VzKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdHgucGF0aCA9PT0gXCIvc2lnbi1pbi9hbm9ueW1vdXNcIikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuQU5PTllNT1VTX1VTRVJTX0NBTk5PVF9TSUdOX0lOX0FHQUlOX0FOT05ZTU9VU0xZXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbmV3U2Vzc2lvbiA9IGN0eC5jb250ZXh0Lm5ld1Nlc3Npb247XG4gICAgICAgICAgICBpZiAoIW5ld1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnM/Lm9uTGlua0FjY291bnQpIHtcbiAgICAgICAgICAgICAgYXdhaXQgb3B0aW9ucz8ub25MaW5rQWNjb3VudD8uKHtcbiAgICAgICAgICAgICAgICBhbm9ueW1vdXNVc2VyOiBzZXNzaW9uLFxuICAgICAgICAgICAgICAgIG5ld1VzZXI6IG5ld1Nlc3Npb25cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW9wdGlvbnM/LmRpc2FibGVEZWxldGVBbm9ueW1vdXNVc2VyKSB7XG4gICAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVVc2VyKHNlc3Npb24udXNlci5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0sXG4gICAgc2NoZW1hOiBtZXJnZVNjaGVtYShzY2hlbWEsIG9wdGlvbnM/LnNjaGVtYSksXG4gICAgJEVSUk9SX0NPREVTOiBFUlJPUl9DT0RFU1xuICB9O1xufTtcblxuZXhwb3J0IHsgYW5vbnltb3VzIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCookieGetter: () => (/* binding */ createCookieGetter),\n/* harmony export */   deleteSessionCookie: () => (/* binding */ deleteSessionCookie),\n/* harmony export */   getCookieCache: () => (/* binding */ getCookieCache),\n/* harmony export */   getCookies: () => (/* binding */ getCookies),\n/* harmony export */   getSessionCookie: () => (/* binding */ getSessionCookie),\n/* harmony export */   parseCookies: () => (/* binding */ parseCookies),\n/* harmony export */   parseSetCookieHeader: () => (/* binding */ parseSetCookieHeader),\n/* harmony export */   setCookieCache: () => (/* binding */ setCookieCache),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie)\n/* harmony export */ });\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n\n\n\n\n\n\n\n// src/utils/time.ts\nvar createTime = (value, format) => {\n  const toMilliseconds = () => {\n    switch (format) {\n      case \"ms\":\n        return value;\n      case \"s\":\n        return value * 1e3;\n      case \"m\":\n        return value * 1e3 * 60;\n      case \"h\":\n        return value * 1e3 * 60 * 60;\n      case \"d\":\n        return value * 1e3 * 60 * 60 * 24;\n      case \"w\":\n        return value * 1e3 * 60 * 60 * 24 * 7;\n      case \"y\":\n        return value * 1e3 * 60 * 60 * 24 * 365;\n    }\n  };\n  const time = {\n    t: `${value}${format}`,\n    value,\n    tFormat: format,\n    toMilliseconds,\n    toSeconds: () => time.toMilliseconds() / 1e3,\n    toMinutes: () => time.toSeconds() / 60,\n    toHours: () => time.toMinutes() / 60,\n    toDays: () => time.toHours() / 24,\n    toWeeks: () => time.toDays() / 7,\n    toYears: () => time.toDays() / 365,\n    getDate: () => new Date(Date.now() + time.toMilliseconds()),\n    add: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return createTime(time.toMilliseconds() + otherMs, \"ms\");\n    },\n    subtract: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return createTime(time.toMilliseconds() - otherMs, \"ms\");\n    },\n    multiply: (factor) => createTime(time.toMilliseconds() * factor, \"ms\"),\n    divide: (divisor) => createTime(time.toMilliseconds() / divisor, \"ms\"),\n    equals: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return time.toMilliseconds() === otherMs;\n    },\n    lessThan: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return time.toMilliseconds() < otherMs;\n    },\n    greaterThan: (other) => {\n      const otherMs = typeof other === \"string\" ? parseTime(other).toMilliseconds() : other.toMilliseconds();\n      return time.toMilliseconds() > otherMs;\n    },\n    format: (pattern) => {\n      const date = time.getDate();\n      return pattern.replace(/YYYY|MM|DD|HH|mm|ss/g, (match) => {\n        switch (match) {\n          case \"YYYY\":\n            return date.getFullYear().toString();\n          case \"MM\":\n            return (date.getMonth() + 1).toString().padStart(2, \"0\");\n          case \"DD\":\n            return date.getDate().toString().padStart(2, \"0\");\n          case \"HH\":\n            return date.getHours().toString().padStart(2, \"0\");\n          case \"mm\":\n            return date.getMinutes().toString().padStart(2, \"0\");\n          case \"ss\":\n            return date.getSeconds().toString().padStart(2, \"0\");\n          default:\n            return match;\n        }\n      });\n    },\n    fromNow: () => {\n      const ms = time.toMilliseconds();\n      if (ms < 0) return time.ago();\n      if (ms < 1e3) return \"in a few seconds\";\n      if (ms < 6e4) return `in ${Math.round(ms / 1e3)} seconds`;\n      if (ms < 36e5) return `in ${Math.round(ms / 6e4)} minutes`;\n      if (ms < 864e5) return `in ${Math.round(ms / 36e5)} hours`;\n      if (ms < 6048e5) return `in ${Math.round(ms / 864e5)} days`;\n      if (ms < 26298e5) return `in ${Math.round(ms / 6048e5)} weeks`;\n      if (ms < 315576e5) return `in ${Math.round(ms / 26298e5)} months`;\n      return `in ${Math.round(ms / 315576e5)} years`;\n    },\n    ago: () => {\n      const ms = -time.toMilliseconds();\n      if (ms < 0) return time.fromNow();\n      if (ms < 1e3) return \"a few seconds ago\";\n      if (ms < 6e4) return `${Math.round(ms / 1e3)} seconds ago`;\n      if (ms < 36e5) return `${Math.round(ms / 6e4)} minutes ago`;\n      if (ms < 864e5) return `${Math.round(ms / 36e5)} hours ago`;\n      if (ms < 6048e5) return `${Math.round(ms / 864e5)} days ago`;\n      if (ms < 26298e5) return `${Math.round(ms / 6048e5)} weeks ago`;\n      if (ms < 315576e5) return `${Math.round(ms / 26298e5)} months ago`;\n      return `${Math.round(ms / 315576e5)} years ago`;\n    }\n  };\n  return time;\n};\nvar parseTime = (time) => {\n  const match = time.match(/^(\\d+)(ms|s|m|h|d|w|y)$/);\n  if (!match) throw new Error(\"Invalid time format\");\n  return createTime(parseInt(match[1]), match[2]);\n};\n\n// src/cookies/cookie-utils.ts\nfunction parseSetCookieHeader(setCookie) {\n  const cookies = /* @__PURE__ */ new Map();\n  const cookieArray = setCookie.split(\", \");\n  cookieArray.forEach((cookieString) => {\n    const parts = cookieString.split(\";\").map((part) => part.trim());\n    const [nameValue, ...attributes] = parts;\n    const [name, ...valueParts] = nameValue.split(\"=\");\n    const value = valueParts.join(\"=\");\n    if (!name || value === void 0) {\n      return;\n    }\n    const attrObj = { value };\n    attributes.forEach((attribute) => {\n      const [attrName, ...attrValueParts] = attribute.split(\"=\");\n      const attrValue = attrValueParts.join(\"=\");\n      const normalizedAttrName = attrName.trim().toLowerCase();\n      switch (normalizedAttrName) {\n        case \"max-age\":\n          attrObj[\"max-age\"] = attrValue ? parseInt(attrValue.trim(), 10) : void 0;\n          break;\n        case \"expires\":\n          attrObj.expires = attrValue ? new Date(attrValue.trim()) : void 0;\n          break;\n        case \"domain\":\n          attrObj.domain = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"path\":\n          attrObj.path = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"secure\":\n          attrObj.secure = true;\n          break;\n        case \"httponly\":\n          attrObj.httponly = true;\n          break;\n        case \"samesite\":\n          attrObj.samesite = attrValue ? attrValue.trim().toLowerCase() : void 0;\n          break;\n        default:\n          attrObj[normalizedAttrName] = attrValue ? attrValue.trim() : true;\n          break;\n      }\n    });\n    cookies.set(name, attrObj);\n  });\n  return cookies;\n}\n\n// src/cookies/index.ts\nfunction createCookieGetter(options) {\n  const secure = options.advanced?.useSecureCookies !== void 0 ? options.advanced?.useSecureCookies : options.baseURL !== void 0 ? options.baseURL.startsWith(\"https://\") ? true : false : _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__.isProduction;\n  const secureCookiePrefix = secure ? \"__Secure-\" : \"\";\n  const crossSubdomainEnabled = !!options.advanced?.crossSubDomainCookies?.enabled;\n  const domain = crossSubdomainEnabled ? options.advanced?.crossSubDomainCookies?.domain || (options.baseURL ? new URL(options.baseURL).hostname : void 0) : void 0;\n  if (crossSubdomainEnabled && !domain) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\n      \"baseURL is required when crossSubdomainCookies are enabled\"\n    );\n  }\n  function createCookie(cookieName, overrideAttributes = {}) {\n    const prefix = options.advanced?.cookiePrefix || \"better-auth\";\n    const name = options.advanced?.cookies?.[cookieName]?.name || `${prefix}.${cookieName}`;\n    const attributes = options.advanced?.cookies?.[cookieName]?.attributes;\n    return {\n      name: `${secureCookiePrefix}${name}`,\n      attributes: {\n        secure: !!secureCookiePrefix,\n        sameSite: \"lax\",\n        path: \"/\",\n        httpOnly: true,\n        ...crossSubdomainEnabled ? { domain } : {},\n        ...options.advanced?.defaultCookieAttributes,\n        ...overrideAttributes,\n        ...attributes\n      }\n    };\n  }\n  return createCookie;\n}\nfunction getCookies(options) {\n  const createCookie = createCookieGetter(options);\n  const sessionMaxAge = options.session?.expiresIn || createTime(7, \"d\").toSeconds();\n  const sessionToken = createCookie(\"session_token\", {\n    maxAge: sessionMaxAge\n  });\n  const sessionData = createCookie(\"session_data\", {\n    maxAge: options.session?.cookieCache?.maxAge || 60 * 5\n  });\n  const dontRememberToken = createCookie(\"dont_remember\");\n  return {\n    sessionToken: {\n      name: sessionToken.name,\n      options: sessionToken.attributes\n    },\n    /**\n     * This cookie is used to store the session data in the cookie\n     * This is useful for when you want to cache the session in the cookie\n     */\n    sessionData: {\n      name: sessionData.name,\n      options: sessionData.attributes\n    },\n    dontRememberToken: {\n      name: dontRememberToken.name,\n      options: dontRememberToken.attributes\n    }\n  };\n}\nasync function setCookieCache(ctx, session) {\n  const shouldStoreSessionDataInCookie = ctx.context.options.session?.cookieCache?.enabled;\n  if (shouldStoreSessionDataInCookie) {\n    const data = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_4__.base64Url.encode(\n      JSON.stringify({\n        session,\n        expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_1__.getDate)(\n          ctx.context.authCookies.sessionData.options.maxAge || 60,\n          \"sec\"\n        ).getTime(),\n        signature: await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_5__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n          ctx.context.secret,\n          JSON.stringify(session)\n        )\n      }),\n      {\n        padding: false\n      }\n    );\n    if (data.length > 4093) {\n      throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\n        \"Session data is too large to store in the cookie. Please disable session cookie caching or reduce the size of the session data\"\n      );\n    }\n    ctx.setCookie(\n      ctx.context.authCookies.sessionData.name,\n      data,\n      ctx.context.authCookies.sessionData.options\n    );\n  }\n}\nasync function setSessionCookie(ctx, session, dontRememberMe, overrides) {\n  const options = ctx.context.authCookies.sessionToken.options;\n  const maxAge = dontRememberMe ? void 0 : ctx.context.sessionConfig.expiresIn;\n  await ctx.setSignedCookie(\n    ctx.context.authCookies.sessionToken.name,\n    session.session.token,\n    ctx.context.secret,\n    {\n      ...options,\n      maxAge,\n      ...overrides\n    }\n  );\n  if (dontRememberMe) {\n    await ctx.setSignedCookie(\n      ctx.context.authCookies.dontRememberToken.name,\n      \"true\",\n      ctx.context.secret,\n      ctx.context.authCookies.dontRememberToken.options\n    );\n  }\n  await setCookieCache(ctx, session);\n  ctx.context.setNewSession(session);\n  if (ctx.context.options.secondaryStorage) {\n    await ctx.context.secondaryStorage?.set(\n      session.session.token,\n      JSON.stringify({\n        user: session.user,\n        session: session.session\n      }),\n      Math.floor(\n        (new Date(session.session.expiresAt).getTime() - Date.now()) / 1e3\n      )\n    );\n  }\n}\nfunction deleteSessionCookie(ctx) {\n  ctx.setCookie(ctx.context.authCookies.sessionToken.name, \"\", {\n    ...ctx.context.authCookies.sessionToken.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.sessionData.name, \"\", {\n    ...ctx.context.authCookies.sessionData.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.dontRememberToken.name, \"\", {\n    ...ctx.context.authCookies.dontRememberToken.options,\n    maxAge: 0\n  });\n}\nfunction parseCookies(cookieHeader) {\n  const cookies = cookieHeader.split(\"; \");\n  const cookieMap = /* @__PURE__ */ new Map();\n  cookies.forEach((cookie) => {\n    const [name, value] = cookie.split(\"=\");\n    cookieMap.set(name, value);\n  });\n  return cookieMap;\n}\nvar getSessionCookie = (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_token\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__.isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionToken = parsedCookie.get(name);\n  if (sessionToken) {\n    return sessionToken;\n  }\n  return null;\n};\nvar getCookieCache = (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_data\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_2__.isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionData = parsedCookie.get(name);\n  if (sessionData) {\n    return (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_0__.safeJSONParse)(sessionData);\n  }\n  return null;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVFRR1ozWEdJLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFvRDtBQUNOO0FBQ0s7QUFDRztBQUNBO0FBQ0Q7O0FBRXJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsTUFBTSxFQUFFLE9BQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsc0JBQXNCO0FBQ3ZELGtDQUFrQyxzQkFBc0I7QUFDeEQsbUNBQW1DLHVCQUF1QjtBQUMxRCxvQ0FBb0Msd0JBQXdCO0FBQzVELHFDQUFxQyx5QkFBeUI7QUFDOUQsc0NBQXNDLDBCQUEwQjtBQUNoRSxtQkFBbUIsMkJBQTJCO0FBQzlDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixzQkFBc0I7QUFDcEQsK0JBQStCLHNCQUFzQjtBQUNyRCxnQ0FBZ0MsdUJBQXVCO0FBQ3ZELGlDQUFpQyx3QkFBd0I7QUFDekQsa0NBQWtDLHlCQUF5QjtBQUMzRCxtQ0FBbUMsMEJBQTBCO0FBQzdELGdCQUFnQiwyQkFBMkI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQSwyTEFBMkwsNERBQVk7QUFDdk07QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLCtEQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBLHFFQUFxRSxPQUFPLEdBQUcsV0FBVztBQUMxRjtBQUNBO0FBQ0EsZUFBZSxtQkFBbUIsRUFBRSxLQUFLO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsU0FBUyxJQUFJO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsZ0VBQVM7QUFDMUI7QUFDQTtBQUNBLG1CQUFtQiwyREFBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsbUVBQVU7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsK0RBQWU7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSw2REFBNkQ7QUFDdkUsZUFBZSw0REFBWSxlQUFlLGFBQWEsR0FBRyxXQUFXLE9BQU8sYUFBYSxHQUFHLFdBQVc7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDREQUE0RDtBQUN0RSxlQUFlLDREQUFZLGVBQWUsYUFBYSxHQUFHLFdBQVcsT0FBTyxhQUFhLEdBQUcsV0FBVztBQUN2RztBQUNBO0FBQ0E7QUFDQSxXQUFXLGlFQUFhO0FBQ3hCO0FBQ0E7QUFDQTs7QUFFdUsiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1RUUdaM1hHSS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi9jaHVuay01M0lQTzJQSi5qcyc7XG5pbXBvcnQgeyBnZXREYXRlIH0gZnJvbSAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBpc1Byb2R1Y3Rpb24gfSBmcm9tICcuL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vY2h1bmstVU5XQ1hLTVAuanMnO1xuaW1wb3J0IHsgYmFzZTY0VXJsIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgeyBjcmVhdGVITUFDIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuXG4vLyBzcmMvdXRpbHMvdGltZS50c1xudmFyIGNyZWF0ZVRpbWUgPSAodmFsdWUsIGZvcm1hdCkgPT4ge1xuICBjb25zdCB0b01pbGxpc2Vjb25kcyA9ICgpID0+IHtcbiAgICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgICAgY2FzZSBcIm1zXCI6XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIGNhc2UgXCJzXCI6XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIDFlMztcbiAgICAgIGNhc2UgXCJtXCI6XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIDFlMyAqIDYwO1xuICAgICAgY2FzZSBcImhcIjpcbiAgICAgICAgcmV0dXJuIHZhbHVlICogMWUzICogNjAgKiA2MDtcbiAgICAgIGNhc2UgXCJkXCI6XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIDFlMyAqIDYwICogNjAgKiAyNDtcbiAgICAgIGNhc2UgXCJ3XCI6XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIDFlMyAqIDYwICogNjAgKiAyNCAqIDc7XG4gICAgICBjYXNlIFwieVwiOlxuICAgICAgICByZXR1cm4gdmFsdWUgKiAxZTMgKiA2MCAqIDYwICogMjQgKiAzNjU7XG4gICAgfVxuICB9O1xuICBjb25zdCB0aW1lID0ge1xuICAgIHQ6IGAke3ZhbHVlfSR7Zm9ybWF0fWAsXG4gICAgdmFsdWUsXG4gICAgdEZvcm1hdDogZm9ybWF0LFxuICAgIHRvTWlsbGlzZWNvbmRzLFxuICAgIHRvU2Vjb25kczogKCkgPT4gdGltZS50b01pbGxpc2Vjb25kcygpIC8gMWUzLFxuICAgIHRvTWludXRlczogKCkgPT4gdGltZS50b1NlY29uZHMoKSAvIDYwLFxuICAgIHRvSG91cnM6ICgpID0+IHRpbWUudG9NaW51dGVzKCkgLyA2MCxcbiAgICB0b0RheXM6ICgpID0+IHRpbWUudG9Ib3VycygpIC8gMjQsXG4gICAgdG9XZWVrczogKCkgPT4gdGltZS50b0RheXMoKSAvIDcsXG4gICAgdG9ZZWFyczogKCkgPT4gdGltZS50b0RheXMoKSAvIDM2NSxcbiAgICBnZXREYXRlOiAoKSA9PiBuZXcgRGF0ZShEYXRlLm5vdygpICsgdGltZS50b01pbGxpc2Vjb25kcygpKSxcbiAgICBhZGQ6IChvdGhlcikgPT4ge1xuICAgICAgY29uc3Qgb3RoZXJNcyA9IHR5cGVvZiBvdGhlciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlVGltZShvdGhlcikudG9NaWxsaXNlY29uZHMoKSA6IG90aGVyLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICByZXR1cm4gY3JlYXRlVGltZSh0aW1lLnRvTWlsbGlzZWNvbmRzKCkgKyBvdGhlck1zLCBcIm1zXCIpO1xuICAgIH0sXG4gICAgc3VidHJhY3Q6IChvdGhlcikgPT4ge1xuICAgICAgY29uc3Qgb3RoZXJNcyA9IHR5cGVvZiBvdGhlciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlVGltZShvdGhlcikudG9NaWxsaXNlY29uZHMoKSA6IG90aGVyLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICByZXR1cm4gY3JlYXRlVGltZSh0aW1lLnRvTWlsbGlzZWNvbmRzKCkgLSBvdGhlck1zLCBcIm1zXCIpO1xuICAgIH0sXG4gICAgbXVsdGlwbHk6IChmYWN0b3IpID0+IGNyZWF0ZVRpbWUodGltZS50b01pbGxpc2Vjb25kcygpICogZmFjdG9yLCBcIm1zXCIpLFxuICAgIGRpdmlkZTogKGRpdmlzb3IpID0+IGNyZWF0ZVRpbWUodGltZS50b01pbGxpc2Vjb25kcygpIC8gZGl2aXNvciwgXCJtc1wiKSxcbiAgICBlcXVhbHM6IChvdGhlcikgPT4ge1xuICAgICAgY29uc3Qgb3RoZXJNcyA9IHR5cGVvZiBvdGhlciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlVGltZShvdGhlcikudG9NaWxsaXNlY29uZHMoKSA6IG90aGVyLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICByZXR1cm4gdGltZS50b01pbGxpc2Vjb25kcygpID09PSBvdGhlck1zO1xuICAgIH0sXG4gICAgbGVzc1RoYW46IChvdGhlcikgPT4ge1xuICAgICAgY29uc3Qgb3RoZXJNcyA9IHR5cGVvZiBvdGhlciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlVGltZShvdGhlcikudG9NaWxsaXNlY29uZHMoKSA6IG90aGVyLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICByZXR1cm4gdGltZS50b01pbGxpc2Vjb25kcygpIDwgb3RoZXJNcztcbiAgICB9LFxuICAgIGdyZWF0ZXJUaGFuOiAob3RoZXIpID0+IHtcbiAgICAgIGNvbnN0IG90aGVyTXMgPSB0eXBlb2Ygb3RoZXIgPT09IFwic3RyaW5nXCIgPyBwYXJzZVRpbWUob3RoZXIpLnRvTWlsbGlzZWNvbmRzKCkgOiBvdGhlci50b01pbGxpc2Vjb25kcygpO1xuICAgICAgcmV0dXJuIHRpbWUudG9NaWxsaXNlY29uZHMoKSA+IG90aGVyTXM7XG4gICAgfSxcbiAgICBmb3JtYXQ6IChwYXR0ZXJuKSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gdGltZS5nZXREYXRlKCk7XG4gICAgICByZXR1cm4gcGF0dGVybi5yZXBsYWNlKC9ZWVlZfE1NfEREfEhIfG1tfHNzL2csIChtYXRjaCkgPT4ge1xuICAgICAgICBzd2l0Y2ggKG1hdGNoKSB7XG4gICAgICAgICAgY2FzZSBcIllZWVlcIjpcbiAgICAgICAgICAgIHJldHVybiBkYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKTtcbiAgICAgICAgICBjYXNlIFwiTU1cIjpcbiAgICAgICAgICAgIHJldHVybiAoZGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgICAgICAgY2FzZSBcIkREXCI6XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgICAgICAgY2FzZSBcIkhIXCI6XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpO1xuICAgICAgICAgIGNhc2UgXCJtbVwiOlxuICAgICAgICAgICAgcmV0dXJuIGRhdGUuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpO1xuICAgICAgICAgIGNhc2UgXCJzc1wiOlxuICAgICAgICAgICAgcmV0dXJuIGRhdGUuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2g7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZnJvbU5vdzogKCkgPT4ge1xuICAgICAgY29uc3QgbXMgPSB0aW1lLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICBpZiAobXMgPCAwKSByZXR1cm4gdGltZS5hZ28oKTtcbiAgICAgIGlmIChtcyA8IDFlMykgcmV0dXJuIFwiaW4gYSBmZXcgc2Vjb25kc1wiO1xuICAgICAgaWYgKG1zIDwgNmU0KSByZXR1cm4gYGluICR7TWF0aC5yb3VuZChtcyAvIDFlMyl9IHNlY29uZHNgO1xuICAgICAgaWYgKG1zIDwgMzZlNSkgcmV0dXJuIGBpbiAke01hdGgucm91bmQobXMgLyA2ZTQpfSBtaW51dGVzYDtcbiAgICAgIGlmIChtcyA8IDg2NGU1KSByZXR1cm4gYGluICR7TWF0aC5yb3VuZChtcyAvIDM2ZTUpfSBob3Vyc2A7XG4gICAgICBpZiAobXMgPCA2MDQ4ZTUpIHJldHVybiBgaW4gJHtNYXRoLnJvdW5kKG1zIC8gODY0ZTUpfSBkYXlzYDtcbiAgICAgIGlmIChtcyA8IDI2Mjk4ZTUpIHJldHVybiBgaW4gJHtNYXRoLnJvdW5kKG1zIC8gNjA0OGU1KX0gd2Vla3NgO1xuICAgICAgaWYgKG1zIDwgMzE1NTc2ZTUpIHJldHVybiBgaW4gJHtNYXRoLnJvdW5kKG1zIC8gMjYyOThlNSl9IG1vbnRoc2A7XG4gICAgICByZXR1cm4gYGluICR7TWF0aC5yb3VuZChtcyAvIDMxNTU3NmU1KX0geWVhcnNgO1xuICAgIH0sXG4gICAgYWdvOiAoKSA9PiB7XG4gICAgICBjb25zdCBtcyA9IC10aW1lLnRvTWlsbGlzZWNvbmRzKCk7XG4gICAgICBpZiAobXMgPCAwKSByZXR1cm4gdGltZS5mcm9tTm93KCk7XG4gICAgICBpZiAobXMgPCAxZTMpIHJldHVybiBcImEgZmV3IHNlY29uZHMgYWdvXCI7XG4gICAgICBpZiAobXMgPCA2ZTQpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zIC8gMWUzKX0gc2Vjb25kcyBhZ29gO1xuICAgICAgaWYgKG1zIDwgMzZlNSkgcmV0dXJuIGAke01hdGgucm91bmQobXMgLyA2ZTQpfSBtaW51dGVzIGFnb2A7XG4gICAgICBpZiAobXMgPCA4NjRlNSkgcmV0dXJuIGAke01hdGgucm91bmQobXMgLyAzNmU1KX0gaG91cnMgYWdvYDtcbiAgICAgIGlmIChtcyA8IDYwNDhlNSkgcmV0dXJuIGAke01hdGgucm91bmQobXMgLyA4NjRlNSl9IGRheXMgYWdvYDtcbiAgICAgIGlmIChtcyA8IDI2Mjk4ZTUpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zIC8gNjA0OGU1KX0gd2Vla3MgYWdvYDtcbiAgICAgIGlmIChtcyA8IDMxNTU3NmU1KSByZXR1cm4gYCR7TWF0aC5yb3VuZChtcyAvIDI2Mjk4ZTUpfSBtb250aHMgYWdvYDtcbiAgICAgIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zIC8gMzE1NTc2ZTUpfSB5ZWFycyBhZ29gO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIHRpbWU7XG59O1xudmFyIHBhcnNlVGltZSA9ICh0aW1lKSA9PiB7XG4gIGNvbnN0IG1hdGNoID0gdGltZS5tYXRjaCgvXihcXGQrKShtc3xzfG18aHxkfHd8eSkkLyk7XG4gIGlmICghbWF0Y2gpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdGltZSBmb3JtYXRcIik7XG4gIHJldHVybiBjcmVhdGVUaW1lKHBhcnNlSW50KG1hdGNoWzFdKSwgbWF0Y2hbMl0pO1xufTtcblxuLy8gc3JjL2Nvb2tpZXMvY29va2llLXV0aWxzLnRzXG5mdW5jdGlvbiBwYXJzZVNldENvb2tpZUhlYWRlcihzZXRDb29raWUpIHtcbiAgY29uc3QgY29va2llcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGNvbnN0IGNvb2tpZUFycmF5ID0gc2V0Q29va2llLnNwbGl0KFwiLCBcIik7XG4gIGNvb2tpZUFycmF5LmZvckVhY2goKGNvb2tpZVN0cmluZykgPT4ge1xuICAgIGNvbnN0IHBhcnRzID0gY29va2llU3RyaW5nLnNwbGl0KFwiO1wiKS5tYXAoKHBhcnQpID0+IHBhcnQudHJpbSgpKTtcbiAgICBjb25zdCBbbmFtZVZhbHVlLCAuLi5hdHRyaWJ1dGVzXSA9IHBhcnRzO1xuICAgIGNvbnN0IFtuYW1lLCAuLi52YWx1ZVBhcnRzXSA9IG5hbWVWYWx1ZS5zcGxpdChcIj1cIik7XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZVBhcnRzLmpvaW4oXCI9XCIpO1xuICAgIGlmICghbmFtZSB8fCB2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGF0dHJPYmogPSB7IHZhbHVlIH07XG4gICAgYXR0cmlidXRlcy5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICAgIGNvbnN0IFthdHRyTmFtZSwgLi4uYXR0clZhbHVlUGFydHNdID0gYXR0cmlidXRlLnNwbGl0KFwiPVwiKTtcbiAgICAgIGNvbnN0IGF0dHJWYWx1ZSA9IGF0dHJWYWx1ZVBhcnRzLmpvaW4oXCI9XCIpO1xuICAgICAgY29uc3Qgbm9ybWFsaXplZEF0dHJOYW1lID0gYXR0ck5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBzd2l0Y2ggKG5vcm1hbGl6ZWRBdHRyTmFtZSkge1xuICAgICAgICBjYXNlIFwibWF4LWFnZVwiOlxuICAgICAgICAgIGF0dHJPYmpbXCJtYXgtYWdlXCJdID0gYXR0clZhbHVlID8gcGFyc2VJbnQoYXR0clZhbHVlLnRyaW0oKSwgMTApIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZXhwaXJlc1wiOlxuICAgICAgICAgIGF0dHJPYmouZXhwaXJlcyA9IGF0dHJWYWx1ZSA/IG5ldyBEYXRlKGF0dHJWYWx1ZS50cmltKCkpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZG9tYWluXCI6XG4gICAgICAgICAgYXR0ck9iai5kb21haW4gPSBhdHRyVmFsdWUgPyBhdHRyVmFsdWUudHJpbSgpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwicGF0aFwiOlxuICAgICAgICAgIGF0dHJPYmoucGF0aCA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkgOiB2b2lkIDA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzZWN1cmVcIjpcbiAgICAgICAgICBhdHRyT2JqLnNlY3VyZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJodHRwb25seVwiOlxuICAgICAgICAgIGF0dHJPYmouaHR0cG9ubHkgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic2FtZXNpdGVcIjpcbiAgICAgICAgICBhdHRyT2JqLnNhbWVzaXRlID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGF0dHJPYmpbbm9ybWFsaXplZEF0dHJOYW1lXSA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkgOiB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvb2tpZXMuc2V0KG5hbWUsIGF0dHJPYmopO1xuICB9KTtcbiAgcmV0dXJuIGNvb2tpZXM7XG59XG5cbi8vIHNyYy9jb29raWVzL2luZGV4LnRzXG5mdW5jdGlvbiBjcmVhdGVDb29raWVHZXR0ZXIob3B0aW9ucykge1xuICBjb25zdCBzZWN1cmUgPSBvcHRpb25zLmFkdmFuY2VkPy51c2VTZWN1cmVDb29raWVzICE9PSB2b2lkIDAgPyBvcHRpb25zLmFkdmFuY2VkPy51c2VTZWN1cmVDb29raWVzIDogb3B0aW9ucy5iYXNlVVJMICE9PSB2b2lkIDAgPyBvcHRpb25zLmJhc2VVUkwuc3RhcnRzV2l0aChcImh0dHBzOi8vXCIpID8gdHJ1ZSA6IGZhbHNlIDogaXNQcm9kdWN0aW9uO1xuICBjb25zdCBzZWN1cmVDb29raWVQcmVmaXggPSBzZWN1cmUgPyBcIl9fU2VjdXJlLVwiIDogXCJcIjtcbiAgY29uc3QgY3Jvc3NTdWJkb21haW5FbmFibGVkID0gISFvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmVuYWJsZWQ7XG4gIGNvbnN0IGRvbWFpbiA9IGNyb3NzU3ViZG9tYWluRW5hYmxlZCA/IG9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uZG9tYWluIHx8IChvcHRpb25zLmJhc2VVUkwgPyBuZXcgVVJMKG9wdGlvbnMuYmFzZVVSTCkuaG9zdG5hbWUgOiB2b2lkIDApIDogdm9pZCAwO1xuICBpZiAoY3Jvc3NTdWJkb21haW5FbmFibGVkICYmICFkb21haW4pIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgXCJiYXNlVVJMIGlzIHJlcXVpcmVkIHdoZW4gY3Jvc3NTdWJkb21haW5Db29raWVzIGFyZSBlbmFibGVkXCJcbiAgICApO1xuICB9XG4gIGZ1bmN0aW9uIGNyZWF0ZUNvb2tpZShjb29raWVOYW1lLCBvdmVycmlkZUF0dHJpYnV0ZXMgPSB7fSkge1xuICAgIGNvbnN0IHByZWZpeCA9IG9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZVByZWZpeCB8fCBcImJldHRlci1hdXRoXCI7XG4gICAgY29uc3QgbmFtZSA9IG9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZXM/Lltjb29raWVOYW1lXT8ubmFtZSB8fCBgJHtwcmVmaXh9LiR7Y29va2llTmFtZX1gO1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBvcHRpb25zLmFkdmFuY2VkPy5jb29raWVzPy5bY29va2llTmFtZV0/LmF0dHJpYnV0ZXM7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGAke3NlY3VyZUNvb2tpZVByZWZpeH0ke25hbWV9YCxcbiAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgc2VjdXJlOiAhIXNlY3VyZUNvb2tpZVByZWZpeCxcbiAgICAgICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgICAgIHBhdGg6IFwiL1wiLFxuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgLi4uY3Jvc3NTdWJkb21haW5FbmFibGVkID8geyBkb21haW4gfSA6IHt9LFxuICAgICAgICAuLi5vcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcyxcbiAgICAgICAgLi4ub3ZlcnJpZGVBdHRyaWJ1dGVzLFxuICAgICAgICAuLi5hdHRyaWJ1dGVzXG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4gY3JlYXRlQ29va2llO1xufVxuZnVuY3Rpb24gZ2V0Q29va2llcyhvcHRpb25zKSB7XG4gIGNvbnN0IGNyZWF0ZUNvb2tpZSA9IGNyZWF0ZUNvb2tpZUdldHRlcihvcHRpb25zKTtcbiAgY29uc3Qgc2Vzc2lvbk1heEFnZSA9IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luIHx8IGNyZWF0ZVRpbWUoNywgXCJkXCIpLnRvU2Vjb25kcygpO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBjcmVhdGVDb29raWUoXCJzZXNzaW9uX3Rva2VuXCIsIHtcbiAgICBtYXhBZ2U6IHNlc3Npb25NYXhBZ2VcbiAgfSk7XG4gIGNvbnN0IHNlc3Npb25EYXRhID0gY3JlYXRlQ29va2llKFwic2Vzc2lvbl9kYXRhXCIsIHtcbiAgICBtYXhBZ2U6IG9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/Lm1heEFnZSB8fCA2MCAqIDVcbiAgfSk7XG4gIGNvbnN0IGRvbnRSZW1lbWJlclRva2VuID0gY3JlYXRlQ29va2llKFwiZG9udF9yZW1lbWJlclwiKTtcbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uVG9rZW46IHtcbiAgICAgIG5hbWU6IHNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgb3B0aW9uczogc2Vzc2lvblRva2VuLmF0dHJpYnV0ZXNcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFRoaXMgY29va2llIGlzIHVzZWQgdG8gc3RvcmUgdGhlIHNlc3Npb24gZGF0YSBpbiB0aGUgY29va2llXG4gICAgICogVGhpcyBpcyB1c2VmdWwgZm9yIHdoZW4geW91IHdhbnQgdG8gY2FjaGUgdGhlIHNlc3Npb24gaW4gdGhlIGNvb2tpZVxuICAgICAqL1xuICAgIHNlc3Npb25EYXRhOiB7XG4gICAgICBuYW1lOiBzZXNzaW9uRGF0YS5uYW1lLFxuICAgICAgb3B0aW9uczogc2Vzc2lvbkRhdGEuYXR0cmlidXRlc1xuICAgIH0sXG4gICAgZG9udFJlbWVtYmVyVG9rZW46IHtcbiAgICAgIG5hbWU6IGRvbnRSZW1lbWJlclRva2VuLm5hbWUsXG4gICAgICBvcHRpb25zOiBkb250UmVtZW1iZXJUb2tlbi5hdHRyaWJ1dGVzXG4gICAgfVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gc2V0Q29va2llQ2FjaGUoY3R4LCBzZXNzaW9uKSB7XG4gIGNvbnN0IHNob3VsZFN0b3JlU2Vzc2lvbkRhdGFJbkNvb2tpZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/LmVuYWJsZWQ7XG4gIGlmIChzaG91bGRTdG9yZVNlc3Npb25EYXRhSW5Db29raWUpIHtcbiAgICBjb25zdCBkYXRhID0gYmFzZTY0VXJsLmVuY29kZShcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKFxuICAgICAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm9wdGlvbnMubWF4QWdlIHx8IDYwLFxuICAgICAgICAgIFwic2VjXCJcbiAgICAgICAgKS5nZXRUaW1lKCksXG4gICAgICAgIHNpZ25hdHVyZTogYXdhaXQgY3JlYXRlSE1BQyhcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS5zaWduKFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeShzZXNzaW9uKVxuICAgICAgICApXG4gICAgICB9KSxcbiAgICAgIHtcbiAgICAgICAgcGFkZGluZzogZmFsc2VcbiAgICAgIH1cbiAgICApO1xuICAgIGlmIChkYXRhLmxlbmd0aCA+IDQwOTMpIHtcbiAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgIFwiU2Vzc2lvbiBkYXRhIGlzIHRvbyBsYXJnZSB0byBzdG9yZSBpbiB0aGUgY29va2llLiBQbGVhc2UgZGlzYWJsZSBzZXNzaW9uIGNvb2tpZSBjYWNoaW5nIG9yIHJlZHVjZSB0aGUgc2l6ZSBvZiB0aGUgc2Vzc2lvbiBkYXRhXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGN0eC5zZXRDb29raWUoXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lLFxuICAgICAgZGF0YSxcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm9wdGlvbnNcbiAgICApO1xuICB9XG59XG5hc3luYyBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKGN0eCwgc2Vzc2lvbiwgZG9udFJlbWVtYmVyTWUsIG92ZXJyaWRlcykge1xuICBjb25zdCBvcHRpb25zID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm9wdGlvbnM7XG4gIGNvbnN0IG1heEFnZSA9IGRvbnRSZW1lbWJlck1lID8gdm9pZCAwIDogY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy5leHBpcmVzSW47XG4gIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgc2Vzc2lvbi5zZXNzaW9uLnRva2VuLFxuICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgbWF4QWdlLFxuICAgICAgLi4ub3ZlcnJpZGVzXG4gICAgfVxuICApO1xuICBpZiAoZG9udFJlbWVtYmVyTWUpIHtcbiAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ubmFtZSxcbiAgICAgIFwidHJ1ZVwiLFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ub3B0aW9uc1xuICAgICk7XG4gIH1cbiAgYXdhaXQgc2V0Q29va2llQ2FjaGUoY3R4LCBzZXNzaW9uKTtcbiAgY3R4LmNvbnRleHQuc2V0TmV3U2Vzc2lvbihzZXNzaW9uKTtcbiAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LnNlY29uZGFyeVN0b3JhZ2U/LnNldChcbiAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgICAgICBzZXNzaW9uOiBzZXNzaW9uLnNlc3Npb25cbiAgICAgIH0pLFxuICAgICAgTWF0aC5mbG9vcihcbiAgICAgICAgKG5ldyBEYXRlKHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQpLmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMWUzXG4gICAgICApXG4gICAgKTtcbiAgfVxufVxuZnVuY3Rpb24gZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpIHtcbiAgY3R4LnNldENvb2tpZShjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZSwgXCJcIiwge1xuICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5vcHRpb25zLFxuICAgIG1heEFnZTogMFxuICB9KTtcbiAgY3R4LnNldENvb2tpZShjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lLCBcIlwiLCB7XG4gICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEub3B0aW9ucyxcbiAgICBtYXhBZ2U6IDBcbiAgfSk7XG4gIGN0eC5zZXRDb29raWUoY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ubmFtZSwgXCJcIiwge1xuICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm9wdGlvbnMsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikge1xuICBjb25zdCBjb29raWVzID0gY29va2llSGVhZGVyLnNwbGl0KFwiOyBcIik7XG4gIGNvbnN0IGNvb2tpZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGNvb2tpZXMuZm9yRWFjaCgoY29va2llKSA9PiB7XG4gICAgY29uc3QgW25hbWUsIHZhbHVlXSA9IGNvb2tpZS5zcGxpdChcIj1cIik7XG4gICAgY29va2llTWFwLnNldChuYW1lLCB2YWx1ZSk7XG4gIH0pO1xuICByZXR1cm4gY29va2llTWFwO1xufVxudmFyIGdldFNlc3Npb25Db29raWUgPSAocmVxdWVzdCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGhlYWRlcnMgPSByZXF1ZXN0IGluc3RhbmNlb2YgSGVhZGVycyA/IHJlcXVlc3QgOiByZXF1ZXN0LmhlYWRlcnM7XG4gIGNvbnN0IGNvb2tpZXMgPSBoZWFkZXJzLmdldChcImNvb2tpZVwiKTtcbiAgaWYgKCFjb29raWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBjb29raWVOYW1lID0gXCJzZXNzaW9uX3Rva2VuXCIsIGNvb2tpZVByZWZpeCA9IFwiYmV0dGVyLWF1dGhcIiB9ID0gY29uZmlnIHx8IHt9O1xuICBjb25zdCBuYW1lID0gaXNQcm9kdWN0aW9uID8gYF9fU2VjdXJlLSR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YCA6IGAke2Nvb2tpZVByZWZpeH0uJHtjb29raWVOYW1lfWA7XG4gIGNvbnN0IHBhcnNlZENvb2tpZSA9IHBhcnNlQ29va2llcyhjb29raWVzKTtcbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gcGFyc2VkQ29va2llLmdldChuYW1lKTtcbiAgaWYgKHNlc3Npb25Ub2tlbikge1xuICAgIHJldHVybiBzZXNzaW9uVG9rZW47XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xudmFyIGdldENvb2tpZUNhY2hlID0gKHJlcXVlc3QsIGNvbmZpZykgPT4ge1xuICBjb25zdCBoZWFkZXJzID0gcmVxdWVzdCBpbnN0YW5jZW9mIEhlYWRlcnMgPyByZXF1ZXN0IDogcmVxdWVzdC5oZWFkZXJzO1xuICBjb25zdCBjb29raWVzID0gaGVhZGVycy5nZXQoXCJjb29raWVcIik7XG4gIGlmICghY29va2llcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHsgY29va2llTmFtZSA9IFwic2Vzc2lvbl9kYXRhXCIsIGNvb2tpZVByZWZpeCA9IFwiYmV0dGVyLWF1dGhcIiB9ID0gY29uZmlnIHx8IHt9O1xuICBjb25zdCBuYW1lID0gaXNQcm9kdWN0aW9uID8gYF9fU2VjdXJlLSR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YCA6IGAke2Nvb2tpZVByZWZpeH0uJHtjb29raWVOYW1lfWA7XG4gIGNvbnN0IHBhcnNlZENvb2tpZSA9IHBhcnNlQ29va2llcyhjb29raWVzKTtcbiAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBwYXJzZWRDb29raWUuZ2V0KG5hbWUpO1xuICBpZiAoc2Vzc2lvbkRhdGEpIHtcbiAgICByZXR1cm4gc2FmZUpTT05QYXJzZShzZXNzaW9uRGF0YSk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xuXG5leHBvcnQgeyBjcmVhdGVDb29raWVHZXR0ZXIsIGRlbGV0ZVNlc3Npb25Db29raWUsIGdldENvb2tpZUNhY2hlLCBnZXRDb29raWVzLCBnZXRTZXNzaW9uQ29va2llLCBwYXJzZUNvb2tpZXMsIHBhcnNlU2V0Q29va2llSGVhZGVyLCBzZXRDb29raWVDYWNoZSwgc2V0U2Vzc2lvbkNvb2tpZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   phoneNumber: () => (/* binding */ phoneNumber)\n/* harmony export */ });\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\n\n\n\n\nfunction generateOTP(size) {\n  return (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_3__.generateRandomString)(size, \"0-9\");\n}\nvar phoneNumber = (options) => {\n  const opts = {\n    expiresIn: options?.expiresIn || 300,\n    otpLength: options?.otpLength || 6,\n    ...options,\n    phoneNumber: \"phoneNumber\",\n    phoneNumberVerified: \"phoneNumberVerified\",\n    code: \"code\",\n    createdAt: \"createdAt\"\n  };\n  const ERROR_CODES = {\n    INVALID_PHONE_NUMBER: \"Invalid phone number\",\n    INVALID_PHONE_NUMBER_OR_PASSWORD: \"Invalid phone number or password\",\n    UNEXPECTED_ERROR: \"Unexpected error\",\n    OTP_NOT_FOUND: \"OTP not found\"\n  };\n  return {\n    id: \"phone-number\",\n    endpoints: {\n      signInPhoneNumber: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/sign-in/phone-number\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n            phoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Phone number to sign in\"\n            }),\n            password: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Password to use for sign in\"\n            }),\n            rememberMe: zod__WEBPACK_IMPORTED_MODULE_5__.z.boolean({\n              description: \"Remember the session\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Sign in with phone number\",\n              description: \"Use this endpoint to sign in with phone number\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                },\n                400: {\n                  description: \"Invalid phone number or password\"\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const { password, phoneNumber: phoneNumber2 } = ctx.body;\n          if (opts.phoneNumberValidator) {\n            const isValidNumber = await opts.phoneNumberValidator(\n              ctx.body.phoneNumber\n            );\n            if (!isValidNumber) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.INVALID_PHONE_NUMBER\n              });\n            }\n          }\n          const user = await ctx.context.adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                field: \"phoneNumber\",\n                value: phoneNumber2\n              }\n            ]\n          });\n          if (!user) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_PHONE_NUMBER_OR_PASSWORD\n            });\n          }\n          const accounts = await ctx.context.internalAdapter.findAccountByUserId(user.id);\n          const credentialAccount = accounts.find(\n            (a) => a.providerId === \"credential\"\n          );\n          if (!credentialAccount) {\n            ctx.context.logger.error(\"Credential account not found\", {\n              phoneNumber: phoneNumber2\n            });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_PHONE_NUMBER_OR_PASSWORD\n            });\n          }\n          const currentPassword = credentialAccount?.password;\n          if (!currentPassword) {\n            ctx.context.logger.error(\"Password not found\", { phoneNumber: phoneNumber2 });\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.UNEXPECTED_ERROR\n            });\n          }\n          const validPassword = await ctx.context.password.verify({\n            hash: currentPassword,\n            password\n          });\n          if (!validPassword) {\n            ctx.context.logger.error(\"Invalid password\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: ERROR_CODES.INVALID_PHONE_NUMBER_OR_PASSWORD\n            });\n          }\n          const session = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.headers,\n            ctx.body.rememberMe === false\n          );\n          if (!session) {\n            ctx.context.logger.error(\"Failed to create session\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n            });\n          }\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(\n            ctx,\n            {\n              session,\n              user\n            },\n            ctx.body.rememberMe === false\n          );\n          return ctx.json({\n            token: session.token,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              phoneNumber: user.phoneNumber,\n              phoneNumberVerified: user.phoneNumberVerified,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        }\n      ),\n      sendPhoneNumberOTP: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/phone-number/send-otp\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n            phoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Phone number to send OTP\"\n            })\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Send OTP to phone number\",\n              description: \"Use this endpoint to send OTP to phone number\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          message: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          if (!options?.sendOTP) {\n            ctx.context.logger.warn(\"sendOTP not implemented\");\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"NOT_IMPLEMENTED\", {\n              message: \"sendOTP not implemented\"\n            });\n          }\n          if (opts.phoneNumberValidator) {\n            const isValidNumber = await opts.phoneNumberValidator(\n              ctx.body.phoneNumber\n            );\n            if (!isValidNumber) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n                message: ERROR_CODES.INVALID_PHONE_NUMBER\n              });\n            }\n          }\n          const code = generateOTP(opts.otpLength);\n          await ctx.context.internalAdapter.createVerificationValue({\n            value: code,\n            identifier: ctx.body.phoneNumber,\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_4__.getDate)(opts.expiresIn, \"sec\")\n          });\n          await options.sendOTP(\n            {\n              phoneNumber: ctx.body.phoneNumber,\n              code\n            },\n            ctx.request\n          );\n          return ctx.json(\n            { code },\n            {\n              body: {\n                message: \"Code sent\"\n              }\n            }\n          );\n        }\n      ),\n      verifyPhoneNumber: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.createAuthEndpoint)(\n        \"/phone-number/verify\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_5__.z.object({\n            /**\n             * Phone number\n             */\n            phoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"Phone number to verify\"\n            }),\n            /**\n             * OTP code\n             */\n            code: zod__WEBPACK_IMPORTED_MODULE_5__.z.string({\n              description: \"OTP code\"\n            }),\n            /**\n             * Disable session creation after verification\n             * @default false\n             */\n            disableSession: zod__WEBPACK_IMPORTED_MODULE_5__.z.boolean({\n              description: \"Disable session creation after verification\"\n            }).optional(),\n            /**\n             * This checks if there is a session already\n             * and updates the phone number with the provided\n             * phone number\n             */\n            updatePhoneNumber: zod__WEBPACK_IMPORTED_MODULE_5__.z.boolean({\n              description: \"Check if there is a session and update the phone number\"\n            }).optional()\n          }),\n          metadata: {\n            openapi: {\n              summary: \"Verify phone number\",\n              description: \"Use this endpoint to verify phone number\",\n              responses: {\n                200: {\n                  description: \"Success\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          user: {\n                            $ref: \"#/components/schemas/User\"\n                          },\n                          session: {\n                            $ref: \"#/components/schemas/Session\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                },\n                400: {\n                  description: \"Invalid OTP\"\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const otp = await ctx.context.internalAdapter.findVerificationValue(\n            ctx.body.phoneNumber\n          );\n          if (!otp || otp.expiresAt < /* @__PURE__ */ new Date()) {\n            if (otp && otp.expiresAt < /* @__PURE__ */ new Date()) {\n              await ctx.context.internalAdapter.deleteVerificationValue(otp.id);\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n                message: \"OTP expired\"\n              });\n            }\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n              message: ERROR_CODES.OTP_NOT_FOUND\n            });\n          }\n          if (otp.value !== ctx.body.code) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"BAD_REQUEST\", {\n              message: \"Invalid OTP\"\n            });\n          }\n          await ctx.context.internalAdapter.deleteVerificationValue(otp.id);\n          if (ctx.body.updatePhoneNumber) {\n            const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCtx)(ctx);\n            if (!session) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"UNAUTHORIZED\", {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.USER_NOT_FOUND\n              });\n            }\n            let user2 = await ctx.context.internalAdapter.updateUser(\n              session.user.id,\n              {\n                [opts.phoneNumber]: ctx.body.phoneNumber,\n                [opts.phoneNumberVerified]: true\n              }\n            );\n            return ctx.json({\n              status: true,\n              token: session.session.token,\n              user: {\n                id: user2.id,\n                email: user2.email,\n                emailVerified: user2.emailVerified,\n                name: user2.name,\n                image: user2.image,\n                phoneNumber: user2.phoneNumber,\n                phoneNumberVerified: user2.phoneNumberVerified,\n                createdAt: user2.createdAt,\n                updatedAt: user2.updatedAt\n              }\n            });\n          }\n          let user = await ctx.context.adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                value: ctx.body.phoneNumber,\n                field: opts.phoneNumber\n              }\n            ]\n          });\n          if (!user) {\n            if (options?.signUpOnVerification) {\n              user = await ctx.context.internalAdapter.createUser({\n                email: options.signUpOnVerification.getTempEmail(\n                  ctx.body.phoneNumber\n                ),\n                name: options.signUpOnVerification.getTempName ? options.signUpOnVerification.getTempName(\n                  ctx.body.phoneNumber\n                ) : ctx.body.phoneNumber,\n                [opts.phoneNumber]: ctx.body.phoneNumber,\n                [opts.phoneNumberVerified]: true\n              });\n              if (!user) {\n                throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"INTERNAL_SERVER_ERROR\", {\n                  message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n                });\n              }\n            }\n          } else {\n            user = await ctx.context.internalAdapter.updateUser(user.id, {\n              [opts.phoneNumberVerified]: true\n            });\n          }\n          if (!user) {\n            return ctx.json(null);\n          }\n          await options?.callbackOnVerification?.(\n            {\n              phoneNumber: ctx.body.phoneNumber,\n              user\n            },\n            ctx.request\n          );\n          if (!user) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"INTERNAL_SERVER_ERROR\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_UPDATE_USER\n            });\n          }\n          if (!ctx.body.disableSession) {\n            const session = await ctx.context.internalAdapter.createSession(\n              user.id,\n              ctx.request\n            );\n            if (!session) {\n              throw new better_call__WEBPACK_IMPORTED_MODULE_6__.APIError(\"INTERNAL_SERVER_ERROR\", {\n                message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_0__.BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n              });\n            }\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_1__.setSessionCookie)(ctx, {\n              session,\n              user\n            });\n            return ctx.json({\n              status: true,\n              token: session.token,\n              user: {\n                id: user.id,\n                email: user.email,\n                emailVerified: user.emailVerified,\n                name: user.name,\n                image: user.image,\n                phoneNumber: user.phoneNumber,\n                phoneNumberVerified: user.phoneNumberVerified,\n                createdAt: user.createdAt,\n                updatedAt: user.updatedAt\n              }\n            });\n          }\n          return ctx.json({\n            status: true,\n            token: null,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              phoneNumber: user.phoneNumber,\n              phoneNumberVerified: user.phoneNumberVerified,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        }\n      )\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_2__.mergeSchema)(schema, options?.schema),\n    $ERROR_CODES: ERROR_CODES\n  };\n};\nvar schema = {\n  user: {\n    fields: {\n      phoneNumber: {\n        type: \"string\",\n        required: false,\n        unique: true,\n        sortable: true,\n        returned: true\n      },\n      phoneNumberVerified: {\n        type: \"boolean\",\n        required: false,\n        returned: true,\n        input: false\n      }\n    }\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVJCT0FENTVZLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQThGO0FBQ3ZDO0FBQ0w7QUFDUztBQUNiO0FBQ3RCO0FBQ2U7O0FBRXZDO0FBQ0EsU0FBUyx3RUFBb0I7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzRUFBa0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlDQUFRO0FBQ3hCLHlCQUF5Qix5Q0FBUTtBQUNqQztBQUNBLGFBQWE7QUFDYixzQkFBc0IseUNBQVE7QUFDOUI7QUFDQSxhQUFhO0FBQ2Isd0JBQXdCLDBDQUFTO0FBQ2pDO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLGtCQUFrQixzQ0FBc0M7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpREFBUTtBQUNoQztBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLHNCQUFzQixpREFBUTtBQUM5QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLHNCQUFzQixpREFBUTtBQUM5QjtBQUNB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O0FBQ0EsZUFBZTtBQUNmO0FBQ0EsMEJBQTBCLGlEQUFRO0FBQ2xDLDJCQUEyQixnRUFBZ0I7QUFDM0MsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpREFBUTtBQUM5Qix1QkFBdUIsZ0VBQWdCO0FBQ3ZDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpREFBUTtBQUNoQyx5QkFBeUIsZ0VBQWdCO0FBQ3pDLGVBQWU7QUFDZjtBQUNBLGtCQUFrQixvRUFBZ0I7QUFDbEM7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVksK0RBQVc7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFdUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1SQk9BRDU1WS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIEJBU0VfRVJST1JfQ09ERVMsIGdldFNlc3Npb25Gcm9tQ3R4IH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBtZXJnZVNjaGVtYSB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCB7IGdldERhdGUgfSBmcm9tICcuL2NodW5rLUZVUk5BNkhZLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlT1RQKHNpemUpIHtcbiAgcmV0dXJuIGdlbmVyYXRlUmFuZG9tU3RyaW5nKHNpemUsIFwiMC05XCIpO1xufVxudmFyIHBob25lTnVtYmVyID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3Qgb3B0cyA9IHtcbiAgICBleHBpcmVzSW46IG9wdGlvbnM/LmV4cGlyZXNJbiB8fCAzMDAsXG4gICAgb3RwTGVuZ3RoOiBvcHRpb25zPy5vdHBMZW5ndGggfHwgNixcbiAgICAuLi5vcHRpb25zLFxuICAgIHBob25lTnVtYmVyOiBcInBob25lTnVtYmVyXCIsXG4gICAgcGhvbmVOdW1iZXJWZXJpZmllZDogXCJwaG9uZU51bWJlclZlcmlmaWVkXCIsXG4gICAgY29kZTogXCJjb2RlXCIsXG4gICAgY3JlYXRlZEF0OiBcImNyZWF0ZWRBdFwiXG4gIH07XG4gIGNvbnN0IEVSUk9SX0NPREVTID0ge1xuICAgIElOVkFMSURfUEhPTkVfTlVNQkVSOiBcIkludmFsaWQgcGhvbmUgbnVtYmVyXCIsXG4gICAgSU5WQUxJRF9QSE9ORV9OVU1CRVJfT1JfUEFTU1dPUkQ6IFwiSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmRcIixcbiAgICBVTkVYUEVDVEVEX0VSUk9SOiBcIlVuZXhwZWN0ZWQgZXJyb3JcIixcbiAgICBPVFBfTk9UX0ZPVU5EOiBcIk9UUCBub3QgZm91bmRcIlxuICB9O1xuICByZXR1cm4ge1xuICAgIGlkOiBcInBob25lLW51bWJlclwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgc2lnbkluUGhvbmVOdW1iZXI6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvc2lnbi1pbi9waG9uZS1udW1iZXJcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiUGhvbmUgbnVtYmVyIHRvIHNpZ24gaW5cIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXNzd29yZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJQYXNzd29yZCB0byB1c2UgZm9yIHNpZ24gaW5cIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICByZW1lbWJlck1lOiB6LmJvb2xlYW4oe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZW1lbWJlciB0aGUgc2Vzc2lvblwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJTaWduIGluIHdpdGggcGhvbmUgbnVtYmVyXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZSB0aGlzIGVuZHBvaW50IHRvIHNpZ24gaW4gd2l0aCBwaG9uZSBudW1iZXJcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9Vc2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvU2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIDQwMDoge1xuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmRcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgcGFzc3dvcmQsIHBob25lTnVtYmVyOiBwaG9uZU51bWJlcjIgfSA9IGN0eC5ib2R5O1xuICAgICAgICAgIGlmIChvcHRzLnBob25lTnVtYmVyVmFsaWRhdG9yKSB7XG4gICAgICAgICAgICBjb25zdCBpc1ZhbGlkTnVtYmVyID0gYXdhaXQgb3B0cy5waG9uZU51bWJlclZhbGlkYXRvcihcbiAgICAgICAgICAgICAgY3R4LmJvZHkucGhvbmVOdW1iZXJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIWlzVmFsaWROdW1iZXIpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLklOVkFMSURfUEhPTkVfTlVNQkVSXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJwaG9uZU51bWJlclwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBwaG9uZU51bWJlcjJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9QSE9ORV9OVU1CRVJfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudEJ5VXNlcklkKHVzZXIuaWQpO1xuICAgICAgICAgIGNvbnN0IGNyZWRlbnRpYWxBY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgICAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIWNyZWRlbnRpYWxBY2NvdW50KSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJDcmVkZW50aWFsIGFjY291bnQgbm90IGZvdW5kXCIsIHtcbiAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHBob25lTnVtYmVyMlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5JTlZBTElEX1BIT05FX05VTUJFUl9PUl9QQVNTV09SRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYXNzd29yZCA9IGNyZWRlbnRpYWxBY2NvdW50Py5wYXNzd29yZDtcbiAgICAgICAgICBpZiAoIWN1cnJlbnRQYXNzd29yZCkge1xuICAgICAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgbm90IGZvdW5kXCIsIHsgcGhvbmVOdW1iZXI6IHBob25lTnVtYmVyMiB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEVSUk9SX0NPREVTLlVORVhQRUNURURfRVJST1JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWxpZFBhc3N3b3JkID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICAgICAgICAgIGhhc2g6IGN1cnJlbnRQYXNzd29yZCxcbiAgICAgICAgICAgIHBhc3N3b3JkXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCF2YWxpZFBhc3N3b3JkKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIHBhc3N3b3JkXCIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9QSE9ORV9OVU1CRVJfT1JfUEFTU1dPUkRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICB1c2VyLmlkLFxuICAgICAgICAgICAgY3R4LmhlYWRlcnMsXG4gICAgICAgICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoXG4gICAgICAgICAgICBjdHgsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHVzZXIucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgIHBob25lTnVtYmVyVmVyaWZpZWQ6IHVzZXIucGhvbmVOdW1iZXJWZXJpZmllZCxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgc2VuZFBob25lTnVtYmVyT1RQOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3Bob25lLW51bWJlci9zZW5kLW90cFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBwaG9uZU51bWJlcjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJQaG9uZSBudW1iZXIgdG8gc2VuZCBPVFBcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlNlbmQgT1RQIHRvIHBob25lIG51bWJlclwiLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2UgdGhpcyBlbmRwb2ludCB0byBzZW5kIE9UUCB0byBwaG9uZSBudW1iZXJcIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgaWYgKCFvcHRpb25zPy5zZW5kT1RQKSB7XG4gICAgICAgICAgICBjdHguY29udGV4dC5sb2dnZXIud2FybihcInNlbmRPVFAgbm90IGltcGxlbWVudGVkXCIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0lNUExFTUVOVEVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJzZW5kT1RQIG5vdCBpbXBsZW1lbnRlZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wdHMucGhvbmVOdW1iZXJWYWxpZGF0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWROdW1iZXIgPSBhd2FpdCBvcHRzLnBob25lTnVtYmVyVmFsaWRhdG9yKFxuICAgICAgICAgICAgICBjdHguYm9keS5waG9uZU51bWJlclxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghaXNWYWxpZE51bWJlcikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogRVJST1JfQ09ERVMuSU5WQUxJRF9QSE9ORV9OVU1CRVJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGNvZGUgPSBnZW5lcmF0ZU9UUChvcHRzLm90cExlbmd0aCk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgICAgIHZhbHVlOiBjb2RlLFxuICAgICAgICAgICAgaWRlbnRpZmllcjogY3R4LmJvZHkucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICBleHBpcmVzQXQ6IGdldERhdGUob3B0cy5leHBpcmVzSW4sIFwic2VjXCIpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgb3B0aW9ucy5zZW5kT1RQKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBwaG9uZU51bWJlcjogY3R4LmJvZHkucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgIGNvZGVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgICAgeyBjb2RlIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkNvZGUgc2VudFwiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgdmVyaWZ5UGhvbmVOdW1iZXI6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvcGhvbmUtbnVtYmVyL3ZlcmlmeVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFBob25lIG51bWJlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBwaG9uZU51bWJlcjogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJQaG9uZSBudW1iZXIgdG8gdmVyaWZ5XCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPVFAgY29kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb2RlOiB6LnN0cmluZyh7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk9UUCBjb2RlXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBEaXNhYmxlIHNlc3Npb24gY3JlYXRpb24gYWZ0ZXIgdmVyaWZpY2F0aW9uXG4gICAgICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkaXNhYmxlU2Vzc2lvbjogei5ib29sZWFuKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBzZXNzaW9uIGNyZWF0aW9uIGFmdGVyIHZlcmlmaWNhdGlvblwiXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaGlzIGNoZWNrcyBpZiB0aGVyZSBpcyBhIHNlc3Npb24gYWxyZWFkeVxuICAgICAgICAgICAgICogYW5kIHVwZGF0ZXMgdGhlIHBob25lIG51bWJlciB3aXRoIHRoZSBwcm92aWRlZFxuICAgICAgICAgICAgICogcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHVwZGF0ZVBob25lTnVtYmVyOiB6LmJvb2xlYW4oe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJDaGVjayBpZiB0aGVyZSBpcyBhIHNlc3Npb24gYW5kIHVwZGF0ZSB0aGUgcGhvbmUgbnVtYmVyXCJcbiAgICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIlZlcmlmeSBwaG9uZSBudW1iZXJcIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHRoaXMgZW5kcG9pbnQgdG8gdmVyaWZ5IHBob25lIG51bWJlclwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgNDAwOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbnZhbGlkIE9UUFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgY29uc3Qgb3RwID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAgICAgIGN0eC5ib2R5LnBob25lTnVtYmVyXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIW90cCB8fCBvdHAuZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgIGlmIChvdHAgJiYgb3RwLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShvdHAuaWQpO1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJPVFAgZXhwaXJlZFwiXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBFUlJPUl9DT0RFUy5PVFBfTk9UX0ZPVU5EXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG90cC52YWx1ZSAhPT0gY3R4LmJvZHkuY29kZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgT1RQXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUob3RwLmlkKTtcbiAgICAgICAgICBpZiAoY3R4LmJvZHkudXBkYXRlUGhvbmVOdW1iZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgICAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX05PVF9GT1VORFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCB1c2VyMiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgICAgICAgICBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBbb3B0cy5waG9uZU51bWJlcl06IGN0eC5ib2R5LnBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIFtvcHRzLnBob25lTnVtYmVyVmVyaWZpZWRdOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogdXNlcjIuaWQsXG4gICAgICAgICAgICAgICAgZW1haWw6IHVzZXIyLmVtYWlsLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgICAgbmFtZTogdXNlcjIubmFtZSxcbiAgICAgICAgICAgICAgICBpbWFnZTogdXNlcjIuaW1hZ2UsXG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHVzZXIyLnBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIHBob25lTnVtYmVyVmVyaWZpZWQ6IHVzZXIyLnBob25lTnVtYmVyVmVyaWZpZWQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyMi5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyMi51cGRhdGVkQXRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3R4LmJvZHkucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgZmllbGQ6IG9wdHMucGhvbmVOdW1iZXJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnM/LnNpZ25VcE9uVmVyaWZpY2F0aW9uKSB7XG4gICAgICAgICAgICAgIHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVXNlcih7XG4gICAgICAgICAgICAgICAgZW1haWw6IG9wdGlvbnMuc2lnblVwT25WZXJpZmljYXRpb24uZ2V0VGVtcEVtYWlsKFxuICAgICAgICAgICAgICAgICAgY3R4LmJvZHkucGhvbmVOdW1iZXJcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIG5hbWU6IG9wdGlvbnMuc2lnblVwT25WZXJpZmljYXRpb24uZ2V0VGVtcE5hbWUgPyBvcHRpb25zLnNpZ25VcE9uVmVyaWZpY2F0aW9uLmdldFRlbXBOYW1lKFxuICAgICAgICAgICAgICAgICAgY3R4LmJvZHkucGhvbmVOdW1iZXJcbiAgICAgICAgICAgICAgICApIDogY3R4LmJvZHkucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgW29wdHMucGhvbmVOdW1iZXJdOiBjdHguYm9keS5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICBbb3B0cy5waG9uZU51bWJlclZlcmlmaWVkXTogdHJ1ZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKHVzZXIuaWQsIHtcbiAgICAgICAgICAgICAgW29wdHMucGhvbmVOdW1iZXJWZXJpZmllZF06IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgb3B0aW9ucz8uY2FsbGJhY2tPblZlcmlmaWNhdGlvbj8uKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBwaG9uZU51bWJlcjogY3R4LmJvZHkucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19VUERBVEVfVVNFUlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghY3R4LmJvZHkuZGlzYWJsZVNlc3Npb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgICAgdXNlci5pZCxcbiAgICAgICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgICAgICB0b2tlbjogc2Vzc2lvbi50b2tlbixcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHVzZXIucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXJWZXJpZmllZDogdXNlci5waG9uZU51bWJlclZlcmlmaWVkLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogdXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHVzZXIucGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgIHBob25lTnVtYmVyVmVyaWZpZWQ6IHVzZXIucGhvbmVOdW1iZXJWZXJpZmllZCxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICBzY2hlbWE6IG1lcmdlU2NoZW1hKHNjaGVtYSwgb3B0aW9ucz8uc2NoZW1hKSxcbiAgICAkRVJST1JfQ09ERVM6IEVSUk9SX0NPREVTXG4gIH07XG59O1xudmFyIHNjaGVtYSA9IHtcbiAgdXNlcjoge1xuICAgIGZpZWxkczoge1xuICAgICAgcGhvbmVOdW1iZXI6IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICByZXR1cm5lZDogdHJ1ZVxuICAgICAgfSxcbiAgICAgIHBob25lTnVtYmVyVmVyaWZpZWQ6IHtcbiAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgcmV0dXJuZWQ6IHRydWUsXG4gICAgICAgIGlucHV0OiBmYWxzZVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IHsgcGhvbmVOdW1iZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkPassword: () => (/* binding */ checkPassword),\n/* harmony export */   validatePassword: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n// src/utils/password.ts\nasync function validatePassword(ctx, data) {\n  const accounts = await ctx.context.internalAdapter.findAccounts(data.userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword) {\n    return false;\n  }\n  const compare = await ctx.context.password.verify({\n    hash: currentPassword,\n    password: data.password\n  });\n  return compare;\n}\nasync function checkPassword(userId, c) {\n  const accounts = await c.context.internalAdapter.findAccounts(userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword || !c.body.password) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"No password credential found\"\n    });\n  }\n  const compare = await c.context.password.verify({\n    hash: currentPassword,\n    password: c.body.password\n  });\n  if (!compare) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid password\"\n    });\n  }\n  return true;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVRPS1pMM1pJLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1Qzs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpREFBUTtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGNBQWMsaURBQVE7QUFDdEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUUyQyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVRPS1pMM1pJLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG4vLyBzcmMvdXRpbHMvcGFzc3dvcmQudHNcbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUGFzc3dvcmQoY3R4LCBkYXRhKSB7XG4gIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhkYXRhLnVzZXJJZCk7XG4gIGNvbnN0IGNyZWRlbnRpYWxBY2NvdW50ID0gYWNjb3VudHM/LmZpbmQoXG4gICAgKGFjY291bnQpID0+IGFjY291bnQucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCJcbiAgKTtcbiAgY29uc3QgY3VycmVudFBhc3N3b3JkID0gY3JlZGVudGlhbEFjY291bnQ/LnBhc3N3b3JkO1xuICBpZiAoIWNyZWRlbnRpYWxBY2NvdW50IHx8ICFjdXJyZW50UGFzc3dvcmQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29uc3QgY29tcGFyZSA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgIHBhc3N3b3JkOiBkYXRhLnBhc3N3b3JkXG4gIH0pO1xuICByZXR1cm4gY29tcGFyZTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrUGFzc3dvcmQodXNlcklkLCBjKSB7XG4gIGNvbnN0IGFjY291bnRzID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHModXNlcklkKTtcbiAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSBhY2NvdW50cz8uZmluZChcbiAgICAoYWNjb3VudCkgPT4gYWNjb3VudC5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIlxuICApO1xuICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBjcmVkZW50aWFsQWNjb3VudD8ucGFzc3dvcmQ7XG4gIGlmICghY3JlZGVudGlhbEFjY291bnQgfHwgIWN1cnJlbnRQYXNzd29yZCB8fCAhYy5ib2R5LnBhc3N3b3JkKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJObyBwYXNzd29yZCBjcmVkZW50aWFsIGZvdW5kXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBjb21wYXJlID0gYXdhaXQgYy5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgIHBhc3N3b3JkOiBjLmJvZHkucGFzc3dvcmRcbiAgfSk7XG4gIGlmICghY29tcGFyZSkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBwYXNzd29yZFwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCB7IGNoZWNrUGFzc3dvcmQsIHZhbGlkYXRlUGFzc3dvcmQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   env: () => (/* binding */ env),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   isTest: () => (/* binding */ isTest)\n/* harmony export */ });\n// src/utils/env.ts\nvar _envShim = /* @__PURE__ */ Object.create(null);\nvar _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nvar env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nvar nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nvar isProduction = nodeENV === \"production\";\nvar isDevelopment = nodeENV === \"dev\" || nodeENV === \"development\";\nvar isTest = nodeENV === \"test\" || toBoolean(env.TEST);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVRRUVNQUE5BLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxhQUFvQjtBQUNuRjtBQUNBO0FBQ0E7O0FBRW9EIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVFFRU1BQTkEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3V0aWxzL2Vudi50c1xudmFyIF9lbnZTaGltID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5jcmVhdGUobnVsbCk7XG52YXIgX2dldEVudiA9ICh1c2VTaGltKSA9PiBnbG9iYWxUaGlzLnByb2Nlc3M/LmVudiB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuRGVubz8uZW52LnRvT2JqZWN0KCkgfHwgLy9AdHMtZXhwZWN0LWVycm9yXG5nbG9iYWxUaGlzLl9fZW52X18gfHwgKHVzZVNoaW0gPyBfZW52U2hpbSA6IGdsb2JhbFRoaXMpO1xudmFyIGVudiA9IG5ldyBQcm94eShfZW52U2hpbSwge1xuICBnZXQoXywgcHJvcCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KCk7XG4gICAgcmV0dXJuIGVudjJbcHJvcF0gPz8gX2VudlNoaW1bcHJvcF07XG4gIH0sXG4gIGhhcyhfLCBwcm9wKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYoKTtcbiAgICByZXR1cm4gcHJvcCBpbiBlbnYyIHx8IHByb3AgaW4gX2VudlNoaW07XG4gIH0sXG4gIHNldChfLCBwcm9wLCB2YWx1ZSkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIGVudjJbcHJvcF0gPSB2YWx1ZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgZGVsZXRlUHJvcGVydHkoXywgcHJvcCkge1xuICAgIGlmICghcHJvcCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBlbnYyID0gX2dldEVudih0cnVlKTtcbiAgICBkZWxldGUgZW52Mltwcm9wXTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgb3duS2V5cygpIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudih0cnVlKTtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoZW52Mik7XG4gIH1cbn0pO1xuZnVuY3Rpb24gdG9Cb29sZWFuKHZhbCkge1xuICByZXR1cm4gdmFsID8gdmFsICE9PSBcImZhbHNlXCIgOiBmYWxzZTtcbn1cbnZhciBub2RlRU5WID0gdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgXCJcIjtcbnZhciBpc1Byb2R1Y3Rpb24gPSBub2RlRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbnZhciBpc0RldmVsb3BtZW50ID0gbm9kZUVOViA9PT0gXCJkZXZcIiB8fCBub2RlRU5WID09PSBcImRldmVsb3BtZW50XCI7XG52YXIgaXNUZXN0ID0gbm9kZUVOViA9PT0gXCJ0ZXN0XCIgfHwgdG9Cb29sZWFuKGVudi5URVNUKTtcblxuZXhwb3J0IHsgZW52LCBpc0RldmVsb3BtZW50LCBpc1Byb2R1Y3Rpb24sIGlzVGVzdCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BetterAuthError: () => (/* binding */ BetterAuthError),\n/* harmony export */   MissingDependencyError: () => (/* binding */ MissingDependencyError)\n/* harmony export */ });\n// src/error/index.ts\nvar BetterAuthError = class extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n};\nvar MissingDependencyError = class extends BetterAuthError {\n  constructor(pkgName) {\n    super(\n      `The package \"${pkgName}\" is required. Make sure it is installed.`,\n      pkgName\n    );\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVVOV0NYS01QLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsUUFBUTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTs7QUFFbUQiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1VTldDWEtNUC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZXJyb3IvaW5kZXgudHNcbnZhciBCZXR0ZXJBdXRoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgY2F1c2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkJldHRlckF1dGhFcnJvclwiO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5jYXVzZSA9IGNhdXNlO1xuICAgIHRoaXMuc3RhY2sgPSBcIlwiO1xuICB9XG59O1xudmFyIE1pc3NpbmdEZXBlbmRlbmN5RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJldHRlckF1dGhFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHBrZ05hbWUpIHtcbiAgICBzdXBlcihcbiAgICAgIGBUaGUgcGFja2FnZSBcIiR7cGtnTmFtZX1cIiBpcyByZXF1aXJlZC4gTWFrZSBzdXJlIGl0IGlzIGluc3RhbGxlZC5gLFxuICAgICAgcGtnTmFtZVxuICAgICk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IEJldHRlckF1dGhFcnJvciwgTWlzc2luZ0RlcGVuZGVuY3lFcnJvciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   twoFactor: () => (/* binding */ twoFactor)\n/* harmony export */ });\n/* harmony import */ var _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-WMXBA6LX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\");\n/* harmony import */ var _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-TOKZL3ZI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/otp */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/otp.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n// src/plugins/two-factor/constant.ts\nvar TWO_FACTOR_COOKIE_NAME = \"two_factor\";\nvar TRUST_DEVICE_COOKIE_NAME = \"trust_device\";\nvar verifyTwoFactorMiddleware = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(\n  {\n    body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n      /**\n       * if true, the device will be trusted\n       * for 30 days. It'll be refreshed on\n       * every sign in request within this time.\n       */\n      trustDevice: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean().optional()\n    })\n  },\n  async (ctx) => {\n    const session = await (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.getSessionFromCtx)(ctx);\n    if (!session) {\n      const cookieName = ctx.context.createAuthCookie(TWO_FACTOR_COOKIE_NAME);\n      const userId = await ctx.getSignedCookie(\n        cookieName.name,\n        ctx.context.secret\n      );\n      if (!userId) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n          message: \"invalid two factor cookie\"\n        });\n      }\n      const user = await ctx.context.internalAdapter.findUserById(\n        userId\n      );\n      if (!user) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n          message: \"invalid two factor cookie\"\n        });\n      }\n      const session2 = await ctx.context.internalAdapter.createSession(\n        userId,\n        ctx.request\n      );\n      if (!session2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: \"failed to create session\"\n        });\n      }\n      return {\n        valid: async () => {\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n            session: session2,\n            user\n          });\n          if (ctx.body.trustDevice) {\n            const trustDeviceCookie = ctx.context.createAuthCookie(\n              TRUST_DEVICE_COOKIE_NAME,\n              {\n                maxAge: 30 * 24 * 60 * 60\n                // 30 days, it'll be refreshed on sign in requests\n              }\n            );\n            const token = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n              ctx.context.secret,\n              `${user.id}!${session2.token}`\n            );\n            await ctx.setSignedCookie(\n              trustDeviceCookie.name,\n              `${token}!${session2.token}`,\n              ctx.context.secret,\n              trustDeviceCookie.attributes\n            );\n          }\n          return ctx.json({\n            token: session2.token,\n            user: {\n              id: user.id,\n              email: user.email,\n              emailVerified: user.emailVerified,\n              name: user.name,\n              image: user.image,\n              createdAt: user.createdAt,\n              updatedAt: user.updatedAt\n            }\n          });\n        },\n        invalid: async () => {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n            message: \"invalid two factor authentication\"\n          });\n        },\n        session: {\n          session: session2,\n          user\n        }\n      };\n    }\n    return {\n      valid: async () => {\n        return ctx.json({\n          token: session.session.token,\n          user: {\n            id: session.user.id,\n            email: session.user.email,\n            emailVerified: session.user.emailVerified,\n            name: session.user.name,\n            image: session.user.image,\n            createdAt: session.user.createdAt,\n            updatedAt: session.user.updatedAt\n          }\n        });\n      },\n      invalid: async () => {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n          message: \"invalid two factor authentication\"\n        });\n      },\n      session\n    };\n  }\n);\nfunction generateBackupCodesFn(options) {\n  return Array.from({ length: 10 }).fill(null).map(() => (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.generateRandomString)(10, \"a-z\", \"0-9\", \"A-Z\")).map((code) => `${code.slice(0, 5)}-${code.slice(5)}`);\n}\nasync function generateBackupCodes(secret, options) {\n  const key = secret;\n  const backupCodes = options?.customBackupCodesGenerate ? options.customBackupCodesGenerate() : generateBackupCodesFn();\n  const encCodes = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricEncrypt)({\n    data: JSON.stringify(backupCodes),\n    key\n  });\n  return {\n    backupCodes,\n    encryptedBackupCodes: encCodes\n  };\n}\nasync function verifyBackupCode(data, key) {\n  const codes = await getBackupCodes(data.backupCodes, key);\n  if (!codes) {\n    return {\n      status: false,\n      updated: null\n    };\n  }\n  return {\n    status: codes.includes(data.code),\n    updated: codes.filter((code) => code !== data.code)\n  };\n}\nasync function getBackupCodes(backupCodes, key) {\n  const secret = Buffer.from(\n    await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricDecrypt)({ key, data: backupCodes })\n  ).toString(\"utf-8\");\n  const data = JSON.parse(secret);\n  const result = zod__WEBPACK_IMPORTED_MODULE_6__.z.array(zod__WEBPACK_IMPORTED_MODULE_6__.z.string()).safeParse(data);\n  if (result.success) {\n    return result.data;\n  }\n  return null;\n}\nvar backupCode2fa = (options) => {\n  const twoFactorTable = \"twoFactor\";\n  return {\n    id: \"backup_code\",\n    endpoints: {\n      verifyBackupCode: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/verify-backup-code\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string(),\n            /**\n             * Disable setting the session cookie\n             */\n            disableSession: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean().optional()\n          }),\n          use: [verifyTwoFactorMiddleware]\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          const twoFactor2 = await ctx.context.adapter.findOne({\n            model: twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              }\n            ]\n          });\n          if (!twoFactor2) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.BACKUP_CODES_NOT_ENABLED\n            });\n          }\n          const validate = await verifyBackupCode(\n            {\n              backupCodes: twoFactor2.backupCodes,\n              code: ctx.body.code\n            },\n            ctx.context.secret\n          );\n          if (!validate.status) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"UNAUTHORIZED\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.INVALID_BACKUP_CODE\n            });\n          }\n          const updatedBackupCodes = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricEncrypt)({\n            key: ctx.context.secret,\n            data: JSON.stringify(validate.updated)\n          });\n          await ctx.context.adapter.updateMany({\n            model: twoFactorTable,\n            update: {\n              backupCodes: updatedBackupCodes\n            },\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              }\n            ]\n          });\n          if (!ctx.body.disableSession) {\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n              session: ctx.context.session.session,\n              user\n            });\n          }\n          return ctx.json({\n            user,\n            session: ctx.context.session\n          });\n        }\n      ),\n      generateBackupCodes: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/generate-backup-codes\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string()\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware]\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          if (!user.twoFactorEnabled) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TWO_FACTOR_NOT_ENABLED\n            });\n          }\n          await ctx.context.password.checkPassword(user.id, ctx);\n          const backupCodes = await generateBackupCodes(\n            ctx.context.secret,\n            options\n          );\n          await ctx.context.adapter.update({\n            model: twoFactorTable,\n            update: {\n              backupCodes: backupCodes.encryptedBackupCodes\n            },\n            where: [\n              {\n                field: \"userId\",\n                value: ctx.context.session.user.id\n              }\n            ]\n          });\n          return ctx.json({\n            status: true,\n            backupCodes: backupCodes.backupCodes\n          });\n        }\n      ),\n      viewBackupCodes: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/view-backup-codes\",\n        {\n          method: \"GET\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            userId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string()\n          }),\n          metadata: {\n            SERVER_ONLY: true\n          }\n        },\n        async (ctx) => {\n          const twoFactor2 = await ctx.context.adapter.findOne({\n            model: twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: ctx.body.userId\n              }\n            ]\n          });\n          if (!twoFactor2) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: \"Backup codes aren't enabled\"\n            });\n          }\n          const backupCodes = await getBackupCodes(\n            twoFactor2.backupCodes,\n            ctx.context.secret\n          );\n          if (!backupCodes) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.BACKUP_CODES_NOT_ENABLED\n            });\n          }\n          return ctx.json({\n            status: true,\n            backupCodes\n          });\n        }\n      )\n    }\n  };\n};\nvar otp2fa = (options) => {\n  const opts = {\n    ...options,\n    digits: options?.digits || 6,\n    period: (options?.period || 3) * 60 * 1e3\n  };\n  const twoFactorTable = \"twoFactor\";\n  const send2FaOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/send-otp\",\n    {\n      method: \"POST\",\n      use: [verifyTwoFactorMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Send two factor OTP\",\n          description: \"Send two factor OTP to the user\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"boolean\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (!options || !options.sendOTP) {\n        ctx.context.logger.error(\n          \"send otp isn't configured. Please configure the send otp function on otp options.\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"otp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.OTP_NOT_ENABLED\n        });\n      }\n      const code = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.generateRandomString)(opts.digits, \"0-9\");\n      await ctx.context.internalAdapter.createVerificationValue({\n        value: code,\n        identifier: `2fa-otp-${user.id}`,\n        expiresAt: new Date(Date.now() + opts.period)\n      });\n      await options.sendOTP({ user, otp: code }, ctx.request);\n      return ctx.json({ status: true });\n    }\n  );\n  const verifyOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/verify-otp\",\n    {\n      method: \"POST\",\n      body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n          description: \"The otp code to verify\"\n        })\n      }),\n      use: [verifyTwoFactorMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Verify two factor OTP\",\n          description: \"Verify two factor OTP\",\n          responses: {\n            200: {\n              description: \"Success\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"boolean\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.OTP_NOT_ENABLED\n        });\n      }\n      const toCheckOtp = await ctx.context.internalAdapter.findVerificationValue(\n        `2fa-otp-${user.id}`\n      );\n      if (!toCheckOtp || toCheckOtp.expiresAt < /* @__PURE__ */ new Date()) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.OTP_HAS_EXPIRED\n        });\n      }\n      if (toCheckOtp.value === ctx.body.code) {\n        if (!user.twoFactorEnabled) {\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            user.id,\n            {\n              twoFactorEnabled: true\n            }\n          );\n          const newSession = await ctx.context.internalAdapter.createSession(\n            user.id,\n            ctx.request,\n            false,\n            ctx.context.session.session\n          );\n          await ctx.context.internalAdapter.deleteSession(\n            ctx.context.session.session.token\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n            session: newSession,\n            user: updatedUser\n          });\n        }\n        return ctx.context.valid();\n      } else {\n        return ctx.context.invalid();\n      }\n    }\n  );\n  return {\n    id: \"otp\",\n    endpoints: {\n      sendTwoFactorOTP: send2FaOTP,\n      verifyTwoFactorOTP: verifyOTP\n    }\n  };\n};\nvar totp2fa = (options) => {\n  const opts = {\n    ...options,\n    digits: options?.digits || 6,\n    period: options?.period || 30\n  };\n  const twoFactorTable = \"twoFactor\";\n  const generateTOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/totp/generate\",\n    {\n      method: \"POST\",\n      use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Generate TOTP code\",\n          description: \"Use this endpoint to generate a TOTP code\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      code: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (options?.disable) {\n        ctx.context.logger.error(\n          \"totp isn't configured. please pass totp option on two factor plugin to enable totp\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"totp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TOTP_NOT_ENABLED\n        });\n      }\n      const code = await (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(twoFactor2.secret, {\n        period: opts.period,\n        digits: opts.digits\n      }).totp();\n      return { code };\n    }\n  );\n  const getTOTPURI = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/get-totp-uri\",\n    {\n      method: \"POST\",\n      use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n      body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n          description: \"User password\"\n        })\n      }),\n      metadata: {\n        openapi: {\n          summary: \"Get TOTP URI\",\n          description: \"Use this endpoint to get the TOTP URI\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      totpURI: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (options?.disable) {\n        ctx.context.logger.error(\n          \"totp isn't configured. please pass totp option on two factor plugin to enable totp\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"totp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2 || !user.twoFactorEnabled) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TOTP_NOT_ENABLED\n        });\n      }\n      const secret = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricDecrypt)({\n        key: ctx.context.secret,\n        data: twoFactor2.secret\n      });\n      await ctx.context.password.checkPassword(user.id, ctx);\n      const totpURI = (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(secret, {\n        digits: opts.digits,\n        period: opts.period\n      }).url(options?.issuer || ctx.context.appName, user.email);\n      return {\n        totpURI\n      };\n    }\n  );\n  const verifyTOTP = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n    \"/two-factor/verify-totp\",\n    {\n      method: \"POST\",\n      body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        code: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n          description: \"The otp code to verify\"\n        })\n      }),\n      use: [verifyTwoFactorMiddleware],\n      metadata: {\n        openapi: {\n          summary: \"Verify two factor TOTP\",\n          description: \"Verify two factor TOTP\",\n          responses: {\n            200: {\n              description: \"Successful response\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"boolean\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    async (ctx) => {\n      if (options?.disable) {\n        ctx.context.logger.error(\n          \"totp isn't configured. please pass totp option on two factor plugin to enable totp\"\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: \"totp isn't configured\"\n        });\n      }\n      const user = ctx.context.session.user;\n      const twoFactor2 = await ctx.context.adapter.findOne({\n        model: twoFactorTable,\n        where: [\n          {\n            field: \"userId\",\n            value: user.id\n          }\n        ]\n      });\n      if (!twoFactor2) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n          message: _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_0__.TWO_FACTOR_ERROR_CODES.TOTP_NOT_ENABLED\n        });\n      }\n      const decrypted = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricDecrypt)({\n        key: ctx.context.secret,\n        data: twoFactor2.secret\n      });\n      const status = await (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(decrypted, {\n        period: opts.period,\n        digits: opts.digits\n      }).verify(ctx.body.code);\n      if (!status) {\n        return ctx.context.invalid();\n      }\n      if (!user.twoFactorEnabled) {\n        const updatedUser = await ctx.context.internalAdapter.updateUser(\n          user.id,\n          {\n            twoFactorEnabled: true\n          }\n        );\n        const newSession = await ctx.context.internalAdapter.createSession(\n          user.id,\n          ctx.request,\n          false,\n          ctx.context.session.session\n        ).catch((e) => {\n          throw e;\n        });\n        await ctx.context.internalAdapter.deleteSession(\n          ctx.context.session.session.token\n        );\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n          session: newSession,\n          user: updatedUser\n        });\n      }\n      return ctx.context.valid();\n    }\n  );\n  return {\n    id: \"totp\",\n    endpoints: {\n      generateTOTP,\n      getTOTPURI,\n      verifyTOTP\n    }\n  };\n};\n\n// src/plugins/two-factor/schema.ts\nvar schema = {\n  user: {\n    fields: {\n      twoFactorEnabled: {\n        type: \"boolean\",\n        required: false,\n        defaultValue: false,\n        input: false\n      }\n    }\n  },\n  twoFactor: {\n    fields: {\n      secret: {\n        type: \"string\",\n        required: true,\n        returned: false\n      },\n      backupCodes: {\n        type: \"string\",\n        required: true,\n        returned: false\n      },\n      userId: {\n        type: \"string\",\n        required: true,\n        returned: false,\n        references: {\n          model: \"user\",\n          field: \"id\"\n        }\n      }\n    }\n  }\n};\nvar twoFactor = (options) => {\n  const opts = {\n    twoFactorTable: \"twoFactor\"\n  };\n  const totp = totp2fa(options?.totpOptions);\n  const backupCode = backupCode2fa(options?.backupCodeOptions);\n  const otp = otp2fa(options?.otpOptions);\n  return {\n    id: \"two-factor\",\n    endpoints: {\n      ...totp.endpoints,\n      ...otp.endpoints,\n      ...backupCode.endpoints,\n      enableTwoFactor: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/enable\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"User password\"\n            }).min(8)\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              summary: \"Enable two factor authentication\",\n              description: \"Use this endpoint to enable two factor authentication. This will generate a TOTP URI and backup codes. Once the user verifies the TOTP URI, the two factor authentication will be enabled.\",\n              responses: {\n                200: {\n                  description: \"Successful response\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          totpURI: {\n                            type: \"string\",\n                            description: \"TOTP URI\"\n                          },\n                          backupCodes: {\n                            type: \"array\",\n                            items: {\n                              type: \"string\"\n                            },\n                            description: \"Backup codes\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          const { password } = ctx.body;\n          const isPasswordValid = await (0,_chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_1__.validatePassword)(ctx, {\n            password,\n            userId: user.id\n          });\n          if (!isPasswordValid) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.BASE_ERROR_CODES.INVALID_PASSWORD\n            });\n          }\n          const secret = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.generateRandomString)(32);\n          const encryptedSecret = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_5__.symmetricEncrypt)({\n            key: ctx.context.secret,\n            data: secret\n          });\n          const backupCodes = await generateBackupCodes(\n            ctx.context.secret,\n            options?.backupCodeOptions\n          );\n          if (options?.skipVerificationOnEnable) {\n            const updatedUser = await ctx.context.internalAdapter.updateUser(\n              user.id,\n              {\n                twoFactorEnabled: true\n              }\n            );\n            const newSession = await ctx.context.internalAdapter.createSession(\n              updatedUser.id,\n              ctx.request,\n              false,\n              ctx.context.session.session\n            );\n            await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n              session: newSession,\n              user: updatedUser\n            });\n            await ctx.context.internalAdapter.deleteSession(\n              ctx.context.session.session.token\n            );\n          }\n          await ctx.context.adapter.deleteMany({\n            model: opts.twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: user.id\n              }\n            ]\n          });\n          await ctx.context.adapter.create({\n            model: opts.twoFactorTable,\n            data: {\n              secret: encryptedSecret,\n              backupCodes: backupCodes.encryptedBackupCodes,\n              userId: user.id\n            }\n          });\n          const totpURI = (0,_better_auth_utils_otp__WEBPACK_IMPORTED_MODULE_9__.createOTP)(secret, {\n            digits: options?.totpOptions?.digits || 6,\n            period: options?.totpOptions?.period\n          }).url(options?.issuer || ctx.context.appName, user.email);\n          return ctx.json({ totpURI, backupCodes: backupCodes.backupCodes });\n        }\n      ),\n      disableTwoFactor: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthEndpoint)(\n        \"/two-factor/disable\",\n        {\n          method: \"POST\",\n          body: zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n            password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string({\n              description: \"User password\"\n            }).min(8)\n          }),\n          use: [_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.sessionMiddleware],\n          metadata: {\n            openapi: {\n              summary: \"Disable two factor authentication\",\n              description: \"Use this endpoint to disable two factor authentication.\",\n              responses: {\n                200: {\n                  description: \"Successful response\",\n                  content: {\n                    \"application/json\": {\n                      schema: {\n                        type: \"object\",\n                        properties: {\n                          status: {\n                            type: \"boolean\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const user = ctx.context.session.user;\n          const { password } = ctx.body;\n          const isPasswordValid = await (0,_chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_1__.validatePassword)(ctx, {\n            password,\n            userId: user.id\n          });\n          if (!isPasswordValid) {\n            throw new better_call__WEBPACK_IMPORTED_MODULE_7__.APIError(\"BAD_REQUEST\", {\n              message: \"Invalid password\"\n            });\n          }\n          const updatedUser = await ctx.context.internalAdapter.updateUser(\n            user.id,\n            {\n              twoFactorEnabled: false\n            }\n          );\n          await ctx.context.adapter.delete({\n            model: opts.twoFactorTable,\n            where: [\n              {\n                field: \"userId\",\n                value: updatedUser.id\n              }\n            ]\n          });\n          const newSession = await ctx.context.internalAdapter.createSession(\n            updatedUser.id,\n            ctx.request,\n            false,\n            ctx.context.session.session\n          );\n          await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.setSessionCookie)(ctx, {\n            session: newSession,\n            user: updatedUser\n          });\n          await ctx.context.internalAdapter.deleteSession(\n            ctx.context.session.session.token\n          );\n          return ctx.json({ status: true });\n        }\n      )\n    },\n    options,\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return context.path === \"/sign-in/email\" || context.path === \"/sign-in/username\" || context.path === \"/sign-in/phone-number\";\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_2__.createAuthMiddleware)(async (ctx) => {\n            const data = ctx.context.newSession;\n            if (!data) {\n              return;\n            }\n            if (!data?.user.twoFactorEnabled) {\n              return;\n            }\n            const trustDeviceCookieName = ctx.context.createAuthCookie(\n              TRUST_DEVICE_COOKIE_NAME\n            );\n            const trustDeviceCookie = await ctx.getSignedCookie(\n              trustDeviceCookieName.name,\n              ctx.context.secret\n            );\n            if (trustDeviceCookie) {\n              const [token, sessionToken] = trustDeviceCookie.split(\"!\");\n              const expectedToken = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__.createHMAC)(\n                \"SHA-256\",\n                \"base64urlnopad\"\n              ).sign(ctx.context.secret, `${data.user.id}!${sessionToken}`);\n              if (token === expectedToken) {\n                const newToken = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_8__.createHMAC)(\n                  \"SHA-256\",\n                  \"base64urlnopad\"\n                ).sign(ctx.context.secret, `${data.user.id}!${sessionToken}`);\n                await ctx.setSignedCookie(\n                  trustDeviceCookieName.name,\n                  `${newToken}!${data.session.token}`,\n                  ctx.context.secret,\n                  trustDeviceCookieName.attributes\n                );\n                return;\n              }\n            }\n            (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_3__.deleteSessionCookie)(ctx);\n            await ctx.context.internalAdapter.deleteSession(data.session.token);\n            const twoFactorCookie = ctx.context.createAuthCookie(\n              TWO_FACTOR_COOKIE_NAME,\n              {\n                maxAge: 60 * 10\n                // 10 minutes\n              }\n            );\n            await ctx.setSignedCookie(\n              twoFactorCookie.name,\n              data.user.id,\n              ctx.context.secret,\n              twoFactorCookie.attributes\n            );\n            return ctx.json({\n              twoFactorRedirect: true\n            });\n          })\n        }\n      ]\n    },\n    schema: (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_4__.mergeSchema)(schema, options?.schema),\n    rateLimit: [\n      {\n        pathMatcher(path) {\n          return path.startsWith(\"/two-factor/\");\n        },\n        window: 10,\n        max: 3\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVZSVks3Q0ZXLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQTZEO0FBQ047QUFDZ0Y7QUFDM0Q7QUFDMUI7QUFDNkM7QUFDdkU7QUFDZTtBQUNjO0FBQ0Y7O0FBRW5EO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyx3RUFBb0I7QUFDcEQ7QUFDQSxVQUFVLHlDQUFRO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsMENBQVM7QUFDNUIsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLDBCQUEwQixxRUFBaUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixpREFBUTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaURBQVE7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9FQUFnQjtBQUNoQztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsbUVBQVU7QUFDMUM7QUFDQSxpQkFBaUIsUUFBUSxHQUFHLGVBQWU7QUFDM0M7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE1BQU0sR0FBRyxlQUFlO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQSxvQkFBb0IsaURBQVE7QUFDNUI7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQSx1Q0FBdUMsbUVBQVU7QUFDakQ7QUFDQTtBQUNBLDhDQUE4QyxhQUFhLEdBQUcsYUFBYTtBQUMzRTtBQUNBO0FBQ0EscUJBQXFCLFNBQVMsR0FBRyxtQkFBbUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1RUFBbUI7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSwrREFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVlJWSzdDRlcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUyB9IGZyb20gJy4vY2h1bmstV01YQkE2TFguanMnO1xuaW1wb3J0IHsgdmFsaWRhdGVQYXNzd29yZCB9IGZyb20gJy4vY2h1bmstVE9LWkwzWkkuanMnO1xuaW1wb3J0IHsgY3JlYXRlQXV0aE1pZGRsZXdhcmUsIGdldFNlc3Npb25Gcm9tQ3R4LCBjcmVhdGVBdXRoRW5kcG9pbnQsIHNlc3Npb25NaWRkbGV3YXJlLCBCQVNFX0VSUk9SX0NPREVTIH0gZnJvbSAnLi9jaHVuay1YWUtCS082Wi5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llLCBkZWxldGVTZXNzaW9uQ29va2llIH0gZnJvbSAnLi9jaHVuay1RUUdaM1hHSS5qcyc7XG5pbXBvcnQgeyBtZXJnZVNjaGVtYSB9IGZyb20gJy4vY2h1bmstV1o2T0lWSksuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcsIHN5bW1ldHJpY0VuY3J5cHQsIHN5bW1ldHJpY0RlY3J5cHQgfSBmcm9tICcuL2NodW5rLURCUE9aUk1TLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBjcmVhdGVITUFDIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0IHsgY3JlYXRlT1RQIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL290cCc7XG5cbi8vIHNyYy9wbHVnaW5zL3R3by1mYWN0b3IvY29uc3RhbnQudHNcbnZhciBUV09fRkFDVE9SX0NPT0tJRV9OQU1FID0gXCJ0d29fZmFjdG9yXCI7XG52YXIgVFJVU1RfREVWSUNFX0NPT0tJRV9OQU1FID0gXCJ0cnVzdF9kZXZpY2VcIjtcbnZhciB2ZXJpZnlUd29GYWN0b3JNaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoXG4gIHtcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIGlmIHRydWUsIHRoZSBkZXZpY2Ugd2lsbCBiZSB0cnVzdGVkXG4gICAgICAgKiBmb3IgMzAgZGF5cy4gSXQnbGwgYmUgcmVmcmVzaGVkIG9uXG4gICAgICAgKiBldmVyeSBzaWduIGluIHJlcXVlc3Qgd2l0aGluIHRoaXMgdGltZS5cbiAgICAgICAqL1xuICAgICAgdHJ1c3REZXZpY2U6IHouYm9vbGVhbigpLm9wdGlvbmFsKClcbiAgICB9KVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICBjb25zdCBjb29raWVOYW1lID0gY3R4LmNvbnRleHQuY3JlYXRlQXV0aENvb2tpZShUV09fRkFDVE9SX0NPT0tJRV9OQU1FKTtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgIGNvb2tpZU5hbWUubmFtZSxcbiAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICApO1xuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcImludmFsaWQgdHdvIGZhY3RvciBjb29raWVcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUlkKFxuICAgICAgICB1c2VySWRcbiAgICAgICk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcImludmFsaWQgdHdvIGZhY3RvciBjb29raWVcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb24yID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgICBpZiAoIXNlc3Npb24yKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJmYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgIHNlc3Npb246IHNlc3Npb24yLFxuICAgICAgICAgICAgdXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmIChjdHguYm9keS50cnVzdERldmljZSkge1xuICAgICAgICAgICAgY29uc3QgdHJ1c3REZXZpY2VDb29raWUgPSBjdHguY29udGV4dC5jcmVhdGVBdXRoQ29va2llKFxuICAgICAgICAgICAgICBUUlVTVF9ERVZJQ0VfQ09PS0lFX05BTUUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBtYXhBZ2U6IDMwICogMjQgKiA2MCAqIDYwXG4gICAgICAgICAgICAgICAgLy8gMzAgZGF5cywgaXQnbGwgYmUgcmVmcmVzaGVkIG9uIHNpZ24gaW4gcmVxdWVzdHNcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlSE1BQyhcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS5zaWduKFxuICAgICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICAgIGAke3VzZXIuaWR9ISR7c2Vzc2lvbjIudG9rZW59YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICAgIHRydXN0RGV2aWNlQ29va2llLm5hbWUsXG4gICAgICAgICAgICAgIGAke3Rva2VufSEke3Nlc3Npb24yLnRva2VufWAsXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgICAgdHJ1c3REZXZpY2VDb29raWUuYXR0cmlidXRlc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uMi50b2tlbixcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogdXNlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgIHVwZGF0ZWRBdDogdXNlci51cGRhdGVkQXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgaW52YWxpZDogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgICBtZXNzYWdlOiBcImludmFsaWQgdHdvIGZhY3RvciBhdXRoZW50aWNhdGlvblwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICBzZXNzaW9uOiBzZXNzaW9uMixcbiAgICAgICAgICB1c2VyXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB2YWxpZDogYXN5bmMgKCkgPT4ge1xuICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgIHRva2VuOiBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBzZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgIG5hbWU6IHNlc3Npb24udXNlci5uYW1lLFxuICAgICAgICAgICAgaW1hZ2U6IHNlc3Npb24udXNlci5pbWFnZSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogc2Vzc2lvbi51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogc2Vzc2lvbi51c2VyLnVwZGF0ZWRBdFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgaW52YWxpZDogYXN5bmMgKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiaW52YWxpZCB0d28gZmFjdG9yIGF1dGhlbnRpY2F0aW9uXCJcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgc2Vzc2lvblxuICAgIH07XG4gIH1cbik7XG5mdW5jdGlvbiBnZW5lcmF0ZUJhY2t1cENvZGVzRm4ob3B0aW9ucykge1xuICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAgfSkuZmlsbChudWxsKS5tYXAoKCkgPT4gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMTAsIFwiYS16XCIsIFwiMC05XCIsIFwiQS1aXCIpKS5tYXAoKGNvZGUpID0+IGAke2NvZGUuc2xpY2UoMCwgNSl9LSR7Y29kZS5zbGljZSg1KX1gKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQmFja3VwQ29kZXMoc2VjcmV0LCBvcHRpb25zKSB7XG4gIGNvbnN0IGtleSA9IHNlY3JldDtcbiAgY29uc3QgYmFja3VwQ29kZXMgPSBvcHRpb25zPy5jdXN0b21CYWNrdXBDb2Rlc0dlbmVyYXRlID8gb3B0aW9ucy5jdXN0b21CYWNrdXBDb2Rlc0dlbmVyYXRlKCkgOiBnZW5lcmF0ZUJhY2t1cENvZGVzRm4oKTtcbiAgY29uc3QgZW5jQ29kZXMgPSBhd2FpdCBzeW1tZXRyaWNFbmNyeXB0KHtcbiAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShiYWNrdXBDb2RlcyksXG4gICAga2V5XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIGJhY2t1cENvZGVzLFxuICAgIGVuY3J5cHRlZEJhY2t1cENvZGVzOiBlbmNDb2Rlc1xuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QmFja3VwQ29kZShkYXRhLCBrZXkpIHtcbiAgY29uc3QgY29kZXMgPSBhd2FpdCBnZXRCYWNrdXBDb2RlcyhkYXRhLmJhY2t1cENvZGVzLCBrZXkpO1xuICBpZiAoIWNvZGVzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogZmFsc2UsXG4gICAgICB1cGRhdGVkOiBudWxsXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHN0YXR1czogY29kZXMuaW5jbHVkZXMoZGF0YS5jb2RlKSxcbiAgICB1cGRhdGVkOiBjb2Rlcy5maWx0ZXIoKGNvZGUpID0+IGNvZGUgIT09IGRhdGEuY29kZSlcbiAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldEJhY2t1cENvZGVzKGJhY2t1cENvZGVzLCBrZXkpIHtcbiAgY29uc3Qgc2VjcmV0ID0gQnVmZmVyLmZyb20oXG4gICAgYXdhaXQgc3ltbWV0cmljRGVjcnlwdCh7IGtleSwgZGF0YTogYmFja3VwQ29kZXMgfSlcbiAgKS50b1N0cmluZyhcInV0Zi04XCIpO1xuICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShzZWNyZXQpO1xuICBjb25zdCByZXN1bHQgPSB6LmFycmF5KHouc3RyaW5nKCkpLnNhZmVQYXJzZShkYXRhKTtcbiAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgcmV0dXJuIHJlc3VsdC5kYXRhO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxudmFyIGJhY2t1cENvZGUyZmEgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0d29GYWN0b3JUYWJsZSA9IFwidHdvRmFjdG9yXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYmFja3VwX2NvZGVcIixcbiAgICBlbmRwb2ludHM6IHtcbiAgICAgIHZlcmlmeUJhY2t1cENvZGU6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvdHdvLWZhY3Rvci92ZXJpZnktYmFja3VwLWNvZGVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgY29kZTogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRGlzYWJsZSBzZXR0aW5nIHRoZSBzZXNzaW9uIGNvb2tpZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBkaXNhYmxlU2Vzc2lvbjogei5ib29sZWFuKCkub3B0aW9uYWwoKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW3ZlcmlmeVR3b0ZhY3Rvck1pZGRsZXdhcmVdXG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgICAgIGNvbnN0IHR3b0ZhY3RvcjIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IHR3b0ZhY3RvclRhYmxlLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIXR3b0ZhY3RvcjIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5CQUNLVVBfQ09ERVNfTk9UX0VOQUJMRURcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWxpZGF0ZSA9IGF3YWl0IHZlcmlmeUJhY2t1cENvZGUoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJhY2t1cENvZGVzOiB0d29GYWN0b3IyLmJhY2t1cENvZGVzLFxuICAgICAgICAgICAgICBjb2RlOiBjdHguYm9keS5jb2RlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIXZhbGlkYXRlLnN0YXR1cykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5JTlZBTElEX0JBQ0tVUF9DT0RFXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXBkYXRlZEJhY2t1cENvZGVzID0gYXdhaXQgc3ltbWV0cmljRW5jcnlwdCh7XG4gICAgICAgICAgICBrZXk6IGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHZhbGlkYXRlLnVwZGF0ZWQpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci51cGRhdGVNYW55KHtcbiAgICAgICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgICAgICBiYWNrdXBDb2RlczogdXBkYXRlZEJhY2t1cENvZGVzXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIWN0eC5ib2R5LmRpc2FibGVTZXNzaW9uKSB7XG4gICAgICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgICAgICBzZXNzaW9uOiBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24sXG4gICAgICAgICAgICAgIHVzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgIHNlc3Npb246IGN0eC5jb250ZXh0LnNlc3Npb25cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIGdlbmVyYXRlQmFja3VwQ29kZXM6IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICAgICAgXCIvdHdvLWZhY3Rvci9nZW5lcmF0ZS1iYWNrdXAtY29kZXNcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV1cbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXI7XG4gICAgICAgICAgaWYgKCF1c2VyLnR3b0ZhY3RvckVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUy5UV09fRkFDVE9SX05PVF9FTkFCTEVEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuY2hlY2tQYXNzd29yZCh1c2VyLmlkLCBjdHgpO1xuICAgICAgICAgIGNvbnN0IGJhY2t1cENvZGVzID0gYXdhaXQgZ2VuZXJhdGVCYWNrdXBDb2RlcyhcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgICApO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIudXBkYXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgICAgICBiYWNrdXBDb2RlczogYmFja3VwQ29kZXMuZW5jcnlwdGVkQmFja3VwQ29kZXNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgIGJhY2t1cENvZGVzOiBiYWNrdXBDb2Rlcy5iYWNrdXBDb2Rlc1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgdmlld0JhY2t1cENvZGVzOiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgICAgIFwiL3R3by1mYWN0b3Ivdmlldy1iYWNrdXAtY29kZXNcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB1c2VySWQ6IHouc3RyaW5nKClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgU0VSVkVSX09OTFk6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB0d29GYWN0b3IyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3R4LmJvZHkudXNlcklkXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIXR3b0ZhY3RvcjIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJCYWNrdXAgY29kZXMgYXJlbid0IGVuYWJsZWRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGJhY2t1cENvZGVzID0gYXdhaXQgZ2V0QmFja3VwQ29kZXMoXG4gICAgICAgICAgICB0d29GYWN0b3IyLmJhY2t1cENvZGVzLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoIWJhY2t1cENvZGVzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuQkFDS1VQX0NPREVTX05PVF9FTkFCTEVEXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgIGJhY2t1cENvZGVzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9XG4gIH07XG59O1xudmFyIG90cDJmYSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBkaWdpdHM6IG9wdGlvbnM/LmRpZ2l0cyB8fCA2LFxuICAgIHBlcmlvZDogKG9wdGlvbnM/LnBlcmlvZCB8fCAzKSAqIDYwICogMWUzXG4gIH07XG4gIGNvbnN0IHR3b0ZhY3RvclRhYmxlID0gXCJ0d29GYWN0b3JcIjtcbiAgY29uc3Qgc2VuZDJGYU9UUCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICBcIi90d28tZmFjdG9yL3NlbmQtb3RwXCIsXG4gICAge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIHVzZTogW3ZlcmlmeVR3b0ZhY3Rvck1pZGRsZXdhcmVdLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgIHN1bW1hcnk6IFwiU2VuZCB0d28gZmFjdG9yIE9UUFwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlbmQgdHdvIGZhY3RvciBPVFAgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzZnVsIHJlc3BvbnNlXCIsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMuc2VuZE9UUCkge1xuICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJzZW5kIG90cCBpc24ndCBjb25maWd1cmVkLiBQbGVhc2UgY29uZmlndXJlIHRoZSBzZW5kIG90cCBmdW5jdGlvbiBvbiBvdHAgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJvdHAgaXNuJ3QgY29uZmlndXJlZFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGN0eC5jb250ZXh0LnNlc3Npb24udXNlcjtcbiAgICAgIGNvbnN0IHR3b0ZhY3RvcjIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogdHdvRmFjdG9yVGFibGUsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlci5pZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXR3b0ZhY3RvcjIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuT1RQX05PVF9FTkFCTEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgY29kZSA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKG9wdHMuZGlnaXRzLCBcIjAtOVwiKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZSh7XG4gICAgICAgIHZhbHVlOiBjb2RlLFxuICAgICAgICBpZGVudGlmaWVyOiBgMmZhLW90cC0ke3VzZXIuaWR9YCxcbiAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgb3B0cy5wZXJpb2QpXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IG9wdGlvbnMuc2VuZE9UUCh7IHVzZXIsIG90cDogY29kZSB9LCBjdHgucmVxdWVzdCk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oeyBzdGF0dXM6IHRydWUgfSk7XG4gICAgfVxuICApO1xuICBjb25zdCB2ZXJpZnlPVFAgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gICAgXCIvdHdvLWZhY3Rvci92ZXJpZnktb3RwXCIsXG4gICAge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgY29kZTogei5zdHJpbmcoe1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvdHAgY29kZSB0byB2ZXJpZnlcIlxuICAgICAgICB9KVxuICAgICAgfSksXG4gICAgICB1c2U6IFt2ZXJpZnlUd29GYWN0b3JNaWRkbGV3YXJlXSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICBzdW1tYXJ5OiBcIlZlcmlmeSB0d28gZmFjdG9yIE9UUFwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmeSB0d28gZmFjdG9yIE9UUFwiLFxuICAgICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgICAgMjAwOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXI7XG4gICAgICBjb25zdCB0d29GYWN0b3IyID0gYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IHR3b0ZhY3RvclRhYmxlLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCF0d29GYWN0b3IyKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBUV09fRkFDVE9SX0VSUk9SX0NPREVTLk9UUF9OT1RfRU5BQkxFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHRvQ2hlY2tPdHAgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAgICBgMmZhLW90cC0ke3VzZXIuaWR9YFxuICAgICAgKTtcbiAgICAgIGlmICghdG9DaGVja090cCB8fCB0b0NoZWNrT3RwLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBUV09fRkFDVE9SX0VSUk9SX0NPREVTLk9UUF9IQVNfRVhQSVJFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh0b0NoZWNrT3RwLnZhbHVlID09PSBjdHguYm9keS5jb2RlKSB7XG4gICAgICAgIGlmICghdXNlci50d29GYWN0b3JFbmFibGVkKSB7XG4gICAgICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR3b0ZhY3RvckVuYWJsZWQ6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgICBjdHgucmVxdWVzdCxcbiAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi50b2tlblxuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgIHNlc3Npb246IG5ld1Nlc3Npb24sXG4gICAgICAgICAgICB1c2VyOiB1cGRhdGVkVXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdHguY29udGV4dC52YWxpZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGN0eC5jb250ZXh0LmludmFsaWQoKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwib3RwXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBzZW5kVHdvRmFjdG9yT1RQOiBzZW5kMkZhT1RQLFxuICAgICAgdmVyaWZ5VHdvRmFjdG9yT1RQOiB2ZXJpZnlPVFBcbiAgICB9XG4gIH07XG59O1xudmFyIHRvdHAyZmEgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBvcHRzID0ge1xuICAgIC4uLm9wdGlvbnMsXG4gICAgZGlnaXRzOiBvcHRpb25zPy5kaWdpdHMgfHwgNixcbiAgICBwZXJpb2Q6IG9wdGlvbnM/LnBlcmlvZCB8fCAzMFxuICB9O1xuICBjb25zdCB0d29GYWN0b3JUYWJsZSA9IFwidHdvRmFjdG9yXCI7XG4gIGNvbnN0IGdlbmVyYXRlVE9UUCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICBcIi90b3RwL2dlbmVyYXRlXCIsXG4gICAge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICBzdW1tYXJ5OiBcIkdlbmVyYXRlIFRPVFAgY29kZVwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZSB0aGlzIGVuZHBvaW50IHRvIGdlbmVyYXRlIGEgVE9UUCBjb2RlXCIsXG4gICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc2Z1bCByZXNwb25zZVwiLFxuICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29kZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgaWYgKG9wdGlvbnM/LmRpc2FibGUpIHtcbiAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwidG90cCBpc24ndCBjb25maWd1cmVkLiBwbGVhc2UgcGFzcyB0b3RwIG9wdGlvbiBvbiB0d28gZmFjdG9yIHBsdWdpbiB0byBlbmFibGUgdG90cFwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcInRvdHAgaXNuJ3QgY29uZmlndXJlZFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGN0eC5jb250ZXh0LnNlc3Npb24udXNlcjtcbiAgICAgIGNvbnN0IHR3b0ZhY3RvcjIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogdHdvRmFjdG9yVGFibGUsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlci5pZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXR3b0ZhY3RvcjIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuVE9UUF9OT1RfRU5BQkxFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvZGUgPSBhd2FpdCBjcmVhdGVPVFAodHdvRmFjdG9yMi5zZWNyZXQsIHtcbiAgICAgICAgcGVyaW9kOiBvcHRzLnBlcmlvZCxcbiAgICAgICAgZGlnaXRzOiBvcHRzLmRpZ2l0c1xuICAgICAgfSkudG90cCgpO1xuICAgICAgcmV0dXJuIHsgY29kZSB9O1xuICAgIH1cbiAgKTtcbiAgY29uc3QgZ2V0VE9UUFVSSSA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICBcIi90d28tZmFjdG9yL2dldC10b3RwLXVyaVwiLFxuICAgIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBwYXNzd29yZFwiXG4gICAgICAgIH0pXG4gICAgICB9KSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICBzdW1tYXJ5OiBcIkdldCBUT1RQIFVSSVwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZSB0aGlzIGVuZHBvaW50IHRvIGdldCB0aGUgVE9UUCBVUklcIixcbiAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzZnVsIHJlc3BvbnNlXCIsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0b3RwVVJJOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyAoY3R4KSA9PiB7XG4gICAgICBpZiAob3B0aW9ucz8uZGlzYWJsZSkge1xuICAgICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJ0b3RwIGlzbid0IGNvbmZpZ3VyZWQuIHBsZWFzZSBwYXNzIHRvdHAgb3B0aW9uIG9uIHR3byBmYWN0b3IgcGx1Z2luIHRvIGVuYWJsZSB0b3RwXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwidG90cCBpc24ndCBjb25maWd1cmVkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgY29uc3QgdHdvRmFjdG9yMiA9IGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiB0d29GYWN0b3JUYWJsZSxcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VyLmlkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdHdvRmFjdG9yMiB8fCAhdXNlci50d29GYWN0b3JFbmFibGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBUV09fRkFDVE9SX0VSUk9SX0NPREVTLlRPVFBfTk9UX0VOQUJMRURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCBzZWNyZXQgPSBhd2FpdCBzeW1tZXRyaWNEZWNyeXB0KHtcbiAgICAgICAga2V5OiBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgIGRhdGE6IHR3b0ZhY3RvcjIuc2VjcmV0XG4gICAgICB9KTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNoZWNrUGFzc3dvcmQodXNlci5pZCwgY3R4KTtcbiAgICAgIGNvbnN0IHRvdHBVUkkgPSBjcmVhdGVPVFAoc2VjcmV0LCB7XG4gICAgICAgIGRpZ2l0czogb3B0cy5kaWdpdHMsXG4gICAgICAgIHBlcmlvZDogb3B0cy5wZXJpb2RcbiAgICAgIH0pLnVybChvcHRpb25zPy5pc3N1ZXIgfHwgY3R4LmNvbnRleHQuYXBwTmFtZSwgdXNlci5lbWFpbCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RwVVJJXG4gICAgICB9O1xuICAgIH1cbiAgKTtcbiAgY29uc3QgdmVyaWZ5VE9UUCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgICBcIi90d28tZmFjdG9yL3ZlcmlmeS10b3RwXCIsXG4gICAge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgICAgY29kZTogei5zdHJpbmcoe1xuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBvdHAgY29kZSB0byB2ZXJpZnlcIlxuICAgICAgICB9KVxuICAgICAgfSksXG4gICAgICB1c2U6IFt2ZXJpZnlUd29GYWN0b3JNaWRkbGV3YXJlXSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICBzdW1tYXJ5OiBcIlZlcmlmeSB0d28gZmFjdG9yIFRPVFBcIixcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJWZXJpZnkgdHdvIGZhY3RvciBUT1RQXCIsXG4gICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc2Z1bCByZXNwb25zZVwiLFxuICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgaWYgKG9wdGlvbnM/LmRpc2FibGUpIHtcbiAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwidG90cCBpc24ndCBjb25maWd1cmVkLiBwbGVhc2UgcGFzcyB0b3RwIG9wdGlvbiBvbiB0d28gZmFjdG9yIHBsdWdpbiB0byBlbmFibGUgdG90cFwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBcInRvdHAgaXNuJ3QgY29uZmlndXJlZFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGN0eC5jb250ZXh0LnNlc3Npb24udXNlcjtcbiAgICAgIGNvbnN0IHR3b0ZhY3RvcjIgPSBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogdHdvRmFjdG9yVGFibGUsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlci5pZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXR3b0ZhY3RvcjIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFRXT19GQUNUT1JfRVJST1JfQ09ERVMuVE9UUF9OT1RfRU5BQkxFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRlY3J5cHRlZCA9IGF3YWl0IHN5bW1ldHJpY0RlY3J5cHQoe1xuICAgICAgICBrZXk6IGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgZGF0YTogdHdvRmFjdG9yMi5zZWNyZXRcbiAgICAgIH0pO1xuICAgICAgY29uc3Qgc3RhdHVzID0gYXdhaXQgY3JlYXRlT1RQKGRlY3J5cHRlZCwge1xuICAgICAgICBwZXJpb2Q6IG9wdHMucGVyaW9kLFxuICAgICAgICBkaWdpdHM6IG9wdHMuZGlnaXRzXG4gICAgICB9KS52ZXJpZnkoY3R4LmJvZHkuY29kZSk7XG4gICAgICBpZiAoIXN0YXR1cykge1xuICAgICAgICByZXR1cm4gY3R4LmNvbnRleHQuaW52YWxpZCgpO1xuICAgICAgfVxuICAgICAgaWYgKCF1c2VyLnR3b0ZhY3RvckVuYWJsZWQpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICB1c2VyLmlkLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR3b0ZhY3RvckVuYWJsZWQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICB1c2VyLmlkLFxuICAgICAgICAgIGN0eC5yZXF1ZXN0LFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvblxuICAgICAgICApLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvbi50b2tlblxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgIHNlc3Npb246IG5ld1Nlc3Npb24sXG4gICAgICAgICAgdXNlcjogdXBkYXRlZFVzZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY3R4LmNvbnRleHQudmFsaWQoKTtcbiAgICB9XG4gICk7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidG90cFwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgZ2VuZXJhdGVUT1RQLFxuICAgICAgZ2V0VE9UUFVSSSxcbiAgICAgIHZlcmlmeVRPVFBcbiAgICB9XG4gIH07XG59O1xuXG4vLyBzcmMvcGx1Z2lucy90d28tZmFjdG9yL3NjaGVtYS50c1xudmFyIHNjaGVtYSA9IHtcbiAgdXNlcjoge1xuICAgIGZpZWxkczoge1xuICAgICAgdHdvRmFjdG9yRW5hYmxlZDoge1xuICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGZhbHNlLFxuICAgICAgICBpbnB1dDogZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHR3b0ZhY3Rvcjoge1xuICAgIGZpZWxkczoge1xuICAgICAgc2VjcmV0OiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICByZXR1cm5lZDogZmFsc2VcbiAgICAgIH0sXG4gICAgICBiYWNrdXBDb2Rlczoge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgcmV0dXJuZWQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgdXNlcklkOiB7XG4gICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICByZXR1cm5lZDogZmFsc2UsXG4gICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgZmllbGQ6IFwiaWRcIlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xudmFyIHR3b0ZhY3RvciA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSB7XG4gICAgdHdvRmFjdG9yVGFibGU6IFwidHdvRmFjdG9yXCJcbiAgfTtcbiAgY29uc3QgdG90cCA9IHRvdHAyZmEob3B0aW9ucz8udG90cE9wdGlvbnMpO1xuICBjb25zdCBiYWNrdXBDb2RlID0gYmFja3VwQ29kZTJmYShvcHRpb25zPy5iYWNrdXBDb2RlT3B0aW9ucyk7XG4gIGNvbnN0IG90cCA9IG90cDJmYShvcHRpb25zPy5vdHBPcHRpb25zKTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ0d28tZmFjdG9yXCIsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICAuLi50b3RwLmVuZHBvaW50cyxcbiAgICAgIC4uLm90cC5lbmRwb2ludHMsXG4gICAgICAuLi5iYWNrdXBDb2RlLmVuZHBvaW50cyxcbiAgICAgIGVuYWJsZVR3b0ZhY3RvcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi90d28tZmFjdG9yL2VuYWJsZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBwYXNzd29yZDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHBhc3N3b3JkXCJcbiAgICAgICAgICAgIH0pLm1pbig4KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgb3BlbmFwaToge1xuICAgICAgICAgICAgICBzdW1tYXJ5OiBcIkVuYWJsZSB0d28gZmFjdG9yIGF1dGhlbnRpY2F0aW9uXCIsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZSB0aGlzIGVuZHBvaW50IHRvIGVuYWJsZSB0d28gZmFjdG9yIGF1dGhlbnRpY2F0aW9uLiBUaGlzIHdpbGwgZ2VuZXJhdGUgYSBUT1RQIFVSSSBhbmQgYmFja3VwIGNvZGVzLiBPbmNlIHRoZSB1c2VyIHZlcmlmaWVzIHRoZSBUT1RQIFVSSSwgdGhlIHR3byBmYWN0b3IgYXV0aGVudGljYXRpb24gd2lsbCBiZSBlbmFibGVkLlwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NmdWwgcmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRvdHBVUkk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRPVFAgVVJJXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja3VwQ29kZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkJhY2t1cCBjb2Rlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgICAgIGNvbnN0IHsgcGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgICAgICAgIGNvbnN0IGlzUGFzc3dvcmRWYWxpZCA9IGF3YWl0IHZhbGlkYXRlUGFzc3dvcmQoY3R4LCB7XG4gICAgICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghaXNQYXNzd29yZFZhbGlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9QQVNTV09SRFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHNlY3JldCA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyKTtcbiAgICAgICAgICBjb25zdCBlbmNyeXB0ZWRTZWNyZXQgPSBhd2FpdCBzeW1tZXRyaWNFbmNyeXB0KHtcbiAgICAgICAgICAgIGtleTogY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgZGF0YTogc2VjcmV0XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgYmFja3VwQ29kZXMgPSBhd2FpdCBnZW5lcmF0ZUJhY2t1cENvZGVzKFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgb3B0aW9ucz8uYmFja3VwQ29kZU9wdGlvbnNcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChvcHRpb25zPy5za2lwVmVyaWZpY2F0aW9uT25FbmFibGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXIoXG4gICAgICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0d29GYWN0b3JFbmFibGVkOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBuZXdTZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgICAgICAgIHVwZGF0ZWRVc2VyLmlkLFxuICAgICAgICAgICAgICBjdHgucmVxdWVzdCxcbiAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvblxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgICAgICAgIHNlc3Npb246IG5ld1Nlc3Npb24sXG4gICAgICAgICAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKFxuICAgICAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24udG9rZW5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmFkYXB0ZXIuZGVsZXRlTWFueSh7XG4gICAgICAgICAgICBtb2RlbDogb3B0cy50d29GYWN0b3JUYWJsZSxcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogdXNlci5pZFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuYWRhcHRlci5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kZWw6IG9wdHMudHdvRmFjdG9yVGFibGUsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIHNlY3JldDogZW5jcnlwdGVkU2VjcmV0LFxuICAgICAgICAgICAgICBiYWNrdXBDb2RlczogYmFja3VwQ29kZXMuZW5jcnlwdGVkQmFja3VwQ29kZXMsXG4gICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IHRvdHBVUkkgPSBjcmVhdGVPVFAoc2VjcmV0LCB7XG4gICAgICAgICAgICBkaWdpdHM6IG9wdGlvbnM/LnRvdHBPcHRpb25zPy5kaWdpdHMgfHwgNixcbiAgICAgICAgICAgIHBlcmlvZDogb3B0aW9ucz8udG90cE9wdGlvbnM/LnBlcmlvZFxuICAgICAgICAgIH0pLnVybChvcHRpb25zPy5pc3N1ZXIgfHwgY3R4LmNvbnRleHQuYXBwTmFtZSwgdXNlci5lbWFpbCk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHsgdG90cFVSSSwgYmFja3VwQ29kZXM6IGJhY2t1cENvZGVzLmJhY2t1cENvZGVzIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgZGlzYWJsZVR3b0ZhY3RvcjogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi90d28tZmFjdG9yL2Rpc2FibGVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBwYXNzd29yZFwiXG4gICAgICAgICAgICB9KS5taW4oOClcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgICAgICAgc3VtbWFyeTogXCJEaXNhYmxlIHR3byBmYWN0b3IgYXV0aGVudGljYXRpb25cIixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlIHRoaXMgZW5kcG9pbnQgdG8gZGlzYWJsZSB0d28gZmFjdG9yIGF1dGhlbnRpY2F0aW9uLlwiLFxuICAgICAgICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NmdWwgcmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyO1xuICAgICAgICAgIGNvbnN0IHsgcGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgICAgICAgIGNvbnN0IGlzUGFzc3dvcmRWYWxpZCA9IGF3YWl0IHZhbGlkYXRlUGFzc3dvcmQoY3R4LCB7XG4gICAgICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICghaXNQYXNzd29yZFZhbGlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBwYXNzd29yZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihcbiAgICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR3b0ZhY3RvckVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCBjdHguY29udGV4dC5hZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgICAgICBtb2RlbDogb3B0cy50d29GYWN0b3JUYWJsZSxcbiAgICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogdXBkYXRlZFVzZXIuaWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICAgIHVwZGF0ZWRVc2VyLmlkLFxuICAgICAgICAgICAgY3R4LnJlcXVlc3QsXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24uc2Vzc2lvblxuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgICAgIHNlc3Npb246IG5ld1Nlc3Npb24sXG4gICAgICAgICAgICB1c2VyOiB1cGRhdGVkVXNlclxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKFxuICAgICAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24oeyBzdGF0dXM6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIG9wdGlvbnMsXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LnBhdGggPT09IFwiL3NpZ24taW4vZW1haWxcIiB8fCBjb250ZXh0LnBhdGggPT09IFwiL3NpZ24taW4vdXNlcm5hbWVcIiB8fCBjb250ZXh0LnBhdGggPT09IFwiL3NpZ24taW4vcGhvbmUtbnVtYmVyXCI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBoYW5kbGVyOiBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gY3R4LmNvbnRleHQubmV3U2Vzc2lvbjtcbiAgICAgICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRhdGE/LnVzZXIudHdvRmFjdG9yRW5hYmxlZCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0cnVzdERldmljZUNvb2tpZU5hbWUgPSBjdHguY29udGV4dC5jcmVhdGVBdXRoQ29va2llKFxuICAgICAgICAgICAgICBUUlVTVF9ERVZJQ0VfQ09PS0lFX05BTUVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCB0cnVzdERldmljZUNvb2tpZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICAgIHRydXN0RGV2aWNlQ29va2llTmFtZS5uYW1lLFxuICAgICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAodHJ1c3REZXZpY2VDb29raWUpIHtcbiAgICAgICAgICAgICAgY29uc3QgW3Rva2VuLCBzZXNzaW9uVG9rZW5dID0gdHJ1c3REZXZpY2VDb29raWUuc3BsaXQoXCIhXCIpO1xuICAgICAgICAgICAgICBjb25zdCBleHBlY3RlZFRva2VuID0gYXdhaXQgY3JlYXRlSE1BQyhcbiAgICAgICAgICAgICAgICBcIlNIQS0yNTZcIixcbiAgICAgICAgICAgICAgICBcImJhc2U2NHVybG5vcGFkXCJcbiAgICAgICAgICAgICAgKS5zaWduKGN0eC5jb250ZXh0LnNlY3JldCwgYCR7ZGF0YS51c2VyLmlkfSEke3Nlc3Npb25Ub2tlbn1gKTtcbiAgICAgICAgICAgICAgaWYgKHRva2VuID09PSBleHBlY3RlZFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VG9rZW4gPSBhd2FpdCBjcmVhdGVITUFDKFxuICAgICAgICAgICAgICAgICAgXCJTSEEtMjU2XCIsXG4gICAgICAgICAgICAgICAgICBcImJhc2U2NHVybG5vcGFkXCJcbiAgICAgICAgICAgICAgICApLnNpZ24oY3R4LmNvbnRleHQuc2VjcmV0LCBgJHtkYXRhLnVzZXIuaWR9ISR7c2Vzc2lvblRva2VufWApO1xuICAgICAgICAgICAgICAgIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgICAgICAgICAgICAgICB0cnVzdERldmljZUNvb2tpZU5hbWUubmFtZSxcbiAgICAgICAgICAgICAgICAgIGAke25ld1Rva2VufSEke2RhdGEuc2Vzc2lvbi50b2tlbn1gLFxuICAgICAgICAgICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgICAgICAgICAgdHJ1c3REZXZpY2VDb29raWVOYW1lLmF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oZGF0YS5zZXNzaW9uLnRva2VuKTtcbiAgICAgICAgICAgIGNvbnN0IHR3b0ZhY3RvckNvb2tpZSA9IGN0eC5jb250ZXh0LmNyZWF0ZUF1dGhDb29raWUoXG4gICAgICAgICAgICAgIFRXT19GQUNUT1JfQ09PS0lFX05BTUUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBtYXhBZ2U6IDYwICogMTBcbiAgICAgICAgICAgICAgICAvLyAxMCBtaW51dGVzXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgICAgICAgICAgICB0d29GYWN0b3JDb29raWUubmFtZSxcbiAgICAgICAgICAgICAgZGF0YS51c2VyLmlkLFxuICAgICAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICAgIHR3b0ZhY3RvckNvb2tpZS5hdHRyaWJ1dGVzXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICAgICAgdHdvRmFjdG9yUmVkaXJlY3Q6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9LFxuICAgIHNjaGVtYTogbWVyZ2VTY2hlbWEoc2NoZW1hLCBvcHRpb25zPy5zY2hlbWEpLFxuICAgIHJhdGVMaW1pdDogW1xuICAgICAge1xuICAgICAgICBwYXRoTWF0Y2hlcihwYXRoKSB7XG4gICAgICAgICAgcmV0dXJuIHBhdGguc3RhcnRzV2l0aChcIi90d28tZmFjdG9yL1wiKTtcbiAgICAgICAgfSxcbiAgICAgICAgd2luZG93OiAxMCxcbiAgICAgICAgbWF4OiAzXG4gICAgICB9XG4gICAgXVxuICB9O1xufTtcblxuZXhwb3J0IHsgdHdvRmFjdG9yIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SocialProviderListEnum: () => (/* binding */ SocialProviderListEnum),\n/* harmony export */   apple: () => (/* binding */ apple),\n/* harmony export */   discord: () => (/* binding */ discord),\n/* harmony export */   dropbox: () => (/* binding */ dropbox),\n/* harmony export */   facebook: () => (/* binding */ facebook),\n/* harmony export */   getApplePublicKey: () => (/* binding */ getApplePublicKey),\n/* harmony export */   github: () => (/* binding */ github),\n/* harmony export */   gitlab: () => (/* binding */ gitlab),\n/* harmony export */   google: () => (/* binding */ google),\n/* harmony export */   linkedin: () => (/* binding */ linkedin),\n/* harmony export */   microsoft: () => (/* binding */ microsoft),\n/* harmony export */   reddit: () => (/* binding */ reddit),\n/* harmony export */   socialProviderList: () => (/* binding */ socialProviderList),\n/* harmony export */   socialProviders: () => (/* binding */ socialProviders),\n/* harmony export */   spotify: () => (/* binding */ spotify),\n/* harmony export */   twitch: () => (/* binding */ twitch),\n/* harmony export */   twitter: () => (/* binding */ twitter)\n/* harmony export */ });\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/decode_protected_header.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/decode_jwt.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwks/remote.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\nvar apple = (options) => {\n  const tokenEndpoint = \"https://appleid.apple.com/auth/token\";\n  return {\n    id: \"apple\",\n    name: \"Apple\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scope = scopes || [\"email\", \"name\"];\n      options.scope && _scope.push(...options.scope);\n      return new URL(\n        `https://appleid.apple.com/auth/authorize?client_id=${options.clientId}&response_type=code&redirect_uri=${options.redirectURI || redirectURI}&scope=${_scope.join(\" \")}&state=${state}&response_mode=form_post`\n      );\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_6__.decodeProtectedHeader)(token);\n      const { kid, alg: jwtAlg } = decodedHeader;\n      if (!kid || !jwtAlg) return false;\n      const publicKey = await getApplePublicKey(kid);\n      const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_7__.jwtVerify)(token, publicKey, {\n        algorithms: [jwtAlg],\n        issuer: \"https://appleid.apple.com\",\n        audience: options.appBundleIdentifier || options.clientId,\n        maxTokenAge: \"1h\"\n      });\n      [\"email_verified\", \"is_private_email\"].forEach((field) => {\n        if (jwtClaims[field] !== void 0) {\n          jwtClaims[field] = Boolean(jwtClaims[field]);\n        }\n      });\n      if (nonce && jwtClaims.nonce !== nonce) {\n        return false;\n      }\n      return !!jwtClaims;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n      if (!profile) {\n        return null;\n      }\n      const name = profile.user ? `${profile.user.name.firstName} ${profile.user.name.lastName}` : profile.email;\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name,\n          emailVerified: false,\n          email: profile.email,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar getApplePublicKey = async (kid) => {\n  const APPLE_BASE_URL = \"https://appleid.apple.com\";\n  const JWKS_APPLE_URI = \"/auth/keys\";\n  const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(`${APPLE_BASE_URL}${JWKS_APPLE_URI}`);\n  if (!data?.keys) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_4__.APIError(\"BAD_REQUEST\", {\n      message: \"Keys not found\"\n    });\n  }\n  const jwk = data.keys.find((key) => key.kid === kid);\n  if (!jwk) {\n    throw new Error(`JWK with kid ${kid} not found`);\n  }\n  return await (0,jose__WEBPACK_IMPORTED_MODULE_9__.importJWK)(jwk, jwk.alg);\n};\nvar discord = (options) => {\n  return {\n    id: \"discord\",\n    name: \"Discord\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"identify\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      return new URL(\n        `https://discord.com/api/oauth2/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"none\"}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://discord.com/api/users/@me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (profile.avatar === null) {\n        const defaultAvatarNumber = profile.discriminator === \"0\" ? Number(BigInt(profile.id) >> BigInt(22)) % 6 : parseInt(profile.discriminator) % 5;\n        profile.image_url = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarNumber}.png`;\n      } else {\n        const format = profile.avatar.startsWith(\"a_\") ? \"gif\" : \"png\";\n        profile.image_url = `https://cdn.discordapp.com/avatars/${profile.id}/${profile.avatar}.${format}`;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name || profile.username || \"\",\n          email: profile.email,\n          emailVerified: profile.verified,\n          image: profile.image_url,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar facebook = (options) => {\n  return {\n    id: \"facebook\",\n    name: \"Facebook\",\n    async createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"email\", \"public_profile\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"facebook\",\n        options,\n        authorizationEndpoint: \"https://www.facebook.com/v21.0/dialog/oauth\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://graph.facebook.com/oauth/access_token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      if (token.split(\".\").length) {\n        try {\n          const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_7__.jwtVerify)(\n            token,\n            (0,jose__WEBPACK_IMPORTED_MODULE_10__.createRemoteJWKSet)(\n              new URL(\"https://www.facebook.com/.well-known/oauth/openid/jwks\")\n            ),\n            {\n              algorithms: [\"RS256\"],\n              audience: options.clientId,\n              issuer: \"https://www.facebook.com\"\n            }\n          );\n          if (nonce && jwtClaims.nonce !== nonce) {\n            return false;\n          }\n          return !!jwtClaims;\n        } catch (error) {\n          return false;\n        }\n      }\n      return true;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken) {\n        const profile2 = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n        const user = {\n          id: profile2.sub,\n          name: profile2.name,\n          email: profile2.email,\n          picture: {\n            data: {\n              url: profile2.picture,\n              height: 100,\n              width: 100,\n              is_silhouette: false\n            }\n          }\n        };\n        const userMap2 = await options.mapProfileToUser?.({\n          ...user,\n          email_verified: true\n        });\n        return {\n          user: {\n            ...user,\n            emailVerified: true,\n            ...userMap2\n          },\n          data: profile2\n        };\n      }\n      const fields = [\n        \"id\",\n        \"name\",\n        \"email\",\n        \"picture\",\n        ...options?.fields || []\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://graph.facebook.com/me?fields=\" + fields.join(\",\"),\n        {\n          auth: {\n            type: \"Bearer\",\n            token: token.accessToken\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.picture.data.url,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar github = (options) => {\n  const tokenEndpoint = \"https://github.com/login/oauth/access_token\";\n  return {\n    id: \"github\",\n    name: \"GitHub\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = scopes || [\"read:user\", \"user:email\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"github\",\n        options,\n        authorizationEndpoint: \"https://github.com/login/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.github.com/user\",\n        {\n          headers: {\n            \"User-Agent\": \"better-auth\",\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      let emailVerified = false;\n      if (!profile.email) {\n        const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\"https://api.github.com/user/emails\", {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        });\n        if (data) {\n          profile.email = (data.find((e) => e.primary) ?? data[0])?.email;\n          emailVerified = data.find((e) => e.email === profile.email)?.verified ?? false;\n        }\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id.toString(),\n          name: profile.name || profile.login,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar google = (options) => {\n  return {\n    id: \"google\",\n    name: \"Google\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.error(\n          \"Client Id and Client Secret is required for Google. Make sure to provide them in the options.\"\n        );\n        throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_2__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_2__.BetterAuthError(\"codeVerifier is required for Google\");\n      }\n      const _scopes = scopes || [\"email\", \"profile\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      const url = await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"google\",\n        options,\n        authorizationEndpoint: \"https://accounts.google.com/o/oauth2/auth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n      options.accessType && url.searchParams.set(\"access_type\", options.accessType);\n      options.prompt && url.searchParams.set(\"prompt\", options.prompt);\n      options.display && url.searchParams.set(\"display\", options.display);\n      options.hd && url.searchParams.set(\"hd\", options.hd);\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://oauth2.googleapis.com/token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const googlePublicKeyUrl = `https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${token}`;\n      const { data: tokenInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(googlePublicKeyUrl);\n      if (!tokenInfo) {\n        return false;\n      }\n      const isValid = tokenInfo.aud === options.clientId && (tokenInfo.iss === \"https://accounts.google.com\" || tokenInfo.iss === \"accounts.google.com\");\n      return isValid;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: user.email_verified,\n          ...userMap\n        },\n        data: user\n      };\n    }\n  };\n};\nvar microsoft = (options) => {\n  const tenant = options.tenantId || \"common\";\n  const authorizationEndpoint = `https://login.microsoftonline.com/${tenant}/oauth2/v2.0/authorize`;\n  const tokenEndpoint = `https://login.microsoftonline.com/${tenant}/oauth2/v2.0/token`;\n  return {\n    id: \"microsoft\",\n    name: \"Microsoft EntraID\",\n    createAuthorizationURL(data) {\n      const scopes = data.scopes || [\"openid\", \"profile\", \"email\", \"User.Read\"];\n      options.scope && scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"microsoft\",\n        options,\n        authorizationEndpoint,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        scopes,\n        redirectURI: data.redirectURI,\n        prompt: options.requireSelectAccount || false\n      });\n    },\n    validateAuthorizationCode({ code, codeVerifier, redirectURI }) {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(token.idToken);\n      const profilePhotoSize = options.profilePhotoSize || 48;\n      await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        `https://graph.microsoft.com/v1.0/me/photos/${profilePhotoSize}x${profilePhotoSize}/$value`,\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          async onResponse(context) {\n            if (options.disableProfilePhoto || !context.response.ok) {\n              return;\n            }\n            try {\n              const response = context.response.clone();\n              const pictureBuffer = await response.arrayBuffer();\n              const pictureBase64 = Buffer.from(pictureBuffer).toString(\"base64\");\n              user.picture = `data:image/jpeg;base64, ${pictureBase64}`;\n            } catch (e) {\n              _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.error(\n                e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n                e\n              );\n            }\n          }\n        }\n      );\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: user\n      };\n    }\n  };\n};\nvar spotify = (options) => {\n  return {\n    id: \"spotify\",\n    name: \"Spotify\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = scopes || [\"user-read-email\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"spotify\",\n        options,\n        authorizationEndpoint: \"https://accounts.spotify.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.spotify.com/v1/me\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          email: profile.email,\n          image: profile.images[0]?.url,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar twitch = (options) => {\n  return {\n    id: \"twitch\",\n    name: \"Twitch\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"user:read:email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"twitch\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.twitch.tv/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        claims: options.claims || [\n          \"email\",\n          \"email_verified\",\n          \"preferred_username\",\n          \"picture\"\n        ]\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const idToken = token.idToken;\n      if (!idToken) {\n        _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"No idToken found in token\");\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_8__.decodeJwt)(idToken);\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar twitter = (options) => {\n  return {\n    id: \"twitter\",\n    name: \"Twitter\",\n    createAuthorizationURL(data) {\n      const _scopes = data.scopes || [\n        \"users.read\",\n        \"tweet.read\",\n        \"offline.access\"\n      ];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"twitter\",\n        options,\n        authorizationEndpoint: \"https://x.com/i/oauth2/authorize\",\n        scopes: _scopes,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        redirectURI: data.redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        authentication: \"basic\",\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.x.com/2/users/me?user.fields=profile_image_url\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.data.id,\n          name: profile.data.name,\n          email: profile.data.username || null,\n          image: profile.data.profile_image_url,\n          emailVerified: profile.data.verified || false,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar dropbox = (options) => {\n  const tokenEndpoint = \"https://api.dropboxapi.com/oauth2/token\";\n  return {\n    id: \"dropbox\",\n    name: \"Dropbox\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = scopes || [\"account_info.read\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"dropbox\",\n        options,\n        authorizationEndpoint: \"https://www.dropbox.com/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.dropboxapi.com/2/users/get_current_account\",\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.account_id,\n          name: profile.name?.display_name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.profile_photo_url,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar linkedin = (options) => {\n  const authorizationEndpoint = \"https://www.linkedin.com/oauth/v2/authorization\";\n  const tokenEndpoint = \"https://www.linkedin.com/oauth/v2/accessToken\";\n  return {\n    id: \"linkedin\",\n    name: \"Linkedin\",\n    createAuthorizationURL: async ({ state, scopes, redirectURI }) => {\n      const _scopes = scopes || [\"profile\", \"email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"linkedin\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://api.linkedin.com/v2/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.picture,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar cleanDoubleSlashes = (input = \"\") => {\n  return input.split(\"://\").map((str) => str.replace(/\\/{2,}/g, \"/\")).join(\"://\");\n};\nvar issuerToEndpoints = (issuer) => {\n  let baseUrl = issuer || \"https://gitlab.com\";\n  return {\n    authorizationEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/authorize`),\n    tokenEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/token`),\n    userinfoEndpoint: cleanDoubleSlashes(`${baseUrl}/api/v4/user`)\n  };\n};\nvar gitlab = (options) => {\n  const { authorizationEndpoint, tokenEndpoint, userinfoEndpoint } = issuerToEndpoints(options.issuer);\n  const issuerId = \"gitlab\";\n  const issuerName = \"Gitlab\";\n  return {\n    id: issuerId,\n    name: issuerName,\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = scopes || [\"read_user\"];\n      options.scope && _scopes.push(...options.scope);\n      return await (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: issuerId,\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        codeVerifier,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        userinfoEndpoint,\n        { headers: { authorization: `Bearer ${token.accessToken}` } }\n      );\n      if (error || profile.state !== \"active\" || profile.locked) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id.toString(),\n          name: profile.name ?? profile.username,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar reddit = (options) => {\n  return {\n    id: \"reddit\",\n    name: \"Reddit\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = scopes || [\"identity\"];\n      options.scope && _scopes.push(...options.scope);\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.createAuthorizationURL)({\n        id: \"reddit\",\n        options,\n        authorizationEndpoint: \"https://www.reddit.com/api/v1/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        duration: options.duration\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const body = new URLSearchParams({\n        grant_type: \"authorization_code\",\n        code,\n        redirect_uri: options.redirectURI || redirectURI\n      });\n      const headers = {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        accept: \"text/plain\",\n        \"user-agent\": \"better-auth\",\n        Authorization: `Basic ${Buffer.from(\n          `${options.clientId}:${options.clientSecret}`\n        ).toString(\"base64\")}`\n      };\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://www.reddit.com/api/v1/access_token\",\n        {\n          method: \"POST\",\n          headers,\n          body: body.toString()\n        }\n      );\n      if (error) {\n        throw error;\n      }\n      return (0,_chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_0__.getOAuth2Tokens)(data);\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_3__.betterFetch)(\n        \"https://oauth.reddit.com/api/v1/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.oauth_client_id,\n          emailVerified: profile.has_verified_email,\n          image: profile.icon_img?.split(\"?\")[0],\n          ...userMap\n        },\n        data: profile\n      };\n    }\n  };\n};\nvar socialProviders = {\n  apple,\n  discord,\n  facebook,\n  github,\n  microsoft,\n  google,\n  spotify,\n  twitch,\n  twitter,\n  dropbox,\n  linkedin,\n  gitlab,\n  reddit\n};\nvar socialProviderList = Object.keys(socialProviders);\nvar SocialProviderListEnum = zod__WEBPACK_IMPORTED_MODULE_5__.z[\"enum\"](socialProviderList, {\n  description: \"OAuth2 provider to use\"\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVZYRFlOQ09YLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBeUc7QUFDNUQ7QUFDUztBQUNKO0FBQ1g7QUFDMkQ7QUFDMUU7O0FBRXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsNEJBQTRCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxpQkFBaUIsbUNBQW1DLG1DQUFtQyxTQUFTLGlCQUFpQixTQUFTLE1BQU07QUFDOUw7QUFDQSxLQUFLO0FBQ0wsd0NBQXdDLGlDQUFpQztBQUN6RSxhQUFhLDZFQUF5QjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwyREFBcUI7QUFDakQsY0FBYyxtQkFBbUI7QUFDakM7QUFDQTtBQUNBLGNBQWMscUJBQXFCLFFBQVEsK0NBQVM7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsK0NBQVM7QUFDL0I7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDZCQUE2QixFQUFFLDJCQUEyQjtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLE9BQU8sUUFBUSxnRUFBVyxJQUFJLGVBQWUsRUFBRSxlQUFlO0FBQ3hFO0FBQ0EsY0FBYyxpREFBUTtBQUN0QjtBQUNBLEtBQUs7QUFDTDtBQUNB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b2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVZYRFlOQ09YLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUsIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwsIGdldE9BdXRoMlRva2VucyB9IGZyb20gJy4vY2h1bmstR1RRTTdKVTcuanMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9jaHVuay1LTERGQkxZTC5qcyc7XG5pbXBvcnQgeyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICcuL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGRlY29kZVByb3RlY3RlZEhlYWRlciwgand0VmVyaWZ5LCBkZWNvZGVKd3QsIGltcG9ydEpXSywgY3JlYXRlUmVtb3RlSldLU2V0IH0gZnJvbSAnam9zZSc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxudmFyIGFwcGxlID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbS9hdXRoL3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYXBwbGVcIixcbiAgICBuYW1lOiBcIkFwcGxlXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZSA9IHNjb3BlcyB8fCBbXCJlbWFpbFwiLCBcIm5hbWVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZS5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIG5ldyBVUkwoXG4gICAgICAgIGBodHRwczovL2FwcGxlaWQuYXBwbGUuY29tL2F1dGgvYXV0aG9yaXplP2NsaWVudF9pZD0ke29wdGlvbnMuY2xpZW50SWR9JnJlc3BvbnNlX3R5cGU9Y29kZSZyZWRpcmVjdF91cmk9JHtvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJfSZzY29wZT0ke19zY29wZS5qb2luKFwiIFwiKX0mc3RhdGU9JHtzdGF0ZX0mcmVzcG9uc2VfbW9kZT1mb3JtX3Bvc3RgXG4gICAgICApO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgY29uc3QgZGVjb2RlZEhlYWRlciA9IGRlY29kZVByb3RlY3RlZEhlYWRlcih0b2tlbik7XG4gICAgICBjb25zdCB7IGtpZCwgYWxnOiBqd3RBbGcgfSA9IGRlY29kZWRIZWFkZXI7XG4gICAgICBpZiAoIWtpZCB8fCAhand0QWxnKSByZXR1cm4gZmFsc2U7XG4gICAgICBjb25zdCBwdWJsaWNLZXkgPSBhd2FpdCBnZXRBcHBsZVB1YmxpY0tleShraWQpO1xuICAgICAgY29uc3QgeyBwYXlsb2FkOiBqd3RDbGFpbXMgfSA9IGF3YWl0IGp3dFZlcmlmeSh0b2tlbiwgcHVibGljS2V5LCB7XG4gICAgICAgIGFsZ29yaXRobXM6IFtqd3RBbGddLFxuICAgICAgICBpc3N1ZXI6IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbVwiLFxuICAgICAgICBhdWRpZW5jZTogb3B0aW9ucy5hcHBCdW5kbGVJZGVudGlmaWVyIHx8IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgIG1heFRva2VuQWdlOiBcIjFoXCJcbiAgICAgIH0pO1xuICAgICAgW1wiZW1haWxfdmVyaWZpZWRcIiwgXCJpc19wcml2YXRlX2VtYWlsXCJdLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChqd3RDbGFpbXNbZmllbGRdICE9PSB2b2lkIDApIHtcbiAgICAgICAgICBqd3RDbGFpbXNbZmllbGRdID0gQm9vbGVhbihqd3RDbGFpbXNbZmllbGRdKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAobm9uY2UgJiYgand0Q2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gISFqd3RDbGFpbXM7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJvZmlsZSA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5hbWUgPSBwcm9maWxlLnVzZXIgPyBgJHtwcm9maWxlLnVzZXIubmFtZS5maXJzdE5hbWV9ICR7cHJvZmlsZS51c2VyLm5hbWUubGFzdE5hbWV9YCA6IHByb2ZpbGUuZW1haWw7XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgZ2V0QXBwbGVQdWJsaWNLZXkgPSBhc3luYyAoa2lkKSA9PiB7XG4gIGNvbnN0IEFQUExFX0JBU0VfVVJMID0gXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tXCI7XG4gIGNvbnN0IEpXS1NfQVBQTEVfVVJJID0gXCIvYXV0aC9rZXlzXCI7XG4gIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goYCR7QVBQTEVfQkFTRV9VUkx9JHtKV0tTX0FQUExFX1VSSX1gKTtcbiAgaWYgKCFkYXRhPy5rZXlzKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJLZXlzIG5vdCBmb3VuZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgandrID0gZGF0YS5rZXlzLmZpbmQoKGtleSkgPT4ga2V5LmtpZCA9PT0ga2lkKTtcbiAgaWYgKCFqd2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEpXSyB3aXRoIGtpZCAke2tpZH0gbm90IGZvdW5kYCk7XG4gIH1cbiAgcmV0dXJuIGF3YWl0IGltcG9ydEpXSyhqd2ssIGp3ay5hbGcpO1xufTtcbnZhciBkaXNjb3JkID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJkaXNjb3JkXCIsXG4gICAgbmFtZTogXCJEaXNjb3JkXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1wiaWRlbnRpZnlcIiwgXCJlbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIG5ldyBVUkwoXG4gICAgICAgIGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS9vYXV0aDIvYXV0aG9yaXplP3Njb3BlPSR7X3Njb3Blcy5qb2luKFxuICAgICAgICAgIFwiK1wiXG4gICAgICAgICl9JnJlc3BvbnNlX3R5cGU9Y29kZSZjbGllbnRfaWQ9JHtvcHRpb25zLmNsaWVudElkfSZyZWRpcmVjdF91cmk9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgICApfSZzdGF0ZT0ke3N0YXRlfSZwcm9tcHQ9JHtvcHRpb25zLnByb21wdCB8fCBcIm5vbmVcIn1gXG4gICAgICApO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdXNlcnMvQG1lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmIChwcm9maWxlLmF2YXRhciA9PT0gbnVsbCkge1xuICAgICAgICBjb25zdCBkZWZhdWx0QXZhdGFyTnVtYmVyID0gcHJvZmlsZS5kaXNjcmltaW5hdG9yID09PSBcIjBcIiA/IE51bWJlcihCaWdJbnQocHJvZmlsZS5pZCkgPj4gQmlnSW50KDIyKSkgJSA2IDogcGFyc2VJbnQocHJvZmlsZS5kaXNjcmltaW5hdG9yKSAlIDU7XG4gICAgICAgIHByb2ZpbGUuaW1hZ2VfdXJsID0gYGh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2VtYmVkL2F2YXRhcnMvJHtkZWZhdWx0QXZhdGFyTnVtYmVyfS5wbmdgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZm9ybWF0ID0gcHJvZmlsZS5hdmF0YXIuc3RhcnRzV2l0aChcImFfXCIpID8gXCJnaWZcIiA6IFwicG5nXCI7XG4gICAgICAgIHByb2ZpbGUuaW1hZ2VfdXJsID0gYGh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMvJHtwcm9maWxlLmlkfS8ke3Byb2ZpbGUuYXZhdGFyfS4ke2Zvcm1hdH1gO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGlzcGxheV9uYW1lIHx8IHByb2ZpbGUudXNlcm5hbWUgfHwgXCJcIixcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLnZlcmlmaWVkLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmltYWdlX3VybCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBmYWNlYm9vayA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZmFjZWJvb2tcIixcbiAgICBuYW1lOiBcIkZhY2Vib29rXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1wiZW1haWxcIiwgXCJwdWJsaWNfcHJvZmlsZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJmYWNlYm9va1wiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3YyMS4wL2RpYWxvZy9vYXV0aFwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL29hdXRoL2FjY2Vzc190b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGlmICh0b2tlbi5zcGxpdChcIi5cIikubGVuZ3RoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyBwYXlsb2FkOiBqd3RDbGFpbXMgfSA9IGF3YWl0IGp3dFZlcmlmeShcbiAgICAgICAgICAgIHRva2VuLFxuICAgICAgICAgICAgY3JlYXRlUmVtb3RlSldLU2V0KFxuICAgICAgICAgICAgICBuZXcgVVJMKFwiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tLy53ZWxsLWtub3duL29hdXRoL29wZW5pZC9qd2tzXCIpXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBhbGdvcml0aG1zOiBbXCJSUzI1NlwiXSxcbiAgICAgICAgICAgICAgYXVkaWVuY2U6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgICAgIGlzc3VlcjogXCJodHRwczovL3d3dy5mYWNlYm9vay5jb21cIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKG5vbmNlICYmIGp3dENsYWltcy5ub25jZSAhPT0gbm9uY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuICEhand0Q2xhaW1zO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmlkVG9rZW4pIHtcbiAgICAgICAgY29uc3QgcHJvZmlsZTIgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICAgIGNvbnN0IHVzZXIgPSB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUyLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlMi5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlMi5lbWFpbCxcbiAgICAgICAgICBwaWN0dXJlOiB7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIHVybDogcHJvZmlsZTIucGljdHVyZSxcbiAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAsXG4gICAgICAgICAgICAgIHdpZHRoOiAxMDAsXG4gICAgICAgICAgICAgIGlzX3NpbGhvdWV0dGU6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCB1c2VyTWFwMiA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHtcbiAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgIGVtYWlsX3ZlcmlmaWVkOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIC4uLnVzZXIsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgLi4udXNlck1hcDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRhdGE6IHByb2ZpbGUyXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBjb25zdCBmaWVsZHMgPSBbXG4gICAgICAgIFwiaWRcIixcbiAgICAgICAgXCJuYW1lXCIsXG4gICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgXCJwaWN0dXJlXCIsXG4gICAgICAgIC4uLm9wdGlvbnM/LmZpZWxkcyB8fCBbXVxuICAgICAgXTtcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2ZpZWxkcz1cIiArIGZpZWxkcy5qb2luKFwiLFwiKSxcbiAgICAgICAge1xuICAgICAgICAgIGF1dGg6IHtcbiAgICAgICAgICAgIHR5cGU6IFwiQmVhcmVyXCIsXG4gICAgICAgICAgICB0b2tlbjogdG9rZW4uYWNjZXNzVG9rZW5cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUuZGF0YS51cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBnaXRodWIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2dpdGh1Yi5jb20vbG9naW4vb2F1dGgvYWNjZXNzX3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZ2l0aHViXCIsXG4gICAgbmFtZTogXCJHaXRIdWJcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gc2NvcGVzIHx8IFtcInJlYWQ6dXNlclwiLCBcInVzZXI6ZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZ2l0aHViXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2dpdGh1Yi5jb20vbG9naW4vb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlclwiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJVc2VyLUFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIixcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgbGV0IGVtYWlsVmVyaWZpZWQgPSBmYWxzZTtcbiAgICAgIGlmICghcHJvZmlsZS5lbWFpbCkge1xuICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2VyL2VtYWlsc1wiLCB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgICBcIlVzZXItQWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICBwcm9maWxlLmVtYWlsID0gKGRhdGEuZmluZCgoZSkgPT4gZS5wcmltYXJ5KSA/PyBkYXRhWzBdKT8uZW1haWw7XG4gICAgICAgICAgZW1haWxWZXJpZmllZCA9IGRhdGEuZmluZCgoZSkgPT4gZS5lbWFpbCA9PT0gcHJvZmlsZS5lbWFpbCk/LnZlcmlmaWVkID8/IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQudG9TdHJpbmcoKSxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUgfHwgcHJvZmlsZS5sb2dpbixcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgZ29vZ2xlID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnb29nbGVcIixcbiAgICBuYW1lOiBcIkdvb2dsZVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCB8fCAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IElkIGFuZCBDbGllbnQgU2VjcmV0IGlzIHJlcXVpcmVkIGZvciBHb29nbGUuIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFjb2RlVmVyaWZpZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcImNvZGVWZXJpZmllciBpcyByZXF1aXJlZCBmb3IgR29vZ2xlXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJlbWFpbFwiLCBcInByb2ZpbGVcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJnb29nbGVcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgICAgb3B0aW9ucy5hY2Nlc3NUeXBlICYmIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiYWNjZXNzX3R5cGVcIiwgb3B0aW9ucy5hY2Nlc3NUeXBlKTtcbiAgICAgIG9wdGlvbnMucHJvbXB0ICYmIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicHJvbXB0XCIsIG9wdGlvbnMucHJvbXB0KTtcbiAgICAgIG9wdGlvbnMuZGlzcGxheSAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImRpc3BsYXlcIiwgb3B0aW9ucy5kaXNwbGF5KTtcbiAgICAgIG9wdGlvbnMuaGQgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJoZFwiLCBvcHRpb25zLmhkKTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGdvb2dsZVB1YmxpY0tleVVybCA9IGBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjMvdG9rZW5pbmZvP2lkX3Rva2VuPSR7dG9rZW59YDtcbiAgICAgIGNvbnN0IHsgZGF0YTogdG9rZW5JbmZvIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChnb29nbGVQdWJsaWNLZXlVcmwpO1xuICAgICAgaWYgKCF0b2tlbkluZm8pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgaXNWYWxpZCA9IHRva2VuSW5mby5hdWQgPT09IG9wdGlvbnMuY2xpZW50SWQgJiYgKHRva2VuSW5mby5pc3MgPT09IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tXCIgfHwgdG9rZW5JbmZvLmlzcyA9PT0gXCJhY2NvdW50cy5nb29nbGUuY29tXCIpO1xuICAgICAgcmV0dXJuIGlzVmFsaWQ7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5zdWIsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBtaWNyb3NvZnQgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0ZW5hbnQgPSBvcHRpb25zLnRlbmFudElkIHx8IFwiY29tbW9uXCI7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IGBodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vJHt0ZW5hbnR9L29hdXRoMi92Mi4wL2F1dGhvcml6ZWA7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBgaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tLyR7dGVuYW50fS9vYXV0aDIvdjIuMC90b2tlbmA7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibWljcm9zb2Z0XCIsXG4gICAgbmFtZTogXCJNaWNyb3NvZnQgRW50cmFJRFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgY29uc3Qgc2NvcGVzID0gZGF0YS5zY29wZXMgfHwgW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCIsIFwiVXNlci5SZWFkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBzY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibWljcm9zb2Z0XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc3RhdGU6IGRhdGEuc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcjogZGF0YS5jb2RlVmVyaWZpZXIsXG4gICAgICAgIHNjb3BlcyxcbiAgICAgICAgcmVkaXJlY3RVUkk6IGRhdGEucmVkaXJlY3RVUkksXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5yZXF1aXJlU2VsZWN0QWNjb3VudCB8fCBmYWxzZVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uaWRUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICBjb25zdCBwcm9maWxlUGhvdG9TaXplID0gb3B0aW9ucy5wcm9maWxlUGhvdG9TaXplIHx8IDQ4O1xuICAgICAgYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIGBodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vdjEuMC9tZS9waG90b3MvJHtwcm9maWxlUGhvdG9TaXplfXgke3Byb2ZpbGVQaG90b1NpemV9LyR2YWx1ZWAsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgb25SZXNwb25zZShjb250ZXh0KSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5kaXNhYmxlUHJvZmlsZVBob3RvIHx8ICFjb250ZXh0LnJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gY29udGV4dC5yZXNwb25zZS5jbG9uZSgpO1xuICAgICAgICAgICAgICBjb25zdCBwaWN0dXJlQnVmZmVyID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICAgICAgICAgICAgY29uc3QgcGljdHVyZUJhc2U2NCA9IEJ1ZmZlci5mcm9tKHBpY3R1cmVCdWZmZXIpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuICAgICAgICAgICAgICB1c2VyLnBpY3R1cmUgPSBgZGF0YTppbWFnZS9qcGVnO2Jhc2U2NCwgJHtwaWN0dXJlQmFzZTY0fWA7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgICAgICBlICYmIHR5cGVvZiBlID09PSBcIm9iamVjdFwiICYmIFwibmFtZVwiIGluIGUgPyBlLm5hbWUgOiBcIlwiLFxuICAgICAgICAgICAgICAgIGVcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuc3ViLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogdXNlci5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB1c2VyXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgc3BvdGlmeSA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwic3BvdGlmeVwiLFxuICAgIG5hbWU6IFwiU3BvdGlmeVwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1widXNlci1yZWFkLWVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInNwb3RpZnlcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuc3BvdGlmeS5jb20vYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hY2NvdW50cy5zcG90aWZ5LmNvbS9hcGkvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkuc3BvdGlmeS5jb20vdjEvbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLmRpc3BsYXlfbmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5pbWFnZXNbMF0/LnVybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciB0d2l0Y2ggPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInR3aXRjaFwiLFxuICAgIG5hbWU6IFwiVHdpdGNoXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1widXNlcjpyZWFkOmVtYWlsXCIsIFwib3BlbmlkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInR3aXRjaFwiLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudHdpdGNoLnR2L29hdXRoMi9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY2xhaW1zOiBvcHRpb25zLmNsYWltcyB8fCBbXG4gICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgIFwiZW1haWxfdmVyaWZpZWRcIixcbiAgICAgICAgICBcInByZWZlcnJlZF91c2VybmFtZVwiLFxuICAgICAgICAgIFwicGljdHVyZVwiXG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLnR3aXRjaC50di9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgaWRUb2tlbiA9IHRva2VuLmlkVG9rZW47XG4gICAgICBpZiAoIWlkVG9rZW4pIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiTm8gaWRUb2tlbiBmb3VuZCBpbiB0b2tlblwiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maWxlID0gZGVjb2RlSnd0KGlkVG9rZW4pO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLnByZWZlcnJlZF91c2VybmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIHR3aXR0ZXIgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInR3aXR0ZXJcIixcbiAgICBuYW1lOiBcIlR3aXR0ZXJcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKGRhdGEpIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBkYXRhLnNjb3BlcyB8fCBbXG4gICAgICAgIFwidXNlcnMucmVhZFwiLFxuICAgICAgICBcInR3ZWV0LnJlYWRcIixcbiAgICAgICAgXCJvZmZsaW5lLmFjY2Vzc1wiXG4gICAgICBdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInR3aXR0ZXJcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8veC5jb20vaS9vYXV0aDIvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGU6IGRhdGEuc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcjogZGF0YS5jb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBkYXRhLnJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uOiBcImJhc2ljXCIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpLnguY29tLzIvb2F1dGgyL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLnguY29tLzIvdXNlcnMvbWU/dXNlci5maWVsZHM9cHJvZmlsZV9pbWFnZV91cmxcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5kYXRhLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGF0YS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmRhdGEudXNlcm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5kYXRhLnByb2ZpbGVfaW1hZ2VfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZGF0YS52ZXJpZmllZCB8fCBmYWxzZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbnZhciBkcm9wYm94ID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vb2F1dGgyL3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZHJvcGJveFwiLFxuICAgIG5hbWU6IFwiRHJvcGJveFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7XG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3BlcyxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJhY2NvdW50X2luZm8ucmVhZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJkcm9wYm94XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3d3dy5kcm9wYm94LmNvbS9vYXV0aDIvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBjb2RlVmVyaWZpZXJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLmRyb3Bib3hhcGkuY29tLzIvdXNlcnMvZ2V0X2N1cnJlbnRfYWNjb3VudFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5hY2NvdW50X2lkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZT8uZGlzcGxheV9uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgfHwgZmFsc2UsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucHJvZmlsZV9waG90b191cmwsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgbGlua2VkaW4gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBhdXRob3JpemF0aW9uRW5kcG9pbnQgPSBcImh0dHBzOi8vd3d3LmxpbmtlZGluLmNvbS9vYXV0aC92Mi9hdXRob3JpemF0aW9uXCI7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vd3d3LmxpbmtlZGluLmNvbS9vYXV0aC92Mi9hY2Nlc3NUb2tlblwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcImxpbmtlZGluXCIsXG4gICAgbmFtZTogXCJMaW5rZWRpblwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1wicHJvZmlsZVwiLCBcImVtYWlsXCIsIFwib3BlbmlkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImxpbmtlZGluXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkubGlua2VkaW4uY29tL3YyL3VzZXJpbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkIHx8IGZhbHNlLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG52YXIgY2xlYW5Eb3VibGVTbGFzaGVzID0gKGlucHV0ID0gXCJcIikgPT4ge1xuICByZXR1cm4gaW5wdXQuc3BsaXQoXCI6Ly9cIikubWFwKChzdHIpID0+IHN0ci5yZXBsYWNlKC9cXC97Mix9L2csIFwiL1wiKSkuam9pbihcIjovL1wiKTtcbn07XG52YXIgaXNzdWVyVG9FbmRwb2ludHMgPSAoaXNzdWVyKSA9PiB7XG4gIGxldCBiYXNlVXJsID0gaXNzdWVyIHx8IFwiaHR0cHM6Ly9naXRsYWIuY29tXCI7XG4gIHJldHVybiB7XG4gICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBjbGVhbkRvdWJsZVNsYXNoZXMoYCR7YmFzZVVybH0vb2F1dGgvYXV0aG9yaXplYCksXG4gICAgdG9rZW5FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L29hdXRoL3Rva2VuYCksXG4gICAgdXNlcmluZm9FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L2FwaS92NC91c2VyYClcbiAgfTtcbn07XG52YXIgZ2l0bGFiID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgeyBhdXRob3JpemF0aW9uRW5kcG9pbnQsIHRva2VuRW5kcG9pbnQsIHVzZXJpbmZvRW5kcG9pbnQgfSA9IGlzc3VlclRvRW5kcG9pbnRzKG9wdGlvbnMuaXNzdWVyKTtcbiAgY29uc3QgaXNzdWVySWQgPSBcImdpdGxhYlwiO1xuICBjb25zdCBpc3N1ZXJOYW1lID0gXCJHaXRsYWJcIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogaXNzdWVySWQsXG4gICAgbmFtZTogaXNzdWVyTmFtZSxcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMOiBhc3luYyAoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSVxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBzY29wZXMgfHwgW1wicmVhZF91c2VyXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBpc3N1ZXJJZCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgY29kZVZlcmlmaWVyXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgdXNlcmluZm9FbmRwb2ludCxcbiAgICAgICAgeyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gIH0gfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCBwcm9maWxlLnN0YXRlICE9PSBcImFjdGl2ZVwiIHx8IHByb2ZpbGUubG9ja2VkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLnRvU3RyaW5nKCksXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lID8/IHByb2ZpbGUudXNlcm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuYXZhdGFyX3VybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIHJlZGRpdCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwicmVkZGl0XCIsXG4gICAgbmFtZTogXCJSZWRkaXRcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IHNjb3BlcyB8fCBbXCJpZGVudGl0eVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJyZWRkaXRcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LnJlZGRpdC5jb20vYXBpL3YxL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb25cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgY29uc3QgYm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICBncmFudF90eXBlOiBcImF1dGhvcml6YXRpb25fY29kZVwiLFxuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdF91cmk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcbiAgICAgICAgYWNjZXB0OiBcInRleHQvcGxhaW5cIixcbiAgICAgICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIixcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7QnVmZmVyLmZyb20oXG4gICAgICAgICAgYCR7b3B0aW9ucy5jbGllbnRJZH06JHtvcHRpb25zLmNsaWVudFNlY3JldH1gXG4gICAgICAgICkudG9TdHJpbmcoXCJiYXNlNjRcIil9YFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vd3d3LnJlZGRpdC5jb20vYXBpL3YxL2FjY2Vzc190b2tlblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIGJvZHk6IGJvZHkudG9TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGdldE9BdXRoMlRva2VucyhkYXRhKTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL29hdXRoLnJlZGRpdC5jb20vYXBpL3YxL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAgIFwiVXNlci1BZ2VudFwiOiBcImJldHRlci1hdXRoXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLm9hdXRoX2NsaWVudF9pZCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmhhc192ZXJpZmllZF9lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5pY29uX2ltZz8uc3BsaXQoXCI/XCIpWzBdLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xudmFyIHNvY2lhbFByb3ZpZGVycyA9IHtcbiAgYXBwbGUsXG4gIGRpc2NvcmQsXG4gIGZhY2Vib29rLFxuICBnaXRodWIsXG4gIG1pY3Jvc29mdCxcbiAgZ29vZ2xlLFxuICBzcG90aWZ5LFxuICB0d2l0Y2gsXG4gIHR3aXR0ZXIsXG4gIGRyb3Bib3gsXG4gIGxpbmtlZGluLFxuICBnaXRsYWIsXG4gIHJlZGRpdFxufTtcbnZhciBzb2NpYWxQcm92aWRlckxpc3QgPSBPYmplY3Qua2V5cyhzb2NpYWxQcm92aWRlcnMpO1xudmFyIFNvY2lhbFByb3ZpZGVyTGlzdEVudW0gPSB6LmVudW0oc29jaWFsUHJvdmlkZXJMaXN0LCB7XG4gIGRlc2NyaXB0aW9uOiBcIk9BdXRoMiBwcm92aWRlciB0byB1c2VcIlxufSk7XG5cbmV4cG9ydCB7IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0sIGFwcGxlLCBkaXNjb3JkLCBkcm9wYm94LCBmYWNlYm9vaywgZ2V0QXBwbGVQdWJsaWNLZXksIGdpdGh1YiwgZ2l0bGFiLCBnb29nbGUsIGxpbmtlZGluLCBtaWNyb3NvZnQsIHJlZGRpdCwgc29jaWFsUHJvdmlkZXJMaXN0LCBzb2NpYWxQcm92aWRlcnMsIHNwb3RpZnksIHR3aXRjaCwgdHdpdHRlciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TWO_FACTOR_ERROR_CODES: () => (/* binding */ TWO_FACTOR_ERROR_CODES)\n/* harmony export */ });\n// src/plugins/two-factor/error-code.ts\nvar TWO_FACTOR_ERROR_CODES = {\n  OTP_NOT_ENABLED: \"OTP not enabled\",\n  OTP_HAS_EXPIRED: \"OTP has expired\",\n  TOTP_NOT_ENABLED: \"TOTP not enabled\",\n  TWO_FACTOR_NOT_ENABLED: \"Two factor isn't enabled\",\n  BACKUP_CODES_NOT_ENABLED: \"Backup codes aren't enabled\",\n  INVALID_BACKUP_CODE: \"Invalid backup code\"\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVdNWEJBNkxYLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWtDIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstV01YQkE2TFguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3BsdWdpbnMvdHdvLWZhY3Rvci9lcnJvci1jb2RlLnRzXG52YXIgVFdPX0ZBQ1RPUl9FUlJPUl9DT0RFUyA9IHtcbiAgT1RQX05PVF9FTkFCTEVEOiBcIk9UUCBub3QgZW5hYmxlZFwiLFxuICBPVFBfSEFTX0VYUElSRUQ6IFwiT1RQIGhhcyBleHBpcmVkXCIsXG4gIFRPVFBfTk9UX0VOQUJMRUQ6IFwiVE9UUCBub3QgZW5hYmxlZFwiLFxuICBUV09fRkFDVE9SX05PVF9FTkFCTEVEOiBcIlR3byBmYWN0b3IgaXNuJ3QgZW5hYmxlZFwiLFxuICBCQUNLVVBfQ09ERVNfTk9UX0VOQUJMRUQ6IFwiQmFja3VwIGNvZGVzIGFyZW4ndCBlbmFibGVkXCIsXG4gIElOVkFMSURfQkFDS1VQX0NPREU6IFwiSW52YWxpZCBiYWNrdXAgY29kZVwiXG59O1xuXG5leHBvcnQgeyBUV09fRkFDVE9SX0VSUk9SX0NPREVTIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accountSchema: () => (/* binding */ accountSchema),\n/* harmony export */   getAllFields: () => (/* binding */ getAllFields),\n/* harmony export */   getIp: () => (/* binding */ getIp),\n/* harmony export */   mergeSchema: () => (/* binding */ mergeSchema),\n/* harmony export */   parseAccountInput: () => (/* binding */ parseAccountInput),\n/* harmony export */   parseAccountOutput: () => (/* binding */ parseAccountOutput),\n/* harmony export */   parseAdditionalUserInput: () => (/* binding */ parseAdditionalUserInput),\n/* harmony export */   parseInputData: () => (/* binding */ parseInputData),\n/* harmony export */   parseOutputData: () => (/* binding */ parseOutputData),\n/* harmony export */   parseSessionInput: () => (/* binding */ parseSessionInput),\n/* harmony export */   parseSessionOutput: () => (/* binding */ parseSessionOutput),\n/* harmony export */   parseUserInput: () => (/* binding */ parseUserInput),\n/* harmony export */   parseUserOutput: () => (/* binding */ parseUserOutput),\n/* harmony export */   sessionSchema: () => (/* binding */ sessionSchema),\n/* harmony export */   userSchema: () => (/* binding */ userSchema),\n/* harmony export */   verificationSchema: () => (/* binding */ verificationSchema)\n/* harmony export */ });\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n\n\n\n\nvar accountSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  providerId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  accountId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  accessToken: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  refreshToken: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  idToken: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  /**\n   * Access token expires at\n   */\n  accessTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().nullish(),\n  /**\n   * Refresh token expires at\n   */\n  refreshTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().nullish(),\n  /**\n   * The scopes that the user has authorized\n   */\n  scope: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  /**\n   * Password is only stored in the credential provider\n   */\n  password: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date())\n});\nvar userSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  email: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().transform((val) => val.toLowerCase()),\n  emailVerified: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean().default(false),\n  name: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  image: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date())\n});\nvar sessionSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  token: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  ipAddress: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish(),\n  userAgent: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish()\n});\nvar verificationSchema = zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date().default(() => /* @__PURE__ */ new Date()),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_1__.z.date(),\n  identifier: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n  nonce: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().nullish()\n});\nfunction parseOutputData(data, schema) {\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in data) {\n    const field = fields[key];\n    if (!field) {\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (field.returned === false) {\n      continue;\n    }\n    parsedData[key] = data[key];\n  }\n  return parsedData;\n}\nfunction getAllFields(options, table) {\n  let schema = {\n    ...table === \"user\" ? options.user?.additionalFields : {},\n    ...table === \"session\" ? options.session?.additionalFields : {}\n  };\n  for (const plugin of options.plugins || []) {\n    if (plugin.schema && plugin.schema[table]) {\n      schema = {\n        ...schema,\n        ...plugin.schema[table].fields\n      };\n    }\n  }\n  return schema;\n}\nfunction parseUserOutput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseOutputData(user, { fields: schema });\n}\nfunction parseAccountOutput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseOutputData(account, { fields: schema });\n}\nfunction parseSessionOutput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseOutputData(session, { fields: schema });\n}\nfunction parseInputData(data, schema) {\n  const action = schema.action || \"create\";\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in fields) {\n    if (key in data) {\n      if (fields[key].input === false) {\n        if (fields[key].defaultValue) {\n          parsedData[key] = fields[key].defaultValue;\n          continue;\n        }\n        continue;\n      }\n      if (fields[key].validator?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].validator.input.parse(data[key]);\n        continue;\n      }\n      if (fields[key].transform?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].transform?.input(data[key]);\n        continue;\n      }\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (fields[key].defaultValue && action === \"create\") {\n      parsedData[key] = fields[key].defaultValue;\n      continue;\n    }\n    if (fields[key].required && action === \"create\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `${key} is required`\n      });\n    }\n  }\n  return parsedData;\n}\nfunction parseUserInput(options, user, action) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema, action });\n}\nfunction parseAdditionalUserInput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema });\n}\nfunction parseAccountInput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseInputData(account, { fields: schema });\n}\nfunction parseSessionInput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseInputData(session, { fields: schema });\n}\nfunction mergeSchema(schema, newSchema) {\n  if (!newSchema) {\n    return schema;\n  }\n  for (const table in newSchema) {\n    const newModelName = newSchema[table]?.modelName;\n    if (newModelName) {\n      schema[table].modelName = newModelName;\n    }\n    for (const field in schema[table].fields) {\n      const newField = newSchema[table]?.fields?.[field];\n      if (!newField) {\n        continue;\n      }\n      schema[table].fields[field].fieldName = newField;\n    }\n  }\n  return schema;\n}\n\n// src/utils/get-request-ip.ts\nfunction getIp(req, options) {\n  if (options.advanced?.ipAddress?.disableIpTracking) {\n    return null;\n  }\n  const testIP = \"127.0.0.1\";\n  if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.isTest) {\n    return testIP;\n  }\n  const ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders;\n  const keys = ipHeaders || [\n    \"x-client-ip\",\n    \"x-forwarded-for\",\n    \"cf-connecting-ip\",\n    \"fastly-client-ip\",\n    \"x-real-ip\",\n    \"x-cluster-client-ip\",\n    \"x-forwarded\",\n    \"forwarded-for\",\n    \"forwarded\"\n  ];\n  const headers = req instanceof Request ? req.headers : req;\n  for (const key of keys) {\n    const value = headers.get(key);\n    if (typeof value === \"string\") {\n      const ip = value.split(\",\")[0].trim();\n      if (ip) return ip;\n    }\n  }\n  return null;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVdaNk9JVkpLLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFDckI7QUFDZTs7QUFFdkMsb0JBQW9CLHlDQUFRO0FBQzVCLE1BQU0seUNBQVE7QUFDZCxjQUFjLHlDQUFRO0FBQ3RCLGFBQWEseUNBQVE7QUFDckIsVUFBVSx5Q0FBUTtBQUNsQixlQUFlLHlDQUFRO0FBQ3ZCLGdCQUFnQix5Q0FBUTtBQUN4QixXQUFXLHlDQUFRO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1Q0FBTTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUNBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0EsU0FBUyx5Q0FBUTtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlDQUFRO0FBQ3BCLGFBQWEsdUNBQU07QUFDbkIsYUFBYSx1Q0FBTTtBQUNuQixDQUFDO0FBQ0QsaUJBQWlCLHlDQUFRO0FBQ3pCLE1BQU0seUNBQVE7QUFDZCxTQUFTLHlDQUFRO0FBQ2pCLGlCQUFpQiwwQ0FBUztBQUMxQixRQUFRLHlDQUFRO0FBQ2hCLFNBQVMseUNBQVE7QUFDakIsYUFBYSx1Q0FBTTtBQUNuQixhQUFhLHVDQUFNO0FBQ25CLENBQUM7QUFDRCxvQkFBb0IseUNBQVE7QUFDNUIsTUFBTSx5Q0FBUTtBQUNkLFVBQVUseUNBQVE7QUFDbEIsYUFBYSx1Q0FBTTtBQUNuQixhQUFhLHVDQUFNO0FBQ25CLGFBQWEsdUNBQU07QUFDbkIsU0FBUyx5Q0FBUTtBQUNqQixhQUFhLHlDQUFRO0FBQ3JCLGFBQWEseUNBQVE7QUFDckIsQ0FBQztBQUNELHlCQUF5Qix5Q0FBUTtBQUNqQyxNQUFNLHlDQUFRO0FBQ2QsU0FBUyx5Q0FBUTtBQUNqQixhQUFhLHVDQUFNO0FBQ25CLGFBQWEsdUNBQU07QUFDbkIsYUFBYSx1Q0FBTTtBQUNuQixjQUFjLHlDQUFRO0FBQ3RCLFNBQVMseUNBQVE7QUFDakIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGdCQUFnQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0JBQWdCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnQkFBZ0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCLG9CQUFvQixLQUFLO0FBQ3pCLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsSUFBSSx3QkFBd0I7QUFDOUQ7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLElBQUksZ0JBQWdCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxnQkFBZ0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGdCQUFnQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sc0RBQU07QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW9SIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstV1o2T0lWSksuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNUZXN0IH0gZnJvbSAnLi9jaHVuay1UUVFTUFBOQS5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG52YXIgYWNjb3VudFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIHByb3ZpZGVySWQ6IHouc3RyaW5nKCksXG4gIGFjY291bnRJZDogei5zdHJpbmcoKSxcbiAgdXNlcklkOiB6LnN0cmluZygpLFxuICBhY2Nlc3NUb2tlbjogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHJlZnJlc2hUb2tlbjogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIGlkVG9rZW46IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogQWNjZXNzIHRva2VuIGV4cGlyZXMgYXRcbiAgICovXG4gIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB6LmRhdGUoKS5udWxsaXNoKCksXG4gIC8qKlxuICAgKiBSZWZyZXNoIHRva2VuIGV4cGlyZXMgYXRcbiAgICovXG4gIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogei5kYXRlKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogVGhlIHNjb3BlcyB0aGF0IHRoZSB1c2VyIGhhcyBhdXRob3JpemVkXG4gICAqL1xuICBzY29wZTogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIC8qKlxuICAgKiBQYXNzd29yZCBpcyBvbmx5IHN0b3JlZCBpbiB0aGUgY3JlZGVudGlhbCBwcm92aWRlclxuICAgKi9cbiAgcGFzc3dvcmQ6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB1cGRhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpXG59KTtcbnZhciB1c2VyU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgZW1haWw6IHouc3RyaW5nKCkudHJhbnNmb3JtKCh2YWwpID0+IHZhbC50b0xvd2VyQ2FzZSgpKSxcbiAgZW1haWxWZXJpZmllZDogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXG4gIG5hbWU6IHouc3RyaW5nKCksXG4gIGltYWdlOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgY3JlYXRlZEF0OiB6LmRhdGUoKS5kZWZhdWx0KCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSxcbiAgdXBkYXRlZEF0OiB6LmRhdGUoKS5kZWZhdWx0KCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKVxufSk7XG52YXIgc2Vzc2lvblNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIHVzZXJJZDogei5zdHJpbmcoKSxcbiAgZXhwaXJlc0F0OiB6LmRhdGUoKSxcbiAgY3JlYXRlZEF0OiB6LmRhdGUoKS5kZWZhdWx0KCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSxcbiAgdXBkYXRlZEF0OiB6LmRhdGUoKS5kZWZhdWx0KCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSxcbiAgdG9rZW46IHouc3RyaW5nKCksXG4gIGlwQWRkcmVzczogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHVzZXJBZ2VudDogei5zdHJpbmcoKS5udWxsaXNoKClcbn0pO1xudmFyIHZlcmlmaWNhdGlvblNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIHZhbHVlOiB6LnN0cmluZygpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB1cGRhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICBleHBpcmVzQXQ6IHouZGF0ZSgpLFxuICBpZGVudGlmaWVyOiB6LnN0cmluZygpLFxuICBub25jZTogei5zdHJpbmcoKS5udWxsaXNoKClcbn0pO1xuZnVuY3Rpb24gcGFyc2VPdXRwdXREYXRhKGRhdGEsIHNjaGVtYSkge1xuICBjb25zdCBmaWVsZHMgPSBzY2hlbWEuZmllbGRzO1xuICBjb25zdCBwYXJzZWREYXRhID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1trZXldO1xuICAgIGlmICghZmllbGQpIHtcbiAgICAgIHBhcnNlZERhdGFba2V5XSA9IGRhdGFba2V5XTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZmllbGQucmV0dXJuZWQgPT09IGZhbHNlKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgcGFyc2VkRGF0YVtrZXldID0gZGF0YVtrZXldO1xuICB9XG4gIHJldHVybiBwYXJzZWREYXRhO1xufVxuZnVuY3Rpb24gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIHRhYmxlKSB7XG4gIGxldCBzY2hlbWEgPSB7XG4gICAgLi4udGFibGUgPT09IFwidXNlclwiID8gb3B0aW9ucy51c2VyPy5hZGRpdGlvbmFsRmllbGRzIDoge30sXG4gICAgLi4udGFibGUgPT09IFwic2Vzc2lvblwiID8gb3B0aW9ucy5zZXNzaW9uPy5hZGRpdGlvbmFsRmllbGRzIDoge31cbiAgfTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2Ygb3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgaWYgKHBsdWdpbi5zY2hlbWEgJiYgcGx1Z2luLnNjaGVtYVt0YWJsZV0pIHtcbiAgICAgIHNjaGVtYSA9IHtcbiAgICAgICAgLi4uc2NoZW1hLFxuICAgICAgICAuLi5wbHVnaW4uc2NoZW1hW3RhYmxlXS5maWVsZHNcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIHJldHVybiBzY2hlbWE7XG59XG5mdW5jdGlvbiBwYXJzZVVzZXJPdXRwdXQob3B0aW9ucywgdXNlcikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VPdXRwdXREYXRhKHVzZXIsIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFjY291bnRPdXRwdXQob3B0aW9ucywgYWNjb3VudCkge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJhY2NvdW50XCIpO1xuICByZXR1cm4gcGFyc2VPdXRwdXREYXRhKGFjY291bnQsIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZVNlc3Npb25PdXRwdXQob3B0aW9ucywgc2Vzc2lvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJzZXNzaW9uXCIpO1xuICByZXR1cm4gcGFyc2VPdXRwdXREYXRhKHNlc3Npb24sIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUlucHV0RGF0YShkYXRhLCBzY2hlbWEpIHtcbiAgY29uc3QgYWN0aW9uID0gc2NoZW1hLmFjdGlvbiB8fCBcImNyZWF0ZVwiO1xuICBjb25zdCBmaWVsZHMgPSBzY2hlbWEuZmllbGRzO1xuICBjb25zdCBwYXJzZWREYXRhID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIGZpZWxkcykge1xuICAgIGlmIChrZXkgaW4gZGF0YSkge1xuICAgICAgaWYgKGZpZWxkc1trZXldLmlucHV0ID09PSBmYWxzZSkge1xuICAgICAgICBpZiAoZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGZpZWxkc1trZXldLnZhbGlkYXRvcj8uaW5wdXQgJiYgZGF0YVtrZXldICE9PSB2b2lkIDApIHtcbiAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0udmFsaWRhdG9yLmlucHV0LnBhcnNlKGRhdGFba2V5XSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGZpZWxkc1trZXldLnRyYW5zZm9ybT8uaW5wdXQgJiYgZGF0YVtrZXldICE9PSB2b2lkIDApIHtcbiAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0udHJhbnNmb3JtPy5pbnB1dChkYXRhW2tleV0pO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHBhcnNlZERhdGFba2V5XSA9IGRhdGFba2V5XTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlICYmIGFjdGlvbiA9PT0gXCJjcmVhdGVcIikge1xuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZHNba2V5XS5yZXF1aXJlZCAmJiBhY3Rpb24gPT09IFwiY3JlYXRlXCIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYCR7a2V5fSBpcyByZXF1aXJlZGBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyc2VkRGF0YTtcbn1cbmZ1bmN0aW9uIHBhcnNlVXNlcklucHV0KG9wdGlvbnMsIHVzZXIsIGFjdGlvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEodXNlciB8fCB7fSwgeyBmaWVsZHM6IHNjaGVtYSwgYWN0aW9uIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VBZGRpdGlvbmFsVXNlcklucHV0KG9wdGlvbnMsIHVzZXIpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwidXNlclwiKTtcbiAgcmV0dXJuIHBhcnNlSW5wdXREYXRhKHVzZXIgfHwge30sIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFjY291bnRJbnB1dChvcHRpb25zLCBhY2NvdW50KSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcImFjY291bnRcIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YShhY2NvdW50LCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VTZXNzaW9uSW5wdXQob3B0aW9ucywgc2Vzc2lvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJzZXNzaW9uXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEoc2Vzc2lvbiwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIG1lcmdlU2NoZW1hKHNjaGVtYSwgbmV3U2NoZW1hKSB7XG4gIGlmICghbmV3U2NoZW1hKSB7XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfVxuICBmb3IgKGNvbnN0IHRhYmxlIGluIG5ld1NjaGVtYSkge1xuICAgIGNvbnN0IG5ld01vZGVsTmFtZSA9IG5ld1NjaGVtYVt0YWJsZV0/Lm1vZGVsTmFtZTtcbiAgICBpZiAobmV3TW9kZWxOYW1lKSB7XG4gICAgICBzY2hlbWFbdGFibGVdLm1vZGVsTmFtZSA9IG5ld01vZGVsTmFtZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBmaWVsZCBpbiBzY2hlbWFbdGFibGVdLmZpZWxkcykge1xuICAgICAgY29uc3QgbmV3RmllbGQgPSBuZXdTY2hlbWFbdGFibGVdPy5maWVsZHM/LltmaWVsZF07XG4gICAgICBpZiAoIW5ld0ZpZWxkKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgc2NoZW1hW3RhYmxlXS5maWVsZHNbZmllbGRdLmZpZWxkTmFtZSA9IG5ld0ZpZWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufVxuXG4vLyBzcmMvdXRpbHMvZ2V0LXJlcXVlc3QtaXAudHNcbmZ1bmN0aW9uIGdldElwKHJlcSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uaXBBZGRyZXNzPy5kaXNhYmxlSXBUcmFja2luZykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHRlc3RJUCA9IFwiMTI3LjAuMC4xXCI7XG4gIGlmIChpc1Rlc3QpIHtcbiAgICByZXR1cm4gdGVzdElQO1xuICB9XG4gIGNvbnN0IGlwSGVhZGVycyA9IG9wdGlvbnMuYWR2YW5jZWQ/LmlwQWRkcmVzcz8uaXBBZGRyZXNzSGVhZGVycztcbiAgY29uc3Qga2V5cyA9IGlwSGVhZGVycyB8fCBbXG4gICAgXCJ4LWNsaWVudC1pcFwiLFxuICAgIFwieC1mb3J3YXJkZWQtZm9yXCIsXG4gICAgXCJjZi1jb25uZWN0aW5nLWlwXCIsXG4gICAgXCJmYXN0bHktY2xpZW50LWlwXCIsXG4gICAgXCJ4LXJlYWwtaXBcIixcbiAgICBcIngtY2x1c3Rlci1jbGllbnQtaXBcIixcbiAgICBcIngtZm9yd2FyZGVkXCIsXG4gICAgXCJmb3J3YXJkZWQtZm9yXCIsXG4gICAgXCJmb3J3YXJkZWRcIlxuICBdO1xuICBjb25zdCBoZWFkZXJzID0gcmVxIGluc3RhbmNlb2YgUmVxdWVzdCA/IHJlcS5oZWFkZXJzIDogcmVxO1xuICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgY29uc3QgdmFsdWUgPSBoZWFkZXJzLmdldChrZXkpO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGNvbnN0IGlwID0gdmFsdWUuc3BsaXQoXCIsXCIpWzBdLnRyaW0oKTtcbiAgICAgIGlmIChpcCkgcmV0dXJuIGlwO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IHsgYWNjb3VudFNjaGVtYSwgZ2V0QWxsRmllbGRzLCBnZXRJcCwgbWVyZ2VTY2hlbWEsIHBhcnNlQWNjb3VudElucHV0LCBwYXJzZUFjY291bnRPdXRwdXQsIHBhcnNlQWRkaXRpb25hbFVzZXJJbnB1dCwgcGFyc2VJbnB1dERhdGEsIHBhcnNlT3V0cHV0RGF0YSwgcGFyc2VTZXNzaW9uSW5wdXQsIHBhcnNlU2Vzc2lvbk91dHB1dCwgcGFyc2VVc2VySW5wdXQsIHBhcnNlVXNlck91dHB1dCwgc2Vzc2lvblNjaGVtYSwgdXNlclNjaGVtYSwgdmVyaWZpY2F0aW9uU2NoZW1hIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getBaseURL: () => (/* binding */ getBaseURL),\n/* harmony export */   getHost: () => (/* binding */ getHost),\n/* harmony export */   getOrigin: () => (/* binding */ getOrigin),\n/* harmony export */   getProtocol: () => (/* binding */ getProtocol)\n/* harmony export */ });\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n\n\n\n// src/utils/url.ts\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.pathname !== \"/\";\n  } catch (error) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${url.replace(/\\/+$/, \"\")}${path}`;\n}\nfunction getBaseURL(url, path) {\n  if (url) {\n    return withPath(url, path);\n  }\n  const fromEnv = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n  if (fromEnv) {\n    return withPath(fromEnv, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  if (url.includes(\"://\")) {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  }\n  return url;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVhGQ0lBTlpYLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwQztBQUNZOztBQUV0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGNBQWMsK0RBQWU7QUFDN0IsMkJBQTJCLElBQUk7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxLQUFLO0FBQ2hELFlBQVksd0JBQXdCLEVBQUUsS0FBSztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1EQUFHLG9CQUFvQixtREFBRyxnQ0FBZ0MsbURBQUcsMkJBQTJCLG1EQUFHLGdDQUFnQyxtREFBRywwQkFBMEIsbURBQUcsb0JBQW9CLG1EQUFHO0FBQ3BNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFdUQiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1YRkNJQU5aWC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlbnYgfSBmcm9tICcuL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vY2h1bmstVU5XQ1hLTVAuanMnO1xuXG4vLyBzcmMvdXRpbHMvdXJsLnRzXG5mdW5jdGlvbiBjaGVja0hhc1BhdGgodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwucGF0aG5hbWUgIT09IFwiL1wiO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICBgSW52YWxpZCBiYXNlIFVSTDogJHt1cmx9LiBQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIGJhc2UgVVJMLmBcbiAgICApO1xuICB9XG59XG5mdW5jdGlvbiB3aXRoUGF0aCh1cmwsIHBhdGggPSBcIi9hcGkvYXV0aFwiKSB7XG4gIGNvbnN0IGhhc1BhdGggPSBjaGVja0hhc1BhdGgodXJsKTtcbiAgaWYgKGhhc1BhdGgpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIHBhdGggPSBwYXRoLnN0YXJ0c1dpdGgoXCIvXCIpID8gcGF0aCA6IGAvJHtwYXRofWA7XG4gIHJldHVybiBgJHt1cmwucmVwbGFjZSgvXFwvKyQvLCBcIlwiKX0ke3BhdGh9YDtcbn1cbmZ1bmN0aW9uIGdldEJhc2VVUkwodXJsLCBwYXRoKSB7XG4gIGlmICh1cmwpIHtcbiAgICByZXR1cm4gd2l0aFBhdGgodXJsLCBwYXRoKTtcbiAgfVxuICBjb25zdCBmcm9tRW52ID0gZW52LkJFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTkVYVF9QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5OVVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0FVVEhfVVJMIHx8IChlbnYuQkFTRV9VUkwgIT09IFwiL1wiID8gZW52LkJBU0VfVVJMIDogdm9pZCAwKTtcbiAgaWYgKGZyb21FbnYpIHtcbiAgICByZXR1cm4gd2l0aFBhdGgoZnJvbUVudiwgcGF0aCk7XG4gIH1cbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIHdpdGhQYXRoKHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sIHBhdGgpO1xuICB9XG4gIHJldHVybiB2b2lkIDA7XG59XG5mdW5jdGlvbiBnZXRPcmlnaW4odXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwub3JpZ2luO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRQcm90b2NvbCh1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5wcm90b2NvbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0SG9zdCh1cmwpIHtcbiAgaWYgKHVybC5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3Q7XG4gIH1cbiAgcmV0dXJuIHVybDtcbn1cblxuZXhwb3J0IHsgZ2V0QmFzZVVSTCwgZ2V0SG9zdCwgZ2V0T3JpZ2luLCBnZXRQcm90b2NvbCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_10__.APIError),\n/* harmony export */   BASE_ERROR_CODES: () => (/* binding */ BASE_ERROR_CODES),\n/* harmony export */   callbackOAuth: () => (/* binding */ callbackOAuth),\n/* harmony export */   changeEmail: () => (/* binding */ changeEmail),\n/* harmony export */   changePassword: () => (/* binding */ changePassword),\n/* harmony export */   createAuthEndpoint: () => (/* binding */ createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* binding */ createAuthMiddleware),\n/* harmony export */   createEmailVerificationToken: () => (/* binding */ createEmailVerificationToken),\n/* harmony export */   deleteUser: () => (/* binding */ deleteUser),\n/* harmony export */   deleteUserCallback: () => (/* binding */ deleteUserCallback),\n/* harmony export */   error: () => (/* binding */ error),\n/* harmony export */   forgetPassword: () => (/* binding */ forgetPassword),\n/* harmony export */   forgetPasswordCallback: () => (/* binding */ forgetPasswordCallback),\n/* harmony export */   freshSessionMiddleware: () => (/* binding */ freshSessionMiddleware),\n/* harmony export */   getEndpoints: () => (/* binding */ getEndpoints),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   getSessionFromCtx: () => (/* binding */ getSessionFromCtx),\n/* harmony export */   handleOAuthUserInfo: () => (/* binding */ handleOAuthUserInfo),\n/* harmony export */   linkSocialAccount: () => (/* binding */ linkSocialAccount),\n/* harmony export */   listSessions: () => (/* binding */ listSessions),\n/* harmony export */   listUserAccounts: () => (/* binding */ listUserAccounts),\n/* harmony export */   ok: () => (/* binding */ ok),\n/* harmony export */   optionsMiddleware: () => (/* binding */ optionsMiddleware),\n/* harmony export */   originCheck: () => (/* binding */ originCheck),\n/* harmony export */   originCheckMiddleware: () => (/* binding */ originCheckMiddleware),\n/* harmony export */   resetPassword: () => (/* binding */ resetPassword),\n/* harmony export */   revokeOtherSessions: () => (/* binding */ revokeOtherSessions),\n/* harmony export */   revokeSession: () => (/* binding */ revokeSession),\n/* harmony export */   revokeSessions: () => (/* binding */ revokeSessions),\n/* harmony export */   router: () => (/* binding */ router),\n/* harmony export */   sendVerificationEmail: () => (/* binding */ sendVerificationEmail),\n/* harmony export */   sendVerificationEmailFn: () => (/* binding */ sendVerificationEmailFn),\n/* harmony export */   sessionMiddleware: () => (/* binding */ sessionMiddleware),\n/* harmony export */   setPassword: () => (/* binding */ setPassword),\n/* harmony export */   signInEmail: () => (/* binding */ signInEmail),\n/* harmony export */   signInSocial: () => (/* binding */ signInSocial),\n/* harmony export */   signOut: () => (/* binding */ signOut),\n/* harmony export */   signUpEmail: () => (/* binding */ signUpEmail),\n/* harmony export */   unlinkAccount: () => (/* binding */ unlinkAccount),\n/* harmony export */   updateUser: () => (/* binding */ updateUser),\n/* harmony export */   verifyEmail: () => (/* binding */ verifyEmail)\n/* harmony export */ });\n/* harmony import */ var _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-VXDYNCOX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/.pnpm/better-call@0.3.3/node_modules/better-call/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/verify.js\");\n/* harmony import */ var jose_errors__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! jose/errors */ \"(rsc)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/util/errors.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar optionsMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createMiddleware)(async () => {\n  return {};\n});\nvar createAuthMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createMiddlewareCreator)({\n  use: [\n    optionsMiddleware,\n    /**\n     * Only use for post hooks\n     */\n    (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createMiddleware)(async () => {\n      return {};\n    })\n  ]\n});\nvar createAuthEndpoint = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createEndpointCreator)({\n  use: [optionsMiddleware]\n});\n\n// src/utils/wildcard.ts\nfunction escapeRegExpChar(char) {\n  if (char === \"-\" || char === \"^\" || char === \"$\" || char === \"+\" || char === \".\" || char === \"(\" || char === \")\" || char === \"|\" || char === \"[\" || char === \"]\" || char === \"{\" || char === \"}\" || char === \"*\" || char === \"?\" || char === \"\\\\\") {\n    return `\\\\${char}`;\n  } else {\n    return char;\n  }\n}\nfunction escapeRegExpString(str) {\n  let result = \"\";\n  for (let i = 0; i < str.length; i++) {\n    result += escapeRegExpChar(str[i]);\n  }\n  return result;\n}\nfunction transform(pattern, separator = true) {\n  if (Array.isArray(pattern)) {\n    let regExpPatterns = pattern.map((p) => `^${transform(p, separator)}$`);\n    return `(?:${regExpPatterns.join(\"|\")})`;\n  }\n  let separatorSplitter = \"\";\n  let separatorMatcher = \"\";\n  let wildcard = \".\";\n  if (separator === true) {\n    separatorSplitter = \"/\";\n    separatorMatcher = \"[/\\\\\\\\]\";\n    wildcard = \"[^/\\\\\\\\]\";\n  } else if (separator) {\n    separatorSplitter = separator;\n    separatorMatcher = escapeRegExpString(separatorSplitter);\n    if (separatorMatcher.length > 1) {\n      separatorMatcher = `(?:${separatorMatcher})`;\n      wildcard = `((?!${separatorMatcher}).)`;\n    } else {\n      wildcard = `[^${separatorMatcher}]`;\n    }\n  }\n  let requiredSeparator = separator ? `${separatorMatcher}+?` : \"\";\n  let optionalSeparator = separator ? `${separatorMatcher}*?` : \"\";\n  let segments = separator ? pattern.split(separatorSplitter) : [pattern];\n  let result = \"\";\n  for (let s = 0; s < segments.length; s++) {\n    let segment = segments[s];\n    let nextSegment = segments[s + 1];\n    let currentSeparator = \"\";\n    if (!segment && s > 0) {\n      continue;\n    }\n    if (separator) {\n      if (s === segments.length - 1) {\n        currentSeparator = optionalSeparator;\n      } else if (nextSegment !== \"**\") {\n        currentSeparator = requiredSeparator;\n      } else {\n        currentSeparator = \"\";\n      }\n    }\n    if (separator && segment === \"**\") {\n      if (currentSeparator) {\n        result += s === 0 ? \"\" : currentSeparator;\n        result += `(?:${wildcard}*?${currentSeparator})*?`;\n      }\n      continue;\n    }\n    for (let c = 0; c < segment.length; c++) {\n      let char = segment[c];\n      if (char === \"\\\\\") {\n        if (c < segment.length - 1) {\n          result += escapeRegExpChar(segment[c + 1]);\n          c++;\n        }\n      } else if (char === \"?\") {\n        result += wildcard;\n      } else if (char === \"*\") {\n        result += `${wildcard}*?`;\n      } else {\n        result += escapeRegExpChar(char);\n      }\n    }\n    result += currentSeparator;\n  }\n  return result;\n}\nfunction isMatch(regexp, sample) {\n  if (typeof sample !== \"string\") {\n    throw new TypeError(`Sample must be a string, but ${typeof sample} given`);\n  }\n  return regexp.test(sample);\n}\nfunction wildcardMatch(pattern, options) {\n  if (typeof pattern !== \"string\" && !Array.isArray(pattern)) {\n    throw new TypeError(\n      `The first argument must be a single pattern string or an array of patterns, but ${typeof pattern} given`\n    );\n  }\n  if (typeof options === \"string\" || typeof options === \"boolean\") {\n    options = { separator: options };\n  }\n  if (arguments.length === 2 && !(typeof options === \"undefined\" || typeof options === \"object\" && options !== null && !Array.isArray(options))) {\n    throw new TypeError(\n      `The second argument must be an options object or a string/boolean separator, but ${typeof options} given`\n    );\n  }\n  options = options || {};\n  if (options.separator === \"\\\\\") {\n    throw new Error(\n      \"\\\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead\"\n    );\n  }\n  let regexpPattern = transform(pattern, options.separator);\n  let regexp = new RegExp(`^${regexpPattern}$`, options.flags);\n  let fn = isMatch.bind(null, regexp);\n  fn.options = options;\n  fn.pattern = pattern;\n  fn.regexp = regexp;\n  return fn;\n}\n\n// src/api/middlewares/origin-check.ts\nvar originCheckMiddleware = createAuthMiddleware(async (ctx) => {\n  if (ctx.request?.method !== \"POST\" || !ctx.request) {\n    return;\n  }\n  const { body, query, context } = ctx;\n  const originHeader = ctx.headers?.get(\"origin\") || ctx.headers?.get(\"referer\") || \"\";\n  const callbackURL = body?.callbackURL || query?.callbackURL;\n  const redirectURL = body?.redirectTo;\n  const errorCallbackURL = body?.errorCallbackURL;\n  const newUserCallbackURL = body?.newUserCallbackURL;\n  const trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const usesCookies = ctx.headers?.has(\"cookie\");\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      return wildcardMatch(pattern)((0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getHost)(url));\n    }\n    const protocol = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getProtocol)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getOrigin)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && !url.includes(\":\")\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  if (usesCookies && !ctx.context.options.advanced?.disableCSRFCheck) {\n    validateURL(originHeader, \"origin\");\n  }\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n  redirectURL && validateURL(redirectURL, \"redirectURL\");\n  errorCallbackURL && validateURL(errorCallbackURL, \"errorCallbackURL\");\n  newUserCallbackURL && validateURL(newUserCallbackURL, \"newUserCallbackURL\");\n});\nvar originCheck = (getValue) => createAuthMiddleware(async (ctx) => {\n  if (!ctx.request) {\n    return;\n  }\n  const { context } = ctx;\n  const callbackURL = getValue(ctx);\n  const trustedOrigins = Array.isArray(\n    context.options.trustedOrigins\n  ) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      return wildcardMatch(pattern)((0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getHost)(url));\n    }\n    return url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && !url.includes(\":\")\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n});\n\n// src/error/codes.ts\nvar BASE_ERROR_CODES = {\n  USER_NOT_FOUND: \"User not found\",\n  FAILED_TO_CREATE_USER: \"Failed to create user\",\n  FAILED_TO_CREATE_SESSION: \"Failed to create session\",\n  FAILED_TO_UPDATE_USER: \"Failed to update user\",\n  FAILED_TO_GET_SESSION: \"Failed to get session\",\n  INVALID_PASSWORD: \"Invalid password\",\n  INVALID_EMAIL: \"Invalid email\",\n  INVALID_EMAIL_OR_PASSWORD: \"Invalid email or password\",\n  SOCIAL_ACCOUNT_ALREADY_LINKED: \"Social account already linked\",\n  PROVIDER_NOT_FOUND: \"Provider not found\",\n  INVALID_TOKEN: \"invalid token\",\n  ID_TOKEN_NOT_SUPPORTED: \"id_token not supported\",\n  FAILED_TO_GET_USER_INFO: \"Failed to get user info\",\n  USER_EMAIL_NOT_FOUND: \"User email not found\",\n  EMAIL_NOT_VERIFIED: \"Email not verified\",\n  PASSWORD_TOO_SHORT: \"Password too short\",\n  PASSWORD_TOO_LONG: \"Password too long\",\n  USER_ALREADY_EXISTS: \"User already exists\",\n  EMAIL_CAN_NOT_BE_UPDATED: \"Email can not be updated\",\n  CREDENTIAL_ACCOUNT_NOT_FOUND: \"Credential account not found\",\n  SESSION_EXPIRED: \"Session expired. Re-authenticate to perform this action.\",\n  FAILED_TO_UNLINK_LAST_ACCOUNT: \"You can't unlink your last account\",\n  ACCOUNT_NOT_FOUND: \"Account not found\"\n};\nvar getSession = () => createAuthEndpoint(\n  \"/get-session\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.optional(\n      zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n        /**\n         * If cookie cache is enabled, it will disable the cache\n         * and fetch the session from the database\n         */\n        disableCookieCache: zod__WEBPACK_IMPORTED_MODULE_11__.z.optional(\n          zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n            description: \"Disable cookie cache and fetch session from database\"\n          }).or(zod__WEBPACK_IMPORTED_MODULE_11__.z.string().transform((v) => v === \"true\"))\n        ).optional(),\n        disableRefresh: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n          description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n        }).or(zod__WEBPACK_IMPORTED_MODULE_11__.z.string().transform((v) => v === \"true\")).optional()\n      })\n    ),\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Get the current session\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      type: \"object\",\n                      properties: {\n                        token: {\n                          type: \"string\"\n                        },\n                        userId: {\n                          type: \"string\"\n                        },\n                        expiresAt: {\n                          type: \"string\"\n                        }\n                      }\n                    },\n                    user: {\n                      type: \"object\",\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessionCookieToken = await ctx.getSignedCookie(\n        ctx.context.authCookies.sessionToken.name,\n        ctx.context.secret\n      );\n      if (!sessionCookieToken) {\n        return ctx.json(null);\n      }\n      const sessionDataCookie = ctx.getCookie(\n        ctx.context.authCookies.sessionData.name\n      );\n      const sessionDataPayload = sessionDataCookie ? (0,_chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_7__.safeJSONParse)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_14__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__.base64.decode(sessionDataCookie))) : null;\n      if (sessionDataPayload) {\n        const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_12__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n          ctx.context.secret,\n          JSON.stringify(sessionDataPayload.session),\n          sessionDataPayload.signature\n        );\n        if (!isValid) {\n          (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n          return ctx.json(null);\n        }\n      }\n      const dontRememberMe = await ctx.getSignedCookie(\n        ctx.context.authCookies.dontRememberToken.name,\n        ctx.context.secret\n      );\n      if (sessionDataPayload?.session && ctx.context.options.session?.cookieCache?.enabled && !ctx.query?.disableCookieCache) {\n        const session2 = sessionDataPayload.session;\n        const hasExpired = sessionDataPayload.expiresAt < Date.now() || session2.session.expiresAt < /* @__PURE__ */ new Date();\n        if (!hasExpired) {\n          return ctx.json(\n            session2\n          );\n        } else {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n        }\n      }\n      const session = await ctx.context.internalAdapter.findSession(sessionCookieToken);\n      ctx.context.session = session;\n      if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n        (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n        if (session) {\n          await ctx.context.internalAdapter.deleteSession(\n            session.session.token\n          );\n        }\n        return ctx.json(null);\n      }\n      if (dontRememberMe || ctx.query?.disableRefresh) {\n        return ctx.json(\n          session\n        );\n      }\n      const expiresIn = ctx.context.sessionConfig.expiresIn;\n      const updateAge = ctx.context.sessionConfig.updateAge;\n      const sessionIsDueToBeUpdatedDate = session.session.expiresAt.valueOf() - expiresIn * 1e3 + updateAge * 1e3;\n      const shouldBeUpdated = sessionIsDueToBeUpdatedDate <= Date.now();\n      if (shouldBeUpdated) {\n        const updatedSession = await ctx.context.internalAdapter.updateSession(\n          session.session.token,\n          {\n            expiresAt: (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__.getDate)(ctx.context.sessionConfig.expiresIn, \"sec\")\n          }\n        );\n        if (!updatedSession) {\n          (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n          return ctx.json(null, { status: 401 });\n        }\n        const maxAge = (updatedSession.expiresAt.valueOf() - Date.now()) / 1e3;\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(\n          ctx,\n          {\n            session: updatedSession,\n            user: session.user\n          },\n          false,\n          {\n            maxAge\n          }\n        );\n        return ctx.json({\n          session: updatedSession,\n          user: session.user\n        });\n      }\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setCookieCache)(ctx, session);\n      return ctx.json(\n        session\n      );\n    } catch (error2) {\n      ctx.context.logger.error(\"INTERNAL_SERVER_ERROR\", error2);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n  }\n);\nvar getSessionFromCtx = async (ctx, config) => {\n  if (ctx.context.session) {\n    return ctx.context.session;\n  }\n  const session = await getSession()({\n    ...ctx,\n    _flag: \"json\",\n    headers: ctx.headers,\n    query: { ...ctx.query, ...config }\n  }).catch((e) => {\n    return null;\n  });\n  ctx.context.session = session;\n  return session;\n};\nvar sessionMiddleware = createAuthMiddleware(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nvar freshSessionMiddleware = createAuthMiddleware(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n  }\n  if (ctx.context.sessionConfig.freshAge === 0) {\n    return {\n      session\n    };\n  }\n  const freshAge = ctx.context.sessionConfig.freshAge;\n  const lastUpdated = session.session.updatedAt?.valueOf() || session.session.createdAt.valueOf();\n  const now = Date.now();\n  const isFresh = now - lastUpdated < freshAge * 1e3;\n  if (!isFresh) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", {\n      message: \"Session is not fresh\"\n    });\n  }\n  return {\n    session\n  };\n});\nvar listSessions = () => createAuthEndpoint(\n  \"/list-sessions\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"List all active sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      token: {\n                        type: \"string\"\n                      },\n                      userId: {\n                        type: \"string\"\n                      },\n                      expiresAt: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      ctx.context.session.user.id\n    );\n    const activeSessions = sessions.filter((session) => {\n      return session.expiresAt > /* @__PURE__ */ new Date();\n    });\n    return ctx.json(\n      activeSessions\n    );\n  }\n);\nvar revokeSession = createAuthEndpoint(\n  \"/revoke-session\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The token to revoke\"\n      })\n    }),\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke a single session\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  token: {\n                    type: \"string\"\n                  }\n                },\n                required: [\"token\"]\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token;\n    const findSession = await ctx.context.internalAdapter.findSession(token);\n    if (!findSession) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Session not found\"\n      });\n    }\n    if (findSession.session.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n    }\n    try {\n      await ctx.context.internalAdapter.deleteSession(token);\n    } catch (error2) {\n      ctx.context.logger.error(\n        error2 && typeof error2 === \"object\" && \"name\" in error2 ? error2.name : \"\",\n        error2\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar revokeSessions = createAuthEndpoint(\n  \"/revoke-sessions\",\n  {\n    method: \"POST\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke all sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      await ctx.context.internalAdapter.deleteSessions(\n        ctx.context.session.user.id\n      );\n    } catch (error2) {\n      ctx.context.logger.error(\n        error2 && typeof error2 === \"object\" && \"name\" in error2 ? error2.name : \"\",\n        error2\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar revokeOtherSessions = createAuthEndpoint(\n  \"/revoke-other-sessions\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Revoke all other sessions for the user except the current one\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    if (!session.user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\");\n    }\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      session.user.id\n    );\n    const activeSessions = sessions.filter((session2) => {\n      return session2.expiresAt > /* @__PURE__ */ new Date();\n    });\n    const otherSessions = activeSessions.filter(\n      (session2) => session2.token !== ctx.context.session.session.token\n    );\n    await Promise.all(\n      otherSessions.map(\n        (session2) => ctx.context.internalAdapter.deleteSession(session2.token)\n      )\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nasync function createEmailVerificationToken(secret, email, updateTo, expiresIn = 3600) {\n  const token = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__.signJWT)(\n    {\n      email: email.toLowerCase(),\n      updateTo\n    },\n    secret,\n    expiresIn\n  );\n  return token;\n}\nasync function sendVerificationEmailFn(ctx, user) {\n  if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n    ctx.context.logger.error(\"Verification email isn't enabled.\");\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n      message: \"Verification email isn't enabled\"\n    });\n  }\n  const token = await createEmailVerificationToken(\n    ctx.context.secret,\n    user.email,\n    void 0,\n    ctx.context.options.emailVerification?.expiresIn\n  );\n  const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n  await ctx.context.options.emailVerification.sendVerificationEmail(\n    {\n      user,\n      url,\n      token\n    },\n    ctx.request\n  );\n}\nvar sendVerificationEmail = createAuthEndpoint(\n  \"/send-verification-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The email to send the verification email to\"\n      }).email(),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to use for email verification callback\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a verification email to the user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  email: {\n                    type: \"string\",\n                    description: \"The email to send the verification email to\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  }\n                },\n                required: [\"email\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const { email } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (!user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.USER_NOT_FOUND\n      });\n    }\n    await sendVerificationEmailFn(ctx, user.user);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar verifyEmail = createAuthEndpoint(\n  \"/verify-email\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The token to verify the email\"\n      }),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Verify the email of the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"user\", \"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    function redirectOnError(error2) {\n      if (ctx.query.callbackURL) {\n        if (ctx.query.callbackURL.includes(\"?\")) {\n          throw ctx.redirect(`${ctx.query.callbackURL}&error=${error2}`);\n        }\n        throw ctx.redirect(`${ctx.query.callbackURL}?error=${error2}`);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: error2\n      });\n    }\n    const { token } = ctx.query;\n    let jwt;\n    try {\n      jwt = await (0,jose__WEBPACK_IMPORTED_MODULE_15__.jwtVerify)(\n        token,\n        new TextEncoder().encode(ctx.context.secret),\n        {\n          algorithms: [\"HS256\"]\n        }\n      );\n    } catch (e) {\n      if (e instanceof jose_errors__WEBPACK_IMPORTED_MODULE_16__.JWTExpired) {\n        return redirectOnError(\"token_expired\");\n      }\n      return redirectOnError(\"invalid_token\");\n    }\n    const schema2 = zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().email(),\n      updateTo: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    });\n    const parsed = schema2.parse(jwt.payload);\n    const user = await ctx.context.internalAdapter.findUserByEmail(\n      parsed.email\n    );\n    if (!user) {\n      return redirectOnError(\"user_not_found\");\n    }\n    if (parsed.updateTo) {\n      const session = await getSessionFromCtx(ctx);\n      if (!session) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      if (session.user.email !== parsed.email) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      const updatedUser = await ctx.context.internalAdapter.updateUserByEmail(\n        parsed.email,\n        {\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      );\n      const newToken = await createEmailVerificationToken(\n        ctx.context.secret,\n        parsed.updateTo\n      );\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: updatedUser,\n          url: `${ctx.context.baseURL}/verify-email?token=${newToken}`,\n          token: newToken\n        },\n        ctx.request\n      );\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n        session: session.session,\n        user: {\n          ...session.user,\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      });\n      if (ctx.query.callbackURL) {\n        throw ctx.redirect(ctx.query.callbackURL);\n      }\n      return ctx.json({\n        status: true,\n        user: {\n          id: updatedUser.id,\n          email: updatedUser.email,\n          name: updatedUser.name,\n          image: updatedUser.image,\n          emailVerified: updatedUser.emailVerified,\n          createdAt: updatedUser.createdAt,\n          updatedAt: updatedUser.updatedAt\n        }\n      });\n    }\n    await ctx.context.internalAdapter.updateUserByEmail(parsed.email, {\n      emailVerified: true\n    });\n    if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n      const currentSession = await getSessionFromCtx(ctx);\n      if (!currentSession || currentSession.user.email !== parsed.email) {\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx.request\n        );\n        if (!session) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\", {\n            message: \"Failed to create session\"\n          });\n        }\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n          session,\n          user: {\n            ...user.user,\n            emailVerified: true\n          }\n        });\n      } else {\n        await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n          session: currentSession.session,\n          user: {\n            ...currentSession.user,\n            emailVerified: true\n          }\n        });\n      }\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL);\n    }\n    return ctx.json({\n      status: true,\n      user: null\n    });\n  }\n);\n\n// src/oauth2/link-account.ts\nasync function handleOAuthUserInfo(c, {\n  userInfo,\n  account,\n  callbackURL\n}) {\n  const dbUser = await c.context.internalAdapter.findOAuthUser(\n    userInfo.email.toLowerCase(),\n    account.accountId,\n    account.providerId\n  ).catch((e) => {\n    _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n      \"Better auth was unable to query your database.\\nError: \",\n      e\n    );\n    throw c.redirect(\n      `${c.context.baseURL}/error?error=internal_server_error`\n    );\n  });\n  let user = dbUser?.user;\n  let isRegister = !user;\n  if (dbUser) {\n    const hasBeenLinked = dbUser.accounts.find(\n      (a) => a.providerId === account.providerId\n    );\n    if (!hasBeenLinked) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        account.providerId\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__.isDevelopment) {\n          _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.warn(\n            `User already exist but account isn't linked to ${account.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`\n          );\n        }\n        return {\n          error: \"account not linked\",\n          data: null\n        };\n      }\n      try {\n        await c.context.internalAdapter.linkAccount({\n          providerId: account.providerId,\n          accountId: userInfo.id.toString(),\n          userId: dbUser.user.id,\n          accessToken: account.accessToken,\n          idToken: account.idToken,\n          refreshToken: account.refreshToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope\n        });\n      } catch (e) {\n        _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Unable to link account\", e);\n        return {\n          error: \"unable to link account\",\n          data: null\n        };\n      }\n    } else {\n      const updateData = Object.fromEntries(\n        Object.entries({\n          accessToken: account.accessToken,\n          idToken: account.idToken,\n          refreshToken: account.refreshToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope\n        }).filter(([_, value]) => value !== void 0)\n      );\n      if (Object.keys(updateData).length > 0) {\n        await c.context.internalAdapter.updateAccount(\n          hasBeenLinked.id,\n          updateData\n        );\n      }\n    }\n  } else {\n    try {\n      user = await c.context.internalAdapter.createOAuthUser(\n        {\n          ...userInfo,\n          email: userInfo.email.toLowerCase(),\n          id: void 0\n        },\n        {\n          accessToken: account.accessToken,\n          idToken: account.idToken,\n          refreshToken: account.refreshToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope,\n          providerId: account.providerId,\n          accountId: userInfo.id.toString()\n        }\n      ).then((res) => res?.user);\n      if (!userInfo.emailVerified && user && c.context.options.emailVerification?.sendOnSignUp) {\n        const token = await createEmailVerificationToken(\n          c.context.secret,\n          user.email,\n          void 0,\n          c.context.options.emailVerification?.expiresIn\n        );\n        const url = `${c.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n        await c.context.options.emailVerification?.sendVerificationEmail?.(\n          {\n            user,\n            url,\n            token\n          },\n          c.request\n        );\n      }\n    } catch (e) {\n      _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger.error(e);\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n        return {\n          error: e.message,\n          data: null,\n          isRegister: false\n        };\n      }\n      return {\n        error: \"unable to create user\",\n        data: null,\n        isRegister: false\n      };\n    }\n  }\n  if (!user) {\n    return {\n      error: \"unable to create user\",\n      data: null,\n      isRegister: false\n    };\n  }\n  const session = await c.context.internalAdapter.createSession(\n    user.id,\n    c.request\n  );\n  if (!session) {\n    return {\n      error: \"unable to create session\",\n      data: null,\n      isRegister: false\n    };\n  }\n  return {\n    data: {\n      session,\n      user\n    },\n    error: null,\n    isRegister\n  };\n}\n\n// src/api/routes/sign-in.ts\nvar signInSocial = createAuthEndpoint(\n  \"/sign-in/social\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * Callback URL to redirect to after the user\n       * has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Callback URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * callback url to redirect if the user is newly registered.\n       *\n       * useful if you have different routes for existing users and new users\n       */\n      newUserCallbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n      /**\n       * Callback url to redirect to if an error happens\n       *\n       * If it's initiated from the client sdk this defaults to\n       * the current url.\n       */\n      errorCallbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Callback URL to redirect to if an error happens\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_0__.SocialProviderListEnum,\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional(),\n      /**\n       * ID token from the provider\n       *\n       * This is used to sign in the user\n       * if the user is already signed in with the\n       * provider in the frontend.\n       *\n       * Only applicable if the provider supports\n       * it. Currently only `apple` and `google` is\n       * supported out of the box.\n       */\n      idToken: zod__WEBPACK_IMPORTED_MODULE_11__.z.optional(\n        zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n          /**\n           * ID token from the provider\n           */\n          token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"ID token from the provider\"\n          }),\n          /**\n           * The nonce used to generate the token\n           */\n          nonce: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"Nonce used to generate the token\"\n          }).optional(),\n          /**\n           * Access token from the provider\n           */\n          accessToken: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"Access token from the provider\"\n          }).optional(),\n          /**\n           * Refresh token from the provider\n           */\n          refreshToken: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n            description: \"Refresh token from the provider\"\n          }).optional(),\n          /**\n           * Expiry date of the token\n           */\n          expiresAt: zod__WEBPACK_IMPORTED_MODULE_11__.z.number({\n            description: \"Expiry date of the token\"\n          }).optional()\n        }),\n        {\n          description: \"ID token from the provider to sign in the user with id token\"\n        }\n      )\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with a social provider\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      type: \"string\"\n                    },\n                    user: {\n                      type: \"object\"\n                    },\n                    url: {\n                      type: \"string\"\n                    },\n                    redirect: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"session\", \"user\", \"url\", \"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n          message: BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: BASE_ERROR_CODES.INVALID_TOKEN\n        });\n      }\n      const userInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!userInfo || !userInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n        });\n      }\n      if (!userInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const data = await handleOAuthUserInfo(c, {\n        userInfo: {\n          email: userInfo.user.email,\n          id: userInfo.user.id,\n          name: userInfo.user.name || \"\",\n          image: userInfo.user.image,\n          emailVerified: userInfo.user.emailVerified || false\n        },\n        account: {\n          providerId: provider.id,\n          accountId: userInfo.user.id,\n          accessToken: c.body.idToken.accessToken\n        }\n      });\n      if (data.error) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n          message: data.error\n        });\n      }\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(c, data.data);\n      return c.json({\n        redirect: false,\n        token: data.data.session.token,\n        url: void 0,\n        user: {\n          id: data.data.user.id,\n          email: data.data.user.email,\n          name: data.data.user.name,\n          image: data.data.user.image,\n          emailVerified: data.data.user.emailVerified,\n          createdAt: data.data.user.createdAt,\n          updatedAt: data.data.user.updatedAt\n        }\n      });\n    }\n    const { codeVerifier, state } = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__.generateState)(c);\n    const url = await provider.createAuthorizationURL({\n      state,\n      codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nvar signInEmail = createAuthEndpoint(\n  \"/sign-in/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * Email of the user\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Email of the user\"\n      }),\n      /**\n       * Password of the user\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Password of the user\"\n      }),\n      /**\n       * Callback URL to use as a redirect for email\n       * verification and for possible redirects\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"Callback URL to use as a redirect for email verification\"\n      }).optional(),\n      /**\n       * If this is false, the session will not be remembered\n       * @default true\n       */\n      rememberMe: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n        description: \"If this is false, the session will not be remembered. Default is `true`.\"\n      }).default(true).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with email and password\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    },\n                    url: {\n                      type: \"string\"\n                    },\n                    redirect: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"session\", \"user\", \"url\", \"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options?.emailAndPassword?.enabled) {\n      ctx.context.logger.error(\n        \"Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password is not enabled\"\n      });\n    }\n    const { email, password } = ctx.body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_11__.z.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      await ctx.context.password.hash(password);\n      ctx.context.logger.error(\"User not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const credentialAccount = user.accounts.find(\n      (a) => a.providerId === \"credential\"\n    );\n    if (!credentialAccount) {\n      ctx.context.logger.error(\"Credential account not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const currentPassword = credentialAccount?.password;\n    if (!currentPassword) {\n      ctx.context.logger.error(\"Password not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const validPassword = await ctx.context.password.verify({\n      hash: currentPassword,\n      password\n    });\n    if (!validPassword) {\n      ctx.context.logger.error(\"Invalid password\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    if (ctx.context.options?.emailAndPassword?.requireEmailVerification && !user.user.emailVerified) {\n      if (!ctx.context.options?.emailVerification?.sendVerificationEmail) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", {\n          message: BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n        });\n      }\n      const token = await createEmailVerificationToken(\n        ctx.context.secret,\n        user.user.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.emailVerification.sendVerificationEmail(\n        {\n          user: user.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FORBIDDEN\", {\n        message: BASE_ERROR_CODES.EMAIL_NOT_VERIFIED\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      user.user.id,\n      ctx.headers,\n      ctx.body.rememberMe === false\n    );\n    if (!session) {\n      ctx.context.logger.error(\"Failed to create session\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNAUTHORIZED\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(\n      ctx,\n      {\n        session,\n        user: user.user\n      },\n      ctx.body.rememberMe === false\n    );\n    return ctx.json({\n      redirect: !!ctx.body.callbackURL,\n      token: session.token,\n      url: ctx.body.callbackURL,\n      user: {\n        id: user.user.id,\n        email: user.user.email,\n        name: user.user.name,\n        image: user.user.image,\n        emailVerified: user.user.emailVerified,\n        createdAt: user.user.createdAt,\n        updatedAt: user.user.updatedAt\n      }\n    });\n  }\n);\nvar schema = zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n  code: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n  error: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n  error_description: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n  state: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n});\nvar callbackOAuth = createAuthEndpoint(\n  \"/callback/:id\",\n  {\n    method: [\"GET\", \"POST\"],\n    body: schema.optional(),\n    query: schema.optional(),\n    metadata: _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.HIDE_METADATA\n  },\n  async (c) => {\n    let queryOrBody;\n    try {\n      if (c.method === \"GET\") {\n        queryOrBody = schema.parse(c.query);\n      } else if (c.method === \"POST\") {\n        queryOrBody = schema.parse(c.body);\n      } else {\n        throw new Error(\"Unsupported method\");\n      }\n    } catch (e) {\n      c.context.logger.error(\"INVALID_CALLBACK_REQUEST\", e);\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=invalid_callback_request`\n      );\n    }\n    const { code, error: error2, state, error_description } = queryOrBody;\n    if (!state) {\n      c.context.logger.error(\"State not found\", error2);\n      throw c.redirect(`${c.context.baseURL}/error?error=state_not_found`);\n    }\n    if (!code) {\n      c.context.logger.error(\"Code not found\");\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=${error2 || \"no_code\"}&error_description=${error_description}`\n      );\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.params.id\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Oauth provider with id\",\n        c.params.id,\n        \"not found\"\n      );\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=oauth_provider_not_found`\n      );\n    }\n    const { codeVerifier, callbackURL, link, errorURL, newUserURL } = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__.parseState)(c);\n    let tokens;\n    try {\n      tokens = await provider.validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n      });\n    } catch (e) {\n      c.context.logger.error(\"\", e);\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=please_restart_the_process`\n      );\n    }\n    const userInfo = await provider.getUserInfo(tokens).then((res) => res?.user);\n    function redirectOnError(error3) {\n      let url = errorURL || callbackURL || `${c.context.baseURL}/error`;\n      if (url.includes(\"?\")) {\n        url = `${url}&error=${error3}`;\n      } else {\n        url = `${url}?error=${error3}`;\n      }\n      throw c.redirect(url);\n    }\n    if (!userInfo) {\n      c.context.logger.error(\"Unable to get user info\");\n      return redirectOnError(\"unable_to_get_user_info\");\n    }\n    if (!userInfo.email) {\n      c.context.logger.error(\n        \"Provider did not return email. This could be due to misconfiguration in the provider settings.\"\n      );\n      return redirectOnError(\"email_not_found\");\n    }\n    if (!callbackURL) {\n      c.context.logger.error(\"No callback URL found\");\n      throw c.redirect(\n        `${c.context.baseURL}/error?error=please_restart_the_process`\n      );\n    }\n    if (link) {\n      if (c.context.options.account?.accountLinking?.allowDifferentEmails !== true && link.email !== userInfo.email.toLowerCase()) {\n        return redirectOnError(\"email_doesn't_match\");\n      }\n      const existingAccount = await c.context.internalAdapter.findAccount(\n        userInfo.id\n      );\n      if (existingAccount) {\n        if (existingAccount && existingAccount.userId !== link.userId) {\n          return redirectOnError(\"account_already_linked_to_different_user\");\n        }\n        return redirectOnError(\"account_already_linked\");\n      }\n      const newAccount = await c.context.internalAdapter.createAccount({\n        userId: link.userId,\n        providerId: provider.id,\n        accountId: userInfo.id,\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      });\n      if (!newAccount) {\n        return redirectOnError(\"unable_to_link_account\");\n      }\n      let toRedirectTo2;\n      try {\n        const url = callbackURL;\n        toRedirectTo2 = url.toString();\n      } catch {\n        toRedirectTo2 = callbackURL;\n      }\n      throw c.redirect(toRedirectTo2);\n    }\n    const result = await handleOAuthUserInfo(c, {\n      userInfo: {\n        ...userInfo,\n        email: userInfo.email,\n        name: userInfo.name || userInfo.email\n      },\n      account: {\n        providerId: provider.id,\n        accountId: userInfo.id,\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      },\n      callbackURL\n    });\n    if (result.error) {\n      c.context.logger.error(result.error.split(\" \").join(\"_\"));\n      return redirectOnError(result.error.split(\" \").join(\"_\"));\n    }\n    const { session, user } = result.data;\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(c, {\n      session,\n      user\n    });\n    let toRedirectTo;\n    try {\n      const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n      toRedirectTo = url.toString();\n    } catch {\n      toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n    }\n    throw c.redirect(toRedirectTo);\n  }\n);\nvar signOut = createAuthEndpoint(\n  \"/sign-out\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Sign out the current user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessionCookieToken = await ctx.getSignedCookie(\n      ctx.context.authCookies.sessionToken.name,\n      ctx.context.secret\n    );\n    if (!sessionCookieToken) {\n      (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n    await ctx.context.internalAdapter.deleteSession(sessionCookieToken);\n    (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n    return ctx.json({\n      success: true\n    });\n  }\n);\nfunction redirectError(ctx, callbackURL, query) {\n  const url = callbackURL ? new URL(callbackURL, ctx.baseURL) : new URL(`${ctx.baseURL}/error`);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nfunction redirectCallback(ctx, callbackURL, query) {\n  const url = new URL(callbackURL, ctx.baseURL);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nvar forgetPassword = createAuthEndpoint(\n  \"/forget-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The email address of the user to send a password reset email to\"\n      }).email(),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPasswordToken function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json(\n        {\n          status: false\n        },\n        {\n          body: {\n            status: true\n          }\n        }\n      );\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_8__.getDate)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.generateId)(24);\n    await ctx.context.internalAdapter.createVerificationValue({\n      value: user.user.id.toString(),\n      identifier: `reset-password:${verificationToken}`,\n      expiresAt\n    });\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${redirectTo}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar forgetPasswordCallback = createAuthEndpoint(\n  \"/reset-password/:token\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect the user to reset their password\"\n      })\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Redirects the user to the callback URL with the token\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { token } = ctx.params;\n    const { callbackURL } = ctx.query;\n    if (!token || !callbackURL) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    const verification = await ctx.context.internalAdapter.findVerificationValue(\n      `reset-password:${token}`\n    );\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    throw ctx.redirect(redirectCallback(ctx.context, callbackURL, { token }));\n  }\n);\nvar resetPassword = createAuthEndpoint(\n  \"/reset-password\",\n  {\n    method: \"POST\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    }).optional(),\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The new password to set\"\n      }),\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The token to reset the password\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Reset the password for a user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token || ctx.query?.token;\n    if (!token) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const { newPassword } = ctx.body;\n    const minLength = ctx.context.password?.config.minPasswordLength;\n    const maxLength = ctx.context.password?.config.maxPasswordLength;\n    if (newPassword.length < minLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    if (newPassword.length > maxLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const id = `reset-password:${token}`;\n    const verification = await ctx.context.internalAdapter.findVerificationValue(id);\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    await ctx.context.internalAdapter.deleteVerificationValue(verification.id);\n    const userId = verification.value;\n    const hashedPassword = await ctx.context.password.hash(newPassword);\n    const accounts = await ctx.context.internalAdapter.findAccounts(userId);\n    const account = accounts.find((ac) => ac.providerId === \"credential\");\n    if (!account) {\n      await ctx.context.internalAdapter.createAccount({\n        userId,\n        providerId: \"credential\",\n        password: hashedPassword,\n        accountId: userId\n      });\n      return ctx.json({\n        status: true\n      });\n    }\n    await ctx.context.internalAdapter.updatePassword(userId, hashedPassword);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar updateUser = () => createAuthEndpoint(\n  \"/update-user\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.record(zod__WEBPACK_IMPORTED_MODULE_11__.z.string(), zod__WEBPACK_IMPORTED_MODULE_11__.z.any()),\n    use: [sessionMiddleware],\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Update the current user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The image of the user\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const body = ctx.body;\n    if (body.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.EMAIL_CAN_NOT_BE_UPDATED\n      });\n    }\n    const { name, image, ...rest } = body;\n    const session = ctx.context.session;\n    if (image === void 0 && name === void 0 && Object.keys(rest).length === 0) {\n      return ctx.json({\n        status: true\n      });\n    }\n    const additionalFields = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.parseUserInput)(\n      ctx.context.options,\n      rest,\n      \"update\"\n    );\n    const user = await ctx.context.internalAdapter.updateUser(\n      session.user.id,\n      {\n        name,\n        image,\n        ...additionalFields\n      }\n    );\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n      session: session.session,\n      user\n    });\n    return ctx.json({\n      status: true\n    });\n  }\n);\nvar changePassword = createAuthEndpoint(\n  \"/change-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The new password to set\"\n      }),\n      /**\n       * The current password of the user\n       */\n      currentPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The current password\"\n      }),\n      /**\n       * revoke all sessions that are not the\n       * current one logged in by the user\n       */\n      revokeOtherSessions: zod__WEBPACK_IMPORTED_MODULE_11__.z.boolean({\n        description: \"Revoke all other sessions\"\n      }).optional()\n    }),\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Change the password of the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      description: \"The user object\",\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { newPassword, currentPassword, revokeOtherSessions: revokeOtherSessions2 } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    if (!account || !account.password) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n      });\n    }\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    const verify = await ctx.context.password.verify({\n      hash: account.password,\n      password: currentPassword\n    });\n    if (!verify) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_PASSWORD\n      });\n    }\n    await ctx.context.internalAdapter.updateAccount(account.id, {\n      password: passwordHash\n    });\n    let token = null;\n    if (revokeOtherSessions2) {\n      await ctx.context.internalAdapter.deleteSessions(session.user.id);\n      const newSession = await ctx.context.internalAdapter.createSession(\n        session.user.id,\n        ctx.headers\n      );\n      if (!newSession) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n        });\n      }\n      await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n        session: newSession,\n        user: session.user\n      });\n      token = newSession.token;\n    }\n    return ctx.json({\n      token,\n      user: {\n        id: session.user.id,\n        email: session.user.email,\n        name: session.user.name,\n        image: session.user.image,\n        emailVerified: session.user.emailVerified,\n        createdAt: session.user.createdAt,\n        updatedAt: session.user.updatedAt\n      }\n    });\n  }\n);\nvar setPassword = createAuthEndpoint(\n  \"/set-password\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod__WEBPACK_IMPORTED_MODULE_11__.z.string()\n    }),\n    metadata: {\n      SERVER_ONLY: true\n    },\n    use: [sessionMiddleware]\n  },\n  async (ctx) => {\n    const { newPassword } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    if (!account) {\n      await ctx.context.internalAdapter.linkAccount({\n        userId: session.user.id,\n        providerId: \"credential\",\n        accountId: session.user.id,\n        password: passwordHash\n      });\n      return ctx.json({\n        status: true\n      });\n    }\n    throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n      message: \"user already has a password\"\n    });\n  }\n);\nvar deleteUser = createAuthEndpoint(\n  \"/delete-user\",\n  {\n    method: \"POST\",\n    use: [sessionMiddleware],\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * The callback URL to redirect to after the user is deleted\n       * this is only used on delete user callback\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n      /**\n       * The password of the user. If the password isn't provided, session freshness\n       * will be checked.\n       */\n      password: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional(),\n      /**\n       * The token to delete the user. If the token is provided, the user will be deleted\n       */\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Delete the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\",\n        {\n          session: ctx.context.session\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\");\n    }\n    const session = ctx.context.session;\n    if (ctx.body.password) {\n      const accounts = await ctx.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const account = accounts.find(\n        (account2) => account2.providerId === \"credential\" && account2.password\n      );\n      if (!account || !account.password) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n          message: BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND\n        });\n      }\n      const verify = await ctx.context.password.verify({\n        hash: account.password,\n        password: ctx.body.password\n      });\n      if (!verify) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n          message: BASE_ERROR_CODES.INVALID_PASSWORD\n        });\n      }\n    } else {\n      if (ctx.context.options.session?.freshAge) {\n        const currentAge = session.session.createdAt.getTime();\n        const freshAge = ctx.context.options.session.freshAge;\n        const now = Date.now();\n        if (now - currentAge > freshAge) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n            message: BASE_ERROR_CODES.SESSION_EXPIRED\n          });\n        }\n      }\n    }\n    if (ctx.body.token) {\n      await deleteUserCallback({\n        ...ctx,\n        query: {\n          token: ctx.body.token\n        }\n      });\n      return ctx.json({\n        success: true,\n        message: \"User deleted\"\n      });\n    }\n    if (ctx.context.options.user.deleteUser?.sendDeleteAccountVerification) {\n      const token = (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_6__.generateRandomString)(32, \"0-9\", \"a-z\");\n      await ctx.context.internalAdapter.createVerificationValue({\n        value: session.user.id,\n        identifier: `delete-account-${token}`,\n        expiresAt: new Date(Date.now() + 1e3 * 60 * 60 * 24)\n      });\n      const url = `${ctx.context.baseURL}/delete-user/callback?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.user.deleteUser.sendDeleteAccountVerification(\n        {\n          user: session.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      return ctx.json({\n        success: true,\n        message: \"Verification email sent\"\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nvar deleteUserCallback = createAuthEndpoint(\n  \"/delete-user/callback\",\n  {\n    method: \"GET\",\n    query: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      token: zod__WEBPACK_IMPORTED_MODULE_11__.z.string(),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string().optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)]\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\");\n    }\n    const session = await getSessionFromCtx(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO\n      });\n    }\n    const token = await ctx.context.internalAdapter.findVerificationValue(\n      `delete-account-${ctx.query.token}`\n    );\n    if (!token || token.expiresAt < /* @__PURE__ */ new Date()) {\n      if (token) {\n        await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    if (token.value !== session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.INVALID_TOKEN\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n    (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.deleteSessionCookie)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL || \"/\");\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nvar changeEmail = createAuthEndpoint(\n  \"/change-email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      newEmail: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The new email to set\"\n      }).email(),\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.changeEmail?.enabled) {\n      ctx.context.logger.error(\"Change email is disabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Change email is disabled\"\n      });\n    }\n    if (ctx.body.newEmail === ctx.context.session.user.email) {\n      ctx.context.logger.error(\"Email is the same\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Email is the same\"\n      });\n    }\n    const existingUser = await ctx.context.internalAdapter.findUserByEmail(\n      ctx.body.newEmail\n    );\n    if (existingUser) {\n      ctx.context.logger.error(\"Email already exists\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Couldn't update your email\"\n      });\n    }\n    if (ctx.context.session.user.emailVerified !== true) {\n      await ctx.context.internalAdapter.updateUserByEmail(\n        ctx.context.session.user.email,\n        {\n          email: ctx.body.newEmail\n        }\n      );\n      return ctx.json({\n        status: true\n      });\n    }\n    if (!ctx.context.options.user.changeEmail.sendChangeEmailVerification) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const token = await createEmailVerificationToken(\n      ctx.context.secret,\n      ctx.context.session.user.email,\n      ctx.body.newEmail,\n      ctx.context.options.emailVerification?.expiresIn\n    );\n    const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n    await ctx.context.options.user.changeEmail.sendChangeEmailVerification(\n      {\n        user: ctx.context.session.user,\n        newEmail: ctx.body.newEmail,\n        url,\n        token\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n// src/api/routes/error.ts\nfunction sanitize(input) {\n  return input.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\");\n}\nvar html = (errorCode = \"Unknown\") => `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Authentication Error</title>\n    <style>\n        :root {\n            --bg-color: #f8f9fa;\n            --text-color: #212529;\n            --accent-color: #000000;\n            --error-color: #dc3545;\n            --border-color: #e9ecef;\n        }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            line-height: 1.5;\n        }\n        .error-container {\n            background-color: #ffffff;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n            padding: 2.5rem;\n            text-align: center;\n            max-width: 90%;\n            width: 400px;\n        }\n        h1 {\n            color: var(--error-color);\n            font-size: 1.75rem;\n            margin-bottom: 1rem;\n            font-weight: 600;\n        }\n        p {\n            margin-bottom: 1.5rem;\n            color: #495057;\n        }\n        .btn {\n            background-color: var(--accent-color);\n            color: #ffffff;\n            text-decoration: none;\n            padding: 0.75rem 1.5rem;\n            border-radius: 6px;\n            transition: all 0.3s ease;\n            display: inline-block;\n            font-weight: 500;\n            border: 2px solid var(--accent-color);\n        }\n        .btn:hover {\n            background-color: #131721;\n        }\n        .error-code {\n            font-size: 0.875rem;\n            color: #6c757d;\n            margin-top: 1.5rem;\n            padding-top: 1.5rem;\n            border-top: 1px solid var(--border-color);\n        }\n        .icon {\n            font-size: 3rem;\n            margin-bottom: 1rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"error-container\">\n        <div class=\"icon\">\\u26A0\\uFE0F</div>\n        <h1>Better Auth Error</h1>\n        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>\n        <a href=\"/\" id=\"returnLink\" class=\"btn\">Return to Application</a>\n        <div class=\"error-code\">Error Code: <span id=\"errorCode\">${sanitize(\n  errorCode\n)}</span></div>\n    </div>\n</body>\n</html>`;\nvar error = createAuthEndpoint(\n  \"/error\",\n  {\n    method: \"GET\",\n    metadata: {\n      ..._chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.HIDE_METADATA,\n      openapi: {\n        description: \"Displays an error page\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"text/html\": {\n                schema: {\n                  type: \"string\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const query = new URL(c.request?.url || \"\").searchParams.get(\"error\") || \"Unknown\";\n    return new Response(html(query), {\n      headers: {\n        \"Content-Type\": \"text/html\"\n      }\n    });\n  }\n);\n\n// src/api/routes/ok.ts\nvar ok = createAuthEndpoint(\n  \"/ok\",\n  {\n    method: \"GET\",\n    metadata: {\n      ..._chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.HIDE_METADATA,\n      openapi: {\n        description: \"Check if the API is working\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    ok: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    return ctx.json({\n      ok: true\n    });\n  }\n);\nvar signUpEmail = () => createAuthEndpoint(\n  \"/sign-up/email\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.record(zod__WEBPACK_IMPORTED_MODULE_11__.z.string(), zod__WEBPACK_IMPORTED_MODULE_11__.z.any()),\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Sign up a user using email and password\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  email: {\n                    type: \"string\",\n                    description: \"The email of the user\"\n                  },\n                  password: {\n                    type: \"string\",\n                    description: \"The password of the user\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  }\n                },\n                required: [\"name\", \"email\", \"password\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    id: {\n                      type: \"string\",\n                      description: \"The id of the user\"\n                    },\n                    email: {\n                      type: \"string\",\n                      description: \"The email of the user\"\n                    },\n                    name: {\n                      type: \"string\",\n                      description: \"The name of the user\"\n                    },\n                    image: {\n                      type: \"string\",\n                      description: \"The image of the user\"\n                    },\n                    emailVerified: {\n                      type: \"boolean\",\n                      description: \"If the email is verified\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.enabled) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password sign up is not enabled\"\n      });\n    }\n    const body = ctx.body;\n    const { name, email, password, image, callbackURL, ...additionalFields } = body;\n    const isValidEmail = zod__WEBPACK_IMPORTED_MODULE_11__.z.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.INVALID_EMAIL\n      });\n    }\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (password.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (password.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.PASSWORD_TOO_LONG\n      });\n    }\n    const dbUser = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (dbUser?.user) {\n      ctx.context.logger.info(`Sign-up attempt for existing email: ${email}`);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: BASE_ERROR_CODES.USER_ALREADY_EXISTS\n      });\n    }\n    const additionalData = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.parseUserInput)(\n      ctx.context.options,\n      additionalFields\n    );\n    let createdUser;\n    try {\n      createdUser = await ctx.context.internalAdapter.createUser({\n        email: email.toLowerCase(),\n        name,\n        image,\n        ...additionalData,\n        emailVerified: false\n      });\n      if (!createdUser) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n          message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n        });\n      }\n    } catch (e) {\n      if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_9__.isDevelopment) {\n        ctx.context.logger.error(\"Failed to create user\", e);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER,\n        details: e\n      });\n    }\n    if (!createdUser) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER\n      });\n    }\n    const hash = await ctx.context.password.hash(password);\n    await ctx.context.internalAdapter.linkAccount({\n      userId: createdUser.id,\n      providerId: \"credential\",\n      accountId: createdUser.id,\n      password: hash\n    });\n    if (ctx.context.options.emailVerification?.sendOnSignUp || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      const token = await createEmailVerificationToken(\n        ctx.context.secret,\n        createdUser.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${body.callbackURL || \"/\"}`;\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: createdUser,\n          url,\n          token\n        },\n        ctx.request\n      );\n    }\n    if (ctx.context.options.emailAndPassword.autoSignIn === false || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      return ctx.json({\n        token: null,\n        user: {\n          id: createdUser.id,\n          email: createdUser.email,\n          name: createdUser.name,\n          image: createdUser.image,\n          emailVerified: createdUser.emailVerified,\n          createdAt: createdUser.createdAt,\n          updatedAt: createdUser.updatedAt\n        }\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      createdUser.id,\n      ctx.request\n    );\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_2__.setSessionCookie)(ctx, {\n      session,\n      user: createdUser\n    });\n    return ctx.json({\n      token: session.token,\n      user: {\n        id: createdUser.id,\n        email: createdUser.email,\n        name: createdUser.name,\n        image: createdUser.image,\n        emailVerified: createdUser.emailVerified,\n        createdAt: createdUser.createdAt,\n        updatedAt: createdUser.updatedAt\n      }\n    });\n  }\n);\nvar listUserAccounts = createAuthEndpoint(\n  \"/list-accounts\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"List all accounts linked to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      id: {\n                        type: \"string\"\n                      },\n                      provider: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const accounts = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    return c.json(\n      accounts.map((a) => {\n        return {\n          id: a.id,\n          provider: a.providerId,\n          createdAt: a.createdAt,\n          updatedAt: a.updatedAt,\n          accountId: a.accountId,\n          scopes: a.scope?.split(\",\") || []\n        };\n      })\n    );\n  }\n);\nvar linkSocialAccount = createAuthEndpoint(\n  \"/link-social\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      /**\n       * Callback URL to redirect to after the user has signed in.\n       */\n      callbackURL: zod__WEBPACK_IMPORTED_MODULE_11__.z.string({\n        description: \"The URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: zod__WEBPACK_IMPORTED_MODULE_11__.z[\"enum\"](_chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_0__.socialProviderList, {\n        description: \"The OAuth2 provider to use\"\n      })\n    }),\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Link a social account to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    url: {\n                      type: \"string\"\n                    },\n                    redirect: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"url\", \"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const account = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const existingAccount = account.find(\n      (a) => a.providerId === c.body.provider\n    );\n    if (existingAccount) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.SOCIAL_ACCOUNT_ALREADY_LINKED\n      });\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"NOT_FOUND\", {\n        message: BASE_ERROR_CODES.PROVIDER_NOT_FOUND\n      });\n    }\n    const state = await (0,_chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_5__.generateState)(c, {\n      userId: session.user.id,\n      email: session.user.email\n    });\n    const url = await provider.createAuthorizationURL({\n      state: state.state,\n      codeVerifier: state.codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: true\n    });\n  }\n);\nvar unlinkAccount = createAuthEndpoint(\n  \"/unlink-account\",\n  {\n    method: \"POST\",\n    body: zod__WEBPACK_IMPORTED_MODULE_11__.z.object({\n      providerId: zod__WEBPACK_IMPORTED_MODULE_11__.z.string()\n    }),\n    use: [freshSessionMiddleware]\n  },\n  async (ctx) => {\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      ctx.context.session.user.id\n    );\n    if (accounts.length === 1) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.FAILED_TO_UNLINK_LAST_ACCOUNT\n      });\n    }\n    const accountExist = accounts.find(\n      (account) => account.providerId === ctx.body.providerId\n    );\n    if (!accountExist) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"BAD_REQUEST\", {\n        message: BASE_ERROR_CODES.ACCOUNT_NOT_FOUND\n      });\n    }\n    await ctx.context.internalAdapter.deleteAccount(\n      ctx.body.providerId,\n      ctx.context.session.user.id\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n// src/api/rate-limiter/index.ts\nfunction shouldRateLimit(max, window, rateLimitData) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  const timeSinceLastRequest = now - rateLimitData.lastRequest;\n  return timeSinceLastRequest < windowInMs && rateLimitData.count >= max;\n}\nfunction rateLimitResponse(retryAfter) {\n  return new Response(\n    JSON.stringify({\n      message: \"Too many requests. Please try again later.\"\n    }),\n    {\n      status: 429,\n      statusText: \"Too Many Requests\",\n      headers: {\n        \"X-Retry-After\": retryAfter.toString()\n      }\n    }\n  );\n}\nfunction getRetryAfter(lastRequest, window) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  return Math.ceil((lastRequest + windowInMs - now) / 1e3);\n}\nfunction createDBStorage(ctx, modelName) {\n  const model = ctx.options.rateLimit?.modelName || \"rateLimit\";\n  const db = ctx.adapter;\n  return {\n    get: async (key) => {\n      const res = await db.findMany({\n        model,\n        where: [{ field: \"key\", value: key }]\n      });\n      const data = res[0];\n      if (typeof data?.lastRequest === \"bigint\") {\n        data.lastRequest = Number(data.lastRequest);\n      }\n      return data;\n    },\n    set: async (key, value, _update) => {\n      try {\n        if (_update) {\n          await db.updateMany({\n            model: modelName ?? \"rateLimit\",\n            where: [{ field: \"key\", value: key }],\n            update: {\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        } else {\n          await db.create({\n            model: modelName ?? \"rateLimit\",\n            data: {\n              key,\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        }\n      } catch (e) {\n        ctx.logger.error(\"Error setting rate limit\", e);\n      }\n    }\n  };\n}\nvar memory = /* @__PURE__ */ new Map();\nfunction getRateLimitStorage(ctx) {\n  if (ctx.options.rateLimit?.customStorage) {\n    return ctx.options.rateLimit.customStorage;\n  }\n  if (ctx.rateLimit.storage === \"secondary-storage\") {\n    return {\n      get: async (key) => {\n        const stringified = await ctx.options.secondaryStorage?.get(key);\n        return stringified ? JSON.parse(stringified) : void 0;\n      },\n      set: async (key, value) => {\n        await ctx.options.secondaryStorage?.set?.(key, JSON.stringify(value));\n      }\n    };\n  }\n  const storage = ctx.rateLimit.storage;\n  if (storage === \"memory\") {\n    return {\n      async get(key) {\n        return memory.get(key);\n      },\n      async set(key, value, _update) {\n        memory.set(key, value);\n      }\n    };\n  }\n  return createDBStorage(ctx, ctx.rateLimit.modelName);\n}\nasync function onRequestRateLimit(req, ctx) {\n  if (!ctx.rateLimit.enabled) {\n    return;\n  }\n  const baseURL = ctx.baseURL;\n  const path = req.url.replace(baseURL, \"\").split(\"?\")[0];\n  let window = ctx.rateLimit.window;\n  let max = ctx.rateLimit.max;\n  const key = (0,_chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_3__.getIp)(req, ctx.options) + path;\n  const specialRules = getDefaultSpecialRules();\n  const specialRule = specialRules.find((rule) => rule.pathMatcher(path));\n  if (specialRule) {\n    window = specialRule.window;\n    max = specialRule.max;\n  }\n  for (const plugin of ctx.options.plugins || []) {\n    if (plugin.rateLimit) {\n      const matchedRule = plugin.rateLimit.find(\n        (rule) => rule.pathMatcher(path)\n      );\n      if (matchedRule) {\n        window = matchedRule.window;\n        max = matchedRule.max;\n        break;\n      }\n    }\n  }\n  if (ctx.rateLimit.customRules) {\n    const _path = Object.keys(ctx.rateLimit.customRules).find((p) => {\n      if (p.includes(\"*\")) {\n        const isMatch2 = wildcardMatch(p)(path);\n        return isMatch2;\n      }\n      return p === path;\n    });\n    if (_path) {\n      const customRule = ctx.rateLimit.customRules[_path];\n      const resolved = typeof customRule === \"function\" ? await customRule(req) : customRule;\n      if (resolved) {\n        window = resolved.window;\n        max = resolved.max;\n      }\n    }\n  }\n  const storage = getRateLimitStorage(ctx);\n  const data = await storage.get(key);\n  const now = Date.now();\n  if (!data) {\n    await storage.set(key, {\n      key,\n      count: 1,\n      lastRequest: now\n    });\n  } else {\n    const timeSinceLastRequest = now - data.lastRequest;\n    if (shouldRateLimit(max, window, data)) {\n      const retryAfter = getRetryAfter(data.lastRequest, window);\n      return rateLimitResponse(retryAfter);\n    } else if (timeSinceLastRequest > window * 1e3) {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: 1,\n          lastRequest: now\n        },\n        true\n      );\n    } else {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: data.count + 1,\n          lastRequest: now\n        },\n        true\n      );\n    }\n  }\n}\nfunction getDefaultSpecialRules() {\n  const specialRules = [\n    {\n      pathMatcher(path) {\n        return path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path.startsWith(\"/change-password\") || path.startsWith(\"/change-email\");\n      },\n      window: 10,\n      max: 3\n    }\n  ];\n  return specialRules;\n}\nfunction getEndpoints(ctx, options) {\n  const pluginEndpoints = options.plugins?.reduce(\n    (acc, plugin) => {\n      return {\n        ...acc,\n        ...plugin.endpoints\n      };\n    },\n    {}\n  );\n  const middlewares = options.plugins?.map(\n    (plugin) => plugin.middlewares?.map((m) => {\n      const middleware = async (context) => {\n        return m.middleware({\n          ...context,\n          context: {\n            ...ctx,\n            ...context.context\n          }\n        });\n      };\n      middleware.path = m.path;\n      middleware.options = m.middleware.options;\n      middleware.headers = m.middleware.headers;\n      return {\n        path: m.path,\n        middleware\n      };\n    })\n  ).filter((plugin) => plugin !== void 0).flat() || [];\n  const baseEndpoints = {\n    signInSocial,\n    callbackOAuth,\n    getSession: getSession(),\n    signOut,\n    signUpEmail: signUpEmail(),\n    signInEmail,\n    forgetPassword,\n    resetPassword,\n    verifyEmail,\n    sendVerificationEmail,\n    changeEmail,\n    changePassword,\n    setPassword,\n    updateUser: updateUser(),\n    deleteUser,\n    forgetPasswordCallback,\n    listSessions: listSessions(),\n    revokeSession,\n    revokeSessions,\n    revokeOtherSessions,\n    linkSocialAccount,\n    listUserAccounts,\n    deleteUserCallback,\n    unlinkAccount\n  };\n  const endpoints = {\n    ...baseEndpoints,\n    ...pluginEndpoints,\n    ok,\n    error\n  };\n  let api = {};\n  for (const [key, endpoint] of Object.entries(endpoints)) {\n    api[key] = async (context = {}) => {\n      endpoint.headers = new Headers();\n      let internalCtx = {\n        setHeader(key2, value) {\n          endpoint.headers.set(key2, value);\n        },\n        setCookie(key2, value, options2) {\n          (0,better_call__WEBPACK_IMPORTED_MODULE_10__.setCookie)(endpoint.headers, key2, value, options2);\n        },\n        getCookie(key2, prefix) {\n          const header = context.headers;\n          const cookieH = header?.get(\"cookie\");\n          const cookie = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.getCookie)(cookieH || \"\", key2, prefix);\n          return cookie;\n        },\n        getSignedCookie(key2, secret, prefix) {\n          const header = context.headers;\n          if (!header) {\n            return null;\n          }\n          const cookie = (0,better_call__WEBPACK_IMPORTED_MODULE_10__.getSignedCookie)(header, secret, key2, prefix);\n          return cookie;\n        },\n        async setSignedCookie(key2, value, secret, options2) {\n          await (0,better_call__WEBPACK_IMPORTED_MODULE_10__.setSignedCookie)(endpoint.headers, key2, value, secret, options2);\n        },\n        redirect(url) {\n          endpoint.headers.set(\"Location\", url);\n          return new better_call__WEBPACK_IMPORTED_MODULE_10__.APIError(\"FOUND\");\n        },\n        responseHeader: endpoint.headers\n      };\n      let authCtx = await ctx;\n      let newSession = null;\n      let internalContext = {\n        ...internalCtx,\n        ...context,\n        path: endpoint.path,\n        context: {\n          ...authCtx,\n          ...context.context,\n          session: null,\n          setNewSession: function(session) {\n            this.newSession = session;\n            newSession = session;\n          },\n          returned: void 0\n        },\n        responseHeader: new Headers()\n      };\n      const plugins = options.plugins || [];\n      const beforeHooks = plugins.map((plugin) => {\n        if (plugin.hooks?.before) {\n          return plugin.hooks.before;\n        }\n      }).filter((plugin) => plugin !== void 0).flat();\n      const afterHooks = plugins.map((plugin) => {\n        if (plugin.hooks?.after) {\n          return plugin.hooks.after;\n        }\n      }).filter((plugin) => plugin !== void 0).flat();\n      if (options.hooks?.before) {\n        beforeHooks.push({\n          matcher: () => true,\n          handler: options.hooks.before\n        });\n      }\n      if (options.hooks?.after) {\n        afterHooks.push({\n          matcher: () => true,\n          handler: options.hooks.after\n        });\n      }\n      for (const hook of beforeHooks) {\n        if (!hook.matcher(internalContext)) continue;\n        const hookRes = await hook.handler(internalContext);\n        if (hookRes && \"context\" in hookRes) {\n          internalContext = {\n            ...internalContext,\n            ...hookRes.context\n          };\n          continue;\n        }\n        if (hookRes) {\n          return hookRes;\n        }\n      }\n      let endpointRes;\n      try {\n        endpointRes = await endpoint(internalContext);\n        if (newSession) {\n          internalContext.context.newSession = newSession;\n        }\n      } catch (e) {\n        if (newSession) {\n          internalContext.context.newSession = newSession;\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n          if (!afterHooks?.length) {\n            e.headers = endpoint.headers;\n            throw e;\n          }\n          internalContext.context.returned = e;\n          internalContext.context.returned.headers = endpoint.headers;\n          for (const hook of afterHooks || []) {\n            const match = hook.matcher(internalContext);\n            if (match) {\n              try {\n                const hookRes = await hook.handler(internalContext);\n                if (hookRes && \"response\" in hookRes) {\n                  internalContext.context.returned = hookRes.response;\n                }\n              } catch (e2) {\n                if (e2 instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n                  internalContext.context.returned = e2;\n                  continue;\n                }\n                throw e2;\n              }\n            }\n          }\n          if (internalContext.context.returned instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n            internalContext.context.returned.headers = endpoint.headers;\n            throw internalContext.context.returned;\n          }\n          return internalContext.context.returned;\n        }\n        throw e;\n      }\n      internalContext.context.returned = endpointRes;\n      internalContext.responseHeader = endpoint.headers;\n      for (const hook of afterHooks) {\n        const match = hook.matcher(internalContext);\n        if (match) {\n          try {\n            const hookRes = await hook.handler(internalContext);\n            if (hookRes) {\n              if (\"responseHeader\" in hookRes) {\n                const headers = hookRes.responseHeader;\n                internalContext.responseHeader = headers;\n              } else {\n                internalContext.context.returned = hookRes;\n              }\n            }\n          } catch (e) {\n            if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n              internalContext.context.returned = e;\n              continue;\n            }\n            throw e;\n          }\n        }\n      }\n      const response = internalContext.context.returned;\n      if (response instanceof Response) {\n        endpoint.headers.forEach((value, key2) => {\n          if (key2 === \"set-cookie\") {\n            response.headers.append(key2, value);\n          } else {\n            response.headers.set(key2, value);\n          }\n        });\n      }\n      if (response instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n        response.headers = endpoint.headers;\n        throw response;\n      }\n      return response;\n    };\n    api[key].path = endpoint.path;\n    api[key].method = endpoint.method;\n    api[key].options = endpoint.options;\n    api[key].headers = endpoint.headers;\n  }\n  return {\n    api,\n    middlewares\n  };\n}\nvar router = (ctx, options) => {\n  const { api, middlewares } = getEndpoints(ctx, options);\n  const basePath = new URL(ctx.baseURL).pathname;\n  return (0,better_call__WEBPACK_IMPORTED_MODULE_10__.createRouter)(api, {\n    extraContext: ctx,\n    basePath,\n    routerMiddleware: [\n      {\n        path: \"/**\",\n        middleware: originCheckMiddleware\n      },\n      ...middlewares\n    ],\n    async onRequest(req) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onRequest) {\n          const response = await plugin.onRequest(req, ctx);\n          if (response && \"response\" in response) {\n            return response.response;\n          }\n        }\n      }\n      return onRequestRateLimit(req, ctx);\n    },\n    async onResponse(res) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onResponse) {\n          const response = await plugin.onResponse(res, ctx);\n          if (response) {\n            return response.response;\n          }\n        }\n      }\n      return res;\n    },\n    onError(e) {\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError && e.status === \"FOUND\") {\n        return;\n      }\n      if (options.onAPIError?.throw) {\n        throw e;\n      }\n      if (options.onAPIError?.onError) {\n        options.onAPIError.onError(e, ctx);\n        return;\n      }\n      const optLogLevel = options.logger?.level;\n      const log = optLogLevel === \"error\" || optLogLevel === \"warn\" || optLogLevel === \"debug\" ? _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_4__.logger : void 0;\n      if (options.logger?.disabled !== true) {\n        if (e && typeof e === \"object\" && \"message\" in e && typeof e.message === \"string\") {\n          if (e.message.includes(\"no column\") || e.message.includes(\"column\") || e.message.includes(\"relation\") || e.message.includes(\"table\") || e.message.includes(\"does not exist\")) {\n            ctx.logger?.error(e.message);\n            return;\n          }\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_10__.APIError) {\n          if (e.status === \"INTERNAL_SERVER_ERROR\") {\n            ctx.logger.error(e.status, e);\n          }\n          log?.error(e.message);\n        } else {\n          ctx.logger?.error(\n            e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n            e\n          );\n        }\n      }\n    }\n  });\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVhZS0JLTzZaLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBaUY7QUFDWDtBQUNzQjtBQUNoQztBQUNZO0FBQ1I7QUFDSTtBQUNoQjtBQUNOO0FBQ007QUFDMkg7QUFDeEk7QUFDZjtBQUM2QjtBQUNGO0FBQ0E7QUFDbEI7QUFDUTs7QUFFekMsd0JBQXdCLDhEQUFnQjtBQUN4QztBQUNBLENBQUM7QUFDRCwyQkFBMkIscUVBQXVCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLDhEQUFnQjtBQUNwQjtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCx5QkFBeUIsbUVBQXFCO0FBQzlDO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsaUxBQWlMLGdCQUFnQjtBQUNqTSxnQkFBZ0IsS0FBSztBQUNyQixJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnQkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELHdCQUF3QjtBQUN4RSxpQkFBaUIseUJBQXlCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGlCQUFpQjtBQUNoRCx3QkFBd0IsaUJBQWlCO0FBQ3pDLE1BQU07QUFDTixzQkFBc0IsaUJBQWlCO0FBQ3ZDO0FBQ0E7QUFDQSx5Q0FBeUMsaUJBQWlCO0FBQzFELHlDQUF5QyxpQkFBaUI7QUFDMUQ7QUFDQTtBQUNBLGtCQUFrQixxQkFBcUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNS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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRTtBQUNuRTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyw2REFBYTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDZEQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSwwQ0FBUSxDQUFDLDBDQUFRLElBQUksdUNBQUs7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixrREFBUTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFMnBCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstWFlLQktPNlouanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU29jaWFsUHJvdmlkZXJMaXN0RW51bSwgc29jaWFsUHJvdmlkZXJMaXN0IH0gZnJvbSAnLi9jaHVuay1WWERZTkNPWC5qcyc7XG5pbXBvcnQgeyBnZXRIb3N0LCBnZXRQcm90b2NvbCwgZ2V0T3JpZ2luIH0gZnJvbSAnLi9jaHVuay1YRkNJQU5aWC5qcyc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uQ29va2llLCBkZWxldGVTZXNzaW9uQ29va2llLCBzZXRDb29raWVDYWNoZSB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuaW1wb3J0IHsgcGFyc2VVc2VySW5wdXQsIGdldElwIH0gZnJvbSAnLi9jaHVuay1XWjZPSVZKSy5qcyc7XG5pbXBvcnQgeyBISURFX01FVEFEQVRBLCBnZW5lcmF0ZUlkLCBsb2dnZXIgfSBmcm9tICcuL2NodW5rLUtMREZCTFlMLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlU3RhdGUsIHBhcnNlU3RhdGUgfSBmcm9tICcuL2NodW5rLU5QTzY0U1ZOLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlUmFuZG9tU3RyaW5nLCBzaWduSldUIH0gZnJvbSAnLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgeyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi9jaHVuay01M0lQTzJQSi5qcyc7XG5pbXBvcnQgeyBnZXREYXRlIH0gZnJvbSAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBpc0RldmVsb3BtZW50IH0gZnJvbSAnLi9jaHVuay1UUVFTUFBOQS5qcyc7XG5pbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlLCBjcmVhdGVNaWRkbGV3YXJlQ3JlYXRvciwgY3JlYXRlRW5kcG9pbnRDcmVhdG9yLCBBUElFcnJvciwgc2V0Q29va2llLCBnZXRDb29raWUsIGdldFNpZ25lZENvb2tpZSwgc2V0U2lnbmVkQ29va2llLCBjcmVhdGVSb3V0ZXIgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5leHBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgY3JlYXRlSE1BQyB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCB7IGJhc2U2NCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgYmluYXJ5IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2JpbmFyeSc7XG5pbXBvcnQgeyBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IEpXVEV4cGlyZWQgfSBmcm9tICdqb3NlL2Vycm9ycyc7XG5cbnZhciBvcHRpb25zTWlkZGxld2FyZSA9IGNyZWF0ZU1pZGRsZXdhcmUoYXN5bmMgKCkgPT4ge1xuICByZXR1cm4ge307XG59KTtcbnZhciBjcmVhdGVBdXRoTWlkZGxld2FyZSA9IGNyZWF0ZU1pZGRsZXdhcmVDcmVhdG9yKHtcbiAgdXNlOiBbXG4gICAgb3B0aW9uc01pZGRsZXdhcmUsXG4gICAgLyoqXG4gICAgICogT25seSB1c2UgZm9yIHBvc3QgaG9va3NcbiAgICAgKi9cbiAgICBjcmVhdGVNaWRkbGV3YXJlKGFzeW5jICgpID0+IHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9KVxuICBdXG59KTtcbnZhciBjcmVhdGVBdXRoRW5kcG9pbnQgPSBjcmVhdGVFbmRwb2ludENyZWF0b3Ioe1xuICB1c2U6IFtvcHRpb25zTWlkZGxld2FyZV1cbn0pO1xuXG4vLyBzcmMvdXRpbHMvd2lsZGNhcmQudHNcbmZ1bmN0aW9uIGVzY2FwZVJlZ0V4cENoYXIoY2hhcikge1xuICBpZiAoY2hhciA9PT0gXCItXCIgfHwgY2hhciA9PT0gXCJeXCIgfHwgY2hhciA9PT0gXCIkXCIgfHwgY2hhciA9PT0gXCIrXCIgfHwgY2hhciA9PT0gXCIuXCIgfHwgY2hhciA9PT0gXCIoXCIgfHwgY2hhciA9PT0gXCIpXCIgfHwgY2hhciA9PT0gXCJ8XCIgfHwgY2hhciA9PT0gXCJbXCIgfHwgY2hhciA9PT0gXCJdXCIgfHwgY2hhciA9PT0gXCJ7XCIgfHwgY2hhciA9PT0gXCJ9XCIgfHwgY2hhciA9PT0gXCIqXCIgfHwgY2hhciA9PT0gXCI/XCIgfHwgY2hhciA9PT0gXCJcXFxcXCIpIHtcbiAgICByZXR1cm4gYFxcXFwke2NoYXJ9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY2hhcjtcbiAgfVxufVxuZnVuY3Rpb24gZXNjYXBlUmVnRXhwU3RyaW5nKHN0cikge1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICByZXN1bHQgKz0gZXNjYXBlUmVnRXhwQ2hhcihzdHJbaV0pO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm0ocGF0dGVybiwgc2VwYXJhdG9yID0gdHJ1ZSkge1xuICBpZiAoQXJyYXkuaXNBcnJheShwYXR0ZXJuKSkge1xuICAgIGxldCByZWdFeHBQYXR0ZXJucyA9IHBhdHRlcm4ubWFwKChwKSA9PiBgXiR7dHJhbnNmb3JtKHAsIHNlcGFyYXRvcil9JGApO1xuICAgIHJldHVybiBgKD86JHtyZWdFeHBQYXR0ZXJucy5qb2luKFwifFwiKX0pYDtcbiAgfVxuICBsZXQgc2VwYXJhdG9yU3BsaXR0ZXIgPSBcIlwiO1xuICBsZXQgc2VwYXJhdG9yTWF0Y2hlciA9IFwiXCI7XG4gIGxldCB3aWxkY2FyZCA9IFwiLlwiO1xuICBpZiAoc2VwYXJhdG9yID09PSB0cnVlKSB7XG4gICAgc2VwYXJhdG9yU3BsaXR0ZXIgPSBcIi9cIjtcbiAgICBzZXBhcmF0b3JNYXRjaGVyID0gXCJbL1xcXFxcXFxcXVwiO1xuICAgIHdpbGRjYXJkID0gXCJbXi9cXFxcXFxcXF1cIjtcbiAgfSBlbHNlIGlmIChzZXBhcmF0b3IpIHtcbiAgICBzZXBhcmF0b3JTcGxpdHRlciA9IHNlcGFyYXRvcjtcbiAgICBzZXBhcmF0b3JNYXRjaGVyID0gZXNjYXBlUmVnRXhwU3RyaW5nKHNlcGFyYXRvclNwbGl0dGVyKTtcbiAgICBpZiAoc2VwYXJhdG9yTWF0Y2hlci5sZW5ndGggPiAxKSB7XG4gICAgICBzZXBhcmF0b3JNYXRjaGVyID0gYCg/OiR7c2VwYXJhdG9yTWF0Y2hlcn0pYDtcbiAgICAgIHdpbGRjYXJkID0gYCgoPyEke3NlcGFyYXRvck1hdGNoZXJ9KS4pYDtcbiAgICB9IGVsc2Uge1xuICAgICAgd2lsZGNhcmQgPSBgW14ke3NlcGFyYXRvck1hdGNoZXJ9XWA7XG4gICAgfVxuICB9XG4gIGxldCByZXF1aXJlZFNlcGFyYXRvciA9IHNlcGFyYXRvciA/IGAke3NlcGFyYXRvck1hdGNoZXJ9Kz9gIDogXCJcIjtcbiAgbGV0IG9wdGlvbmFsU2VwYXJhdG9yID0gc2VwYXJhdG9yID8gYCR7c2VwYXJhdG9yTWF0Y2hlcn0qP2AgOiBcIlwiO1xuICBsZXQgc2VnbWVudHMgPSBzZXBhcmF0b3IgPyBwYXR0ZXJuLnNwbGl0KHNlcGFyYXRvclNwbGl0dGVyKSA6IFtwYXR0ZXJuXTtcbiAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gIGZvciAobGV0IHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspIHtcbiAgICBsZXQgc2VnbWVudCA9IHNlZ21lbnRzW3NdO1xuICAgIGxldCBuZXh0U2VnbWVudCA9IHNlZ21lbnRzW3MgKyAxXTtcbiAgICBsZXQgY3VycmVudFNlcGFyYXRvciA9IFwiXCI7XG4gICAgaWYgKCFzZWdtZW50ICYmIHMgPiAwKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHNlcGFyYXRvcikge1xuICAgICAgaWYgKHMgPT09IHNlZ21lbnRzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgY3VycmVudFNlcGFyYXRvciA9IG9wdGlvbmFsU2VwYXJhdG9yO1xuICAgICAgfSBlbHNlIGlmIChuZXh0U2VnbWVudCAhPT0gXCIqKlwiKSB7XG4gICAgICAgIGN1cnJlbnRTZXBhcmF0b3IgPSByZXF1aXJlZFNlcGFyYXRvcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRTZXBhcmF0b3IgPSBcIlwiO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoc2VwYXJhdG9yICYmIHNlZ21lbnQgPT09IFwiKipcIikge1xuICAgICAgaWYgKGN1cnJlbnRTZXBhcmF0b3IpIHtcbiAgICAgICAgcmVzdWx0ICs9IHMgPT09IDAgPyBcIlwiIDogY3VycmVudFNlcGFyYXRvcjtcbiAgICAgICAgcmVzdWx0ICs9IGAoPzoke3dpbGRjYXJkfSo/JHtjdXJyZW50U2VwYXJhdG9yfSkqP2A7XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCBzZWdtZW50Lmxlbmd0aDsgYysrKSB7XG4gICAgICBsZXQgY2hhciA9IHNlZ21lbnRbY107XG4gICAgICBpZiAoY2hhciA9PT0gXCJcXFxcXCIpIHtcbiAgICAgICAgaWYgKGMgPCBzZWdtZW50Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICByZXN1bHQgKz0gZXNjYXBlUmVnRXhwQ2hhcihzZWdtZW50W2MgKyAxXSk7XG4gICAgICAgICAgYysrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNoYXIgPT09IFwiP1wiKSB7XG4gICAgICAgIHJlc3VsdCArPSB3aWxkY2FyZDtcbiAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gXCIqXCIpIHtcbiAgICAgICAgcmVzdWx0ICs9IGAke3dpbGRjYXJkfSo/YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCArPSBlc2NhcGVSZWdFeHBDaGFyKGNoYXIpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQgKz0gY3VycmVudFNlcGFyYXRvcjtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gaXNNYXRjaChyZWdleHAsIHNhbXBsZSkge1xuICBpZiAodHlwZW9mIHNhbXBsZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFNhbXBsZSBtdXN0IGJlIGEgc3RyaW5nLCBidXQgJHt0eXBlb2Ygc2FtcGxlfSBnaXZlbmApO1xuICB9XG4gIHJldHVybiByZWdleHAudGVzdChzYW1wbGUpO1xufVxuZnVuY3Rpb24gd2lsZGNhcmRNYXRjaChwYXR0ZXJuLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgcGF0dGVybiAhPT0gXCJzdHJpbmdcIiAmJiAhQXJyYXkuaXNBcnJheShwYXR0ZXJuKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICBgVGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzaW5nbGUgcGF0dGVybiBzdHJpbmcgb3IgYW4gYXJyYXkgb2YgcGF0dGVybnMsIGJ1dCAke3R5cGVvZiBwYXR0ZXJufSBnaXZlbmBcbiAgICApO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJib29sZWFuXCIpIHtcbiAgICBvcHRpb25zID0geyBzZXBhcmF0b3I6IG9wdGlvbnMgfTtcbiAgfVxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiAhKHR5cGVvZiBvcHRpb25zID09PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiBvcHRpb25zID09PSBcIm9iamVjdFwiICYmIG9wdGlvbnMgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkob3B0aW9ucykpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgIGBUaGUgc2Vjb25kIGFyZ3VtZW50IG11c3QgYmUgYW4gb3B0aW9ucyBvYmplY3Qgb3IgYSBzdHJpbmcvYm9vbGVhbiBzZXBhcmF0b3IsIGJ1dCAke3R5cGVvZiBvcHRpb25zfSBnaXZlbmBcbiAgICApO1xuICB9XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBpZiAob3B0aW9ucy5zZXBhcmF0b3IgPT09IFwiXFxcXFwiKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJcXFxcIGlzIG5vdCBhIHZhbGlkIHNlcGFyYXRvciBiZWNhdXNlIGl0IGlzIHVzZWQgZm9yIGVzY2FwaW5nLiBUcnkgc2V0dGluZyB0aGUgc2VwYXJhdG9yIHRvIGB0cnVlYCBpbnN0ZWFkXCJcbiAgICApO1xuICB9XG4gIGxldCByZWdleHBQYXR0ZXJuID0gdHJhbnNmb3JtKHBhdHRlcm4sIG9wdGlvbnMuc2VwYXJhdG9yKTtcbiAgbGV0IHJlZ2V4cCA9IG5ldyBSZWdFeHAoYF4ke3JlZ2V4cFBhdHRlcm59JGAsIG9wdGlvbnMuZmxhZ3MpO1xuICBsZXQgZm4gPSBpc01hdGNoLmJpbmQobnVsbCwgcmVnZXhwKTtcbiAgZm4ub3B0aW9ucyA9IG9wdGlvbnM7XG4gIGZuLnBhdHRlcm4gPSBwYXR0ZXJuO1xuICBmbi5yZWdleHAgPSByZWdleHA7XG4gIHJldHVybiBmbjtcbn1cblxuLy8gc3JjL2FwaS9taWRkbGV3YXJlcy9vcmlnaW4tY2hlY2sudHNcbnZhciBvcmlnaW5DaGVja01pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGlmIChjdHgucmVxdWVzdD8ubWV0aG9kICE9PSBcIlBPU1RcIiB8fCAhY3R4LnJlcXVlc3QpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgeyBib2R5LCBxdWVyeSwgY29udGV4dCB9ID0gY3R4O1xuICBjb25zdCBvcmlnaW5IZWFkZXIgPSBjdHguaGVhZGVycz8uZ2V0KFwib3JpZ2luXCIpIHx8IGN0eC5oZWFkZXJzPy5nZXQoXCJyZWZlcmVyXCIpIHx8IFwiXCI7XG4gIGNvbnN0IGNhbGxiYWNrVVJMID0gYm9keT8uY2FsbGJhY2tVUkwgfHwgcXVlcnk/LmNhbGxiYWNrVVJMO1xuICBjb25zdCByZWRpcmVjdFVSTCA9IGJvZHk/LnJlZGlyZWN0VG87XG4gIGNvbnN0IGVycm9yQ2FsbGJhY2tVUkwgPSBib2R5Py5lcnJvckNhbGxiYWNrVVJMO1xuICBjb25zdCBuZXdVc2VyQ2FsbGJhY2tVUkwgPSBib2R5Py5uZXdVc2VyQ2FsbGJhY2tVUkw7XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gQXJyYXkuaXNBcnJheShjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpID8gY29udGV4dC50cnVzdGVkT3JpZ2lucyA6IFtcbiAgICAuLi5jb250ZXh0LnRydXN0ZWRPcmlnaW5zLFxuICAgIC4uLmNvbnRleHQub3B0aW9ucy50cnVzdGVkT3JpZ2lucz8uKGN0eC5yZXF1ZXN0KSB8fCBbXVxuICBdO1xuICBjb25zdCB1c2VzQ29va2llcyA9IGN0eC5oZWFkZXJzPy5oYXMoXCJjb29raWVcIik7XG4gIGNvbnN0IG1hdGNoZXNQYXR0ZXJuID0gKHVybCwgcGF0dGVybikgPT4ge1xuICAgIGlmICh1cmwuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBhdHRlcm4uaW5jbHVkZXMoXCIqXCIpKSB7XG4gICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShnZXRIb3N0KHVybCkpO1xuICAgIH1cbiAgICBjb25zdCBwcm90b2NvbCA9IGdldFByb3RvY29sKHVybCk7XG4gICAgcmV0dXJuIHByb3RvY29sID09PSBcImh0dHA6XCIgfHwgcHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgfHwgIXByb3RvY29sID8gcGF0dGVybiA9PT0gZ2V0T3JpZ2luKHVybCkgOiB1cmwuc3RhcnRzV2l0aChwYXR0ZXJuKTtcbiAgfTtcbiAgY29uc3QgdmFsaWRhdGVVUkwgPSAodXJsLCBsYWJlbCkgPT4ge1xuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGlzVHJ1c3RlZE9yaWdpbiA9IHRydXN0ZWRPcmlnaW5zLnNvbWUoXG4gICAgICAob3JpZ2luKSA9PiBtYXRjaGVzUGF0dGVybih1cmwsIG9yaWdpbikgfHwgdXJsPy5zdGFydHNXaXRoKFwiL1wiKSAmJiBsYWJlbCAhPT0gXCJvcmlnaW5cIiAmJiAhdXJsLmluY2x1ZGVzKFwiOlwiKVxuICAgICk7XG4gICAgaWYgKCFpc1RydXN0ZWRPcmlnaW4pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihgSW52YWxpZCAke2xhYmVsfTogJHt1cmx9YCk7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuaW5mbyhcbiAgICAgICAgYElmIGl0J3MgYSB2YWxpZCBVUkwsIHBsZWFzZSBhZGQgJHt1cmx9IHRvIHRydXN0ZWRPcmlnaW5zIGluIHlvdXIgYXV0aCBjb25maWdcbmAsXG4gICAgICAgIGBDdXJyZW50IGxpc3Qgb2YgdHJ1c3RlZE9yaWdpbnM6ICR7dHJ1c3RlZE9yaWdpbnN9YFxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7IG1lc3NhZ2U6IGBJbnZhbGlkICR7bGFiZWx9YCB9KTtcbiAgICB9XG4gIH07XG4gIGlmICh1c2VzQ29va2llcyAmJiAhY3R4LmNvbnRleHQub3B0aW9ucy5hZHZhbmNlZD8uZGlzYWJsZUNTUkZDaGVjaykge1xuICAgIHZhbGlkYXRlVVJMKG9yaWdpbkhlYWRlciwgXCJvcmlnaW5cIik7XG4gIH1cbiAgY2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwoY2FsbGJhY2tVUkwsIFwiY2FsbGJhY2tVUkxcIik7XG4gIHJlZGlyZWN0VVJMICYmIHZhbGlkYXRlVVJMKHJlZGlyZWN0VVJMLCBcInJlZGlyZWN0VVJMXCIpO1xuICBlcnJvckNhbGxiYWNrVVJMICYmIHZhbGlkYXRlVVJMKGVycm9yQ2FsbGJhY2tVUkwsIFwiZXJyb3JDYWxsYmFja1VSTFwiKTtcbiAgbmV3VXNlckNhbGxiYWNrVVJMICYmIHZhbGlkYXRlVVJMKG5ld1VzZXJDYWxsYmFja1VSTCwgXCJuZXdVc2VyQ2FsbGJhY2tVUkxcIik7XG59KTtcbnZhciBvcmlnaW5DaGVjayA9IChnZXRWYWx1ZSkgPT4gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICBpZiAoIWN0eC5yZXF1ZXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHsgY29udGV4dCB9ID0gY3R4O1xuICBjb25zdCBjYWxsYmFja1VSTCA9IGdldFZhbHVlKGN0eCk7XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gQXJyYXkuaXNBcnJheShcbiAgICBjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnNcbiAgKSA/IGNvbnRleHQudHJ1c3RlZE9yaWdpbnMgOiBbXG4gICAgLi4uY29udGV4dC50cnVzdGVkT3JpZ2lucyxcbiAgICAuLi5jb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnM/LihjdHgucmVxdWVzdCkgfHwgW11cbiAgXTtcbiAgY29uc3QgbWF0Y2hlc1BhdHRlcm4gPSAodXJsLCBwYXR0ZXJuKSA9PiB7XG4gICAgaWYgKHVybC5zdGFydHNXaXRoKFwiL1wiKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIipcIikpIHtcbiAgICAgIHJldHVybiB3aWxkY2FyZE1hdGNoKHBhdHRlcm4pKGdldEhvc3QodXJsKSk7XG4gICAgfVxuICAgIHJldHVybiB1cmwuc3RhcnRzV2l0aChwYXR0ZXJuKTtcbiAgfTtcbiAgY29uc3QgdmFsaWRhdGVVUkwgPSAodXJsLCBsYWJlbCkgPT4ge1xuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGlzVHJ1c3RlZE9yaWdpbiA9IHRydXN0ZWRPcmlnaW5zLnNvbWUoXG4gICAgICAob3JpZ2luKSA9PiBtYXRjaGVzUGF0dGVybih1cmwsIG9yaWdpbikgfHwgdXJsPy5zdGFydHNXaXRoKFwiL1wiKSAmJiBsYWJlbCAhPT0gXCJvcmlnaW5cIiAmJiAhdXJsLmluY2x1ZGVzKFwiOlwiKVxuICAgICk7XG4gICAgaWYgKCFpc1RydXN0ZWRPcmlnaW4pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihgSW52YWxpZCAke2xhYmVsfTogJHt1cmx9YCk7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuaW5mbyhcbiAgICAgICAgYElmIGl0J3MgYSB2YWxpZCBVUkwsIHBsZWFzZSBhZGQgJHt1cmx9IHRvIHRydXN0ZWRPcmlnaW5zIGluIHlvdXIgYXV0aCBjb25maWdcbmAsXG4gICAgICAgIGBDdXJyZW50IGxpc3Qgb2YgdHJ1c3RlZE9yaWdpbnM6ICR7dHJ1c3RlZE9yaWdpbnN9YFxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7IG1lc3NhZ2U6IGBJbnZhbGlkICR7bGFiZWx9YCB9KTtcbiAgICB9XG4gIH07XG4gIGNhbGxiYWNrVVJMICYmIHZhbGlkYXRlVVJMKGNhbGxiYWNrVVJMLCBcImNhbGxiYWNrVVJMXCIpO1xufSk7XG5cbi8vIHNyYy9lcnJvci9jb2Rlcy50c1xudmFyIEJBU0VfRVJST1JfQ09ERVMgPSB7XG4gIFVTRVJfTk9UX0ZPVU5EOiBcIlVzZXIgbm90IGZvdW5kXCIsXG4gIEZBSUxFRF9UT19DUkVBVEVfVVNFUjogXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIixcbiAgRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OOiBcIkZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvblwiLFxuICBGQUlMRURfVE9fVVBEQVRFX1VTRVI6IFwiRmFpbGVkIHRvIHVwZGF0ZSB1c2VyXCIsXG4gIEZBSUxFRF9UT19HRVRfU0VTU0lPTjogXCJGYWlsZWQgdG8gZ2V0IHNlc3Npb25cIixcbiAgSU5WQUxJRF9QQVNTV09SRDogXCJJbnZhbGlkIHBhc3N3b3JkXCIsXG4gIElOVkFMSURfRU1BSUw6IFwiSW52YWxpZCBlbWFpbFwiLFxuICBJTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEOiBcIkludmFsaWQgZW1haWwgb3IgcGFzc3dvcmRcIixcbiAgU09DSUFMX0FDQ09VTlRfQUxSRUFEWV9MSU5LRUQ6IFwiU29jaWFsIGFjY291bnQgYWxyZWFkeSBsaW5rZWRcIixcbiAgUFJPVklERVJfTk9UX0ZPVU5EOiBcIlByb3ZpZGVyIG5vdCBmb3VuZFwiLFxuICBJTlZBTElEX1RPS0VOOiBcImludmFsaWQgdG9rZW5cIixcbiAgSURfVE9LRU5fTk9UX1NVUFBPUlRFRDogXCJpZF90b2tlbiBub3Qgc3VwcG9ydGVkXCIsXG4gIEZBSUxFRF9UT19HRVRfVVNFUl9JTkZPOiBcIkZhaWxlZCB0byBnZXQgdXNlciBpbmZvXCIsXG4gIFVTRVJfRU1BSUxfTk9UX0ZPVU5EOiBcIlVzZXIgZW1haWwgbm90IGZvdW5kXCIsXG4gIEVNQUlMX05PVF9WRVJJRklFRDogXCJFbWFpbCBub3QgdmVyaWZpZWRcIixcbiAgUEFTU1dPUkRfVE9PX1NIT1JUOiBcIlBhc3N3b3JkIHRvbyBzaG9ydFwiLFxuICBQQVNTV09SRF9UT09fTE9ORzogXCJQYXNzd29yZCB0b28gbG9uZ1wiLFxuICBVU0VSX0FMUkVBRFlfRVhJU1RTOiBcIlVzZXIgYWxyZWFkeSBleGlzdHNcIixcbiAgRU1BSUxfQ0FOX05PVF9CRV9VUERBVEVEOiBcIkVtYWlsIGNhbiBub3QgYmUgdXBkYXRlZFwiLFxuICBDUkVERU5USUFMX0FDQ09VTlRfTk9UX0ZPVU5EOiBcIkNyZWRlbnRpYWwgYWNjb3VudCBub3QgZm91bmRcIixcbiAgU0VTU0lPTl9FWFBJUkVEOiBcIlNlc3Npb24gZXhwaXJlZC4gUmUtYXV0aGVudGljYXRlIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uXCIsXG4gIEZBSUxFRF9UT19VTkxJTktfTEFTVF9BQ0NPVU5UOiBcIllvdSBjYW4ndCB1bmxpbmsgeW91ciBsYXN0IGFjY291bnRcIixcbiAgQUNDT1VOVF9OT1RfRk9VTkQ6IFwiQWNjb3VudCBub3QgZm91bmRcIlxufTtcbnZhciBnZXRTZXNzaW9uID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9nZXQtc2Vzc2lvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiB6Lm9wdGlvbmFsKFxuICAgICAgei5vYmplY3Qoe1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgY29va2llIGNhY2hlIGlzIGVuYWJsZWQsIGl0IHdpbGwgZGlzYWJsZSB0aGUgY2FjaGVcbiAgICAgICAgICogYW5kIGZldGNoIHRoZSBzZXNzaW9uIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICAgICAqL1xuICAgICAgICBkaXNhYmxlQ29va2llQ2FjaGU6IHoub3B0aW9uYWwoXG4gICAgICAgICAgei5ib29sZWFuKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2FibGUgY29va2llIGNhY2hlIGFuZCBmZXRjaCBzZXNzaW9uIGZyb20gZGF0YWJhc2VcIlxuICAgICAgICAgIH0pLm9yKHouc3RyaW5nKCkudHJhbnNmb3JtKCh2KSA9PiB2ID09PSBcInRydWVcIikpXG4gICAgICAgICkub3B0aW9uYWwoKSxcbiAgICAgICAgZGlzYWJsZVJlZnJlc2g6IHouYm9vbGVhbih7XG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBzZXNzaW9uIHJlZnJlc2guIFVzZWZ1bCBmb3IgY2hlY2tpbmcgc2Vzc2lvbiBzdGF0dXMsIHdpdGhvdXQgdXBkYXRpbmcgdGhlIHNlc3Npb25cIlxuICAgICAgICB9KS5vcih6LnN0cmluZygpLnRyYW5zZm9ybSgodikgPT4gdiA9PT0gXCJ0cnVlXCIpKS5vcHRpb25hbCgpXG4gICAgICB9KVxuICAgICksXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSBjdXJyZW50IHNlc3Npb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvVXNlclwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZVRva2VuID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICAgKTtcbiAgICAgIGlmICghc2Vzc2lvbkNvb2tpZVRva2VuKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhQ29va2llID0gY3R4LmdldENvb2tpZShcbiAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhUGF5bG9hZCA9IHNlc3Npb25EYXRhQ29va2llID8gc2FmZUpTT05QYXJzZShiaW5hcnkuZGVjb2RlKGJhc2U2NC5kZWNvZGUoc2Vzc2lvbkRhdGFDb29raWUpKSkgOiBudWxsO1xuICAgICAgaWYgKHNlc3Npb25EYXRhUGF5bG9hZCkge1xuICAgICAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgY3JlYXRlSE1BQyhcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS52ZXJpZnkoXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHNlc3Npb25EYXRhUGF5bG9hZC5zZXNzaW9uKSxcbiAgICAgICAgICBzZXNzaW9uRGF0YVBheWxvYWQuc2lnbmF0dXJlXG4gICAgICAgICk7XG4gICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IGRvbnRSZW1lbWJlck1lID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ubmFtZSxcbiAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgICApO1xuICAgICAgaWYgKHNlc3Npb25EYXRhUGF5bG9hZD8uc2Vzc2lvbiAmJiBjdHguY29udGV4dC5vcHRpb25zLnNlc3Npb24/LmNvb2tpZUNhY2hlPy5lbmFibGVkICYmICFjdHgucXVlcnk/LmRpc2FibGVDb29raWVDYWNoZSkge1xuICAgICAgICBjb25zdCBzZXNzaW9uMiA9IHNlc3Npb25EYXRhUGF5bG9hZC5zZXNzaW9uO1xuICAgICAgICBjb25zdCBoYXNFeHBpcmVkID0gc2Vzc2lvbkRhdGFQYXlsb2FkLmV4cGlyZXNBdCA8IERhdGUubm93KCkgfHwgc2Vzc2lvbjIuc2Vzc2lvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICAgICAgaWYgKCFoYXNFeHBpcmVkKSB7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgICAgc2Vzc2lvbjJcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGRhdGFDb29raWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lO1xuICAgICAgICAgIGN0eC5zZXRDb29raWUoZGF0YUNvb2tpZSwgXCJcIiwge1xuICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24oc2Vzc2lvbkNvb2tpZVRva2VuKTtcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uO1xuICAgICAgaWYgKCFzZXNzaW9uIHx8IHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgIGlmIChzZXNzaW9uKSB7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW5cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgIH1cbiAgICAgIGlmIChkb250UmVtZW1iZXJNZSB8fCBjdHgucXVlcnk/LmRpc2FibGVSZWZyZXNoKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbihcbiAgICAgICAgICBzZXNzaW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCBleHBpcmVzSW4gPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmV4cGlyZXNJbjtcbiAgICAgIGNvbnN0IHVwZGF0ZUFnZSA9IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcudXBkYXRlQWdlO1xuICAgICAgY29uc3Qgc2Vzc2lvbklzRHVlVG9CZVVwZGF0ZWREYXRlID0gc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdC52YWx1ZU9mKCkgLSBleHBpcmVzSW4gKiAxZTMgKyB1cGRhdGVBZ2UgKiAxZTM7XG4gICAgICBjb25zdCBzaG91bGRCZVVwZGF0ZWQgPSBzZXNzaW9uSXNEdWVUb0JlVXBkYXRlZERhdGUgPD0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChzaG91bGRCZVVwZGF0ZWQpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlU2Vzc2lvbihcbiAgICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZXhwaXJlc0luLCBcInNlY1wiKVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCF1cGRhdGVkU2Vzc2lvbikge1xuICAgICAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgICAgICByZXR1cm4gY3R4Lmpzb24obnVsbCwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtYXhBZ2UgPSAodXBkYXRlZFNlc3Npb24uZXhwaXJlc0F0LnZhbHVlT2YoKSAtIERhdGUubm93KCkpIC8gMWUzO1xuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgICAgIGN0eCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzZXNzaW9uOiB1cGRhdGVkU2Vzc2lvbixcbiAgICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAge1xuICAgICAgICAgICAgbWF4QWdlXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICAgIHNlc3Npb246IHVwZGF0ZWRTZXNzaW9uLFxuICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlclxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHNldENvb2tpZUNhY2hlKGN0eCwgc2Vzc2lvbik7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgIHNlc3Npb25cbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwgZXJyb3IyKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0dFVF9TRVNTSU9OXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbik7XG52YXIgZ2V0U2Vzc2lvbkZyb21DdHggPSBhc3luYyAoY3R4LCBjb25maWcpID0+IHtcbiAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb24pIHtcbiAgICByZXR1cm4gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgfVxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbigpKHtcbiAgICAuLi5jdHgsXG4gICAgX2ZsYWc6IFwianNvblwiLFxuICAgIGhlYWRlcnM6IGN0eC5oZWFkZXJzLFxuICAgIHF1ZXJ5OiB7IC4uLmN0eC5xdWVyeSwgLi4uY29uZmlnIH1cbiAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSk7XG4gIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uO1xuICByZXR1cm4gc2Vzc2lvbjtcbn07XG52YXIgc2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uXG4gIH07XG59KTtcbnZhciBmcmVzaFNlc3Npb25NaWRkbGV3YXJlID0gY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgaWYgKCFzZXNzaW9uPy5zZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICB9XG4gIGlmIChjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlID09PSAwKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNlc3Npb25cbiAgICB9O1xuICB9XG4gIGNvbnN0IGZyZXNoQWdlID0gY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy5mcmVzaEFnZTtcbiAgY29uc3QgbGFzdFVwZGF0ZWQgPSBzZXNzaW9uLnNlc3Npb24udXBkYXRlZEF0Py52YWx1ZU9mKCkgfHwgc2Vzc2lvbi5zZXNzaW9uLmNyZWF0ZWRBdC52YWx1ZU9mKCk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGlzRnJlc2ggPSBub3cgLSBsYXN0VXBkYXRlZCA8IGZyZXNoQWdlICogMWUzO1xuICBpZiAoIWlzRnJlc2gpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgbWVzc2FnZTogXCJTZXNzaW9uIGlzIG5vdCBmcmVzaFwiXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uXG4gIH07XG59KTtcbnZhciBsaXN0U2Vzc2lvbnMgPSAoKSA9PiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2xpc3Qtc2Vzc2lvbnNcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTGlzdCBhbGwgYWN0aXZlIHNlc3Npb25zIGZvciB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlzdFNlc3Npb25zKFxuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcigoc2Vzc2lvbikgPT4ge1xuICAgICAgcmV0dXJuIHNlc3Npb24uZXhwaXJlc0F0ID4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgYWN0aXZlU2Vzc2lvbnNcbiAgICApO1xuICB9XG4pO1xudmFyIHJldm9rZVNlc3Npb24gPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jldm9rZS1zZXNzaW9uXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byByZXZva2VcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGEgc2luZ2xlIHNlc3Npb25cIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ0b2tlblwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgdG9rZW4gPSBjdHguYm9keS50b2tlbjtcbiAgICBjb25zdCBmaW5kU2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kU2Vzc2lvbih0b2tlbik7XG4gICAgaWYgKCFmaW5kU2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlNlc3Npb24gbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoZmluZFNlc3Npb24uc2Vzc2lvbi51c2VySWQgIT09IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24odG9rZW4pO1xuICAgIH0gY2F0Y2ggKGVycm9yMikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBlcnJvcjIgJiYgdHlwZW9mIGVycm9yMiA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlcnJvcjIgPyBlcnJvcjIubmFtZSA6IFwiXCIsXG4gICAgICAgIGVycm9yMlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xudmFyIHJldm9rZVNlc3Npb25zID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXZva2Utc2Vzc2lvbnNcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhbGwgc2Vzc2lvbnMgZm9yIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yMikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBlcnJvcjIgJiYgdHlwZW9mIGVycm9yMiA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlcnJvcjIgPyBlcnJvcjIubmFtZSA6IFwiXCIsXG4gICAgICAgIGVycm9yMlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xudmFyIHJldm9rZU90aGVyU2Vzc2lvbnMgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3Jldm9rZS1vdGhlci1zZXNzaW9uc1wiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGFsbCBvdGhlciBzZXNzaW9ucyBmb3IgdGhlIHVzZXIgZXhjZXB0IHRoZSBjdXJyZW50IG9uZVwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgaWYgKCFzZXNzaW9uLnVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlzdFNlc3Npb25zKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcigoc2Vzc2lvbjIpID0+IHtcbiAgICAgIHJldHVybiBzZXNzaW9uMi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICB9KTtcbiAgICBjb25zdCBvdGhlclNlc3Npb25zID0gYWN0aXZlU2Vzc2lvbnMuZmlsdGVyKFxuICAgICAgKHNlc3Npb24yKSA9PiBzZXNzaW9uMi50b2tlbiAhPT0gY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuXG4gICAgKTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIG90aGVyU2Vzc2lvbnMubWFwKFxuICAgICAgICAoc2Vzc2lvbjIpID0+IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHNlc3Npb24yLnRva2VuKVxuICAgICAgKVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuYXN5bmMgZnVuY3Rpb24gY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihzZWNyZXQsIGVtYWlsLCB1cGRhdGVUbywgZXhwaXJlc0luID0gMzYwMCkge1xuICBjb25zdCB0b2tlbiA9IGF3YWl0IHNpZ25KV1QoXG4gICAge1xuICAgICAgZW1haWw6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICB1cGRhdGVUb1xuICAgIH0sXG4gICAgc2VjcmV0LFxuICAgIGV4cGlyZXNJblxuICApO1xuICByZXR1cm4gdG9rZW47XG59XG5hc3luYyBmdW5jdGlvbiBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbihjdHgsIHVzZXIpIHtcbiAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWwpIHtcbiAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZC5cIik7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICB1c2VyLmVtYWlsLFxuICAgIHZvaWQgMCxcbiAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgKTtcbiAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5zZW5kVmVyaWZpY2F0aW9uRW1haWwoXG4gICAge1xuICAgICAgdXNlcixcbiAgICAgIHVybCxcbiAgICAgIHRva2VuXG4gICAgfSxcbiAgICBjdHgucmVxdWVzdFxuICApO1xufVxudmFyIHNlbmRWZXJpZmljYXRpb25FbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2VuZC12ZXJpZmljYXRpb24tZW1haWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIHRvIHNlbmQgdGhlIHZlcmlmaWNhdGlvbiBlbWFpbCB0b1wiXG4gICAgICB9KS5lbWFpbCgpLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byB1c2UgZm9yIGVtYWlsIHZlcmlmaWNhdGlvbiBjYWxsYmFja1wiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2VuZCBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIHRvIHNlbmQgdGhlIHZlcmlmaWNhdGlvbiBlbWFpbCB0b1wiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgY2FsbGJhY2tVUkw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byB1c2UgZm9yIGVtYWlsIHZlcmlmaWNhdGlvbiBjYWxsYmFja1wiXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wiZW1haWxcIl1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZC5cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgZW1haWwgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IHNlbmRWZXJpZmljYXRpb25FbWFpbEZuKGN0eCwgdXNlci51c2VyKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG52YXIgdmVyaWZ5RW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3ZlcmlmeS1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICB0b2tlbjogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gdmVyaWZ5IHRoZSBlbWFpbFwiXG4gICAgICB9KSxcbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZW1haWwgdmVyaWZpY2F0aW9uXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmlnaW5DaGVjaygoY3R4KSA9PiBjdHgucXVlcnkuY2FsbGJhY2tVUkwpXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJWZXJpZnkgdGhlIGVtYWlsIG9mIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1widXNlclwiLCBcInN0YXR1c1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGZ1bmN0aW9uIHJlZGlyZWN0T25FcnJvcihlcnJvcjIpIHtcbiAgICAgIGlmIChjdHgucXVlcnkuY2FsbGJhY2tVUkwpIHtcbiAgICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTC5pbmNsdWRlcyhcIj9cIikpIHtcbiAgICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMfSZlcnJvcj0ke2Vycm9yMn1gKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoYCR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMfT9lcnJvcj0ke2Vycm9yMn1gKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGVycm9yMlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgdG9rZW4gfSA9IGN0eC5xdWVyeTtcbiAgICBsZXQgand0O1xuICAgIHRyeSB7XG4gICAgICBqd3QgPSBhd2FpdCBqd3RWZXJpZnkoXG4gICAgICAgIHRva2VuLFxuICAgICAgICBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoY3R4LmNvbnRleHQuc2VjcmV0KSxcbiAgICAgICAge1xuICAgICAgICAgIGFsZ29yaXRobXM6IFtcIkhTMjU2XCJdXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBKV1RFeHBpcmVkKSB7XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ0b2tlbl9leHBpcmVkXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImludmFsaWRfdG9rZW5cIik7XG4gICAgfVxuICAgIGNvbnN0IHNjaGVtYTIgPSB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgpLFxuICAgICAgdXBkYXRlVG86IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pO1xuICAgIGNvbnN0IHBhcnNlZCA9IHNjaGVtYTIucGFyc2Uoand0LnBheWxvYWQpO1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKFxuICAgICAgcGFyc2VkLmVtYWlsXG4gICAgKTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1c2VyX25vdF9mb3VuZFwiKTtcbiAgICB9XG4gICAgaWYgKHBhcnNlZC51cGRhdGVUbykge1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9P2Vycm9yPXVuYXV0aG9yaXplZGApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmF1dGhvcml6ZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoc2Vzc2lvbi51c2VyLmVtYWlsICE9PSBwYXJzZWQuZW1haWwpIHtcbiAgICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9P2Vycm9yPXVuYXV0aG9yaXplZGApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmF1dGhvcml6ZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyQnlFbWFpbChcbiAgICAgICAgcGFyc2VkLmVtYWlsLFxuICAgICAgICB7XG4gICAgICAgICAgZW1haWw6IHBhcnNlZC51cGRhdGVUbyxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgY29uc3QgbmV3VG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgIHBhcnNlZC51cGRhdGVUb1xuICAgICAgKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogdXBkYXRlZFVzZXIsXG4gICAgICAgICAgdXJsOiBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHtuZXdUb2tlbn1gLFxuICAgICAgICAgIHRva2VuOiBuZXdUb2tlblxuICAgICAgICB9LFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICAgIGF3YWl0IHNldFNlc3Npb25Db29raWUoY3R4LCB7XG4gICAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvbixcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIC4uLnNlc3Npb24udXNlcixcbiAgICAgICAgICBlbWFpbDogcGFyc2VkLnVwZGF0ZVRvLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1cGRhdGVkVXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogdXBkYXRlZFVzZXIuZW1haWwsXG4gICAgICAgICAgbmFtZTogdXBkYXRlZFVzZXIubmFtZSxcbiAgICAgICAgICBpbWFnZTogdXBkYXRlZFVzZXIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXBkYXRlZFVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHVwZGF0ZWRVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IHVwZGF0ZWRVc2VyLnVwZGF0ZWRBdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZVVzZXJCeUVtYWlsKHBhcnNlZC5lbWFpbCwge1xuICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgIH0pO1xuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5hdXRvU2lnbkluQWZ0ZXJWZXJpZmljYXRpb24pIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICAgIGlmICghY3VycmVudFNlc3Npb24gfHwgY3VycmVudFNlc3Npb24udXNlci5lbWFpbCAhPT0gcGFyc2VkLmVtYWlsKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgICB1c2VyLnVzZXIuaWQsXG4gICAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4udXNlci51c2VyLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgIHNlc3Npb246IGN1cnJlbnRTZXNzaW9uLnNlc3Npb24sXG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4uY3VycmVudFNlc3Npb24udXNlcixcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgIHVzZXI6IG51bGxcbiAgICB9KTtcbiAgfVxuKTtcblxuLy8gc3JjL29hdXRoMi9saW5rLWFjY291bnQudHNcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZU9BdXRoVXNlckluZm8oYywge1xuICB1c2VySW5mbyxcbiAgYWNjb3VudCxcbiAgY2FsbGJhY2tVUkxcbn0pIHtcbiAgY29uc3QgZGJVc2VyID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kT0F1dGhVc2VyKFxuICAgIHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgYWNjb3VudC5hY2NvdW50SWQsXG4gICAgYWNjb3VudC5wcm92aWRlcklkXG4gICkuY2F0Y2goKGUpID0+IHtcbiAgICBsb2dnZXIuZXJyb3IoXG4gICAgICBcIkJldHRlciBhdXRoIHdhcyB1bmFibGUgdG8gcXVlcnkgeW91ciBkYXRhYmFzZS5cXG5FcnJvcjogXCIsXG4gICAgICBlXG4gICAgKTtcbiAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPWludGVybmFsX3NlcnZlcl9lcnJvcmBcbiAgICApO1xuICB9KTtcbiAgbGV0IHVzZXIgPSBkYlVzZXI/LnVzZXI7XG4gIGxldCBpc1JlZ2lzdGVyID0gIXVzZXI7XG4gIGlmIChkYlVzZXIpIHtcbiAgICBjb25zdCBoYXNCZWVuTGlua2VkID0gZGJVc2VyLmFjY291bnRzLmZpbmQoXG4gICAgICAoYSkgPT4gYS5wcm92aWRlcklkID09PSBhY2NvdW50LnByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghaGFzQmVlbkxpbmtlZCkge1xuICAgICAgY29uc3QgdHJ1c3RlZFByb3ZpZGVycyA9IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzO1xuICAgICAgY29uc3QgaXNUcnVzdGVkUHJvdmlkZXIgPSB0cnVzdGVkUHJvdmlkZXJzPy5pbmNsdWRlcyhcbiAgICAgICAgYWNjb3VudC5wcm92aWRlcklkXG4gICAgICApO1xuICAgICAgaWYgKCFpc1RydXN0ZWRQcm92aWRlciAmJiAhdXNlckluZm8uZW1haWxWZXJpZmllZCB8fCBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uZW5hYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGlzRGV2ZWxvcG1lbnQpIHtcbiAgICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICAgIGBVc2VyIGFscmVhZHkgZXhpc3QgYnV0IGFjY291bnQgaXNuJ3QgbGlua2VkIHRvICR7YWNjb3VudC5wcm92aWRlcklkfS4gVG8gcmVhZCBtb3JlIGFib3V0IGhvdyBhY2NvdW50IGxpbmtpbmcgd29ya3MgaW4gQmV0dGVyIEF1dGggc2VlIGh0dHBzOi8vd3d3LmJldHRlci1hdXRoLmNvbS9kb2NzL2NvbmNlcHRzL3VzZXJzLWFjY291bnRzI2FjY291bnQtbGlua2luZy5gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBcImFjY291bnQgbm90IGxpbmtlZFwiLFxuICAgICAgICAgIGRhdGE6IG51bGxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoe1xuICAgICAgICAgIHByb3ZpZGVySWQ6IGFjY291bnQucHJvdmlkZXJJZCxcbiAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLmlkLnRvU3RyaW5nKCksXG4gICAgICAgICAgdXNlcklkOiBkYlVzZXIudXNlci5pZCxcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjb3VudC5hY2Nlc3NUb2tlbixcbiAgICAgICAgICBpZFRva2VuOiBhY2NvdW50LmlkVG9rZW4sXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiBhY2NvdW50LnJlZnJlc2hUb2tlbixcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHNjb3BlOiBhY2NvdW50LnNjb3BlXG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJVbmFibGUgdG8gbGluayBhY2NvdW50XCIsIGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBcInVuYWJsZSB0byBsaW5rIGFjY291bnRcIixcbiAgICAgICAgICBkYXRhOiBudWxsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHtcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjb3VudC5hY2Nlc3NUb2tlbixcbiAgICAgICAgICBpZFRva2VuOiBhY2NvdW50LmlkVG9rZW4sXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiBhY2NvdW50LnJlZnJlc2hUb2tlbixcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHNjb3BlOiBhY2NvdW50LnNjb3BlXG4gICAgICAgIH0pLmZpbHRlcigoW18sIHZhbHVlXSkgPT4gdmFsdWUgIT09IHZvaWQgMClcbiAgICAgICk7XG4gICAgICBpZiAoT2JqZWN0LmtleXModXBkYXRlRGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZUFjY291bnQoXG4gICAgICAgICAgaGFzQmVlbkxpbmtlZC5pZCxcbiAgICAgICAgICB1cGRhdGVEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICB1c2VyID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVPQXV0aFVzZXIoXG4gICAgICAgIHtcbiAgICAgICAgICAuLi51c2VySW5mbyxcbiAgICAgICAgICBlbWFpbDogdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICBpZDogdm9pZCAwXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjb3VudC5hY2Nlc3NUb2tlbixcbiAgICAgICAgICBpZFRva2VuOiBhY2NvdW50LmlkVG9rZW4sXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiBhY2NvdW50LnJlZnJlc2hUb2tlbixcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHNjb3BlOiBhY2NvdW50LnNjb3BlLFxuICAgICAgICAgIHByb3ZpZGVySWQ6IGFjY291bnQucHJvdmlkZXJJZCxcbiAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLmlkLnRvU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgKS50aGVuKChyZXMpID0+IHJlcz8udXNlcik7XG4gICAgICBpZiAoIXVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgJiYgdXNlciAmJiBjLmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZE9uU2lnblVwKSB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICAgICAgICBjLmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIHVzZXIuZW1haWwsXG4gICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgIGMuY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgdXJsID0gYCR7Yy5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2NhbGxiYWNrVVJMfWA7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWw/LihcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgdG9rZW5cbiAgICAgICAgICB9LFxuICAgICAgICAgIGMucmVxdWVzdFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihlKTtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBlcnJvcjogZS5tZXNzYWdlLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yOiBcInVuYWJsZSB0byBjcmVhdGUgdXNlclwiLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiBcInVuYWJsZSB0byBjcmVhdGUgdXNlclwiLFxuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgfTtcbiAgfVxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgIHVzZXIuaWQsXG4gICAgYy5yZXF1ZXN0XG4gICk7XG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7XG4gICAgICBlcnJvcjogXCJ1bmFibGUgdG8gY3JlYXRlIHNlc3Npb25cIixcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBkYXRhOiB7XG4gICAgICBzZXNzaW9uLFxuICAgICAgdXNlclxuICAgIH0sXG4gICAgZXJyb3I6IG51bGwsXG4gICAgaXNSZWdpc3RlclxuICB9O1xufVxuXG4vLyBzcmMvYXBpL3JvdXRlcy9zaWduLWluLnRzXG52YXIgc2lnbkluU29jaWFsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLWluL3NvY2lhbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlclxuICAgICAgICogaGFzIHNpZ25lZCBpbi5cbiAgICAgICAqL1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGhhcyBzaWduZWQgaW5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogY2FsbGJhY2sgdXJsIHRvIHJlZGlyZWN0IGlmIHRoZSB1c2VyIGlzIG5ld2x5IHJlZ2lzdGVyZWQuXG4gICAgICAgKlxuICAgICAgICogdXNlZnVsIGlmIHlvdSBoYXZlIGRpZmZlcmVudCByb3V0ZXMgZm9yIGV4aXN0aW5nIHVzZXJzIGFuZCBuZXcgdXNlcnNcbiAgICAgICAqL1xuICAgICAgbmV3VXNlckNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIHVybCB0byByZWRpcmVjdCB0byBpZiBhbiBlcnJvciBoYXBwZW5zXG4gICAgICAgKlxuICAgICAgICogSWYgaXQncyBpbml0aWF0ZWQgZnJvbSB0aGUgY2xpZW50IHNkayB0aGlzIGRlZmF1bHRzIHRvXG4gICAgICAgKiB0aGUgY3VycmVudCB1cmwuXG4gICAgICAgKi9cbiAgICAgIGVycm9yQ2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIGFuIGVycm9yIGhhcHBlbnNcIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT0F1dGgyIHByb3ZpZGVyIHRvIHVzZWBcbiAgICAgICAqL1xuICAgICAgcHJvdmlkZXI6IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0sXG4gICAgICAvKipcbiAgICAgICAqIERpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlclxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIGhhbmRsZSB0aGUgcmVkaXJlY3Rpb25cbiAgICAgICAqIHlvdXJzZWxmIGxpa2UgaW4gYSBwb3B1cCBvciBhIGRpZmZlcmVudCB0YWIuXG4gICAgICAgKi9cbiAgICAgIGRpc2FibGVSZWRpcmVjdDogei5ib29sZWFuKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBhdXRvbWF0aWMgcmVkaXJlY3Rpb24gdG8gdGhlIHByb3ZpZGVyLiBVc2VmdWwgZm9yIGhhbmRsaW5nIHRoZSByZWRpcmVjdGlvbiB5b3Vyc2VsZlwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZCB0byBzaWduIGluIHRoZSB1c2VyXG4gICAgICAgKiBpZiB0aGUgdXNlciBpcyBhbHJlYWR5IHNpZ25lZCBpbiB3aXRoIHRoZVxuICAgICAgICogcHJvdmlkZXIgaW4gdGhlIGZyb250ZW5kLlxuICAgICAgICpcbiAgICAgICAqIE9ubHkgYXBwbGljYWJsZSBpZiB0aGUgcHJvdmlkZXIgc3VwcG9ydHNcbiAgICAgICAqIGl0LiBDdXJyZW50bHkgb25seSBgYXBwbGVgIGFuZCBgZ29vZ2xlYCBpc1xuICAgICAgICogc3VwcG9ydGVkIG91dCBvZiB0aGUgYm94LlxuICAgICAgICovXG4gICAgICBpZFRva2VuOiB6Lm9wdGlvbmFsKFxuICAgICAgICB6Lm9iamVjdCh7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogSUQgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICB0b2tlbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSUQgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcIlxuICAgICAgICAgIH0pLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFRoZSBub25jZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSB0b2tlblxuICAgICAgICAgICAqL1xuICAgICAgICAgIG5vbmNlOiB6LnN0cmluZyh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJOb25jZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSB0b2tlblwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBBY2Nlc3MgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBhY2Nlc3NUb2tlbjogei5zdHJpbmcoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQWNjZXNzIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXCJcbiAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFJlZnJlc2ggdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICByZWZyZXNoVG9rZW46IHouc3RyaW5nKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlZnJlc2ggdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogRXhwaXJ5IGRhdGUgb2YgdGhlIHRva2VuXG4gICAgICAgICAgICovXG4gICAgICAgICAgZXhwaXJlc0F0OiB6Lm51bWJlcih7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFeHBpcnkgZGF0ZSBvZiB0aGUgdG9rZW5cIlxuICAgICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgICAgfSksXG4gICAgICAgIHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlciB0byBzaWduIGluIHRoZSB1c2VyIHdpdGggaWQgdG9rZW5cIlxuICAgICAgICB9XG4gICAgICApXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIGEgc29jaWFsIHByb3ZpZGVyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInNlc3Npb25cIiwgXCJ1c2VyXCIsIFwidXJsXCIsIFwicmVkaXJlY3RcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjLmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gYy5ib2R5LnByb3ZpZGVyXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlByb3ZpZGVyIG5vdCBmb3VuZC4gTWFrZSBzdXJlIHRvIGFkZCB0aGUgcHJvdmlkZXIgaW4geW91ciBhdXRoIGNvbmZpZ1wiLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QUk9WSURFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoYy5ib2R5LmlkVG9rZW4pIHtcbiAgICAgIGlmICghcHJvdmlkZXIudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiUHJvdmlkZXIgZG9lcyBub3Qgc3VwcG9ydCBpZCB0b2tlbiB2ZXJpZmljYXRpb25cIixcbiAgICAgICAgICB7XG4gICAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSURfVE9LRU5fTk9UX1NVUFBPUlRFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgdG9rZW4sIG5vbmNlIH0gPSBjLmJvZHkuaWRUb2tlbjtcbiAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgaWYgKCF2YWxpZCkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSW52YWxpZCBpZCB0b2tlblwiLCB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHtcbiAgICAgICAgaWRUb2tlbjogdG9rZW4sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaFRva2VuOiBjLmJvZHkuaWRUb2tlbi5yZWZyZXNoVG9rZW5cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VySW5mbyB8fCAhdXNlckluZm8/LnVzZXIpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgdXNlciBpbmZvXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0dFVF9VU0VSX0lORk9cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoIXVzZXJJbmZvLnVzZXIuZW1haWwpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXIgZW1haWwgbm90IGZvdW5kXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9FTUFJTF9OT1RfRk9VTkRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgaGFuZGxlT0F1dGhVc2VySW5mbyhjLCB7XG4gICAgICAgIHVzZXJJbmZvOiB7XG4gICAgICAgICAgZW1haWw6IHVzZXJJbmZvLnVzZXIuZW1haWwsXG4gICAgICAgICAgaWQ6IHVzZXJJbmZvLnVzZXIuaWQsXG4gICAgICAgICAgbmFtZTogdXNlckluZm8udXNlci5uYW1lIHx8IFwiXCIsXG4gICAgICAgICAgaW1hZ2U6IHVzZXJJbmZvLnVzZXIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlckluZm8udXNlci5lbWFpbFZlcmlmaWVkIHx8IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGFjY291bnQ6IHtcbiAgICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLnVzZXIuaWQsXG4gICAgICAgICAgYWNjZXNzVG9rZW46IGMuYm9keS5pZFRva2VuLmFjY2Vzc1Rva2VuXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGRhdGEuZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBkYXRhLmVycm9yXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjLCBkYXRhLmRhdGEpO1xuICAgICAgcmV0dXJuIGMuanNvbih7XG4gICAgICAgIHJlZGlyZWN0OiBmYWxzZSxcbiAgICAgICAgdG9rZW46IGRhdGEuZGF0YS5zZXNzaW9uLnRva2VuLFxuICAgICAgICB1cmw6IHZvaWQgMCxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBkYXRhLmRhdGEudXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogZGF0YS5kYXRhLnVzZXIuZW1haWwsXG4gICAgICAgICAgbmFtZTogZGF0YS5kYXRhLnVzZXIubmFtZSxcbiAgICAgICAgICBpbWFnZTogZGF0YS5kYXRhLnVzZXIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZGF0YS5kYXRhLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGRhdGEuZGF0YS51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IGRhdGEuZGF0YS51c2VyLnVwZGF0ZWRBdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBjb2RlVmVyaWZpZXIsIHN0YXRlIH0gPSBhd2FpdCBnZW5lcmF0ZVN0YXRlKGMpO1xuICAgIGNvbnN0IHVybCA9IGF3YWl0IHByb3ZpZGVyLmNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGUsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSTogYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2NhbGxiYWNrLyR7cHJvdmlkZXIuaWR9YFxuICAgIH0pO1xuICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgdXJsOiB1cmwudG9TdHJpbmcoKSxcbiAgICAgIHJlZGlyZWN0OiAhYy5ib2R5LmRpc2FibGVSZWRpcmVjdFxuICAgIH0pO1xuICB9XG4pO1xudmFyIHNpZ25JbkVtYWlsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLWluL2VtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogRW1haWwgb2YgdGhlIHVzZXJcbiAgICAgICAqL1xuICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgb2YgdGhlIHVzZXJcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIFBhc3N3b3JkIG9mIHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIHBhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlBhc3N3b3JkIG9mIHRoZSB1c2VyXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBDYWxsYmFjayBVUkwgdG8gdXNlIGFzIGEgcmVkaXJlY3QgZm9yIGVtYWlsXG4gICAgICAgKiB2ZXJpZmljYXRpb24gYW5kIGZvciBwb3NzaWJsZSByZWRpcmVjdHNcbiAgICAgICAqL1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ2FsbGJhY2sgVVJMIHRvIHVzZSBhcyBhIHJlZGlyZWN0IGZvciBlbWFpbCB2ZXJpZmljYXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogSWYgdGhpcyBpcyBmYWxzZSwgdGhlIHNlc3Npb24gd2lsbCBub3QgYmUgcmVtZW1iZXJlZFxuICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICovXG4gICAgICByZW1lbWJlck1lOiB6LmJvb2xlYW4oe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJJZiB0aGlzIGlzIGZhbHNlLCB0aGUgc2Vzc2lvbiB3aWxsIG5vdCBiZSByZW1lbWJlcmVkLiBEZWZhdWx0IGlzIGB0cnVlYC5cIlxuICAgICAgfSkuZGVmYXVsdCh0cnVlKS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZFwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJzZXNzaW9uXCIsIFwidXNlclwiLCBcInVybFwiLCBcInJlZGlyZWN0XCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbEFuZFBhc3N3b3JkPy5lbmFibGVkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiRW1haWwgYW5kIHBhc3N3b3JkIGlzIG5vdCBlbmFibGVkLiBNYWtlIHN1cmUgdG8gZW5hYmxlIGl0IGluIHRoZSBvcHRpb25zIG9uIHlvdSBgYXV0aC50c2AgZmlsZS4gQ2hlY2sgYGh0dHBzOi8vYmV0dGVyLWF1dGguY29tL2RvY3MvYXV0aGVudGljYXRpb24vZW1haWwtcGFzc3dvcmRgIGZvciBtb3JlIVwiXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGFuZCBwYXNzd29yZCBpcyBub3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IGlzVmFsaWRFbWFpbCA9IHouc3RyaW5nKCkuZW1haWwoKS5zYWZlUGFyc2UoZW1haWwpO1xuICAgIGlmICghaXNWYWxpZEVtYWlsLnN1Y2Nlc3MpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwsIHtcbiAgICAgIGluY2x1ZGVBY2NvdW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGlmICghdXNlcikge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChwYXNzd29yZCk7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVc2VyIG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3JlZGVudGlhbEFjY291bnQgPSB1c2VyLmFjY291bnRzLmZpbmQoXG4gICAgICAoYSkgPT4gYS5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIlxuICAgICk7XG4gICAgaWYgKCFjcmVkZW50aWFsQWNjb3VudCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiQ3JlZGVudGlhbCBhY2NvdW50IG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3VycmVudFBhc3N3b3JkID0gY3JlZGVudGlhbEFjY291bnQ/LnBhc3N3b3JkO1xuICAgIGlmICghY3VycmVudFBhc3N3b3JkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHZhbGlkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgaGFzaDogY3VycmVudFBhc3N3b3JkLFxuICAgICAgcGFzc3dvcmRcbiAgICB9KTtcbiAgICBpZiAoIXZhbGlkUGFzc3dvcmQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkludmFsaWQgcGFzc3dvcmRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucz8uZW1haWxBbmRQYXNzd29yZD8ucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uICYmICF1c2VyLnVzZXIuZW1haWxWZXJpZmllZCkge1xuICAgICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5FTUFJTF9OT1RfVkVSSUZJRURcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oXG4gICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgdXNlci51c2VyLmVtYWlsLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLnNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICAgICAge1xuICAgICAgICAgIHVzZXI6IHVzZXIudXNlcixcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgdG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkVNQUlMX05PVF9WRVJJRklFRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgIHVzZXIudXNlci5pZCxcbiAgICAgIGN0eC5oZWFkZXJzLFxuICAgICAgY3R4LmJvZHkucmVtZW1iZXJNZSA9PT0gZmFsc2VcbiAgICApO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgY3R4LFxuICAgICAge1xuICAgICAgICBzZXNzaW9uLFxuICAgICAgICB1c2VyOiB1c2VyLnVzZXJcbiAgICAgIH0sXG4gICAgICBjdHguYm9keS5yZW1lbWJlck1lID09PSBmYWxzZVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHJlZGlyZWN0OiAhIWN0eC5ib2R5LmNhbGxiYWNrVVJMLFxuICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICB1cmw6IGN0eC5ib2R5LmNhbGxiYWNrVVJMLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogdXNlci51c2VyLmlkLFxuICAgICAgICBlbWFpbDogdXNlci51c2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiB1c2VyLnVzZXIubmFtZSxcbiAgICAgICAgaW1hZ2U6IHVzZXIudXNlci5pbWFnZSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci51c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogdXNlci51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVzZXIudXBkYXRlZEF0XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbik7XG52YXIgc2NoZW1hID0gei5vYmplY3Qoe1xuICBjb2RlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGVycm9yOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGVycm9yX2Rlc2NyaXB0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHN0YXRlOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIGNhbGxiYWNrT0F1dGggPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2NhbGxiYWNrLzppZFwiLFxuICB7XG4gICAgbWV0aG9kOiBbXCJHRVRcIiwgXCJQT1NUXCJdLFxuICAgIGJvZHk6IHNjaGVtYS5vcHRpb25hbCgpLFxuICAgIHF1ZXJ5OiBzY2hlbWEub3B0aW9uYWwoKSxcbiAgICBtZXRhZGF0YTogSElERV9NRVRBREFUQVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGxldCBxdWVyeU9yQm9keTtcbiAgICB0cnkge1xuICAgICAgaWYgKGMubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgICAgIHF1ZXJ5T3JCb2R5ID0gc2NoZW1hLnBhcnNlKGMucXVlcnkpO1xuICAgICAgfSBlbHNlIGlmIChjLm1ldGhvZCA9PT0gXCJQT1NUXCIpIHtcbiAgICAgICAgcXVlcnlPckJvZHkgPSBzY2hlbWEucGFyc2UoYy5ib2R5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIG1ldGhvZFwiKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSU5WQUxJRF9DQUxMQkFDS19SRVFVRVNUXCIsIGUpO1xuICAgICAgdGhyb3cgYy5yZWRpcmVjdChcbiAgICAgICAgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPWludmFsaWRfY2FsbGJhY2tfcmVxdWVzdGBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHsgY29kZSwgZXJyb3I6IGVycm9yMiwgc3RhdGUsIGVycm9yX2Rlc2NyaXB0aW9uIH0gPSBxdWVyeU9yQm9keTtcbiAgICBpZiAoIXN0YXRlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiU3RhdGUgbm90IGZvdW5kXCIsIGVycm9yMik7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1zdGF0ZV9ub3RfZm91bmRgKTtcbiAgICB9XG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiQ29kZSBub3QgZm91bmRcIik7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgICBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9JHtlcnJvcjIgfHwgXCJub19jb2RlXCJ9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb259YFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjLmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gYy5wYXJhbXMuaWRcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiT2F1dGggcHJvdmlkZXIgd2l0aCBpZFwiLFxuICAgICAgICBjLnBhcmFtcy5pZCxcbiAgICAgICAgXCJub3QgZm91bmRcIlxuICAgICAgKTtcbiAgICAgIHRocm93IGMucmVkaXJlY3QoXG4gICAgICAgIGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcj9lcnJvcj1vYXV0aF9wcm92aWRlcl9ub3RfZm91bmRgXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB7IGNvZGVWZXJpZmllciwgY2FsbGJhY2tVUkwsIGxpbmssIGVycm9yVVJMLCBuZXdVc2VyVVJMIH0gPSBhd2FpdCBwYXJzZVN0YXRlKGMpO1xuICAgIGxldCB0b2tlbnM7XG4gICAgdHJ5IHtcbiAgICAgIHRva2VucyA9IGF3YWl0IHByb3ZpZGVyLnZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBgJHtjLmNvbnRleHQuYmFzZVVSTH0vY2FsbGJhY2svJHtwcm92aWRlci5pZH1gXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiXCIsIGUpO1xuICAgICAgdGhyb3cgYy5yZWRpcmVjdChcbiAgICAgICAgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yP2Vycm9yPXBsZWFzZV9yZXN0YXJ0X3RoZV9wcm9jZXNzYFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdXNlckluZm8gPSBhd2FpdCBwcm92aWRlci5nZXRVc2VySW5mbyh0b2tlbnMpLnRoZW4oKHJlcykgPT4gcmVzPy51c2VyKTtcbiAgICBmdW5jdGlvbiByZWRpcmVjdE9uRXJyb3IoZXJyb3IzKSB7XG4gICAgICBsZXQgdXJsID0gZXJyb3JVUkwgfHwgY2FsbGJhY2tVUkwgfHwgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYDtcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoXCI/XCIpKSB7XG4gICAgICAgIHVybCA9IGAke3VybH0mZXJyb3I9JHtlcnJvcjN9YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVybCA9IGAke3VybH0/ZXJyb3I9JHtlcnJvcjN9YDtcbiAgICAgIH1cbiAgICAgIHRocm93IGMucmVkaXJlY3QodXJsKTtcbiAgICB9XG4gICAgaWYgKCF1c2VySW5mbykge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVuYWJsZSB0byBnZXQgdXNlciBpbmZvXCIpO1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInVuYWJsZV90b19nZXRfdXNlcl9pbmZvXCIpO1xuICAgIH1cbiAgICBpZiAoIXVzZXJJbmZvLmVtYWlsKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlByb3ZpZGVyIGRpZCBub3QgcmV0dXJuIGVtYWlsLiBUaGlzIGNvdWxkIGJlIGR1ZSB0byBtaXNjb25maWd1cmF0aW9uIGluIHRoZSBwcm92aWRlciBzZXR0aW5ncy5cIlxuICAgICAgKTtcbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJlbWFpbF9ub3RfZm91bmRcIik7XG4gICAgfVxuICAgIGlmICghY2FsbGJhY2tVUkwpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJObyBjYWxsYmFjayBVUkwgZm91bmRcIik7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgICBgJHtjLmNvbnRleHQuYmFzZVVSTH0vZXJyb3I/ZXJyb3I9cGxlYXNlX3Jlc3RhcnRfdGhlX3Byb2Nlc3NgXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAobGluaykge1xuICAgICAgaWYgKGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5hbGxvd0RpZmZlcmVudEVtYWlscyAhPT0gdHJ1ZSAmJiBsaW5rLmVtYWlsICE9PSB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJlbWFpbF9kb2Vzbid0X21hdGNoXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgZXhpc3RpbmdBY2NvdW50ID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudChcbiAgICAgICAgdXNlckluZm8uaWRcbiAgICAgICk7XG4gICAgICBpZiAoZXhpc3RpbmdBY2NvdW50KSB7XG4gICAgICAgIGlmIChleGlzdGluZ0FjY291bnQgJiYgZXhpc3RpbmdBY2NvdW50LnVzZXJJZCAhPT0gbGluay51c2VySWQpIHtcbiAgICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiYWNjb3VudF9hbHJlYWR5X2xpbmtlZF90b19kaWZmZXJlbnRfdXNlclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiYWNjb3VudF9hbHJlYWR5X2xpbmtlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld0FjY291bnQgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoe1xuICAgICAgICB1c2VySWQ6IGxpbmsudXNlcklkLFxuICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZCxcbiAgICAgICAgLi4udG9rZW5zLFxuICAgICAgICBzY29wZTogdG9rZW5zLnNjb3Blcz8uam9pbihcIixcIilcbiAgICAgIH0pO1xuICAgICAgaWYgKCFuZXdBY2NvdW50KSB7XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmFibGVfdG9fbGlua19hY2NvdW50XCIpO1xuICAgICAgfVxuICAgICAgbGV0IHRvUmVkaXJlY3RUbzI7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB1cmwgPSBjYWxsYmFja1VSTDtcbiAgICAgICAgdG9SZWRpcmVjdFRvMiA9IHVybC50b1N0cmluZygpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHRvUmVkaXJlY3RUbzIgPSBjYWxsYmFja1VSTDtcbiAgICAgIH1cbiAgICAgIHRocm93IGMucmVkaXJlY3QodG9SZWRpcmVjdFRvMik7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZU9BdXRoVXNlckluZm8oYywge1xuICAgICAgdXNlckluZm86IHtcbiAgICAgICAgLi4udXNlckluZm8sXG4gICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbCxcbiAgICAgICAgbmFtZTogdXNlckluZm8ubmFtZSB8fCB1c2VySW5mby5lbWFpbFxuICAgICAgfSxcbiAgICAgIGFjY291bnQ6IHtcbiAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIuaWQsXG4gICAgICAgIGFjY291bnRJZDogdXNlckluZm8uaWQsXG4gICAgICAgIC4uLnRva2VucyxcbiAgICAgICAgc2NvcGU6IHRva2Vucy5zY29wZXM/LmpvaW4oXCIsXCIpXG4gICAgICB9LFxuICAgICAgY2FsbGJhY2tVUkxcbiAgICB9KTtcbiAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKHJlc3VsdC5lcnJvci5zcGxpdChcIiBcIikuam9pbihcIl9cIikpO1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihyZXN1bHQuZXJyb3Iuc3BsaXQoXCIgXCIpLmpvaW4oXCJfXCIpKTtcbiAgICB9XG4gICAgY29uc3QgeyBzZXNzaW9uLCB1c2VyIH0gPSByZXN1bHQuZGF0YTtcbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGMsIHtcbiAgICAgIHNlc3Npb24sXG4gICAgICB1c2VyXG4gICAgfSk7XG4gICAgbGV0IHRvUmVkaXJlY3RUbztcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXJsID0gcmVzdWx0LmlzUmVnaXN0ZXIgPyBuZXdVc2VyVVJMIHx8IGNhbGxiYWNrVVJMIDogY2FsbGJhY2tVUkw7XG4gICAgICB0b1JlZGlyZWN0VG8gPSB1cmwudG9TdHJpbmcoKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHRvUmVkaXJlY3RUbyA9IHJlc3VsdC5pc1JlZ2lzdGVyID8gbmV3VXNlclVSTCB8fCBjYWxsYmFja1VSTCA6IGNhbGxiYWNrVVJMO1xuICAgIH1cbiAgICB0aHJvdyBjLnJlZGlyZWN0KHRvUmVkaXJlY3RUbyk7XG4gIH1cbik7XG52YXIgc2lnbk91dCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2lnbi1vdXRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBvdXQgdGhlIGN1cnJlbnQgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb25Db29raWVUb2tlbiA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uVG9rZW4ubmFtZSxcbiAgICAgIGN0eC5jb250ZXh0LnNlY3JldFxuICAgICk7XG4gICAgaWYgKCFzZXNzaW9uQ29va2llVG9rZW4pIHtcbiAgICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbihzZXNzaW9uQ29va2llVG9rZW4pO1xuICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuZnVuY3Rpb24gcmVkaXJlY3RFcnJvcihjdHgsIGNhbGxiYWNrVVJMLCBxdWVyeSkge1xuICBjb25zdCB1cmwgPSBjYWxsYmFja1VSTCA/IG5ldyBVUkwoY2FsbGJhY2tVUkwsIGN0eC5iYXNlVVJMKSA6IG5ldyBVUkwoYCR7Y3R4LmJhc2VVUkx9L2Vycm9yYCk7XG4gIGlmIChxdWVyeSlcbiAgICBPYmplY3QuZW50cmllcyhxdWVyeSkuZm9yRWFjaCgoW2ssIHZdKSA9PiB1cmwuc2VhcmNoUGFyYW1zLnNldChrLCB2KSk7XG4gIHJldHVybiB1cmwuaHJlZjtcbn1cbmZ1bmN0aW9uIHJlZGlyZWN0Q2FsbGJhY2soY3R4LCBjYWxsYmFja1VSTCwgcXVlcnkpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChjYWxsYmFja1VSTCwgY3R4LmJhc2VVUkwpO1xuICBpZiAocXVlcnkpXG4gICAgT2JqZWN0LmVudHJpZXMocXVlcnkpLmZvckVhY2goKFtrLCB2XSkgPT4gdXJsLnNlYXJjaFBhcmFtcy5zZXQoaywgdikpO1xuICByZXR1cm4gdXJsLmhyZWY7XG59XG52YXIgZm9yZ2V0UGFzc3dvcmQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2ZvcmdldC1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyIHRvIHNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0by5cbiAgICAgICAqL1xuICAgICAgZW1haWw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvXCJcbiAgICAgIH0pLmVtYWlsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmQuXG4gICAgICAgKiBJZiB0aGUgdG9rZW4gaXNuJ3QgdmFsaWQgb3IgZXhwaXJlZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/XG4gICAgICAgKiBlcnJvcj1JTlZBTElEX1RPS0VOYC4gSWYgdGhlIHRva2VuIGlzIHZhbGlkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9cbiAgICAgICAqIHRva2VuPVZBTElEX1RPS0VOXG4gICAgICAgKi9cbiAgICAgIHJlZGlyZWN0VG86IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZC4gSWYgdGhlIHRva2VuIGlzbid0IHZhbGlkIG9yIGV4cGlyZWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP2Vycm9yPUlOVkFMSURfVE9LRU5gLiBJZiB0aGUgdG9rZW4gaXMgdmFsaWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP3Rva2VuPVZBTElEX1RPS0VOXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5zZW5kUmVzZXRQYXNzd29yZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlJlc2V0IHBhc3N3b3JkIGlzbid0IGVuYWJsZWQuUGxlYXNlIHBhc3MgYW4gZW1haWxBbmRQYXNzd29yZC5zZW5kUmVzZXRQYXNzd29yZFRva2VuIGZ1bmN0aW9uIGluIHlvdXIgYXV0aCBjb25maWchXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiUmVzZXQgcGFzc3dvcmQgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCwgcmVkaXJlY3RUbyB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwsIHtcbiAgICAgIGluY2x1ZGVBY2NvdW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGlmICghdXNlcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUmVzZXQgUGFzc3dvcmQ6IFVzZXIgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oXG4gICAgICAgIHtcbiAgICAgICAgICBzdGF0dXM6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGRlZmF1bHRFeHBpcmVzSW4gPSA2MCAqIDYwICogMTtcbiAgICBjb25zdCBleHBpcmVzQXQgPSBnZXREYXRlKFxuICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnJlc2V0UGFzc3dvcmRUb2tlbkV4cGlyZXNJbiB8fCBkZWZhdWx0RXhwaXJlc0luLFxuICAgICAgXCJzZWNcIlxuICAgICk7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uVG9rZW4gPSBnZW5lcmF0ZUlkKDI0KTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoe1xuICAgICAgdmFsdWU6IHVzZXIudXNlci5pZC50b1N0cmluZygpLFxuICAgICAgaWRlbnRpZmllcjogYHJlc2V0LXBhc3N3b3JkOiR7dmVyaWZpY2F0aW9uVG9rZW59YCxcbiAgICAgIGV4cGlyZXNBdFxuICAgIH0pO1xuICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3Jlc2V0LXBhc3N3b3JkLyR7dmVyaWZpY2F0aW9uVG9rZW59P2NhbGxiYWNrVVJMPSR7cmVkaXJlY3RUb31gO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5zZW5kUmVzZXRQYXNzd29yZChcbiAgICAgIHtcbiAgICAgICAgdXNlcjogdXNlci51c2VyLFxuICAgICAgICB1cmwsXG4gICAgICAgIHRva2VuOiB2ZXJpZmljYXRpb25Ub2tlblxuICAgICAgfSxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG52YXIgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjayA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVzZXQtcGFzc3dvcmQvOnRva2VuXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmRcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtvcmlnaW5DaGVjaygoY3R4KSA9PiBjdHgucXVlcnkuY2FsbGJhY2tVUkwpXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZWRpcmVjdHMgdGhlIHVzZXIgdG8gdGhlIGNhbGxiYWNrIFVSTCB3aXRoIHRoZSB0b2tlblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHsgdG9rZW4gfSA9IGN0eC5wYXJhbXM7XG4gICAgY29uc3QgeyBjYWxsYmFja1VSTCB9ID0gY3R4LnF1ZXJ5O1xuICAgIGlmICghdG9rZW4gfHwgIWNhbGxiYWNrVVJMKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoXG4gICAgICAgIHJlZGlyZWN0RXJyb3IoY3R4LmNvbnRleHQsIGNhbGxiYWNrVVJMLCB7IGVycm9yOiBcIklOVkFMSURfVE9LRU5cIiB9KVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIGByZXNldC1wYXNzd29yZDoke3Rva2VufWBcbiAgICApO1xuICAgIGlmICghdmVyaWZpY2F0aW9uIHx8IHZlcmlmaWNhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgICByZWRpcmVjdEVycm9yKGN0eC5jb250ZXh0LCBjYWxsYmFja1VSTCwgeyBlcnJvcjogXCJJTlZBTElEX1RPS0VOXCIgfSlcbiAgICAgICk7XG4gICAgfVxuICAgIHRocm93IGN0eC5yZWRpcmVjdChyZWRpcmVjdENhbGxiYWNrKGN0eC5jb250ZXh0LCBjYWxsYmFja1VSTCwgeyB0b2tlbiB9KSk7XG4gIH1cbik7XG52YXIgcmVzZXRQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVzZXQtcGFzc3dvcmRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KS5vcHRpb25hbCgpLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG5ld1Bhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XCJcbiAgICAgIH0pLFxuICAgICAgdG9rZW46IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIHJlc2V0IHRoZSBwYXNzd29yZFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVzZXQgdGhlIHBhc3N3b3JkIGZvciBhIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHRva2VuID0gY3R4LmJvZHkudG9rZW4gfHwgY3R4LnF1ZXJ5Py50b2tlbjtcbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgbmV3UGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IG1pbkxlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkPy5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgY29uc3QgbWF4TGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQ/LmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgaWQgPSBgcmVzZXQtcGFzc3dvcmQ6JHt0b2tlbn1gO1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoaWQpO1xuICAgIGlmICghdmVyaWZpY2F0aW9uIHx8IHZlcmlmaWNhdGlvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUodmVyaWZpY2F0aW9uLmlkKTtcbiAgICBjb25zdCB1c2VySWQgPSB2ZXJpZmljYXRpb24udmFsdWU7XG4gICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHModXNlcklkKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZCgoYWMpID0+IGFjLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVBY2NvdW50KHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBwcm92aWRlcklkOiBcImNyZWRlbnRpYWxcIixcbiAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxuICAgICAgICBhY2NvdW50SWQ6IHVzZXJJZFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlUGFzc3dvcmQodXNlcklkLCBoYXNoZWRQYXNzd29yZCk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xudmFyIHVwZGF0ZVVzZXIgPSAoKSA9PiBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3VwZGF0ZS11c2VyXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoucmVjb3JkKHouc3RyaW5nKCksIHouYW55KCkpLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgJEluZmVyOiB7XG4gICAgICAgIGJvZHk6IHt9XG4gICAgICB9LFxuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJVcGRhdGUgdGhlIGN1cnJlbnQgdXNlclwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGltYWdlIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBib2R5ID0gY3R4LmJvZHk7XG4gICAgaWYgKGJvZHkuZW1haWwpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5FTUFJTF9DQU5fTk9UX0JFX1VQREFURURcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IG5hbWUsIGltYWdlLCAuLi5yZXN0IH0gPSBib2R5O1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGlmIChpbWFnZSA9PT0gdm9pZCAwICYmIG5hbWUgPT09IHZvaWQgMCAmJiBPYmplY3Qua2V5cyhyZXN0KS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkZGl0aW9uYWxGaWVsZHMgPSBwYXJzZVVzZXJJbnB1dChcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMsXG4gICAgICByZXN0LFxuICAgICAgXCJ1cGRhdGVcIlxuICAgICk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkLFxuICAgICAge1xuICAgICAgICBuYW1lLFxuICAgICAgICBpbWFnZSxcbiAgICAgICAgLi4uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfVxuICAgICk7XG4gICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvbixcbiAgICAgIHVzZXJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG52YXIgY2hhbmdlUGFzc3dvcmQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2NoYW5nZS1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XG4gICAgICAgKi9cbiAgICAgIG5ld1Bhc3N3b3JkOiB6LnN0cmluZyh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgY3VycmVudCBwYXNzd29yZCBvZiB0aGUgdXNlclxuICAgICAgICovXG4gICAgICBjdXJyZW50UGFzc3dvcmQ6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGN1cnJlbnQgcGFzc3dvcmRcIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIHJldm9rZSBhbGwgc2Vzc2lvbnMgdGhhdCBhcmUgbm90IHRoZVxuICAgICAgICogY3VycmVudCBvbmUgbG9nZ2VkIGluIGJ5IHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIHJldm9rZU90aGVyU2Vzc2lvbnM6IHouYm9vbGVhbih7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhbGwgb3RoZXIgc2Vzc2lvbnNcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDaGFuZ2UgdGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdXNlciBvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCwgY3VycmVudFBhc3N3b3JkLCByZXZva2VPdGhlclNlc3Npb25zOiByZXZva2VPdGhlclNlc3Npb25zMiB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgbWluUGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA8IG1pblBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gc2hvcnRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWF4UGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA+IG1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gbG9uZ1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fTE9OR1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiICYmIGFjY291bnQyLnBhc3N3b3JkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnQgfHwgIWFjY291bnQucGFzc3dvcmQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5DUkVERU5USUFMX0FDQ09VTlRfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcGFzc3dvcmRIYXNoID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChuZXdQYXNzd29yZCk7XG4gICAgY29uc3QgdmVyaWZ5ID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICAgIGhhc2g6IGFjY291bnQucGFzc3dvcmQsXG4gICAgICBwYXNzd29yZDogY3VycmVudFBhc3N3b3JkXG4gICAgfSk7XG4gICAgaWYgKCF2ZXJpZnkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZUFjY291bnQoYWNjb3VudC5pZCwge1xuICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkSGFzaFxuICAgIH0pO1xuICAgIGxldCB0b2tlbiA9IG51bGw7XG4gICAgaWYgKHJldm9rZU90aGVyU2Vzc2lvbnMyKSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBjdHguaGVhZGVyc1xuICAgICAgKTtcbiAgICAgIGlmICghbmV3U2Vzc2lvbikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0dFVF9TRVNTSU9OXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgc2Vzc2lvbjogbmV3U2Vzc2lvbixcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyXG4gICAgICB9KTtcbiAgICAgIHRva2VuID0gbmV3U2Vzc2lvbi50b2tlbjtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHRva2VuLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBlbWFpbDogc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiBzZXNzaW9uLnVzZXIubmFtZSxcbiAgICAgICAgaW1hZ2U6IHNlc3Npb24udXNlci5pbWFnZSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogc2Vzc2lvbi51c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogc2Vzc2lvbi51c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgdXBkYXRlZEF0OiBzZXNzaW9uLnVzZXIudXBkYXRlZEF0XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbik7XG52YXIgc2V0UGFzc3dvcmQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3NldC1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XG4gICAgICAgKi9cbiAgICAgIG5ld1Bhc3N3b3JkOiB6LnN0cmluZygpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIFNFUlZFUl9PTkxZOiB0cnVlXG4gICAgfSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHsgbmV3UGFzc3dvcmQgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGNvbnN0IG1pblBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1pblBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPCBtaW5QYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIHNob3J0XCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19TSE9SVFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1heFBhc3N3b3JkTGVuZ3RoID0gY3R4LmNvbnRleHQucGFzc3dvcmQuY29uZmlnLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPiBtYXhQYXNzd29yZExlbmd0aCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiUGFzc3dvcmQgaXMgdG9vIGxvbmdcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX0xPTkdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKFxuICAgICAgKGFjY291bnQyKSA9PiBhY2NvdW50Mi5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIiAmJiBhY2NvdW50Mi5wYXNzd29yZFxuICAgICk7XG4gICAgY29uc3QgcGFzc3dvcmRIYXNoID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChuZXdQYXNzd29yZCk7XG4gICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoe1xuICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgcHJvdmlkZXJJZDogXCJjcmVkZW50aWFsXCIsXG4gICAgICAgIGFjY291bnRJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRIYXNoXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwidXNlciBhbHJlYWR5IGhhcyBhIHBhc3N3b3JkXCJcbiAgICB9KTtcbiAgfVxuKTtcbnZhciBkZWxldGVVc2VyID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9kZWxldGUtdXNlclwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgY2FsbGJhY2sgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGlzIGRlbGV0ZWRcbiAgICAgICAqIHRoaXMgaXMgb25seSB1c2VkIG9uIGRlbGV0ZSB1c2VyIGNhbGxiYWNrXG4gICAgICAgKi9cbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBwYXNzd29yZCBvZiB0aGUgdXNlci4gSWYgdGhlIHBhc3N3b3JkIGlzbid0IHByb3ZpZGVkLCBzZXNzaW9uIGZyZXNobmVzc1xuICAgICAgICogd2lsbCBiZSBjaGVja2VkLlxuICAgICAgICovXG4gICAgICBwYXNzd29yZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgdG9rZW4gdG8gZGVsZXRlIHRoZSB1c2VyLiBJZiB0aGUgdG9rZW4gaXMgcHJvdmlkZWQsIHRoZSB1c2VyIHdpbGwgYmUgZGVsZXRlZFxuICAgICAgICovXG4gICAgICB0b2tlbjogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGVsZXRlIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uZGVsZXRlVXNlcj8uZW5hYmxlZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIkRlbGV0ZSB1c2VyIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gdGhlIG9wdGlvbnNcIixcbiAgICAgICAge1xuICAgICAgICAgIHNlc3Npb246IGN0eC5jb250ZXh0LnNlc3Npb25cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgaWYgKGN0eC5ib2R5LnBhc3N3b3JkKSB7XG4gICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50cy5maW5kKFxuICAgICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiICYmIGFjY291bnQyLnBhc3N3b3JkXG4gICAgICApO1xuICAgICAgaWYgKCFhY2NvdW50IHx8ICFhY2NvdW50LnBhc3N3b3JkKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkNSRURFTlRJQUxfQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB2ZXJpZnkgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgICBoYXNoOiBhY2NvdW50LnBhc3N3b3JkLFxuICAgICAgICBwYXNzd29yZDogY3R4LmJvZHkucGFzc3dvcmRcbiAgICAgIH0pO1xuICAgICAgaWYgKCF2ZXJpZnkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9QQVNTV09SRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uZnJlc2hBZ2UpIHtcbiAgICAgICAgY29uc3QgY3VycmVudEFnZSA9IHNlc3Npb24uc2Vzc2lvbi5jcmVhdGVkQXQuZ2V0VGltZSgpO1xuICAgICAgICBjb25zdCBmcmVzaEFnZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbi5mcmVzaEFnZTtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKG5vdyAtIGN1cnJlbnRBZ2UgPiBmcmVzaEFnZSkge1xuICAgICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuU0VTU0lPTl9FWFBJUkVEXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGN0eC5ib2R5LnRva2VuKSB7XG4gICAgICBhd2FpdCBkZWxldGVVc2VyQ2FsbGJhY2soe1xuICAgICAgICAuLi5jdHgsXG4gICAgICAgIHF1ZXJ5OiB7XG4gICAgICAgICAgdG9rZW46IGN0eC5ib2R5LnRva2VuXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogXCJVc2VyIGRlbGV0ZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uc2VuZERlbGV0ZUFjY291bnRWZXJpZmljYXRpb24pIHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVSYW5kb21TdHJpbmcoMzIsIFwiMC05XCIsIFwiYS16XCIpO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKHtcbiAgICAgICAgdmFsdWU6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgaWRlbnRpZmllcjogYGRlbGV0ZS1hY2NvdW50LSR7dG9rZW59YCxcbiAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMWUzICogNjAgKiA2MCAqIDI0KVxuICAgICAgfSk7XG4gICAgICBjb25zdCB1cmwgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS9kZWxldGUtdXNlci9jYWxsYmFjaz90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlci5zZW5kRGVsZXRlQWNjb3VudFZlcmlmaWNhdGlvbihcbiAgICAgICAge1xuICAgICAgICAgIHVzZXI6IHNlc3Npb24udXNlcixcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgdG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgY3R4LnJlcXVlc3RcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBzZW50XCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBiZWZvcmVEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYmVmb3JlRGVsZXRlO1xuICAgIGlmIChiZWZvcmVEZWxldGUpIHtcbiAgICAgIGF3YWl0IGJlZm9yZURlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudHMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgY29uc3QgYWZ0ZXJEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYWZ0ZXJEZWxldGU7XG4gICAgaWYgKGFmdGVyRGVsZXRlKSB7XG4gICAgICBhd2FpdCBhZnRlckRlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZFwiXG4gICAgfSk7XG4gIH1cbik7XG52YXIgZGVsZXRlVXNlckNhbGxiYWNrID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9kZWxldGUtdXNlci9jYWxsYmFja1wiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICB0b2tlbjogei5zdHJpbmcoKSxcbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtvcmlnaW5DaGVjaygoY3R4KSA9PiBjdHgucXVlcnkuY2FsbGJhY2tVUkwpXVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLnVzZXI/LmRlbGV0ZVVzZXI/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJEZWxldGUgdXNlciBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHRoZSBvcHRpb25zXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIik7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIGBkZWxldGUtYWNjb3VudC0ke2N0eC5xdWVyeS50b2tlbn1gXG4gICAgKTtcbiAgICBpZiAoIXRva2VuIHx8IHRva2VuLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKHRva2VuLmlkKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICh0b2tlbi52YWx1ZSAhPT0gc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBiZWZvcmVEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYmVmb3JlRGVsZXRlO1xuICAgIGlmIChiZWZvcmVEZWxldGUpIHtcbiAgICAgIGF3YWl0IGJlZm9yZURlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudHMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlVmVyaWZpY2F0aW9uVmFsdWUodG9rZW4uaWQpO1xuICAgIGRlbGV0ZVNlc3Npb25Db29raWUoY3R4KTtcbiAgICBjb25zdCBhZnRlckRlbGV0ZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5kZWxldGVVc2VyPy5hZnRlckRlbGV0ZTtcbiAgICBpZiAoYWZ0ZXJEZWxldGUpIHtcbiAgICAgIGF3YWl0IGFmdGVyRGVsZXRlKHNlc3Npb24udXNlciwgY3R4LnJlcXVlc3QpO1xuICAgIH1cbiAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMIHx8IFwiL1wiKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZFwiXG4gICAgfSk7XG4gIH1cbik7XG52YXIgY2hhbmdlRW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2NoYW5nZS1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBuZXdFbWFpbDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmV3IGVtYWlsIHRvIHNldFwiXG4gICAgICB9KS5lbWFpbCgpLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciBlbWFpbCB2ZXJpZmljYXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLnVzZXI/LmNoYW5nZUVtYWlsPy5lbmFibGVkKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJDaGFuZ2UgZW1haWwgaXMgZGlzYWJsZWQuXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkNoYW5nZSBlbWFpbCBpcyBkaXNhYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGN0eC5ib2R5Lm5ld0VtYWlsID09PSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWwpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkVtYWlsIGlzIHRoZSBzYW1lXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGlzIHRoZSBzYW1lXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKFxuICAgICAgY3R4LmJvZHkubmV3RW1haWxcbiAgICApO1xuICAgIGlmIChleGlzdGluZ1VzZXIpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkVtYWlsIGFscmVhZHkgZXhpc3RzXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkNvdWxkbid0IHVwZGF0ZSB5b3VyIGVtYWlsXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsVmVyaWZpZWQgIT09IHRydWUpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyQnlFbWFpbChcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgICB7XG4gICAgICAgICAgZW1haWw6IGN0eC5ib2R5Lm5ld0VtYWlsXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5jaGFuZ2VFbWFpbC5zZW5kQ2hhbmdlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgY3R4LmJvZHkubmV3RW1haWwsXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICApO1xuICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmNoYW5nZUVtYWlsLnNlbmRDaGFuZ2VFbWFpbFZlcmlmaWNhdGlvbihcbiAgICAgIHtcbiAgICAgICAgdXNlcjogY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLFxuICAgICAgICBuZXdFbWFpbDogY3R4LmJvZHkubmV3RW1haWwsXG4gICAgICAgIHVybCxcbiAgICAgICAgdG9rZW5cbiAgICAgIH0sXG4gICAgICBjdHgucmVxdWVzdFxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG4vLyBzcmMvYXBpL3JvdXRlcy9lcnJvci50c1xuZnVuY3Rpb24gc2FuaXRpemUoaW5wdXQpIHtcbiAgcmV0dXJuIGlucHV0LnJlcGxhY2UoLyYvZywgXCImYW1wO1wiKS5yZXBsYWNlKC88L2csIFwiJmx0O1wiKS5yZXBsYWNlKC8+L2csIFwiJmd0O1wiKS5yZXBsYWNlKC9cIi9nLCBcIiZxdW90O1wiKS5yZXBsYWNlKC8nL2csIFwiJiMzOTtcIik7XG59XG52YXIgaHRtbCA9IChlcnJvckNvZGUgPSBcIlVua25vd25cIikgPT4gYDwhRE9DVFlQRSBodG1sPlxuPGh0bWwgbGFuZz1cImVuXCI+XG48aGVhZD5cbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgICA8bWV0YSBuYW1lPVwidmlld3BvcnRcIiBjb250ZW50PVwid2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMFwiPlxuICAgIDx0aXRsZT5BdXRoZW50aWNhdGlvbiBFcnJvcjwvdGl0bGU+XG4gICAgPHN0eWxlPlxuICAgICAgICA6cm9vdCB7XG4gICAgICAgICAgICAtLWJnLWNvbG9yOiAjZjhmOWZhO1xuICAgICAgICAgICAgLS10ZXh0LWNvbG9yOiAjMjEyNTI5O1xuICAgICAgICAgICAgLS1hY2NlbnQtY29sb3I6ICMwMDAwMDA7XG4gICAgICAgICAgICAtLWVycm9yLWNvbG9yOiAjZGMzNTQ1O1xuICAgICAgICAgICAgLS1ib3JkZXItY29sb3I6ICNlOWVjZWY7XG4gICAgICAgIH1cbiAgICAgICAgYm9keSB7XG4gICAgICAgICAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBSb2JvdG8sICdIZWx2ZXRpY2EgTmV1ZScsIEFyaWFsLCBzYW5zLXNlcmlmO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmctY29sb3IpO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpO1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGhlaWdodDogMTAwdmg7XG4gICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMS41O1xuICAgICAgICB9XG4gICAgICAgIC5lcnJvci1jb250YWluZXIge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjA1KTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDIuNXJlbTtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIG1heC13aWR0aDogOTAlO1xuICAgICAgICAgICAgd2lkdGg6IDQwMHB4O1xuICAgICAgICB9XG4gICAgICAgIGgxIHtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNzVyZW07XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgfVxuICAgICAgICBwIHtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEuNXJlbTtcbiAgICAgICAgICAgIGNvbG9yOiAjNDk1MDU3O1xuICAgICAgICB9XG4gICAgICAgIC5idG4ge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTtcbiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgICAgICAgICAgcGFkZGluZzogMC43NXJlbSAxLjVyZW07XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlO1xuICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWFjY2VudC1jb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0bjpob3ZlciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTMxNzIxO1xuICAgICAgICB9XG4gICAgICAgIC5lcnJvci1jb2RlIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NzVyZW07XG4gICAgICAgICAgICBjb2xvcjogIzZjNzU3ZDtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEuNXJlbTtcbiAgICAgICAgICAgIHBhZGRpbmctdG9wOiAxLjVyZW07XG4gICAgICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICAuaWNvbiB7XG4gICAgICAgICAgICBmb250LXNpemU6IDNyZW07XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICAgICAgICB9XG4gICAgPC9zdHlsZT5cbjwvaGVhZD5cbjxib2R5PlxuICAgIDxkaXYgY2xhc3M9XCJlcnJvci1jb250YWluZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImljb25cIj5cXHUyNkEwXFx1RkUwRjwvZGl2PlxuICAgICAgICA8aDE+QmV0dGVyIEF1dGggRXJyb3I8L2gxPlxuICAgICAgICA8cD5XZSBlbmNvdW50ZXJlZCBhbiBpc3N1ZSB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHRyeSBhZ2FpbiBvciBjb250YWN0IHRoZSBhcHBsaWNhdGlvbiBvd25lciBpZiB0aGUgcHJvYmxlbSBwZXJzaXN0cy48L3A+XG4gICAgICAgIDxhIGhyZWY9XCIvXCIgaWQ9XCJyZXR1cm5MaW5rXCIgY2xhc3M9XCJidG5cIj5SZXR1cm4gdG8gQXBwbGljYXRpb248L2E+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJlcnJvci1jb2RlXCI+RXJyb3IgQ29kZTogPHNwYW4gaWQ9XCJlcnJvckNvZGVcIj4ke3Nhbml0aXplKFxuICBlcnJvckNvZGVcbil9PC9zcGFuPjwvZGl2PlxuICAgIDwvZGl2PlxuPC9ib2R5PlxuPC9odG1sPmA7XG52YXIgZXJyb3IgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2Vycm9yXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIC4uLkhJREVfTUVUQURBVEEsXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc3BsYXlzIGFuIGVycm9yIHBhZ2VcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcInRleHQvaHRtbFwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IFVSTChjLnJlcXVlc3Q/LnVybCB8fCBcIlwiKS5zZWFyY2hQYXJhbXMuZ2V0KFwiZXJyb3JcIikgfHwgXCJVbmtub3duXCI7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShodG1sKHF1ZXJ5KSwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcInRleHQvaHRtbFwiXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbik7XG5cbi8vIHNyYy9hcGkvcm91dGVzL29rLnRzXG52YXIgb2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29rXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIC4uLkhJREVfTUVUQURBVEEsXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoZWNrIGlmIHRoZSBBUEkgaXMgd29ya2luZ1wiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBvazoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgb2s6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbnZhciBzaWduVXBFbWFpbCA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2lnbi11cC9lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6LnJlY29yZCh6LnN0cmluZygpLCB6LmFueSgpKSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgJEluZmVyOiB7XG4gICAgICAgIGJvZHk6IHt9XG4gICAgICB9LFxuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIHVwIGEgdXNlciB1c2luZyBlbWFpbCBhbmQgcGFzc3dvcmRcIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBjYWxsYmFja1VSTDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHVzZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGNhbGxiYWNrXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJuYW1lXCIsIFwiZW1haWxcIiwgXCJwYXNzd29yZFwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGlkIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBpbWFnZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJZiB0aGUgZW1haWwgaXMgdmVyaWZpZWRcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LmVuYWJsZWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJFbWFpbCBhbmQgcGFzc3dvcmQgc2lnbiB1cCBpcyBub3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYm9keSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHsgbmFtZSwgZW1haWwsIHBhc3N3b3JkLCBpbWFnZSwgY2FsbGJhY2tVUkwsIC4uLmFkZGl0aW9uYWxGaWVsZHMgfSA9IGJvZHk7XG4gICAgY29uc3QgaXNWYWxpZEVtYWlsID0gei5zdHJpbmcoKS5lbWFpbCgpLnNhZmVQYXJzZShlbWFpbCk7XG4gICAgaWYgKCFpc1ZhbGlkRW1haWwuc3VjY2Vzcykge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoIDwgbWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBzaG9ydFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoID4gbWF4UGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBsb25nXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgZGJVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgaWYgKGRiVXNlcj8udXNlcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmluZm8oYFNpZ24tdXAgYXR0ZW1wdCBmb3IgZXhpc3RpbmcgZW1haWw6ICR7ZW1haWx9YCk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9BTFJFQURZX0VYSVNUU1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkZGl0aW9uYWxEYXRhID0gcGFyc2VVc2VySW5wdXQoXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLFxuICAgICAgYWRkaXRpb25hbEZpZWxkc1xuICAgICk7XG4gICAgbGV0IGNyZWF0ZWRVc2VyO1xuICAgIHRyeSB7XG4gICAgICBjcmVhdGVkVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVVc2VyKHtcbiAgICAgICAgZW1haWw6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGltYWdlLFxuICAgICAgICAuLi5hZGRpdGlvbmFsRGF0YSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgaWYgKCFjcmVhdGVkVXNlcikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGlzRGV2ZWxvcG1lbnQpIHtcbiAgICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSB1c2VyXCIsIGUpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19DUkVBVEVfVVNFUixcbiAgICAgICAgZGV0YWlsczogZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghY3JlYXRlZFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBoYXNoID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChwYXNzd29yZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpbmtBY2NvdW50KHtcbiAgICAgIHVzZXJJZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICBwcm92aWRlcklkOiBcImNyZWRlbnRpYWxcIixcbiAgICAgIGFjY291bnRJZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICBwYXNzd29yZDogaGFzaFxuICAgIH0pO1xuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduVXAgfHwgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgIGNyZWF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2JvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHRva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLmF1dG9TaWduSW4gPT09IGZhbHNlIHx8IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IGNyZWF0ZWRVc2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiBjcmVhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiBjcmVhdGVkVXNlci5uYW1lLFxuICAgICAgICAgIGltYWdlOiBjcmVhdGVkVXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBjcmVhdGVkVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogY3JlYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogY3JlYXRlZFVzZXIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICBjcmVhdGVkVXNlci5pZCxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgc2Vzc2lvbixcbiAgICAgIHVzZXI6IGNyZWF0ZWRVc2VyXG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiBjcmVhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgbmFtZTogY3JlYXRlZFVzZXIubmFtZSxcbiAgICAgICAgaW1hZ2U6IGNyZWF0ZWRVc2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBjcmVhdGVkVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICBjcmVhdGVkQXQ6IGNyZWF0ZWRVc2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgdXBkYXRlZEF0OiBjcmVhdGVkVXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcbnZhciBsaXN0VXNlckFjY291bnRzID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saXN0LWFjY291bnRzXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3QgYWxsIGFjY291bnRzIGxpbmtlZCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICByZXR1cm4gYy5qc29uKFxuICAgICAgYWNjb3VudHMubWFwKChhKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IGEuaWQsXG4gICAgICAgICAgcHJvdmlkZXI6IGEucHJvdmlkZXJJZCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogYS51cGRhdGVkQXQsXG4gICAgICAgICAgYWNjb3VudElkOiBhLmFjY291bnRJZCxcbiAgICAgICAgICBzY29wZXM6IGEuc2NvcGU/LnNwbGl0KFwiLFwiKSB8fCBbXVxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApO1xuICB9XG4pO1xudmFyIGxpbmtTb2NpYWxBY2NvdW50ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saW5rLXNvY2lhbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBoYXMgc2lnbmVkIGluLlxuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSB1c2VyIGhhcyBzaWduZWQgaW5cIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT0F1dGgyIHByb3ZpZGVyIHRvIHVzZWBcbiAgICAgICAqL1xuICAgICAgcHJvdmlkZXI6IHouZW51bShzb2NpYWxQcm92aWRlckxpc3QsIHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIE9BdXRoMiBwcm92aWRlciB0byB1c2VcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTGluayBhIHNvY2lhbCBhY2NvdW50IHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInVybFwiLCBcInJlZGlyZWN0XCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGNvbnN0IGV4aXN0aW5nQWNjb3VudCA9IGFjY291bnQuZmluZChcbiAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IGMuYm9keS5wcm92aWRlclxuICAgICk7XG4gICAgaWYgKGV4aXN0aW5nQWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlNPQ0lBTF9BQ0NPVU5UX0FMUkVBRFlfTElOS0VEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjLmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gYy5ib2R5LnByb3ZpZGVyXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlByb3ZpZGVyIG5vdCBmb3VuZC4gTWFrZSBzdXJlIHRvIGFkZCB0aGUgcHJvdmlkZXIgaW4geW91ciBhdXRoIGNvbmZpZ1wiLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QUk9WSURFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IGdlbmVyYXRlU3RhdGUoYywge1xuICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICBlbWFpbDogc2Vzc2lvbi51c2VyLmVtYWlsXG4gICAgfSk7XG4gICAgY29uc3QgdXJsID0gYXdhaXQgcHJvdmlkZXIuY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICBzdGF0ZTogc3RhdGUuc3RhdGUsXG4gICAgICBjb2RlVmVyaWZpZXI6IHN0YXRlLmNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJOiBgJHtjLmNvbnRleHQuYmFzZVVSTH0vY2FsbGJhY2svJHtwcm92aWRlci5pZH1gXG4gICAgfSk7XG4gICAgcmV0dXJuIGMuanNvbih7XG4gICAgICB1cmw6IHVybC50b1N0cmluZygpLFxuICAgICAgcmVkaXJlY3Q6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbnZhciB1bmxpbmtBY2NvdW50ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi91bmxpbmstYWNjb3VudFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpXG4gICAgfSksXG4gICAgdXNlOiBbZnJlc2hTZXNzaW9uTWlkZGxld2FyZV1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgaWYgKGFjY291bnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19VTkxJTktfTEFTVF9BQ0NPVU5UXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudEV4aXN0ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2NvdW50KSA9PiBhY2NvdW50LnByb3ZpZGVySWQgPT09IGN0eC5ib2R5LnByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghYWNjb3VudEV4aXN0KSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudChcbiAgICAgIGN0eC5ib2R5LnByb3ZpZGVySWQsXG4gICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcblxuLy8gc3JjL2FwaS9yYXRlLWxpbWl0ZXIvaW5kZXgudHNcbmZ1bmN0aW9uIHNob3VsZFJhdGVMaW1pdChtYXgsIHdpbmRvdywgcmF0ZUxpbWl0RGF0YSkge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCB3aW5kb3dJbk1zID0gd2luZG93ICogMWUzO1xuICBjb25zdCB0aW1lU2luY2VMYXN0UmVxdWVzdCA9IG5vdyAtIHJhdGVMaW1pdERhdGEubGFzdFJlcXVlc3Q7XG4gIHJldHVybiB0aW1lU2luY2VMYXN0UmVxdWVzdCA8IHdpbmRvd0luTXMgJiYgcmF0ZUxpbWl0RGF0YS5jb3VudCA+PSBtYXg7XG59XG5mdW5jdGlvbiByYXRlTGltaXRSZXNwb25zZShyZXRyeUFmdGVyKSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgbWVzc2FnZTogXCJUb28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIlxuICAgIH0pLFxuICAgIHtcbiAgICAgIHN0YXR1czogNDI5LFxuICAgICAgc3RhdHVzVGV4dDogXCJUb28gTWFueSBSZXF1ZXN0c1wiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIlgtUmV0cnktQWZ0ZXJcIjogcmV0cnlBZnRlci50b1N0cmluZygpXG4gICAgICB9XG4gICAgfVxuICApO1xufVxuZnVuY3Rpb24gZ2V0UmV0cnlBZnRlcihsYXN0UmVxdWVzdCwgd2luZG93KSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IHdpbmRvd0luTXMgPSB3aW5kb3cgKiAxZTM7XG4gIHJldHVybiBNYXRoLmNlaWwoKGxhc3RSZXF1ZXN0ICsgd2luZG93SW5NcyAtIG5vdykgLyAxZTMpO1xufVxuZnVuY3Rpb24gY3JlYXRlREJTdG9yYWdlKGN0eCwgbW9kZWxOYW1lKSB7XG4gIGNvbnN0IG1vZGVsID0gY3R4Lm9wdGlvbnMucmF0ZUxpbWl0Py5tb2RlbE5hbWUgfHwgXCJyYXRlTGltaXRcIjtcbiAgY29uc3QgZGIgPSBjdHguYWRhcHRlcjtcbiAgcmV0dXJuIHtcbiAgICBnZXQ6IGFzeW5jIChrZXkpID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRiLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJrZXlcIiwgdmFsdWU6IGtleSB9XVxuICAgICAgfSk7XG4gICAgICBjb25zdCBkYXRhID0gcmVzWzBdO1xuICAgICAgaWYgKHR5cGVvZiBkYXRhPy5sYXN0UmVxdWVzdCA9PT0gXCJiaWdpbnRcIikge1xuICAgICAgICBkYXRhLmxhc3RSZXF1ZXN0ID0gTnVtYmVyKGRhdGEubGFzdFJlcXVlc3QpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcbiAgICBzZXQ6IGFzeW5jIChrZXksIHZhbHVlLCBfdXBkYXRlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoX3VwZGF0ZSkge1xuICAgICAgICAgIGF3YWl0IGRiLnVwZGF0ZU1hbnkoe1xuICAgICAgICAgICAgbW9kZWw6IG1vZGVsTmFtZSA/PyBcInJhdGVMaW1pdFwiLFxuICAgICAgICAgICAgd2hlcmU6IFt7IGZpZWxkOiBcImtleVwiLCB2YWx1ZToga2V5IH1dLFxuICAgICAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgICAgIGNvdW50OiB2YWx1ZS5jb3VudCxcbiAgICAgICAgICAgICAgbGFzdFJlcXVlc3Q6IHZhbHVlLmxhc3RSZXF1ZXN0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgZGIuY3JlYXRlKHtcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUgPz8gXCJyYXRlTGltaXRcIixcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXG4gICAgICAgICAgICAgIGxhc3RSZXF1ZXN0OiB2YWx1ZS5sYXN0UmVxdWVzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGN0eC5sb2dnZXIuZXJyb3IoXCJFcnJvciBzZXR0aW5nIHJhdGUgbGltaXRcIiwgZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxudmFyIG1lbW9yeSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRSYXRlTGltaXRTdG9yYWdlKGN0eCkge1xuICBpZiAoY3R4Lm9wdGlvbnMucmF0ZUxpbWl0Py5jdXN0b21TdG9yYWdlKSB7XG4gICAgcmV0dXJuIGN0eC5vcHRpb25zLnJhdGVMaW1pdC5jdXN0b21TdG9yYWdlO1xuICB9XG4gIGlmIChjdHgucmF0ZUxpbWl0LnN0b3JhZ2UgPT09IFwic2Vjb25kYXJ5LXN0b3JhZ2VcIikge1xuICAgIHJldHVybiB7XG4gICAgICBnZXQ6IGFzeW5jIChrZXkpID0+IHtcbiAgICAgICAgY29uc3Qgc3RyaW5naWZpZWQgPSBhd2FpdCBjdHgub3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlPy5nZXQoa2V5KTtcbiAgICAgICAgcmV0dXJuIHN0cmluZ2lmaWVkID8gSlNPTi5wYXJzZShzdHJpbmdpZmllZCkgOiB2b2lkIDA7XG4gICAgICB9LFxuICAgICAgc2V0OiBhc3luYyAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgICAgICBhd2FpdCBjdHgub3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlPy5zZXQ/LihrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBjb25zdCBzdG9yYWdlID0gY3R4LnJhdGVMaW1pdC5zdG9yYWdlO1xuICBpZiAoc3RvcmFnZSA9PT0gXCJtZW1vcnlcIikge1xuICAgIHJldHVybiB7XG4gICAgICBhc3luYyBnZXQoa2V5KSB7XG4gICAgICAgIHJldHVybiBtZW1vcnkuZ2V0KGtleSk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgc2V0KGtleSwgdmFsdWUsIF91cGRhdGUpIHtcbiAgICAgICAgbWVtb3J5LnNldChrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHJldHVybiBjcmVhdGVEQlN0b3JhZ2UoY3R4LCBjdHgucmF0ZUxpbWl0Lm1vZGVsTmFtZSk7XG59XG5hc3luYyBmdW5jdGlvbiBvblJlcXVlc3RSYXRlTGltaXQocmVxLCBjdHgpIHtcbiAgaWYgKCFjdHgucmF0ZUxpbWl0LmVuYWJsZWQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgYmFzZVVSTCA9IGN0eC5iYXNlVVJMO1xuICBjb25zdCBwYXRoID0gcmVxLnVybC5yZXBsYWNlKGJhc2VVUkwsIFwiXCIpLnNwbGl0KFwiP1wiKVswXTtcbiAgbGV0IHdpbmRvdyA9IGN0eC5yYXRlTGltaXQud2luZG93O1xuICBsZXQgbWF4ID0gY3R4LnJhdGVMaW1pdC5tYXg7XG4gIGNvbnN0IGtleSA9IGdldElwKHJlcSwgY3R4Lm9wdGlvbnMpICsgcGF0aDtcbiAgY29uc3Qgc3BlY2lhbFJ1bGVzID0gZ2V0RGVmYXVsdFNwZWNpYWxSdWxlcygpO1xuICBjb25zdCBzcGVjaWFsUnVsZSA9IHNwZWNpYWxSdWxlcy5maW5kKChydWxlKSA9PiBydWxlLnBhdGhNYXRjaGVyKHBhdGgpKTtcbiAgaWYgKHNwZWNpYWxSdWxlKSB7XG4gICAgd2luZG93ID0gc3BlY2lhbFJ1bGUud2luZG93O1xuICAgIG1heCA9IHNwZWNpYWxSdWxlLm1heDtcbiAgfVxuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBjdHgub3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgaWYgKHBsdWdpbi5yYXRlTGltaXQpIHtcbiAgICAgIGNvbnN0IG1hdGNoZWRSdWxlID0gcGx1Z2luLnJhdGVMaW1pdC5maW5kKFxuICAgICAgICAocnVsZSkgPT4gcnVsZS5wYXRoTWF0Y2hlcihwYXRoKVxuICAgICAgKTtcbiAgICAgIGlmIChtYXRjaGVkUnVsZSkge1xuICAgICAgICB3aW5kb3cgPSBtYXRjaGVkUnVsZS53aW5kb3c7XG4gICAgICAgIG1heCA9IG1hdGNoZWRSdWxlLm1heDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzKSB7XG4gICAgY29uc3QgX3BhdGggPSBPYmplY3Qua2V5cyhjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzKS5maW5kKChwKSA9PiB7XG4gICAgICBpZiAocC5pbmNsdWRlcyhcIipcIikpIHtcbiAgICAgICAgY29uc3QgaXNNYXRjaDIgPSB3aWxkY2FyZE1hdGNoKHApKHBhdGgpO1xuICAgICAgICByZXR1cm4gaXNNYXRjaDI7XG4gICAgICB9XG4gICAgICByZXR1cm4gcCA9PT0gcGF0aDtcbiAgICB9KTtcbiAgICBpZiAoX3BhdGgpIHtcbiAgICAgIGNvbnN0IGN1c3RvbVJ1bGUgPSBjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzW19wYXRoXTtcbiAgICAgIGNvbnN0IHJlc29sdmVkID0gdHlwZW9mIGN1c3RvbVJ1bGUgPT09IFwiZnVuY3Rpb25cIiA/IGF3YWl0IGN1c3RvbVJ1bGUocmVxKSA6IGN1c3RvbVJ1bGU7XG4gICAgICBpZiAocmVzb2x2ZWQpIHtcbiAgICAgICAgd2luZG93ID0gcmVzb2x2ZWQud2luZG93O1xuICAgICAgICBtYXggPSByZXNvbHZlZC5tYXg7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNvbnN0IHN0b3JhZ2UgPSBnZXRSYXRlTGltaXRTdG9yYWdlKGN0eCk7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBzdG9yYWdlLmdldChrZXkpO1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBpZiAoIWRhdGEpIHtcbiAgICBhd2FpdCBzdG9yYWdlLnNldChrZXksIHtcbiAgICAgIGtleSxcbiAgICAgIGNvdW50OiAxLFxuICAgICAgbGFzdFJlcXVlc3Q6IG5vd1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHRpbWVTaW5jZUxhc3RSZXF1ZXN0ID0gbm93IC0gZGF0YS5sYXN0UmVxdWVzdDtcbiAgICBpZiAoc2hvdWxkUmF0ZUxpbWl0KG1heCwgd2luZG93LCBkYXRhKSkge1xuICAgICAgY29uc3QgcmV0cnlBZnRlciA9IGdldFJldHJ5QWZ0ZXIoZGF0YS5sYXN0UmVxdWVzdCwgd2luZG93KTtcbiAgICAgIHJldHVybiByYXRlTGltaXRSZXNwb25zZShyZXRyeUFmdGVyKTtcbiAgICB9IGVsc2UgaWYgKHRpbWVTaW5jZUxhc3RSZXF1ZXN0ID4gd2luZG93ICogMWUzKSB7XG4gICAgICBhd2FpdCBzdG9yYWdlLnNldChcbiAgICAgICAga2V5LFxuICAgICAgICB7XG4gICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICBjb3VudDogMSxcbiAgICAgICAgICBsYXN0UmVxdWVzdDogbm93XG4gICAgICAgIH0sXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KFxuICAgICAgICBrZXksXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIGNvdW50OiBkYXRhLmNvdW50ICsgMSxcbiAgICAgICAgICBsYXN0UmVxdWVzdDogbm93XG4gICAgICAgIH0sXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBnZXREZWZhdWx0U3BlY2lhbFJ1bGVzKCkge1xuICBjb25zdCBzcGVjaWFsUnVsZXMgPSBbXG4gICAge1xuICAgICAgcGF0aE1hdGNoZXIocGF0aCkge1xuICAgICAgICByZXR1cm4gcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24taW5cIikgfHwgcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24tdXBcIikgfHwgcGF0aC5zdGFydHNXaXRoKFwiL2NoYW5nZS1wYXNzd29yZFwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvY2hhbmdlLWVtYWlsXCIpO1xuICAgICAgfSxcbiAgICAgIHdpbmRvdzogMTAsXG4gICAgICBtYXg6IDNcbiAgICB9XG4gIF07XG4gIHJldHVybiBzcGVjaWFsUnVsZXM7XG59XG5mdW5jdGlvbiBnZXRFbmRwb2ludHMoY3R4LCBvcHRpb25zKSB7XG4gIGNvbnN0IHBsdWdpbkVuZHBvaW50cyA9IG9wdGlvbnMucGx1Z2lucz8ucmVkdWNlKFxuICAgIChhY2MsIHBsdWdpbikgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uYWNjLFxuICAgICAgICAuLi5wbHVnaW4uZW5kcG9pbnRzXG4gICAgICB9O1xuICAgIH0sXG4gICAge31cbiAgKTtcbiAgY29uc3QgbWlkZGxld2FyZXMgPSBvcHRpb25zLnBsdWdpbnM/Lm1hcChcbiAgICAocGx1Z2luKSA9PiBwbHVnaW4ubWlkZGxld2FyZXM/Lm1hcCgobSkgPT4ge1xuICAgICAgY29uc3QgbWlkZGxld2FyZSA9IGFzeW5jIChjb250ZXh0KSA9PiB7XG4gICAgICAgIHJldHVybiBtLm1pZGRsZXdhcmUoe1xuICAgICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgLi4uY3R4LFxuICAgICAgICAgICAgLi4uY29udGV4dC5jb250ZXh0XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICBtaWRkbGV3YXJlLnBhdGggPSBtLnBhdGg7XG4gICAgICBtaWRkbGV3YXJlLm9wdGlvbnMgPSBtLm1pZGRsZXdhcmUub3B0aW9ucztcbiAgICAgIG1pZGRsZXdhcmUuaGVhZGVycyA9IG0ubWlkZGxld2FyZS5oZWFkZXJzO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aDogbS5wYXRoLFxuICAgICAgICBtaWRkbGV3YXJlXG4gICAgICB9O1xuICAgIH0pXG4gICkuZmlsdGVyKChwbHVnaW4pID0+IHBsdWdpbiAhPT0gdm9pZCAwKS5mbGF0KCkgfHwgW107XG4gIGNvbnN0IGJhc2VFbmRwb2ludHMgPSB7XG4gICAgc2lnbkluU29jaWFsLFxuICAgIGNhbGxiYWNrT0F1dGgsXG4gICAgZ2V0U2Vzc2lvbjogZ2V0U2Vzc2lvbigpLFxuICAgIHNpZ25PdXQsXG4gICAgc2lnblVwRW1haWw6IHNpZ25VcEVtYWlsKCksXG4gICAgc2lnbkluRW1haWwsXG4gICAgZm9yZ2V0UGFzc3dvcmQsXG4gICAgcmVzZXRQYXNzd29yZCxcbiAgICB2ZXJpZnlFbWFpbCxcbiAgICBzZW5kVmVyaWZpY2F0aW9uRW1haWwsXG4gICAgY2hhbmdlRW1haWwsXG4gICAgY2hhbmdlUGFzc3dvcmQsXG4gICAgc2V0UGFzc3dvcmQsXG4gICAgdXBkYXRlVXNlcjogdXBkYXRlVXNlcigpLFxuICAgIGRlbGV0ZVVzZXIsXG4gICAgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjayxcbiAgICBsaXN0U2Vzc2lvbnM6IGxpc3RTZXNzaW9ucygpLFxuICAgIHJldm9rZVNlc3Npb24sXG4gICAgcmV2b2tlU2Vzc2lvbnMsXG4gICAgcmV2b2tlT3RoZXJTZXNzaW9ucyxcbiAgICBsaW5rU29jaWFsQWNjb3VudCxcbiAgICBsaXN0VXNlckFjY291bnRzLFxuICAgIGRlbGV0ZVVzZXJDYWxsYmFjayxcbiAgICB1bmxpbmtBY2NvdW50XG4gIH07XG4gIGNvbnN0IGVuZHBvaW50cyA9IHtcbiAgICAuLi5iYXNlRW5kcG9pbnRzLFxuICAgIC4uLnBsdWdpbkVuZHBvaW50cyxcbiAgICBvayxcbiAgICBlcnJvclxuICB9O1xuICBsZXQgYXBpID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgZW5kcG9pbnRdIG9mIE9iamVjdC5lbnRyaWVzKGVuZHBvaW50cykpIHtcbiAgICBhcGlba2V5XSA9IGFzeW5jIChjb250ZXh0ID0ge30pID0+IHtcbiAgICAgIGVuZHBvaW50LmhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgbGV0IGludGVybmFsQ3R4ID0ge1xuICAgICAgICBzZXRIZWFkZXIoa2V5MiwgdmFsdWUpIHtcbiAgICAgICAgICBlbmRwb2ludC5oZWFkZXJzLnNldChrZXkyLCB2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldENvb2tpZShrZXkyLCB2YWx1ZSwgb3B0aW9uczIpIHtcbiAgICAgICAgICBzZXRDb29raWUoZW5kcG9pbnQuaGVhZGVycywga2V5MiwgdmFsdWUsIG9wdGlvbnMyKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0Q29va2llKGtleTIsIHByZWZpeCkge1xuICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGNvbnRleHQuaGVhZGVycztcbiAgICAgICAgICBjb25zdCBjb29raWVIID0gaGVhZGVyPy5nZXQoXCJjb29raWVcIik7XG4gICAgICAgICAgY29uc3QgY29va2llID0gZ2V0Q29va2llKGNvb2tpZUggfHwgXCJcIiwga2V5MiwgcHJlZml4KTtcbiAgICAgICAgICByZXR1cm4gY29va2llO1xuICAgICAgICB9LFxuICAgICAgICBnZXRTaWduZWRDb29raWUoa2V5Miwgc2VjcmV0LCBwcmVmaXgpIHtcbiAgICAgICAgICBjb25zdCBoZWFkZXIgPSBjb250ZXh0LmhlYWRlcnM7XG4gICAgICAgICAgaWYgKCFoZWFkZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBjb29raWUgPSBnZXRTaWduZWRDb29raWUoaGVhZGVyLCBzZWNyZXQsIGtleTIsIHByZWZpeCk7XG4gICAgICAgICAgcmV0dXJuIGNvb2tpZTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgc2V0U2lnbmVkQ29va2llKGtleTIsIHZhbHVlLCBzZWNyZXQsIG9wdGlvbnMyKSB7XG4gICAgICAgICAgYXdhaXQgc2V0U2lnbmVkQ29va2llKGVuZHBvaW50LmhlYWRlcnMsIGtleTIsIHZhbHVlLCBzZWNyZXQsIG9wdGlvbnMyKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVkaXJlY3QodXJsKSB7XG4gICAgICAgICAgZW5kcG9pbnQuaGVhZGVycy5zZXQoXCJMb2NhdGlvblwiLCB1cmwpO1xuICAgICAgICAgIHJldHVybiBuZXcgQVBJRXJyb3IoXCJGT1VORFwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2VIZWFkZXI6IGVuZHBvaW50LmhlYWRlcnNcbiAgICAgIH07XG4gICAgICBsZXQgYXV0aEN0eCA9IGF3YWl0IGN0eDtcbiAgICAgIGxldCBuZXdTZXNzaW9uID0gbnVsbDtcbiAgICAgIGxldCBpbnRlcm5hbENvbnRleHQgPSB7XG4gICAgICAgIC4uLmludGVybmFsQ3R4LFxuICAgICAgICAuLi5jb250ZXh0LFxuICAgICAgICBwYXRoOiBlbmRwb2ludC5wYXRoLFxuICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgLi4uYXV0aEN0eCxcbiAgICAgICAgICAuLi5jb250ZXh0LmNvbnRleHQsXG4gICAgICAgICAgc2Vzc2lvbjogbnVsbCxcbiAgICAgICAgICBzZXROZXdTZXNzaW9uOiBmdW5jdGlvbihzZXNzaW9uKSB7XG4gICAgICAgICAgICB0aGlzLm5ld1Nlc3Npb24gPSBzZXNzaW9uO1xuICAgICAgICAgICAgbmV3U2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXR1cm5lZDogdm9pZCAwXG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlSGVhZGVyOiBuZXcgSGVhZGVycygpXG4gICAgICB9O1xuICAgICAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgICAgIGNvbnN0IGJlZm9yZUhvb2tzID0gcGx1Z2lucy5tYXAoKHBsdWdpbikgPT4ge1xuICAgICAgICBpZiAocGx1Z2luLmhvb2tzPy5iZWZvcmUpIHtcbiAgICAgICAgICByZXR1cm4gcGx1Z2luLmhvb2tzLmJlZm9yZTtcbiAgICAgICAgfVxuICAgICAgfSkuZmlsdGVyKChwbHVnaW4pID0+IHBsdWdpbiAhPT0gdm9pZCAwKS5mbGF0KCk7XG4gICAgICBjb25zdCBhZnRlckhvb2tzID0gcGx1Z2lucy5tYXAoKHBsdWdpbikgPT4ge1xuICAgICAgICBpZiAocGx1Z2luLmhvb2tzPy5hZnRlcikge1xuICAgICAgICAgIHJldHVybiBwbHVnaW4uaG9va3MuYWZ0ZXI7XG4gICAgICAgIH1cbiAgICAgIH0pLmZpbHRlcigocGx1Z2luKSA9PiBwbHVnaW4gIT09IHZvaWQgMCkuZmxhdCgpO1xuICAgICAgaWYgKG9wdGlvbnMuaG9va3M/LmJlZm9yZSkge1xuICAgICAgICBiZWZvcmVIb29rcy5wdXNoKHtcbiAgICAgICAgICBtYXRjaGVyOiAoKSA9PiB0cnVlLFxuICAgICAgICAgIGhhbmRsZXI6IG9wdGlvbnMuaG9va3MuYmVmb3JlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMuaG9va3M/LmFmdGVyKSB7XG4gICAgICAgIGFmdGVySG9va3MucHVzaCh7XG4gICAgICAgICAgbWF0Y2hlcjogKCkgPT4gdHJ1ZSxcbiAgICAgICAgICBoYW5kbGVyOiBvcHRpb25zLmhvb2tzLmFmdGVyXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBob29rIG9mIGJlZm9yZUhvb2tzKSB7XG4gICAgICAgIGlmICghaG9vay5tYXRjaGVyKGludGVybmFsQ29udGV4dCkpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBob29rUmVzID0gYXdhaXQgaG9vay5oYW5kbGVyKGludGVybmFsQ29udGV4dCk7XG4gICAgICAgIGlmIChob29rUmVzICYmIFwiY29udGV4dFwiIGluIGhvb2tSZXMpIHtcbiAgICAgICAgICBpbnRlcm5hbENvbnRleHQgPSB7XG4gICAgICAgICAgICAuLi5pbnRlcm5hbENvbnRleHQsXG4gICAgICAgICAgICAuLi5ob29rUmVzLmNvbnRleHRcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChob29rUmVzKSB7XG4gICAgICAgICAgcmV0dXJuIGhvb2tSZXM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGxldCBlbmRwb2ludFJlcztcbiAgICAgIHRyeSB7XG4gICAgICAgIGVuZHBvaW50UmVzID0gYXdhaXQgZW5kcG9pbnQoaW50ZXJuYWxDb250ZXh0KTtcbiAgICAgICAgaWYgKG5ld1Nlc3Npb24pIHtcbiAgICAgICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5uZXdTZXNzaW9uID0gbmV3U2Vzc2lvbjtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBpZiAobmV3U2Vzc2lvbikge1xuICAgICAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0Lm5ld1Nlc3Npb24gPSBuZXdTZXNzaW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgICBpZiAoIWFmdGVySG9va3M/Lmxlbmd0aCkge1xuICAgICAgICAgICAgZS5oZWFkZXJzID0gZW5kcG9pbnQuaGVhZGVycztcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkID0gZTtcbiAgICAgICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZC5oZWFkZXJzID0gZW5kcG9pbnQuaGVhZGVycztcbiAgICAgICAgICBmb3IgKGNvbnN0IGhvb2sgb2YgYWZ0ZXJIb29rcyB8fCBbXSkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBob29rLm1hdGNoZXIoaW50ZXJuYWxDb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhvb2tSZXMgPSBhd2FpdCBob29rLmhhbmRsZXIoaW50ZXJuYWxDb250ZXh0KTtcbiAgICAgICAgICAgICAgICBpZiAoaG9va1JlcyAmJiBcInJlc3BvbnNlXCIgaW4gaG9va1Jlcykge1xuICAgICAgICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSBob29rUmVzLnJlc3BvbnNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBjYXRjaCAoZTIpIHtcbiAgICAgICAgICAgICAgICBpZiAoZTIgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSBlMjtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aHJvdyBlMjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQuaGVhZGVycyA9IGVuZHBvaW50LmhlYWRlcnM7XG4gICAgICAgICAgICB0aHJvdyBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9XG4gICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXR1cm5lZCA9IGVuZHBvaW50UmVzO1xuICAgICAgaW50ZXJuYWxDb250ZXh0LnJlc3BvbnNlSGVhZGVyID0gZW5kcG9pbnQuaGVhZGVycztcbiAgICAgIGZvciAoY29uc3QgaG9vayBvZiBhZnRlckhvb2tzKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gaG9vay5tYXRjaGVyKGludGVybmFsQ29udGV4dCk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBob29rUmVzID0gYXdhaXQgaG9vay5oYW5kbGVyKGludGVybmFsQ29udGV4dCk7XG4gICAgICAgICAgICBpZiAoaG9va1Jlcykge1xuICAgICAgICAgICAgICBpZiAoXCJyZXNwb25zZUhlYWRlclwiIGluIGhvb2tSZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gaG9va1Jlcy5yZXNwb25zZUhlYWRlcjtcbiAgICAgICAgICAgICAgICBpbnRlcm5hbENvbnRleHQucmVzcG9uc2VIZWFkZXIgPSBoZWFkZXJzO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkID0gaG9va1JlcztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSBlO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCByZXNwb25zZSA9IGludGVybmFsQ29udGV4dC5jb250ZXh0LnJldHVybmVkO1xuICAgICAgaWYgKHJlc3BvbnNlIGluc3RhbmNlb2YgUmVzcG9uc2UpIHtcbiAgICAgICAgZW5kcG9pbnQuaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5MikgPT4ge1xuICAgICAgICAgIGlmIChrZXkyID09PSBcInNldC1jb29raWVcIikge1xuICAgICAgICAgICAgcmVzcG9uc2UuaGVhZGVycy5hcHBlbmQoa2V5MiwgdmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNwb25zZS5oZWFkZXJzLnNldChrZXkyLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXNwb25zZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgIHJlc3BvbnNlLmhlYWRlcnMgPSBlbmRwb2ludC5oZWFkZXJzO1xuICAgICAgICB0aHJvdyByZXNwb25zZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9O1xuICAgIGFwaVtrZXldLnBhdGggPSBlbmRwb2ludC5wYXRoO1xuICAgIGFwaVtrZXldLm1ldGhvZCA9IGVuZHBvaW50Lm1ldGhvZDtcbiAgICBhcGlba2V5XS5vcHRpb25zID0gZW5kcG9pbnQub3B0aW9ucztcbiAgICBhcGlba2V5XS5oZWFkZXJzID0gZW5kcG9pbnQuaGVhZGVycztcbiAgfVxuICByZXR1cm4ge1xuICAgIGFwaSxcbiAgICBtaWRkbGV3YXJlc1xuICB9O1xufVxudmFyIHJvdXRlciA9IChjdHgsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgeyBhcGksIG1pZGRsZXdhcmVzIH0gPSBnZXRFbmRwb2ludHMoY3R4LCBvcHRpb25zKTtcbiAgY29uc3QgYmFzZVBhdGggPSBuZXcgVVJMKGN0eC5iYXNlVVJMKS5wYXRobmFtZTtcbiAgcmV0dXJuIGNyZWF0ZVJvdXRlcihhcGksIHtcbiAgICBleHRyYUNvbnRleHQ6IGN0eCxcbiAgICBiYXNlUGF0aCxcbiAgICByb3V0ZXJNaWRkbGV3YXJlOiBbXG4gICAgICB7XG4gICAgICAgIHBhdGg6IFwiLyoqXCIsXG4gICAgICAgIG1pZGRsZXdhcmU6IG9yaWdpbkNoZWNrTWlkZGxld2FyZVxuICAgICAgfSxcbiAgICAgIC4uLm1pZGRsZXdhcmVzXG4gICAgXSxcbiAgICBhc3luYyBvblJlcXVlc3QocmVxKSB7XG4gICAgICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBjdHgub3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgICAgIGlmIChwbHVnaW4ub25SZXF1ZXN0KSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwbHVnaW4ub25SZXF1ZXN0KHJlcSwgY3R4KTtcbiAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgXCJyZXNwb25zZVwiIGluIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucmVzcG9uc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb25SZXF1ZXN0UmF0ZUxpbWl0KHJlcSwgY3R4KTtcbiAgICB9LFxuICAgIGFzeW5jIG9uUmVzcG9uc2UocmVzKSB7XG4gICAgICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBjdHgub3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgICAgIGlmIChwbHVnaW4ub25SZXNwb25zZSkge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcGx1Z2luLm9uUmVzcG9uc2UocmVzLCBjdHgpO1xuICAgICAgICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnJlc3BvbnNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlcztcbiAgICB9LFxuICAgIG9uRXJyb3IoZSkge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvciAmJiBlLnN0YXR1cyA9PT0gXCJGT1VORFwiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLm9uQVBJRXJyb3I/LnRocm93KSB7XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5vbkFQSUVycm9yPy5vbkVycm9yKSB7XG4gICAgICAgIG9wdGlvbnMub25BUElFcnJvci5vbkVycm9yKGUsIGN0eCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG9wdExvZ0xldmVsID0gb3B0aW9ucy5sb2dnZXI/LmxldmVsO1xuICAgICAgY29uc3QgbG9nID0gb3B0TG9nTGV2ZWwgPT09IFwiZXJyb3JcIiB8fCBvcHRMb2dMZXZlbCA9PT0gXCJ3YXJuXCIgfHwgb3B0TG9nTGV2ZWwgPT09IFwiZGVidWdcIiA/IGxvZ2dlciA6IHZvaWQgMDtcbiAgICAgIGlmIChvcHRpb25zLmxvZ2dlcj8uZGlzYWJsZWQgIT09IHRydWUpIHtcbiAgICAgICAgaWYgKGUgJiYgdHlwZW9mIGUgPT09IFwib2JqZWN0XCIgJiYgXCJtZXNzYWdlXCIgaW4gZSAmJiB0eXBlb2YgZS5tZXNzYWdlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgaWYgKGUubWVzc2FnZS5pbmNsdWRlcyhcIm5vIGNvbHVtblwiKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoXCJjb2x1bW5cIikgfHwgZS5tZXNzYWdlLmluY2x1ZGVzKFwicmVsYXRpb25cIikgfHwgZS5tZXNzYWdlLmluY2x1ZGVzKFwidGFibGVcIikgfHwgZS5tZXNzYWdlLmluY2x1ZGVzKFwiZG9lcyBub3QgZXhpc3RcIikpIHtcbiAgICAgICAgICAgIGN0eC5sb2dnZXI/LmVycm9yKGUubWVzc2FnZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgICBpZiAoZS5zdGF0dXMgPT09IFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIpIHtcbiAgICAgICAgICAgIGN0eC5sb2dnZXIuZXJyb3IoZS5zdGF0dXMsIGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsb2c/LmVycm9yKGUubWVzc2FnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3R4LmxvZ2dlcj8uZXJyb3IoXG4gICAgICAgICAgICBlICYmIHR5cGVvZiBlID09PSBcIm9iamVjdFwiICYmIFwibmFtZVwiIGluIGUgPyBlLm5hbWUgOiBcIlwiLFxuICAgICAgICAgICAgZVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuZXhwb3J0IHsgQkFTRV9FUlJPUl9DT0RFUywgY2FsbGJhY2tPQXV0aCwgY2hhbmdlRW1haWwsIGNoYW5nZVBhc3N3b3JkLCBjcmVhdGVBdXRoRW5kcG9pbnQsIGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuLCBkZWxldGVVc2VyLCBkZWxldGVVc2VyQ2FsbGJhY2ssIGVycm9yLCBmb3JnZXRQYXNzd29yZCwgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjaywgZnJlc2hTZXNzaW9uTWlkZGxld2FyZSwgZ2V0RW5kcG9pbnRzLCBnZXRTZXNzaW9uLCBnZXRTZXNzaW9uRnJvbUN0eCwgaGFuZGxlT0F1dGhVc2VySW5mbywgbGlua1NvY2lhbEFjY291bnQsIGxpc3RTZXNzaW9ucywgbGlzdFVzZXJBY2NvdW50cywgb2ssIG9wdGlvbnNNaWRkbGV3YXJlLCBvcmlnaW5DaGVjaywgb3JpZ2luQ2hlY2tNaWRkbGV3YXJlLCByZXNldFBhc3N3b3JkLCByZXZva2VPdGhlclNlc3Npb25zLCByZXZva2VTZXNzaW9uLCByZXZva2VTZXNzaW9ucywgcm91dGVyLCBzZW5kVmVyaWZpY2F0aW9uRW1haWwsIHNlbmRWZXJpZmljYXRpb25FbWFpbEZuLCBzZXNzaW9uTWlkZGxld2FyZSwgc2V0UGFzc3dvcmQsIHNpZ25JbkVtYWlsLCBzaWduSW5Tb2NpYWwsIHNpZ25PdXQsIHNpZ25VcEVtYWlsLCB1bmxpbmtBY2NvdW50LCB1cGRhdGVVc2VyLCB2ZXJpZnlFbWFpbCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/index.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/index.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BetterAuthError: () => (/* reexport safe */ _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_16__.BetterAuthError),\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.HIDE_METADATA),\n/* harmony export */   MissingDependencyError: () => (/* reexport safe */ _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_16__.MissingDependencyError),\n/* harmony export */   betterAuth: () => (/* binding */ betterAuth),\n/* harmony export */   capitalizeFirstLetter: () => (/* reexport safe */ _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_11__.capitalizeFirstLetter),\n/* harmony export */   createCookieGetter: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.createCookieGetter),\n/* harmony export */   createLogger: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.createLogger),\n/* harmony export */   deleteSessionCookie: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.deleteSessionCookie),\n/* harmony export */   generateId: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.generateId),\n/* harmony export */   generateState: () => (/* reexport safe */ _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_9__.generateState),\n/* harmony export */   getCookieCache: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getCookieCache),\n/* harmony export */   getCookies: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getCookies),\n/* harmony export */   getSessionCookie: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getSessionCookie),\n/* harmony export */   levels: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.levels),\n/* harmony export */   logger: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.logger),\n/* harmony export */   parseCookies: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.parseCookies),\n/* harmony export */   parseSetCookieHeader: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.parseSetCookieHeader),\n/* harmony export */   parseState: () => (/* reexport safe */ _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_9__.parseState),\n/* harmony export */   setCookieCache: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.setCookieCache),\n/* harmony export */   setSessionCookie: () => (/* reexport safe */ _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.setSessionCookie),\n/* harmony export */   shouldPublishLog: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.shouldPublishLog)\n/* harmony export */ });\n/* harmony import */ var _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TOKZL3ZI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-VXDYNCOX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\");\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-62MWLLEG.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_SK6Y2YH6_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./chunk-SK6Y2YH6.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./chunk-3XTQSPPA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// src/utils/constants.ts\nvar DEFAULT_SECRET = \"better-auth-secret-123456789\";\n\n// src/init.ts\nvar init = async (options) => {\n  const adapter = await (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.getAdapter)(options);\n  const plugins = options.plugins || [];\n  const internalPlugins = getInternalPlugins(options);\n  const logger2 = (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.createLogger)(options.logger);\n  const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__.getBaseURL)(options.baseURL, options.basePath);\n  const secret = options.secret || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.env.BETTER_AUTH_SECRET || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.env.AUTH_SECRET || DEFAULT_SECRET;\n  if (secret === DEFAULT_SECRET) {\n    if (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.isProduction) {\n      logger2.error(\n        \"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\"\n      );\n    }\n  }\n  options = {\n    ...options,\n    secret,\n    baseURL: baseURL ? new URL(baseURL).origin : \"\",\n    basePath: options.basePath || \"/api/auth\",\n    plugins: plugins.concat(internalPlugins)\n  };\n  const cookies = (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.getCookies)(options);\n  const tables = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.getAuthTables)(options);\n  const providers = Object.keys(options.socialProviders || {}).map((key) => {\n    const value = options.socialProviders?.[key];\n    if (!value || value.enabled === false) {\n      return null;\n    }\n    if (!value.clientId) {\n      logger2.warn(\n        `Social provider ${key} is missing clientId or clientSecret`\n      );\n    }\n    return _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_2__.socialProviders[key](\n      value\n      // TODO: fix this\n    );\n  }).filter((x) => x !== null);\n  const generateIdFunc = ({ model, size }) => {\n    if (typeof options?.advanced?.generateId === \"function\") {\n      return options.advanced.generateId({ model, size });\n    }\n    return (0,_chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_8__.generateId)(size);\n  };\n  const ctx = {\n    appName: options.appName || \"Better Auth\",\n    socialProviders: providers,\n    options,\n    tables,\n    trustedOrigins: getTrustedOrigins(options),\n    baseURL: baseURL || \"\",\n    sessionConfig: {\n      updateAge: options.session?.updateAge !== void 0 ? options.session.updateAge : 24 * 60 * 60,\n      // 24 hours\n      expiresIn: options.session?.expiresIn || 60 * 60 * 24 * 7,\n      // 7 days\n      freshAge: options.session?.freshAge === void 0 ? 60 * 60 * 24 : options.session.freshAge\n    },\n    secret,\n    rateLimit: {\n      ...options.rateLimit,\n      enabled: options.rateLimit?.enabled ?? _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.isProduction,\n      window: options.rateLimit?.window || 10,\n      max: options.rateLimit?.max || 100,\n      storage: options.rateLimit?.storage || (options.secondaryStorage ? \"secondary-storage\" : \"memory\")\n    },\n    authCookies: cookies,\n    logger: logger2,\n    generateId: generateIdFunc,\n    session: null,\n    secondaryStorage: options.secondaryStorage,\n    password: {\n      hash: options.emailAndPassword?.password?.hash || _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_12__.hashPassword,\n      verify: options.emailAndPassword?.password?.verify || _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_12__.verifyPassword,\n      config: {\n        minPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n        maxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128\n      },\n      checkPassword: _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_0__.checkPassword\n    },\n    setNewSession(session) {\n      this.newSession = session;\n    },\n    newSession: null,\n    adapter,\n    internalAdapter: (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.createInternalAdapter)(adapter, {\n      options,\n      hooks: options.databaseHooks ? [options.databaseHooks] : [],\n      generateId: generateIdFunc\n    }),\n    createAuthCookie: (0,_chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_5__.createCookieGetter)(options)\n  };\n  let { context } = runPluginInit(ctx);\n  return context;\n};\nfunction runPluginInit(ctx) {\n  let options = ctx.options;\n  const plugins = options.plugins || [];\n  let context = ctx;\n  const dbHooks = [];\n  for (const plugin of plugins) {\n    if (plugin.init) {\n      const result = plugin.init(ctx);\n      if (typeof result === \"object\") {\n        if (result.options) {\n          const { databaseHooks, ...restOpts } = result.options;\n          if (databaseHooks) {\n            dbHooks.push(databaseHooks);\n          }\n          options = (0,defu__WEBPACK_IMPORTED_MODULE_17__.defu)(options, restOpts);\n        }\n        if (result.context) {\n          context = {\n            ...context,\n            ...result.context\n          };\n        }\n      }\n    }\n  }\n  dbHooks.push(options.databaseHooks);\n  context.internalAdapter = (0,_chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_6__.createInternalAdapter)(ctx.adapter, {\n    options,\n    hooks: dbHooks.filter((u) => u !== void 0),\n    generateId: ctx.generateId\n  });\n  context.options = options;\n  return { context };\n}\nfunction getInternalPlugins(options) {\n  const plugins = [];\n  if (options.advanced?.crossSubDomainCookies?.enabled) ;\n  return plugins;\n}\nfunction getTrustedOrigins(options) {\n  const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__.getBaseURL)(options.baseURL, options.basePath);\n  if (!baseURL) {\n    return [];\n  }\n  const trustedOrigins = [new URL(baseURL).origin];\n  if (options.trustedOrigins && Array.isArray(options.trustedOrigins)) {\n    trustedOrigins.push(...options.trustedOrigins);\n  }\n  const envTrustedOrigins = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_15__.env.BETTER_AUTH_TRUSTED_ORIGINS;\n  if (envTrustedOrigins) {\n    trustedOrigins.push(...envTrustedOrigins.split(\",\"));\n  }\n  return trustedOrigins;\n}\n\n// src/auth.ts\nvar betterAuth = (options) => {\n  const authContext = init(options);\n  const { api } = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.getEndpoints)(authContext, options);\n  const errorCodes = options.plugins?.reduce((acc, plugin) => {\n    if (plugin.$ERROR_CODES) {\n      return {\n        ...acc,\n        ...plugin.$ERROR_CODES\n      };\n    }\n    return acc;\n  }, {});\n  return {\n    handler: async (request) => {\n      const ctx = await authContext;\n      const basePath = ctx.options.basePath || \"/api/auth\";\n      const url = new URL(request.url);\n      if (!ctx.options.baseURL) {\n        const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_4__.getBaseURL)(void 0, basePath) || `${url.origin}${basePath}`;\n        ctx.options.baseURL = baseURL;\n        ctx.baseURL = baseURL;\n      }\n      ctx.trustedOrigins = [\n        ...options.trustedOrigins ? Array.isArray(options.trustedOrigins) ? options.trustedOrigins : options.trustedOrigins(request) : [],\n        ctx.options.baseURL,\n        url.origin\n      ];\n      const { handler } = (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.router)(ctx, options);\n      return handler(request);\n    },\n    api,\n    options,\n    $context: authContext,\n    $Infer: {},\n    $ERROR_CODES: {\n      ...errorCodes,\n      ..._chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_1__.BASE_ERROR_CODES\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFvRDtBQUN5QjtBQUN2QjtBQUN6QjtBQUNvQjtBQUNvQjtBQUM2SDtBQUMzRztBQUMxRDtBQUNrQztBQUNpRDtBQUNoRDtBQUNuQztBQUMrQjtBQUNPO0FBQ3RDO0FBQ0E7QUFDMkI7QUFDc0I7QUFDbEQ7O0FBRTVCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHdCQUF3Qiw4REFBVTtBQUNsQztBQUNBO0FBQ0Esa0JBQWtCLGdFQUFZO0FBQzlCLGtCQUFrQiw4REFBVTtBQUM1QixtQ0FBbUMsb0RBQUcsdUJBQXVCLG9EQUFHO0FBQ2hFO0FBQ0EsUUFBUSw2REFBWTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsOERBQVU7QUFDNUIsaUJBQWlCLGlFQUFhO0FBQzlCLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsS0FBSztBQUNoQztBQUNBO0FBQ0EsV0FBVywrREFBZTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsNEJBQTRCLGFBQWE7QUFDekM7QUFDQSwyQ0FBMkMsYUFBYTtBQUN4RDtBQUNBLFdBQVcsOERBQVU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsNkRBQVk7QUFDekQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCw2REFBWTtBQUNwRSw0REFBNEQsK0RBQWM7QUFDMUU7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLG1CQUFtQjtBQUNuQixLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EscUJBQXFCLHlFQUFxQjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsc0JBQXNCLHNFQUFrQjtBQUN4QztBQUNBLFFBQVEsVUFBVTtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkJBQTZCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwyQ0FBSTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHlFQUFxQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsOERBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0RBQUc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLE1BQU0sRUFBRSxnRUFBWTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxJQUFJO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDhEQUFVLHlCQUF5QixXQUFXLEVBQUUsU0FBUztBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxVQUFVLEVBQUUsMERBQU07QUFDaEM7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxTQUFTLGdFQUFnQjtBQUN6QjtBQUNBO0FBQ0E7O0FBRXNCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hlY2tQYXNzd29yZCB9IGZyb20gJy4vY2h1bmstVE9LWkwzWkkuanMnO1xuaW1wb3J0IHsgZ2V0RW5kcG9pbnRzLCByb3V0ZXIsIEJBU0VfRVJST1JfQ09ERVMgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCB7IHNvY2lhbFByb3ZpZGVycyB9IGZyb20gJy4vY2h1bmstVlhEWU5DT1guanMnO1xuaW1wb3J0ICcuL2NodW5rLUdUUU03SlU3LmpzJztcbmltcG9ydCB7IGdldEJhc2VVUkwgfSBmcm9tICcuL2NodW5rLVhGQ0lBTlpYLmpzJztcbmltcG9ydCB7IGdldENvb2tpZXMsIGNyZWF0ZUNvb2tpZUdldHRlciB9IGZyb20gJy4vY2h1bmstUVFHWjNYR0kuanMnO1xuZXhwb3J0IHsgY3JlYXRlQ29va2llR2V0dGVyLCBkZWxldGVTZXNzaW9uQ29va2llLCBnZXRDb29raWVDYWNoZSwgZ2V0Q29va2llcywgZ2V0U2Vzc2lvbkNvb2tpZSwgcGFyc2VDb29raWVzLCBwYXJzZVNldENvb2tpZUhlYWRlciwgc2V0Q29va2llQ2FjaGUsIHNldFNlc3Npb25Db29raWUgfSBmcm9tICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCB7IGdldEFkYXB0ZXIsIGdldEF1dGhUYWJsZXMsIGNyZWF0ZUludGVybmFsQWRhcHRlciB9IGZyb20gJy4vY2h1bmstNjJNV0xMRUcuanMnO1xuaW1wb3J0ICcuL2NodW5rLVdaNk9JVkpLLmpzJztcbmltcG9ydCB7IGNyZWF0ZUxvZ2dlciwgZ2VuZXJhdGVJZCB9IGZyb20gJy4vY2h1bmstS0xERkJMWUwuanMnO1xuZXhwb3J0IHsgSElERV9NRVRBREFUQSwgY3JlYXRlTG9nZ2VyLCBnZW5lcmF0ZUlkLCBsZXZlbHMsIGxvZ2dlciwgc2hvdWxkUHVibGlzaExvZyB9IGZyb20gJy4vY2h1bmstS0xERkJMWUwuanMnO1xuZXhwb3J0IHsgZ2VuZXJhdGVTdGF0ZSwgcGFyc2VTdGF0ZSB9IGZyb20gJy4vY2h1bmstTlBPNjRTVk4uanMnO1xuaW1wb3J0ICcuL2NodW5rLVNLNlkyWUg2LmpzJztcbmV4cG9ydCB7IGNhcGl0YWxpemVGaXJzdExldHRlciB9IGZyb20gJy4vY2h1bmstM1hUUVNQUEEuanMnO1xuaW1wb3J0IHsgaGFzaFBhc3N3b3JkLCB2ZXJpZnlQYXNzd29yZCB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0ICcuL2NodW5rLTUzSVBPMlBKLmpzJztcbmltcG9ydCAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBlbnYsIGlzUHJvZHVjdGlvbiB9IGZyb20gJy4vY2h1bmstVFFRU1BQTkEuanMnO1xuZXhwb3J0IHsgQmV0dGVyQXV0aEVycm9yLCBNaXNzaW5nRGVwZW5kZW5jeUVycm9yIH0gZnJvbSAnLi9jaHVuay1VTldDWEtNUC5qcyc7XG5pbXBvcnQgeyBkZWZ1IH0gZnJvbSAnZGVmdSc7XG5cbi8vIHNyYy91dGlscy9jb25zdGFudHMudHNcbnZhciBERUZBVUxUX1NFQ1JFVCA9IFwiYmV0dGVyLWF1dGgtc2VjcmV0LTEyMzQ1Njc4OVwiO1xuXG4vLyBzcmMvaW5pdC50c1xudmFyIGluaXQgPSBhc3luYyAob3B0aW9ucykgPT4ge1xuICBjb25zdCBhZGFwdGVyID0gYXdhaXQgZ2V0QWRhcHRlcihvcHRpb25zKTtcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgY29uc3QgaW50ZXJuYWxQbHVnaW5zID0gZ2V0SW50ZXJuYWxQbHVnaW5zKG9wdGlvbnMpO1xuICBjb25zdCBsb2dnZXIyID0gY3JlYXRlTG9nZ2VyKG9wdGlvbnMubG9nZ2VyKTtcbiAgY29uc3QgYmFzZVVSTCA9IGdldEJhc2VVUkwob3B0aW9ucy5iYXNlVVJMLCBvcHRpb25zLmJhc2VQYXRoKTtcbiAgY29uc3Qgc2VjcmV0ID0gb3B0aW9ucy5zZWNyZXQgfHwgZW52LkJFVFRFUl9BVVRIX1NFQ1JFVCB8fCBlbnYuQVVUSF9TRUNSRVQgfHwgREVGQVVMVF9TRUNSRVQ7XG4gIGlmIChzZWNyZXQgPT09IERFRkFVTFRfU0VDUkVUKSB7XG4gICAgaWYgKGlzUHJvZHVjdGlvbikge1xuICAgICAgbG9nZ2VyMi5lcnJvcihcbiAgICAgICAgXCJZb3UgYXJlIHVzaW5nIHRoZSBkZWZhdWx0IHNlY3JldC4gUGxlYXNlIHNldCBgQkVUVEVSX0FVVEhfU0VDUkVUYCBpbiB5b3VyIGVudmlyb25tZW50IHZhcmlhYmxlcyBvciBwYXNzIGBzZWNyZXRgIGluIHlvdXIgYXV0aCBjb25maWcuXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIG9wdGlvbnMgPSB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBzZWNyZXQsXG4gICAgYmFzZVVSTDogYmFzZVVSTCA/IG5ldyBVUkwoYmFzZVVSTCkub3JpZ2luIDogXCJcIixcbiAgICBiYXNlUGF0aDogb3B0aW9ucy5iYXNlUGF0aCB8fCBcIi9hcGkvYXV0aFwiLFxuICAgIHBsdWdpbnM6IHBsdWdpbnMuY29uY2F0KGludGVybmFsUGx1Z2lucylcbiAgfTtcbiAgY29uc3QgY29va2llcyA9IGdldENvb2tpZXMob3B0aW9ucyk7XG4gIGNvbnN0IHRhYmxlcyA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGNvbnN0IHByb3ZpZGVycyA9IE9iamVjdC5rZXlzKG9wdGlvbnMuc29jaWFsUHJvdmlkZXJzIHx8IHt9KS5tYXAoKGtleSkgPT4ge1xuICAgIGNvbnN0IHZhbHVlID0gb3B0aW9ucy5zb2NpYWxQcm92aWRlcnM/LltrZXldO1xuICAgIGlmICghdmFsdWUgfHwgdmFsdWUuZW5hYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAoIXZhbHVlLmNsaWVudElkKSB7XG4gICAgICBsb2dnZXIyLndhcm4oXG4gICAgICAgIGBTb2NpYWwgcHJvdmlkZXIgJHtrZXl9IGlzIG1pc3NpbmcgY2xpZW50SWQgb3IgY2xpZW50U2VjcmV0YFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHNvY2lhbFByb3ZpZGVyc1trZXldKFxuICAgICAgdmFsdWVcbiAgICAgIC8vIFRPRE86IGZpeCB0aGlzXG4gICAgKTtcbiAgfSkuZmlsdGVyKCh4KSA9PiB4ICE9PSBudWxsKTtcbiAgY29uc3QgZ2VuZXJhdGVJZEZ1bmMgPSAoeyBtb2RlbCwgc2l6ZSB9KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zPy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5hZHZhbmNlZC5nZW5lcmF0ZUlkKHsgbW9kZWwsIHNpemUgfSk7XG4gICAgfVxuICAgIHJldHVybiBnZW5lcmF0ZUlkKHNpemUpO1xuICB9O1xuICBjb25zdCBjdHggPSB7XG4gICAgYXBwTmFtZTogb3B0aW9ucy5hcHBOYW1lIHx8IFwiQmV0dGVyIEF1dGhcIixcbiAgICBzb2NpYWxQcm92aWRlcnM6IHByb3ZpZGVycyxcbiAgICBvcHRpb25zLFxuICAgIHRhYmxlcyxcbiAgICB0cnVzdGVkT3JpZ2luczogZ2V0VHJ1c3RlZE9yaWdpbnMob3B0aW9ucyksXG4gICAgYmFzZVVSTDogYmFzZVVSTCB8fCBcIlwiLFxuICAgIHNlc3Npb25Db25maWc6IHtcbiAgICAgIHVwZGF0ZUFnZTogb3B0aW9ucy5zZXNzaW9uPy51cGRhdGVBZ2UgIT09IHZvaWQgMCA/IG9wdGlvbnMuc2Vzc2lvbi51cGRhdGVBZ2UgOiAyNCAqIDYwICogNjAsXG4gICAgICAvLyAyNCBob3Vyc1xuICAgICAgZXhwaXJlc0luOiBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQgKiA3LFxuICAgICAgLy8gNyBkYXlzXG4gICAgICBmcmVzaEFnZTogb3B0aW9ucy5zZXNzaW9uPy5mcmVzaEFnZSA9PT0gdm9pZCAwID8gNjAgKiA2MCAqIDI0IDogb3B0aW9ucy5zZXNzaW9uLmZyZXNoQWdlXG4gICAgfSxcbiAgICBzZWNyZXQsXG4gICAgcmF0ZUxpbWl0OiB7XG4gICAgICAuLi5vcHRpb25zLnJhdGVMaW1pdCxcbiAgICAgIGVuYWJsZWQ6IG9wdGlvbnMucmF0ZUxpbWl0Py5lbmFibGVkID8/IGlzUHJvZHVjdGlvbixcbiAgICAgIHdpbmRvdzogb3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyB8fCAxMCxcbiAgICAgIG1heDogb3B0aW9ucy5yYXRlTGltaXQ/Lm1heCB8fCAxMDAsXG4gICAgICBzdG9yYWdlOiBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSB8fCAob3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlID8gXCJzZWNvbmRhcnktc3RvcmFnZVwiIDogXCJtZW1vcnlcIilcbiAgICB9LFxuICAgIGF1dGhDb29raWVzOiBjb29raWVzLFxuICAgIGxvZ2dlcjogbG9nZ2VyMixcbiAgICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkRnVuYyxcbiAgICBzZXNzaW9uOiBudWxsLFxuICAgIHNlY29uZGFyeVN0b3JhZ2U6IG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSxcbiAgICBwYXNzd29yZDoge1xuICAgICAgaGFzaDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5wYXNzd29yZD8uaGFzaCB8fCBoYXNoUGFzc3dvcmQsXG4gICAgICB2ZXJpZnk6IG9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucGFzc3dvcmQ/LnZlcmlmeSB8fCB2ZXJpZnlQYXNzd29yZCxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBtaW5QYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5taW5QYXNzd29yZExlbmd0aCB8fCA4LFxuICAgICAgICBtYXhQYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5tYXhQYXNzd29yZExlbmd0aCB8fCAxMjhcbiAgICAgIH0sXG4gICAgICBjaGVja1Bhc3N3b3JkXG4gICAgfSxcbiAgICBzZXROZXdTZXNzaW9uKHNlc3Npb24pIHtcbiAgICAgIHRoaXMubmV3U2Vzc2lvbiA9IHNlc3Npb247XG4gICAgfSxcbiAgICBuZXdTZXNzaW9uOiBudWxsLFxuICAgIGFkYXB0ZXIsXG4gICAgaW50ZXJuYWxBZGFwdGVyOiBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIoYWRhcHRlciwge1xuICAgICAgb3B0aW9ucyxcbiAgICAgIGhvb2tzOiBvcHRpb25zLmRhdGFiYXNlSG9va3MgPyBbb3B0aW9ucy5kYXRhYmFzZUhvb2tzXSA6IFtdLFxuICAgICAgZ2VuZXJhdGVJZDogZ2VuZXJhdGVJZEZ1bmNcbiAgICB9KSxcbiAgICBjcmVhdGVBdXRoQ29va2llOiBjcmVhdGVDb29raWVHZXR0ZXIob3B0aW9ucylcbiAgfTtcbiAgbGV0IHsgY29udGV4dCB9ID0gcnVuUGx1Z2luSW5pdChjdHgpO1xuICByZXR1cm4gY29udGV4dDtcbn07XG5mdW5jdGlvbiBydW5QbHVnaW5Jbml0KGN0eCkge1xuICBsZXQgb3B0aW9ucyA9IGN0eC5vcHRpb25zO1xuICBjb25zdCBwbHVnaW5zID0gb3B0aW9ucy5wbHVnaW5zIHx8IFtdO1xuICBsZXQgY29udGV4dCA9IGN0eDtcbiAgY29uc3QgZGJIb29rcyA9IFtdO1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBwbHVnaW5zKSB7XG4gICAgaWYgKHBsdWdpbi5pbml0KSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwbHVnaW4uaW5pdChjdHgpO1xuICAgICAgaWYgKHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgaWYgKHJlc3VsdC5vcHRpb25zKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhYmFzZUhvb2tzLCAuLi5yZXN0T3B0cyB9ID0gcmVzdWx0Lm9wdGlvbnM7XG4gICAgICAgICAgaWYgKGRhdGFiYXNlSG9va3MpIHtcbiAgICAgICAgICAgIGRiSG9va3MucHVzaChkYXRhYmFzZUhvb2tzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgb3B0aW9ucyA9IGRlZnUob3B0aW9ucywgcmVzdE9wdHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQuY29udGV4dCkge1xuICAgICAgICAgIGNvbnRleHQgPSB7XG4gICAgICAgICAgICAuLi5jb250ZXh0LFxuICAgICAgICAgICAgLi4ucmVzdWx0LmNvbnRleHRcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGRiSG9va3MucHVzaChvcHRpb25zLmRhdGFiYXNlSG9va3MpO1xuICBjb250ZXh0LmludGVybmFsQWRhcHRlciA9IGNyZWF0ZUludGVybmFsQWRhcHRlcihjdHguYWRhcHRlciwge1xuICAgIG9wdGlvbnMsXG4gICAgaG9va3M6IGRiSG9va3MuZmlsdGVyKCh1KSA9PiB1ICE9PSB2b2lkIDApLFxuICAgIGdlbmVyYXRlSWQ6IGN0eC5nZW5lcmF0ZUlkXG4gIH0pO1xuICBjb250ZXh0Lm9wdGlvbnMgPSBvcHRpb25zO1xuICByZXR1cm4geyBjb250ZXh0IH07XG59XG5mdW5jdGlvbiBnZXRJbnRlcm5hbFBsdWdpbnMob3B0aW9ucykge1xuICBjb25zdCBwbHVnaW5zID0gW107XG4gIGlmIChvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmVuYWJsZWQpIDtcbiAgcmV0dXJuIHBsdWdpbnM7XG59XG5mdW5jdGlvbiBnZXRUcnVzdGVkT3JpZ2lucyhvcHRpb25zKSB7XG4gIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKG9wdGlvbnMuYmFzZVVSTCwgb3B0aW9ucy5iYXNlUGF0aCk7XG4gIGlmICghYmFzZVVSTCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCB0cnVzdGVkT3JpZ2lucyA9IFtuZXcgVVJMKGJhc2VVUkwpLm9yaWdpbl07XG4gIGlmIChvcHRpb25zLnRydXN0ZWRPcmlnaW5zICYmIEFycmF5LmlzQXJyYXkob3B0aW9ucy50cnVzdGVkT3JpZ2lucykpIHtcbiAgICB0cnVzdGVkT3JpZ2lucy5wdXNoKC4uLm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpO1xuICB9XG4gIGNvbnN0IGVudlRydXN0ZWRPcmlnaW5zID0gZW52LkJFVFRFUl9BVVRIX1RSVVNURURfT1JJR0lOUztcbiAgaWYgKGVudlRydXN0ZWRPcmlnaW5zKSB7XG4gICAgdHJ1c3RlZE9yaWdpbnMucHVzaCguLi5lbnZUcnVzdGVkT3JpZ2lucy5zcGxpdChcIixcIikpO1xuICB9XG4gIHJldHVybiB0cnVzdGVkT3JpZ2lucztcbn1cblxuLy8gc3JjL2F1dGgudHNcbnZhciBiZXR0ZXJBdXRoID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgYXV0aENvbnRleHQgPSBpbml0KG9wdGlvbnMpO1xuICBjb25zdCB7IGFwaSB9ID0gZ2V0RW5kcG9pbnRzKGF1dGhDb250ZXh0LCBvcHRpb25zKTtcbiAgY29uc3QgZXJyb3JDb2RlcyA9IG9wdGlvbnMucGx1Z2lucz8ucmVkdWNlKChhY2MsIHBsdWdpbikgPT4ge1xuICAgIGlmIChwbHVnaW4uJEVSUk9SX0NPREVTKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5hY2MsXG4gICAgICAgIC4uLnBsdWdpbi4kRVJST1JfQ09ERVNcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgcmV0dXJuIHtcbiAgICBoYW5kbGVyOiBhc3luYyAocmVxdWVzdCkgPT4ge1xuICAgICAgY29uc3QgY3R4ID0gYXdhaXQgYXV0aENvbnRleHQ7XG4gICAgICBjb25zdCBiYXNlUGF0aCA9IGN0eC5vcHRpb25zLmJhc2VQYXRoIHx8IFwiL2FwaS9hdXRoXCI7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGlmICghY3R4Lm9wdGlvbnMuYmFzZVVSTCkge1xuICAgICAgICBjb25zdCBiYXNlVVJMID0gZ2V0QmFzZVVSTCh2b2lkIDAsIGJhc2VQYXRoKSB8fCBgJHt1cmwub3JpZ2lufSR7YmFzZVBhdGh9YDtcbiAgICAgICAgY3R4Lm9wdGlvbnMuYmFzZVVSTCA9IGJhc2VVUkw7XG4gICAgICAgIGN0eC5iYXNlVVJMID0gYmFzZVVSTDtcbiAgICAgIH1cbiAgICAgIGN0eC50cnVzdGVkT3JpZ2lucyA9IFtcbiAgICAgICAgLi4ub3B0aW9ucy50cnVzdGVkT3JpZ2lucyA/IEFycmF5LmlzQXJyYXkob3B0aW9ucy50cnVzdGVkT3JpZ2lucykgPyBvcHRpb25zLnRydXN0ZWRPcmlnaW5zIDogb3B0aW9ucy50cnVzdGVkT3JpZ2lucyhyZXF1ZXN0KSA6IFtdLFxuICAgICAgICBjdHgub3B0aW9ucy5iYXNlVVJMLFxuICAgICAgICB1cmwub3JpZ2luXG4gICAgICBdO1xuICAgICAgY29uc3QgeyBoYW5kbGVyIH0gPSByb3V0ZXIoY3R4LCBvcHRpb25zKTtcbiAgICAgIHJldHVybiBoYW5kbGVyKHJlcXVlc3QpO1xuICAgIH0sXG4gICAgYXBpLFxuICAgIG9wdGlvbnMsXG4gICAgJGNvbnRleHQ6IGF1dGhDb250ZXh0LFxuICAgICRJbmZlcjoge30sXG4gICAgJEVSUk9SX0NPREVTOiB7XG4gICAgICAuLi5lcnJvckNvZGVzLFxuICAgICAgLi4uQkFTRV9FUlJPUl9DT0RFU1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IGJldHRlckF1dGggfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/plugins.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/plugins.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_28__.HIDE_METADATA),\n/* harmony export */   admin: () => (/* reexport safe */ _chunk_NP2H7VJV_js__WEBPACK_IMPORTED_MODULE_11__.admin),\n/* harmony export */   anonymous: () => (/* reexport safe */ _chunk_PZOB66AP_js__WEBPACK_IMPORTED_MODULE_12__.anonymous),\n/* harmony export */   bearer: () => (/* reexport safe */ _chunk_KKKJI5Y7_js__WEBPACK_IMPORTED_MODULE_13__.bearer),\n/* harmony export */   createAuthEndpoint: () => (/* reexport safe */ _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* reexport safe */ _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthMiddleware),\n/* harmony export */   customSession: () => (/* reexport safe */ _chunk_FR3BYA47_js__WEBPACK_IMPORTED_MODULE_14__.customSession),\n/* harmony export */   emailOTP: () => (/* reexport safe */ _chunk_LNAETVOO_js__WEBPACK_IMPORTED_MODULE_15__.emailOTP),\n/* harmony export */   genericOAuth: () => (/* reexport safe */ _chunk_NIUW4WF7_js__WEBPACK_IMPORTED_MODULE_16__.genericOAuth),\n/* harmony export */   jwt: () => (/* reexport safe */ _chunk_7LU7PVPP_js__WEBPACK_IMPORTED_MODULE_4__.jwt),\n/* harmony export */   magicLink: () => (/* reexport safe */ _chunk_2KOUY3SJ_js__WEBPACK_IMPORTED_MODULE_5__.magicLink),\n/* harmony export */   multiSession: () => (/* reexport safe */ _chunk_6B3UWAJ3_js__WEBPACK_IMPORTED_MODULE_6__.multiSession),\n/* harmony export */   oAuthProxy: () => (/* binding */ oAuthProxy),\n/* harmony export */   oidcProvider: () => (/* reexport safe */ _chunk_KYDZ4BE2_js__WEBPACK_IMPORTED_MODULE_10__.oidcProvider),\n/* harmony export */   oneTap: () => (/* reexport safe */ _chunk_AVAADPGB_js__WEBPACK_IMPORTED_MODULE_7__.oneTap),\n/* harmony export */   openAPI: () => (/* reexport safe */ _chunk_PHHYUVFI_js__WEBPACK_IMPORTED_MODULE_8__.openAPI),\n/* harmony export */   optionsMiddleware: () => (/* reexport safe */ _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.optionsMiddleware),\n/* harmony export */   organization: () => (/* reexport safe */ _chunk_2RDAV2UB_js__WEBPACK_IMPORTED_MODULE_9__.organization),\n/* harmony export */   phoneNumber: () => (/* reexport safe */ _chunk_RBOAD55Y_js__WEBPACK_IMPORTED_MODULE_0__.phoneNumber),\n/* harmony export */   twoFactor: () => (/* reexport safe */ _chunk_VRVK7CFW_js__WEBPACK_IMPORTED_MODULE_1__.twoFactor),\n/* harmony export */   twoFactorClient: () => (/* reexport safe */ _chunk_GYDUPG7X_js__WEBPACK_IMPORTED_MODULE_17__.twoFactorClient),\n/* harmony export */   username: () => (/* reexport safe */ _chunk_M7C7TKIU_js__WEBPACK_IMPORTED_MODULE_2__.username)\n/* harmony export */ });\n/* harmony import */ var _chunk_RBOAD55Y_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-RBOAD55Y.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-RBOAD55Y.js\");\n/* harmony import */ var _chunk_VRVK7CFW_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-VRVK7CFW.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VRVK7CFW.js\");\n/* harmony import */ var _chunk_M7C7TKIU_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-M7C7TKIU.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-M7C7TKIU.js\");\n/* harmony import */ var _chunk_WMXBA6LX_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-WMXBA6LX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WMXBA6LX.js\");\n/* harmony import */ var _chunk_7LU7PVPP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-7LU7PVPP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-7LU7PVPP.js\");\n/* harmony import */ var _chunk_2KOUY3SJ_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunk-2KOUY3SJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2KOUY3SJ.js\");\n/* harmony import */ var _chunk_6B3UWAJ3_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./chunk-6B3UWAJ3.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-6B3UWAJ3.js\");\n/* harmony import */ var _chunk_AVAADPGB_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./chunk-AVAADPGB.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-AVAADPGB.js\");\n/* harmony import */ var _chunk_PHHYUVFI_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./chunk-PHHYUVFI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PHHYUVFI.js\");\n/* harmony import */ var _chunk_2RDAV2UB_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunk-2RDAV2UB.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-2RDAV2UB.js\");\n/* harmony import */ var _chunk_KYDZ4BE2_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./chunk-KYDZ4BE2.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KYDZ4BE2.js\");\n/* harmony import */ var _chunk_NP2H7VJV_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./chunk-NP2H7VJV.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NP2H7VJV.js\");\n/* harmony import */ var _chunk_PZOB66AP_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./chunk-PZOB66AP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PZOB66AP.js\");\n/* harmony import */ var _chunk_KKKJI5Y7_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./chunk-KKKJI5Y7.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KKKJI5Y7.js\");\n/* harmony import */ var _chunk_FR3BYA47_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./chunk-FR3BYA47.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FR3BYA47.js\");\n/* harmony import */ var _chunk_LNAETVOO_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./chunk-LNAETVOO.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-LNAETVOO.js\");\n/* harmony import */ var _chunk_NIUW4WF7_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./chunk-NIUW4WF7.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NIUW4WF7.js\");\n/* harmony import */ var _chunk_GYDUPG7X_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./chunk-GYDUPG7X.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js\");\n/* harmony import */ var _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./chunk-GBLEGHZW.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\");\n/* harmony import */ var _chunk_TOKZL3ZI_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./chunk-TOKZL3ZI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TOKZL3ZI.js\");\n/* harmony import */ var _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./chunk-XYKBKO6Z.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XYKBKO6Z.js\");\n/* harmony import */ var _chunk_VXDYNCOX_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./chunk-VXDYNCOX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-VXDYNCOX.js\");\n/* harmony import */ var _chunk_GTQM7JU7_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./chunk-GTQM7JU7.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GTQM7JU7.js\");\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./chunk-HVHN3Y2L.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_QQGZ3XGI_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./chunk-QQGZ3XGI.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-QQGZ3XGI.js\");\n/* harmony import */ var _chunk_62MWLLEG_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./chunk-62MWLLEG.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-62MWLLEG.js\");\n/* harmony import */ var _chunk_WZ6OIVJK_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./chunk-WZ6OIVJK.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-WZ6OIVJK.js\");\n/* harmony import */ var _chunk_KLDFBLYL_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./chunk-KLDFBLYL.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-KLDFBLYL.js\");\n/* harmony import */ var _chunk_NPO64SVN_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./chunk-NPO64SVN.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-NPO64SVN.js\");\n/* harmony import */ var _chunk_SK6Y2YH6_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./chunk-SK6Y2YH6.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-SK6Y2YH6.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./chunk-3XTQSPPA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./chunk-DBPOZRMS.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_53IPO2PJ_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./chunk-53IPO2PJ.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-53IPO2PJ.js\");\n/* harmony import */ var _chunk_FURNA6HY_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./chunk-FURNA6HY.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-FURNA6HY.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.64/node_modules/zod/dist/esm/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getVenderBaseURL() {\n  const vercel = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.VERCEL_URL;\n  const netlify = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.NETLIFY_URL;\n  const render = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.RENDER_URL;\n  const aws = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.AWS_LAMBDA_FUNCTION_NAME;\n  const google = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.GOOGLE_CLOUD_FUNCTION_NAME;\n  const azure = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.AZURE_FUNCTION_NAME;\n  return vercel || netlify || render || aws || google || azure;\n}\nvar oAuthProxy = (opts) => {\n  return {\n    id: \"oauth-proxy\",\n    endpoints: {\n      oAuthProxy: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthEndpoint)(\n        \"/oauth-proxy-callback\",\n        {\n          method: \"GET\",\n          query: zod__WEBPACK_IMPORTED_MODULE_37__.z.object({\n            callbackURL: zod__WEBPACK_IMPORTED_MODULE_37__.z.string({\n              description: \"The URL to redirect to after the proxy\"\n            }),\n            cookies: zod__WEBPACK_IMPORTED_MODULE_37__.z.string({\n              description: \"The cookies to set after the proxy\"\n            })\n          }),\n          use: [(0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.originCheck)((ctx) => ctx.query.callbackURL)],\n          metadata: {\n            openapi: {\n              description: \"OAuth Proxy Callback\",\n              parameters: [\n                {\n                  in: \"query\",\n                  name: \"callbackURL\",\n                  required: true,\n                  description: \"The URL to redirect to after the proxy\"\n                },\n                {\n                  in: \"query\",\n                  name: \"cookies\",\n                  required: true,\n                  description: \"The cookies to set after the proxy\"\n                }\n              ],\n              responses: {\n                302: {\n                  description: \"Redirect\",\n                  headers: {\n                    Location: {\n                      description: \"The URL to redirect to\",\n                      schema: {\n                        type: \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        async (ctx) => {\n          const cookies = ctx.query.cookies;\n          const decryptedCookies = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_32__.symmetricDecrypt)({\n            key: ctx.context.secret,\n            data: cookies\n          });\n          ctx.setHeader(\"set-cookie\", decryptedCookies);\n          throw ctx.redirect(ctx.query.callbackURL);\n        }\n      )\n    },\n    hooks: {\n      after: [\n        {\n          matcher(context) {\n            return context.path?.startsWith(\"/callback\");\n          },\n          handler: (0,_chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.createAuthMiddleware)(async (ctx) => {\n            const response = ctx.context.returned;\n            const headers = response instanceof _chunk_XYKBKO6Z_js__WEBPACK_IMPORTED_MODULE_20__.APIError ? response.headers : null;\n            const location = headers?.get(\"location\");\n            if (location?.includes(\"/oauth-proxy-callback?callbackURL\")) {\n              if (!location.startsWith(\"http\")) {\n                return;\n              }\n              const locationURL = new URL(location);\n              const origin = locationURL.origin;\n              if (origin === (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_24__.getOrigin)(ctx.context.baseURL)) {\n                const newLocation = locationURL.searchParams.get(\"callbackURL\");\n                if (!newLocation) {\n                  return;\n                }\n                ctx.setHeader(\"location\", newLocation);\n                return;\n              }\n              const setCookies = headers?.get(\"set-cookie\");\n              if (!setCookies) {\n                return;\n              }\n              const encryptedCookies = await (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_32__.symmetricEncrypt)({\n                key: ctx.context.secret,\n                data: setCookies\n              });\n              const locationWithCookies = `${location}&cookies=${encodeURIComponent(\n                encryptedCookies\n              )}`;\n              ctx.setHeader(\"location\", locationWithCookies);\n            }\n          })\n        }\n      ],\n      before: [\n        {\n          matcher(context) {\n            return context.path?.startsWith(\"/sign-in/social\");\n          },\n          async handler(ctx) {\n            const url = new URL(\n              opts?.currentURL || ctx.request?.url || getVenderBaseURL() || ctx.context.baseURL\n            );\n            const productionURL = opts?.productionURL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_35__.env.BETTER_AUTH_URL;\n            if (productionURL === ctx.context.options.baseURL) {\n              return;\n            }\n            ctx.body.callbackURL = `${url.origin}${ctx.context.options.basePath || \"/api/auth\"}/oauth-proxy-callback?callbackURL=${encodeURIComponent(\n              ctx.body.callbackURL || ctx.context.baseURL\n            )}`;\n            return {\n              context: ctx\n            };\n          }\n        }\n      ]\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3BsdWdpbnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWtEO0FBQ0Y7QUFDRDtBQUNsQjtBQUNhO0FBQ007QUFDRztBQUNOO0FBQ0M7QUFDSztBQUNBO0FBQ1A7QUFDSTtBQUNIO0FBQ087QUFDTDtBQUNJO0FBQ0c7QUFDekI7QUFDQTtBQUN5RTtBQUNKO0FBQ3JFO0FBQ0E7QUFDQTtBQUNtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDdUI7QUFDdkI7QUFDQTtBQUNBO0FBQzRDO0FBQzVDO0FBQ0E7QUFDYTtBQUNiO0FBQ0w7O0FBRXhCO0FBQ0EsaUJBQWlCLG9EQUFHO0FBQ3BCLGtCQUFrQixvREFBRztBQUNyQixpQkFBaUIsb0RBQUc7QUFDcEIsY0FBYyxvREFBRztBQUNqQixpQkFBaUIsb0RBQUc7QUFDcEIsZ0JBQWdCLG9EQUFHO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix1RUFBa0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDBDQUFRO0FBQ3pCLHlCQUF5QiwwQ0FBUTtBQUNqQztBQUNBLGFBQWE7QUFDYixxQkFBcUIsMENBQVE7QUFDN0I7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYLGdCQUFnQixnRUFBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHlDQUF5QyxxRUFBZ0I7QUFDekQ7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLG1CQUFtQix5RUFBb0I7QUFDdkM7QUFDQSxnREFBZ0QseURBQVE7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsOERBQVM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxxRUFBZ0I7QUFDN0Q7QUFDQTtBQUNBLGVBQWU7QUFDZiw2Q0FBNkMsU0FBUyxXQUFXO0FBQ2pFO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELG9EQUFHO0FBQzVEO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxXQUFXLEVBQUUsNENBQTRDLG9DQUFvQztBQUNuSTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXNCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvcGx1Z2lucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBwaG9uZU51bWJlciB9IGZyb20gJy4vY2h1bmstUkJPQUQ1NVkuanMnO1xuZXhwb3J0IHsgdHdvRmFjdG9yIH0gZnJvbSAnLi9jaHVuay1WUlZLN0NGVy5qcyc7XG5leHBvcnQgeyB1c2VybmFtZSB9IGZyb20gJy4vY2h1bmstTTdDN1RLSVUuanMnO1xuaW1wb3J0ICcuL2NodW5rLVdNWEJBNkxYLmpzJztcbmV4cG9ydCB7IGp3dCB9IGZyb20gJy4vY2h1bmstN0xVN1BWUFAuanMnO1xuZXhwb3J0IHsgbWFnaWNMaW5rIH0gZnJvbSAnLi9jaHVuay0yS09VWTNTSi5qcyc7XG5leHBvcnQgeyBtdWx0aVNlc3Npb24gfSBmcm9tICcuL2NodW5rLTZCM1VXQUozLmpzJztcbmV4cG9ydCB7IG9uZVRhcCB9IGZyb20gJy4vY2h1bmstQVZBQURQR0IuanMnO1xuZXhwb3J0IHsgb3BlbkFQSSB9IGZyb20gJy4vY2h1bmstUEhIWVVWRkkuanMnO1xuZXhwb3J0IHsgb3JnYW5pemF0aW9uIH0gZnJvbSAnLi9jaHVuay0yUkRBVjJVQi5qcyc7XG5leHBvcnQgeyBvaWRjUHJvdmlkZXIgfSBmcm9tICcuL2NodW5rLUtZRFo0QkUyLmpzJztcbmV4cG9ydCB7IGFkbWluIH0gZnJvbSAnLi9jaHVuay1OUDJIN1ZKVi5qcyc7XG5leHBvcnQgeyBhbm9ueW1vdXMgfSBmcm9tICcuL2NodW5rLVBaT0I2NkFQLmpzJztcbmV4cG9ydCB7IGJlYXJlciB9IGZyb20gJy4vY2h1bmstS0tLSkk1WTcuanMnO1xuZXhwb3J0IHsgY3VzdG9tU2Vzc2lvbiB9IGZyb20gJy4vY2h1bmstRlIzQllBNDcuanMnO1xuZXhwb3J0IHsgZW1haWxPVFAgfSBmcm9tICcuL2NodW5rLUxOQUVUVk9PLmpzJztcbmV4cG9ydCB7IGdlbmVyaWNPQXV0aCB9IGZyb20gJy4vY2h1bmstTklVVzRXRjcuanMnO1xuZXhwb3J0IHsgdHdvRmFjdG9yQ2xpZW50IH0gZnJvbSAnLi9jaHVuay1HWURVUEc3WC5qcyc7XG5pbXBvcnQgJy4vY2h1bmstR0JMRUdIWlcuanMnO1xuaW1wb3J0ICcuL2NodW5rLVRPS1pMM1pJLmpzJztcbmltcG9ydCB7IGNyZWF0ZUF1dGhFbmRwb2ludCwgb3JpZ2luQ2hlY2ssIGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBBUElFcnJvciB9IGZyb20gJy4vY2h1bmstWFlLQktPNlouanMnO1xuZXhwb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBjcmVhdGVBdXRoTWlkZGxld2FyZSwgb3B0aW9uc01pZGRsZXdhcmUgfSBmcm9tICcuL2NodW5rLVhZS0JLTzZaLmpzJztcbmltcG9ydCAnLi9jaHVuay1WWERZTkNPWC5qcyc7XG5pbXBvcnQgJy4vY2h1bmstR1RRTTdKVTcuanMnO1xuaW1wb3J0ICcuL2NodW5rLUhWSE4zWTJMLmpzJztcbmltcG9ydCB7IGdldE9yaWdpbiB9IGZyb20gJy4vY2h1bmstWEZDSUFOWlguanMnO1xuaW1wb3J0ICcuL2NodW5rLVFRR1ozWEdJLmpzJztcbmltcG9ydCAnLi9jaHVuay02Mk1XTExFRy5qcyc7XG5pbXBvcnQgJy4vY2h1bmstV1o2T0lWSksuanMnO1xuZXhwb3J0IHsgSElERV9NRVRBREFUQSB9IGZyb20gJy4vY2h1bmstS0xERkJMWUwuanMnO1xuaW1wb3J0ICcuL2NodW5rLU5QTzY0U1ZOLmpzJztcbmltcG9ydCAnLi9jaHVuay1TSzZZMllINi5qcyc7XG5pbXBvcnQgJy4vY2h1bmstM1hUUVNQUEEuanMnO1xuaW1wb3J0IHsgc3ltbWV0cmljRGVjcnlwdCwgc3ltbWV0cmljRW5jcnlwdCB9IGZyb20gJy4vY2h1bmstREJQT1pSTVMuanMnO1xuaW1wb3J0ICcuL2NodW5rLTUzSVBPMlBKLmpzJztcbmltcG9ydCAnLi9jaHVuay1GVVJOQTZIWS5qcyc7XG5pbXBvcnQgeyBlbnYgfSBmcm9tICcuL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCAnLi9jaHVuay1VTldDWEtNUC5qcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuZnVuY3Rpb24gZ2V0VmVuZGVyQmFzZVVSTCgpIHtcbiAgY29uc3QgdmVyY2VsID0gZW52LlZFUkNFTF9VUkw7XG4gIGNvbnN0IG5ldGxpZnkgPSBlbnYuTkVUTElGWV9VUkw7XG4gIGNvbnN0IHJlbmRlciA9IGVudi5SRU5ERVJfVVJMO1xuICBjb25zdCBhd3MgPSBlbnYuQVdTX0xBTUJEQV9GVU5DVElPTl9OQU1FO1xuICBjb25zdCBnb29nbGUgPSBlbnYuR09PR0xFX0NMT1VEX0ZVTkNUSU9OX05BTUU7XG4gIGNvbnN0IGF6dXJlID0gZW52LkFaVVJFX0ZVTkNUSU9OX05BTUU7XG4gIHJldHVybiB2ZXJjZWwgfHwgbmV0bGlmeSB8fCByZW5kZXIgfHwgYXdzIHx8IGdvb2dsZSB8fCBhenVyZTtcbn1cbnZhciBvQXV0aFByb3h5ID0gKG9wdHMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJvYXV0aC1wcm94eVwiLFxuICAgIGVuZHBvaW50czoge1xuICAgICAgb0F1dGhQcm94eTogY3JlYXRlQXV0aEVuZHBvaW50KFxuICAgICAgICBcIi9vYXV0aC1wcm94eS1jYWxsYmFja1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoe1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSBwcm94eVwiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNvb2tpZXM6IHouc3RyaW5nKHtcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGNvb2tpZXMgdG8gc2V0IGFmdGVyIHRoZSBwcm94eVwiXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBvcGVuYXBpOiB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk9BdXRoIFByb3h5IENhbGxiYWNrXCIsXG4gICAgICAgICAgICAgIHBhcmFtZXRlcnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBpbjogXCJxdWVyeVwiLFxuICAgICAgICAgICAgICAgICAgbmFtZTogXCJjYWxsYmFja1VSTFwiLFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGFmdGVyIHRoZSBwcm94eVwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBpbjogXCJxdWVyeVwiLFxuICAgICAgICAgICAgICAgICAgbmFtZTogXCJjb29raWVzXCIsXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBjb29raWVzIHRvIHNldCBhZnRlciB0aGUgcHJveHlcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgICAgICAgMzAyOiB7XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZWRpcmVjdFwiLFxuICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG9cIixcbiAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCBjb29raWVzID0gY3R4LnF1ZXJ5LmNvb2tpZXM7XG4gICAgICAgICAgY29uc3QgZGVjcnlwdGVkQ29va2llcyA9IGF3YWl0IHN5bW1ldHJpY0RlY3J5cHQoe1xuICAgICAgICAgICAga2V5OiBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgICBkYXRhOiBjb29raWVzXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY3R4LnNldEhlYWRlcihcInNldC1jb29raWVcIiwgZGVjcnlwdGVkQ29va2llcyk7XG4gICAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGN0eC5xdWVyeS5jYWxsYmFja1VSTCk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9LFxuICAgIGhvb2tzOiB7XG4gICAgICBhZnRlcjogW1xuICAgICAgICB7XG4gICAgICAgICAgbWF0Y2hlcihjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5wYXRoPy5zdGFydHNXaXRoKFwiL2NhbGxiYWNrXCIpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaGFuZGxlcjogY3JlYXRlQXV0aE1pZGRsZXdhcmUoYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBjdHguY29udGV4dC5yZXR1cm5lZDtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSByZXNwb25zZSBpbnN0YW5jZW9mIEFQSUVycm9yID8gcmVzcG9uc2UuaGVhZGVycyA6IG51bGw7XG4gICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGhlYWRlcnM/LmdldChcImxvY2F0aW9uXCIpO1xuICAgICAgICAgICAgaWYgKGxvY2F0aW9uPy5pbmNsdWRlcyhcIi9vYXV0aC1wcm94eS1jYWxsYmFjaz9jYWxsYmFja1VSTFwiKSkge1xuICAgICAgICAgICAgICBpZiAoIWxvY2F0aW9uLnN0YXJ0c1dpdGgoXCJodHRwXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uVVJMID0gbmV3IFVSTChsb2NhdGlvbik7XG4gICAgICAgICAgICAgIGNvbnN0IG9yaWdpbiA9IGxvY2F0aW9uVVJMLm9yaWdpbjtcbiAgICAgICAgICAgICAgaWYgKG9yaWdpbiA9PT0gZ2V0T3JpZ2luKGN0eC5jb250ZXh0LmJhc2VVUkwpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3TG9jYXRpb24gPSBsb2NhdGlvblVSTC5zZWFyY2hQYXJhbXMuZ2V0KFwiY2FsbGJhY2tVUkxcIik7XG4gICAgICAgICAgICAgICAgaWYgKCFuZXdMb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdHguc2V0SGVhZGVyKFwibG9jYXRpb25cIiwgbmV3TG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zdCBzZXRDb29raWVzID0gaGVhZGVycz8uZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICAgICAgICAgICAgaWYgKCFzZXRDb29raWVzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZENvb2tpZXMgPSBhd2FpdCBzeW1tZXRyaWNFbmNyeXB0KHtcbiAgICAgICAgICAgICAgICBrZXk6IGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICAgICAgICBkYXRhOiBzZXRDb29raWVzXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBjb25zdCBsb2NhdGlvbldpdGhDb29raWVzID0gYCR7bG9jYXRpb259JmNvb2tpZXM9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkQ29va2llc1xuICAgICAgICAgICAgICApfWA7XG4gICAgICAgICAgICAgIGN0eC5zZXRIZWFkZXIoXCJsb2NhdGlvblwiLCBsb2NhdGlvbldpdGhDb29raWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgYmVmb3JlOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBtYXRjaGVyKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LnBhdGg/LnN0YXJ0c1dpdGgoXCIvc2lnbi1pbi9zb2NpYWxcIik7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBoYW5kbGVyKGN0eCkge1xuICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChcbiAgICAgICAgICAgICAgb3B0cz8uY3VycmVudFVSTCB8fCBjdHgucmVxdWVzdD8udXJsIHx8IGdldFZlbmRlckJhc2VVUkwoKSB8fCBjdHguY29udGV4dC5iYXNlVVJMXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgcHJvZHVjdGlvblVSTCA9IG9wdHM/LnByb2R1Y3Rpb25VUkwgfHwgZW52LkJFVFRFUl9BVVRIX1VSTDtcbiAgICAgICAgICAgIGlmIChwcm9kdWN0aW9uVVJMID09PSBjdHguY29udGV4dC5vcHRpb25zLmJhc2VVUkwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3R4LmJvZHkuY2FsbGJhY2tVUkwgPSBgJHt1cmwub3JpZ2lufSR7Y3R4LmNvbnRleHQub3B0aW9ucy5iYXNlUGF0aCB8fCBcIi9hcGkvYXV0aFwifS9vYXV0aC1wcm94eS1jYWxsYmFjaz9jYWxsYmFja1VSTD0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgICAgY3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgY3R4LmNvbnRleHQuYmFzZVVSTFxuICAgICAgICAgICAgKX1gO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgY29udGV4dDogY3R4XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgXVxuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IG9BdXRoUHJveHkgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/plugins.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter)\n/* harmony export */ });\n// src/utils/misc.ts\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTNYVFFTUFBBLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFaUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay0zWFRRU1BQQS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvbWlzYy50c1xuZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cikge1xuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpO1xufVxuXG5leHBvcnQgeyBjYXBpdGFsaXplRmlyc3RMZXR0ZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-47EOFRJT.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-47EOFRJT.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InferPlugin: () => (/* binding */ InferPlugin),\n/* harmony export */   createAuthClient: () => (/* binding */ createAuthClient)\n/* harmony export */ });\n/* harmony import */ var _chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-PY47VMWF.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PY47VMWF.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-3XTQSPPA.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n\n\n\n// src/client/vanilla.ts\nfunction createAuthClient(options) {\n  const {\n    pluginPathMethods,\n    pluginsActions,\n    pluginsAtoms,\n    $fetch,\n    atomListeners,\n    $store\n  } = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_0__.getClientConfig)(options);\n  let resolvedHooks = {};\n  for (const [key, value] of Object.entries(pluginsAtoms)) {\n    resolvedHooks[`use${(0,_chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_1__.capitalizeFirstLetter)(key)}`] = value;\n  }\n  const routes = {\n    ...pluginsActions,\n    ...resolvedHooks,\n    $fetch,\n    $store\n  };\n  const proxy = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_0__.createDynamicPathProxy)(\n    routes,\n    $fetch,\n    pluginPathMethods,\n    pluginsAtoms,\n    atomListeners\n  );\n  return proxy;\n}\n\n// src/client/index.ts\nvar InferPlugin = () => {\n  return {\n    id: \"infer-server-plugin\",\n    $InferServerPlugin: {}\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTQ3RU9GUkpULmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEU7QUFDbEI7O0FBRTVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksRUFBRSxtRUFBZTtBQUNyQjtBQUNBO0FBQ0Esd0JBQXdCLHlFQUFxQixNQUFNO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDBFQUFzQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5QyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLTQ3RU9GUkpULmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldENsaWVudENvbmZpZywgY3JlYXRlRHluYW1pY1BhdGhQcm94eSB9IGZyb20gJy4vY2h1bmstUFk0N1ZNV0YuanMnO1xuaW1wb3J0IHsgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyIH0gZnJvbSAnLi9jaHVuay0zWFRRU1BQQS5qcyc7XG5cbi8vIHNyYy9jbGllbnQvdmFuaWxsYS50c1xuZnVuY3Rpb24gY3JlYXRlQXV0aENsaWVudChvcHRpb25zKSB7XG4gIGNvbnN0IHtcbiAgICBwbHVnaW5QYXRoTWV0aG9kcyxcbiAgICBwbHVnaW5zQWN0aW9ucyxcbiAgICBwbHVnaW5zQXRvbXMsXG4gICAgJGZldGNoLFxuICAgIGF0b21MaXN0ZW5lcnMsXG4gICAgJHN0b3JlXG4gIH0gPSBnZXRDbGllbnRDb25maWcob3B0aW9ucyk7XG4gIGxldCByZXNvbHZlZEhvb2tzID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHBsdWdpbnNBdG9tcykpIHtcbiAgICByZXNvbHZlZEhvb2tzW2B1c2Uke2NhcGl0YWxpemVGaXJzdExldHRlcihrZXkpfWBdID0gdmFsdWU7XG4gIH1cbiAgY29uc3Qgcm91dGVzID0ge1xuICAgIC4uLnBsdWdpbnNBY3Rpb25zLFxuICAgIC4uLnJlc29sdmVkSG9va3MsXG4gICAgJGZldGNoLFxuICAgICRzdG9yZVxuICB9O1xuICBjb25zdCBwcm94eSA9IGNyZWF0ZUR5bmFtaWNQYXRoUHJveHkoXG4gICAgcm91dGVzLFxuICAgICRmZXRjaCxcbiAgICBwbHVnaW5QYXRoTWV0aG9kcyxcbiAgICBwbHVnaW5zQXRvbXMsXG4gICAgYXRvbUxpc3RlbmVyc1xuICApO1xuICByZXR1cm4gcHJveHk7XG59XG5cbi8vIHNyYy9jbGllbnQvaW5kZXgudHNcbnZhciBJbmZlclBsdWdpbiA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJpbmZlci1zZXJ2ZXItcGx1Z2luXCIsXG4gICAgJEluZmVyU2VydmVyUGx1Z2luOiB7fVxuICB9O1xufTtcblxuZXhwb3J0IHsgSW5mZXJQbHVnaW4sIGNyZWF0ZUF1dGhDbGllbnQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-47EOFRJT.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compareHash: () => (/* binding */ compareHash),\n/* harmony export */   constantTimeEqual: () => (/* binding */ constantTimeEqual),\n/* harmony export */   generateRandomString: () => (/* binding */ generateRandomString),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   hashToBase64: () => (/* binding */ hashToBase64),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   symmetricDecrypt: () => (/* binding */ symmetricDecrypt),\n/* harmony export */   symmetricEncrypt: () => (/* binding */ symmetricEncrypt),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(ssr)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/ciphers/chacha */ \"(ssr)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @noble/ciphers/utils */ \"(ssr)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/utils.js\");\n/* harmony import */ var _noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @noble/ciphers/webcrypto */ \"(ssr)/./node_modules/.pnpm/@noble+ciphers@0.6.0/node_modules/@noble/ciphers/esm/webcrypto.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(ssr)/./node_modules/.pnpm/jose@5.10.0/node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var _noble_hashes_scrypt__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @noble/hashes/scrypt */ \"(ssr)/./node_modules/.pnpm/@noble+hashes@1.7.1/node_modules/@noble/hashes/esm/scrypt.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils */ \"(ssr)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(ssr)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/random */ \"(ssr)/./node_modules/.pnpm/@better-auth+utils@0.2.3/node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n\n\n\n\n\n\n\n\n// src/crypto/index.ts\n\n// src/crypto/buffer.ts\nfunction constantTimeEqual(a, b) {\n  const aBuffer = new Uint8Array(a);\n  const bBuffer = new Uint8Array(b);\n  if (aBuffer.length !== bBuffer.length) {\n    return false;\n  }\n  let c = 0;\n  for (let i = 0; i < aBuffer.length; i++) {\n    c |= aBuffer[i] ^ bBuffer[i];\n  }\n  return c === 0;\n}\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(data);\n  return Buffer.from(buffer).toString(\"base64\");\n}\nasync function compareHash(data, hash) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(\n    typeof data === \"string\" ? new TextEncoder().encode(data) : data\n  );\n  const hashBuffer = Buffer.from(hash, \"base64\");\n  return constantTimeEqual(buffer, hashBuffer);\n}\nasync function signJWT(payload, secret, expiresIn = 3600) {\n  const jwt = await new jose__WEBPACK_IMPORTED_MODULE_4__.SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n  return jwt;\n}\nvar config = {\n  N: 16384,\n  r: 16,\n  p: 1,\n  dkLen: 64\n};\nasync function generateKey(password, salt) {\n  return await (0,_noble_hashes_scrypt__WEBPACK_IMPORTED_MODULE_5__.scryptAsync)(password.normalize(\"NFKC\"), salt, {\n    N: config.N,\n    p: config.p,\n    r: config.r,\n    dkLen: config.dkLen,\n    maxmem: 128 * config.N * config.r * 2\n  });\n}\nvar hashPassword = async (password) => {\n  const salt = _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode((0,_better_auth_utils__WEBPACK_IMPORTED_MODULE_1__.getRandomValues)(new Uint8Array(16)));\n  const key = await generateKey(password, salt);\n  return `${salt}:${_better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_2__.hex.encode(key)}`;\n};\nvar verifyPassword = async ({\n  hash,\n  password\n}) => {\n  const [salt, key] = hash.split(\":\");\n  const targetKey = await generateKey(password, salt);\n  return constantTimeEqual(targetKey, new Uint8Array(Buffer.from(key, \"hex\")));\n};\nvar generateRandomString = (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_3__.createRandomStringGenerator)(\n  \"a-z\",\n  \"0-9\",\n  \"A-Z\",\n  \"-_\"\n);\n\n// src/crypto/index.ts\nvar symmetricEncrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.utf8ToBytes)(data);\n  const chacha = (0,_noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__.managedNonce)(_noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.bytesToHex)(chacha.encrypt(dataAsBytes));\n};\nvar symmetricDecrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils__WEBPACK_IMPORTED_MODULE_6__.hexToBytes)(data);\n  const chacha = (0,_noble_ciphers_webcrypto__WEBPACK_IMPORTED_MODULE_7__.managedNonce)(_noble_ciphers_chacha__WEBPACK_IMPORTED_MODULE_8__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLURCUE9aUk1TLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRDtBQUNLO0FBQ2lCO0FBQ25CO0FBQ3pCO0FBQ29CO0FBQ0U7QUFDUjtBQUMyQjs7QUFFeEU7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixvQkFBb0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixtRUFBVTtBQUNqQztBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQVU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlDQUFPLCtCQUErQixjQUFjO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUVBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsZUFBZSx1REFBRyxRQUFRLG1FQUFlO0FBQ3pDO0FBQ0EsWUFBWSxLQUFLLEdBQUcsdURBQUcsYUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzRkFBMkI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwyQkFBMkIsbUVBQVU7QUFDckMsc0JBQXNCLGlFQUFXO0FBQ2pDLGlCQUFpQixzRUFBWSxDQUFDLG9FQUFpQjtBQUMvQyxTQUFTLGdFQUFVO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDJCQUEyQixtRUFBVTtBQUNyQyxzQkFBc0IsZ0VBQVU7QUFDaEMsaUJBQWlCLHNFQUFZLENBQUMsb0VBQWlCO0FBQy9DO0FBQ0E7O0FBRXlKIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstREJQT1pSTVMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCB7IHhjaGFjaGEyMHBvbHkxMzA1IH0gZnJvbSAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhJztcbmltcG9ydCB7IHV0ZjhUb0J5dGVzLCBieXRlc1RvSGV4LCBoZXhUb0J5dGVzIH0gZnJvbSAnQG5vYmxlL2NpcGhlcnMvdXRpbHMnO1xuaW1wb3J0IHsgbWFuYWdlZE5vbmNlIH0gZnJvbSAnQG5vYmxlL2NpcGhlcnMvd2ViY3J5cHRvJztcbmltcG9ydCB7IFNpZ25KV1QgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHNjcnlwdEFzeW5jIH0gZnJvbSAnQG5vYmxlL2hhc2hlcy9zY3J5cHQnO1xuaW1wb3J0IHsgZ2V0UmFuZG9tVmFsdWVzIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzJztcbmltcG9ydCB7IGhleCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0IHsgY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbi8vIHNyYy9jcnlwdG8vaW5kZXgudHNcblxuLy8gc3JjL2NyeXB0by9idWZmZXIudHNcbmZ1bmN0aW9uIGNvbnN0YW50VGltZUVxdWFsKGEsIGIpIHtcbiAgY29uc3QgYUJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGEpO1xuICBjb25zdCBiQnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYik7XG4gIGlmIChhQnVmZmVyLmxlbmd0aCAhPT0gYkJ1ZmZlci5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgbGV0IGMgPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFCdWZmZXIubGVuZ3RoOyBpKyspIHtcbiAgICBjIHw9IGFCdWZmZXJbaV0gXiBiQnVmZmVyW2ldO1xuICB9XG4gIHJldHVybiBjID09PSAwO1xufVxuYXN5bmMgZnVuY3Rpb24gaGFzaFRvQmFzZTY0KGRhdGEpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGRhdGEpO1xuICByZXR1cm4gQnVmZmVyLmZyb20oYnVmZmVyKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbXBhcmVIYXNoKGRhdGEsIGhhc2gpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KFxuICAgIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpIDogZGF0YVxuICApO1xuICBjb25zdCBoYXNoQnVmZmVyID0gQnVmZmVyLmZyb20oaGFzaCwgXCJiYXNlNjRcIik7XG4gIHJldHVybiBjb25zdGFudFRpbWVFcXVhbChidWZmZXIsIGhhc2hCdWZmZXIpO1xufVxuYXN5bmMgZnVuY3Rpb24gc2lnbkpXVChwYXlsb2FkLCBzZWNyZXQsIGV4cGlyZXNJbiA9IDM2MDApIHtcbiAgY29uc3Qgand0ID0gYXdhaXQgbmV3IFNpZ25KV1QocGF5bG9hZCkuc2V0UHJvdGVjdGVkSGVhZGVyKHsgYWxnOiBcIkhTMjU2XCIgfSkuc2V0SXNzdWVkQXQoKS5zZXRFeHBpcmF0aW9uVGltZShNYXRoLmZsb29yKERhdGUubm93KCkgLyAxZTMpICsgZXhwaXJlc0luKS5zaWduKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzZWNyZXQpKTtcbiAgcmV0dXJuIGp3dDtcbn1cbnZhciBjb25maWcgPSB7XG4gIE46IDE2Mzg0LFxuICByOiAxNixcbiAgcDogMSxcbiAgZGtMZW46IDY0XG59O1xuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpIHtcbiAgcmV0dXJuIGF3YWl0IHNjcnlwdEFzeW5jKHBhc3N3b3JkLm5vcm1hbGl6ZShcIk5GS0NcIiksIHNhbHQsIHtcbiAgICBOOiBjb25maWcuTixcbiAgICBwOiBjb25maWcucCxcbiAgICByOiBjb25maWcucixcbiAgICBka0xlbjogY29uZmlnLmRrTGVuLFxuICAgIG1heG1lbTogMTI4ICogY29uZmlnLk4gKiBjb25maWcuciAqIDJcbiAgfSk7XG59XG52YXIgaGFzaFBhc3N3b3JkID0gYXN5bmMgKHBhc3N3b3JkKSA9PiB7XG4gIGNvbnN0IHNhbHQgPSBoZXguZW5jb2RlKGdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxNikpKTtcbiAgY29uc3Qga2V5ID0gYXdhaXQgZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpO1xuICByZXR1cm4gYCR7c2FsdH06JHtoZXguZW5jb2RlKGtleSl9YDtcbn07XG52YXIgdmVyaWZ5UGFzc3dvcmQgPSBhc3luYyAoe1xuICBoYXNoLFxuICBwYXNzd29yZFxufSkgPT4ge1xuICBjb25zdCBbc2FsdCwga2V5XSA9IGhhc2guc3BsaXQoXCI6XCIpO1xuICBjb25zdCB0YXJnZXRLZXkgPSBhd2FpdCBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCk7XG4gIHJldHVybiBjb25zdGFudFRpbWVFcXVhbCh0YXJnZXRLZXksIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKGtleSwgXCJoZXhcIikpKTtcbn07XG52YXIgZ2VuZXJhdGVSYW5kb21TdHJpbmcgPSBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IoXG4gIFwiYS16XCIsXG4gIFwiMC05XCIsXG4gIFwiQS1aXCIsXG4gIFwiLV9cIlxuKTtcblxuLy8gc3JjL2NyeXB0by9pbmRleC50c1xudmFyIHN5bW1ldHJpY0VuY3J5cHQgPSBhc3luYyAoe1xuICBrZXksXG4gIGRhdGFcbn0pID0+IHtcbiAgY29uc3Qga2V5QXNCeXRlcyA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChrZXkpO1xuICBjb25zdCBkYXRhQXNCeXRlcyA9IHV0ZjhUb0J5dGVzKGRhdGEpO1xuICBjb25zdCBjaGFjaGEgPSBtYW5hZ2VkTm9uY2UoeGNoYWNoYTIwcG9seTEzMDUpKG5ldyBVaW50OEFycmF5KGtleUFzQnl0ZXMpKTtcbiAgcmV0dXJuIGJ5dGVzVG9IZXgoY2hhY2hhLmVuY3J5cHQoZGF0YUFzQnl0ZXMpKTtcbn07XG52YXIgc3ltbWV0cmljRGVjcnlwdCA9IGFzeW5jICh7XG4gIGtleSxcbiAgZGF0YVxufSkgPT4ge1xuICBjb25zdCBrZXlBc0J5dGVzID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGtleSk7XG4gIGNvbnN0IGRhdGFBc0J5dGVzID0gaGV4VG9CeXRlcyhkYXRhKTtcbiAgY29uc3QgY2hhY2hhID0gbWFuYWdlZE5vbmNlKHhjaGFjaGEyMHBvbHkxMzA1KShuZXcgVWludDhBcnJheShrZXlBc0J5dGVzKSk7XG4gIHJldHVybiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoY2hhY2hhLmRlY3J5cHQoZGF0YUFzQnl0ZXMpKTtcbn07XG5cbmV4cG9ydCB7IGNvbXBhcmVIYXNoLCBjb25zdGFudFRpbWVFcXVhbCwgZ2VuZXJhdGVSYW5kb21TdHJpbmcsIGhhc2hQYXNzd29yZCwgaGFzaFRvQmFzZTY0LCBzaWduSldULCBzeW1tZXRyaWNEZWNyeXB0LCBzeW1tZXRyaWNFbmNyeXB0LCB2ZXJpZnlQYXNzd29yZCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminAc: () => (/* binding */ adminAc),\n/* harmony export */   createAccessControl: () => (/* binding */ createAccessControl),\n/* harmony export */   defaultAc: () => (/* binding */ defaultAc),\n/* harmony export */   defaultRoles: () => (/* binding */ defaultRoles),\n/* harmony export */   defaultStatements: () => (/* binding */ defaultStatements),\n/* harmony export */   memberAc: () => (/* binding */ memberAc),\n/* harmony export */   ownerAc: () => (/* binding */ ownerAc),\n/* harmony export */   role: () => (/* binding */ role)\n/* harmony export */ });\n// src/plugins/organization/access/access.ts\nfunction createAccessControl(s) {\n  return {\n    newRole(statements2) {\n      return role(statements2);\n    }\n  };\n}\nfunction role(statements) {\n  return {\n    statements,\n    authorize(request, connector) {\n      for (const [requestedResource, requestedActions] of Object.entries(\n        request\n      )) {\n        const allowedActions = statements[requestedResource];\n        if (!allowedActions) {\n          return {\n            success: false,\n            error: `You are not allowed to access resource: ${requestedResource}`\n          };\n        }\n        const success = connector === \"OR\" ? requestedActions.some(\n          (requestedAction) => allowedActions.includes(requestedAction)\n        ) : requestedActions.every(\n          (requestedAction) => allowedActions.includes(requestedAction)\n        );\n        if (success) {\n          return { success: true };\n        }\n        return {\n          success: false,\n          error: `Unauthorized to access resource \"${requestedResource}\"`\n        };\n      }\n      return {\n        success: false,\n        error: \"Not authorized\"\n      };\n    }\n  };\n}\n\n// src/plugins/organization/access/statement.ts\nvar defaultStatements = {\n  organization: [\"update\", \"delete\"],\n  member: [\"create\", \"update\", \"delete\"],\n  invitation: [\"create\", \"cancel\"]\n};\nvar defaultAc = createAccessControl();\nvar adminAc = defaultAc.newRole({\n  organization: [\"update\"],\n  invitation: [\"create\", \"cancel\"],\n  member: [\"create\", \"update\", \"delete\"]\n});\nvar ownerAc = defaultAc.newRole({\n  organization: [\"update\", \"delete\"],\n  member: [\"create\", \"update\", \"delete\"],\n  invitation: [\"create\", \"cancel\"]\n});\nvar memberAc = defaultAc.newRole({\n  organization: [],\n  member: [],\n  invitation: []\n});\nvar defaultRoles = {\n  admin: adminAc,\n  owner: ownerAc,\n  member: memberAc\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdCTEVHSFpXLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQsa0JBQWtCO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EscURBQXFELGtCQUFrQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2RyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdCTEVHSFpXLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9hY2Nlc3MvYWNjZXNzLnRzXG5mdW5jdGlvbiBjcmVhdGVBY2Nlc3NDb250cm9sKHMpIHtcbiAgcmV0dXJuIHtcbiAgICBuZXdSb2xlKHN0YXRlbWVudHMyKSB7XG4gICAgICByZXR1cm4gcm9sZShzdGF0ZW1lbnRzMik7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gcm9sZShzdGF0ZW1lbnRzKSB7XG4gIHJldHVybiB7XG4gICAgc3RhdGVtZW50cyxcbiAgICBhdXRob3JpemUocmVxdWVzdCwgY29ubmVjdG9yKSB7XG4gICAgICBmb3IgKGNvbnN0IFtyZXF1ZXN0ZWRSZXNvdXJjZSwgcmVxdWVzdGVkQWN0aW9uc10gb2YgT2JqZWN0LmVudHJpZXMoXG4gICAgICAgIHJlcXVlc3RcbiAgICAgICkpIHtcbiAgICAgICAgY29uc3QgYWxsb3dlZEFjdGlvbnMgPSBzdGF0ZW1lbnRzW3JlcXVlc3RlZFJlc291cmNlXTtcbiAgICAgICAgaWYgKCFhbGxvd2VkQWN0aW9ucykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBgWW91IGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MgcmVzb3VyY2U6ICR7cmVxdWVzdGVkUmVzb3VyY2V9YFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGNvbm5lY3RvciA9PT0gXCJPUlwiID8gcmVxdWVzdGVkQWN0aW9ucy5zb21lKFxuICAgICAgICAgIChyZXF1ZXN0ZWRBY3Rpb24pID0+IGFsbG93ZWRBY3Rpb25zLmluY2x1ZGVzKHJlcXVlc3RlZEFjdGlvbilcbiAgICAgICAgKSA6IHJlcXVlc3RlZEFjdGlvbnMuZXZlcnkoXG4gICAgICAgICAgKHJlcXVlc3RlZEFjdGlvbikgPT4gYWxsb3dlZEFjdGlvbnMuaW5jbHVkZXMocmVxdWVzdGVkQWN0aW9uKVxuICAgICAgICApO1xuICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBgVW5hdXRob3JpemVkIHRvIGFjY2VzcyByZXNvdXJjZSBcIiR7cmVxdWVzdGVkUmVzb3VyY2V9XCJgXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IFwiTm90IGF1dGhvcml6ZWRcIlxuICAgICAgfTtcbiAgICB9XG4gIH07XG59XG5cbi8vIHNyYy9wbHVnaW5zL29yZ2FuaXphdGlvbi9hY2Nlc3Mvc3RhdGVtZW50LnRzXG52YXIgZGVmYXVsdFN0YXRlbWVudHMgPSB7XG4gIG9yZ2FuaXphdGlvbjogW1widXBkYXRlXCIsIFwiZGVsZXRlXCJdLFxuICBtZW1iZXI6IFtcImNyZWF0ZVwiLCBcInVwZGF0ZVwiLCBcImRlbGV0ZVwiXSxcbiAgaW52aXRhdGlvbjogW1wiY3JlYXRlXCIsIFwiY2FuY2VsXCJdXG59O1xudmFyIGRlZmF1bHRBYyA9IGNyZWF0ZUFjY2Vzc0NvbnRyb2woKTtcbnZhciBhZG1pbkFjID0gZGVmYXVsdEFjLm5ld1JvbGUoe1xuICBvcmdhbml6YXRpb246IFtcInVwZGF0ZVwiXSxcbiAgaW52aXRhdGlvbjogW1wiY3JlYXRlXCIsIFwiY2FuY2VsXCJdLFxuICBtZW1iZXI6IFtcImNyZWF0ZVwiLCBcInVwZGF0ZVwiLCBcImRlbGV0ZVwiXVxufSk7XG52YXIgb3duZXJBYyA9IGRlZmF1bHRBYy5uZXdSb2xlKHtcbiAgb3JnYW5pemF0aW9uOiBbXCJ1cGRhdGVcIiwgXCJkZWxldGVcIl0sXG4gIG1lbWJlcjogW1wiY3JlYXRlXCIsIFwidXBkYXRlXCIsIFwiZGVsZXRlXCJdLFxuICBpbnZpdGF0aW9uOiBbXCJjcmVhdGVcIiwgXCJjYW5jZWxcIl1cbn0pO1xudmFyIG1lbWJlckFjID0gZGVmYXVsdEFjLm5ld1JvbGUoe1xuICBvcmdhbml6YXRpb246IFtdLFxuICBtZW1iZXI6IFtdLFxuICBpbnZpdGF0aW9uOiBbXVxufSk7XG52YXIgZGVmYXVsdFJvbGVzID0ge1xuICBhZG1pbjogYWRtaW5BYyxcbiAgb3duZXI6IG93bmVyQWMsXG4gIG1lbWJlcjogbWVtYmVyQWNcbn07XG5cbmV4cG9ydCB7IGFkbWluQWMsIGNyZWF0ZUFjY2Vzc0NvbnRyb2wsIGRlZmF1bHRBYywgZGVmYXVsdFJvbGVzLCBkZWZhdWx0U3RhdGVtZW50cywgbWVtYmVyQWMsIG93bmVyQWMsIHJvbGUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   twoFactorClient: () => (/* binding */ twoFactorClient)\n/* harmony export */ });\n// src/plugins/two-factor/client.ts\nvar twoFactorClient = (options) => {\n  return {\n    id: \"two-factor\",\n    $InferServerPlugin: {},\n    atomListeners: [\n      {\n        matcher: (path) => path.startsWith(\"/two-factor/\"),\n        signal: \"$sessionSignal\"\n      }\n    ],\n    pathMethods: {\n      \"/two-factor/disable\": \"POST\",\n      \"/two-factor/enable\": \"POST\",\n      \"/two-factor/send-otp\": \"POST\",\n      \"/two-factor/generate-backup-codes\": \"POST\"\n    },\n    fetchPlugins: [\n      {\n        id: \"two-factor\",\n        name: \"two-factor\",\n        hooks: {\n          async onSuccess(context) {\n            if (context.data?.twoFactorRedirect) {\n              if (options?.onTwoFactorRedirect) {\n                await options.onTwoFactorRedirect();\n              }\n            }\n          }\n        }\n      }\n    ]\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUdZRFVQRzdYLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTJCIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstR1lEVVBHN1guanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3BsdWdpbnMvdHdvLWZhY3Rvci9jbGllbnQudHNcbnZhciB0d29GYWN0b3JDbGllbnQgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInR3by1mYWN0b3JcIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9LFxuICAgIGF0b21MaXN0ZW5lcnM6IFtcbiAgICAgIHtcbiAgICAgICAgbWF0Y2hlcjogKHBhdGgpID0+IHBhdGguc3RhcnRzV2l0aChcIi90d28tZmFjdG9yL1wiKSxcbiAgICAgICAgc2lnbmFsOiBcIiRzZXNzaW9uU2lnbmFsXCJcbiAgICAgIH1cbiAgICBdLFxuICAgIHBhdGhNZXRob2RzOiB7XG4gICAgICBcIi90d28tZmFjdG9yL2Rpc2FibGVcIjogXCJQT1NUXCIsXG4gICAgICBcIi90d28tZmFjdG9yL2VuYWJsZVwiOiBcIlBPU1RcIixcbiAgICAgIFwiL3R3by1mYWN0b3Ivc2VuZC1vdHBcIjogXCJQT1NUXCIsXG4gICAgICBcIi90d28tZmFjdG9yL2dlbmVyYXRlLWJhY2t1cC1jb2Rlc1wiOiBcIlBPU1RcIlxuICAgIH0sXG4gICAgZmV0Y2hQbHVnaW5zOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiBcInR3by1mYWN0b3JcIixcbiAgICAgICAgbmFtZTogXCJ0d28tZmFjdG9yXCIsXG4gICAgICAgIGhvb2tzOiB7XG4gICAgICAgICAgYXN5bmMgb25TdWNjZXNzKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmRhdGE/LnR3b0ZhY3RvclJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgIGlmIChvcHRpb25zPy5vblR3b0ZhY3RvclJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgb3B0aW9ucy5vblR3b0ZhY3RvclJlZGlyZWN0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG5leHBvcnQgeyB0d29GYWN0b3JDbGllbnQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseJSON: () => (/* binding */ parseJSON),\n/* harmony export */   parser_default: () => (/* binding */ parser_default)\n/* harmony export */ });\n// src/client/parser.ts\nvar PROTO_POLLUTION_PATTERNS = {\n  proto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n  constructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n  protoShort: /\"__proto__\"\\s*:/,\n  constructorShort: /\"constructor\"\\s*:/\n};\nvar JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nvar SPECIAL_VALUES = {\n  true: true,\n  false: false,\n  null: null,\n  undefined: void 0,\n  nan: Number.NaN,\n  infinity: Number.POSITIVE_INFINITY,\n  \"-infinity\": Number.NEGATIVE_INFINITY\n};\nvar ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n  return date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n  const match = ISO_DATE_REGEX.exec(value);\n  if (!match) return null;\n  const [\n    ,\n    year,\n    month,\n    day,\n    hour,\n    minute,\n    second,\n    ms,\n    offsetSign,\n    offsetHour,\n    offsetMinute\n  ] = match;\n  let date = new Date(\n    Date.UTC(\n      parseInt(year, 10),\n      parseInt(month, 10) - 1,\n      parseInt(day, 10),\n      parseInt(hour, 10),\n      parseInt(minute, 10),\n      parseInt(second, 10),\n      ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0\n    )\n  );\n  if (offsetSign) {\n    const offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n    date.setUTCMinutes(date.getUTCMinutes() + offset);\n  }\n  return isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n  const {\n    strict = false,\n    warnings = false,\n    reviver,\n    parseDates = true\n  } = options;\n  if (typeof value !== \"string\") {\n    return value;\n  }\n  const trimmed = value.trim();\n  if (trimmed[0] === '\"' && trimmed.endsWith('\"') && !trimmed.slice(1, -1).includes('\"')) {\n    return trimmed.slice(1, -1);\n  }\n  const lowerValue = trimmed.toLowerCase();\n  if (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n    return SPECIAL_VALUES[lowerValue];\n  }\n  if (!JSON_SIGNATURE.test(trimmed)) {\n    if (strict) {\n      throw new SyntaxError(\"[better-json] Invalid JSON\");\n    }\n    return value;\n  }\n  const hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n    ([key, pattern]) => {\n      const matches = pattern.test(trimmed);\n      if (matches && warnings) {\n        console.warn(\n          `[better-json] Detected potential prototype pollution attempt using ${key} pattern`\n        );\n      }\n      return matches;\n    }\n  );\n  if (hasProtoPattern && strict) {\n    throw new Error(\n      \"[better-json] Potential prototype pollution attempt detected\"\n    );\n  }\n  try {\n    const secureReviver = (key, value2) => {\n      if (key === \"__proto__\" || key === \"constructor\" && value2 && typeof value2 === \"object\" && \"prototype\" in value2) {\n        if (warnings) {\n          console.warn(\n            `[better-json] Dropping \"${key}\" key to prevent prototype pollution`\n          );\n        }\n        return void 0;\n      }\n      if (parseDates && typeof value2 === \"string\") {\n        const date = parseISODate(value2);\n        if (date) {\n          return date;\n        }\n      }\n      return reviver ? reviver(key, value2) : value2;\n    };\n    return JSON.parse(trimmed, secureReviver);\n  } catch (error) {\n    if (strict) {\n      throw error;\n    }\n    return value;\n  }\n}\nfunction parseJSON(value, options = { strict: true }) {\n  return betterJSONParse(value, options);\n}\nvar parser_default = parseJSON;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUhWSE4zWTJMLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBLHFCQUFxQixFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLFdBQVcsS0FBSyxNQUFNLEtBQUs7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLElBQUksa0JBQWtCLEVBQUUsTUFBTSxFQUFFO0FBQy9HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0ZBQWdGLEtBQUs7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGNBQWM7QUFDcEQ7QUFDQTtBQUNBOztBQUVxQyIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLUhWSE4zWTJMLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jbGllbnQvcGFyc2VyLnRzXG52YXIgUFJPVE9fUE9MTFVUSU9OX1BBVFRFUk5TID0ge1xuICBwcm90bzogL1wiKD86X3xcXFxcdTB7Mn01W0ZmXSl7Mn0oPzpwfFxcXFx1MHsyfTcwKSg/OnJ8XFxcXHUwezJ9NzIpKD86b3xcXFxcdTB7Mn02W0ZmXSkoPzp0fFxcXFx1MHsyfTc0KSg/Om98XFxcXHUwezJ9NltGZl0pKD86X3xcXFxcdTB7Mn01W0ZmXSl7Mn1cIlxccyo6LyxcbiAgY29uc3RydWN0b3I6IC9cIig/OmN8XFxcXHUwMDYzKSg/Om98XFxcXHUwMDZbRmZdKSg/Om58XFxcXHUwMDZbRWVdKSg/OnN8XFxcXHUwMDczKSg/OnR8XFxcXHUwMDc0KSg/OnJ8XFxcXHUwMDcyKSg/OnV8XFxcXHUwMDc1KSg/OmN8XFxcXHUwMDYzKSg/OnR8XFxcXHUwMDc0KSg/Om98XFxcXHUwMDZbRmZdKSg/OnJ8XFxcXHUwMDcyKVwiXFxzKjovLFxuICBwcm90b1Nob3J0OiAvXCJfX3Byb3RvX19cIlxccyo6LyxcbiAgY29uc3RydWN0b3JTaG9ydDogL1wiY29uc3RydWN0b3JcIlxccyo6L1xufTtcbnZhciBKU09OX1NJR05BVFVSRSA9IC9eXFxzKltcIlt7XXxeXFxzKi0/XFxkezEsMTZ9KFxcLlxcZHsxLDE3fSk/KFtFZV1bKy1dP1xcZCspP1xccyokLztcbnZhciBTUEVDSUFMX1ZBTFVFUyA9IHtcbiAgdHJ1ZTogdHJ1ZSxcbiAgZmFsc2U6IGZhbHNlLFxuICBudWxsOiBudWxsLFxuICB1bmRlZmluZWQ6IHZvaWQgMCxcbiAgbmFuOiBOdW1iZXIuTmFOLFxuICBpbmZpbml0eTogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxuICBcIi1pbmZpbml0eVwiOiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFlcbn07XG52YXIgSVNPX0RBVEVfUkVHRVggPSAvXihcXGR7NH0pLShcXGR7Mn0pLShcXGR7Mn0pVChcXGR7Mn0pOihcXGR7Mn0pOihcXGR7Mn0pKD86XFwuKFxcZHsxLDd9KSk/KD86WnwoWystXSkoXFxkezJ9KTooXFxkezJ9KSkkLztcbmZ1bmN0aW9uIGlzVmFsaWREYXRlKGRhdGUpIHtcbiAgcmV0dXJuIGRhdGUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTihkYXRlLmdldFRpbWUoKSk7XG59XG5mdW5jdGlvbiBwYXJzZUlTT0RhdGUodmFsdWUpIHtcbiAgY29uc3QgbWF0Y2ggPSBJU09fREFURV9SRUdFWC5leGVjKHZhbHVlKTtcbiAgaWYgKCFtYXRjaCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IFtcbiAgICAsXG4gICAgeWVhcixcbiAgICBtb250aCxcbiAgICBkYXksXG4gICAgaG91cixcbiAgICBtaW51dGUsXG4gICAgc2Vjb25kLFxuICAgIG1zLFxuICAgIG9mZnNldFNpZ24sXG4gICAgb2Zmc2V0SG91cixcbiAgICBvZmZzZXRNaW51dGVcbiAgXSA9IG1hdGNoO1xuICBsZXQgZGF0ZSA9IG5ldyBEYXRlKFxuICAgIERhdGUuVVRDKFxuICAgICAgcGFyc2VJbnQoeWVhciwgMTApLFxuICAgICAgcGFyc2VJbnQobW9udGgsIDEwKSAtIDEsXG4gICAgICBwYXJzZUludChkYXksIDEwKSxcbiAgICAgIHBhcnNlSW50KGhvdXIsIDEwKSxcbiAgICAgIHBhcnNlSW50KG1pbnV0ZSwgMTApLFxuICAgICAgcGFyc2VJbnQoc2Vjb25kLCAxMCksXG4gICAgICBtcyA/IHBhcnNlSW50KG1zLnBhZEVuZCgzLCBcIjBcIiksIDEwKSA6IDBcbiAgICApXG4gICk7XG4gIGlmIChvZmZzZXRTaWduKSB7XG4gICAgY29uc3Qgb2Zmc2V0ID0gKHBhcnNlSW50KG9mZnNldEhvdXIsIDEwKSAqIDYwICsgcGFyc2VJbnQob2Zmc2V0TWludXRlLCAxMCkpICogKG9mZnNldFNpZ24gPT09IFwiK1wiID8gLTEgOiAxKTtcbiAgICBkYXRlLnNldFVUQ01pbnV0ZXMoZGF0ZS5nZXRVVENNaW51dGVzKCkgKyBvZmZzZXQpO1xuICB9XG4gIHJldHVybiBpc1ZhbGlkRGF0ZShkYXRlKSA/IGRhdGUgOiBudWxsO1xufVxuZnVuY3Rpb24gYmV0dGVySlNPTlBhcnNlKHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHN0cmljdCA9IGZhbHNlLFxuICAgIHdhcm5pbmdzID0gZmFsc2UsXG4gICAgcmV2aXZlcixcbiAgICBwYXJzZURhdGVzID0gdHJ1ZVxuICB9ID0gb3B0aW9ucztcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBjb25zdCB0cmltbWVkID0gdmFsdWUudHJpbSgpO1xuICBpZiAodHJpbW1lZFswXSA9PT0gJ1wiJyAmJiB0cmltbWVkLmVuZHNXaXRoKCdcIicpICYmICF0cmltbWVkLnNsaWNlKDEsIC0xKS5pbmNsdWRlcygnXCInKSkge1xuICAgIHJldHVybiB0cmltbWVkLnNsaWNlKDEsIC0xKTtcbiAgfVxuICBjb25zdCBsb3dlclZhbHVlID0gdHJpbW1lZC50b0xvd2VyQ2FzZSgpO1xuICBpZiAobG93ZXJWYWx1ZS5sZW5ndGggPD0gOSAmJiBsb3dlclZhbHVlIGluIFNQRUNJQUxfVkFMVUVTKSB7XG4gICAgcmV0dXJuIFNQRUNJQUxfVkFMVUVTW2xvd2VyVmFsdWVdO1xuICB9XG4gIGlmICghSlNPTl9TSUdOQVRVUkUudGVzdCh0cmltbWVkKSkge1xuICAgIGlmIChzdHJpY3QpIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcIltiZXR0ZXItanNvbl0gSW52YWxpZCBKU09OXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgY29uc3QgaGFzUHJvdG9QYXR0ZXJuID0gT2JqZWN0LmVudHJpZXMoUFJPVE9fUE9MTFVUSU9OX1BBVFRFUk5TKS5zb21lKFxuICAgIChba2V5LCBwYXR0ZXJuXSkgPT4ge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IHBhdHRlcm4udGVzdCh0cmltbWVkKTtcbiAgICAgIGlmIChtYXRjaGVzICYmIHdhcm5pbmdzKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICBgW2JldHRlci1qc29uXSBEZXRlY3RlZCBwb3RlbnRpYWwgcHJvdG90eXBlIHBvbGx1dGlvbiBhdHRlbXB0IHVzaW5nICR7a2V5fSBwYXR0ZXJuYFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgfVxuICApO1xuICBpZiAoaGFzUHJvdG9QYXR0ZXJuICYmIHN0cmljdCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiW2JldHRlci1qc29uXSBQb3RlbnRpYWwgcHJvdG90eXBlIHBvbGx1dGlvbiBhdHRlbXB0IGRldGVjdGVkXCJcbiAgICApO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3Qgc2VjdXJlUmV2aXZlciA9IChrZXksIHZhbHVlMikgPT4ge1xuICAgICAgaWYgKGtleSA9PT0gXCJfX3Byb3RvX19cIiB8fCBrZXkgPT09IFwiY29uc3RydWN0b3JcIiAmJiB2YWx1ZTIgJiYgdHlwZW9mIHZhbHVlMiA9PT0gXCJvYmplY3RcIiAmJiBcInByb3RvdHlwZVwiIGluIHZhbHVlMikge1xuICAgICAgICBpZiAod2FybmluZ3MpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICBgW2JldHRlci1qc29uXSBEcm9wcGluZyBcIiR7a2V5fVwiIGtleSB0byBwcmV2ZW50IHByb3RvdHlwZSBwb2xsdXRpb25gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgfVxuICAgICAgaWYgKHBhcnNlRGF0ZXMgJiYgdHlwZW9mIHZhbHVlMiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBjb25zdCBkYXRlID0gcGFyc2VJU09EYXRlKHZhbHVlMik7XG4gICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXZpdmVyID8gcmV2aXZlcihrZXksIHZhbHVlMikgOiB2YWx1ZTI7XG4gICAgfTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZSh0cmltbWVkLCBzZWN1cmVSZXZpdmVyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoc3RyaWN0KSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5mdW5jdGlvbiBwYXJzZUpTT04odmFsdWUsIG9wdGlvbnMgPSB7IHN0cmljdDogdHJ1ZSB9KSB7XG4gIHJldHVybiBiZXR0ZXJKU09OUGFyc2UodmFsdWUsIG9wdGlvbnMpO1xufVxudmFyIHBhcnNlcl9kZWZhdWx0ID0gcGFyc2VKU09OO1xuXG5leHBvcnQgeyBwYXJzZUpTT04sIHBhcnNlcl9kZWZhdWx0IH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PY47VMWF.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PY47VMWF.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDynamicPathProxy: () => (/* binding */ createDynamicPathProxy),\n/* harmony export */   getClientConfig: () => (/* binding */ getClientConfig),\n/* harmony export */   useAuthQuery: () => (/* binding */ useAuthQuery)\n/* harmony export */ });\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-HVHN3Y2L.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/.pnpm/@better-fetch+fetch@1.1.12/node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@0.11.4/node_modules/nanostores/atom/index.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@0.11.4/node_modules/nanostores/lifecycle/index.js\");\n\n\n\n\n\nvar useAuthQuery = (initializedAtom, path, $fetch, options) => {\n  const value = (0,nanostores__WEBPACK_IMPORTED_MODULE_3__.atom)({\n    data: null,\n    error: null,\n    isPending: true,\n    isRefetching: false,\n    refetch: () => {\n      return fn();\n    }\n  });\n  const fn = () => {\n    const opts = typeof options === \"function\" ? options({\n      data: value.get().data,\n      error: value.get().error,\n      isPending: value.get().isPending\n    }) : options;\n    return $fetch(path, {\n      ...opts,\n      async onSuccess(context) {\n        if (typeof window !== \"undefined\") {\n          value.set({\n            data: context.data,\n            error: null,\n            isPending: false,\n            isRefetching: false,\n            refetch: value.value.refetch\n          });\n        }\n        await opts?.onSuccess?.(context);\n      },\n      async onError(context) {\n        const { request } = context;\n        const retryAttempts = typeof request.retry === \"number\" ? request.retry : request.retry?.attempts;\n        const retryAttempt = request.retryAttempt || 0;\n        if (retryAttempts && retryAttempt < retryAttempts) return;\n        value.set({\n          error: context.error,\n          data: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onError?.(context);\n      },\n      async onRequest(context) {\n        const currentValue = value.get();\n        value.set({\n          isPending: currentValue.data === null,\n          data: currentValue.data,\n          error: null,\n          isRefetching: true,\n          refetch: value.value.refetch\n        });\n        await opts?.onRequest?.(context);\n      }\n    });\n  };\n  initializedAtom = Array.isArray(initializedAtom) ? initializedAtom : [initializedAtom];\n  let isMounted = false;\n  for (const initAtom of initializedAtom) {\n    initAtom.subscribe(() => {\n      if (isMounted) {\n        fn();\n      } else {\n        (0,nanostores__WEBPACK_IMPORTED_MODULE_4__.onMount)(value, () => {\n          fn();\n          isMounted = true;\n          return () => {\n            value.off();\n            initAtom.off();\n          };\n        });\n      }\n    });\n  }\n  return value;\n};\nvar redirectPlugin = {\n  id: \"redirect\",\n  name: \"Redirect\",\n  hooks: {\n    onSuccess(context) {\n      if (context.data?.url && context.data?.redirect) {\n        if (typeof window !== \"undefined\" && window.location) {\n          if (window.location) {\n            try {\n              window.location.href = context.data.url;\n            } catch {\n            }\n          }\n        }\n      }\n    }\n  }\n};\nfunction getSessionAtom($fetch) {\n  const $signal = (0,nanostores__WEBPACK_IMPORTED_MODULE_3__.atom)(false);\n  const session = useAuthQuery($signal, \"/get-session\", $fetch, {\n    method: \"GET\"\n  });\n  return {\n    session,\n    $sessionSignal: $signal\n  };\n}\n\n// src/client/config.ts\nvar getClientConfig = (options) => {\n  const isCredentialsSupported = \"credentials\" in Request.prototype;\n  const baseURL = (0,_chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_1__.getBaseURL)(options?.baseURL);\n  const pluginsFetchPlugins = options?.plugins?.flatMap((plugin) => plugin.fetchPlugins).filter((pl) => pl !== void 0) || [];\n  const $fetch = (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_2__.createFetch)({\n    baseURL,\n    ...isCredentialsSupported ? { credentials: \"include\" } : {},\n    method: \"GET\",\n    jsonParser(text) {\n      return (0,_chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_0__.parseJSON)(text, {\n        strict: false\n      });\n    },\n    customFetchImpl: async (input, init) => {\n      try {\n        return await fetch(input, init);\n      } catch (error) {\n        return Response.error();\n      }\n    },\n    ...options?.fetchOptions,\n    plugins: options?.disableDefaultFetchPlugins ? [...options?.fetchOptions?.plugins || [], ...pluginsFetchPlugins] : [\n      redirectPlugin,\n      ...options?.fetchOptions?.plugins || [],\n      ...pluginsFetchPlugins\n    ]\n  });\n  const { $sessionSignal, session } = getSessionAtom($fetch);\n  const plugins = options?.plugins || [];\n  let pluginsActions = {};\n  let pluginsAtoms = {\n    $sessionSignal,\n    session\n  };\n  let pluginPathMethods = {\n    \"/sign-out\": \"POST\",\n    \"/revoke-sessions\": \"POST\",\n    \"/revoke-other-sessions\": \"POST\",\n    \"/delete-user\": \"POST\"\n  };\n  const atomListeners = [\n    {\n      signal: \"$sessionSignal\",\n      matcher(path) {\n        return path === \"/sign-out\" || path === \"/update-user\" || path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path === \"/delete-user\";\n      }\n    }\n  ];\n  for (const plugin of plugins) {\n    if (plugin.getAtoms) {\n      Object.assign(pluginsAtoms, plugin.getAtoms?.($fetch));\n    }\n    if (plugin.pathMethods) {\n      Object.assign(pluginPathMethods, plugin.pathMethods);\n    }\n    if (plugin.atomListeners) {\n      atomListeners.push(...plugin.atomListeners);\n    }\n  }\n  const $store = {\n    notify: (signal) => {\n      pluginsAtoms[signal].set(\n        !pluginsAtoms[signal].get()\n      );\n    },\n    listen: (signal, listener) => {\n      pluginsAtoms[signal].subscribe(listener);\n    },\n    atoms: pluginsAtoms\n  };\n  for (const plugin of plugins) {\n    if (plugin.getActions) {\n      Object.assign(pluginsActions, plugin.getActions?.($fetch, $store));\n    }\n  }\n  return {\n    pluginsActions,\n    pluginsAtoms,\n    pluginPathMethods,\n    atomListeners,\n    $fetch,\n    $store\n  };\n};\n\n// src/client/proxy.ts\nfunction getMethod(path, knownPathMethods, args) {\n  const method = knownPathMethods[path];\n  const { fetchOptions, query, ...body } = args || {};\n  if (method) {\n    return method;\n  }\n  if (fetchOptions?.method) {\n    return fetchOptions.method;\n  }\n  if (body && Object.keys(body).length > 0) {\n    return \"POST\";\n  }\n  return \"GET\";\n}\nfunction createDynamicPathProxy(routes, client, knownPathMethods, atoms, atomListeners) {\n  function createProxy(path = []) {\n    return new Proxy(function() {\n    }, {\n      get(target, prop) {\n        const fullPath = [...path, prop];\n        let current = routes;\n        for (const segment of fullPath) {\n          if (current && typeof current === \"object\" && segment in current) {\n            current = current[segment];\n          } else {\n            current = void 0;\n            break;\n          }\n        }\n        if (typeof current === \"function\") {\n          return current;\n        }\n        return createProxy(fullPath);\n      },\n      apply: async (_, __, args) => {\n        const routePath = \"/\" + path.map(\n          (segment) => segment.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`)\n        ).join(\"/\");\n        const arg = args[0] || {};\n        const fetchOptions = args[1] || {};\n        const { query, fetchOptions: argFetchOptions, ...body } = arg;\n        const options = {\n          ...fetchOptions,\n          ...argFetchOptions\n        };\n        const method = getMethod(routePath, knownPathMethods, arg);\n        return await client(routePath, {\n          ...options,\n          body: method === \"GET\" ? void 0 : {\n            ...body,\n            ...options?.body || {}\n          },\n          query: query || options?.query,\n          method,\n          async onSuccess(context) {\n            await options?.onSuccess?.(context);\n            const matches = atomListeners?.find((s) => s.matcher(routePath));\n            if (!matches) return;\n            const signal = atoms[matches.signal];\n            if (!signal) return;\n            const val = signal.get();\n            setTimeout(() => {\n              signal.set(!val);\n            }, 10);\n          }\n        });\n      }\n    });\n  }\n  return createProxy();\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVBZNDdWTVdGLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQWdEO0FBQ0M7QUFDQztBQUNQOztBQUUzQztBQUNBLGdCQUFnQixnREFBSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLFFBQVEsbURBQU87QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnREFBSTtBQUN0QjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDhEQUFVO0FBQzVCO0FBQ0EsaUJBQWlCLGdFQUFXO0FBQzVCO0FBQ0Esa0NBQWtDLHlCQUF5QixJQUFJO0FBQy9EO0FBQ0E7QUFDQSxhQUFhLDZEQUFTO0FBQ3RCO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsVUFBVSwwQkFBMEI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsVUFBVSwrQkFBK0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsaUVBQWlFLHFCQUFxQjtBQUN0RjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0RBQWdEO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVpRSIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVBZNDdWTVdGLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlSlNPTiB9IGZyb20gJy4vY2h1bmstSFZITjNZMkwuanMnO1xuaW1wb3J0IHsgZ2V0QmFzZVVSTCB9IGZyb20gJy4vY2h1bmstWEZDSUFOWlguanMnO1xuaW1wb3J0IHsgY3JlYXRlRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCB7IGF0b20sIG9uTW91bnQgfSBmcm9tICduYW5vc3RvcmVzJztcblxudmFyIHVzZUF1dGhRdWVyeSA9IChpbml0aWFsaXplZEF0b20sIHBhdGgsICRmZXRjaCwgb3B0aW9ucykgPT4ge1xuICBjb25zdCB2YWx1ZSA9IGF0b20oe1xuICAgIGRhdGE6IG51bGwsXG4gICAgZXJyb3I6IG51bGwsXG4gICAgaXNQZW5kaW5nOiB0cnVlLFxuICAgIGlzUmVmZXRjaGluZzogZmFsc2UsXG4gICAgcmVmZXRjaDogKCkgPT4ge1xuICAgICAgcmV0dXJuIGZuKCk7XG4gICAgfVxuICB9KTtcbiAgY29uc3QgZm4gPSAoKSA9PiB7XG4gICAgY29uc3Qgb3B0cyA9IHR5cGVvZiBvcHRpb25zID09PSBcImZ1bmN0aW9uXCIgPyBvcHRpb25zKHtcbiAgICAgIGRhdGE6IHZhbHVlLmdldCgpLmRhdGEsXG4gICAgICBlcnJvcjogdmFsdWUuZ2V0KCkuZXJyb3IsXG4gICAgICBpc1BlbmRpbmc6IHZhbHVlLmdldCgpLmlzUGVuZGluZ1xuICAgIH0pIDogb3B0aW9ucztcbiAgICByZXR1cm4gJGZldGNoKHBhdGgsIHtcbiAgICAgIC4uLm9wdHMsXG4gICAgICBhc3luYyBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHZhbHVlLnNldCh7XG4gICAgICAgICAgICBkYXRhOiBjb250ZXh0LmRhdGEsXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIGlzUGVuZGluZzogZmFsc2UsXG4gICAgICAgICAgICBpc1JlZmV0Y2hpbmc6IGZhbHNlLFxuICAgICAgICAgICAgcmVmZXRjaDogdmFsdWUudmFsdWUucmVmZXRjaFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IG9wdHM/Lm9uU3VjY2Vzcz8uKGNvbnRleHQpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIG9uRXJyb3IoY29udGV4dCkge1xuICAgICAgICBjb25zdCB7IHJlcXVlc3QgfSA9IGNvbnRleHQ7XG4gICAgICAgIGNvbnN0IHJldHJ5QXR0ZW1wdHMgPSB0eXBlb2YgcmVxdWVzdC5yZXRyeSA9PT0gXCJudW1iZXJcIiA/IHJlcXVlc3QucmV0cnkgOiByZXF1ZXN0LnJldHJ5Py5hdHRlbXB0cztcbiAgICAgICAgY29uc3QgcmV0cnlBdHRlbXB0ID0gcmVxdWVzdC5yZXRyeUF0dGVtcHQgfHwgMDtcbiAgICAgICAgaWYgKHJldHJ5QXR0ZW1wdHMgJiYgcmV0cnlBdHRlbXB0IDwgcmV0cnlBdHRlbXB0cykgcmV0dXJuO1xuICAgICAgICB2YWx1ZS5zZXQoe1xuICAgICAgICAgIGVycm9yOiBjb250ZXh0LmVycm9yLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgaXNQZW5kaW5nOiBmYWxzZSxcbiAgICAgICAgICBpc1JlZmV0Y2hpbmc6IGZhbHNlLFxuICAgICAgICAgIHJlZmV0Y2g6IHZhbHVlLnZhbHVlLnJlZmV0Y2hcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IG9wdHM/Lm9uRXJyb3I/Lihjb250ZXh0KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBvblJlcXVlc3QoY29udGV4dCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB2YWx1ZS5nZXQoKTtcbiAgICAgICAgdmFsdWUuc2V0KHtcbiAgICAgICAgICBpc1BlbmRpbmc6IGN1cnJlbnRWYWx1ZS5kYXRhID09PSBudWxsLFxuICAgICAgICAgIGRhdGE6IGN1cnJlbnRWYWx1ZS5kYXRhLFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIGlzUmVmZXRjaGluZzogdHJ1ZSxcbiAgICAgICAgICByZWZldGNoOiB2YWx1ZS52YWx1ZS5yZWZldGNoXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBvcHRzPy5vblJlcXVlc3Q/Lihjb250ZXh0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgaW5pdGlhbGl6ZWRBdG9tID0gQXJyYXkuaXNBcnJheShpbml0aWFsaXplZEF0b20pID8gaW5pdGlhbGl6ZWRBdG9tIDogW2luaXRpYWxpemVkQXRvbV07XG4gIGxldCBpc01vdW50ZWQgPSBmYWxzZTtcbiAgZm9yIChjb25zdCBpbml0QXRvbSBvZiBpbml0aWFsaXplZEF0b20pIHtcbiAgICBpbml0QXRvbS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgaWYgKGlzTW91bnRlZCkge1xuICAgICAgICBmbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb25Nb3VudCh2YWx1ZSwgKCkgPT4ge1xuICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgaXNNb3VudGVkID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdmFsdWUub2ZmKCk7XG4gICAgICAgICAgICBpbml0QXRvbS5vZmYoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIHJlZGlyZWN0UGx1Z2luID0ge1xuICBpZDogXCJyZWRpcmVjdFwiLFxuICBuYW1lOiBcIlJlZGlyZWN0XCIsXG4gIGhvb2tzOiB7XG4gICAgb25TdWNjZXNzKGNvbnRleHQpIHtcbiAgICAgIGlmIChjb250ZXh0LmRhdGE/LnVybCAmJiBjb250ZXh0LmRhdGE/LnJlZGlyZWN0KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbikge1xuICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY29udGV4dC5kYXRhLnVybDtcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcbmZ1bmN0aW9uIGdldFNlc3Npb25BdG9tKCRmZXRjaCkge1xuICBjb25zdCAkc2lnbmFsID0gYXRvbShmYWxzZSk7XG4gIGNvbnN0IHNlc3Npb24gPSB1c2VBdXRoUXVlcnkoJHNpZ25hbCwgXCIvZ2V0LXNlc3Npb25cIiwgJGZldGNoLCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiXG4gIH0pO1xuICByZXR1cm4ge1xuICAgIHNlc3Npb24sXG4gICAgJHNlc3Npb25TaWduYWw6ICRzaWduYWxcbiAgfTtcbn1cblxuLy8gc3JjL2NsaWVudC9jb25maWcudHNcbnZhciBnZXRDbGllbnRDb25maWcgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBpc0NyZWRlbnRpYWxzU3VwcG9ydGVkID0gXCJjcmVkZW50aWFsc1wiIGluIFJlcXVlc3QucHJvdG90eXBlO1xuICBjb25zdCBiYXNlVVJMID0gZ2V0QmFzZVVSTChvcHRpb25zPy5iYXNlVVJMKTtcbiAgY29uc3QgcGx1Z2luc0ZldGNoUGx1Z2lucyA9IG9wdGlvbnM/LnBsdWdpbnM/LmZsYXRNYXAoKHBsdWdpbikgPT4gcGx1Z2luLmZldGNoUGx1Z2lucykuZmlsdGVyKChwbCkgPT4gcGwgIT09IHZvaWQgMCkgfHwgW107XG4gIGNvbnN0ICRmZXRjaCA9IGNyZWF0ZUZldGNoKHtcbiAgICBiYXNlVVJMLFxuICAgIC4uLmlzQ3JlZGVudGlhbHNTdXBwb3J0ZWQgPyB7IGNyZWRlbnRpYWxzOiBcImluY2x1ZGVcIiB9IDoge30sXG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGpzb25QYXJzZXIodGV4dCkge1xuICAgICAgcmV0dXJuIHBhcnNlSlNPTih0ZXh0LCB7XG4gICAgICAgIHN0cmljdDogZmFsc2VcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY3VzdG9tRmV0Y2hJbXBsOiBhc3luYyAoaW5wdXQsIGluaXQpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBmZXRjaChpbnB1dCwgaW5pdCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gUmVzcG9uc2UuZXJyb3IoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC4uLm9wdGlvbnM/LmZldGNoT3B0aW9ucyxcbiAgICBwbHVnaW5zOiBvcHRpb25zPy5kaXNhYmxlRGVmYXVsdEZldGNoUGx1Z2lucyA/IFsuLi5vcHRpb25zPy5mZXRjaE9wdGlvbnM/LnBsdWdpbnMgfHwgW10sIC4uLnBsdWdpbnNGZXRjaFBsdWdpbnNdIDogW1xuICAgICAgcmVkaXJlY3RQbHVnaW4sXG4gICAgICAuLi5vcHRpb25zPy5mZXRjaE9wdGlvbnM/LnBsdWdpbnMgfHwgW10sXG4gICAgICAuLi5wbHVnaW5zRmV0Y2hQbHVnaW5zXG4gICAgXVxuICB9KTtcbiAgY29uc3QgeyAkc2Vzc2lvblNpZ25hbCwgc2Vzc2lvbiB9ID0gZ2V0U2Vzc2lvbkF0b20oJGZldGNoKTtcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnM/LnBsdWdpbnMgfHwgW107XG4gIGxldCBwbHVnaW5zQWN0aW9ucyA9IHt9O1xuICBsZXQgcGx1Z2luc0F0b21zID0ge1xuICAgICRzZXNzaW9uU2lnbmFsLFxuICAgIHNlc3Npb25cbiAgfTtcbiAgbGV0IHBsdWdpblBhdGhNZXRob2RzID0ge1xuICAgIFwiL3NpZ24tb3V0XCI6IFwiUE9TVFwiLFxuICAgIFwiL3Jldm9rZS1zZXNzaW9uc1wiOiBcIlBPU1RcIixcbiAgICBcIi9yZXZva2Utb3RoZXItc2Vzc2lvbnNcIjogXCJQT1NUXCIsXG4gICAgXCIvZGVsZXRlLXVzZXJcIjogXCJQT1NUXCJcbiAgfTtcbiAgY29uc3QgYXRvbUxpc3RlbmVycyA9IFtcbiAgICB7XG4gICAgICBzaWduYWw6IFwiJHNlc3Npb25TaWduYWxcIixcbiAgICAgIG1hdGNoZXIocGF0aCkge1xuICAgICAgICByZXR1cm4gcGF0aCA9PT0gXCIvc2lnbi1vdXRcIiB8fCBwYXRoID09PSBcIi91cGRhdGUtdXNlclwiIHx8IHBhdGguc3RhcnRzV2l0aChcIi9zaWduLWluXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi9zaWduLXVwXCIpIHx8IHBhdGggPT09IFwiL2RlbGV0ZS11c2VyXCI7XG4gICAgICB9XG4gICAgfVxuICBdO1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBwbHVnaW5zKSB7XG4gICAgaWYgKHBsdWdpbi5nZXRBdG9tcykge1xuICAgICAgT2JqZWN0LmFzc2lnbihwbHVnaW5zQXRvbXMsIHBsdWdpbi5nZXRBdG9tcz8uKCRmZXRjaCkpO1xuICAgIH1cbiAgICBpZiAocGx1Z2luLnBhdGhNZXRob2RzKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHBsdWdpblBhdGhNZXRob2RzLCBwbHVnaW4ucGF0aE1ldGhvZHMpO1xuICAgIH1cbiAgICBpZiAocGx1Z2luLmF0b21MaXN0ZW5lcnMpIHtcbiAgICAgIGF0b21MaXN0ZW5lcnMucHVzaCguLi5wbHVnaW4uYXRvbUxpc3RlbmVycyk7XG4gICAgfVxuICB9XG4gIGNvbnN0ICRzdG9yZSA9IHtcbiAgICBub3RpZnk6IChzaWduYWwpID0+IHtcbiAgICAgIHBsdWdpbnNBdG9tc1tzaWduYWxdLnNldChcbiAgICAgICAgIXBsdWdpbnNBdG9tc1tzaWduYWxdLmdldCgpXG4gICAgICApO1xuICAgIH0sXG4gICAgbGlzdGVuOiAoc2lnbmFsLCBsaXN0ZW5lcikgPT4ge1xuICAgICAgcGx1Z2luc0F0b21zW3NpZ25hbF0uc3Vic2NyaWJlKGxpc3RlbmVyKTtcbiAgICB9LFxuICAgIGF0b21zOiBwbHVnaW5zQXRvbXNcbiAgfTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2YgcGx1Z2lucykge1xuICAgIGlmIChwbHVnaW4uZ2V0QWN0aW9ucykge1xuICAgICAgT2JqZWN0LmFzc2lnbihwbHVnaW5zQWN0aW9ucywgcGx1Z2luLmdldEFjdGlvbnM/LigkZmV0Y2gsICRzdG9yZSkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIHBsdWdpbnNBY3Rpb25zLFxuICAgIHBsdWdpbnNBdG9tcyxcbiAgICBwbHVnaW5QYXRoTWV0aG9kcyxcbiAgICBhdG9tTGlzdGVuZXJzLFxuICAgICRmZXRjaCxcbiAgICAkc3RvcmVcbiAgfTtcbn07XG5cbi8vIHNyYy9jbGllbnQvcHJveHkudHNcbmZ1bmN0aW9uIGdldE1ldGhvZChwYXRoLCBrbm93blBhdGhNZXRob2RzLCBhcmdzKSB7XG4gIGNvbnN0IG1ldGhvZCA9IGtub3duUGF0aE1ldGhvZHNbcGF0aF07XG4gIGNvbnN0IHsgZmV0Y2hPcHRpb25zLCBxdWVyeSwgLi4uYm9keSB9ID0gYXJncyB8fCB7fTtcbiAgaWYgKG1ldGhvZCkge1xuICAgIHJldHVybiBtZXRob2Q7XG4gIH1cbiAgaWYgKGZldGNoT3B0aW9ucz8ubWV0aG9kKSB7XG4gICAgcmV0dXJuIGZldGNoT3B0aW9ucy5tZXRob2Q7XG4gIH1cbiAgaWYgKGJvZHkgJiYgT2JqZWN0LmtleXMoYm9keSkubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBcIlBPU1RcIjtcbiAgfVxuICByZXR1cm4gXCJHRVRcIjtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUR5bmFtaWNQYXRoUHJveHkocm91dGVzLCBjbGllbnQsIGtub3duUGF0aE1ldGhvZHMsIGF0b21zLCBhdG9tTGlzdGVuZXJzKSB7XG4gIGZ1bmN0aW9uIGNyZWF0ZVByb3h5KHBhdGggPSBbXSkge1xuICAgIHJldHVybiBuZXcgUHJveHkoZnVuY3Rpb24oKSB7XG4gICAgfSwge1xuICAgICAgZ2V0KHRhcmdldCwgcHJvcCkge1xuICAgICAgICBjb25zdCBmdWxsUGF0aCA9IFsuLi5wYXRoLCBwcm9wXTtcbiAgICAgICAgbGV0IGN1cnJlbnQgPSByb3V0ZXM7XG4gICAgICAgIGZvciAoY29uc3Qgc2VnbWVudCBvZiBmdWxsUGF0aCkge1xuICAgICAgICAgIGlmIChjdXJyZW50ICYmIHR5cGVvZiBjdXJyZW50ID09PSBcIm9iamVjdFwiICYmIHNlZ21lbnQgaW4gY3VycmVudCkge1xuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbc2VnbWVudF07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnQgPSB2b2lkIDA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlUHJveHkoZnVsbFBhdGgpO1xuICAgICAgfSxcbiAgICAgIGFwcGx5OiBhc3luYyAoXywgX18sIGFyZ3MpID0+IHtcbiAgICAgICAgY29uc3Qgcm91dGVQYXRoID0gXCIvXCIgKyBwYXRoLm1hcChcbiAgICAgICAgICAoc2VnbWVudCkgPT4gc2VnbWVudC5yZXBsYWNlKC9bQS1aXS9nLCAobGV0dGVyKSA9PiBgLSR7bGV0dGVyLnRvTG93ZXJDYXNlKCl9YClcbiAgICAgICAgKS5qb2luKFwiL1wiKTtcbiAgICAgICAgY29uc3QgYXJnID0gYXJnc1swXSB8fCB7fTtcbiAgICAgICAgY29uc3QgZmV0Y2hPcHRpb25zID0gYXJnc1sxXSB8fCB7fTtcbiAgICAgICAgY29uc3QgeyBxdWVyeSwgZmV0Y2hPcHRpb25zOiBhcmdGZXRjaE9wdGlvbnMsIC4uLmJvZHkgfSA9IGFyZztcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAuLi5mZXRjaE9wdGlvbnMsXG4gICAgICAgICAgLi4uYXJnRmV0Y2hPcHRpb25zXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IGdldE1ldGhvZChyb3V0ZVBhdGgsIGtub3duUGF0aE1ldGhvZHMsIGFyZyk7XG4gICAgICAgIHJldHVybiBhd2FpdCBjbGllbnQocm91dGVQYXRoLCB7XG4gICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICBib2R5OiBtZXRob2QgPT09IFwiR0VUXCIgPyB2b2lkIDAgOiB7XG4gICAgICAgICAgICAuLi5ib2R5LFxuICAgICAgICAgICAgLi4ub3B0aW9ucz8uYm9keSB8fCB7fVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5IHx8IG9wdGlvbnM/LnF1ZXJ5LFxuICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgICBhc3luYyBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgICAgICAgYXdhaXQgb3B0aW9ucz8ub25TdWNjZXNzPy4oY29udGV4dCk7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gYXRvbUxpc3RlbmVycz8uZmluZCgocykgPT4gcy5tYXRjaGVyKHJvdXRlUGF0aCkpO1xuICAgICAgICAgICAgaWYgKCFtYXRjaGVzKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBzaWduYWwgPSBhdG9tc1ttYXRjaGVzLnNpZ25hbF07XG4gICAgICAgICAgICBpZiAoIXNpZ25hbCkgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgdmFsID0gc2lnbmFsLmdldCgpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHNpZ25hbC5zZXQoIXZhbCk7XG4gICAgICAgICAgICB9LCAxMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gY3JlYXRlUHJveHkoKTtcbn1cblxuZXhwb3J0IHsgY3JlYXRlRHluYW1pY1BhdGhQcm94eSwgZ2V0Q2xpZW50Q29uZmlnLCB1c2VBdXRoUXVlcnkgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PY47VMWF.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   env: () => (/* binding */ env),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   isTest: () => (/* binding */ isTest)\n/* harmony export */ });\n// src/utils/env.ts\nvar _envShim = /* @__PURE__ */ Object.create(null);\nvar _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nvar env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nvar nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nvar isProduction = nodeENV === \"production\";\nvar isDevelopment = nodeENV === \"dev\" || nodeENV === \"development\";\nvar isTest = nodeENV === \"test\" || toBoolean(env.TEST);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVRRUVNQUE5BLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxhQUFvQjtBQUNuRjtBQUNBO0FBQ0E7O0FBRW9EIiwic291cmNlcyI6WyIvVXNlcnMvZ29tb2xlbW9rZ2F0aXRzb2UvcHJvamVjdHMvZW1haWwtcHJldmlld2VyLWFwcGxpY2F0aW9uL25vZGVfbW9kdWxlcy8ucG5wbS9iZXR0ZXItYXV0aEAxLjEuMTkvbm9kZV9tb2R1bGVzL2JldHRlci1hdXRoL2Rpc3QvY2h1bmstVFFRU1BQTkEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3V0aWxzL2Vudi50c1xudmFyIF9lbnZTaGltID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5jcmVhdGUobnVsbCk7XG52YXIgX2dldEVudiA9ICh1c2VTaGltKSA9PiBnbG9iYWxUaGlzLnByb2Nlc3M/LmVudiB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuRGVubz8uZW52LnRvT2JqZWN0KCkgfHwgLy9AdHMtZXhwZWN0LWVycm9yXG5nbG9iYWxUaGlzLl9fZW52X18gfHwgKHVzZVNoaW0gPyBfZW52U2hpbSA6IGdsb2JhbFRoaXMpO1xudmFyIGVudiA9IG5ldyBQcm94eShfZW52U2hpbSwge1xuICBnZXQoXywgcHJvcCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KCk7XG4gICAgcmV0dXJuIGVudjJbcHJvcF0gPz8gX2VudlNoaW1bcHJvcF07XG4gIH0sXG4gIGhhcyhfLCBwcm9wKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYoKTtcbiAgICByZXR1cm4gcHJvcCBpbiBlbnYyIHx8IHByb3AgaW4gX2VudlNoaW07XG4gIH0sXG4gIHNldChfLCBwcm9wLCB2YWx1ZSkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIGVudjJbcHJvcF0gPSB2YWx1ZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgZGVsZXRlUHJvcGVydHkoXywgcHJvcCkge1xuICAgIGlmICghcHJvcCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBlbnYyID0gX2dldEVudih0cnVlKTtcbiAgICBkZWxldGUgZW52Mltwcm9wXTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgb3duS2V5cygpIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudih0cnVlKTtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoZW52Mik7XG4gIH1cbn0pO1xuZnVuY3Rpb24gdG9Cb29sZWFuKHZhbCkge1xuICByZXR1cm4gdmFsID8gdmFsICE9PSBcImZhbHNlXCIgOiBmYWxzZTtcbn1cbnZhciBub2RlRU5WID0gdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgXCJcIjtcbnZhciBpc1Byb2R1Y3Rpb24gPSBub2RlRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbnZhciBpc0RldmVsb3BtZW50ID0gbm9kZUVOViA9PT0gXCJkZXZcIiB8fCBub2RlRU5WID09PSBcImRldmVsb3BtZW50XCI7XG52YXIgaXNUZXN0ID0gbm9kZUVOViA9PT0gXCJ0ZXN0XCIgfHwgdG9Cb29sZWFuKGVudi5URVNUKTtcblxuZXhwb3J0IHsgZW52LCBpc0RldmVsb3BtZW50LCBpc1Byb2R1Y3Rpb24sIGlzVGVzdCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BetterAuthError: () => (/* binding */ BetterAuthError),\n/* harmony export */   MissingDependencyError: () => (/* binding */ MissingDependencyError)\n/* harmony export */ });\n// src/error/index.ts\nvar BetterAuthError = class extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n};\nvar MissingDependencyError = class extends BetterAuthError {\n  constructor(pkgName) {\n    super(\n      `The package \"${pkgName}\" is required. Make sure it is installed.`,\n      pkgName\n    );\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVVOV0NYS01QLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsUUFBUTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTs7QUFFbUQiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1VTldDWEtNUC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZXJyb3IvaW5kZXgudHNcbnZhciBCZXR0ZXJBdXRoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgY2F1c2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkJldHRlckF1dGhFcnJvclwiO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5jYXVzZSA9IGNhdXNlO1xuICAgIHRoaXMuc3RhY2sgPSBcIlwiO1xuICB9XG59O1xudmFyIE1pc3NpbmdEZXBlbmRlbmN5RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJldHRlckF1dGhFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHBrZ05hbWUpIHtcbiAgICBzdXBlcihcbiAgICAgIGBUaGUgcGFja2FnZSBcIiR7cGtnTmFtZX1cIiBpcyByZXF1aXJlZC4gTWFrZSBzdXJlIGl0IGlzIGluc3RhbGxlZC5gLFxuICAgICAgcGtnTmFtZVxuICAgICk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IEJldHRlckF1dGhFcnJvciwgTWlzc2luZ0RlcGVuZGVuY3lFcnJvciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getBaseURL: () => (/* binding */ getBaseURL),\n/* harmony export */   getHost: () => (/* binding */ getHost),\n/* harmony export */   getOrigin: () => (/* binding */ getOrigin),\n/* harmony export */   getProtocol: () => (/* binding */ getProtocol)\n/* harmony export */ });\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n\n\n\n// src/utils/url.ts\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.pathname !== \"/\";\n  } catch (error) {\n    throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_1__.BetterAuthError(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${url.replace(/\\/+$/, \"\")}${path}`;\n}\nfunction getBaseURL(url, path) {\n  if (url) {\n    return withPath(url, path);\n  }\n  const fromEnv = _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NEXT_PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_BETTER_AUTH_URL || _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.NUXT_PUBLIC_AUTH_URL || (_chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL !== \"/\" ? _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_0__.env.BASE_URL : void 0);\n  if (fromEnv) {\n    return withPath(fromEnv, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  if (url.includes(\"://\")) {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  }\n  return url;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NodW5rLVhGQ0lBTlpYLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwQztBQUNZOztBQUV0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGNBQWMsK0RBQWU7QUFDN0IsMkJBQTJCLElBQUk7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxLQUFLO0FBQ2hELFlBQVksd0JBQXdCLEVBQUUsS0FBSztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1EQUFHLG9CQUFvQixtREFBRyxnQ0FBZ0MsbURBQUcsMkJBQTJCLG1EQUFHLGdDQUFnQyxtREFBRywwQkFBMEIsbURBQUcsb0JBQW9CLG1EQUFHO0FBQ3BNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFdUQiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVuay1YRkNJQU5aWC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlbnYgfSBmcm9tICcuL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vY2h1bmstVU5XQ1hLTVAuanMnO1xuXG4vLyBzcmMvdXRpbHMvdXJsLnRzXG5mdW5jdGlvbiBjaGVja0hhc1BhdGgodXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwucGF0aG5hbWUgIT09IFwiL1wiO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICBgSW52YWxpZCBiYXNlIFVSTDogJHt1cmx9LiBQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIGJhc2UgVVJMLmBcbiAgICApO1xuICB9XG59XG5mdW5jdGlvbiB3aXRoUGF0aCh1cmwsIHBhdGggPSBcIi9hcGkvYXV0aFwiKSB7XG4gIGNvbnN0IGhhc1BhdGggPSBjaGVja0hhc1BhdGgodXJsKTtcbiAgaWYgKGhhc1BhdGgpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIHBhdGggPSBwYXRoLnN0YXJ0c1dpdGgoXCIvXCIpID8gcGF0aCA6IGAvJHtwYXRofWA7XG4gIHJldHVybiBgJHt1cmwucmVwbGFjZSgvXFwvKyQvLCBcIlwiKX0ke3BhdGh9YDtcbn1cbmZ1bmN0aW9uIGdldEJhc2VVUkwodXJsLCBwYXRoKSB7XG4gIGlmICh1cmwpIHtcbiAgICByZXR1cm4gd2l0aFBhdGgodXJsLCBwYXRoKTtcbiAgfVxuICBjb25zdCBmcm9tRW52ID0gZW52LkJFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTkVYVF9QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5QVUJMSUNfQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5OVVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0FVVEhfVVJMIHx8IChlbnYuQkFTRV9VUkwgIT09IFwiL1wiID8gZW52LkJBU0VfVVJMIDogdm9pZCAwKTtcbiAgaWYgKGZyb21FbnYpIHtcbiAgICByZXR1cm4gd2l0aFBhdGgoZnJvbUVudiwgcGF0aCk7XG4gIH1cbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIHdpdGhQYXRoKHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sIHBhdGgpO1xuICB9XG4gIHJldHVybiB2b2lkIDA7XG59XG5mdW5jdGlvbiBnZXRPcmlnaW4odXJsKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWRVcmwub3JpZ2luO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRQcm90b2NvbCh1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5wcm90b2NvbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0SG9zdCh1cmwpIHtcbiAgaWYgKHVybC5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3Q7XG4gIH1cbiAgcmV0dXJuIHVybDtcbn1cblxuZXhwb3J0IHsgZ2V0QmFzZVVSTCwgZ2V0SG9zdCwgZ2V0T3JpZ2luLCBnZXRQcm90b2NvbCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/client/plugins.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/client/plugins.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InferServerPlugin: () => (/* binding */ InferServerPlugin),\n/* harmony export */   adminClient: () => (/* binding */ adminClient),\n/* harmony export */   anonymousClient: () => (/* binding */ anonymousClient),\n/* harmony export */   customSessionClient: () => (/* binding */ customSessionClient),\n/* harmony export */   emailOTPClient: () => (/* binding */ emailOTPClient),\n/* harmony export */   genericOAuthClient: () => (/* binding */ genericOAuthClient),\n/* harmony export */   getPasskeyActions: () => (/* binding */ getPasskeyActions),\n/* harmony export */   inferAdditionalFields: () => (/* binding */ inferAdditionalFields),\n/* harmony export */   jwtClient: () => (/* binding */ jwtClient),\n/* harmony export */   magicLinkClient: () => (/* binding */ magicLinkClient),\n/* harmony export */   multiSessionClient: () => (/* binding */ multiSessionClient),\n/* harmony export */   oidcClient: () => (/* binding */ oidcClient),\n/* harmony export */   oneTapClient: () => (/* binding */ oneTapClient),\n/* harmony export */   organizationClient: () => (/* binding */ organizationClient),\n/* harmony export */   passkeyClient: () => (/* binding */ passkeyClient),\n/* harmony export */   phoneNumberClient: () => (/* binding */ phoneNumberClient),\n/* harmony export */   ssoClient: () => (/* binding */ ssoClient),\n/* harmony export */   twoFactorClient: () => (/* reexport safe */ _chunk_GYDUPG7X_js__WEBPACK_IMPORTED_MODULE_0__.twoFactorClient),\n/* harmony export */   usernameClient: () => (/* binding */ usernameClient)\n/* harmony export */ });\n/* harmony import */ var _chunk_GYDUPG7X_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../chunk-GYDUPG7X.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GYDUPG7X.js\");\n/* harmony import */ var _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../chunk-GBLEGHZW.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-GBLEGHZW.js\");\n/* harmony import */ var _chunk_47EOFRJT_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../chunk-47EOFRJT.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-47EOFRJT.js\");\n/* harmony import */ var _chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../chunk-PY47VMWF.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PY47VMWF.js\");\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../chunk-HVHN3Y2L.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../chunk-XFCIANZX.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_3XTQSPPA_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../chunk-3XTQSPPA.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-3XTQSPPA.js\");\n/* harmony import */ var _chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../chunk-DBPOZRMS.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-DBPOZRMS.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../chunk-TQQSPPNA.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../chunk-UNWCXKMP.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@0.11.4/node_modules/nanostores/atom/index.js\");\n/* harmony import */ var _simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @simplewebauthn/browser */ \"(ssr)/./node_modules/.pnpm/@simplewebauthn+browser@13.1.0/node_modules/@simplewebauthn/browser/esm/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar organizationClient = (options) => {\n  const $listOrg = (0,nanostores__WEBPACK_IMPORTED_MODULE_11__.atom)(false);\n  const $activeOrgSignal = (0,nanostores__WEBPACK_IMPORTED_MODULE_11__.atom)(false);\n  const $activeMemberSignal = (0,nanostores__WEBPACK_IMPORTED_MODULE_11__.atom)(false);\n  const roles = {\n    admin: _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_1__.adminAc,\n    member: _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_1__.memberAc,\n    owner: _chunk_GBLEGHZW_js__WEBPACK_IMPORTED_MODULE_1__.ownerAc,\n    ...options?.roles\n  };\n  return {\n    id: \"organization\",\n    $InferServerPlugin: {},\n    getActions: ($fetch) => ({\n      $Infer: {\n        ActiveOrganization: {},\n        Organization: {},\n        Invitation: {},\n        Member: {}\n      },\n      organization: {\n        checkRolePermission: (data) => {\n          if (Object.keys(data.permission).length > 1) {\n            throw new _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_9__.BetterAuthError(\n              \"you can only check one resource permission at a time.\"\n            );\n          }\n          const role = roles[data.role];\n          if (!role) {\n            return false;\n          }\n          const isAuthorized = role?.authorize(data.permission);\n          return isAuthorized.success;\n        }\n      }\n    }),\n    getAtoms: ($fetch) => {\n      const listOrganizations = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_3__.useAuthQuery)(\n        $listOrg,\n        \"/organization/list\",\n        $fetch,\n        {\n          method: \"GET\"\n        }\n      );\n      const activeOrganization = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_3__.useAuthQuery)(\n        [$activeOrgSignal],\n        \"/organization/get-full-organization\",\n        $fetch,\n        () => ({\n          method: \"GET\"\n        })\n      );\n      const activeMember = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_3__.useAuthQuery)(\n        [$activeMemberSignal],\n        \"/organization/get-active-member\",\n        $fetch,\n        {\n          method: \"GET\"\n        }\n      );\n      return {\n        $listOrg,\n        $activeOrgSignal,\n        $activeMemberSignal,\n        activeOrganization,\n        listOrganizations,\n        activeMember\n      };\n    },\n    pathMethods: {\n      \"/organization/get-full-organization\": \"GET\"\n    },\n    atomListeners: [\n      {\n        matcher(path) {\n          return path === \"/organization/create\" || path === \"/organization/delete\" || path === \"/organization/update\";\n        },\n        signal: \"$listOrg\"\n      },\n      {\n        matcher(path) {\n          return path.startsWith(\"/organization\");\n        },\n        signal: \"$activeOrgSignal\"\n      },\n      {\n        matcher(path) {\n          return path.includes(\"/organization/update-member-role\");\n        },\n        signal: \"$activeMemberSignal\"\n      }\n    ]\n  };\n};\n\n// src/plugins/username/client.ts\nvar usernameClient = () => {\n  return {\n    id: \"username\",\n    $InferServerPlugin: {}\n  };\n};\nvar getPasskeyActions = ($fetch, {\n  $listPasskeys\n}) => {\n  const signInPasskey = async (opts, options) => {\n    const response = await $fetch(\n      \"/passkey/generate-authenticate-options\",\n      {\n        method: \"POST\",\n        body: {\n          email: opts?.email\n        }\n      }\n    );\n    if (!response.data) {\n      return response;\n    }\n    try {\n      const res = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_10__.startAuthentication)({\n        optionsJSON: response.data,\n        useBrowserAutofill: opts?.autoFill\n      });\n      const verified = await $fetch(\"/passkey/verify-authentication\", {\n        body: {\n          response: res\n        },\n        ...opts?.fetchOptions,\n        ...options,\n        method: \"POST\"\n      });\n      if (!verified.data) {\n        return verified;\n      }\n    } catch (e) {\n      return {\n        data: null,\n        error: {\n          message: \"auth cancelled\",\n          status: 400,\n          statusText: \"BAD_REQUEST\"\n        }\n      };\n    }\n  };\n  const registerPasskey = async (opts, fetchOpts) => {\n    const options = await $fetch(\n      \"/passkey/generate-register-options\",\n      {\n        method: \"GET\"\n      }\n    );\n    if (!options.data) {\n      return options;\n    }\n    try {\n      const res = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_10__.startRegistration)({\n        optionsJSON: options.data,\n        useAutoRegister: opts?.useAutoRegister\n      });\n      const verified = await $fetch(\"/passkey/verify-registration\", {\n        ...opts?.fetchOptions,\n        ...fetchOpts,\n        body: {\n          response: res,\n          name: opts?.name\n        },\n        method: \"POST\"\n      });\n      if (!verified.data) {\n        return verified;\n      }\n      $listPasskeys.set(Math.random());\n    } catch (e) {\n      if (e instanceof _simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_10__.WebAuthnError) {\n        if (e.code === \"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED\") {\n          return {\n            data: null,\n            error: {\n              message: \"previously registered\",\n              status: 400,\n              statusText: \"BAD_REQUEST\"\n            }\n          };\n        }\n        if (e.code === \"ERROR_CEREMONY_ABORTED\") {\n          return {\n            data: null,\n            error: {\n              message: \"registration cancelled\",\n              status: 400,\n              statusText: \"BAD_REQUEST\"\n            }\n          };\n        }\n        return {\n          data: null,\n          error: {\n            message: e.message,\n            status: 400,\n            statusText: \"BAD_REQUEST\"\n          }\n        };\n      }\n      return {\n        data: null,\n        error: {\n          message: e instanceof Error ? e.message : \"unknown error\",\n          status: 500,\n          statusText: \"INTERNAL_SERVER_ERROR\"\n        }\n      };\n    }\n  };\n  return {\n    signIn: {\n      /**\n       * Sign in with a registered passkey\n       */\n      passkey: signInPasskey\n    },\n    passkey: {\n      /**\n       * Add a passkey to the user account\n       */\n      addPasskey: registerPasskey\n    },\n    /**\n     * Inferred Internal Types\n     */\n    $Infer: {}\n  };\n};\nvar passkeyClient = () => {\n  const $listPasskeys = (0,nanostores__WEBPACK_IMPORTED_MODULE_11__.atom)();\n  return {\n    id: \"passkey\",\n    $InferServerPlugin: {},\n    getActions: ($fetch) => getPasskeyActions($fetch, {\n      $listPasskeys\n    }),\n    getAtoms($fetch) {\n      const listPasskeys = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_3__.useAuthQuery)(\n        $listPasskeys,\n        \"/passkey/list-user-passkeys\",\n        $fetch,\n        {\n          method: \"GET\"\n        }\n      );\n      return {\n        listPasskeys,\n        $listPasskeys\n      };\n    },\n    pathMethods: {\n      \"/passkey/register\": \"POST\",\n      \"/passkey/authenticate\": \"POST\"\n    },\n    atomListeners: [\n      {\n        matcher(path) {\n          return path === \"/passkey/verify-registration\" || path === \"/passkey/delete-passkey\" || path === \"/passkey/update-passkey\";\n        },\n        signal: \"_listPasskeys\"\n      }\n    ]\n  };\n};\n\n// src/plugins/magic-link/client.ts\nvar magicLinkClient = () => {\n  return {\n    id: \"magic-link\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/phone-number/client.ts\nvar phoneNumberClient = () => {\n  return {\n    id: \"phoneNumber\",\n    $InferServerPlugin: {},\n    atomListeners: [\n      {\n        matcher(path) {\n          return path === \"/phone-number/update\" || path === \"/phone-number/verify\";\n        },\n        signal: \"$sessionSignal\"\n      }\n    ]\n  };\n};\n\n// src/plugins/anonymous/client.ts\nvar anonymousClient = () => {\n  return {\n    id: \"anonymous\",\n    $InferServerPlugin: {},\n    pathMethods: {\n      \"/sign-in/anonymous\": \"POST\"\n    }\n  };\n};\n\n// src/plugins/additional-fields/client.ts\nvar inferAdditionalFields = (schema) => {\n  return {\n    id: \"additional-fields-client\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/admin/client.ts\nvar adminClient = () => {\n  return {\n    id: \"better-auth-client\",\n    $InferServerPlugin: {},\n    pathMethods: {\n      \"/admin/list-users\": \"GET\",\n      \"/admin/stop-impersonating\": \"POST\"\n    }\n  };\n};\n\n// src/plugins/generic-oauth/client.ts\nvar genericOAuthClient = () => {\n  return {\n    id: \"generic-oauth-client\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/jwt/client.ts\nvar jwtClient = () => {\n  return {\n    id: \"better-auth-client\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/multi-session/client.ts\nvar multiSessionClient = () => {\n  return {\n    id: \"multi-session\",\n    $InferServerPlugin: {},\n    atomListeners: [\n      {\n        matcher(path) {\n          return path === \"/multi-session/set-active\";\n        },\n        signal: \"$sessionSignal\"\n      }\n    ]\n  };\n};\n\n// src/plugins/email-otp/client.ts\nvar emailOTPClient = () => {\n  return {\n    id: \"email-otp\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/one-tap/client.ts\nvar isRequestInProgress = false;\nvar oneTapClient = (options) => {\n  return {\n    id: \"one-tap\",\n    getActions: ($fetch, _) => ({\n      oneTap: async (opts, fetchOptions) => {\n        if (isRequestInProgress) {\n          console.warn(\n            \"A Google One Tap request is already in progress. Please wait.\"\n          );\n          return;\n        }\n        isRequestInProgress = true;\n        try {\n          if (typeof window === \"undefined\" || !window.document) {\n            console.warn(\n              \"Google One Tap is only available in browser environments\"\n            );\n            return;\n          }\n          const { autoSelect, cancelOnTapOutside, context } = opts ?? {};\n          const contextValue = context ?? options.context ?? \"signin\";\n          await loadGoogleScript();\n          await new Promise((resolve, reject) => {\n            let isResolved = false;\n            const baseDelay = options.promptOptions?.baseDelay ?? 1e3;\n            const maxAttempts = options.promptOptions?.maxAttempts ?? 5;\n            window.google?.accounts.id.initialize({\n              client_id: options.clientId,\n              callback: async (response) => {\n                isResolved = true;\n                try {\n                  await $fetch(\"/one-tap/callback\", {\n                    method: \"POST\",\n                    body: { idToken: response.credential },\n                    ...opts?.fetchOptions,\n                    ...fetchOptions\n                  });\n                  if (!opts?.fetchOptions && !fetchOptions || opts?.callbackURL) {\n                    window.location.href = opts?.callbackURL ?? \"/\";\n                  }\n                  resolve();\n                } catch (error) {\n                  console.error(\"Error during One Tap callback:\", error);\n                  reject(error);\n                }\n              },\n              auto_select: autoSelect,\n              cancel_on_tap_outside: cancelOnTapOutside,\n              context: contextValue,\n              nonce: (0,_chunk_DBPOZRMS_js__WEBPACK_IMPORTED_MODULE_7__.generateRandomString)(16),\n              ...options.additionalOptions\n            });\n            const handlePrompt = (attempt) => {\n              if (isResolved) return;\n              window.google?.accounts.id.prompt((notification) => {\n                if (isResolved) return;\n                if (notification.isDismissedMoment && notification.isDismissedMoment()) {\n                  if (attempt < maxAttempts) {\n                    const delay = Math.pow(2, attempt) * baseDelay;\n                    setTimeout(() => handlePrompt(attempt + 1), delay);\n                  } else {\n                    opts?.onPromptNotification?.(notification);\n                  }\n                } else if (notification.isSkippedMoment && notification.isSkippedMoment()) {\n                  if (attempt < maxAttempts) {\n                    const delay = Math.pow(2, attempt) * baseDelay;\n                    setTimeout(() => handlePrompt(attempt + 1), delay);\n                  } else {\n                    opts?.onPromptNotification?.(notification);\n                  }\n                }\n              });\n            };\n            handlePrompt(0);\n          });\n        } catch (error) {\n          console.error(\"Error during Google One Tap flow:\", error);\n          throw error;\n        } finally {\n          isRequestInProgress = false;\n        }\n      }\n    }),\n    getAtoms($fetch) {\n      return {};\n    }\n  };\n};\nvar loadGoogleScript = () => {\n  return new Promise((resolve) => {\n    if (window.googleScriptInitialized) {\n      resolve();\n      return;\n    }\n    const script = document.createElement(\"script\");\n    script.src = \"https://accounts.google.com/gsi/client\";\n    script.async = true;\n    script.defer = true;\n    script.onload = () => {\n      window.googleScriptInitialized = true;\n      resolve();\n    };\n    document.head.appendChild(script);\n  });\n};\n\n// src/plugins/custom-session/client.ts\nvar customSessionClient = () => {\n  return InferServerPlugin();\n};\n\n// src/client/plugins/infer-plugin.ts\nvar InferServerPlugin = () => {\n  return {\n    id: \"infer-server-plugin\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/sso/client.ts\nvar ssoClient = () => {\n  return {\n    id: \"sso-client\",\n    $InferServerPlugin: {}\n  };\n};\n\n// src/plugins/oidc-provider/client.ts\nvar oidcClient = () => {\n  return {\n    id: \"oidc-client\",\n    $InferServerPlugin: {}\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L2NsaWVudC9wbHVnaW5zLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDVztBQUNwQztBQUNzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDOEI7QUFDOUI7QUFDeUI7QUFDckI7QUFDOEQ7O0FBRWhHO0FBQ0EsbUJBQW1CLGlEQUFJO0FBQ3ZCLDJCQUEyQixpREFBSTtBQUMvQiw4QkFBOEIsaURBQUk7QUFDbEM7QUFDQSxXQUFXLHVEQUFPO0FBQ2xCLFlBQVksd0RBQVE7QUFDcEIsV0FBVyx1REFBTztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCLHdCQUF3QjtBQUN4QixzQkFBc0I7QUFDdEI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtEQUFlO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQ0FBZ0MsZ0VBQVk7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsZ0VBQVk7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLDJCQUEyQixnRUFBWTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkVBQW1CO0FBQzNDO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDJFQUFpQjtBQUN6QztBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTix1QkFBdUIsbUVBQWE7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaURBQUk7QUFDNUI7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMkJBQTJCLGdFQUFZO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwwQ0FBMEM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOEJBQThCO0FBQzFEO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix3RUFBb0I7QUFDekM7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLFdBQVc7QUFDWCxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFeVQiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nb21vbGVtb2tnYXRpdHNvZS9wcm9qZWN0cy9lbWFpbC1wcmV2aWV3ZXItYXBwbGljYXRpb24vbm9kZV9tb2R1bGVzLy5wbnBtL2JldHRlci1hdXRoQDEuMS4xOS9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jbGllbnQvcGx1Z2lucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyB0d29GYWN0b3JDbGllbnQgfSBmcm9tICcuLi9jaHVuay1HWURVUEc3WC5qcyc7XG5pbXBvcnQgeyBhZG1pbkFjLCBtZW1iZXJBYywgb3duZXJBYyB9IGZyb20gJy4uL2NodW5rLUdCTEVHSFpXLmpzJztcbmltcG9ydCAnLi4vY2h1bmstNDdFT0ZSSlQuanMnO1xuaW1wb3J0IHsgdXNlQXV0aFF1ZXJ5IH0gZnJvbSAnLi4vY2h1bmstUFk0N1ZNV0YuanMnO1xuaW1wb3J0ICcuLi9jaHVuay1IVkhOM1kyTC5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLVhGQ0lBTlpYLmpzJztcbmltcG9ydCAnLi4vY2h1bmstM1hUUVNQUEEuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuLi9jaHVuay1EQlBPWlJNUy5qcyc7XG5pbXBvcnQgJy4uL2NodW5rLVRRUVNQUE5BLmpzJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4uL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IGF0b20gfSBmcm9tICduYW5vc3RvcmVzJztcbmltcG9ydCB7IHN0YXJ0QXV0aGVudGljYXRpb24sIHN0YXJ0UmVnaXN0cmF0aW9uLCBXZWJBdXRobkVycm9yIH0gZnJvbSAnQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXInO1xuXG52YXIgb3JnYW5pemF0aW9uQ2xpZW50ID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgJGxpc3RPcmcgPSBhdG9tKGZhbHNlKTtcbiAgY29uc3QgJGFjdGl2ZU9yZ1NpZ25hbCA9IGF0b20oZmFsc2UpO1xuICBjb25zdCAkYWN0aXZlTWVtYmVyU2lnbmFsID0gYXRvbShmYWxzZSk7XG4gIGNvbnN0IHJvbGVzID0ge1xuICAgIGFkbWluOiBhZG1pbkFjLFxuICAgIG1lbWJlcjogbWVtYmVyQWMsXG4gICAgb3duZXI6IG93bmVyQWMsXG4gICAgLi4ub3B0aW9ucz8ucm9sZXNcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJvcmdhbml6YXRpb25cIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9LFxuICAgIGdldEFjdGlvbnM6ICgkZmV0Y2gpID0+ICh7XG4gICAgICAkSW5mZXI6IHtcbiAgICAgICAgQWN0aXZlT3JnYW5pemF0aW9uOiB7fSxcbiAgICAgICAgT3JnYW5pemF0aW9uOiB7fSxcbiAgICAgICAgSW52aXRhdGlvbjoge30sXG4gICAgICAgIE1lbWJlcjoge31cbiAgICAgIH0sXG4gICAgICBvcmdhbml6YXRpb246IHtcbiAgICAgICAgY2hlY2tSb2xlUGVybWlzc2lvbjogKGRhdGEpID0+IHtcbiAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoZGF0YS5wZXJtaXNzaW9uKS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgICBcInlvdSBjYW4gb25seSBjaGVjayBvbmUgcmVzb3VyY2UgcGVybWlzc2lvbiBhdCBhIHRpbWUuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJvbGUgPSByb2xlc1tkYXRhLnJvbGVdO1xuICAgICAgICAgIGlmICghcm9sZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBpc0F1dGhvcml6ZWQgPSByb2xlPy5hdXRob3JpemUoZGF0YS5wZXJtaXNzaW9uKTtcbiAgICAgICAgICByZXR1cm4gaXNBdXRob3JpemVkLnN1Y2Nlc3M7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSxcbiAgICBnZXRBdG9tczogKCRmZXRjaCkgPT4ge1xuICAgICAgY29uc3QgbGlzdE9yZ2FuaXphdGlvbnMgPSB1c2VBdXRoUXVlcnkoXG4gICAgICAgICRsaXN0T3JnLFxuICAgICAgICBcIi9vcmdhbml6YXRpb24vbGlzdFwiLFxuICAgICAgICAkZmV0Y2gsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGFjdGl2ZU9yZ2FuaXphdGlvbiA9IHVzZUF1dGhRdWVyeShcbiAgICAgICAgWyRhY3RpdmVPcmdTaWduYWxdLFxuICAgICAgICBcIi9vcmdhbml6YXRpb24vZ2V0LWZ1bGwtb3JnYW5pemF0aW9uXCIsXG4gICAgICAgICRmZXRjaCxcbiAgICAgICAgKCkgPT4gKHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBjb25zdCBhY3RpdmVNZW1iZXIgPSB1c2VBdXRoUXVlcnkoXG4gICAgICAgIFskYWN0aXZlTWVtYmVyU2lnbmFsXSxcbiAgICAgICAgXCIvb3JnYW5pemF0aW9uL2dldC1hY3RpdmUtbWVtYmVyXCIsXG4gICAgICAgICRmZXRjaCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIlxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgJGxpc3RPcmcsXG4gICAgICAgICRhY3RpdmVPcmdTaWduYWwsXG4gICAgICAgICRhY3RpdmVNZW1iZXJTaWduYWwsXG4gICAgICAgIGFjdGl2ZU9yZ2FuaXphdGlvbixcbiAgICAgICAgbGlzdE9yZ2FuaXphdGlvbnMsXG4gICAgICAgIGFjdGl2ZU1lbWJlclxuICAgICAgfTtcbiAgICB9LFxuICAgIHBhdGhNZXRob2RzOiB7XG4gICAgICBcIi9vcmdhbml6YXRpb24vZ2V0LWZ1bGwtb3JnYW5pemF0aW9uXCI6IFwiR0VUXCJcbiAgICB9LFxuICAgIGF0b21MaXN0ZW5lcnM6IFtcbiAgICAgIHtcbiAgICAgICAgbWF0Y2hlcihwYXRoKSB7XG4gICAgICAgICAgcmV0dXJuIHBhdGggPT09IFwiL29yZ2FuaXphdGlvbi9jcmVhdGVcIiB8fCBwYXRoID09PSBcIi9vcmdhbml6YXRpb24vZGVsZXRlXCIgfHwgcGF0aCA9PT0gXCIvb3JnYW5pemF0aW9uL3VwZGF0ZVwiO1xuICAgICAgICB9LFxuICAgICAgICBzaWduYWw6IFwiJGxpc3RPcmdcIlxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbWF0Y2hlcihwYXRoKSB7XG4gICAgICAgICAgcmV0dXJuIHBhdGguc3RhcnRzV2l0aChcIi9vcmdhbml6YXRpb25cIik7XG4gICAgICAgIH0sXG4gICAgICAgIHNpZ25hbDogXCIkYWN0aXZlT3JnU2lnbmFsXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG1hdGNoZXIocGF0aCkge1xuICAgICAgICAgIHJldHVybiBwYXRoLmluY2x1ZGVzKFwiL29yZ2FuaXphdGlvbi91cGRhdGUtbWVtYmVyLXJvbGVcIik7XG4gICAgICAgIH0sXG4gICAgICAgIHNpZ25hbDogXCIkYWN0aXZlTWVtYmVyU2lnbmFsXCJcbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG4vLyBzcmMvcGx1Z2lucy91c2VybmFtZS9jbGllbnQudHNcbnZhciB1c2VybmFtZUNsaWVudCA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ1c2VybmFtZVwiLFxuICAgICRJbmZlclNlcnZlclBsdWdpbjoge31cbiAgfTtcbn07XG52YXIgZ2V0UGFzc2tleUFjdGlvbnMgPSAoJGZldGNoLCB7XG4gICRsaXN0UGFzc2tleXNcbn0pID0+IHtcbiAgY29uc3Qgc2lnbkluUGFzc2tleSA9IGFzeW5jIChvcHRzLCBvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCAkZmV0Y2goXG4gICAgICBcIi9wYXNza2V5L2dlbmVyYXRlLWF1dGhlbnRpY2F0ZS1vcHRpb25zXCIsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBlbWFpbDogb3B0cz8uZW1haWxcbiAgICAgICAgfVxuICAgICAgfVxuICAgICk7XG4gICAgaWYgKCFyZXNwb25zZS5kYXRhKSB7XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBzdGFydEF1dGhlbnRpY2F0aW9uKHtcbiAgICAgICAgb3B0aW9uc0pTT046IHJlc3BvbnNlLmRhdGEsXG4gICAgICAgIHVzZUJyb3dzZXJBdXRvZmlsbDogb3B0cz8uYXV0b0ZpbGxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdmVyaWZpZWQgPSBhd2FpdCAkZmV0Y2goXCIvcGFzc2tleS92ZXJpZnktYXV0aGVudGljYXRpb25cIiwge1xuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgcmVzcG9uc2U6IHJlc1xuICAgICAgICB9LFxuICAgICAgICAuLi5vcHRzPy5mZXRjaE9wdGlvbnMsXG4gICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCJcbiAgICAgIH0pO1xuICAgICAgaWYgKCF2ZXJpZmllZC5kYXRhKSB7XG4gICAgICAgIHJldHVybiB2ZXJpZmllZDtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiYXV0aCBjYW5jZWxsZWRcIixcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgICBzdGF0dXNUZXh0OiBcIkJBRF9SRVFVRVNUXCJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IHJlZ2lzdGVyUGFzc2tleSA9IGFzeW5jIChvcHRzLCBmZXRjaE9wdHMpID0+IHtcbiAgICBjb25zdCBvcHRpb25zID0gYXdhaXQgJGZldGNoKFxuICAgICAgXCIvcGFzc2tleS9nZW5lcmF0ZS1yZWdpc3Rlci1vcHRpb25zXCIsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJHRVRcIlxuICAgICAgfVxuICAgICk7XG4gICAgaWYgKCFvcHRpb25zLmRhdGEpIHtcbiAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgc3RhcnRSZWdpc3RyYXRpb24oe1xuICAgICAgICBvcHRpb25zSlNPTjogb3B0aW9ucy5kYXRhLFxuICAgICAgICB1c2VBdXRvUmVnaXN0ZXI6IG9wdHM/LnVzZUF1dG9SZWdpc3RlclxuICAgICAgfSk7XG4gICAgICBjb25zdCB2ZXJpZmllZCA9IGF3YWl0ICRmZXRjaChcIi9wYXNza2V5L3ZlcmlmeS1yZWdpc3RyYXRpb25cIiwge1xuICAgICAgICAuLi5vcHRzPy5mZXRjaE9wdGlvbnMsXG4gICAgICAgIC4uLmZldGNoT3B0cyxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIHJlc3BvbnNlOiByZXMsXG4gICAgICAgICAgbmFtZTogb3B0cz8ubmFtZVxuICAgICAgICB9LFxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiXG4gICAgICB9KTtcbiAgICAgIGlmICghdmVyaWZpZWQuZGF0YSkge1xuICAgICAgICByZXR1cm4gdmVyaWZpZWQ7XG4gICAgICB9XG4gICAgICAkbGlzdFBhc3NrZXlzLnNldChNYXRoLnJhbmRvbSgpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIFdlYkF1dGhuRXJyb3IpIHtcbiAgICAgICAgaWYgKGUuY29kZSA9PT0gXCJFUlJPUl9BVVRIRU5USUNBVE9SX1BSRVZJT1VTTFlfUkVHSVNURVJFRFwiKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICBtZXNzYWdlOiBcInByZXZpb3VzbHkgcmVnaXN0ZXJlZFwiLFxuICAgICAgICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgICAgICAgc3RhdHVzVGV4dDogXCJCQURfUkVRVUVTVFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZS5jb2RlID09PSBcIkVSUk9SX0NFUkVNT05ZX0FCT1JURURcIikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJyZWdpc3RyYXRpb24gY2FuY2VsbGVkXCIsXG4gICAgICAgICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICAgICAgICBzdGF0dXNUZXh0OiBcIkJBRF9SRVFVRVNUXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgbWVzc2FnZTogZS5tZXNzYWdlLFxuICAgICAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgICAgICBzdGF0dXNUZXh0OiBcIkJBRF9SRVFVRVNUXCJcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IGUgaW5zdGFuY2VvZiBFcnJvciA/IGUubWVzc2FnZSA6IFwidW5rbm93biBlcnJvclwiLFxuICAgICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICAgIHN0YXR1c1RleHQ6IFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgc2lnbkluOiB7XG4gICAgICAvKipcbiAgICAgICAqIFNpZ24gaW4gd2l0aCBhIHJlZ2lzdGVyZWQgcGFzc2tleVxuICAgICAgICovXG4gICAgICBwYXNza2V5OiBzaWduSW5QYXNza2V5XG4gICAgfSxcbiAgICBwYXNza2V5OiB7XG4gICAgICAvKipcbiAgICAgICAqIEFkZCBhIHBhc3NrZXkgdG8gdGhlIHVzZXIgYWNjb3VudFxuICAgICAgICovXG4gICAgICBhZGRQYXNza2V5OiByZWdpc3RlclBhc3NrZXlcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIEluZmVycmVkIEludGVybmFsIFR5cGVzXG4gICAgICovXG4gICAgJEluZmVyOiB7fVxuICB9O1xufTtcbnZhciBwYXNza2V5Q2xpZW50ID0gKCkgPT4ge1xuICBjb25zdCAkbGlzdFBhc3NrZXlzID0gYXRvbSgpO1xuICByZXR1cm4ge1xuICAgIGlkOiBcInBhc3NrZXlcIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9LFxuICAgIGdldEFjdGlvbnM6ICgkZmV0Y2gpID0+IGdldFBhc3NrZXlBY3Rpb25zKCRmZXRjaCwge1xuICAgICAgJGxpc3RQYXNza2V5c1xuICAgIH0pLFxuICAgIGdldEF0b21zKCRmZXRjaCkge1xuICAgICAgY29uc3QgbGlzdFBhc3NrZXlzID0gdXNlQXV0aFF1ZXJ5KFxuICAgICAgICAkbGlzdFBhc3NrZXlzLFxuICAgICAgICBcIi9wYXNza2V5L2xpc3QtdXNlci1wYXNza2V5c1wiLFxuICAgICAgICAkZmV0Y2gsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxpc3RQYXNza2V5cyxcbiAgICAgICAgJGxpc3RQYXNza2V5c1xuICAgICAgfTtcbiAgICB9LFxuICAgIHBhdGhNZXRob2RzOiB7XG4gICAgICBcIi9wYXNza2V5L3JlZ2lzdGVyXCI6IFwiUE9TVFwiLFxuICAgICAgXCIvcGFzc2tleS9hdXRoZW50aWNhdGVcIjogXCJQT1NUXCJcbiAgICB9LFxuICAgIGF0b21MaXN0ZW5lcnM6IFtcbiAgICAgIHtcbiAgICAgICAgbWF0Y2hlcihwYXRoKSB7XG4gICAgICAgICAgcmV0dXJuIHBhdGggPT09IFwiL3Bhc3NrZXkvdmVyaWZ5LXJlZ2lzdHJhdGlvblwiIHx8IHBhdGggPT09IFwiL3Bhc3NrZXkvZGVsZXRlLXBhc3NrZXlcIiB8fCBwYXRoID09PSBcIi9wYXNza2V5L3VwZGF0ZS1wYXNza2V5XCI7XG4gICAgICAgIH0sXG4gICAgICAgIHNpZ25hbDogXCJfbGlzdFBhc3NrZXlzXCJcbiAgICAgIH1cbiAgICBdXG4gIH07XG59O1xuXG4vLyBzcmMvcGx1Z2lucy9tYWdpYy1saW5rL2NsaWVudC50c1xudmFyIG1hZ2ljTGlua0NsaWVudCA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJtYWdpYy1saW5rXCIsXG4gICAgJEluZmVyU2VydmVyUGx1Z2luOiB7fVxuICB9O1xufTtcblxuLy8gc3JjL3BsdWdpbnMvcGhvbmUtbnVtYmVyL2NsaWVudC50c1xudmFyIHBob25lTnVtYmVyQ2xpZW50ID0gKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInBob25lTnVtYmVyXCIsXG4gICAgJEluZmVyU2VydmVyUGx1Z2luOiB7fSxcbiAgICBhdG9tTGlzdGVuZXJzOiBbXG4gICAgICB7XG4gICAgICAgIG1hdGNoZXIocGF0aCkge1xuICAgICAgICAgIHJldHVybiBwYXRoID09PSBcIi9waG9uZS1udW1iZXIvdXBkYXRlXCIgfHwgcGF0aCA9PT0gXCIvcGhvbmUtbnVtYmVyL3ZlcmlmeVwiO1xuICAgICAgICB9LFxuICAgICAgICBzaWduYWw6IFwiJHNlc3Npb25TaWduYWxcIlxuICAgICAgfVxuICAgIF1cbiAgfTtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL2Fub255bW91cy9jbGllbnQudHNcbnZhciBhbm9ueW1vdXNDbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYW5vbnltb3VzXCIsXG4gICAgJEluZmVyU2VydmVyUGx1Z2luOiB7fSxcbiAgICBwYXRoTWV0aG9kczoge1xuICAgICAgXCIvc2lnbi1pbi9hbm9ueW1vdXNcIjogXCJQT1NUXCJcbiAgICB9XG4gIH07XG59O1xuXG4vLyBzcmMvcGx1Z2lucy9hZGRpdGlvbmFsLWZpZWxkcy9jbGllbnQudHNcbnZhciBpbmZlckFkZGl0aW9uYWxGaWVsZHMgPSAoc2NoZW1hKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYWRkaXRpb25hbC1maWVsZHMtY2xpZW50XCIsXG4gICAgJEluZmVyU2VydmVyUGx1Z2luOiB7fVxuICB9O1xufTtcblxuLy8gc3JjL3BsdWdpbnMvYWRtaW4vY2xpZW50LnRzXG52YXIgYWRtaW5DbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYmV0dGVyLWF1dGgtY2xpZW50XCIsXG4gICAgJEluZmVyU2VydmVyUGx1Z2luOiB7fSxcbiAgICBwYXRoTWV0aG9kczoge1xuICAgICAgXCIvYWRtaW4vbGlzdC11c2Vyc1wiOiBcIkdFVFwiLFxuICAgICAgXCIvYWRtaW4vc3RvcC1pbXBlcnNvbmF0aW5nXCI6IFwiUE9TVFwiXG4gICAgfVxuICB9O1xufTtcblxuLy8gc3JjL3BsdWdpbnMvZ2VuZXJpYy1vYXV0aC9jbGllbnQudHNcbnZhciBnZW5lcmljT0F1dGhDbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZ2VuZXJpYy1vYXV0aC1jbGllbnRcIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9XG4gIH07XG59O1xuXG4vLyBzcmMvcGx1Z2lucy9qd3QvY2xpZW50LnRzXG52YXIgand0Q2xpZW50ID0gKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImJldHRlci1hdXRoLWNsaWVudFwiLFxuICAgICRJbmZlclNlcnZlclBsdWdpbjoge31cbiAgfTtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL211bHRpLXNlc3Npb24vY2xpZW50LnRzXG52YXIgbXVsdGlTZXNzaW9uQ2xpZW50ID0gKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm11bHRpLXNlc3Npb25cIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9LFxuICAgIGF0b21MaXN0ZW5lcnM6IFtcbiAgICAgIHtcbiAgICAgICAgbWF0Y2hlcihwYXRoKSB7XG4gICAgICAgICAgcmV0dXJuIHBhdGggPT09IFwiL211bHRpLXNlc3Npb24vc2V0LWFjdGl2ZVwiO1xuICAgICAgICB9LFxuICAgICAgICBzaWduYWw6IFwiJHNlc3Npb25TaWduYWxcIlxuICAgICAgfVxuICAgIF1cbiAgfTtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL2VtYWlsLW90cC9jbGllbnQudHNcbnZhciBlbWFpbE9UUENsaWVudCA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJlbWFpbC1vdHBcIixcbiAgICAkSW5mZXJTZXJ2ZXJQbHVnaW46IHt9XG4gIH07XG59O1xuXG4vLyBzcmMvcGx1Z2lucy9vbmUtdGFwL2NsaWVudC50c1xudmFyIGlzUmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTtcbnZhciBvbmVUYXBDbGllbnQgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm9uZS10YXBcIixcbiAgICBnZXRBY3Rpb25zOiAoJGZldGNoLCBfKSA9PiAoe1xuICAgICAgb25lVGFwOiBhc3luYyAob3B0cywgZmV0Y2hPcHRpb25zKSA9PiB7XG4gICAgICAgIGlmIChpc1JlcXVlc3RJblByb2dyZXNzKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgXCJBIEdvb2dsZSBPbmUgVGFwIHJlcXVlc3QgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4gUGxlYXNlIHdhaXQuXCJcbiAgICAgICAgICApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpc1JlcXVlc3RJblByb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhd2luZG93LmRvY3VtZW50KSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgIFwiR29vZ2xlIE9uZSBUYXAgaXMgb25seSBhdmFpbGFibGUgaW4gYnJvd3NlciBlbnZpcm9ubWVudHNcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgeyBhdXRvU2VsZWN0LCBjYW5jZWxPblRhcE91dHNpZGUsIGNvbnRleHQgfSA9IG9wdHMgPz8ge307XG4gICAgICAgICAgY29uc3QgY29udGV4dFZhbHVlID0gY29udGV4dCA/PyBvcHRpb25zLmNvbnRleHQgPz8gXCJzaWduaW5cIjtcbiAgICAgICAgICBhd2FpdCBsb2FkR29vZ2xlU2NyaXB0KCk7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbGV0IGlzUmVzb2x2ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2VEZWxheSA9IG9wdGlvbnMucHJvbXB0T3B0aW9ucz8uYmFzZURlbGF5ID8/IDFlMztcbiAgICAgICAgICAgIGNvbnN0IG1heEF0dGVtcHRzID0gb3B0aW9ucy5wcm9tcHRPcHRpb25zPy5tYXhBdHRlbXB0cyA/PyA1O1xuICAgICAgICAgICAgd2luZG93Lmdvb2dsZT8uYWNjb3VudHMuaWQuaW5pdGlhbGl6ZSh7XG4gICAgICAgICAgICAgIGNsaWVudF9pZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jIChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlzUmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBhd2FpdCAkZmV0Y2goXCIvb25lLXRhcC9jYWxsYmFja1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IHsgaWRUb2tlbjogcmVzcG9uc2UuY3JlZGVudGlhbCB9LFxuICAgICAgICAgICAgICAgICAgICAuLi5vcHRzPy5mZXRjaE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIC4uLmZldGNoT3B0aW9uc1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBpZiAoIW9wdHM/LmZldGNoT3B0aW9ucyAmJiAhZmV0Y2hPcHRpb25zIHx8IG9wdHM/LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gb3B0cz8uY2FsbGJhY2tVUkwgPz8gXCIvXCI7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkdXJpbmcgT25lIFRhcCBjYWxsYmFjazpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGF1dG9fc2VsZWN0OiBhdXRvU2VsZWN0LFxuICAgICAgICAgICAgICBjYW5jZWxfb25fdGFwX291dHNpZGU6IGNhbmNlbE9uVGFwT3V0c2lkZSxcbiAgICAgICAgICAgICAgY29udGV4dDogY29udGV4dFZhbHVlLFxuICAgICAgICAgICAgICBub25jZTogZ2VuZXJhdGVSYW5kb21TdHJpbmcoMTYpLFxuICAgICAgICAgICAgICAuLi5vcHRpb25zLmFkZGl0aW9uYWxPcHRpb25zXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZVByb21wdCA9IChhdHRlbXB0KSA9PiB7XG4gICAgICAgICAgICAgIGlmIChpc1Jlc29sdmVkKSByZXR1cm47XG4gICAgICAgICAgICAgIHdpbmRvdy5nb29nbGU/LmFjY291bnRzLmlkLnByb21wdCgobm90aWZpY2F0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGlzUmVzb2x2ZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmlzRGlzbWlzc2VkTW9tZW50ICYmIG5vdGlmaWNhdGlvbi5pc0Rpc21pc3NlZE1vbWVudCgpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heEF0dGVtcHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5wb3coMiwgYXR0ZW1wdCkgKiBiYXNlRGVsYXk7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gaGFuZGxlUHJvbXB0KGF0dGVtcHQgKyAxKSwgZGVsYXkpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0cz8ub25Qcm9tcHROb3RpZmljYXRpb24/Lihub3RpZmljYXRpb24pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLmlzU2tpcHBlZE1vbWVudCAmJiBub3RpZmljYXRpb24uaXNTa2lwcGVkTW9tZW50KCkpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0IDwgbWF4QXR0ZW1wdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVsYXkgPSBNYXRoLnBvdygyLCBhdHRlbXB0KSAqIGJhc2VEZWxheTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBoYW5kbGVQcm9tcHQoYXR0ZW1wdCArIDEpLCBkZWxheSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvcHRzPy5vblByb21wdE5vdGlmaWNhdGlvbj8uKG5vdGlmaWNhdGlvbik7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBoYW5kbGVQcm9tcHQoMCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyBHb29nbGUgT25lIFRhcCBmbG93OlwiLCBlcnJvcik7XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaXNSZXF1ZXN0SW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSksXG4gICAgZ2V0QXRvbXMoJGZldGNoKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9O1xufTtcbnZhciBsb2FkR29vZ2xlU2NyaXB0ID0gKCkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBpZiAod2luZG93Lmdvb2dsZVNjcmlwdEluaXRpYWxpemVkKSB7XG4gICAgICByZXNvbHZlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgc2NyaXB0LnNyYyA9IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL2dzaS9jbGllbnRcIjtcbiAgICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xuICAgIHNjcmlwdC5kZWZlciA9IHRydWU7XG4gICAgc2NyaXB0Lm9ubG9hZCA9ICgpID0+IHtcbiAgICAgIHdpbmRvdy5nb29nbGVTY3JpcHRJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICByZXNvbHZlKCk7XG4gICAgfTtcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG4gIH0pO1xufTtcblxuLy8gc3JjL3BsdWdpbnMvY3VzdG9tLXNlc3Npb24vY2xpZW50LnRzXG52YXIgY3VzdG9tU2Vzc2lvbkNsaWVudCA9ICgpID0+IHtcbiAgcmV0dXJuIEluZmVyU2VydmVyUGx1Z2luKCk7XG59O1xuXG4vLyBzcmMvY2xpZW50L3BsdWdpbnMvaW5mZXItcGx1Z2luLnRzXG52YXIgSW5mZXJTZXJ2ZXJQbHVnaW4gPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiaW5mZXItc2VydmVyLXBsdWdpblwiLFxuICAgICRJbmZlclNlcnZlclBsdWdpbjoge31cbiAgfTtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL3Nzby9jbGllbnQudHNcbnZhciBzc29DbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwic3NvLWNsaWVudFwiLFxuICAgICRJbmZlclNlcnZlclBsdWdpbjoge31cbiAgfTtcbn07XG5cbi8vIHNyYy9wbHVnaW5zL29pZGMtcHJvdmlkZXIvY2xpZW50LnRzXG52YXIgb2lkY0NsaWVudCA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJvaWRjLWNsaWVudFwiLFxuICAgICRJbmZlclNlcnZlclBsdWdpbjoge31cbiAgfTtcbn07XG5cbmV4cG9ydCB7IEluZmVyU2VydmVyUGx1Z2luLCBhZG1pbkNsaWVudCwgYW5vbnltb3VzQ2xpZW50LCBjdXN0b21TZXNzaW9uQ2xpZW50LCBlbWFpbE9UUENsaWVudCwgZ2VuZXJpY09BdXRoQ2xpZW50LCBnZXRQYXNza2V5QWN0aW9ucywgaW5mZXJBZGRpdGlvbmFsRmllbGRzLCBqd3RDbGllbnQsIG1hZ2ljTGlua0NsaWVudCwgbXVsdGlTZXNzaW9uQ2xpZW50LCBvaWRjQ2xpZW50LCBvbmVUYXBDbGllbnQsIG9yZ2FuaXphdGlvbkNsaWVudCwgcGFzc2tleUNsaWVudCwgcGhvbmVOdW1iZXJDbGllbnQsIHNzb0NsaWVudCwgdXNlcm5hbWVDbGllbnQgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/client/plugins.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/react.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/react.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter),\n/* harmony export */   createAuthClient: () => (/* binding */ createAuthClient),\n/* harmony export */   useStore: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var _chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-PY47VMWF.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-PY47VMWF.js\");\n/* harmony import */ var _chunk_HVHN3Y2L_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-HVHN3Y2L.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-HVHN3Y2L.js\");\n/* harmony import */ var _chunk_XFCIANZX_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-XFCIANZX.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-XFCIANZX.js\");\n/* harmony import */ var _chunk_TQQSPPNA_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-TQQSPPNA.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-TQQSPPNA.js\");\n/* harmony import */ var _chunk_UNWCXKMP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunk-UNWCXKMP.js */ \"(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/chunk-UNWCXKMP.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/.pnpm/nanostores@0.11.4/node_modules/nanostores/listen-keys/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@15.2.1_@babel+core@7.24.5_@opentelemetry+api@1.9.0_react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n\n\n\n\n\n\n\n\nvar emit = (snapshotRef, onChange) => (value) => {\n  snapshotRef.current = value;\n  onChange();\n};\nfunction useStore(store, { keys, deps = [store, keys] } = {}) {\n  let snapshotRef = (0,react__WEBPACK_IMPORTED_MODULE_5__.useRef)();\n  snapshotRef.current = store.get();\n  let subscribe = (0,react__WEBPACK_IMPORTED_MODULE_5__.useCallback)(\n    (onChange) => (keys?.length || 0) > 0 ? (0,nanostores__WEBPACK_IMPORTED_MODULE_6__.listenKeys)(store, keys, emit(snapshotRef, onChange)) : store.listen(emit(snapshotRef, onChange)),\n    deps\n  );\n  let get = () => snapshotRef.current;\n  return (0,react__WEBPACK_IMPORTED_MODULE_5__.useSyncExternalStore)(subscribe, get, get);\n}\n\n// src/client/react/index.ts\nfunction getAtomKey(str) {\n  return `use${capitalizeFirstLetter(str)}`;\n}\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nfunction createAuthClient(options) {\n  const {\n    pluginPathMethods,\n    pluginsActions,\n    pluginsAtoms,\n    $fetch,\n    $store,\n    atomListeners\n  } = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_0__.getClientConfig)(options);\n  let resolvedHooks = {};\n  for (const [key, value] of Object.entries(pluginsAtoms)) {\n    resolvedHooks[getAtomKey(key)] = () => useStore(value);\n  }\n  const routes = {\n    ...pluginsActions,\n    ...resolvedHooks,\n    $fetch,\n    $store\n  };\n  const proxy = (0,_chunk_PY47VMWF_js__WEBPACK_IMPORTED_MODULE_0__.createDynamicPathProxy)(\n    routes,\n    $fetch,\n    pluginPathMethods,\n    pluginsAtoms,\n    atomListeners\n  );\n  return proxy;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3JlYWN0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBOEU7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDVztBQUMwQjs7QUFFbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsNkJBQTZCLElBQUk7QUFDNUQsb0JBQW9CLDZDQUFNO0FBQzFCO0FBQ0Esa0JBQWtCLGtEQUFXO0FBQzdCLDRDQUE0QyxzREFBVTtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJEQUFvQjtBQUM3Qjs7QUFFQTtBQUNBO0FBQ0EsZUFBZSwyQkFBMkI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxFQUFFLG1FQUFlO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDBFQUFzQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2RCIsInNvdXJjZXMiOlsiL1VzZXJzL2dvbW9sZW1va2dhdGl0c29lL3Byb2plY3RzL2VtYWlsLXByZXZpZXdlci1hcHBsaWNhdGlvbi9ub2RlX21vZHVsZXMvLnBucG0vYmV0dGVyLWF1dGhAMS4xLjE5L25vZGVfbW9kdWxlcy9iZXR0ZXItYXV0aC9kaXN0L3JlYWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldENsaWVudENvbmZpZywgY3JlYXRlRHluYW1pY1BhdGhQcm94eSB9IGZyb20gJy4vY2h1bmstUFk0N1ZNV0YuanMnO1xuaW1wb3J0ICcuL2NodW5rLUhWSE4zWTJMLmpzJztcbmltcG9ydCAnLi9jaHVuay1YRkNJQU5aWC5qcyc7XG5pbXBvcnQgJy4vY2h1bmstVFFRU1BQTkEuanMnO1xuaW1wb3J0ICcuL2NodW5rLVVOV0NYS01QLmpzJztcbmltcG9ydCB7IGxpc3RlbktleXMgfSBmcm9tICduYW5vc3RvcmVzJztcbmltcG9ydCB7IHVzZVJlZiwgdXNlQ2FsbGJhY2ssIHVzZVN5bmNFeHRlcm5hbFN0b3JlIH0gZnJvbSAncmVhY3QnO1xuXG52YXIgZW1pdCA9IChzbmFwc2hvdFJlZiwgb25DaGFuZ2UpID0+ICh2YWx1ZSkgPT4ge1xuICBzbmFwc2hvdFJlZi5jdXJyZW50ID0gdmFsdWU7XG4gIG9uQ2hhbmdlKCk7XG59O1xuZnVuY3Rpb24gdXNlU3RvcmUoc3RvcmUsIHsga2V5cywgZGVwcyA9IFtzdG9yZSwga2V5c10gfSA9IHt9KSB7XG4gIGxldCBzbmFwc2hvdFJlZiA9IHVzZVJlZigpO1xuICBzbmFwc2hvdFJlZi5jdXJyZW50ID0gc3RvcmUuZ2V0KCk7XG4gIGxldCBzdWJzY3JpYmUgPSB1c2VDYWxsYmFjayhcbiAgICAob25DaGFuZ2UpID0+IChrZXlzPy5sZW5ndGggfHwgMCkgPiAwID8gbGlzdGVuS2V5cyhzdG9yZSwga2V5cywgZW1pdChzbmFwc2hvdFJlZiwgb25DaGFuZ2UpKSA6IHN0b3JlLmxpc3RlbihlbWl0KHNuYXBzaG90UmVmLCBvbkNoYW5nZSkpLFxuICAgIGRlcHNcbiAgKTtcbiAgbGV0IGdldCA9ICgpID0+IHNuYXBzaG90UmVmLmN1cnJlbnQ7XG4gIHJldHVybiB1c2VTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIGdldCwgZ2V0KTtcbn1cblxuLy8gc3JjL2NsaWVudC9yZWFjdC9pbmRleC50c1xuZnVuY3Rpb24gZ2V0QXRvbUtleShzdHIpIHtcbiAgcmV0dXJuIGB1c2Uke2NhcGl0YWxpemVGaXJzdExldHRlcihzdHIpfWA7XG59XG5mdW5jdGlvbiBjYXBpdGFsaXplRmlyc3RMZXR0ZXIoc3RyKSB7XG4gIHJldHVybiBzdHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSk7XG59XG5mdW5jdGlvbiBjcmVhdGVBdXRoQ2xpZW50KG9wdGlvbnMpIHtcbiAgY29uc3Qge1xuICAgIHBsdWdpblBhdGhNZXRob2RzLFxuICAgIHBsdWdpbnNBY3Rpb25zLFxuICAgIHBsdWdpbnNBdG9tcyxcbiAgICAkZmV0Y2gsXG4gICAgJHN0b3JlLFxuICAgIGF0b21MaXN0ZW5lcnNcbiAgfSA9IGdldENsaWVudENvbmZpZyhvcHRpb25zKTtcbiAgbGV0IHJlc29sdmVkSG9va3MgPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocGx1Z2luc0F0b21zKSkge1xuICAgIHJlc29sdmVkSG9va3NbZ2V0QXRvbUtleShrZXkpXSA9ICgpID0+IHVzZVN0b3JlKHZhbHVlKTtcbiAgfVxuICBjb25zdCByb3V0ZXMgPSB7XG4gICAgLi4ucGx1Z2luc0FjdGlvbnMsXG4gICAgLi4ucmVzb2x2ZWRIb29rcyxcbiAgICAkZmV0Y2gsXG4gICAgJHN0b3JlXG4gIH07XG4gIGNvbnN0IHByb3h5ID0gY3JlYXRlRHluYW1pY1BhdGhQcm94eShcbiAgICByb3V0ZXMsXG4gICAgJGZldGNoLFxuICAgIHBsdWdpblBhdGhNZXRob2RzLFxuICAgIHBsdWdpbnNBdG9tcyxcbiAgICBhdG9tTGlzdGVuZXJzXG4gICk7XG4gIHJldHVybiBwcm94eTtcbn1cblxuZXhwb3J0IHsgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyLCBjcmVhdGVBdXRoQ2xpZW50LCB1c2VTdG9yZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/better-auth@1.1.19/node_modules/better-auth/dist/react.js\n");

/***/ })

};
;